<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01955</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004488</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Efficient Optimization of Stimuli for Model-Based Design of Experiments to Resolve Dynamical Uncertainty</article-title>
<alt-title alt-title-type="running-head">Stimuli Optimization MBDOE</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Mdluli</surname> <given-names>Thembi</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Buzzard</surname> <given-names>Gregery T.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Rundell</surname> <given-names>Ann E.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Weldon School of Biomedical Engineering, Purdue University, West Lafayette, Indiana, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Mathematics Department, Purdue University, West Lafayette, Indiana, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Kosakovsky Pond</surname> <given-names>Sergei L.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of California San Diego, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Wrote the paper: TM GTB AER.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">tmdluli@purdue.edu</email> (TM); <email xlink:type="simple">rundell@purdue.edu</email> (AR)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>9</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>17</day>
<month>9</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>9</issue>
<elocation-id>e1004488</elocation-id>
<history>
<date date-type="received">
<day>24</day>
<month>10</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>5</day>
<month>8</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Mdluli et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004488" xlink:type="simple"/>
<abstract>
<p>This model-based design of experiments (MBDOE) method determines the input magnitudes of an experimental stimuli to apply and the associated measurements that should be taken to optimally constrain the uncertain dynamics of a biological system under study. The ideal global solution for this experiment design problem is generally computationally intractable because of parametric uncertainties in the mathematical model of the biological system. Others have addressed this issue by limiting the solution to a local estimate of the model parameters. Here we present an approach that is independent of the local parameter constraint. This approach is made computationally efficient and tractable by the use of: (1) sparse grid interpolation that approximates the biological system dynamics, (2) representative parameters that uniformly represent the data-consistent dynamical space, and (3) probability weights of the represented experimentally distinguishable dynamics. Our approach identifies data-consistent representative parameters using sparse grid interpolants, constructs the optimal input sequence from a greedy search, and defines the associated optimal measurements using a scenario tree. We explore the optimality of this MBDOE algorithm using a 3-dimensional Hes1 model and a 19-dimensional T-cell receptor model. The 19-dimensional T-cell model also demonstrates the MBDOE algorithm’s scalability to higher dimensions. In both cases, the dynamical uncertainty region that bounds the trajectories of the target system states were reduced by as much as 86% and 99% respectively after completing the designed experiments <italic>in silico</italic>. Our results suggest that for resolving dynamical uncertainty, the ability to design an input sequence paired with its associated measurements is particularly important when limited by the number of measurements.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Many mathematical models that have been developed for biological systems are limited because the complex systems are not well understood, the parameters are not known, and available data is limited and noisy. On the other hand, experiments to support model development are limited in terms of costs and time, feasible inputs and feasible measurements. MBDOE combines the mathematical models with experiment design to strategically design optimal experiments to obtain data that will contribute to the understanding of the systems. Our approach extends current capabilities of existing MBDOE techniques to make them more useful for scientists to resolve the trajectories of the system under study. It identifies the optimal conditions for stimuli and measurements that yield the most information about the system given the practical limitations. Exploration of the input space is not a trivial extension to MBDOE methods used for determining optimal measurements due to the nonlinear nature of many biological system models. The exploration of the system dynamics elicited by different inputs requires a computationally efficient and tractable approach. Our approach plans optimal experiments to reduce dynamical uncertainty in the output of selected target states of the biological system.</p>
</abstract>
<funding-group>
<funding-statement>This research was supported in part by the NSF grant DMS-0900277. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="6"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Since experiments can be expensive and time consuming, it is important that they are planned to generate useful data. Traditional design of experiments is a well established field and has led to many advances in biology and medicine. The data obtained from strategically designed experiments has facilitated the creation of mathematical models that relate experimental stimuli to measurable outcomes. These models typically describe the system’s input-output relationship but fail to capture or encode knowledge of the system’s internal mechanisms and processes. Mechanistic and semi-mechanistic mathematical models encode the current understanding of the internal processes of the biological system even though many of these internal states or species are not directly measurable. These mechanistic models can be used to support optimal experiment design that considers the current knowledge of the system interactions and practical experimental constraints. In recent literature this type of experiment design has been referred to as model-based design of experiments (MBDOE). MBDOE produces experiments meant to reduce some measure of uncertainty in the associated model while respecting cost, time and resource constraints. Most MBDOE strategies can be categorized by three types of objectives: (1) reducing model parameter uncertainty [<xref ref-type="bibr" rid="pcbi.1004488.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004488.ref007">7</xref>], (2) discriminating among possible models [<xref ref-type="bibr" rid="pcbi.1004488.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1004488.ref013">13</xref>], and (3) reducing dynamical uncertainty [<xref ref-type="bibr" rid="pcbi.1004488.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1004488.ref017">17</xref>]. This work advances current abilities to design experiments to resolve the trajectories of target states of a biological system model, thereby reducing its dynamical uncertainty.</p>
<p>Many of the MBDOE strategies that support reduction of parameter uncertainty and model discrimination rely on linear approximations that are locally optimal to design an experiment by optimizing a criterion of the Fisher Information Matrix (FIM) [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004488.ref021">21</xref>]. Such techniques use the local sensitivities of parameters to design an optimal experiment which requires an initial estimate of the unknown parameters. Most biological system models are not well characterized, as data is limited and noisy, so initial estimates of the model parameters are inaccurate. Furthermore, biological models are typically nonlinear, so a poor initial parameter estimate is likely to result in a local minimum, which may result in sub-optimal experiment design. Alternatively, the Sigma Point method refines estimates of the characteristic values of the parameter statistics [<xref ref-type="bibr" rid="pcbi.1004488.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref023">23</xref>]. This method is computationally efficient and gives a better approximation of the covariance matrix when compared to the FIM-based and boot-strap methods. However, this method is not applicable when the biological system is not well characterized with existing experimental data. These local methods for MBDOE are limited to scenarios when initial estimates for the model parameters or their distributions are already fairly well known.</p>
<p>To overcome the shortcomings of local MBDOE strategies, global approaches that consider the entire uncertain parameter range have been developed. Global optimization has been used to improve the FIM-based design [<xref ref-type="bibr" rid="pcbi.1004488.ref024">24</xref>] and local deterministic optimization of the likelihood with multi-start initial parameter estimates [<xref ref-type="bibr" rid="pcbi.1004488.ref025">25</xref>] have been previously employed. Some Bayesian MBDOE methods use Monte Carlo generated estimates of the parameter confidence intervals to design a global optimal experiment [<xref ref-type="bibr" rid="pcbi.1004488.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1004488.ref030">30</xref>]. A comparison of the FIM-based and Bayesian-based MBDOE methods by Weber et al. [<xref ref-type="bibr" rid="pcbi.1004488.ref031">31</xref>] shows that Bayesian methods give more accurate and informative designs. However, all of these global methods are computationally prohibitive for large numbers of highly uncertain parameters and mathematical models that are computationally intensive. The limitation due to computation has been partially abrogated by methods that utilize surrogate models to approximate the mathematical model of the system. Herein, as in our previous work [<xref ref-type="bibr" rid="pcbi.1004488.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>], we use a sparse grid interpolation tool to approximate the biological model.</p>
<p>To find the optimal design a search has to be performed over all of the experimental factors that define the feasible experimental perturbations and potential measurements. A complete exploration of the full design space over the uncertain parameter space for an optimal experiment design is impractical due to the combinatorial explosion of possible experimental factors evaluated for all possible model parameterizations. To solve the problem, most MBDOE strategies constrain the design space to a subset of the possible experiments. This reduces the design space by assuming a small predefined set of possible measurement points, measurable species and/or input levels [<xref ref-type="bibr" rid="pcbi.1004488.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1004488.ref033">33</xref>]. Herein, we define the input to be the exogenous experimental factors, perturbations and/or stimuli that are applied to the biological system. Other designs have considered finding an optimal input sequence while the times and measurement species are defined <italic>a priori</italic> [<xref ref-type="bibr" rid="pcbi.1004488.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref034">34</xref>]. To consider both optimal measurements and an optimal input sequence, some strategies [<xref ref-type="bibr" rid="pcbi.1004488.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref035">35</xref>] evaluate the optimality of a pre-defined set of specified inputs and measurement points. All of these approaches may result in sub-optimal experiment designs if the best experiment is not among the specified experimental options.</p>
<p>Ideally, experiment design determines the optimal solution within a feasible space defined by all the possible experimental measurements and inputs. Since different inputs can elicit dramatically different dynamics for some nonlinear systems, evaluating experiments for optimal inputs is not necessarily a trivial extension of the global techniques for identifying optimal measurements. Herein, we describe and evaluate a computationally efficient and tractable method for performing global MBDOE to define optimal experimental inputs and measurements to reduce the uncertainty in continuous nonlinear system dynamics. The method utilizes the sparse grid surrogate model technique first employed for global experimental designs presented in [<xref ref-type="bibr" rid="pcbi.1004488.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>], which selected only optimal measurements and not optimal inputs. We proposed an earlier version [<xref ref-type="bibr" rid="pcbi.1004488.ref036">36</xref>] of our input design MBDOE algorithm that used a combination of scenario trees and sparse grid interpolation to screen the input design space for optimal inputs that will generate diverse dynamics of the uncertain nonlinear system. This paper is an extension of that work. Herein we utilize a greedy search to determine the input magnitude to be applied using a method that is similar to that in [<xref ref-type="bibr" rid="pcbi.1004488.ref037">37</xref>] which determined near-optimal measurements in polynomial time. Our MBDOE algorithm is made even more computationally efficient and robust than our previous sparse grid based strategies due to the uniform sampling over the dynamical space via careful selection of representative parameters, the optimization criteria for optimal experiment design for a target system, and the repeated update of probability weights over the dynamical space using predicted data. Our new MBDOE method develops a strategic experiment design that yields highly informative data that can be used to constrain the system dynamics to dynamical uncertainty regions.</p>
<p>In the methods section, we describe the experiment design problem and define the methods used to solve the problem as sequential optimizations to first select an optimal input sequence and, subsequently, specify the associated optimal measurement pairs (species and time points). In the results section, we explore the optimality of the derived experiment design solution using a small 3-dimensional Hes1 oscillatory model and demonstrate the scalability of this MBDOE strategy with a 19-dimensional T-cell receptor model. The global applicability, support of hybrid experiment designs, and limitations of this MBDOE approach are discussed to conclude the paper.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec003">
<title>Dynamical Model Definition</title>
<p>This MBDOE algorithm is designed to resolve dynamical uncertainties associated with the biological system by reducing the predicted variance in the system dynamics. The system is described by nonlinear ordinary differential equations of the general form:
<disp-formula id="pcbi.1004488.e001"><alternatives><graphic id="pcbi.1004488.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mn mathvariant="bold">0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold>f</bold> is a deterministic smooth function of <inline-formula id="pcbi.1004488.e002"><alternatives><graphic id="pcbi.1004488.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mtext mathvariant="bold">x</mml:mtext> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the states of the system, <inline-formula id="pcbi.1004488.e003"><alternatives><graphic id="pcbi.1004488.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e003"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the known model parameters, <inline-formula id="pcbi.1004488.e004"><alternatives><graphic id="pcbi.1004488.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e004"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:msup><mml:mi>p</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the unknown model parameters, and <inline-formula id="pcbi.1004488.e005"><alternatives><graphic id="pcbi.1004488.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e005"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>u</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> the exogenous inputs. Using control vector parameterization (CVP) [<xref ref-type="bibr" rid="pcbi.1004488.ref038">38</xref>], we represent <bold>u</bold> = [<bold><italic>u</italic></bold>(<italic>τ</italic><sub>1</sub>), …, <bold><italic>u</italic></bold>(<italic>τ</italic><sub><italic>N</italic></sub>)] ∈ ℝ<sup><italic>n</italic><sub><italic>u</italic></sub>∗<italic>N</italic></sup>, as vector-valued function of the system inputs that can change value at each discrete time point, <italic>τ</italic><sub><italic>j</italic></sub>, where <italic>j</italic> = 1, …, <italic>N</italic>. There is uncertainty in the dynamics of the system which is generated by the uncertainty in the values of the unknown model parameters, <bold><italic>θ</italic></bold>′ ∈ Ω where Ω is a compact set.</p>
<p>It is common in biological systems that not all states of this system are experimentally measurable. All feasible measurements for this system are modeled by:
<disp-formula id="pcbi.1004488.e006"><alternatives><graphic id="pcbi.1004488.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e006"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <bold>h</bold> is a smooth vector-valued function that relates to the system’s internal states described in <xref ref-type="disp-formula" rid="pcbi.1004488.e001">Eq (1)</xref> and <inline-formula id="pcbi.1004488.e007"><alternatives><graphic id="pcbi.1004488.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mtext mathvariant="bold">y</mml:mtext> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. We abbreviate <xref ref-type="disp-formula" rid="pcbi.1004488.e006">Eq (2)</xref> by the notation <bold>y</bold>(<bold>u</bold>, <bold>θ</bold>′, <italic>t</italic>). The user defines the number of measurements that they would like to have designed, <italic>K</italic>, as well as the set of possible times for measurement, 𝕋, by either specifying discrete time points or defining a time resolution, <italic>δt</italic>, between <italic>T</italic><sub><italic>I</italic></sub> and <italic>T</italic><sub><italic>F</italic></sub>, the initial and final model simulation times, respectively.</p>
<p>Our MBDOE algorithm designs experiments that reduce dynamical uncertainty in a target system. This target system is a subset of the system states termed, target states, <bold>x</bold><sub><bold><italic>T</italic></bold></sub>, when stimulated by a target input, <bold>u</bold><sub><bold><italic>T</italic></bold></sub>. This approach employs the concept of a target system also used to evaluate an alternative MBDOE strategy [<xref ref-type="bibr" rid="pcbi.1004488.ref016">16</xref>].</p>
<p>We consider dynamical uncertainty in the measurable states, <bold>y</bold>, and the target states, <bold>x</bold><sub><bold><italic>T</italic></bold></sub>, generated by the uncertainty in the unknown parameters, <bold><italic>θ</italic></bold>′. As a result of limited and noisy data, often biological system models will fit the data with a wide range of parameters values and associated dynamics. Therefore, for an optimal design, we need to consider all the possible data-consistent dynamical scenarios which are a function of the parameter space, Ω.</p>
</sec>
<sec id="sec004">
<title>Optimization Problem Definition</title>
<p>The optimal experiment, <italic>D</italic>* ∈ 𝔻, defines the optimal input stimulation and optimal measurement pairs that resolve the target state dynamics. This design is defined by a piecewise input sequence, <bold>u</bold>* (<xref ref-type="disp-formula" rid="pcbi.1004488.e008">Eq (3)</xref>), and associated measurements <italic>M</italic>* = {(<italic>m</italic><sub><italic>k</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>):<italic>k</italic> = 1,2,…<italic>K</italic>} ∈ 𝕄, which defines <italic>K</italic> measurement pairs by the index of a measurement species <italic>m</italic><sub><italic>k</italic></sub> and its corresponding measurement time <italic>t</italic><sub><italic>k</italic></sub>.
<disp-formula id="pcbi.1004488.e008"><alternatives><graphic id="pcbi.1004488.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold">u</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mn>1</mml:mn> <mml:mo>*</mml:mo></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>N</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
We choose <italic>D</italic>* as the experimental design that maximizes a measure of information gained from an experiment
<disp-formula id="pcbi.1004488.e009"><alternatives><graphic id="pcbi.1004488.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="italic">D</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">argmin</mml:mo> <mml:mrow><mml:mi mathvariant="bold">u</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>*</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>𝕄</mml:mo></mml:mrow></mml:munder> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
The target state dynamical uncertainty (TDU), <italic>γ</italic>(<bold>u</bold>), is quantified by the sum of the maximum variance in each target state that results when analyzed assuming the input sequence, <bold>u</bold>, has been applied and measurements, <italic>M</italic>, exist to constrain the uncertain parameter space:
<disp-formula id="pcbi.1004488.e010"><alternatives><graphic id="pcbi.1004488.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mo movablelimits="true" form="prefix">max</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>Var</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi mathvariant="bold">T</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∣</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where the maximum variance of the <italic>i</italic><sup><italic>th</italic></sup> target state, max(Var(<italic>x</italic><sub><bold>T</bold> <italic>i</italic></sub>(<italic>t</italic>)∣(<bold>u</bold>, <italic>M</italic>)), is chosen across the simulated time <italic>t</italic>, from the initial, <italic>T</italic><sub><italic>I</italic></sub> to the final time, <italic>T</italic><sub><italic>F</italic></sub>.</p>
<p>The ideal solution for the above optimization problem simultaneously solves for the optimal input vector, <bold>u</bold>*, together with the optimal measurements, <italic>M</italic>*. This is generally a computationally intractable problem due to the combinatorial explosion of all possible selections for the experiment design complicated by the expense of evaluating the design with the model for all possible uncertain parameter values. Our approach proposes a computationally efficient method to approximate both the optimal input vector and associated optimal measurement points by breaking the problem into smaller computationally feasible optimization problems. The first optimization problem solves for the input vector using a greedy method by minimizing the value of TDU at each iteration assuming a single best measurement is taken:
<disp-formula id="pcbi.1004488.e011"><alternatives><graphic id="pcbi.1004488.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold">u</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">argmin</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mo>ℝ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>u</mml:mi></mml:msub></mml:msup></mml:mrow></mml:munder> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mi>N</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
The optimal input vector is then used in the second optimization to determine the multiple optimal measurements points. This combined solution of input and measurements approximates the optimal experiment design defined in <xref ref-type="disp-formula" rid="pcbi.1004488.e009">Eq (4)</xref>.</p>
<p>A flow-chart of the MBDOE algorithm is given in <xref ref-type="fig" rid="pcbi.1004488.g001">Fig 1</xref> to display the sequence of events in determining the optimal experiment design: (a) identify representative parameters that maintain the diversity of simulated dynamics that fit the existing data, (b) determine the optimal input vector that minimizes TDU, and (c) specify associated multiple measurement pairs given an optimal input vector.</p>
<fig id="pcbi.1004488.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Flow charts describing the three steps for the MBDOE method.</title>
<p>These describe (a) how acceptable and representative parameters are identified, (b) the process for determining the optimal input vector, and (c) the selection of multiple measurement pairs associated with the optimal input vector.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.g001"/>
</fig>
</sec>
<sec id="sec005">
<title>Identify Representative Parameters</title>
<p>The first step of this process screens the uncertain parameter space, Ω, to identify the space of acceptable parameters, Ω<sub><italic>A</italic></sub>. The acceptable parameters are those that support model simulations to fit the available data as:
<disp-formula id="pcbi.1004488.e012"><alternatives><graphic id="pcbi.1004488.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e012"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Ω</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>∈</mml:mo> <mml:mo>Ω</mml:mo> <mml:mo>∣</mml:mo> <mml:msub><mml:mo form="prefix">log</mml:mo> <mml:mn>10</mml:mn></mml:msub> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>∈</mml:mo> <mml:mo>Ω</mml:mo></mml:mrow></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where <inline-formula id="pcbi.1004488.e013"><alternatives><graphic id="pcbi.1004488.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e013"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the mean of the experimental data for the <italic>i</italic><sup><italic>th</italic></sup> model output at the time point, <italic>t</italic>, collected with the applied input <bold>u</bold>, <inline-formula id="pcbi.1004488.e014"><alternatives><graphic id="pcbi.1004488.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e014"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the corresponding model dynamics simulated with a parameter set, <bold><italic>θ</italic></bold>′, and <italic>σ</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is the standard deviation of the data. In this work, we approximate <inline-formula id="pcbi.1004488.e015"><alternatives><graphic id="pcbi.1004488.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e015"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> using a sparse grid interpolation tool over the uncertain space Ω for computational efficiency. <italic>T</italic><sub><italic>A</italic></sub> is the threshold for acceptability. This weighted least squares function has been used before to define acceptable parameters in [<xref ref-type="bibr" rid="pcbi.1004488.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>]. The parameter space, Ω, is sampled using Latin Hypercube Sampling (LHS). If the initial screen produces fewer acceptable parameters than <italic>N</italic><sub><italic>A</italic></sub>, the desired number of acceptable parameter vectors that will support the experiment design, focused grids are created [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>] to improve the resolution of the grid interpolant in the acceptable regions of the uncertain parameter space. LHS is also used to sample the focused grids to find more acceptable parameters until the <italic>cardinality</italic>(Ω<sub><italic>A</italic></sub>) ≥ <italic>N</italic><sub><italic>A</italic></sub>. In this work, we define the <italic>dynamical uncertainty region</italic> to be the region spanned by the most extreme trajectories of the acceptable parameters.</p>
<sec id="sec006">
<title>Selection of Representative Parameters</title>
<p>We select representative parameters from the acceptable parameter space, Ω<sub><italic>RA</italic></sub> ⊂ Ω<sub><italic>A</italic></sub>, that span the dynamics space, denoted by 𝕯<sub><italic>A</italic></sub>, simulated by the model over the acceptable parameter space. Our selection of Ω<sub><italic>RA</italic></sub> effectively samples the parameters consistent with the number of experimentally distinguishable dynamics for robustness. We cluster the trajectories, <italic>η</italic> ∈ 𝕯<sub><italic>A</italic></sub>, where <italic>η</italic> = <italic>φ</italic>(<italic>θ</italic>′) is the trajectory associated with <italic>θ</italic>′, so that parameters that generate similar dynamics are grouped together. A spectral clustering method is used that employs eigenvalue analysis to estimate the number of clusters. The cluster number is determined at the largest gap of the eigenvalues of the normalized Laplacian matrix that is used in spectral clustering as in [<xref ref-type="bibr" rid="pcbi.1004488.ref039">39</xref>]. After the clusters are created, we select representative parameters from each cluster to form Ω<sub><italic>RA</italic></sub>. To preserve dynamical diversity, the representative parameters are sampled from the convex hull of each cluster using the MATLAB function <italic>convhulln</italic>. The number of representatives sampled from the convex hull of each cluster is equal to a user-specified number, <bold>C</bold>, with minimum sample size of three to ensure triangulation. Thus the representative parameters discretize the acceptable uncertain space into <italic>N</italic><sub><italic>RA</italic></sub> = <bold>C</bold>⋅(# of clusters) parameters that preserve the dynamical diversity. We use these representative parameters as an indirect means to approximate a uniform sampling from the acceptable trajectory space as described next.</p>
</sec>
<sec id="sec007">
<title>Computational Efficiency Afforded by Dynamical Representative Parameters</title>
<p>For computational efficiency, our goal is to estimate the mean and variance of possible trajectories with uniform sampling in dynamical space. To be more precise, let ℓ<sub>Ω</sub>(<italic>θ</italic>′) be the likelihood of <italic>θ</italic>′ based on existing experimental data. Then one way to define the probability of <italic>θ</italic>′ is:
<disp-formula id="pcbi.1004488.e016"><alternatives><graphic id="pcbi.1004488.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e016"/><mml:math id="M16" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mo>Ω</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi> <mml:mo>Ω</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>λ</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mo>Ω</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>λ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
However, this focuses on the parameter space and may overweigh some regions of the dynamical space if the dynamics are relatively insensitive to changes in the parameter values. This is due to the fact that we obtained Ω<sub><italic>A</italic></sub> by LHS on the parameter space. Instead, we want to sample uniformly in the dynamical space. Let 𝕯<sub><italic>RA</italic></sub> = <italic>φ</italic>(Ω<sub><italic>RA</italic></sub>) be the set of trajectories simulated with the set of representative parameters. So the probability of a given trajectory, <italic>η</italic>, can be defined by:
<disp-formula id="pcbi.1004488.e017"><alternatives><graphic id="pcbi.1004488.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e017"/><mml:math id="M17" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mi mathvariant="fraktur">D</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi> <mml:mi mathvariant="fraktur">D</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ν</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="fraktur">D</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mi mathvariant="fraktur">D</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ν</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
This can be used to translate to a <italic>p</italic><sub>Ω<sub><italic>RA</italic></sub></sub>(<italic>θ</italic>′) where <italic>θ</italic>′ generates a trajectory, <italic>η</italic>, that is contained in 𝕯<sub><italic>RA</italic></sub>. (Recall, <italic>η</italic> ∈ 𝕯<sub><italic>A</italic></sub>.) Thus, an alternative way to define the probability of <italic>θ</italic>′ over the experimentally distinguishable dynamical space is:
<disp-formula id="pcbi.1004488.e018"><alternatives><graphic id="pcbi.1004488.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e018"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi> <mml:mo>Ω</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mi mathvariant="fraktur">D</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
Since 𝕯<sub><italic>RA</italic></sub> spans the dynamical set represented within 𝕯<sub><italic>A</italic></sub>, its reduced membership is compensated for by these probabilities.</p>
<p>The representative acceptable parameter set and its associated probability weights enable us to estimate the expected values and variances for the measured and target states over the experimentally distinguishable dynamics as:
<disp-formula id="pcbi.1004488.e019"><alternatives><graphic id="pcbi.1004488.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mi mathvariant="fraktur">D</mml:mi> <mml:mi>A</mml:mi></mml:msub></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>η</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="fraktur">D</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mi mathvariant="fraktur">D</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>η</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula> <xref ref-type="table" rid="pcbi.1004488.t001">Table 1</xref> specifies where this relationship in <xref ref-type="disp-formula" rid="pcbi.1004488.e019">Eq (11)</xref> is used in the following equations to estimate the expected values and variances in a computationally efficient manner using the representative parameters.</p>
<table-wrap id="pcbi.1004488.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.t001</object-id>
<label>Table 1</label>
<caption>
<title>Mapping of functions to equation numbers to efficiently estimate necessary expected values and variances.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004488.t001g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.t001"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Equation number</th>
<th align="center" rowspan="1" colspan="1">Expected Value Description</th>
<th align="center" rowspan="1" colspan="1">f(θ′)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1">(<xref ref-type="disp-formula" rid="pcbi.1004488.e034">14</xref>)</td>
<td align="center" rowspan="1" colspan="1">measurement variance, Var(<italic>y</italic><sub><italic>i</italic></sub>(<bold>u</bold>, ⋅, <italic>t</italic>))</td>
<td align="center" rowspan="1" colspan="1">(<italic>y</italic><sub><italic>i</italic></sub>(<bold>u</bold>,<bold>θ</bold>′, <italic>t</italic>)−<italic>μ</italic><sub><italic>i</italic></sub>(<italic>t</italic>))<sup>2</sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">(<xref ref-type="disp-formula" rid="pcbi.1004488.e034">14</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004488.e044">18</xref>)</td>
<td align="center" rowspan="1" colspan="1">expected experimental noise<xref ref-type="table-fn" rid="t001fn001">*</xref>, <italic>E</italic>(<italic>σ</italic><sub><italic>i</italic></sub>(<bold>u</bold>, <italic>t</italic>))<sup>2</sup></td>
<td align="center" rowspan="1" colspan="1">
<inline-formula id="pcbi.1004488.e020">
<alternatives>
<graphic id="pcbi.1004488.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e020"/>
<mml:math id="M20" display="inline" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>ζ</mml:mi>
<mml:mi>b</mml:mi>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>ζ</mml:mi>
<mml:mi>s</mml:mi>
</mml:msub>
<mml:mo stretchy="false">∣</mml:mo>
<mml:msub>
<mml:mi>y</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext mathvariant="bold">u</mml:mtext>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mi mathvariant="bold-italic">θ</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">∣</mml:mo>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>ζ</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo stretchy="false">∣</mml:mo>
<mml:msub>
<mml:mover accent="true">
<mml:mi>y</mml:mi>
<mml:mo>.</mml:mo>
</mml:mover>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo stretchy="false">(</mml:mo>
<mml:mtext mathvariant="bold">u</mml:mtext>
<mml:mo>,</mml:mo>
<mml:msup>
<mml:mi mathvariant="bold-italic">θ</mml:mi>
<mml:mo>′</mml:mo>
</mml:msup>
<mml:mo>,</mml:mo>
<mml:mi>t</mml:mi>
<mml:mo stretchy="false">)</mml:mo>
<mml:mo stretchy="false">∣</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">(<xref ref-type="disp-formula" rid="pcbi.1004488.e010">5</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004488.e044">18</xref>)</td>
<td align="center" rowspan="1" colspan="1">mean value, <italic>μ</italic></td>
<td align="center" rowspan="1" colspan="1"><italic>y</italic><sub><italic>i</italic></sub>(<bold>u</bold>, <bold><italic>θ</italic></bold>′, <italic>t</italic><sub><italic>k</italic></sub>)</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">(<xref ref-type="disp-formula" rid="pcbi.1004488.e010">5</xref>)</td>
<td align="center" rowspan="1" colspan="1">target state variance, Var(<italic>x</italic><sub><bold>T</bold><italic>i</italic></sub>(<italic>t</italic>))</td>
<td align="center" rowspan="1" colspan="1">(<italic>x</italic><sub><italic>Ti</italic></sub>(<bold>u</bold><sub><italic>T</italic></sub>, <bold><italic>θ</italic></bold>′, <italic>t</italic>)−<italic>μ</italic><sub><italic>Ti</italic></sub>(<italic>t</italic>))<sup>2</sup></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>*the constants <italic>ζ</italic><sub><italic>b</italic></sub>, <italic>ζ</italic><sub><italic>s</italic></sub>, <italic>ζ</italic><sub><italic>t</italic></sub> are described in [<xref ref-type="bibr" rid="pcbi.1004488.ref012">12</xref>].</p>
</fn>
</table-wrap-foot>
</table-wrap>
</sec>
</sec>
<sec id="sec008">
<title>Determine Optimal Input Vector</title>
<p>We propose solving the input vector using a greedy search algorithm. The input is discretized as in control vector parameterization (CVP) by the potential admissible input times 𝓣 = {<italic>τ</italic><sub>1</sub>⋯<italic>τ</italic><sub><italic>N</italic></sub>} and by potential magnitude levels. The number of possible input magnitudes is determined by the inputs bound [<italic>u</italic><sub><italic>min</italic></sub>, <italic>u</italic><sub><italic>max</italic></sub>] and resolution, <italic>δu</italic>:
<disp-formula id="pcbi.1004488.e021"><alternatives><graphic id="pcbi.1004488.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e021"/><mml:math id="M21" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>δ</mml:mi> <mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
The algorithm for the greedy search method to select the optimal input vector is detailed in the flowchart in <xref ref-type="fig" rid="pcbi.1004488.g001">Fig 1(b)</xref>. The input magnitude is initially set to a base input level, <bold>u</bold><sub>1</sub> = <bold><italic>u</italic></bold><sub><italic>b</italic></sub>(<italic>t</italic>) ∀<italic>t</italic> ∈ [<italic>T</italic><sub><italic>I</italic></sub> <italic>T</italic><sub><italic>F</italic></sub>], which is determined by the user. At each iteration, <italic>k</italic>, of the greedy search method, optimized input levels, <inline-formula id="pcbi.1004488.e022"><alternatives><graphic id="pcbi.1004488.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e022"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, for the admissible times, <italic>τ</italic><sub><italic>j</italic></sub> ∈ 𝓣<sub><italic>k</italic>−1</sub>, are selected from all <italic>N</italic><sub><italic>u</italic></sub> possible admissible input magnitudes as described in Algorithm 1. We evaluate TDU<sup><italic>j</italic></sup> for each of the admissible input times <italic>τ</italic><sub><italic>j</italic></sub> ∈ 𝓣<sub><italic>k</italic>−1</sub> and associated <inline-formula id="pcbi.1004488.e023"><alternatives><graphic id="pcbi.1004488.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and select the input conditions, <inline-formula id="pcbi.1004488.e024"><alternatives><graphic id="pcbi.1004488.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, that minimize the value of TDU according to <xref ref-type="disp-formula" rid="pcbi.1004488.e011">Eq (6)</xref> as optimal. These optimal input conditions update the current input vector as follows:
<disp-formula id="pcbi.1004488.e025"><alternatives><graphic id="pcbi.1004488.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e025"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:msup><mml:mi>τ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mtext>Elsewhere</mml:mtext></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
where <italic>τ</italic>′ is an input admissible time that has previously been optimized to update the vector, <bold>u</bold>*<sub><italic>k</italic>−1</sub>. We define 𝓢<sub><italic>k</italic>−1</sub>, a set of all previously optimized input admissible times such that <inline-formula id="pcbi.1004488.e026"><alternatives><graphic id="pcbi.1004488.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e026"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>τ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mo stretchy="false">[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>𝓢</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&gt;</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. When the input vector is updated with optimal input conditions, <inline-formula id="pcbi.1004488.e027"><alternatives><graphic id="pcbi.1004488.e027g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e027"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the input time, <inline-formula id="pcbi.1004488.e028"><alternatives><graphic id="pcbi.1004488.e028g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e028"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is moved from the set 𝓣<sub><italic>k</italic>−1</sub> to the set 𝓢<sub><italic>k</italic>−1</sub>. This process continues iteratively, and the input vector is updated until 𝓣 is empty or no input magnitude change improves the value of TDU<sub><italic>k</italic>−1</sub> as shown in <xref ref-type="fig" rid="pcbi.1004488.g001">Fig 1(b)</xref>.</p>
<p specific-use="line"><bold>Algorithm 1</bold> Algorithm for Selecting <inline-formula id="pcbi.1004488.e029"><alternatives><graphic id="pcbi.1004488.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e029"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>u</mml:mi> <mml:msub><mml:mo>*</mml:mo> <mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
<p specific-use="line"><bold>Input:</bold> <italic>τ</italic><sub><italic>j</italic></sub>, <bold><italic>u</italic></bold><sub><italic>min</italic></sub>,<bold><italic>u</italic></bold><sub><italic>max</italic></sub>, <italic>δ</italic> <bold><italic>u</italic></bold>, 𝓢<sub><italic>k</italic>−1</sub>, 𝓣<sub><italic>k</italic>−1</sub>, <bold>u</bold>*<sub><italic>k</italic>−1</sub></p>
<p specific-use="line"><bold>Output:</bold> <inline-formula id="pcbi.1004488.e030">
<alternatives>
<graphic id="pcbi.1004488.e030g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e030"/>
<mml:math id="M30" display="inline" overflow="scroll">
<mml:mrow>
<mml:msubsup>
<mml:mi mathvariant="bold-italic">u</mml:mi>
<mml:mi>j</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula> and corresponding TDU<sup><italic>j</italic></sup></p>
<p specific-use="line"> <bold>for</bold> p = 1:<italic>N</italic><sub><italic>u</italic></sub> <bold>do</bold> (Note: <italic>N</italic><sub><italic>u</italic></sub> = number of possible input magnitudes)</p>
<p specific-use="line">  1. Define <inline-formula id="pcbi.1004488.e031"><alternatives><graphic id="pcbi.1004488.e031g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e031"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mi>j</mml:mi> <mml:mi>p</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo> <mml:mi>δ</mml:mi> <mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
<p specific-use="line">  2. Simulate dynamics with <bold>u</bold> = <bold><italic>u</italic></bold><sub><italic>p</italic></sub> for <italic>τ</italic><sub><italic>j</italic></sub> ≤ <italic>t</italic> &lt; <italic>τ</italic>′ where <italic>τ</italic>′ = <italic>min</italic>[<italic>t</italic> ∈ 𝓢<sub><italic>k</italic>−1</sub>∣<italic>t</italic> &gt; <italic>τ</italic><sub><italic>j</italic></sub>]</p>
<p specific-use="line">  3. Determine an associated measurement pair: <italic>m</italic><sub><italic>k</italic></sub> ∈ <italic>n</italic><sub><italic>m</italic></sub> and <italic>t</italic><sub><italic>k</italic></sub> ∈ 𝕋. <italic>See</italic> <xref ref-type="disp-formula" rid="pcbi.1004488.e035">Eq (15)</xref></p>
<p specific-use="line">  4. Update uncertain parameter probabilities given data for (<italic>m</italic><sub><italic>k</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>). <italic>See</italic> <xref ref-type="disp-formula" rid="pcbi.1004488.e036">Eq (16)</xref></p>
<p specific-use="line">  5. Estimate variance of target states, <bold>x</bold><sub><bold>T</bold></sub>, with target input, <bold>u</bold><sub><bold>T</bold></sub>, using updated uncertain parameter</p>
<p specific-use="line">  probabilities</p>
<p specific-use="line">  6. Calculate TDU<sup><italic>p</italic></sup>. <italic>See</italic> <xref ref-type="disp-formula" rid="pcbi.1004488.e010">Eq (5)</xref></p>
<p specific-use="line"><bold>end for</bold></p>
<p specific-use="line"><inline-formula id="pcbi.1004488.e054"><alternatives><graphic id="pcbi.1004488.e054g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e054"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mo>*</mml:mo> </mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mtext mathvariant="normal">argmin</mml:mtext> <mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi> <mml:mi>u</mml:mi> </mml:msub><mml:mo>}</mml:mo></mml:mrow> </mml:munder></mml:mrow></mml:math></alternatives></inline-formula> TDU<sup><italic>p</italic></sup>. <italic>See</italic> <xref ref-type="disp-formula" rid="pcbi.1004488.e011">Eq (6)</xref></p>
<p specific-use="line">
<inline-formula id="pcbi.1004488.e032">
<alternatives>
<graphic id="pcbi.1004488.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e032"/>
<mml:math id="M32" display="inline" overflow="scroll">
<mml:mrow>
<mml:msubsup>
<mml:mi mathvariant="bold-italic">u</mml:mi>
<mml:mi>j</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mi mathvariant="bold-italic">u</mml:mi>
<mml:mi>j</mml:mi>
<mml:msup>
<mml:mi>p</mml:mi>
<mml:mo>*</mml:mo>
</mml:msup>
</mml:msubsup>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
</p>
<p specific-use="line">TDU<sup><italic>j</italic></sup> = TDU<sup><italic>p</italic>*</sup></p>
<sec id="sec009">
<title>Determine an Associated Measurement Pair</title>
<p>Given an input vector, <bold>u</bold> ∈ ℝ<sup><italic>n</italic><sub><italic>u</italic></sub>∗<italic>N</italic></sup>, a measurement pair is selected from the feasible measurement space defined by the <inline-formula id="pcbi.1004488.e033"><alternatives><graphic id="pcbi.1004488.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e033"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>h</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> entry in the <bold>y</bold> vector at a specific sample time point, <italic>t</italic><sub><italic>k</italic></sub>. This pair is selected as the one that maximizes a Hampel smoothed distinguishability metric. We smooth the function of the distinguishability metric, <italic>ξ</italic>(<italic>t</italic>), over time using a Hampel identifier, Γ<sub><italic>Hampel</italic></sub>(•), to remove outliers and smooth the grid approximation (when used). The distinguishability metric quantifies the ability of an experiment to resolve the dynamics and is defined as:
<disp-formula id="pcbi.1004488.e034"><alternatives><graphic id="pcbi.1004488.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e034"/><mml:math id="M34" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ξ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>Γ</mml:mo> <mml:mrow><mml:mi>H</mml:mi> <mml:mi>a</mml:mi> <mml:mi>m</mml:mi> <mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>Var</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>E</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
where <italic>ξ</italic><sub><italic>i</italic></sub>(<italic>t</italic>) is the output’s distinguishability metric for the for the <italic>i</italic><sup><italic>th</italic></sup> measurable model output at each possible measurement time point. <italic>E</italic>(<italic>σ</italic><sub><italic>i</italic></sub>(<bold>u</bold>, <italic>t</italic>))<sup>2</sup> reflects the expected experimental noise of a measurement. If the experimental measurement noise is not available prior to running the experiments, we estimate the noise with an error model adopted from [<xref ref-type="bibr" rid="pcbi.1004488.ref014">14</xref>] as shown in <xref ref-type="table" rid="pcbi.1004488.t001">Table 1</xref>. The optimal measurement pair satisfies:
<disp-formula id="pcbi.1004488.e035"><alternatives><graphic id="pcbi.1004488.e035g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e035"/><mml:math id="M35" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">argmax</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>𝕋</mml:mo></mml:mrow></mml:munder> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
where <italic>m</italic><sub><italic>k</italic></sub> is the <italic>i</italic><sup><italic>th</italic></sup> species of <bold>y</bold> and <italic>t</italic><sub><italic>k</italic></sub> is the sample time point.</p>
<p>This distinguishability metric is similar to the one introduced in [<xref ref-type="bibr" rid="pcbi.1004488.ref013">13</xref>] with the exception of the Hampel smoothing and the probability weights which were added to smooth the approximations for smaller numbers of sampled uncertain parameters as described in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004488.e016">8</xref>) to (<xref ref-type="disp-formula" rid="pcbi.1004488.e019">11</xref>). The key point is that we focus on selecting measurements to distinguish dynamics rather than parameters. Hence, probability weights, <italic>p</italic>(<italic>θ</italic>′), are induced from a probability on dynamics in a way that will allow us to sample uniformly in dynamical space. This enables us to calculate the expected values and variances in <xref ref-type="disp-formula" rid="pcbi.1004488.e034">Eq (14)</xref> over the experimentally distinguishable dynamics in a computationally efficient manner.</p>
</sec>
<sec id="sec010">
<title>Update Uncertain Parameter Probabilities</title>
<p>Given the optimal measurement pairs (<italic>m</italic><sub><italic>k</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>), we use data that corresponds to the measurement point to assign and update parameter probability weights. Each of the uncertain parameters, <bold><italic>θ</italic></bold>′ ∈ Ω<sub><italic>RA</italic></sub>, is assigned a probability weight to reflect the confidence given the simulation fitness for various scenarios. Herein, the priors of these probability weights are initially assigned uniformly across <bold><italic>θ</italic></bold>′ ∈ Ω<sub><italic>RA</italic></sub> and updated following Bayes theorem:
<disp-formula id="pcbi.1004488.e036"><alternatives><graphic id="pcbi.1004488.e036g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e036"/><mml:math id="M36" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula> <disp-formula id="pcbi.1004488.e037"><alternatives><graphic id="pcbi.1004488.e037g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e037"/><mml:math id="M37" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
The posterior parameter probability, <inline-formula id="pcbi.1004488.e038"><alternatives><graphic id="pcbi.1004488.e038g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e038"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, under the observation is given by the prior probability, <italic>p</italic>(<bold><italic>θ</italic></bold>′), and the likelihood function, <inline-formula id="pcbi.1004488.e039"><alternatives><graphic id="pcbi.1004488.e039g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e039"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, normalized by the normalizing constant, <inline-formula id="pcbi.1004488.e040"><alternatives><graphic id="pcbi.1004488.e040g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e040"/><mml:math id="M40" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> which is approximated in <xref ref-type="disp-formula" rid="pcbi.1004488.e037">Eq (17)</xref>. <inline-formula id="pcbi.1004488.e041"><alternatives><graphic id="pcbi.1004488.e041g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e041"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the data of the <italic>i</italic><sup><italic>th</italic></sup> measurement species at the specific time point <italic>t</italic><sub><italic>k</italic></sub> collected under the application of the input <bold>u</bold>. If experimental data is available, then <inline-formula id="pcbi.1004488.e042"><alternatives><graphic id="pcbi.1004488.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e042"/><mml:math id="M42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the observed data. However, for our parallel design, we make predictions of the data for the selected measurement point since data is not available until the experiment design is over. In this case, <inline-formula id="pcbi.1004488.e043"><alternatives><graphic id="pcbi.1004488.e043g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e043"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the prediction of the data for the selected species at the particular time point. With the design of multiple measurements employed in this method, data is predicted with a scenario tree design as described below and the likelihood of the predicted data is assumed to follow a Gaussian distribution:
<disp-formula id="pcbi.1004488.e044"><alternatives><graphic id="pcbi.1004488.e044g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e044"/><mml:math id="M44" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>E</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>E</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where <italic>y</italic><sub><italic>i</italic></sub>(<bold>u</bold>, <bold><italic>θ</italic></bold>′, <italic>t</italic><sub><italic>k</italic></sub>)) is the model simulation of the dynamics of the model at the selected measurement point (<italic>m</italic><sub><italic>k</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) with the parameter <bold><italic>θ</italic></bold>′ under the input <bold>u</bold>.</p>
</sec>
</sec>
<sec id="sec011">
<title>Specifying Multiple Measurement Pairs</title>
<p>Our design can identify multiple informative measurements given an optimal selected input vector, <bold>u</bold>*, as shown in <xref ref-type="fig" rid="pcbi.1004488.g001">Fig 1(c)</xref>. We use an adaptation of the measurement scenario tree method [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>] which makes multiple predictions of the data value from a given measurement point to allow the next informative point to be selected. In this work, we introduce the use of prior/posterior probability updates to minimize the bias due to outliers. The use of probabilities also enables the algorithm to work well with a smaller number of sampled uncertain parameters than previously, contributing to the computational efficiency. As in [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>], a measurement scenario tree is initialized by a node which defines the first optimal measurement point. At each node, we determine the optimal sampling time point according to <xref ref-type="disp-formula" rid="pcbi.1004488.e035">Eq (15)</xref> to maximize the distinguishability metric for each measurable species. Our MBDOE algorithm selects the measurement pair that minimizes the TDU according to <xref ref-type="disp-formula" rid="pcbi.1004488.e010">Eq (5)</xref> as the optimal measurement pair for that node. Subsequent measurements (nodes) are chosen by considering three different scenarios (branches) from the node. These scenarios arise by predicting three possible outcomes for the measurement pair: previously these were defined by the minimum, mean, and maximum predicted measurement values. Herein, the cumulative distribution function is computed from the priors to span from the minimum to maximum predicted data values for that measurement pair. The three predicted possible outcomes are the simulated values at the measurement pairs that correspond to the 10<sup><italic>th</italic></sup>,50<sup><italic>th</italic></sup>, and 90<sup><italic>th</italic></sup> percentiles. Using each of these predicted possible outcomes to approximate the data, <inline-formula id="pcbi.1004488.e045"><alternatives><graphic id="pcbi.1004488.e045g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e045"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">u</mml:mtext> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the posterior for each branch are updated for the <bold><italic>θ</italic></bold>′ ∈ Ω<sub><italic>RA</italic></sub> as in <xref ref-type="disp-formula" rid="pcbi.1004488.e036">Eq (16)</xref>. Given the updated branch specific priors, the measurement pair specifying the next node in each branch is determined by the optimal measurement pair selected to minimize <xref ref-type="disp-formula" rid="pcbi.1004488.e010">Eq (5)</xref> assuming the estimated posterior is the prior. This process is continued until the tree structure contains at least the specified number of unique measurements. The minimum number of levels in the tree is <italic>log</italic><sub>3</sub>(<italic>K</italic>)+1 where <italic>K</italic> is the user-specified desired number of measurements.</p>
</sec>
<sec id="sec012">
<title>Computational Efficiency Afforded by Sparse Grid</title>
<p>Evaluating all possible experiments over the design space, 𝔻, using model simulations for a large uncertain parameter space, Ω, is computationally prohibitive. The sparse grid tool offers an efficient way to approximate the system’s output dynamics using interpolating polynomials by sampling an uncertain space in a systematic way to create a surrogate model for the system. The grid approximation is then used to interpolate additional points on the uncertain space without the cost of directly simulating the model.</p>
<sec id="sec013">
<title>Sparse grid Interpolation over Uncertain Parameter Space</title>
<p>A sparse grid approximation of the dynamics of the measured states over the uncertain parameter space is created using the process described previously [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>]. With the sparse grid interpolant, points are sampled from Ω using LHS and their corresponding model output are approximated by:
<disp-formula id="pcbi.1004488.e046"><alternatives><graphic id="pcbi.1004488.e046g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e046"/><mml:math id="M46" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:msub><mml:mi mathvariant="bold">y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">T</mml:mi> <mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pcbi.1004488.e047"><alternatives><graphic id="pcbi.1004488.e047g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e047"/><mml:math id="M47" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mo>⋅</mml:mo> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the estimated value at time t for the <italic>i</italic><sup><italic>th</italic></sup> model output and <inline-formula id="pcbi.1004488.e048"><alternatives><graphic id="pcbi.1004488.e048g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e048"/><mml:math id="M48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mtext mathvariant="bold">y</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mrow><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mtext mathvariant="bold-italic">θ</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mtext mathvariant="bold">T</mml:mtext> <mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a vector of the <italic>i</italic><sup><italic>th</italic></sup> model output sampled at time points, <inline-formula id="pcbi.1004488.e049"><alternatives><graphic id="pcbi.1004488.e049g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e049"/><mml:math id="M49" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold">T</mml:mtext> <mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, specified by the time-interpolating vector for the uncertain parameters, <bold><italic>θ</italic></bold>′. Herein, the <italic>L</italic><sub><italic>d</italic>, <italic>q</italic></sub> are Lagrange polynomials where the degree <italic>d</italic> can be increased to improve the accuracy of the interpolant approximation while ensuring computational efficiency and q is used as the index to builds the polynomial, 0 &lt; <italic>q</italic> &lt; <italic>d</italic>.</p>
</sec>
<sec id="sec014">
<title>Sparse grid Interpolation over Input Space</title>
<p>If the number of all possible input combinations exceed the maximum number of grid nodes predicted to create the sparse grid interpolation, the sparse grid interpolation tool is used to approximate the model dynamics over the input space. The sparse grid interpolant is sampled at the <italic>N</italic><sub><italic>u</italic></sub> possible input magnitudes and the corresponding model outputs are approximated for each <bold><italic>θ</italic></bold>′ ∈ Ω<sub><italic>RA</italic></sub> by:
<disp-formula id="pcbi.1004488.e050"><alternatives><graphic id="pcbi.1004488.e050g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e050"/><mml:math id="M50" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:msub><mml:mi mathvariant="bold">y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">u</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">T</mml:mi> <mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
The interpolated dynamics are used to characterize the experimental distinguishability metric (<xref ref-type="disp-formula" rid="pcbi.1004488.e034">Eq (14)</xref>) for each of the <italic>N</italic><sub><italic>u</italic></sub> possible input magnitudes.</p>
</sec>
</sec>
<sec id="sec015">
<title>Computational Implementation Details</title>
<p>The algorithm was coded in MATLAB (2013a). The Sparse Grid toolbox (v5.1.1) was obtained from <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.ians.uni-stuttgart.de/spinterp">http://www.ians.uni-stuttgart.de/spinterp</ext-link> [<xref ref-type="bibr" rid="pcbi.1004488.ref040">40</xref>] and integrated with our model-based experiment design algorithm. We minimize the error due to inaccurate interpolants by specifying the termination conditions based on their depth or by the relative or absolute errors of 10% and 5 respectively. The max depth is set to 3 and 5 for the parameter screening and focused grids, respectively, and 5 for the input grid. We set the data-consistent acceptability threshold <italic>T</italic><sub><italic>A</italic></sub> = 2, which correspond to two standard deviations. The Hes1 and T-cell receptor models for the results were numerically integrated using the stiff ode solver ode15s with the default settings. To increase computational efficiency, the sparse grid code and the mathematical models were vectorized. The code was run on four 8-core Intel Xeon 3.4 GHz CPUs each with 16 GB of memory and running the Windows 2003 server platform with the MATLAB Parallel Computing Toolbox. Our input design MBDOE algorithm code is available upon request from the corresponding author.</p>
<p>An upper bound on the number of model simulations used by our MBDOE algorithm can be approximated by:
<disp-formula id="pcbi.1004488.e051"><alternatives><graphic id="pcbi.1004488.e051g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e051"/><mml:math id="M51" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>v</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mi>S</mml:mi> <mml:msub><mml:mi>G</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>A</mml:mi></mml:msub></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mo>+</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:msub><mml:mi>G</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub> <mml:mo>×</mml:mo> <mml:mfrac><mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mo>+</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>A</mml:mi></mml:mrow></mml:msub> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <italic>SG</italic><sub><italic>θ</italic></sub> and <italic>SG</italic><sub><italic>u</italic></sub> are the number of model simulations (nodes) used to create sparse grid interpolants over the uncertain parameter and input space, respectively. An upper bound estimate of these values can be calculated using a Sparse Grid toolbox function, <italic>spdim(maxDepth, Dim)</italic> assuming the maximum possible depth and the dimension of the uncertain parameter or input space. The number of simulations required to build an accurate interpolant may be quite a bit lower than this approximation when the model is smooth over the uncertain parameter and/or input space. The terms of this upper bound approximation are mapped to the steps of <xref ref-type="fig" rid="pcbi.1004488.g001">Fig 1</xref>. The (a) term of <xref ref-type="disp-formula" rid="pcbi.1004488.e051">Eq (21)</xref> is the total number of model simulations used to identify the representative parameters. The second term, (b), is the number of simulations that determine the optimal input vector. For this approximation, the sparse interpolant on the input space is only created if the estimated maximum number of nodes, <italic>SG</italic><sub><italic>u</italic></sub> required is less than <italic>N</italic><sub><italic>u</italic></sub>. Furthermore, we assume a worst case scenario where the input magnitude changes at all <italic>N</italic> admissible times resulting in the fraction, <inline-formula id="pcbi.1004488.e052"><alternatives><graphic id="pcbi.1004488.e052g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e052"/><mml:math id="M52" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. The third term, (c), is the number of model simulations used create the scenario tree to determine the measurement pairs.</p>
</sec>
</sec>
<sec id="sec016" sec-type="results">
<title>Results</title>
<sec id="sec017">
<title>3-Dimensional Problem: The Hes1 Model</title>
<p>To illustrate the effectiveness of our MBDOE strategy to resolve dynamical uncertainty of a target system, we use a simple Hes1 oscillator toy model [<xref ref-type="bibr" rid="pcbi.1004488.ref041">41</xref>]. This example demonstrates how an optimal perturbation enhances the ability of the MBDOE to reduce the dynamical uncertainty. The Hes1 model was previously used to demonstrate a Bayesian design of experiments strategy [<xref ref-type="bibr" rid="pcbi.1004488.ref016">16</xref>]. This model describes the changes in the level of the Hes1 transcription factor that is important in somitogenesis. It is modeled with an ODE system that describes the changes of the levels of the Hes1 mRNA, <italic>m</italic>, the cytosolic protein, <italic>P</italic><sub>1</sub>, and the nuclear protein, <italic>P</italic><sub>2</sub>, as shown:
<disp-formula id="pcbi.1004488.e053"><alternatives><graphic id="pcbi.1004488.e053g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004488.e053"/><mml:math id="M53" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>m</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>k</mml:mi> <mml:mi>m</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:msub><mml:mi>P</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>h</mml:mi></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>k</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>ν</mml:mi> <mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>k</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>P</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
A description of the parameters of the model and their nominal values are listed in <xref ref-type="table" rid="pcbi.1004488.t002">Table 2</xref>. The degradation rate, <italic>k</italic>, and protein transport rate, <italic>k</italic><sub>1</sub>, are assumed to be known and their values are set to the nominal value while the rest of the parameters are considered unknown. The uncertain parameter space, Ω, is initially set to have bounds of 0.1 and 10 times previously reported nominal parameter values.</p>
<table-wrap id="pcbi.1004488.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.t002</object-id>
<label>Table 2</label>
<caption>
<title>Hes1 model parameters and definitions.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004488.t002g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.t002"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Symbol</th>
<th align="center" rowspan="1" colspan="1">Parameter Description</th>
<th align="center" rowspan="1" colspan="1">Nominal value</th>
<th align="center" rowspan="1" colspan="1">Parameter Range</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1"><italic>k</italic></td>
<td align="center" rowspan="1" colspan="1">degradation rate</td>
<td align="center" rowspan="1" colspan="1">0.03 min<sup>−1</sup></td>
<td align="center" rowspan="1" colspan="1">fixed</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"><italic>k</italic><sub>1</sub></td>
<td align="center" rowspan="1" colspan="1">transport rate of protein</td>
<td align="center" rowspan="1" colspan="1">0.16<italic>min</italic><sup>−1</sup></td>
<td align="center" rowspan="1" colspan="1">fixed</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"><italic>P</italic><sub>0</sub></td>
<td align="center" rowspan="1" colspan="1">regulatory transcription level of protein</td>
<td align="center" rowspan="1" colspan="1">2.4</td>
<td align="center" rowspan="1" colspan="1">0.24—24</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"><italic>h</italic></td>
<td align="center" rowspan="1" colspan="1">Hill type coefficient</td>
<td align="center" rowspan="1" colspan="1">2</td>
<td align="center" rowspan="1" colspan="1">0.2—20</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"><italic>ν</italic></td>
<td align="center" rowspan="1" colspan="1">rate of mRNA transcription</td>
<td align="center" rowspan="1" colspan="1">2.5 × 10<sup>−2</sup> <italic>min</italic><sup>−1</sup></td>
<td align="center" rowspan="1" colspan="1">2.5 × 10<sup>−3</sup>−2.5 × 10<sup>−1</sup></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The experimental design space is 𝔻, partially defined by an input <italic>α</italic> ∈ 𝕌 that modifies the transport rate, <italic>k</italic><sub>1</sub>, as <italic>α</italic> × <italic>k</italic><sub>1</sub> where 𝕌 = [0.01,2] with a <italic>δu</italic> = 0.05. The input magnitude can be changed at admissible times, 𝓣 = {0,2,5,8,10,50,100,150,200} min. In this example, <italic>u</italic><sub><italic>b</italic></sub>, is set to <italic>α</italic> = 1 ∀<italic>τ</italic> ∈ 𝓣. The allowable measurement state space includes the Hes1 mRNA, <italic>m</italic>, and the total protein concentration, <italic>P</italic><sub>1</sub>+<italic>P</italic><sub>2</sub>. The allowable sampling time space 𝕋 = [0, 300] min was defined to specify measurements with a <italic>δt</italic> = 10 min. We want the algorithm to specify a minimum of 8 distinct measurements. The experiment is designed to decrease the dynamical uncertainty on three target states, <italic>m</italic>, <italic>P</italic><sub>1</sub>, and <italic>P</italic><sub>2</sub> under a target input <italic>α</italic> = 1 applied for the simulated time period.</p>
<p>To evaluate the MBDOE algorithm <italic>in silico</italic>, we simulate a plant model for which we want to reduce the dynamical uncertainty. The plant model is initially simulated with unknown model parameters set at the nominal values shown in <xref ref-type="table" rid="pcbi.1004488.t002">Table 2</xref>. We generate 6 initial measurements of both mRNA, <italic>m</italic>, and total protein concentration, <italic>P</italic><sub>1</sub>+<italic>P</italic><sub>2</sub>, at times <italic>t</italic> = 10,20,60 min with 10% additive Gaussian noise.</p>
<p>Initial data identify the acceptable parameter space, Ω<sub><italic>A</italic></sub>, that is consistent with the data as defined by <xref ref-type="disp-formula" rid="pcbi.1004488.e012">Eq (7)</xref>. The resulting optimal experiment design is in <xref ref-type="table" rid="pcbi.1004488.t003">Table 3</xref>. The optimal input sequence is specified by <italic>α</italic> values shown in <xref ref-type="fig" rid="pcbi.1004488.g002">Fig 2a</xref> and associated predicted measurements are shown on <xref ref-type="fig" rid="pcbi.1004488.g002">Fig 2b</xref>, superimposed on the representative dynamics for the measurable species to illustrate their connection with uncertainty. The greedy algorithm for the input selection is shown in <xref ref-type="table" rid="pcbi.1004488.t004">Table 4</xref> showing each iteration of input selection with the progressive predicted reduction in TDU values. The initial uncertainty and final uncertainty in the dynamics of the target states are superimpossed in <xref ref-type="fig" rid="pcbi.1004488.g002">Fig 2c</xref> to demonstrate the reduction of the region of uncertainty of the dynamics. The dynamical uncertainty regions associated with the mRNA, <italic>P</italic><sub>1</sub>, <italic>P</italic><sub>2</sub> target states are reduced by 84%, 81% and 86%, respectively. In all cases, this reduced uncertainty region enclose the true dynamics of the system.</p>
<table-wrap id="pcbi.1004488.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.t003</object-id>
<label>Table 3</label>
<caption>
<title>Optimal Experiment Design for Hes1 Example.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004488.t003g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.t003"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Time Step</th>
<th align="center" rowspan="1" colspan="1">Action under MBDOE design</th>
<th align="center" rowspan="1" colspan="1">Scenario Tree Level</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1">T = 0 mins</td>
<td align="center" rowspan="1" colspan="1">Apply <italic>α</italic> = 0.1</td>
<td align="center" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 2 mins</td>
<td align="center" rowspan="1" colspan="1">Apply <italic>α</italic> = 1.9</td>
<td align="center" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"/>
<td align="center" rowspan="1" colspan="1">Measure P1+P2</td>
<td align="center" rowspan="1" colspan="1">2<sup><italic>nd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 40 mins</td>
<td align="center" rowspan="1" colspan="1">Measure mRNA</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"/>
<td align="center" rowspan="1" colspan="1">Apply <italic>α</italic> = 0.3</td>
<td align="center" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 50 mins</td>
<td align="center" rowspan="1" colspan="1">Measure mRNA</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 70 mins</td>
<td align="center" rowspan="1" colspan="1">Measure mRNA</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 80 mins</td>
<td align="center" rowspan="1" colspan="1">Measure mRNA</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"/>
<td align="center" rowspan="1" colspan="1">Apply <italic>α</italic> = 0.35</td>
<td align="center" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 100 mins</td>
<td align="center" rowspan="1" colspan="1">Measure P1+P2</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 120 mins</td>
<td align="center" rowspan="1" colspan="1">Measure mRNA</td>
<td align="center" rowspan="1" colspan="1">1<sup><italic>st</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 130 mins</td>
<td align="center" rowspan="1" colspan="1">Measure P1+P2</td>
<td align="center" rowspan="1" colspan="1">2<sup><italic>nd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 140 mins</td>
<td align="center" rowspan="1" colspan="1">Measure mRNA</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 150 mins</td>
<td align="center" rowspan="1" colspan="1">Apply <italic>α</italic> = 0.75</td>
<td align="center" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 180 mins</td>
<td align="center" rowspan="1" colspan="1">Measure P1+P2</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"/>
<td align="center" rowspan="1" colspan="1">Measure P1+P2</td>
<td align="center" rowspan="1" colspan="1">2<sup><italic>nd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 190 mins</td>
<td align="center" rowspan="1" colspan="1">Measure P1+P2</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 200 mins</td>
<td align="center" rowspan="1" colspan="1">Apply <italic>α</italic> = 0.95</td>
<td align="center" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 210 mins</td>
<td align="center" rowspan="1" colspan="1">Measure mRNA</td>
<td align="center" rowspan="1" colspan="1">3<sup><italic>rd</italic></sup></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1004488.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.g002</object-id>
<label>Fig 2</label>
<caption>
<title>An illustration of the optimal experiment design for the Hes1 example.</title>
<p>(<bold>a</bold>) The input sequence selected by the design for the duration of the experiment. (<bold>b</bold>) Model simulation of the output dynamics of the measurable species <italic>m</italic> and <italic>P</italic><sub>1</sub>+<italic>P</italic><sub>2</sub> under an optimal input simulated with Ω<sub><italic>RA</italic></sub>. The red dots specify the selected optimal measurement points which are the mean values generated using nominal plant with additive 10% Gaussian noise. Error bars are also given by the standard deviation of the simulated data (three data points are generated for each time point). (<bold>c</bold>) The initial (grey) and final (blue) uncertainty in the target states dynamics. The designed experiment reduces the uncertainty region by 84%,81%, and 86% for mRNA, <italic>P</italic><sub>1</sub>, and <italic>P</italic><sub>2</sub>, respectively. The red line shows the simulated dynamics of the nominal plant.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.g002"/>
</fig>
<table-wrap id="pcbi.1004488.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.t004</object-id>
<label>Table 4</label>
<caption>
<title>Greedy Method for Hes1 Input Vector Design.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004488.t004g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.t004"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Iteration</th>
<th align="center" rowspan="1" colspan="1">min(TDU)</th>
<th align="center" rowspan="1" colspan="1"><italic>τ</italic>*</th>
<th align="center" rowspan="1" colspan="1"><italic>u</italic>*</th>
<th align="center" rowspan="1" colspan="1">u at time 𝓣 = {0 2 5 8 10 50 100 150 200}</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1">0</td>
<td align="center" rowspan="1" colspan="1">−</td>
<td align="center" rowspan="1" colspan="1">−</td>
<td align="center" rowspan="1" colspan="1">−</td>
<td align="center" rowspan="1" colspan="1">[1 1 1 1 1 1 1 1 1]</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">1</td>
<td align="center" rowspan="1" colspan="1">11.5191</td>
<td align="center" rowspan="1" colspan="1">50</td>
<td align="center" rowspan="1" colspan="1">0.3</td>
<td align="center" rowspan="1" colspan="1">[1 1 1 1 1 0.3 0.3 0.3 0.3]</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">2</td>
<td align="center" rowspan="1" colspan="1">10.7718</td>
<td align="center" rowspan="1" colspan="1">0</td>
<td align="center" rowspan="1" colspan="1">0.1</td>
<td align="center" rowspan="1" colspan="1">[0.1 0.1 0.1 0.1 0.1 0.1 0.3 0.3 0.3 0.3]</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">3</td>
<td align="center" rowspan="1" colspan="1">7.8597</td>
<td align="center" rowspan="1" colspan="1">2</td>
<td align="center" rowspan="1" colspan="1">1.9</td>
<td align="center" rowspan="1" colspan="1">[0.1 1.9 1.9 1.9 1.9 1.9 0.3 0.3 0.3 0.3]</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">4</td>
<td align="center" rowspan="1" colspan="1">7.6381</td>
<td align="center" rowspan="1" colspan="1">100</td>
<td align="center" rowspan="1" colspan="1">0.35</td>
<td align="center" rowspan="1" colspan="1">[0.1 1.9 1.9 1.9 1.9 1.9 0.3 0.35 0.35 0.35]</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">5</td>
<td align="center" rowspan="1" colspan="1">1.1810</td>
<td align="center" rowspan="1" colspan="1">150</td>
<td align="center" rowspan="1" colspan="1">0.75</td>
<td align="center" rowspan="1" colspan="1">[0.1 1.9 1.9 1.9 1.9 1.9 0.3 0.35 0.75 0.75]</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">6</td>
<td align="center" rowspan="1" colspan="1">0.5849</td>
<td align="center" rowspan="1" colspan="1">200</td>
<td align="center" rowspan="1" colspan="1">0.95</td>
<td align="center" rowspan="1" colspan="1">[0.1 1.9 1.9 1.9 1.9 1.9 0.3 0.35 0.75 0.95]</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The measurement pairs are shown in the scenario tree in <xref ref-type="fig" rid="pcbi.1004488.g003">Fig 3a</xref>. the nodes of the tree specify the measurements that maximize uncertainty in the measurable species, <italic>ξ</italic>, while minimizing the TDU, <italic>γ</italic>, under the optimal input sequence, <bold>u*</bold>. In general, the values of <italic>ξ</italic> and <italic>γ</italic> decrease as you move down the tree and the predicted dynamics are constrained. To investigate how the measurement pairs contribute to the reduction of uncertainty in the dynamics of the target system, the total, <italic>γ</italic>, and individual variances are estimated assuming each predicted measurement has been taken (moving down and from left to right along the tree, neglecting repeated measurements). These results are shown in <xref ref-type="fig" rid="pcbi.1004488.g003">Fig 3b and 3c</xref>. These figures show that the first five unique measurements from the tree are necessary to resolve the target system dynamics.</p>
<fig id="pcbi.1004488.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Supporting details of optimal experiment design for Hes1 example.</title>
<p>(<bold>a</bold>) The measurement scenario tree representation for selecting optimal measurements. Each node defines, the measurement pairs with the predicted value of the distinguishability metric, <italic>ξ</italic>, target dynamical uncertainty, <italic>γ</italic>, and three estimated measurement values from simulation, G1, G2, and G3. The path along the scenario tree with predictions closest to the data from the nominal plant is shown in red. (<bold>b</bold>) Reduction of TDU and (<bold>c</bold>) individual variance of target states with each additional unique measurement from the scenario tree.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.g003"/>
</fig>
<p>To further explore the optimality of our MBDOE algorithm, we compare our results achieved with <bold>u</bold>* and <italic>M</italic>* to those of measurement only MBDOE. For this comparison, the measurement only MBDOE determined the optimal measurements, <italic>M</italic><sub><italic>T</italic></sub>, assuming the applied input was the target input, <bold>u</bold><sub><bold>T</bold></sub>. These results are summarized in <xref ref-type="table" rid="pcbi.1004488.t005">Table 5</xref> by the percentage reduction in the uncertain dynamical region for each target species and TDU. Our MBDOE algorithm outperforms all other experiment design combinations based on the TDU reduction. Although our MBDOE design is not the best in reducing the uncertain dynamical region for all target states, the results are comparable. The supplemental material contains the figures showing the uncertain dynamical regions for all measurement and input combinations in the Table. The supplemental material also contains figures that indicate the ability of our MBDOE algorithm to reduce the uncertain dynamical regions for different parameterizations of the Hes1 plant model.</p>
<table-wrap id="pcbi.1004488.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.t005</object-id>
<label>Table 5</label>
<caption>
<title>Comparison of Optimal Input MBDOE with Measurement Only MBDOE for the Hes1 Model.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004488.t005g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.t005"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2" colspan="1">Input Applied</th>
<th align="center" rowspan="2" colspan="1">Measurements</th>
<th align="center" colspan="4" rowspan="1">% Uncertainty Reduction</th>
</tr>
<tr>
<th align="center" rowspan="1" colspan="1">m</th>
<th align="center" rowspan="1" colspan="1"><italic>P</italic><sub>1</sub></th>
<th align="center" rowspan="1" colspan="1"><italic>P</italic><sub>2</sub></th>
<th align="center" rowspan="1" colspan="1">TDU, <italic>γ</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1"><bold>u</bold>*</td>
<td align="center" rowspan="1" colspan="1"><italic>M</italic>*</td>
<td align="center" rowspan="1" colspan="1">84%</td>
<td align="center" rowspan="1" colspan="1">81%</td>
<td align="center" rowspan="1" colspan="1">86%</td>
<td align="center" rowspan="1" colspan="1">84.6%</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"><bold>u</bold><sub><bold>T</bold></sub></td>
<td align="center" rowspan="1" colspan="1"><italic>M</italic><sub><italic>T</italic></sub></td>
<td align="center" rowspan="1" colspan="1">75%</td>
<td align="center" rowspan="1" colspan="1">68%</td>
<td align="center" rowspan="1" colspan="1">81%</td>
<td align="center" rowspan="1" colspan="1">77%</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"><bold>u</bold>*</td>
<td align="center" rowspan="1" colspan="1"><italic>M</italic><sub><italic>T</italic></sub></td>
<td align="center" rowspan="1" colspan="1">86%</td>
<td align="center" rowspan="1" colspan="1">82%</td>
<td align="center" rowspan="1" colspan="1">83%</td>
<td align="center" rowspan="1" colspan="1">84.2%</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1"><bold>u</bold><sub><bold>T</bold></sub></td>
<td align="center" rowspan="1" colspan="1"><italic>M*</italic></td>
<td align="center" rowspan="1" colspan="1">80%</td>
<td align="center" rowspan="1" colspan="1">79%</td>
<td align="center" rowspan="1" colspan="1">82%</td>
<td align="center" rowspan="1" colspan="1">80.8%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The computational efficiency of this MBDOE method partially arises from the use of an interpolation as a surrogate of the model to reduce numerical integration of ODEs. The sparse grid terminated with a relative accuracy of 0.7% with an absolute tolerance of 0.9. The algorithm required only 137 model evaluations to build an interpolant which was sampled 10,000 times to identify 3852 acceptable parameters where <italic>N</italic><sub><italic>A</italic></sub> = 2000. The algorithm selected 48 representative parameters, <italic>N</italic><sub><italic>RA</italic></sub> = 48, to span the distinguishable dynamics generated by the acceptable parameters. For the input design, separate 1-D sparse grids are constructed for each admissible time of input change with 9 nodes. The total number model evaluation used for the complete experiment design is 18,716 where 2137 were for finding the representative parameters, 16,531 were used for the input selection, and 48 were used for the measurement selection. Clearly the majority of the model simulations were used to determine the optimal input signal. This is exceptionally large since we allowed the input to change at 9 time points and had fine input resolution with 40 different values. For comparison purposes, the Hes1 model experiment design in [<xref ref-type="bibr" rid="pcbi.1004488.ref016">16</xref>] required more than 30,000 model simulations to determine which species should be measured to provide the most information.</p>
<sec id="sec018">
<title>19-Dimensional Example: The T-cell Receptor Model</title>
<p>The scalability of the MBDOE strategy to high dimensional problems is demonstrated using a T-cell receptor signaling model proposed by Lipniacki et al. [<xref ref-type="bibr" rid="pcbi.1004488.ref042">42</xref>]. This model was used previously as an example model to resolve dynamical uncertainty using parallel measurements only [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>]. The model has 37 ODE equations that describes the dynamics of the species involved in the activation of T-cell signaling pathway, and 19 model parameters. Herein, we assume all of the parameters are unknown.</p>
<p>The Lipniacki model demonstrates the effectiveness of the MBDOE algorithm to use an optimal input to reduce dynamical uncertainty in a target system with conditions that maybe difficult to manipulate experimentally exactly. For illustrative purposes, we consider the system that could be experimentally determined to have a concentration of the agonist ligand, pMHC1, significantly higher than the concentration of the TCR receptors. The target system assumes that the concentration of this ligand pMHC1 predictably decreases as it binds to the TCR receptor. Two inputs are allowed to be manipulated in the experiment design under the system with constant supersaturating concentration of pMHC1: the drugs Sanguinarine, an Erk inhibitor, and PMA, an upstream activator of the protein kinase C. The magnitude levels of these control inputs, 𝕌, where 𝕌 ∈ [0, 1] with a resolution of <italic>δu</italic> = 0.3 can be changed at potential times 𝓣 = {5,10,15,20} min while the duration of an experiment run is 30 minutes. In this example, the initial u<sub><italic>b</italic></sub> is set to no drug application. None of the drugs are applied to the target system.</p>
<p>The allowable measurement state space 𝕄 is defined to include phosphorylated Zap, pZAP, total phosphorylated Mek, pMEK + ppMEK, and total phosphorylated Erk, pERK + ppERK. The allowable sampling time space T = [0 30] min was defined to specify measurements with a <italic>δt</italic> = 1 min. Optimal measurements are designed under an optimal input to reduce dynamical uncertainty in target states, free SHP, ZAP, ppMEk, and ppERK under the target system with predictable decreasing levels of pMHC1. A total of four measurements are to be designed. The design is initiated by identifying acceptable parameters that fit an initial data set containing 9 points, pERK + ppERK at 0, 2, 5, 7, 8, 10, 12, 20 and 30 minutes.</p>
<p>The optimal experimental design that constrains the predicted dynamics of the target system is presented in <xref ref-type="table" rid="pcbi.1004488.t006">Table 6</xref>. Optimal drug levels for Sanguinarine and PMA are administered at times <italic>t</italic> = 10 minutes and optimal measurements are specified at times <italic>t</italic> = 14,18 and 30 minutes. These predicted measurements are also superimposed on the simulation of the representative parameters in <xref ref-type="fig" rid="pcbi.1004488.g004">Fig 4a</xref> to illustrate their connection with uncertainty. The optimal experimental design yields a reduction of uncertainty in target state dynamics by as much as 99% observed in Zap, with the least predicted dynamical uncertainty reduction by 46% for free SHP (<xref ref-type="fig" rid="pcbi.1004488.g004">Fig 4b</xref>). Although we would like to dramatically reduce the uncertainty for all target states, the reduction performance is highly dependent on the relationship between the target and measurable states. There are cases where the measurements may not be informative at all; our MBDOE approach will help inform the experimentalist <italic>a priori</italic>.</p>
<table-wrap id="pcbi.1004488.t006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.t006</object-id>
<label>Table 6</label>
<caption>
<title>Optimal Experiment Design for TCR Example.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004488.t006g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.t006"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="1" colspan="1">Time Step</th>
<th align="center" rowspan="1" colspan="1">Action under MBDOE design</th>
<th align="center" rowspan="1" colspan="1">Scenario Tree Level</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="1" colspan="1"/>
<td align="center" rowspan="1" colspan="1">Sanguinarine = 0</td>
<td align="center" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 10 mins</td>
<td align="center" rowspan="1" colspan="1">Apply PMA = 0.3</td>
<td align="center" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 14 mins</td>
<td align="center" rowspan="1" colspan="1">Measure pERK+ppERK</td>
<td align="center" rowspan="1" colspan="1">2<sup><italic>nd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 18 mins</td>
<td align="center" rowspan="1" colspan="1">Measure pMEK+ppMEK</td>
<td align="center" rowspan="1" colspan="1">2<sup><italic>nd</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 30 mins</td>
<td align="center" rowspan="1" colspan="1">Measure pERK+ppERK</td>
<td align="center" rowspan="1" colspan="1">1<sup><italic>st</italic></sup></td>
</tr>
<tr>
<td align="center" rowspan="1" colspan="1">T = 30 mins</td>
<td align="center" rowspan="1" colspan="1">Measure pERK+ppERK</td>
<td align="center" rowspan="1" colspan="1">2<sup><italic>nd</italic></sup></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1004488.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.g004</object-id>
<label>Fig 4</label>
<caption>
<title>An illustration of the optimal experimental design for the TCR example.</title>
<p>(<bold>a</bold>) Model simulation of the output dynamics of the measurable species under the optimal input provided in <xref ref-type="table" rid="pcbi.1004488.t006">Table 6</xref> simulated with Ω<sub><italic>RA</italic></sub>. The red dots specify the selected optimal measurement points by the mean values generated by nominal plant with additive 10% Gaussian noise. Error bars are also given by the standard deviation of the simulated data (three data points are generated for each time point). (<bold>b</bold>) The initial (grey) and final (blue) uncertainty in the target states dynamics. The designed experiment reduces the uncertainty region by 46%,99%,85% and 59% for free SHP, ZAP, ppMEK and ppERK, respectively. The red line shows the simulated dynamics of the nominal plant.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.g004"/>
</fig>
<p>For completeness, the measurement scenario tree design is provided in <xref ref-type="fig" rid="pcbi.1004488.g005">Fig 5a</xref>. Each measurement from the scenario tree is investigated to determine how it contributes to the decrease in the TDU and the individual maximum variance (<xref ref-type="fig" rid="pcbi.1004488.g005">Fig 5b and 5c</xref>). <xref ref-type="fig" rid="pcbi.1004488.g005">Fig 5b</xref> also compares the reduction in TDU for our MBDOE approach to a measurement only design. For the measurement only MBDOE approach, we choose to find 4 measurements assuming the target input was applied to the TCR model. From this figure, it is clear that the optimization of the input signal is most important when a limited number of measurements are taken.</p>
<fig id="pcbi.1004488.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004488.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Supporting details of optimal experiment design for TCR example.</title>
<p>(<bold>a</bold>) The measurement scenario tree representation for selecting optimal measurements. Each node defines, the measurement pairs with the predicted value of the distinguishability metric, <italic>ξ</italic>, target dynamical uncertainty, <italic>γ</italic>, and three estimated measurement values from simulation, G1, G2, and G3. The path along the scenario tree with predictions closest to the data from the nominal plant is shown in red. (<bold>b</bold>) Reduction of TDU (blue line) and (<bold>c</bold>) individual variance of target states with each additional unique measurement from the scenario tree. In (<bold>b</bold>) the reduction in TDU for a measurement only MBDOE scenario (red line) is provided for comparison purposes.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.g005"/>
</fig>
<p>The computational efficiency of this MBDOE method on a higher dimension problem depends on the use of interpolation to explore the uncertain parameter space. From the 10,063 nodes used to create the grid, the algorithm identified 3974 acceptable parameters. The grid interpolant was sampled 100,000 times using LHS to identify an additional 403 acceptable parameters. The algorithm determined <italic>N</italic><sub><italic>RA</italic></sub> = 44 with <italic>N</italic><sub><italic>A</italic></sub> = 2000. There was no need to construct an input sparse grid since <italic>N</italic><sub><italic>u</italic></sub> = 16 and there were only 4 admissible times for potential input changes. The total number of model simulations for the complete experiment design is 16,991 with 12,063 for the selection of representative parameters, 4884 simulations for the input design, and 44 simulations to support the measurement selection. The majority of the model simulations are used to explore the large dimension uncertain parameter space to identify the acceptable and representative parameters. Given <xref ref-type="disp-formula" rid="pcbi.1004488.e051">Eq (21)</xref> and the settings specified for the TCR model, the maximum number of model simulations possible was 19,084. The number of simulations actually performed was smaller than the worst case scenario because the input design terminated due to a lack of improvement in the TDU with additional changes to the input vector. For comparison purposes, previous work with this TCR model assuming different initial data and measurable species in [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>] required 19,000 model evaluations to only define optimal measurements for a parallel design that fully resolved the dynamics to within experimental capabilities.</p>
</sec>
</sec>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Discussion</title>
<p>In this work, we have proposed an MBDOE algorithm that extends previous work to include the design of an optimal input together with optimal measurements to reduce dynamical uncertainty in biological systems. The global nature of the algorithm overcomes the challenges posed by traditional MBDOE designs that rely on the local FIM design. Furthermore, most MBDOE techniques that consider input design only compare a predefined set of input values and/or measurements. Our computationally efficient approach enables us to avoid this limitation and search over the input space for the optimal input values at pre-specified time points. Our strategy achieves a global design by implementing computationally efficient strategies using sparse grid interpolation, probability-weighted scenario trees, and dynamical representative parameters. An interpolant of the ODE system is created by strategically sampling the uncertain parameter space and is used to evaluate additional points by LHS without simulating the ODEs. Representative parameters are used to span the dynamics of the acceptable parameter space. Together, the representative parameters and the sparse grid interpolation are used to efficiently screen the dynamical variance on the input space and facilitate the probability-weighted scenario tree to identify associated optimal measurements that minimize the uncertainty in the target system dynamics. We have confirmed that our optimal input MBDOE algorithm will specify experiments that are more informative in their ability to reduce dynamical uncertainty over MBDOE techniques that only specify optimal measurements using 3D and 19D models. The optimization of the input signal is most important when a limited number of measurements are taken.</p>
<p>The computational expense of the MBDOE method is highly dependent on the dimension of the unknown parameter space and the feasible input space. For high dimension models, a large number of model simulations may be required to explore the large dimension uncertain parameter space to identify the acceptable and representative parameters. This computational burden can be reduced by the use of the sparse grid interpolation tool if the model output is smooth over the uncertain parameter space. For large input spaces, the majority of the model simulations in the MBDOE algorithm may be used to determine the optimal input signal. The number of model simulations increases with more flexibility in the input feasible space in terms of: (1) number of inputs that could be applied, (2) number of allowable changes in the inputs magnitudes (input resolutions), and (3) the number of admissible input times. In our examples, we specified a high degree of flexibility in the feasible input space for the lower dimension Hes1 model than the high dimension TCR model. As a result, the TCR model used 12,063 model simulations for the optimal input vector design while the Hes1 system required 16,531 model simulations.</p>
<p>Historically, MBDOE methods have designed experiments sequentially, whereby information gained from a previous experiment is used immediately to inform the next experiment design [<xref ref-type="bibr" rid="pcbi.1004488.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1004488.ref044">44</xref>]. This approach is prevalent with the local MBDOE strategies since it improves the accuracy of the parameter estimates that support the design of the next experiment. The sequential design becomes problematic when the number of uncertain parameters is large because a single experiment does not estimate all the parameters accurately [<xref ref-type="bibr" rid="pcbi.1004488.ref045">45</xref>]. A parallel design methodology improves the estimates of the parameters and reduces experimental costs by specifying multiple measurements. The parallel design in [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>] uses scenario trees to specify all optimal measurements necessary to resolve the experimentally distinguishable dynamics. A hybrid design combines the advantage of the sequential design with the cost efficiency of the parallel design by specifying multiple experiments to perform and iterating with the results informing the next round of MBDOE. Our MBDOE design uniquely supports this hybrid design strategy. It uses a measurement scenario tree to determine a user-specified number of measurements as opposed to the previous scenario tree approach that indicated all measurements required to fully resolve the dynamics. Herein, the number of desired measurements controls the depth of the constructed scenario tree. (If a tree is made too deep, we believe that many of the specified measurements would be sub-optimal since the actual dynamics only lie within a fraction of the predicted tree.) Thus, if the desired dynamical resolution is not achieved by one application of our MBDOE algorithm, the design can be repeated while informed with the new additional experimental data. New experimental data restricts the acceptable parameter space further to generate a new more relevant optimal experimental design.</p>
<p>Although our MBDOE algorithm is global, we cannot claim it is globally optimal. The algorithm makes optimal decisions within constraints. To make the problem tractable, we split the optimization problem into two sequential steps while the first specifies the optimal inputs and the second finds the associated measurement pairs. It is possible, that a better solution does exist and our algorithm misses it. Another source that may contribute to a sub-optimal result would be in the accuracy of the sparse grids. If the interpolants are not sufficiently accurate surrogates for the model responses, the results may be sub-optimal. In addition, we do not presume to have a good estimate of the number of acceptable parameter values needed to support the MBDOE since it is a function of the the biological system, the experimental setup, measurement noise, the mathematical model and its uncertainty. Hence, there is no exact formula for calculating the number of acceptable parameter vectors needed to support our experiment design algorithm. If the value is too small, the algorithm output would be sub-optimal and likely not repeatable. However, if repeated runs of our MBDOE algorithm produce similar results for increasing numbers of <italic>N</italic><sub><italic>A</italic></sub> than it is likely to be sufficiently large. Thus, without putting constraints on the biological system model, <italic>N</italic><sub><italic>A</italic></sub> must be sufficiently large to cover all distinguishable dynamics so that repeated application of our MBDOE algorithm derives similar optimal experiment designs.</p>
<p>Overall, the proposed MBDOE strategy successfully extends previous MBDOE capabilities to design an optimal input with associated measurements that minimizes the uncertainty in the target system dynamics. The interpolation grid provides a computational efficient way to search for both parameter fits and optimal input over large uncertain spaces. The use of representative parameters, selected to span the dynamical space of the biological model, provides a means to sample the dynamical space uniformly enhancing the computational tractability of this approach. Furthermore, the probability weighted scenario tree designs modified from [<xref ref-type="bibr" rid="pcbi.1004488.ref015">15</xref>] supports input and multiple optimal measurement pair selection with fewer sampled parameters. Although the enhancement of the discrimination ability of the experiment is somewhat model dependent, for the examples we have presented herein, we have found that the ability to specify an optimal input in addition to optimal measurements has enhanced the ability to bound the expected target system dynamics.</p>
</sec>
<sec id="sec020">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004488.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004488.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Additional results to support the efficacy of the MBDOE algorithm to reduce dynamical uncertainty in model states.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We are grateful to M Pargett, J Perley, A Sai and the rest of the Rundell research group for their insightful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004488.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hasenauer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Waldherr</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Allgower</surname> <given-names>F</given-names></name> (<year>2010</year>) <article-title>Parameter identification, experimental design and model falsification for biological network models using semidefinite programming</article-title>. <source>IET systems biology</source> <volume>4</volume>: <fpage>119</fpage>–<lpage>130</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1049/iet-syb.2009.0030" xlink:type="simple">10.1049/iet-syb.2009.0030</ext-link></comment> <object-id pub-id-type="pmid">20232992</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bandara</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schlder</surname> <given-names>J P</given-names></name>, <name name-style="western"><surname>Eils</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bock</surname> <given-names>H G</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>T</given-names></name> (<year>2009</year>) <article-title>Optimal experimental design for parameter estimation of a cell signaling model</article-title>. <source>PLoS computational biology</source> <volume>5</volume>(<issue>2</issue>): <fpage>e1000558</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000558" xlink:type="simple">10.1371/journal.pcbi.1000558</ext-link></comment> <object-id pub-id-type="pmid">19911077</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Steiert</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Raue</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Timmer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kreutz</surname> <given-names>C</given-names></name> (<year>2012</year>) <article-title>Experimental design for parameter estimation of gene regulatory networks</article-title>. <source>PloS One</source> <volume>7</volume>(<issue>7</issue>): <fpage>e40052</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0040052" xlink:type="simple">10.1371/journal.pone.0040052</ext-link></comment> <object-id pub-id-type="pmid">22815723</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bezeau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Endrenyi</surname> <given-names>L</given-names></name> (<year>1986</year>) <article-title>Design of experiments for the precise estimation of dose-response parameters: the Hill equation</article-title>. <source>Journal of Theoretical Biology</source> <volume>123</volume>(<issue>4</issue>): <fpage>415</fpage>–<lpage>430</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0022-5193(86)80211-9" xlink:type="simple">10.1016/S0022-5193(86)80211-9</ext-link></comment> <object-id pub-id-type="pmid">3657186</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Li</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Vu</surname> <given-names>Q</given-names></name> (<year>2013</year>) <article-title>Identification of parameter correlations for parameter estimation in dynamic biological models</article-title>. <source>BMC systems biology</source> <volume>7</volume>: <fpage>91</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-7-91" xlink:type="simple">10.1186/1752-0509-7-91</ext-link></comment> <object-id pub-id-type="pmid">24053643</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Transtrum</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Qiu</surname> <given-names>P</given-names></name> (<year>2012</year>) <article-title>Optimal experiment selection for parameter estimation in biological differential equation models</article-title>. <source>BMC bioinformatics</source> <volume>13</volume>: <fpage>181</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-13-181" xlink:type="simple">10.1186/1471-2105-13-181</ext-link></comment> <object-id pub-id-type="pmid">22838836</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Franceschini</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Macchietto</surname> <given-names>S</given-names></name> (<year>2003</year>) <article-title>Model-based design of experiments for parameter precision: State of the art</article-title>. <source>Chem. Eng. Sci</source>. <volume>9</volume>: <fpage>11</fpage></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Weber</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kramer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dingler</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Radde</surname> <given-names>N</given-names></name> (<year>2012</year>) <article-title>Trajectory-oriented Bayesian experiment design versus Fisher A-optimal design: an in depth comparison study</article-title>. <source>Journal of Computational Physics</source> <volume>28</volume>(<issue>18</issue>):<fpage>i535</fpage>–<lpage>i541</lpage></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lages</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Cordeiro</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sousa Silva</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ponces Freire</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ferreira</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>Optimization of time-course experiments for kinetic model discrimination</article-title>. <source>PloS One</source> <volume>7</volume>(<issue>3</issue>): <fpage>e32749</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0032749" xlink:type="simple">10.1371/journal.pone.0032749</ext-link></comment> <object-id pub-id-type="pmid">22403703</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Apgar</surname> <given-names>J F</given-names></name>, <name name-style="western"><surname>Toettcher</surname> <given-names>J E</given-names></name>, <name name-style="western"><surname>Endy</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>F M</given-names></name>, <name name-style="western"><surname>Tidor</surname> <given-names>B</given-names></name> (<year>2008</year>) <article-title>Stimulus design for model selection and validation in cell signaling</article-title> <source>PLoS One computational biology</source> <volume>4</volume>(<issue>2</issue>): <fpage>e30</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0040030" xlink:type="simple">10.1371/journal.pcbi.0040030</ext-link></comment> <object-id pub-id-type="pmid">18282085</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Galvanin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Macchietto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bezzo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pado</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Marzolo</surname> <given-names>V</given-names></name> (<year>2007</year>) <article-title>Model-Based Design of Parallel Experiments</article-title>. <source>Ind. Eng. Chem. Res</source> <volume>46</volume>: <fpage>871</fpage>–<lpage>882</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ie0611406" xlink:type="simple">10.1021/ie0611406</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stegmaier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Skanda</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lebiedz</surname> <given-names>D</given-names></name> (<year>2013</year>) <article-title>Robust optimal design of experiments for model discrimination using an interactive software tool</article-title>. <source>PloS One</source> <volume>8</volume>(<issue>2</issue>): <fpage>e55723</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0055723" xlink:type="simple">10.1371/journal.pone.0055723</ext-link></comment> <object-id pub-id-type="pmid">23390549</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Silk</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kirk</surname> <given-names>PDW</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Toni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MPH</given-names></name> (<year>2014</year>). <article-title>Model Selection in Systems Biology Depends on Experimental Design</article-title>. <name name-style="western"><surname>Rost</surname> <given-names>B</given-names></name>, ed. <source>PLoS Computational Biology</source>. <volume>10</volume>(<issue>6</issue>):<fpage>e1003650</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003650" xlink:type="simple">10.1371/journal.pcbi.1003650</ext-link></comment> <object-id pub-id-type="pmid">24922483</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Donahue</surname> <given-names>M M</given-names></name>, <name name-style="western"><surname>Buzzard</surname> <given-names>G T</given-names></name>, <name name-style="western"><surname>Rundell</surname> <given-names>A E</given-names></name> (<year>2010</year>) <article-title>Experiment design through dynamical characterisation of non-linear systems biology models utilising sparse grids</article-title>. <source>IET systems biology</source> <volume>4</volume>(<issue>4</issue>): <fpage>249</fpage>–<lpage>262</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1049/iet-syb.2009.0031" xlink:type="simple">10.1049/iet-syb.2009.0031</ext-link></comment> <object-id pub-id-type="pmid">20632775</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bazil</surname> <given-names>J N</given-names></name>, <name name-style="western"><surname>Buzzard</surname> <given-names>G T</given-names></name>, <name name-style="western"><surname>Rundell</surname> <given-names>A E</given-names></name> (<year>2012</year>) <article-title>A global parallel model based design of experiments method to minimize model output uncertainty</article-title>. <source>Bulletin of mathematical biology</source> <volume>74</volume>(<issue>3</issue>): <fpage>688</fpage>–<lpage>716</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11538-011-9686-9" xlink:type="simple">10.1007/s11538-011-9686-9</ext-link></comment> <object-id pub-id-type="pmid">21989566</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Liepe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Filippi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Komorowski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>M P H</given-names></name>, (<year>2013</year>) <article-title>Maximizing the information content of experiments in systems biology</article-title>. <source>Bulletin of mathematical biology</source> <volume>9</volume>(<issue>1</issue>): <fpage>e1002888</fpage></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Marvel</surname> <given-names>S W</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>C M</given-names></name> (<year>2012</year>) <article-title>Set membership experimental design for biological systems</article-title>. <source>Journal of Computational and Graphical Statistics</source> <volume>6</volume>(<issue>1</issue>): <fpage>21</fpage></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Omony</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mach-Aigner</surname> <given-names>A R</given-names></name>, <name name-style="western"><surname>de Graaff</surname> <given-names>L H</given-names></name>, <name name-style="western"><surname>van Straten</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>van Boxtel</surname> <given-names>A J B</given-names></name> (<year>2012</year>) <article-title>Evaluation of design strategies for time course experiments in genetic networks: case study of the XlnR regulon in Aspergillus niger</article-title>. <source>IEEE/ACM transactions on computational biology and bioinformatics / IEEE, ACM</source>, <volume>9</volume>(<issue>5</issue>): <fpage>1316</fpage>–<lpage>1325</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2012.59" xlink:type="simple">10.1109/TCBB.2012.59</ext-link></comment> <object-id pub-id-type="pmid">22529332</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kutalik</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Cho</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wolkenhauer</surname> <given-names>O</given-names></name>, (<year>2004</year>) <article-title>Optimal sampling time selection for parameter estimation in dynamic pathway modeling</article-title>. <source>Bio Systems</source> <volume>9</volume>(<issue>1-3</issue>): <fpage>43</fpage>–<lpage>55</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.biosystems.2004.03.007" xlink:type="simple">10.1016/j.biosystems.2004.03.007</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="other">Maheshwari V, Rangaiah G P, Samavedham L (2012) A Novel Multi-Objective Optimization based Experimental Design and its Application for Physiological Model of Type 1 Diabetes. Symposium on Advanced Control of Chemical Processes.</mixed-citation>
</ref>
<ref id="pcbi.1004488.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kreutz</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Timmer</surname> <given-names>J</given-names></name> (<year>2009</year>) <article-title>Experimental Design in Systems Biology</article-title>. <source>FEBS Journal</source> <volume>276</volume>(<issue>4</issue>):<fpage>923</fpage>–<lpage>942</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1742-4658.2008.06843.x" xlink:type="simple">10.1111/j.1742-4658.2008.06843.x</ext-link></comment> <object-id pub-id-type="pmid">19215298</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schenkendorf</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kremling</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mangol</surname> <given-names>M</given-names></name> (<year>2008</year>) <article-title>Optimal Experimental Design with the sigma point method</article-title>. <source>IET Systems Biology</source> <volume>3</volume>: <fpage>10</fpage>–<lpage>23</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1049/iet-syb:20080094" xlink:type="simple">10.1049/iet-syb:20080094</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Flassig</surname> <given-names>R. J.</given-names></name>, and <name name-style="western"><surname>Sundmacher</surname> <given-names>K.</given-names></name> (<year>2012</year>). <article-title>Optimal Design of Stimulus Experiments for Robust Discrimination of Biochemical Reaction Networks</article-title>. <source>Bioinformatics</source> <volume>28</volume>(<issue>23</issue>): <fpage>30893096</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts585" xlink:type="simple">10.1093/bioinformatics/bts585</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Banga</surname> <given-names>J R</given-names></name>, <name name-style="western"><surname>Versyck</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Van Impe</surname> <given-names>J F</given-names></name> (<year>2002</year>) <article-title>Computation of Optimal Identification Experiments for Nonlinear Dynamic Process Models: a Stochastic Global Optimization Approach</article-title>. <source>Industrial &amp; Engineering Chemistry Research</source> <volume>41</volume>(<issue>10</issue>): <fpage>2425</fpage>–<lpage>2430</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ie010183d" xlink:type="simple">10.1021/ie010183d</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Steiert</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Raue</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Timmer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kreutz</surname> <given-names>C</given-names></name> (<year>2012</year>) <article-title>Experimental design for parameter estimation of gene regulatory networks</article-title>. <source>PloS one</source> <volume>7</volume>(<issue>7</issue>): <fpage>e40052</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0040052" xlink:type="simple">10.1371/journal.pone.0040052</ext-link></comment> <object-id pub-id-type="pmid">22815723</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Su</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>H</given-names></name> (<year>2011</year>) <article-title>Optimal Design of Degradation Experiment Based on Monte Carlo Simulation</article-title>. <source>Advanced Materials Research</source> <volume>211–212</volume>: <fpage>280</fpage>–<lpage>284</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4028/www.scientific.net/AMR.211-212.280" xlink:type="simple">10.4028/www.scientific.net/AMR.211-212.280</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Maiwald</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kreutz</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pfeifer</surname> <given-names>A C</given-names></name>, <name name-style="western"><surname>Bohl</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Klingmller</surname> <given-names>U</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Dynamic pathway modeling: feasibility analysis and optimal experimental design</article-title>. <source>Annals of the New York Academy of Sciences</source> <volume>1115</volume>:<fpage>212</fpage>–<lpage>220</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1196/annals.1407.007" xlink:type="simple">10.1196/annals.1407.007</ext-link></comment> <object-id pub-id-type="pmid">18033750</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Solonen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Haario</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Laine</surname> <given-names>M</given-names></name> (<year>2012</year>) <article-title>Simulation-Based Optimal Design Using a Response Variance Criterion</article-title>., <source>Journal of Computational and Graphical Statistics</source> <volume>21</volume>(<issue>1</issue>):<fpage>234</fpage>–<lpage>252</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jcgs.2011.10070" xlink:type="simple">10.1198/jcgs.2011.10070</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huan</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Marzouk</surname> <given-names>Y</given-names></name> (<year>2013</year>) <article-title>Simulation-based optimal Bayesian experimental design for nonlinear systems</article-title>. <source>Journal of Computational Physics</source> <volume>232</volume>(<issue>1</issue>): <fpage>288</fpage>–<lpage>317</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jcp.2012.08.013" xlink:type="simple">10.1016/j.jcp.2012.08.013</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ryan</surname> <given-names>K J</given-names></name> (<year>2003</year>) <article-title>Estimating Expected Information Gains for Experimental Designs With Application to the Random Fatigue-Limit Model</article-title>. <source>Journal of Computational and Graphical Statistics</source> <volume>12</volume>: <fpage>585</fpage>–<lpage>603</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/1061860032012" xlink:type="simple">10.1198/1061860032012</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Weber</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kramer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dingler</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Radde</surname> <given-names>N</given-names></name> (<year>2012</year>) <article-title>Trajectory-oriented Bayesian experiment design versus Fisher A-optimal design: an in depth comparison study</article-title>. <source>Journal of Computational Physics</source> <volume>28</volume>(<issue>18</issue>):<fpage>i535</fpage>–<lpage>i541</lpage></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gadkar</surname> <given-names>K G</given-names></name>, <name name-style="western"><surname>Gunawan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>F J</given-names></name> (<year>2005</year>) <article-title>Iterative approach to model identification of biological networks</article-title>. <source>BMC bioinformatics</source> <volume>6</volume>: <fpage>155</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-6-155" xlink:type="simple">10.1186/1471-2105-6-155</ext-link></comment> <object-id pub-id-type="pmid">15967022</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yue</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kell</surname> <given-names>D B</given-names></name> (<year>2008</year>) <article-title>Sensitivity analysis and robust experimental design of a signal transduction pathway system</article-title>. <source>Int. J. Chem. Kinet</source>. <volume>40</volume>: <fpage>730741</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/kin.20369" xlink:type="simple">10.1002/kin.20369</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mehra</surname> <given-names>R K</given-names></name> (<year>1974</year>) <article-title>Optimal input signals for parameter estimation in dynamic systems–Survey and new results</article-title>. <source>IEEE Transactions on Automatic Control</source> <volume>19</volume>(<issue>6</issue>): <fpage>753</fpage>–<lpage>768</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TAC.1974.1100701" xlink:type="simple">10.1109/TAC.1974.1100701</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dong</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Nilsen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Systems biology of the clock in Neurospora crassa</article-title>. <source>PloS one</source> <volume>3</volume>(<issue>8</issue>): <fpage>e3105</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0003105" xlink:type="simple">10.1371/journal.pone.0003105</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="other">Mdluli T, Pargett M, Buzzard G T, Rundell A, E. (2008) Specifying Informative Experiment Stimulation Conditions for Resolving Dynamical Uncertainty in Biological Systems. International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC’14): 298–301</mixed-citation>
</ref>
<ref id="pcbi.1004488.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Busetto</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Hauser</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Krummenacher</surname> <given-names>G</given-names></name>, <etal>et al</etal> (<year>2013</year>). <article-title>Near-optimal experimental design for model selection in systems biology</article-title>. <source>Bioinformatics</source>. <volume>29</volume>(<issue>20</issue>):<fpage>2625</fpage>–<lpage>2632</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt436" xlink:type="simple">10.1093/bioinformatics/btt436</ext-link></comment> <object-id pub-id-type="pmid">23900189</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Betts</surname> <given-names>J T</given-names></name> and <name name-style="western"><surname>Huffman</surname> <given-names>W P</given-names></name> (198) <article-title>Mesh refinement in direct transcription methoods for optimal control</article-title>. <source>Optimal Control Application Methods</source> <volume>19</volume>(<issue>1</issue>): <fpage>1</fpage>–<lpage>21</lpage></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="other">Li Z, Liu J, Chen S, and Tang X (2007). Noise robust spectral clustering. In IEEE 11th International Conference on Computer Vision.</mixed-citation>
</ref>
<ref id="pcbi.1004488.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="other">Ferenczi I (2005) Global Optimization using Sparse Grids. Technische Unversitat Munchen 140</mixed-citation>
</ref>
<ref id="pcbi.1004488.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zeiser</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mller</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Liebscher</surname> <given-names>V</given-names></name> (<year>2007</year>) <article-title>Modeling the Hes1 Oscillator</article-title>. <source>Journal of Computational Biology</source> <volume>14</volume>(<issue>7</issue>): <fpage>984</fpage>–<lpage>1000</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2007.0029" xlink:type="simple">10.1089/cmb.2007.0029</ext-link></comment> <object-id pub-id-type="pmid">17803375</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lipniacki</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hat</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Faeder</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Hlavacek</surname> <given-names>WS</given-names></name> (<year>2008</year>) <article-title>Stochastic effects and bistability in T cell receptor signaling</article-title>. <source>Journal of Theoretical Biology</source> <volume>254</volume>: <fpage>110122</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2008.05.001" xlink:type="simple">10.1016/j.jtbi.2008.05.001</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Van Derlinden</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bernaerts</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Van Impe</surname> <given-names>J F</given-names></name> (<year>2010</year>) <article-title>Simultaneous versus sequential optimal experiment design for the identification of multi-parameter microbial growth kinetics as a function of temperature</article-title>. <source>Journal of theoretical biology</source> <volume>264</volume>(<issue>2</issue>): <fpage>347</fpage>–<lpage>55</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2010.01.003" xlink:type="simple">10.1016/j.jtbi.2010.01.003</ext-link></comment> <object-id pub-id-type="pmid">20064532</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Homologous</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Rovati</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Enrico</surname> <given-names>G</given-names></name> (<year>1988</year>) <article-title>DESIGN: Computerized Optimization of Experimental Design for Estimating <italic>K</italic><sub><italic>d</italic></sub> and <italic>B</italic><sub><italic>max</italic></sub> in Ligand Binding Experiments</article-title>. <source>Journal of theoretical biology</source> <volume>249</volume>: <fpage>636</fpage>–<lpage>649</lpage></mixed-citation>
</ref>
<ref id="pcbi.1004488.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Apgar</surname> <given-names>J F</given-names></name>, <name name-style="western"><surname>Witmer</surname> <given-names>D K</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>F M</given-names></name>, and <name name-style="western"><surname>Tidor</surname> <given-names>B</given-names></name> (<year>2012</year>) <article-title>Sloppy Models, Paramter Uncertainty, and the Role of Experimental Design</article-title>. <source>Molecular BioSystems</source> <volume>6</volume>(<issue>10</issue>): <fpage>1890</fpage>–<lpage>1900</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1039/b918098b" xlink:type="simple">10.1039/b918098b</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>