<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00708</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002711</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Neuroscience</subject>
            <subj-group>
              <subject>Computational neuroscience</subject>
              <subj-group>
                <subject>Coding mechanisms</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Neuroscience</subject>
        </subj-group>
      </article-categories><title-group><article-title>Coding and Decoding with Adapting Neurons: A Population Approach to the Peri-Stimulus Time Histogram</article-title><alt-title alt-title-type="running-head">Coding and Decoding with Adapting Neurons</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Naud</surname>
            <given-names>Richard</given-names>
          </name>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Gerstner</surname>
            <given-names>Wulfram</given-names>
          </name>
          <xref ref-type="aff" rid="aff1"/>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1">
        <addr-line>School of Computer and Communication Sciences and School of Life Sciences, Brain Mind Institute, Ecole Polytechnique Fédérale de Lausanne, Lausanne-EPFL, Lausanne, Switzerland</addr-line>
      </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Sporns</surname>
            <given-names>Olaf</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">
        <addr-line>Indiana University, United States of America</addr-line>
      </aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">wulfram.gerstner@epfl.ch</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: RN WG. Performed the experiments: RN. Analyzed the data: RN. Wrote the paper: RN WG.</p>
        </fn>
      </author-notes><pub-date pub-type="collection">
        <month>10</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>4</day>
        <month>10</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>10</issue><elocation-id>e1002711</elocation-id><history>
        <date date-type="received">
          <day>3</day>
          <month>5</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>3</day>
          <month>8</month>
          <year>2012</year>
        </date>
      </history><permissions>
        
        <copyright-holder>Naud, Gerstner</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions><abstract>
        <p>The response of a neuron to a time-dependent stimulus, as measured in a Peri-Stimulus-Time-Histogram (PSTH), exhibits an intricate temporal structure that reflects potential temporal coding principles. Here we analyze the encoding and decoding of PSTHs for spiking neurons with arbitrary refractoriness and adaptation. As a modeling framework, we use the spike response model, also known as the generalized linear neuron model. Because of refractoriness, the effect of the most recent spike on the spiking probability a few milliseconds later is very strong. The influence of the last spike needs therefore to be described with high precision, while the rest of the neuronal spiking history merely introduces an average self-inhibition or adaptation that depends on the expected number of past spikes but not on the exact spike timings. Based on these insights, we derive a ‘quasi-renewal equation’ which is shown to yield an excellent description of the firing rate of adapting neurons. We explore the domain of validity of the quasi-renewal equation and compare it with other rate equations for populations of spiking neurons. The problem of decoding the stimulus from the population response (or PSTH) is addressed analogously. We find that for small levels of activity and weak adaptation, a simple accumulator of the past activity is sufficient to decode the original input, but when refractory effects become large decoding becomes a non-linear function of the past activity. The results presented here can be applied to the mean-field analysis of coupled neuron networks, but also to arbitrary point processes with negative self-interaction.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>How can information be encoded and decoded in populations of adapting neurons? A quantitative answer to this question requires a mathematical expression relating neuronal activity to the external stimulus, and, conversely, stimulus to neuronal activity. Although widely used equations and models exist for the special problem of relating external stimulus to the action potentials of a single neuron, the analogous problem of relating the external stimulus to the activity of a <italic>population</italic> has proven more difficult. There is a bothersome gap between the dynamics of single adapting neurons and the dynamics of populations. Moreover, if we ignore the single neurons and describe directly the population dynamics, we are faced with the ambiguity of the adapting neural code. The neural code of adapting populations is ambiguous because it is possible to observe a range of population activities in response to a given instantaneous input. Somehow the ambiguity is resolved by the knowledge of the population history, but how precisely? In this article we use approximation methods to provide mathematical expressions that describe the encoding and decoding of external stimuli in adapting populations. The theory presented here helps to bridge the gap between the dynamics of single neurons and that of populations.</p>
      </abstract><funding-group>
        <funding-statement>The research was supported by the European project BrainScaleS (project 269921) and the Swiss National Science Foundation project “Coding Characteristics of Neuron Models” (project 200020\_132871/1). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group><counts>
        <page-count count="14"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Encoding and decoding of information with populations of neurons is a fundamental question of computational neuroscience <xref ref-type="bibr" rid="pcbi.1002711-Rieke1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>. A time-varying stimulus can be encoded in the active fraction of a population of neurons, a coding procedure that we will refer to as population coding (<xref ref-type="fig" rid="pcbi-1002711-g001">Fig. 1</xref>). Given the need for fast processing of information by the brain <xref ref-type="bibr" rid="pcbi.1002711-Thorpe1">[4]</xref>, population coding is an efficient way to encode information by averaging across a pool of noisy neurons <xref ref-type="bibr" rid="pcbi.1002711-Abeles1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref> and is likely to be used at least to some degree by the nervous system <xref ref-type="bibr" rid="pcbi.1002711-Averbeck1">[7]</xref>. For a population of identical neurons, the instantaneous population firing rate is proportional to the Peri-Stimulus Time Histogram (PSTH) of a single neuron driven repeatedly by the same stimulus over many trials.</p>
      <fig id="pcbi-1002711-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002711.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Encoding and Decoding with neuronal populations.</title>
          <p>What is the function that relates an arbitrary stimulus to the population activity of adapting neurons? We focus on the problem of relating the filtered input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e001" xlink:type="simple"/></inline-formula> to the activity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e002" xlink:type="simple"/></inline-formula>. The population activity is the fraction of active neurons (red) in the population of neurons (right). All neurons are identical and receive the same stimulus. One possible stimulus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e003" xlink:type="simple"/></inline-formula> is a step current (left).</p>
        </caption>
        <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.g001" xlink:type="simple"/>
      </fig>
      <p>When driven by a step change in the input, the population of neurons coding for this stimulus responds first strongly but then adapts to the stimulus. To cite a few examples, the activity of auditory nerve fibers adapt to pure tones <xref ref-type="bibr" rid="pcbi.1002711-Smith1">[8]</xref>, cells in the retina and the visual cortex adapt to contrast <xref ref-type="bibr" rid="pcbi.1002711-Baccus1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Sclar1">[10]</xref> and neurons in the inferior temporal cortex adapt to higher order structures of images <xref ref-type="bibr" rid="pcbi.1002711-Ringo1">[11]</xref>. Adaptation is energy-efficient <xref ref-type="bibr" rid="pcbi.1002711-Laughlin1">[12]</xref> but leads to a potentially ambiguous code because adapting responses generate a population activity which does not directly reflect the momentary strength of the stimuli <xref ref-type="bibr" rid="pcbi.1002711-Fairhall1">[13]</xref>. Putting the case of sensory illusions aside, the fact that our perception of constant stimuli does not fade away indicates that the adapting responses can be efficiently decoded by the brain areas further down the processing stream. In fact, illusions such as the motion after-effect are believed to reflect errors in decoding the activity of neuronal populations <xref ref-type="bibr" rid="pcbi.1002711-Seris1">[14]</xref>. But what <italic>is</italic> the correct rule to decode population activity? What elements of the population history are relevant? What are the basic principles?</p>
      <p>Synapse- and network-specific mechanisms merge with intrinsic neuronal properties to produce an adapting population response. Here we focus on the intrinsic mechanisms, commonly called spike-frequency adaptation. Spike-frequency adaptation appears in practically all neuron types of the nervous system <xref ref-type="bibr" rid="pcbi.1002711-Benda1">[15]</xref>. Biophysical processes that can mediate spike-frequency adaptation include spike-triggered activation/inactivation of ion-channels <xref ref-type="bibr" rid="pcbi.1002711-Storm1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Schwindt2">[18]</xref> and a spike-triggered increase in the firing threshold <xref ref-type="bibr" rid="pcbi.1002711-Hill1">[19]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>. Neurons adapt a little more each time they emit a spike, and it is the cumulative effect of all previous spikes that sets the level of adaptation. The effect of a single spike on future spiking probability cannot be summarized by a single time constant. Rather, the spike-triggered adaptation unfolds on multiple time scales and varies strongly across cell-types <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-LaCamera1">[23]</xref>.</p>
      <p>Mean-field methods were used to describe: attractors <xref ref-type="bibr" rid="pcbi.1002711-Amit1">[24]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Renart1">[28]</xref>, rapid-responses <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-FourcaudTrocme1">[29]</xref> and signal propagation <xref ref-type="bibr" rid="pcbi.1002711-Diesmann1">[30]</xref>. While adaptation is important to correctly predict the activity of single neurons <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Pillow1">[31]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Jolivet2">[33]</xref>, it is difficult to include it in mean-field methods. A theory relating spike-frequency adaptation to population dynamics should be general enough to encompass a variety of different spike-triggered adaptation profiles, as observed in experiments. In the literature we find six main approaches to the population coding problem. The first and most simple one formulates the rate of a neuronal population (or the time-dependent rate in a PSTH) as a linear function of the stimulus. This phenomenological model relates to the concept of receptive fields <xref ref-type="bibr" rid="pcbi.1002711-Hubel1">[34]</xref> and can be made quantitative using a Wiener expansion <xref ref-type="bibr" rid="pcbi.1002711-Marmarelis1">[35]</xref>. Yet, early experimental tests showed that linear filtering must be complemented with a non-linear function <xref ref-type="bibr" rid="pcbi.1002711-Marmarelis1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-EnrothCugell1">[36]</xref>. The linear-non-linear model can thus be considered as the second approach to population coding. In combination with a Poisson spike generator it is called the LNP model for Linear-Nonlinear-Poisson. It makes accurate predictions of experimental measurements for stationary stimulus ensembles, but fails when the stimulus switches either its first or second order statistics. Neural refractoriness is in part responsible for effects not taken into account in this linear-nonlinear model <xref ref-type="bibr" rid="pcbi.1002711-Gerstner4">[37]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Ostojic1">[40]</xref>. In a third approach proposed by Wilson and Cowan <xref ref-type="bibr" rid="pcbi.1002711-Wilson1">[41]</xref> the population activity is the solution to a non-linear differential equation. Unfortunately this equation has only a heuristic link to the underlying neuronal dynamics and cannot account for rapid transients in the population response. The fourth approach formulates the population activity in terms of an integral equation <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Wilson1">[41]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Gerstner5">[42]</xref> which can be interpreted as a (time-dependent) renewal theory. While this renewal theory takes into account refractoriness (i.e. the effect of the most recent spike) and captures the rapid transients of the population response and PSTH, neither this one nor any of the other encoding frameworks mentioned above consider adaptive effects. To include adaptation into previously non-adaptive models, a common approach is to modify the effective input by rescaling the external input with a function that depends on the mean neuronal firing rate in the past <xref ref-type="bibr" rid="pcbi.1002711-Benda1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Rauch1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-LaCamera2">[44]</xref>. This forms the fifth method. For example, Benda and Herz <xref ref-type="bibr" rid="pcbi.1002711-Benda1">[15]</xref> suggested a phenomenological framework in which the linear-non-linear approach is modified as a function of the past activity while Rauch et al. <xref ref-type="bibr" rid="pcbi.1002711-Rauch1">[43]</xref> calculated the effective rate in integrate-and-fire neurons endowed with a frequency-dependent modification of the input current. Finally, there is also a sixth method to determine the population activity of adapting populations. Inspired by the Fokker-Planck approach for integrate-and-fire neurons <xref ref-type="bibr" rid="pcbi.1002711-Brunel1">[27]</xref>, this last approach finds the population activity by evolving probability distributions of one or several state variables <xref ref-type="bibr" rid="pcbi.1002711-Treves1">[45]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Farkhooi1">[49]</xref>. Isolating the population activity then involves solving a non-linear system of partial differential equations.</p>
      <p>The results described in the present article are based on two principal insights. The first one is that adaptation reduces the effect of the stimulus primarily as a function of the expected number of spikes in the recent history and only secondarily as a function of the higher moments of the spiking history such as spike-spike correlations. We derive such an expansion of the history moments from the single neuron parameters. The second insight is that the effects of the refractory period are well captured by renewal theory and can be superimposed on the effects of adaptation.</p>
      <p>The article is organized as follows: after a description of the population dynamics, we derive a mathematical expression that predicts the momentary value of the population activity from current and past values of the input. Then, we verify that the resulting encoding framework accurately describes the response to input steps. We also study the accuracy of the encoding framework in response to fluctuating stimuli and analyze the problem of decoding. Finally, we compare with simpler theories such as renewal theory and a truncated expansion of the past history moments.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <p>To keep the discussion transparent, we focus on a population of unconnected neurons. Our results can be generalized to coupled populations using standard theoretical methods <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Brunel1">[27]</xref>.</p>
      <sec id="s2a">
        <title>Encoding Time-dependent Stimuli in the Population Activity</title>
        <p>How does a population of adapting neurons encode a given stimulating current <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e004" xlink:type="simple"/></inline-formula>? Each neuron in the population will produce a spike train, denoted by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e005" xlink:type="simple"/></inline-formula>, such that the population can be said to respond with a set of spike trains. Using the population approach, we want to know how the stimulus is reflected in the fraction of neurons that are active at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e006" xlink:type="simple"/></inline-formula>, that is, the population activity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e007" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002711-g001">Fig. 1</xref>). The population activity (or instantaneous rate of the population) is a biologically relevant quantity in the sense that a post-synaptic neuron further down the processing stream receives inputs from a whole population of presynaptic neurons and is therefore at each moment in time driven by the spike arrivals summed over the presynaptic population, <italic>i. e.</italic> the presynaptic population activity.</p>
        <p>Mathematically, we consider a set of spike trains in which spikes are represented by Dirac-pulses centered on the spike time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e008" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e009" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>. The population activity is defined as the expected proportion of active neurons within an infinitesimal time interval. It corresponds, in the limit of a large population and small time interval, to the number of active neurons <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e010" xlink:type="simple"/></inline-formula> in the time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e011" xlink:type="simple"/></inline-formula> divided by the total number of neurons <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e012" xlink:type="simple"/></inline-formula> and the time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e013" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>:<disp-formula id="pcbi.1002711.e014"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e014" xlink:type="simple"/><label>(1)</label></disp-formula>The angular brackets <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e015" xlink:type="simple"/></inline-formula> denote the expected value over an ensemble of identical neurons. Experimentally, the population activity is estimated on a finite time interval and for a finite population. Equivalently the population activity can be considered as an average over independent presentations of a stimulus in only one neuron. In this sense, the population activity is equivalent to both the time-dependent firing intensity and the Peri-Stimulus Time Histogram (PSTH).</p>
        <p>Since the population activity represents the instantaneous firing probability, it is different from the conditional firing intensity, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e016" xlink:type="simple"/></inline-formula>, which further depends on the precise spiking history, or past spike train <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e017" xlink:type="simple"/></inline-formula>. Suppose we have observed a single neuron for a long time (e.g. 10 seconds). During that time we have recorded its time dependent input current <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e018" xlink:type="simple"/></inline-formula> and observed its firing times <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e019" xlink:type="simple"/></inline-formula>. Knowing the firing history <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e020" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e021" xlink:type="simple"/></inline-formula> and the time-dependent driving current <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e022" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e023" xlink:type="simple"/></inline-formula>, the variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e024" xlink:type="simple"/></inline-formula> describes the instantaneous rate of the neuron to fire again at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e025" xlink:type="simple"/></inline-formula>. Intuitively, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e026" xlink:type="simple"/></inline-formula> reflects a likelihood to spike at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e027" xlink:type="simple"/></inline-formula> for a neuron having a specific history while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e028" xlink:type="simple"/></inline-formula> is the firing rate at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e029" xlink:type="simple"/></inline-formula> averaged on all possible histories (see <xref ref-type="sec" rid="s4">Methods</xref>):<disp-formula id="pcbi.1002711.e030"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e030" xlink:type="simple"/><label>(2)</label></disp-formula></p>
        <p>Ideally, one could hope to estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e031" xlink:type="simple"/></inline-formula> directly from the data. However, given the dimensionality of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e032" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e033" xlink:type="simple"/></inline-formula>, model-free estimation is not feasible. Instead we use the Spike Response Model (SRM; <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Gerstner6">[50]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Gerstner7">[52]</xref>), which is an example of a Generalized Linear Model <xref ref-type="bibr" rid="pcbi.1002711-Paninski1">[53]</xref>, in order to parametrize <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e034" xlink:type="simple"/></inline-formula>, but other parametrizations outside the exponential family are also possible. In particular, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e035" xlink:type="simple"/></inline-formula> can also be defined for nonlinear neuron models with diffusive noise in the input, even though explicit expressions are not available. The validity of the SRM as a model of neuronal spike generation has been verified for various neuron types and various experimental protocols <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Pillow1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Jolivet1">[32]</xref>. In the SRM, the conditional firing intensity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e036" xlink:type="simple"/></inline-formula> increases with the effective input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e037" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002711.e038"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e038" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e039" xlink:type="simple"/></inline-formula> is the total driving force of the neuron:<disp-formula id="pcbi.1002711.e040"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e040" xlink:type="simple"/><label>(4)</label></disp-formula>where ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e041" xlink:type="simple"/></inline-formula>’ denotes the convolution, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e042" xlink:type="simple"/></inline-formula> is the input current convolved with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e043" xlink:type="simple"/></inline-formula> the membrane filter, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e044" xlink:type="simple"/></inline-formula> encodes the effect of each spike on the probability of spiking, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e045" xlink:type="simple"/></inline-formula> is a scaling constant related to the instantaneous rate at the threshold with units of inverse time (see <xref ref-type="sec" rid="s4">Methods</xref> for model parameters). The link-function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e046" xlink:type="simple"/></inline-formula> can take different shapes depending on the noise process <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>. Here we will use an exponential link-function since it was shown to fit the noisy adaptive-exponential-integrate-and-fire model <xref ref-type="bibr" rid="pcbi.1002711-Mensi2">[54]</xref> as well as experimental data <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Jolivet1">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Pillow2">[55]</xref>. The exponential link-function: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e047" xlink:type="simple"/></inline-formula> corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e048" xlink:type="simple"/></inline-formula> after absorbing the scaling parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e049" xlink:type="simple"/></inline-formula> in the constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e050" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e051" xlink:type="simple"/></inline-formula> and in the functions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e052" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e053" xlink:type="simple"/></inline-formula> to make these unit-free.</p>
        <p>To see that the function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e054" xlink:type="simple"/></inline-formula> can implement both adaptation and refractoriness, let us first distinguish these processes conceptually. The characteristic signature of refractoriness is that the interspike interval distribution for constant input is zero or close to zero for very short intervals (e.g. one millisecond) - and in the following we use this characteristic signature as a definition of refractoriness. With this definition, a Hodgkin-Huxley model (with or without noise) or a leaky integrate-and-fire model (with or without diffusive noise) are refractory, whereas a Linear-Nonlinear-Poisson Model is not. In fact, every neuron model with intrinsic dynamics exhibits refractoriness, but Poissonian models do not.</p>
        <p>While refractoriness refers to the interspike-interval distribution and therefore to the dependence upon the <italic>most recent</italic> spike, adaptation refers to the effect of multiple spikes. Adaptation is most clearly observed as a successive increase of interspike intervals in response to a step current. In contrast, a renewal model <xref ref-type="bibr" rid="pcbi.1002711-Cox1">[56]</xref>, where interspike intervals are independent of each other, does not exhibit adaptation (but does exhibit refractoriness). Similarly, a leaky or exponential integrate-and-fire model with diffusive noise does not show adaptation. A Hodgkin-Huxley model with the original set of parameters exhibits very little adaptation, but addition of a slow ion current induces adaptation.</p>
        <p>Conceptually, contributions of multiple spikes must accumulate to generate spike frequency adaptation. In the Spike Response Model, this accumulation is written as a convolution: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e055" xlink:type="simple"/></inline-formula>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e056" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e057" xlink:type="simple"/></inline-formula> and vanishes elsewhere, the model exhibits absolute refractoriness of duration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e058" xlink:type="simple"/></inline-formula> but no adaptation. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e059" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e060" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e061" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e062" xlink:type="simple"/></inline-formula> ms, then the model exhibits adaptation in addition to refractoriness. In all the simulations, we use <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e063" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e064" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e065" xlink:type="simple"/></inline-formula>, With this choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e066" xlink:type="simple"/></inline-formula> we are in agreement with experimental results on cortical neurons <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>, but the effects of adaptation and refractoriness cannot be separated as clearly as in the case of a model with absolute refractoriness. Loosely speaking, the long time constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e067" xlink:type="simple"/></inline-formula> causes adaptation, whereas the short time constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e068" xlink:type="simple"/></inline-formula> mainly contributes to refractoriness. In fact, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e069" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e070" xlink:type="simple"/></inline-formula> equal to the membrane time constant, the model becomes equivalent to a leaky integrate-and-fire neuron <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>, so that the neuron is refractory and non-adapting. In the simulations, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e071" xlink:type="simple"/></inline-formula> is longer than the membrane time constant so that, for very strong stimuli, it may also contribute to adaptation. We note that the formalism developed in this paper does not rely on our specific choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e072" xlink:type="simple"/></inline-formula>. We only require (i) causality by imposing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e073" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e074" xlink:type="simple"/></inline-formula> and (ii) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e075" xlink:type="simple"/></inline-formula> so that the effect of a past spike decreases over time.</p>
        <p>The effects described by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e076" xlink:type="simple"/></inline-formula> can be mediated by a dynamic threshold as well as spike-triggered currents <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>. Throughout the remainder of the text we will refer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e077" xlink:type="simple"/></inline-formula> as the effective spike after-potential (SAP). It is, however, important to note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e078" xlink:type="simple"/></inline-formula> has no units, <italic>i.e.</italic> it relates to an appropriately scaled version of the experimentally measured spike after-potential. A depolarizing (facilitating) SAP is associated with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e079" xlink:type="simple"/></inline-formula>, while a hyperpolarizing (adapting) SAP is associated with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e080" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s2b">
        <title>Quasi-Renewal Theory</title>
        <p>In a population of neurons, every neuron has a different spiking history defined by its past spike train <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e081" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e082" xlink:type="simple"/></inline-formula> is the most recent spike, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e083" xlink:type="simple"/></inline-formula> the previous one and so on. To find the population activity at any given time, we hypothesize that the strong effect of the most recent spike needs to be considered explicitly while the rest of the spiking history merely introduces a self-inhibition that is similar for all neurons and that depends only on the average firing profile in the past. Thus for each neuron we write the past spike train as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e084" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e085" xlink:type="simple"/></inline-formula> is the time of the <italic>last</italic> spike. Our hypothesis corresponds to the approximation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e086" xlink:type="simple"/></inline-formula>, <italic>i.e.</italic> the last spike needs to be treated explicitly, but we may average across earlier spike times. This approximation is not appropriate for intrinsically bursting neurons, but it should apply well to other cell types (fast-spiking, non-fast-spiking, delayed, low-threshold). According to this hypothesis, and in analogy to the time-dependent renewal theory <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Gerstner5">[42]</xref> we find (derivation in <xref ref-type="sec" rid="s4">Methods</xref>):<disp-formula id="pcbi.1002711.e087"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e087" xlink:type="simple"/><label>(5)</label></disp-formula>Unfortunately <xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eq. 5</xref> remains insolvable, because we do not know <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e088" xlink:type="simple"/></inline-formula>. Using <xref ref-type="disp-formula" rid="pcbi.1002711.e038">Eqs. 3</xref> and <xref ref-type="disp-formula" rid="pcbi.1002711.e040">4</xref> we find:<disp-formula id="pcbi.1002711.e089"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e089" xlink:type="simple"/><label>(6)</label></disp-formula>As mentioned above, we hypothesize that the spiking history before the previous spike merely inhibits subsequent firing as a function of the average spiking profile in the past. In order to formally implement such an approximation, we introduce a series expansion <xref ref-type="bibr" rid="pcbi.1002711-vanKampen1">[57]</xref> in terms of the spiking history moments (derivation in <xref ref-type="sec" rid="s4">Methods</xref>) where we exploit the fact that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e090" xlink:type="simple"/></inline-formula> is a moment generating function:<disp-formula id="pcbi.1002711.e091"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e091" xlink:type="simple"/><label>(7)</label></disp-formula>The first history moment <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e092" xlink:type="simple"/></inline-formula> relates to the expected number of spikes at a given time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e093" xlink:type="simple"/></inline-formula>. The second history moment considers the spike-spike correlations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e094" xlink:type="simple"/></inline-formula> and so on for the higher moments.</p>
        <p>We truncate the series expansion resulting from <xref ref-type="disp-formula" rid="pcbi.1002711.e091">Eq. 7</xref> at the first order (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e095" xlink:type="simple"/></inline-formula>). We can then write <xref ref-type="disp-formula" rid="pcbi.1002711.e089">Eq. 6</xref> as:<disp-formula id="pcbi.1002711.e096"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e096" xlink:type="simple"/><label>(8)</label></disp-formula>We can insert <xref ref-type="disp-formula" rid="pcbi.1002711.e096">Eq. 8</xref> in <xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eq. 5</xref> so as to solve for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e097" xlink:type="simple"/></inline-formula> as a function of the filtered input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e098" xlink:type="simple"/></inline-formula>. The solutions can be found using numerical methods.</p>
        <p>We note that by removing the integral of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e099" xlink:type="simple"/></inline-formula> from <xref ref-type="disp-formula" rid="pcbi.1002711.e096">Eq. 8</xref> we return exactly to the renewal equation for population activity (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e100" xlink:type="simple"/></inline-formula>). Adaptation reduces the driving force by an amount proportional to the average spike density before <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e101" xlink:type="simple"/></inline-formula>, that is, the average spiking density before the most recent spike. In other words, instead of using the specific spike history of a given neuron, we work with the average history except for the most recent spike which we treat explicitly. We call <xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eqs. 5</xref> and <xref ref-type="disp-formula" rid="pcbi.1002711.e096">8</xref> the Quasi-Renewal equation (QR) to acknowledge its theoretical foundations. It is renewal-like, yet, we do not assume the renewal condition since a new spike does not erase the effect of the previous history (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
      </sec>
      <sec id="s2c">
        <title>Encoding and Decoding Time-Dependent Stimuli</title>
        <p>Let us now assess the domain of validity of the QR theory by comparing it with direct simulations of a population of SRM neurons. To describe the single neurons dynamics, we use a set of parameters characteristic of L2–3 pyramidal cells <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>. The SAP is made of two exponentials: one with a short time constant (30 ms) but large amplitude and another with a long time constant (400 ms) but a small amplitude. The results presented here are representative of results that can be obtained for any other physiological set of parameters. For details on the simulation, see <xref ref-type="sec" rid="s4">Methods</xref>.</p>
        <p>The response to a step increase in stimulating current is a standard paradigm to assess adaptation in neurons and used here as a qualitative test of our theory. We use three different step amplitudes: weak, medium and strong. The response of a population of, say, 25,000 model neurons to a <italic>strong</italic> step increase in current starts with a very rapid peak of activity. Indeed, almost immediately after the strong stimulus onset, most of the neurons are triggered to emit a spike. Immediately after firing at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e102" xlink:type="simple"/></inline-formula>, the membrane potential of theses neurons is reset to a lower value by the contribution of the SAP; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e103" xlink:type="simple"/></inline-formula>. The lower membrane potential leads to a strong reduction of the population activity. Neurons which have fired at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e104" xlink:type="simple"/></inline-formula> are ready to fire again only after the SAP has decreased sufficiently so that the membrane potential can approach again the threshold <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e105" xlink:type="simple"/></inline-formula>. We can therefore expect that a noiseless population of neurons will keep on oscillating with the intrinsic firing frequency of the neurons <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref>; however, due to stochastic spike emission of a noisy population the neurons in the population gradually de-synchronize. The damped-oscillation that we see in response to a strong step stimulus (<xref ref-type="fig" rid="pcbi-1002711-g002">Fig. 2C</xref>) is the result of this gradual de-synchronization. Similar damped oscillations at the intrinsic firing frequency of the neurons have also been observed for a Spike Response Model with renewal properties <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref>, i.e., a model that only remembers the effect of the last spike.</p>
        <fig id="pcbi-1002711-g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002711.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Quasi-renewal theory for step responses with realistic SAP.</title>
            <p>(<bold>A–C</bold>) Population activity responses (top panels; PSTH from 25,000 repeated simulations in blue, quasi-renewal theory in black) to the step current input as shown in bottom panels (black). The input step size was increased from <bold>A</bold> to <bold>C</bold>. The mean first and last interspike interval were 458<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e106" xlink:type="simple"/></inline-formula>2 ms and 504<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e107" xlink:type="simple"/></inline-formula>2 ms, respectively, in <bold>A</bold>, 142.1<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e108" xlink:type="simple"/></inline-formula>0.4 and 214<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e109" xlink:type="simple"/></inline-formula>1 ms in <bold>B</bold>, 93.5<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e110" xlink:type="simple"/></inline-formula>0.2 and 163.2<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e111" xlink:type="simple"/></inline-formula>0.5 ms in <bold>C</bold>. (<bold>D</bold>) Steady-state activity vs. input current for simulations of 25,000 independent neurons (blue) and quasi-renewal theory (black). The SAP was fixed to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e112" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>. For other model parameters see Models and <xref ref-type="sec" rid="s4">Methods</xref>.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.g002" xlink:type="simple"/>
        </fig>
        <p>In contrast to renewal models (i.e., models with refractoriness but no adaptation), we observe in <xref ref-type="fig" rid="pcbi-1002711-g002">Fig. 2C</xref> that the population activity decays on a slow time scale, taking around one second to reach a steady state. This long decay is due to adaptation in the single-neuron dynamics, here controlled by the slow time constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e113" xlink:type="simple"/></inline-formula> ms. The amount of adaptation can be quantified if we compare, for a given neuron its first interspike interval after stimulus onset with the last interspike interval. The mean first interspike interval (averaged over all neurons) for the strong step stimulus is 93 ms while the last interval is nearly twice as long (163 ms), indicating strong adaptation. For smaller steps, the effect of refractoriness is less important so that adaptation becomes the most prominent feature of the step response (<xref ref-type="fig" rid="pcbi-1002711-g002">Fig. 2A</xref>). An appropriate encoding framework should reproduce both the refractoriness-based oscillations and the adaptation-based decay.</p>
        <p>The QR equation describes well both the damped oscillation and the adapting tail of the population activity response to steps (<xref ref-type="fig" rid="pcbi-1002711-g002">Fig. 2</xref>). Also, the steady state activity is predicted over a large range (<xref ref-type="fig" rid="pcbi-1002711-g002">Fig. 2D</xref>). We note that an adaptation mechanism that is essentially subtractive on the membrane potential (<xref ref-type="disp-formula" rid="pcbi.1002711.e040">Eq. 4</xref>) leads here to a divisive effect on the frequency-current curve. Altogether, we conclude the QR theory accurately encode the response to step stimulus.</p>
        <p>Step changes in otherwise constant input are useful for qualitative assessment of the theory but quite far from natural stimuli. Keeping the same SAP as in <xref ref-type="fig" rid="pcbi-1002711-g002">Fig. 2</xref>, we replace the piecewise-constant input by a fluctuating current (here Ornstein-Uhlenbeck process) and study the validity of QR over a range of input mean and standard deviation (STD), see <xref ref-type="fig" rid="pcbi-1002711-g003">Fig. 3</xref>. As the STD of the input increases, the response of the population reaches higher activities (maximum activity at STD = 80 pA was 89 Hz). The prediction by the QR theory is almost perfect with correlation coefficients consistently higher than 0.98. Note that the correlation coefficient is bounded above by the finite-size effects in estimating the average of the 25,000-neuron simulation. Over the range of input studied, there was no tendency of either overestimating or underestimating the population activity (probability of positive error was 0.5). There was only a weak tendency of increased discrepancies between theory and simulation at higher activity (correlation coefficient between simulated activity and mean square error was 0.25).</p>
        <fig id="pcbi-1002711-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002711.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Encoding time-dependent stimuli in the population activity.</title>
            <p>(<bold>A</bold>) Population activity responses (middle panel; PSTH from 25,000 repeated simulations in blue, quasi-renewal theory in black) to the time-dependent stimuli shown in the bottom panel (black). The difference between direct simulation and theory is shown in the top panel. The stimulus is an Ornstein-Uhlenbeck process with correlation time constant of 300 ms, a STD increasing every 2 seconds (20,40,60 pA) and a mean of 10 pA. (<bold>B</bold>) Correlation coefficients between direct simulation and QR for various STDs and mean (in pA) of the input current.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.g003" xlink:type="simple"/>
        </fig>
        <p>Decoding the population activity requires solving the QR equation (<xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eq. 5</xref> and <xref ref-type="disp-formula" rid="pcbi.1002711.e096">8</xref>) for the original input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e114" xlink:type="simple"/></inline-formula> (see <xref ref-type="sec" rid="s4">Methods</xref>). Input steps can be correctly decoded (<xref ref-type="fig" rid="pcbi-1002711-g004">Fig. 4A–C</xref>) but also fluctuating stimuli (<xref ref-type="fig" rid="pcbi-1002711-g004">Fig. 4D–E</xref>). Again, the input mean does not influence the precision of the decoding (<xref ref-type="fig" rid="pcbi-1002711-g004">Fig. 4E</xref>). The numerical method does not decode regions associated with population activities that are either zero or very small. Accordingly, the correlation coefficient in <xref ref-type="fig" rid="pcbi-1002711-g004">Fig. 4E</xref> is calculated only at times where decoding could be carried out. Note that unless one is to estimate the statistics of the input current and assume stationarity, it is impossible for any decoder to decode at times when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e115" xlink:type="simple"/></inline-formula>. If the size of the population is decreased, the performance of the QR decoder decreases (<xref ref-type="supplementary-material" rid="pcbi.1002711.s001">Fig. S1</xref>). Finite size effects limit decoding performance by increasing the error on the mean activity (as can be seen by comparing the effect of filtering the average population activity (<xref ref-type="supplementary-material" rid="pcbi.1002711.s001">Fig. S1A and B</xref>)). Another finite-size effect is that at small population sizes there is a greater fraction of time where an estimate of the activity is zero and the decoding cannot be performed (<xref ref-type="supplementary-material" rid="pcbi.1002711.s001">Fig. S1D</xref>–F). Also, decoding errors are larger when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e116" xlink:type="simple"/></inline-formula> is close to zero (<xref ref-type="supplementary-material" rid="pcbi.1002711.s001">Fig. S1C</xref>). Nevertheless, for an input with STD = 40 pA and a population of 250 neurons, QR decoding can be performed 55% of the times with a correlation coefficient of 0.92. If the filtering of the population activity is on a longer time scale (20 ms instead of 2 ms) then decoding is possible 82% of the times and the accuracy is roughly the same (<xref ref-type="supplementary-material" rid="pcbi.1002711.s001">Fig. S1</xref>).</p>
        <fig id="pcbi-1002711-g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002711.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Decoding the stimulus from the population activity.</title>
            <p>(<bold>A</bold>–<bold>C</bold>) The original (bottom panels, black line) and decoded stimulus (bottom panels, red line; arbitrary units) recovered from the PSTH of 25,000 independent SRM neurons (top panels; blue line) with the QR decoder (<xref ref-type="disp-formula" rid="pcbi.1002711.e340">Eq. 45</xref>). (<bold>D</bold>) Same as before but for time-dependent input. The decoded waveform of negative input is occasionally undefined and corresponds to input outside the dynamic range. The difference between direct simulation and theory is shown in the bottom panel. (<bold>E</bold>) Correlation coefficient between original and decoded input as a function of input STD, shown for three distinct mean input (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e117" xlink:type="simple"/></inline-formula> pA, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e118" xlink:type="simple"/></inline-formula> pA, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e119" xlink:type="simple"/></inline-formula> pA). Decoding based on quasi-renewal theory (<xref ref-type="sec" rid="s4">Methods</xref>).</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.g004" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2d">
        <title>Comparing Population Encoding Theories</title>
        <p>We will consider two recent theories of population activity from the literature. Both can be seen as extensions of rate models such as the Linear-Nonlinear Poisson model where the activity of a homogeneous population is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e120" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e121" xlink:type="simple"/></inline-formula> is a linear filter and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e122" xlink:type="simple"/></inline-formula> some nonlinear function. First, we focus on adaptive formulations of such rate models. For example Benda and Herz <xref ref-type="bibr" rid="pcbi.1002711-Benda1">[15]</xref> have suggested that the firing rate of adapting neurons is a non-linear function of an input that is reduced by the past activity, such that the activity is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e123" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e124" xlink:type="simple"/></inline-formula> is a self interaction filter that summarizes the effect of adaptation. Second, we compare our approach with renewal theory <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Gerstner5">[42]</xref> which includes refractoriness, but not adaptation. How does our QR theory relate to these existing theories? And how would these competing theories perform on the same set of step stimuli?</p>
        <p>To discuss the relation to existing theories, we recall that the instantaneous rate of our model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e125" xlink:type="simple"/></inline-formula> depends on both the input and the previous spike trains. In QR theory, we single out the most recent spike at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e126" xlink:type="simple"/></inline-formula> and averaged over the remaining spike trains <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e127" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e128" xlink:type="simple"/></inline-formula>. There are two alternative approaches. One can keep the most recent spike at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e129" xlink:type="simple"/></inline-formula> and disregard the effect of all the others: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e130" xlink:type="simple"/></inline-formula>. This gives rise to the time-dependent renewal theory, which will serve as a first reference for the performance comparison discussed below. On the other hand, one can average over <italic>all</italic> previous spikes, that is, no special treatment for the most recent one. In this case<disp-formula id="pcbi.1002711.e131"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e131" xlink:type="simple"/><label>(9)</label></disp-formula>The right-hand side of <xref ref-type="disp-formula" rid="pcbi.1002711.e131">Eq. 9</xref> can be treated with a moment expansion similar to the one in <xref ref-type="disp-formula" rid="pcbi.1002711.e091">Eq. 7</xref>. To zero order, this gives a population rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e132" xlink:type="simple"/></inline-formula>, that is, an instantiation of the LNP model. To first order in an event-based moment expansion (EME1) we find:<disp-formula id="pcbi.1002711.e133"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e133" xlink:type="simple"/><label>(10)</label></disp-formula>Therefore, the moment expansion (<xref ref-type="disp-formula" rid="pcbi.1002711.e091">Eq. 7</xref>) offers a way to link the phenomenological framework of Benda and Herz (2003) to parameters of the SRM. In particular, the nonlinearity is the exponential function, the input term is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e134" xlink:type="simple"/></inline-formula> and the self-inhibition filter is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e135" xlink:type="simple"/></inline-formula>. We note that <xref ref-type="disp-formula" rid="pcbi.1002711.e133">Eq. 10</xref> is a self-consistent equation for the population activity valid in the limit of small coupling between the spikes which can be solved using standard numerical methods (see <xref ref-type="sec" rid="s4">Methods</xref>). A second-order equation (EME2) can similarly be constructed using an approximation to the correlation function (see <xref ref-type="sec" rid="s4">Methods</xref>).</p>
        <p>We compare the prediction of EME1, EME2 and renewal theory with the simulated responses to step inputs (<xref ref-type="fig" rid="pcbi-1002711-g005">Fig. 5</xref>). All the encoding frameworks work well for small input amplitudes (<xref ref-type="fig" rid="pcbi-1002711-g005">Fig. 5A</xref>). It is for larger input steps that the different theories can be distinguished qualitatively (<xref ref-type="fig" rid="pcbi-1002711-g005">Fig. 5C</xref>). Renewal theory predicts accurately the initial damped oscillation as can be expected by its explicit treatment of the relative refractory period. The adapting tail, however, is missing. The steady state is reached too soon and at a level which is systematically too high. EME1 is more accurate in its description of the adapting tail but fails to capture the damped oscillations. The strong refractory period induces a strong coupling between the spikes which means that truncating to only the first moment is insufficient. The solution based on EME2 improves the accuracy upon that of EME1 so as to make the initial peak shorter, but oscillates only weakly. We checked that the failure of the moment-expansion approach is due to the strong refractory period by systematically modifying the strength of the SAP (<xref ref-type="supplementary-material" rid="pcbi.1002711.s002">Fig. S2</xref>). Similarly, when the SAP is weak, the effect of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e136" xlink:type="simple"/></inline-formula> will often accumulate over several spikes and renewal theory does not capture the resulting adaptation (<xref ref-type="supplementary-material" rid="pcbi.1002711.s002">Fig. S2</xref>).</p>
        <fig id="pcbi-1002711-g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002711.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Approximative theories.</title>
            <p>(<bold>A</bold>–<bold>C</bold>) Population activity responses (top panels; PSTH from 25,000 repeated simulations in blue, renewal theory in black, first order moment expansion (EME1) in red, second order (EME2) in green) to the step current input (bottom panels; black). (<bold>D</bold>) Activity at the steady state vs. input current as calculated from the direct simulation of 25,000 model neurons (blue squares, error bars show one standard error of the mean), prediction from renewal theory (black), and 1st order moment-expansion (red, <xref ref-type="disp-formula" rid="pcbi.1002711.e394">Eq. 51</xref>).</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.g005" xlink:type="simple"/>
        </fig>
        <p>Fluctuating input makes the population respond in peaks of activity separated by periods of quiescence. This effectively reduces the coupling between the spikes and therefore improves the accuracy of EME1. The validity of EME1 for encoding time-dependent stimulus (<xref ref-type="supplementary-material" rid="pcbi.1002711.s003">Fig. S3</xref>) decreases with the STD of the fluctuating input with no clear dependence on the input mean.</p>
        <p>Decoding with EME1 is done according to a simple relation:<disp-formula id="pcbi.1002711.e137"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e137" xlink:type="simple"/><label>(11)</label></disp-formula>where the logarithm of the momentary population activity is added to an accumulation of the past activity. The presence of the logarithm reflects the non-linearity for encoding (the link-function in <xref ref-type="disp-formula" rid="pcbi.1002711.e038">Eq. 3</xref>) and leads to the fact that when the instantaneous population activity is zero, the stimulus is undefined but bounded from above: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e138" xlink:type="simple"/></inline-formula>. <xref ref-type="supplementary-material" rid="pcbi.1002711.s004">Fig. S4</xref> shows the ability of <xref ref-type="disp-formula" rid="pcbi.1002711.e137">Eq. 11</xref> to recover the input from the population activity of 25,000 model neurons. We conclude that <xref ref-type="disp-formula" rid="pcbi.1002711.e137">Eq. 11</xref> is a valid decoder in the domain of applicability of EME1.</p>
        <p>In summary, the EMEs yield theoretical expressions for the time-dependent as well as steady-state population activity. These expressions are valid in the limit of small coupling between the spikes which corresponds to either large interspike intervals or small SAP. Renewal theory on the other hand is valid when the single-neuron dynamics does not adapt and whenever the refractory effects dominate.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>The input-output function of a neuron population is sometimes described as a linear filter of the input <xref ref-type="bibr" rid="pcbi.1002711-Wilson1">[41]</xref>, as a linear filter of the input reduced as a function of past activity <xref ref-type="bibr" rid="pcbi.1002711-Hawkes1">[58]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Pernice1">[59]</xref>, as a non-linear function of the filtered input <xref ref-type="bibr" rid="pcbi.1002711-Schwartz2">[60]</xref>, or by any of the more recent population encoding frameworks <xref ref-type="bibr" rid="pcbi.1002711-Richardson1">[47]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Toyoizumi1">[48]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Knight1">[61]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Muller2">[65]</xref>. These theories differ in their underlying assumptions. To the best of our knowledge, a closed-form expression that does not assume weak refractoriness or weak adaptation has not been published before.</p>
      <p>We have derived self-consistent formulas for the population activity of independent adapting neurons. There are two levels of approximation, EME1 (<xref ref-type="disp-formula" rid="pcbi.1002711.e133">Eq. 10</xref>) is valid at low coupling between spikes which can be observed in real neurons whenever (i) the interspike intervals are large, (ii) the SAPs have small amplitudes or (iii) both the firing rate is low and the SAPs have small amplitudes. The second level of approximation merges renewal theory with the moment-expansion to give an accurate description on all time-scales. We called this approach the QR theory.</p>
      <p>The QR equation captures almost perfectly the population code for time-dependent input even at the high firing rates observed in retinal ganglion cells <xref ref-type="bibr" rid="pcbi.1002711-Pillow2">[55]</xref>. But for the large interspike intervals and lower population activity levels of <italic>in vivo</italic> neurons of the cortex <xref ref-type="bibr" rid="pcbi.1002711-deKock1">[66]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Crochet1">[67]</xref>, it is possible that the simpler encoding scheme of <xref ref-type="disp-formula" rid="pcbi.1002711.e133">Eq. 10</xref> is sufficient. Most likely, the appropriate level of approximation will depend on the neural system; cortical sparse coding may be well represented by EME, while neuron populations in the early stages of perception may require QR.</p>
      <p>We have focused here on the Spike Response Model with escape noise which is an instantiation of a Generalized Linear Model. The escape noise model, defined as the instantaneous firing rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e139" xlink:type="simple"/></inline-formula> given the momentary distance between the (deterministic) membrane potential and threshold should be contrasted with the diffusive noise model where the membrane potential fluctuates because of noisy input. Nevertheless, the two noise models have been linked in the past <xref ref-type="bibr" rid="pcbi.1002711-Plesser1">[51]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Mensi2">[54]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Herrmann1">[68]</xref>. For example, the interval-distribution of a leaky integrate-and-fire model with diffusive noise and arbitrary input can be well captured by escape noise with instantaneous firing rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e140" xlink:type="simple"/></inline-formula> which depends both on the membrane potential and its temporal derivative <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e141" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002711-Plesser1">[51]</xref>. The dependence upon <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e142" xlink:type="simple"/></inline-formula> accounts for the rapid and replicable response that one observes when an integrate-and-fire model with diffusive noise is driven in the supra-threshold regime <xref ref-type="bibr" rid="pcbi.1002711-Herrmann1">[68]</xref> and can, in principle, be included in the framework of the QR theory.</p>
      <p>The decoding schemes presented in this paper (<xref ref-type="disp-formula" rid="pcbi.1002711.e137">Eq. 11</xref> and <xref ref-type="disp-formula" rid="pcbi.1002711.e340">45</xref>) reveal a fundamental aspect of population coding with adapting neurons. Namely, the ambiguity introduced by the adaptation can be resolved by considering a well-tuned accumulator of past activity. The neural code of adapting populations is ambiguous because the momentary level of activity could be the result of different stimulus histories. We have shown that resolving the ambiguity requires the knowledge of the activity in the past but to a good approximation does not require the knowledge of which neuron was active. At high population activity for neurons with large SAPs, however, the individual timing of the last spike in the spike trains is required to resolve the ambiguity (compare also Fairhall <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002711-Fairhall1">[13]</xref>). Unlike bayesian spike-train decoding <xref ref-type="bibr" rid="pcbi.1002711-Pillow2">[55]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Paninski2">[69]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Koyama1">[70]</xref>, we note that in our decoding frameworks the operation requires only knowledge of the population activity history and the single neuron characteristics. The properties of the QR or EME1 decoder can be used to find biophysical correlates of neural decoding such as previously proposed for short term plasticity <xref ref-type="bibr" rid="pcbi.1002711-Sen1">[71]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Pfister1">[72]</xref>, non-linear dendrites <xref ref-type="bibr" rid="pcbi.1002711-Polsky1">[73]</xref> or lateral inhibition <xref ref-type="bibr" rid="pcbi.1002711-Carandini1">[74]</xref>. Note that, a constant percept in spite of spike frequency adaptation does not necessarily mean that neurons use a QR decoder. It depends on the synaptic structure. In an over-representing cortex, a constant percept can be achieved even when the neurons exhibit strong adaptation transients <xref ref-type="bibr" rid="pcbi.1002711-Druckmann1">[75]</xref>.</p>
      <p>Using the results presented here, existing mean-field methods for populations of spiking neurons can readily be adapted to include spike-frequency adaptation. In <xref ref-type="sec" rid="s4">Methods</xref> we show the QR theory for the interspike interval distribution and the steady-state autocorrelation function (<xref ref-type="fig" rid="pcbi-1002711-g006">Fig. 6</xref>) as well as linear filter characterizing the impulse response function (or frequency-dependent gain function) of the population. From the linear filter and the autocorrelation function, we can calculate the signal-to-noise ratio <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref> and thus the transmitted information <xref ref-type="bibr" rid="pcbi.1002711-Rieke1">[1]</xref>. The autocorrelation function also gives an estimate of the coefficient of variation <xref ref-type="bibr" rid="pcbi.1002711-Softky1">[76]</xref> and clarifies the role of the SAP in quenching the spike count variability <xref ref-type="bibr" rid="pcbi.1002711-Farkhooi1">[49]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Liu1">[77]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Wang1">[78]</xref>. The finite-size effects <xref ref-type="bibr" rid="pcbi.1002711-Brunel1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Spiridon1">[79]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Buice1">[81]</xref> is another, more challenging, extension that should be possible.</p>
      <fig id="pcbi-1002711-g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002711.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Steady-state interspike interval distribution and auto-correlation.</title>
          <p>(<bold>A</bold>)The interspike interval distribution calculated from the 25,000 repeated simulations of the SRM after the steady state has been reached (blue) is compared with the QR theory (<xref ref-type="disp-formula" rid="pcbi.1002711.e241">Eq. 31</xref>; black) for I = 60, 70 and 80 pA. (<bold>B</bold>) On the same regimen, the autocorrelation function calculated from direct simulations at the steady-state (blue) is compared with the QR prediction (<xref ref-type="disp-formula" rid="pcbi.1002711.e248">Eq. 33</xref>; black). See <xref ref-type="sec" rid="s4">Methods</xref> for model parameters.</p>
        </caption>
        <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.g006" xlink:type="simple"/>
      </fig>
      <p>The scope of the present investigation was restricted to unconnected neurons. In the mean-field approximation, it is straight-forward to extend the results to several populations of connected neurons <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref>. For instance, similar to EME1, a network made of inter-connected neurons of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e143" xlink:type="simple"/></inline-formula> cell-types would correspond to the self-consistent system of equation:<disp-formula id="pcbi.1002711.e144"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e144" xlink:type="simple"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e145" xlink:type="simple"/></inline-formula> is the scaled post-synaptic potential kernel from cell-type <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e146" xlink:type="simple"/></inline-formula> to cell-type <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e147" xlink:type="simple"/></inline-formula> (following the formalism of Gerstner and Kislter <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e148" xlink:type="simple"/></inline-formula> is an external driving force, each subpopulation is characterized by its population activity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e149" xlink:type="simple"/></inline-formula> and its specific spike after potential <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e150" xlink:type="simple"/></inline-formula>. The analogous equation for QR theory is:<disp-formula id="pcbi.1002711.e151"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e151" xlink:type="simple"/><label>(13)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e152" xlink:type="simple"/></inline-formula> is:<disp-formula id="pcbi.1002711.e153"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e153" xlink:type="simple"/><label>(14)</label></disp-formula>Since the SAP is one of the most important parameter for distinguishing between cell classes <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref>, the approach presented in this paper opens the door to network models that take into account the neuronal cell-types beyond the sign of the synaptic connection. Even within the same class of cells, real neurons have slightly different parameters from one cell to the next <xref ref-type="bibr" rid="pcbi.1002711-Mensi1">[22]</xref> and it remains to be tested whether we can describe a moderately inhomogeneous population with our theory. Also, further work will be required to see if the decoding methods presented here can be applied to brain-machine interfacing <xref ref-type="bibr" rid="pcbi.1002711-Chapin1">[82]</xref>–<xref ref-type="bibr" rid="pcbi.1002711-Koyama2">[84]</xref>.</p>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <p>This section is organized in 3 subsections. Subsection A covers the mathematical steps to derive the main theoretical results (<xref ref-type="disp-formula" rid="pcbi.1002711.e030">Eqs. 2</xref>, <xref ref-type="disp-formula" rid="pcbi.1002711.e087">5</xref> and <xref ref-type="disp-formula" rid="pcbi.1002711.e091">7</xref>). It also presents a new approach to the time-dependent renewal equation, links with renewal theory and the derivation of the steady-state interspike interval distribution and auto-correlation. Subsection B covers the numerical methods and algorithmic details and subsection C the analysis methods.</p>
      <sec id="s4a">
        <title>A Mathematical Methods</title>
        <sec id="s4a1">
          <title>Derivation of <xref ref-type="disp-formula" rid="pcbi.1002711.e030">Eq. 2</xref></title>
          <p>The probability density of a train of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e154" xlink:type="simple"/></inline-formula> spikes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e155" xlink:type="simple"/></inline-formula> in an interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e156" xlink:type="simple"/></inline-formula> is given by <xref ref-type="bibr" rid="pcbi.1002711-Pfister2">[85]</xref>:<disp-formula id="pcbi.1002711.e157"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e157" xlink:type="simple"/><label>(15)</label></disp-formula>where we omit writing the dependence on the input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e158" xlink:type="simple"/></inline-formula> for notational convenience. Here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e159" xlink:type="simple"/></inline-formula> is the spike train where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e160" xlink:type="simple"/></inline-formula> denotes the most recent spike, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e161" xlink:type="simple"/></inline-formula> the previous one and so on. Instead of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e162" xlink:type="simple"/></inline-formula> we can also write <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e163" xlink:type="simple"/></inline-formula>. Note that because of causality, at a time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e164" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e165" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e166" xlink:type="simple"/></inline-formula> can only depend on <italic>earlier</italic> spikes so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e167" xlink:type="simple"/></inline-formula>. Special care has to be taken because of the discontinuity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e168" xlink:type="simple"/></inline-formula> at the moment of the spike. We require <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e169" xlink:type="simple"/></inline-formula> so that it is excluded that two spikes occur at the same moment in time. By definition, the population activity is the expected value of a spike train: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e170" xlink:type="simple"/></inline-formula>. Following van Kampen <xref ref-type="bibr" rid="pcbi.1002711-vanKampen1">[57]</xref> we can integrate over all possible spike times in an ordered or non-ordered fashion. In the ordered fashion, each spike time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e171" xlink:type="simple"/></inline-formula> is restricted to times before the next spike time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e172" xlink:type="simple"/></inline-formula>. We obtain:<disp-formula id="pcbi.1002711.e173"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e173" xlink:type="simple"/><label>(16)</label></disp-formula>where the term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e174" xlink:type="simple"/></inline-formula> has been eliminated by the fact that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e175" xlink:type="simple"/></inline-formula>. The notation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e176" xlink:type="simple"/></inline-formula> is intended to remind the reader that a spike happening exactly at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e177" xlink:type="simple"/></inline-formula> is included in the integral. In fact only <italic>one</italic> Dirac-delta function gives a non-vanishing term because only the integral over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e178" xlink:type="simple"/></inline-formula> includes the time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e179" xlink:type="simple"/></inline-formula>. After integration over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e180" xlink:type="simple"/></inline-formula> we have:<disp-formula id="pcbi.1002711.e181"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e181" xlink:type="simple"/><label>(17)</label></disp-formula>Note that there are now <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e182" xlink:type="simple"/></inline-formula> integrals and the first integral is over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e183" xlink:type="simple"/></inline-formula> with an upper limit at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e184" xlink:type="simple"/></inline-formula>. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e185" xlink:type="simple"/></inline-formula> makes clear that the spike <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e186" xlink:type="simple"/></inline-formula> must be before the spike at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e187" xlink:type="simple"/></inline-formula>. In the ordered notation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e188" xlink:type="simple"/></inline-formula>. Re-labelling the infinite sum with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e189" xlink:type="simple"/></inline-formula>, one readily sees that we recover the weighting factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e190" xlink:type="simple"/></inline-formula> of a specific spike train with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e191" xlink:type="simple"/></inline-formula> spikes (<xref ref-type="disp-formula" rid="pcbi.1002711.e157">Eq. 15</xref>) in front of the momentary firing intensity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e192" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002711.e193"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e193" xlink:type="simple"/><label>(18)</label></disp-formula>Therefore we have shown <xref ref-type="disp-formula" rid="pcbi.1002711.e030">Eq. 2</xref>, which we repeat here in the notation of the present paragraph:<disp-formula id="pcbi.1002711.e194"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e194" xlink:type="simple"/><label>(19)</label></disp-formula>Note that the term with zero spikes in the past (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e195" xlink:type="simple"/></inline-formula>) contributes a term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e196" xlink:type="simple"/></inline-formula> to the sum.</p>
        </sec>
        <sec id="s4a2">
          <title>Derivation of <xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eq. 5</xref></title>
          <p>In order to single out the effect of the previous spike, we replace <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e197" xlink:type="simple"/></inline-formula> and group factors in the path integral of <xref ref-type="disp-formula" rid="pcbi.1002711.e193">Eq. 18</xref>:<disp-formula id="pcbi.1002711.e198"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e198" xlink:type="simple"/><label>(20)</label></disp-formula>The first term contains the probability that no spike was ever fired by the neuron until time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e199" xlink:type="simple"/></inline-formula>. We can safely assume this term to be zero. The factors in square brackets depend on all previous spike times. However if we assume that the adaptation effects only depend on the most recent spike time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e200" xlink:type="simple"/></inline-formula> and on the typical spiking history before, but not on the specific spike times of earlier spikes, then the formula in square brackets can be moved in front of the integrals over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e201" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e202" xlink:type="simple"/></inline-formula>, … We therefore set:<disp-formula id="pcbi.1002711.e203"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e203" xlink:type="simple"/><label>(21)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e204" xlink:type="simple"/></inline-formula> is the spike train containing all the spikes before <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e205" xlink:type="simple"/></inline-formula>. Thus, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e206" xlink:type="simple"/></inline-formula> is now only a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e207" xlink:type="simple"/></inline-formula> but not of the exact configuration of earlier spikes. We use the approximation of <xref ref-type="disp-formula" rid="pcbi.1002711.e203">Eq. 21</xref> only for the factors surrounded by square brackets in <xref ref-type="disp-formula" rid="pcbi.1002711.e198">Eq. 20</xref>. The path integral <xref ref-type="disp-formula" rid="pcbi.1002711.e198">Eq. 20</xref> becomes:<disp-formula id="pcbi.1002711.e208"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e208" xlink:type="simple"/><label>(22)</label></disp-formula>where we have used <xref ref-type="disp-formula" rid="pcbi.1002711.e181">Eq. 17</xref> to recover <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e209" xlink:type="simple"/></inline-formula>.</p>
        </sec>
        <sec id="s4a3">
          <title>Derivation of <xref ref-type="disp-formula" rid="pcbi.1002711.e091">Eq. 7</xref></title>
          <p>We can recognize in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e210" xlink:type="simple"/></inline-formula> the moment generating functional for the random function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e211" xlink:type="simple"/></inline-formula>. This functional can be written in terms of the correlation functions such as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e212" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002711-vanKampen1">[57]</xref>. The correlation functions are labeled <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e213" xlink:type="simple"/></inline-formula> as in van Kampen <xref ref-type="bibr" rid="pcbi.1002711-vanKampen1">[57]</xref> such that the first correlation function is the population activity: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e214" xlink:type="simple"/></inline-formula>, the second correlation function is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e215" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e216" xlink:type="simple"/></inline-formula>, and so on. Then, the generating functional can be written <xref ref-type="bibr" rid="pcbi.1002711-vanKampen1">[57]</xref>:<disp-formula id="pcbi.1002711.e217"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e217" xlink:type="simple"/><label>(23)</label></disp-formula><xref ref-type="disp-formula" rid="pcbi.1002711.e217">Eq. 23</xref> is called a generating functional because the functional derivatives with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e218" xlink:type="simple"/></inline-formula> and evaluated at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e219" xlink:type="simple"/></inline-formula> yields the correlation functions.</p>
        </sec>
        <sec id="s4a4">
          <title>Derivation of the renewal equation</title>
          <p>A derivation of the renewal equation <xref ref-type="bibr" rid="pcbi.1002711-Gerstner2">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Wilson1">[41]</xref>, <xref ref-type="bibr" rid="pcbi.1002711-Gerstner5">[42]</xref> can be obtained by replacing the QR approximation (<xref ref-type="disp-formula" rid="pcbi.1002711.e203">Eq. 21</xref>) by the renewal approximation:<disp-formula id="pcbi.1002711.e220"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e220" xlink:type="simple"/><label>(24)</label></disp-formula>Applying this approximation on the factors in the square bracket of <xref ref-type="disp-formula" rid="pcbi.1002711.e198">Eq. 20</xref> gives:<disp-formula id="pcbi.1002711.e221"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e221" xlink:type="simple"/><label>(25)</label></disp-formula>Therefore <xref ref-type="disp-formula" rid="pcbi.1002711.e198">Eqs. 20</xref> and <xref ref-type="disp-formula" rid="pcbi.1002711.e220">24</xref> yield a novel path integral proof of the renewal equation (<xref ref-type="disp-formula" rid="pcbi.1002711.e221">Eq. 25</xref>).</p>
        </sec>
        <sec id="s4a5">
          <title>The survival function and interval distribution</title>
          <p>First consider the expected value in <xref ref-type="disp-formula" rid="pcbi.1002711.e030">Eq. 2</xref> partitioned so as to first average over the previous spike <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e222" xlink:type="simple"/></inline-formula> and then over the rest of the spiking history <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e223" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002711.e224"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e224" xlink:type="simple"/><label>(26)</label></disp-formula>where the last equality results from a marginalization of the last spike time. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e225" xlink:type="simple"/></inline-formula> is the probability to spike at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e226" xlink:type="simple"/></inline-formula> <italic>and</italic> to survive from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e227" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e228" xlink:type="simple"/></inline-formula> without spiking. Thus we can write <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e229" xlink:type="simple"/></inline-formula> as the product of the population activity at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e230" xlink:type="simple"/></inline-formula> and the probability of not spiking between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e231" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e232" xlink:type="simple"/></inline-formula> that we will label <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e233" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002711.e234"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e234" xlink:type="simple"/><label>(27)</label></disp-formula>The function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e235" xlink:type="simple"/></inline-formula> is the survival function in renewal theory. It depends implicitly on the spiking history. The rate of decay of the survival function depends in general on the precise timing of <italic>all</italic> previous spikes. The QR approximation means that we approximate this decay by averaging over all possible spike trains before <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e236" xlink:type="simple"/></inline-formula>, so that:<disp-formula id="pcbi.1002711.e237"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e237" xlink:type="simple"/><label>(28)</label></disp-formula>which can be integrated to yield:<disp-formula id="pcbi.1002711.e238"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e238" xlink:type="simple"/><label>(29)</label></disp-formula>The survival function in <xref ref-type="disp-formula" rid="pcbi.1002711.e234">Eq. 27</xref> and <xref ref-type="disp-formula" rid="pcbi.1002711.e224">Eq. 26</xref> leads to the QR equation (<xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eq. 5</xref>). Following renewal theory <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>, the interspike interval distribution:<disp-formula id="pcbi.1002711.e239"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e239" xlink:type="simple"/><label>(30)</label></disp-formula>The factor in <xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eq. 5</xref> can therefore be interpreted as an approximate expression of the interspike interval distribution of adaptive neurons.</p>
        </sec>
        <sec id="s4a6">
          <title>Auto-correlation functions and interspike interval distributions at the steady state</title>
          <p>At the steady state with a constant input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e240" xlink:type="simple"/></inline-formula>, the interspike interval distribution predicted by QR theory is:<disp-formula id="pcbi.1002711.e241"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e241" xlink:type="simple"/><label>(31)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e242" xlink:type="simple"/></inline-formula> is the interspike interval, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e243" xlink:type="simple"/></inline-formula> is the steady-state activity, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e244" xlink:type="simple"/></inline-formula> is the averaged conditional firing intensity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e245" xlink:type="simple"/></inline-formula>. The latter can be written as:<disp-formula id="pcbi.1002711.e246"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e246" xlink:type="simple"/><label>(32)</label></disp-formula>From which we recover the auto-correlation function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e247" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>:<disp-formula id="pcbi.1002711.e248"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e248" xlink:type="simple"/><label>(33)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e249" xlink:type="simple"/></inline-formula> is the Fourier transform of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e250" xlink:type="simple"/></inline-formula>. To solve for the steady-state population activity, we note that the inverse of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e251" xlink:type="simple"/></inline-formula> is also the mean interspike interval at the steady state:<disp-formula id="pcbi.1002711.e252"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e252" xlink:type="simple"/><label>(34)</label></disp-formula></p>
        </sec>
      </sec>
      <sec id="s4b">
        <title>B Numerical Methods</title>
        <p>All simulations were performed on a desktop computer with 4 cores (Intel Core i7, 2.6 GHz, 24 GB RAM) using Matlab (The Mathworks, Natwick, MA). The Matlab codes to numerically solve the self-consistent equations are made available on the author's websites. The algorithmic aspects of the numerical methods are discussed now.</p>
        <sec id="s4b1">
          <title>Direct simulation</title>
          <p>All temporal units in this code are given in milliseconds. Direct simulation of <xref ref-type="disp-formula" rid="pcbi.1002711.e038">Eq. 3</xref> was done by first discretizing time (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e253" xlink:type="simple"/></inline-formula> was varied between 0.5 and 0.005 ms) and then deciding at each time step whether a spike is emitted by comparing the probability to spike in a time-bin:<disp-formula id="pcbi.1002711.e254"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e254" xlink:type="simple"/><label>(35)</label></disp-formula>to a random number of uniform distribution. Each time a spike is emitted, the firing probability is reduced according to the SRM equation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e255" xlink:type="simple"/></inline-formula> because another term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e256" xlink:type="simple"/></inline-formula> is added (<xref ref-type="disp-formula" rid="pcbi.1002711.e038">Eq. 3</xref>). Typically 25,000 repeated simulations were required to compute PSTHs on such a fine temporal resolution. The PSTHs were built by averaging the 25,000 discretized spike trains and performing a 2-ms running average unless otherwise mentioned. The dynamics of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e257" xlink:type="simple"/></inline-formula> were calculated from the numerical solution of the differential equation corresponding to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e258" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e259" xlink:type="simple"/></inline-formula> and similarly for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e260" xlink:type="simple"/></inline-formula>.</p>
          <p>For all simulations, the baseline current was 10 pA (except for time-dependent current where the mean was specified), the baseline excitability was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e261" xlink:type="simple"/></inline-formula> kHz, the membrane filter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e262" xlink:type="simple"/></inline-formula> was a single exponential with an amplitude <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e263" xlink:type="simple"/></inline-formula> in units of inverse electric charge and a time constant of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e264" xlink:type="simple"/></inline-formula>10 ms.</p>
          <p>Time-dependent input consisted of an Ornstein-Uhlenbeck process which is computed at every time step as:<disp-formula id="pcbi.1002711.e265"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e265" xlink:type="simple"/><label>(36)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e266" xlink:type="simple"/></inline-formula> is the mean, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e267" xlink:type="simple"/></inline-formula> the standard deviation and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e268" xlink:type="simple"/></inline-formula> = 300 ms the correlation time constant. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e269" xlink:type="simple"/></inline-formula> is a zero mean, unit variance Gaussian variable updated at every time step.</p>
        </sec>
        <sec id="s4b2">
          <title>Numerical solution of renewal and quasi-renewal equations</title>
          <p>We consider the QR equation, <xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eq. 5</xref>, with the averaged conditional intensity of <xref ref-type="disp-formula" rid="pcbi.1002711.e096">Eq. 8</xref>. We choose a tolerance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e270" xlink:type="simple"/></inline-formula> for truncating the function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e271" xlink:type="simple"/></inline-formula> and find the cutoff <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e272" xlink:type="simple"/></inline-formula> such that: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e273" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e274" xlink:type="simple"/></inline-formula>. A typical value for the tolerance, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e275" xlink:type="simple"/></inline-formula>, is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e276" xlink:type="simple"/></inline-formula>. We split the main integral in <xref ref-type="disp-formula" rid="pcbi.1002711.e087">Eq. 5</xref> in two integrals, one from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e277" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e278" xlink:type="simple"/></inline-formula>, the other from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e279" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e280" xlink:type="simple"/></inline-formula> to get:<disp-formula id="pcbi.1002711.e281"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e281" xlink:type="simple"/><label>(37)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e282" xlink:type="simple"/></inline-formula> is called the survival function (see <xref ref-type="sec" rid="s4">Methods</xref> A) and corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e283" xlink:type="simple"/></inline-formula>. With the same reasoning the lower bound of the innermost integral can be changed from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e284" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e285" xlink:type="simple"/></inline-formula> because <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e286" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e287" xlink:type="simple"/></inline-formula>. The first term in the square brackets of <xref ref-type="disp-formula" rid="pcbi.1002711.e281">Eq. 37</xref> are the neurons that have had their last spike a long time back in the past. For this term, we use the conservation equation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e288" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1002711-Gerstner1">[3]</xref>. This enables us to write the first-order QR equation in terms of an integral from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e289" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e290" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e291" xlink:type="simple"/></inline-formula> only:<disp-formula id="pcbi.1002711.e292"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e292" xlink:type="simple"/><label>(38)</label></disp-formula>We define two vectors. First <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e293" xlink:type="simple"/></inline-formula> is made of the exponential in <xref ref-type="disp-formula" rid="pcbi.1002711.e292">Eq. 38</xref> on the linear grid for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e294" xlink:type="simple"/></inline-formula>, such that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e295" xlink:type="simple"/></inline-formula>'th element can be written:<disp-formula id="pcbi.1002711.e296"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e296" xlink:type="simple"/><label>(39)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e297" xlink:type="simple"/></inline-formula> is the discretized function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e298" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e299" xlink:type="simple"/></inline-formula> is the number of time steps <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e300" xlink:type="simple"/></inline-formula> needed to cover the time span <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e301" xlink:type="simple"/></inline-formula> defined above. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e302" xlink:type="simple"/></inline-formula> does not depend on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e303" xlink:type="simple"/></inline-formula> since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e304" xlink:type="simple"/></inline-formula> (because of an absolute refractoriness during the spike). The update of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e305" xlink:type="simple"/></inline-formula> is the computationally expensive step of our implementation. Adaptive time-step procedures could be applied to improve the efficiency of the algorithm, but we did not do so. The special case where a rapid solution is possible is discussed further below.</p>
          <p>The second vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e306" xlink:type="simple"/></inline-formula> corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e307" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e308" xlink:type="simple"/></inline-formula> evaluated on the same linear grid as the one used for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e309" xlink:type="simple"/></inline-formula>. This vector traces the probability of having the last spike at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e310" xlink:type="simple"/></inline-formula>. Assuming that there was no stimulation before time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e311" xlink:type="simple"/></inline-formula> we can initialize this vector to zero. To update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e312" xlink:type="simple"/></inline-formula> we note that the firing condition <xref ref-type="disp-formula" rid="pcbi.1002711.e254">Eq. 35</xref> gives:<disp-formula id="pcbi.1002711.e313"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e313" xlink:type="simple"/><label>(40)</label></disp-formula>To do so, we see from <xref ref-type="disp-formula" rid="pcbi.1002711.e313">Eq. 40</xref> that we can evaluate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e314" xlink:type="simple"/></inline-formula> from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e315" xlink:type="simple"/></inline-formula> calculated at the previous time step. The first bin is updated to the previous population activity:<disp-formula id="pcbi.1002711.e316"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e316" xlink:type="simple"/><label>(41)</label></disp-formula>and all the other bins are updated according to<disp-formula id="pcbi.1002711.e317"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e317" xlink:type="simple"/><label>(42)</label></disp-formula></p>
          <p>We can therefore calculate the population activity iteratively at each time bin using <xref ref-type="disp-formula" rid="pcbi.1002711.e292">Eq. 38</xref>:<disp-formula id="pcbi.1002711.e318"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e318" xlink:type="simple"/><label>(43)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e319" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e320" xlink:type="simple"/></inline-formula> depend on the activity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e321" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e322" xlink:type="simple"/></inline-formula>. This algorithm implements a numerical approximation of the QR equation. On our desktop computer and with our particular implementation, solving 1 second of biological time took 36 seconds with a discretization of 0.1 ms for QR and 84–200 seconds for direct simulation of 25,000 neurons, depending on the firing rate. Using the same number of neurons but with a discretization of 0.5 ms it took 1.8 seconds to solve QR and 16–20 seconds to perform the direct simulation. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e323" xlink:type="simple"/></inline-formula> is the total number of time step, the present numerical methods are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e324" xlink:type="simple"/></inline-formula>. Evaluating the convolution in <xref ref-type="disp-formula" rid="pcbi.1002711.e296">Eq. 39</xref> with fast Fourier transform gives <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e325" xlink:type="simple"/></inline-formula>. This same convolution can be evaluated with a differential equation with the choice of basis: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e326" xlink:type="simple"/></inline-formula>, with parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e327" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e328" xlink:type="simple"/></inline-formula> having the constraint of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e329" xlink:type="simple"/></inline-formula>. This fast parametrization solves in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e330" xlink:type="simple"/></inline-formula>.</p>
        </sec>
        <sec id="s4b3">
          <title>Decoding QR</title>
          <p>Isolating the input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e331" xlink:type="simple"/></inline-formula> from <xref ref-type="disp-formula" rid="pcbi.1002711.e318">Eq. 43</xref> gives the decoding algorithm:<disp-formula id="pcbi.1002711.e332"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e332" xlink:type="simple"/><label>(44)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e333" xlink:type="simple"/></inline-formula> is also a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e334" xlink:type="simple"/></inline-formula>. Decoding can be carried out by assuming <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e335" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1002711.e332">Eq. 44</xref>, but this can lead to numerical instabilities when the time step is not very small. Instead we write <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e336" xlink:type="simple"/></inline-formula> as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e337" xlink:type="simple"/></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1002711.e316">Eqs. 41</xref> and <xref ref-type="disp-formula" rid="pcbi.1002711.e317">42</xref>), expand <xref ref-type="disp-formula" rid="pcbi.1002711.e317">Eq. 42</xref> to first order in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e338" xlink:type="simple"/></inline-formula> and solve the resulting quadratic equation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e339" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002711.e340"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e340" xlink:type="simple"/><label>(45)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e341" xlink:type="simple"/></inline-formula> denotes the element by element (array) multiplication.</p>
        </sec>
        <sec id="s4b4">
          <title>Numerical solution of EME1 and EME2</title>
          <p>The structure of EME1 and EME2 allows us to use a nonlinear grid spacing in order to save memory resources. The bins should be small where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e342" xlink:type="simple"/></inline-formula> varies fast, and larger where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e343" xlink:type="simple"/></inline-formula> varies slowly. Since the SAP is approximatively exponential, we choose the size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e344" xlink:type="simple"/></inline-formula> of bin <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e345" xlink:type="simple"/></inline-formula> to be given by: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e346" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e347" xlink:type="simple"/></inline-formula> takes the nearest greater integer and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e348" xlink:type="simple"/></inline-formula> is the smallest time bin allowed and will be the discretization of the final solution for the population activity. The degree of nonlinearity, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e349" xlink:type="simple"/></inline-formula>, is chosen such that there are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e350" xlink:type="simple"/></inline-formula> bins between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e351" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e352" xlink:type="simple"/></inline-formula>. To a good approximation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e353" xlink:type="simple"/></inline-formula> can be obtained by solving the equation: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e354" xlink:type="simple"/></inline-formula>.</p>
          <p>To perform the numerical integration, we define the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e355" xlink:type="simple"/></inline-formula> made of the function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e356" xlink:type="simple"/></inline-formula> evaluated at the end of each bin <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e357" xlink:type="simple"/></inline-formula> with bin size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e358" xlink:type="simple"/></inline-formula>, the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e359" xlink:type="simple"/></inline-formula> with elements <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e360" xlink:type="simple"/></inline-formula> made of the convolution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e361" xlink:type="simple"/></inline-formula> discretized on the uniform grid of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e362" xlink:type="simple"/></inline-formula> with bin size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e363" xlink:type="simple"/></inline-formula>, and on the same grid the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e364" xlink:type="simple"/></inline-formula> made of the discretized population activity. Finally, we define the vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e365" xlink:type="simple"/></inline-formula> made of the population activity in the last <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e366" xlink:type="simple"/></inline-formula> seconds since time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e367" xlink:type="simple"/></inline-formula> on the non-linear grid defined by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e368" xlink:type="simple"/></inline-formula>. Using the rectangle method to evaluate the integral of the first-order self-consistent equation for population activity, we can write:<disp-formula id="pcbi.1002711.e369"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e369" xlink:type="simple"/><label>(46)</label></disp-formula>Such that the population activity is obtained by solving iteratively through time <xref ref-type="disp-formula" rid="pcbi.1002711.e369">Eq. 46</xref>, an operation requiring <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e370" xlink:type="simple"/></inline-formula>.</p>
          <p>To compute the second order equation, we first build the correlation vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e371" xlink:type="simple"/></inline-formula> on the linear grid of the smallest bin size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e372" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002711.e373"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e373" xlink:type="simple"/><label>(47)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e374" xlink:type="simple"/></inline-formula> denotes the inverse Fourier transform and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e375" xlink:type="simple"/></inline-formula> is the Fourier transform of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e376" xlink:type="simple"/></inline-formula>, the steady-state interspike interval distribution for a renewal process. The steady-state inter-spike interval distribution vector is calculated from:<disp-formula id="pcbi.1002711.e377"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e377" xlink:type="simple"/><label>(48)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e378" xlink:type="simple"/></inline-formula> is a constant input and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e379" xlink:type="simple"/></inline-formula> is an interspike interval. We assume that at each time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e380" xlink:type="simple"/></inline-formula> the correlation function is the steady-state correlation function associated with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e381" xlink:type="simple"/></inline-formula>. Then we construct the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e382" xlink:type="simple"/></inline-formula> such that its element <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e383" xlink:type="simple"/></inline-formula> can be written:<disp-formula id="pcbi.1002711.e384"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e384" xlink:type="simple"/><label>(49)</label></disp-formula>Since the logarithmically spaced <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e385" xlink:type="simple"/></inline-formula> were multiples of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e386" xlink:type="simple"/></inline-formula> this matrix can be computed from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e387" xlink:type="simple"/></inline-formula>. We first construct a look-up table for the correlation function for a range of the filtered input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e388" xlink:type="simple"/></inline-formula>. This way the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e389" xlink:type="simple"/></inline-formula> can be easily computed at each time step by updating with the new values of the population activity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e390" xlink:type="simple"/></inline-formula>. Finally, we evaluate the self-consistent equation of the population activity with the second order correction:<disp-formula id="pcbi.1002711.e391"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e391" xlink:type="simple"/><label>(50)</label></disp-formula></p>
        </sec>
        <sec id="s4b5">
          <title>EME1 gain function</title>
          <p>The first-order expansion (<xref ref-type="disp-formula" rid="pcbi.1002711.e133">Eq. 10</xref>) can be used to write an analytical expression for the steady-state population activity. A constant input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e392" xlink:type="simple"/></inline-formula> will bring the neuron population to a constant population activity that is obtained by solving for the constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e393" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1002711.e133">Eq. 10</xref>.<disp-formula id="pcbi.1002711.e394"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e394" xlink:type="simple"/><label>(51)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e395" xlink:type="simple"/></inline-formula> is the Lambert W-function and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e396" xlink:type="simple"/></inline-formula>. This gain function is valid on a restricted range of input (<xref ref-type="fig" rid="pcbi-1002711-g005">Fig. 5D</xref>).</p>
        </sec>
      </sec>
      <sec id="s4c">
        <title>C Analysis Methods</title>
        <p>When assessing the accuracy of the encoding or the decoding, we used the correlation coefficient. The correlation coefficient is the variance-normalized covariance between two random variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e397" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e398" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002711.e399"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002711.e399" xlink:type="simple"/><label>(52)</label></disp-formula>where the expectation is taken over the discretized time.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002711.s001" mimetype="image/tiff" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.s001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>Statistics of decoding performance.</bold> (<bold>A</bold>–<bold>B</bold>) Correlation coefficient between original filtered input recovered from the activity of a population of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e400" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e401" xlink:type="simple"/></inline-formula> neurons shown as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e402" xlink:type="simple"/></inline-formula>. The activity was filtered with a given single exponential filter with a time constant of (<bold>A</bold>) 20 ms and (<bold>B</bold>) 2 ms. (<bold>C</bold>) Mean squared error associated with an instantaneous firing rate (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e403" xlink:type="simple"/></inline-formula>, error bars correspond to one standard deviation). (<bold>D</bold>–<bold>E</bold>) Fraction of input times at which decoding could be performed corresponding to <bold>A</bold> and <bold>B</bold>, respectively. Decoding could not be carried out when the stimulus was outside the dynamic range which corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e404" xlink:type="simple"/></inline-formula>. (<bold>F</bold>) Fraction of times where the activity was non-zero as a function of the population size. Colors show different standard deviation of the original input with values in pA, other parameters idem as <xref ref-type="fig" rid="pcbi-1002711-g004">Fig. 4</xref>.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002711.s002" mimetype="image/tiff" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.s002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>Role of SAP for Renewal theory, EME1 and EME2 for step input.</bold> Population activity responses (top panels; PSTH from 25,000 repeated simulations in blue, renewal theory in black, EME1 in red, EME2 in green) to the step current input (bottom panels; black). The neuron population follows spike-response model dynamics with effective SAP <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e405" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e406" xlink:type="simple"/></inline-formula> = 500 ms. (<bold>A–C</bold>) shows exemplar traces for different SAP amplitude and input steps: (<bold>A</bold>) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e407" xlink:type="simple"/></inline-formula> and current step <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e408" xlink:type="simple"/></inline-formula> pA, (<bold>B</bold>) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e409" xlink:type="simple"/></inline-formula> and current step <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e410" xlink:type="simple"/></inline-formula> pA, (<bold>C</bold>) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e411" xlink:type="simple"/></inline-formula> and current step <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e412" xlink:type="simple"/></inline-formula> pA. The mean square error of each analytical approximation (<bold>D</bold> Renewal, <bold>E</bold> EME1, <bold>F</bold>, EME2) for various values of the SAP amplitude <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e413" xlink:type="simple"/></inline-formula> and current step size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e414" xlink:type="simple"/></inline-formula>. The error rate is the standard deviation between the PSTH and the theory as calculated on the first 2 seconds after the step, divided by 2 seconds. For other model parameters see <xref ref-type="sec" rid="s4">Methods</xref>.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002711.s003" mimetype="image/tiff" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.s003" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Encoding time-dependent stimuli in the population activity with Event-Based Moment Expansion (EME).</bold> (<bold>A</bold>) Population activity responses (middle panel; PSTH from 25,000 repeated simulations in blue, EME1 in red to the time-dependent stimuli (bottom panel; black). The difference between direct simulation and theory is shown in the top panel.The stimulus is an Ornstein-Uhlenbeck process with correlation time constant of 300 ms with STD increasing every 2 seconds (20,40,60 pA) and a mean of 10 pA. (<bold>B</bold>) Correlation coefficients between direct simulation and EME1 for various STDs and mean (in pA) of the input current. Results of <xref ref-type="fig" rid="pcbi-1002711-g003">Fig. 3</xref> are copied (dashed lines).</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002711.s004" mimetype="image/tiff" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002711.s004" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p><bold>Decoding the stimulus from the population activity with EME1.</bold> (<bold>A</bold>–<bold>D</bold>) The original (bottom panels, black line) and decoded stimulus (bottom panels, red line; arbitrary units) recovered from the PSTH of 25,000 independent SRM neurons (top panels; blue line) using <xref ref-type="disp-formula" rid="pcbi.1002711.e137">Eq. 11</xref>. The decoded waveform of negative input is occasionally undefined because the logarithm of zero activity is not defined (<xref ref-type="disp-formula" rid="pcbi.1002711.e137">Eq. 11</xref>). (<bold>E</bold>) Correlation coefficient of original and decoded input as a function of input STD, shown for three distinct mean input (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e415" xlink:type="simple"/></inline-formula> pA, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e416" xlink:type="simple"/></inline-formula> pA, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002711.e417" xlink:type="simple"/></inline-formula> pA). Compare also with QR in <xref ref-type="fig" rid="pcbi-1002711-g004">Fig. 4</xref>.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We would like to thank C. Pozzorini, D. J. Rezende and G. Hennequin for helpful discussions.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002711-Rieke1">
        <label>1</label>
        <mixed-citation publication-type="other" xlink:type="simple">Rieke F, Warland D, de Ruyter van Steveninck R, Bialek W (1996) Spikes - Exploring the neural code. Cambridge: MIT Press.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Dayan1">
        <label>2</label>
        <mixed-citation publication-type="other" xlink:type="simple">Dayan P, Abbott LF (2001) Theoretical Neuroscience. Cambridge: MIT Press.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Gerstner1">
        <label>3</label>
        <mixed-citation publication-type="other" xlink:type="simple">Gerstner W, Kistler W (2002) Spiking neuron models. New York: Cambridge University Press.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Thorpe1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thorpe</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Fize</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Marlot</surname><given-names>C</given-names></name> (<year>1996</year>) <article-title>Speed of processing in the human visual system</article-title>. <source>Nature</source> <volume>381</volume>: <fpage>520</fpage>–<lpage>522</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Abeles1">
        <label>5</label>
        <mixed-citation publication-type="other" xlink:type="simple">Abeles M (1991) Corticonics. Cambridge: Cambridge University Press.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Gerstner2">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2000</year>) <article-title>Population dynamics of spiking neurons: Fast transients, asynchronous states, and locking</article-title>. <source>Neural Comput</source> <volume>12</volume>: <fpage>43</fpage>–<lpage>89</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Averbeck1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Averbeck</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Latham</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Pouget</surname><given-names>A</given-names></name> (<year>2006</year>) <article-title>Neural correlations, population coding and computation</article-title>. <source>Nat Rev Neurosci</source> <volume>7</volume>: <fpage>358</fpage>–<lpage>366</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Smith1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>RL</given-names></name> (<year>1979</year>) <article-title>Adaptation, saturation, and physiological masking in single auditory-nerve fibers</article-title>. <source>J Acoust Soc Am</source> <volume>65</volume>: <fpage>166</fpage>–<lpage>78</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Baccus1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baccus</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Meister</surname><given-names>M</given-names></name> (<year>2002</year>) <article-title>Fast and slow contrast adaptation in retinal circuitry</article-title>. <source>Neuron</source> <volume>36</volume>: <fpage>909</fpage>–<lpage>919</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Sclar1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sclar</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Lennie</surname><given-names>P</given-names></name>, <name name-style="western"><surname>DePriest</surname><given-names>DD</given-names></name> (<year>1989</year>) <article-title>Contrast adaptation in striate cortex of macaque</article-title>. <source>Vision Res</source> <volume>29</volume>: <fpage>747</fpage>–<lpage>55</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Ringo1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ringo</surname><given-names>JL</given-names></name> (<year>1996</year>) <article-title>Stimulus specific adaptation in inferior temporal and medial temporal cortex of the monkey</article-title>. <source>Behav Brain Res</source> <volume>76</volume>: <fpage>191</fpage>–<lpage>7</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Laughlin1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Laughlin</surname><given-names>SB</given-names></name>, <name name-style="western"><surname>Sejnowski</surname><given-names>TJ</given-names></name> (<year>2003</year>) <article-title>Communication in neuronal networks</article-title>. <source>Science</source> <volume>301</volume>: <fpage>1870</fpage>–<lpage>4</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Fairhall1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fairhall</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Lewen</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name>, <name name-style="western"><surname>van Steveninck</surname><given-names>R</given-names></name> (<year>2001</year>) <article-title>Efficiency and ambiguity in an adaptive neural code</article-title>. <source>Nature</source> <volume>412</volume>: <fpage>787</fpage>–<lpage>792</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Seris1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Seriès</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Stocker</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Simoncelli</surname><given-names>EP</given-names></name> (<year>2009</year>) <article-title>Is the homunculus “aware” of sensory adaptation?</article-title> <source>Neural Comput</source> <volume>21</volume>: <fpage>3271</fpage>–<lpage>304</lpage> doi:<ext-link ext-link-type="uri" xlink:href="http://10.1162/neco.2009.09-08-869" xlink:type="simple">10.1162/neco.2009.09-08-869</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Benda1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benda</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Herz</surname><given-names>A</given-names></name> (<year>2003</year>) <article-title>A universal model for spike-frequency adaptation</article-title>. <source>Neural Comput</source> <volume>15</volume>: <fpage>2523</fpage>–<lpage>2564</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Storm1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Storm</surname><given-names>JF</given-names></name> (<year>1987</year>) <article-title>Action potential repolarization and a fast after-hyperpolarization in rat hippocampal pyramidal cells</article-title>. <source>J Physiol</source> <volume>385</volume>: <fpage>733</fpage>–<lpage>759</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Schwindt1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwindt</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Spain</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Foehring</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Stafstrom</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Chubb</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>1988</year>) <article-title>Multiple potassium conductances and their functions in neurons from cat sensorimotor cortex in vitro</article-title>. <source>J Neurophysiol</source> <volume>59</volume>: <fpage>424</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Schwindt2">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwindt</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Spain</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Foehring</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Chubb</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Crill</surname><given-names>W</given-names></name> (<year>1988</year>) <article-title>Slow conductances in neurons from cat sensorimotor cortex in vitro and their role in slow excitability changes</article-title>. <source>J Neurophysiol</source> <volume>59</volume>: <fpage>450</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Hill1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hill</surname><given-names>A</given-names></name> (<year>1936</year>) <article-title>Excitation and accomodation in nerve</article-title>. <source>Proc Biol Sci</source> <volume>119</volume>: <fpage>305</fpage>–<lpage>355</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Fuortes1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuortes</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Mantegazzini</surname><given-names>F</given-names></name> (<year>1962</year>) <article-title>Interpretation of the repetitive firing of nerve cells</article-title>. <source>J Gen Physiol</source> <volume>45</volume>: <fpage>1163</fpage>–<lpage>1179</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Azouz1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Azouz</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gray</surname><given-names>CM</given-names></name> (<year>2000</year>) <article-title>Dynamic spike threshold reveals a mechanism for synaptic coincidence detection in cortical neurons in vivo</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>97</volume>: <fpage>8110</fpage>–<lpage>5</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Mensi1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mensi</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Naud</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Avermann</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Petersen</surname><given-names>CCH</given-names></name>, <name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2012</year>) <article-title>Parameter extraction and classification of three neuron types reveals two different adaptation mechanisms</article-title>. <source>J Neurophysiol</source> <volume>107</volume>: <fpage>1756</fpage>–<lpage>1775</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-LaCamera1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>La Camera</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Rauch</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Thurbon</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lüscher</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Senn</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Multiple time scales of temporal response in pyramidal and fast spiking cortical neurons</article-title>. <source>J Neurophysiol</source> <volume>96</volume>: <fpage>3448</fpage>–<lpage>3464</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Amit1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Amit</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Tsodyks</surname><given-names>MV</given-names></name> (<year>1991</year>) <article-title>Quantitative study of attractor neural networks retrieving at low spike rates. i: Substrate — spikes, rates, and neuronal gain</article-title>. <source>Network</source> <volume>2</volume>: <fpage>259</fpage>–<lpage>273</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Gerstner3">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name>, <name name-style="western"><surname>van Hemmen</surname><given-names>J</given-names></name> (<year>1992</year>) <article-title>Universality in neural networks: the importance of the ‘mean firing rate’</article-title>. <source>Biol Cybern</source> <volume>67</volume>: <fpage>195</fpage>–<lpage>205</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Amit2">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Amit</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name> (<year>1997</year>) <article-title>A model of spontaneous activity and local delay activity during delay periods in the cerebral cortex</article-title>. <source>Cereb Cortex</source> <volume>7</volume>: <fpage>237</fpage>–<lpage>252</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Brunel1">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name> (<year>2000</year>) <article-title>Dynamics of sparsely connected networks of excitatory and inhibitory spiking neuron</article-title>. <source>J Comput Neurosci</source> <volume>8</volume>: <fpage>183</fpage>–<lpage>208</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Renart1">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Renart</surname><given-names>A</given-names></name>, <name name-style="western"><surname>de la Rocha</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bartho</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Hollender</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Parga</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The asynchronous state in cortical circuits</article-title>. <source>Science</source> <volume>327</volume>: <fpage>587</fpage>–<lpage>90</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-FourcaudTrocme1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fourcaud-Trocme</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Hansel</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Vreeswijk</surname><given-names>CV</given-names></name>, <name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name> (<year>2003</year>) <article-title>How spike generation mechanisms determine the neuronal response to uctuating inputs</article-title>. <source>J Neurosci</source> <volume>23</volume>: <fpage>11628</fpage>–<lpage>11640</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Diesmann1">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Diesmann</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gewaltig</surname><given-names>MO</given-names></name>, <name name-style="western"><surname>Aertsen</surname><given-names>A</given-names></name> (<year>1999</year>) <article-title>Stable propagation of synchronous spiking in cortical neural networks</article-title>. <source>Nature</source> <volume>402</volume>: <fpage>529</fpage>–<lpage>533</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Pillow1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pillow</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Uzzell</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Simoncelli</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname><given-names>E</given-names></name> (<year>2005</year>) <article-title>Prediction and decoding of retinal ganglion cell responses with a probabilistic spiking model</article-title>. <source>J Neurosci</source> <volume>25</volume>: <fpage>11003</fpage>–<lpage>11013</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Jolivet1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jolivet</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Rauch</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Luscher</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2006</year>) <article-title>Predicting spike timing of neocortical pyramidal neurons by simple threshold models</article-title>. <source>J Comput Neurosci</source> <volume>21</volume>: <fpage>35</fpage>–<lpage>49</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Jolivet2">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jolivet</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kobayashi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Rauch</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Naud</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Shinomoto</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>A benchmark test for a quantitative assessment of simple neuron models</article-title>. <source>J Neurosci Methods</source> <volume>169</volume>: <fpage>417</fpage>–<lpage>424</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Hubel1">
        <label>34</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hubel</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Wiesel</surname><given-names>T</given-names></name> (<year>1962</year>) <article-title>Receptive fields, binocular interaction and functional architecture in the cat's visual cortex</article-title>. <source>J Physiol</source> <volume>160</volume>: <fpage>106</fpage>–<lpage>154</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Marmarelis1">
        <label>35</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marmarelis</surname><given-names>PZ</given-names></name>, <name name-style="western"><surname>Naka</surname><given-names>K</given-names></name> (<year>1972</year>) <article-title>White-noise analysis of a neuron chain: an application of the wiener theory</article-title>. <source>Science</source> <volume>175</volume>: <fpage>1276</fpage>–<lpage>8</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-EnrothCugell1">
        <label>36</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Enroth-Cugell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Robson</surname><given-names>JG</given-names></name> (<year>1966</year>) <article-title>The contrast sensitivity of retinal ganglion cells of the cat</article-title>. <source>J Physiol</source> <volume>187</volume>: <fpage>517</fpage>–<lpage>52</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Gerstner4">
        <label>37</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2001</year>) <article-title>Coding properties of spiking neurons: reverse- and cross-correlations</article-title>. <source>Neural Netw</source> <volume>14</volume>: <fpage>599</fpage>–<lpage>610</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Aviel1">
        <label>38</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aviel</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2006</year>) <article-title>From spiking neurons to rate models: a cascade model as an approximation to spiking neuron models with refractoriness</article-title>. <source>Phys Rev E</source> <volume>73</volume>: <fpage>51908</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Schwartz1">
        <label>39</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwartz</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Sejnowski</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name> (<year>2006</year>) <article-title>Soft mixer assignment in a hierarchical generative model of natural scene statistics</article-title>. <source>Neural Comput</source> <volume>18</volume>: <fpage>2680</fpage>–<lpage>2718</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Ostojic1">
        <label>40</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ostojic</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name> (<year>2011</year>) <article-title>From spiking neuron models to linear-nonlinear models</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1001056</fpage> doi:<ext-link ext-link-type="uri" xlink:href="http://10.1371/journal.pcbi.1001056" xlink:type="simple">10.1371/journal.pcbi.1001056</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Wilson1">
        <label>41</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname><given-names>HR</given-names></name>, <name name-style="western"><surname>Cowan</surname><given-names>JD</given-names></name> (<year>1972</year>) <article-title>Excitatory and inhibitory interactions in localized populations of model neurons</article-title>. <source>Biophys J</source> <volume>12</volume>: <fpage>1</fpage>–<lpage>24</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Gerstner5">
        <label>42</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>1995</year>) <article-title>Time structure of the activity in neural network models</article-title>. <source>Phys Rev E</source> <volume>51</volume>: <fpage>738</fpage>–<lpage>758</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Rauch1">
        <label>43</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rauch</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Camera</surname><given-names>GL</given-names></name>, <name name-style="western"><surname>Luscher</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Senn</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Fusi</surname><given-names>S</given-names></name> (<year>2003</year>) <article-title>Neocortical pyramidal cells respond as integrate-and-fire neurons to in vivo-like input currents</article-title>. <source>J Neurophysiol</source> <volume>90</volume>: <fpage>1598</fpage>–<lpage>1612</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-LaCamera2">
        <label>44</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>La Camera</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Rauch</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lüscher</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Senn</surname><given-names>W</given-names></name> (<year>2004</year>) <article-title>Minimal models of adapted neuronal response to in vivo-like input currents</article-title>. <source>Neural Comput</source> <volume>16</volume>: <fpage>2101</fpage>–<lpage>2124</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Treves1">
        <label>45</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Treves</surname><given-names>A</given-names></name> (<year>1993</year>) <article-title>Mean-field analysis of neuronal spike dynamics</article-title>. <source>Network</source> <volume>4</volume>: <fpage>259</fpage>–<lpage>284</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Muller1">
        <label>46</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muller</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Buesing</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Schemmel</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Meier</surname><given-names>K</given-names></name> (<year>2007</year>) <article-title>Spike-frequency adapting neural ensembles: beyond mean adaptation and renewal theories</article-title>. <source>Neural Comput</source> <volume>19</volume>: <fpage>2958</fpage>–<lpage>3010</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Richardson1">
        <label>47</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Richardson</surname><given-names>MJE</given-names></name> (<year>2009</year>) <article-title>Dynamics of populations and networks of neurons with voltage-activated and calcium-activated currents</article-title>. <source>Phys Rev E</source> <volume>80</volume>: <fpage>021928</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Toyoizumi1">
        <label>48</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toyoizumi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Rad</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name> (<year>2009</year>) <article-title>Mean-field approximations for coupled populations of generalized linear model spiking neurons with markov refractoriness</article-title>. <source>Neural Comput</source> <volume>21</volume>: <fpage>1203</fpage>–<lpage>1243</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Farkhooi1">
        <label>49</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Farkhooi</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Muller</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Nawrot</surname><given-names>MP</given-names></name> (<year>2011</year>) <article-title>Adaptation reduces variability of the neuronal population code</article-title>. <source>Phys Rev E</source> <volume>83</volume>: <fpage>050905</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Gerstner6">
        <label>50</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name>, <name name-style="western"><surname>van Hemmen</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Cowan</surname><given-names>J</given-names></name> (<year>1996</year>) <article-title>What matters in neuronal locking?</article-title> <source>Neural Comput</source> <volume>8</volume>: <fpage>1653</fpage>–<lpage>1676</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Plesser1">
        <label>51</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Plesser</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2000</year>) <article-title>Noise in integrate-and-fire neurons: From stochastic input to escape rates</article-title>. <source>Neural Comput</source> <volume>12</volume>: <fpage>367</fpage>–<lpage>384</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Gerstner7">
        <label>52</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2008</year>) <article-title>Spike-response model</article-title>. <source>Scholarpedia</source> <volume>3</volume>: <fpage>1343</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Paninski1">
        <label>53</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name> (<year>2004</year>) <article-title>Maximum likelihood estimation of cascade point-process neural encoding models</article-title>. <source>Network</source> <volume>15</volume>: <fpage>243</fpage>–<lpage>262</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Mensi2">
        <label>54</label>
        <mixed-citation publication-type="other" xlink:type="simple">Mensi S, Naud R, Gerstner W (2011) From stochastic nonlinear integrate-and-fire to generalized linear models. In: Shawe-Taylor J, Zemel RS, Bartlett P, Pereira F, Weinberger KQ, editors. Advances in Neural Information Processing Systems 24. Cambridge: MIT Press.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Pillow2">
        <label>55</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pillow</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source> <volume>454</volume>: <fpage>995</fpage>–<lpage>999</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Cox1">
        <label>56</label>
        <mixed-citation publication-type="other" xlink:type="simple">Cox DR (1962) Renewal theory. London: Methuen.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-vanKampen1">
        <label>57</label>
        <mixed-citation publication-type="other" xlink:type="simple">van Kampen NG (1992) Stochastic processes in physics and chemistry. 2nd edition. Amsterdam: North-Holland.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Hawkes1">
        <label>58</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hawkes</surname><given-names>AG</given-names></name> (<year>1971</year>) <article-title>Spectra of some self-exciting and mutually exciting processes</article-title>. <source>Biometrika</source> <volume>58</volume>: <fpage>83</fpage>–<lpage>90</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Pernice1">
        <label>59</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pernice</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Staude</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Cardanobile</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname><given-names>S</given-names></name> (<year>2011</year>) <article-title>How structure determines correlations in neuronal networks</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1002059</fpage> doi:<ext-link ext-link-type="uri" xlink:href="http://10.1371/journal.pcbi.1002059" xlink:type="simple">10.1371/journal.pcbi.1002059</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Schwartz2">
        <label>60</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwartz</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Pillow</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Rust</surname><given-names>NC</given-names></name>, <name name-style="western"><surname>Simoncelli</surname><given-names>EP</given-names></name> (<year>2006</year>) <article-title>Spike-triggered neural characterization</article-title>. <source>J Vis</source> <volume>6</volume>: <fpage>484</fpage>–<lpage>507</lpage> doi:<ext-link ext-link-type="uri" xlink:href="http://10.1167/6.4.13" xlink:type="simple">10.1167/6.4.13</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Knight1">
        <label>61</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Knight</surname><given-names>BW</given-names></name> (<year>2000</year>) <article-title>Dynamics of encoding in neuron populations: some general mathematical features</article-title>. <source>Neural Comput</source> <volume>12</volume>: <fpage>473</fpage>–<lpage>518</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Shriki1">
        <label>62</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shriki</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Hansel</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname><given-names>H</given-names></name> (<year>2003</year>) <article-title>Rate models for conductance-based cortical neuronal networks</article-title>. <source>Neural Comput</source> <volume>15</volume>: <fpage>1809</fpage>–<lpage>1841</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Richardson2">
        <label>63</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Richardson</surname><given-names>MJE</given-names></name>, <name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Hakim</surname><given-names>V</given-names></name> (<year>2003</year>) <article-title>From subthreshold to firing-rate resonance</article-title>. <source>J Neurophysiol</source> <volume>89</volume>: <fpage>2538</fpage>–<lpage>2554</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Richardson3">
        <label>64</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Richardson</surname><given-names>MJE</given-names></name> (<year>2007</year>) <article-title>Firing-rate response of linear and nonlinear integrate-and-fire neurons to modulated current-based and conductance-based synaptic drive</article-title>. <source>Phys Rev E</source> <volume>76</volume>: <fpage>021919</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Muller2">
        <label>65</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muller</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Buesing</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Schemmel</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Meier</surname><given-names>K</given-names></name> (<year>2007</year>) <article-title>Spike-frequency adapting neural ensembles: beyond mean adaptation and renewal theories</article-title>. <source>Neural Comput</source> <volume>19</volume>: <fpage>2958</fpage>–<lpage>3010</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-deKock1">
        <label>66</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Kock</surname><given-names>CPJ</given-names></name>, <name name-style="western"><surname>Sakmann</surname><given-names>B</given-names></name> (<year>2009</year>) <article-title>Spiking in primary somatosensory cortex during natural whisking in awake head-restrained rats is cell-type specific</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>106</volume>: <fpage>16446</fpage>–<lpage>16450</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Crochet1">
        <label>67</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crochet</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Poulet</surname><given-names>JFA</given-names></name>, <name name-style="western"><surname>Kremer</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Petersen</surname><given-names>CCH</given-names></name> (<year>2011</year>) <article-title>Synaptic mechanisms underlying sparse coding of active touch</article-title>. <source>Neuron</source> <volume>69</volume>: <fpage>1160</fpage>–<lpage>75</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Herrmann1">
        <label>68</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Herrmann</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2001</year>) <article-title>Noise and the psth response to current transients: I. General theory and application to the integrate-and-fire neuron</article-title>. <source>J Computat Neurosci</source> <volume>11</volume>: <fpage>135</fpage>–<lpage>151</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Paninski2">
        <label>69</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Pillow</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lewi</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Statistical models for neural encoding, decoding, and optimal stimulus design</article-title>. <source>Prog Brain Res</source> <volume>165</volume>: <fpage>493</fpage>–<lpage>507</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Koyama1">
        <label>70</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koyama</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Eden</surname><given-names>UT</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>, <name name-style="western"><surname>Kass</surname><given-names>RE</given-names></name> (<year>2010</year>) <article-title>Bayesian decoding of neural spike trains</article-title>. <source>Ann Inst Stat Math</source> <volume>62</volume>: <fpage>37</fpage>–<lpage>59</lpage> doi:<ext-link ext-link-type="uri" xlink:href="http://10.1007/s10463-009-0249-x" xlink:type="simple">10.1007/s10463-009-0249-x</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Sen1">
        <label>71</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sen</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Jorge-Rivera</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Marder</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Abbott</surname><given-names>LF</given-names></name> (<year>1996</year>) <article-title>Decoding synapses</article-title>. <source>J Neurosci</source> <volume>16</volume>: <fpage>6307</fpage>–<lpage>6318</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Pfister1">
        <label>72</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pfister</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lengyel</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Synapses with short-term plasticity are optimal estimators of presynaptic membrane potentials</article-title>. <source>Nat Neurosci</source> <volume>13</volume>: <fpage>1271</fpage>–<lpage>5</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Polsky1">
        <label>73</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Polsky</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Mel</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Schiller</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Encoding and decoding bursts by nmda spikes in basal dendrites of layer 5 pyramidal neurons</article-title>. <source>J Neurosci</source> <volume>29</volume>: <fpage>11891</fpage>–<lpage>903</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Carandini1">
        <label>74</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carandini</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Heeger</surname><given-names>D</given-names></name> (<year>1994</year>) <article-title>Summation and division by neurons in primate visual cortex</article-title>. <source>Science</source> <volume>264</volume>: <fpage>1333</fpage>–<lpage>1336</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Druckmann1">
        <label>75</label>
        <mixed-citation publication-type="other" xlink:type="simple">Druckmann S, Chklovskii D (2010) Over-complete representations on recurrent neural networks can support persistent percepts. In: Lafferty J, Williams CKY, Shawe-Taylor J, Zemel RS, Culotta A, editors. Advances in Neural Information Processing Systems 24. Cambridge: MIT Press.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Softky1">
        <label>76</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Softky</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Koch</surname><given-names>C</given-names></name> (<year>1993</year>) <article-title>The highly irregular firing pattern of cortical cells is inconsistent with temporal integration of random epsps</article-title>. <source>J Neurosci</source> <volume>13</volume>: <fpage>334</fpage>–<lpage>350</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Liu1">
        <label>77</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>YH</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>XJ</given-names></name> (<year>2001</year>) <article-title>Spike-frequency adaptation of a generalized leaky integrate-and-fire model neuron</article-title>. <source>J Comput Neurosci</source> <volume>10</volume>: <fpage>25</fpage>–<lpage>45</lpage> doi:<ext-link ext-link-type="uri" xlink:href="http://10.1023/A:1008916026143" xlink:type="simple">10.1023/A:1008916026143</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Wang1">
        <label>78</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>XJ</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Sanchez-Vives</surname><given-names>MV</given-names></name>, <name name-style="western"><surname>McCormick</surname><given-names>DA</given-names></name> (<year>2003</year>) <article-title>Adaptation and temporal decorrelation by single neurons in the primary visual cortex</article-title>. <source>J Neurophysiol</source> <volume>89</volume>: <fpage>3279</fpage>–<lpage>93</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Spiridon1">
        <label>79</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spiridon</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>1999</year>) <article-title>Noise spectrum and signal transmission trough a population of spiking neurons</article-title>. <source>Network</source> <volume>10</volume>: <fpage>257</fpage>–<lpage>272</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Lindner1">
        <label>80</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindner</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Chacron</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Longtin</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>Integrate-and-fire neurons with threshold noise: A tractable model of how interspike interval correlations affect neuronal signal transmission</article-title>. <source>Phys Rev E</source> <volume>72</volume>: <fpage>021911</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Buice1">
        <label>81</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buice</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Chow</surname><given-names>CC</given-names></name> (<year>2007</year>) <article-title>Correlations, uctuations, and stability of a finite-size network of coupled oscillators</article-title>. <source>Phys RevE</source> <volume>76</volume>: <fpage>031118</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Chapin1">
        <label>82</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chapin</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Moxon</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Markowitz</surname><given-names>RS</given-names></name>, <name name-style="western"><surname>Nicolelis</surname><given-names>N</given-names></name> (<year>1999</year>) <article-title>Real-time control of a robot arm using simultaneously recorded neurons in the motor cortex</article-title>. <source>Nat Neurosci</source> <volume>2</volume>: <fpage>664</fpage>–<lpage>670</lpage> doi:<ext-link ext-link-type="uri" xlink:href="http://10.1038/10223" xlink:type="simple">10.1038/10223</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Hatsopoulos1">
        <label>83</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hatsopoulos</surname><given-names>NG</given-names></name>, <name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name> (<year>2009</year>) <article-title>The science of neural interface systems</article-title>. <source>Annu Rev Neurosci</source> <volume>32</volume>: <fpage>249</fpage>–<lpage>66</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Koyama2">
        <label>84</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koyama</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Chase</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Whitford</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Velliste</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Schwartz</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Comparison of brain–computer interface decoding algorithms in open-loop and closed-loop control</article-title>. <source>J Comput Neurosci</source> <volume>29</volume>: <fpage>73</fpage>–<lpage>87</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002711-Pfister2">
        <label>85</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pfister</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Toyoizumi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Barber</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Gerstner</surname><given-names>W</given-names></name> (<year>2006</year>) <article-title>Optimal spike-timing-dependent plasticity for precise action potential firing in supervised learning</article-title>. <source>Neural Comput</source> <volume>18</volume>: <fpage>1318</fpage>–<lpage>1348</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>