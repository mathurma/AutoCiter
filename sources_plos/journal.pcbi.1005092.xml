<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00048</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005092</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Geography</subject><subj-group><subject>Human geography</subject><subj-group><subject>Human mobility</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Human geography</subject><subj-group><subject>Human mobility</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Maximum likelihood estimation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Maximum likelihood estimation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Factor analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Factor analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Acceleration</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Separating Timing, Movement Conditions and Individual Differences in the Analysis of Human Movement</article-title>
<alt-title alt-title-type="running-head">Timing and Movement Path Separation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7099-2314</contrib-id>
<name name-style="western">
<surname>Raket</surname> <given-names>Lars Lau</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Grimme</surname> <given-names>Britta</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Schöner</surname> <given-names>Gregor</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Igel</surname> <given-names>Christian</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7793-9620</contrib-id>
<name name-style="western">
<surname>Markussen</surname> <given-names>Bo</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Mathematical Sciences, University of Copenhagen, Copenhagen, Denmark</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Institut für Neuroinformatik, Ruhr-Universität Bochum, Bochum, Germany</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Computer Science, University of Copenhagen, Copenhagen, Denmark</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Diedrichsen</surname> <given-names>Jörn</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Western University, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item><p><bold>Conceived and designed the experiments:</bold> BG GS.</p></list-item> <list-item><p><bold>Performed the experiments:</bold> BG.</p></list-item> <list-item><p><bold>Analyzed the data:</bold> LLR BG CI BM.</p></list-item> <list-item><p><bold>Wrote the paper:</bold> LLR BG GS CI BM.</p></list-item></list></p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">larslau@math.ku.dk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>9</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>22</day>
<month>9</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>9</issue>
<elocation-id>e1005092</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>1</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>29</day>
<month>7</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Raket et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005092"/>
<abstract>
<p>A central task in the analysis of human movement behavior is to determine systematic patterns and differences across experimental conditions, participants and repetitions. This is possible because human movement is highly regular, being constrained by invariance principles. Movement timing and movement path, in particular, are linked through scaling laws. Separating variations of movement timing from the spatial variations of movements is a well-known challenge that is addressed in current approaches only through forms of preprocessing that bias analysis. Here we propose a novel nonlinear mixed-effects model for analyzing temporally continuous signals that contain systematic effects in both timing and path. Identifiability issues of path relative to timing are overcome by using maximum likelihood estimation in which the most likely separation of space and time is chosen given the variation found in data. The model is applied to analyze experimental data of human arm movements in which participants move a hand-held object to a target location while avoiding an obstacle. The model is used to classify movement data according to participant. Comparison to alternative approaches establishes nonlinear mixed-effects models as viable alternatives to conventional analysis frameworks. The model is then combined with a novel factor-analysis model that estimates the low-dimensional subspace within which movements vary when the task demands vary. Our framework enables us to visualize different dimensions of movement variation and to test hypotheses about the effect of obstacle placement and height on the movement path. We demonstrate that the approach can be used to uncover new properties of human movement.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>When you move a cup to a new location on a table, the movement of lifting, transporting, and setting down the cup appears to be completely automatic. Although the hand could take continuously many different paths and move on any temporal trajectory, real movements are highly regular and reproducible. From repetition to repetition movements vary, and the pattern of variance reflects movement conditions and movement timing. If another person performs the same task, the movement will be similar. When we look more closely, however, there are systematic individual differences. Some people will overcompensate when avoiding an obstacle and some people will systematically move slower than others. When we want to understand human movement, all these aspects are important. We want to know which parts of a movement are common across people and we want to quantify the different types of variability. Thus, the models we use to analyze movement data should contain all the mentioned effects. In this work, we developed a framework for statistical analysis of movement data that respects these structures of movements. We showed how this framework modeled the individual characteristics of participants better than other state-of-the-art modeling approaches. We combined the timing-and-path-separating model with a novel factor analysis model for analyzing the effect of obstacles on spatial movement paths. This combination allowed for an unprecedented ability to quantify and display different sources of variation in the data. We analyzed data from a designed experiment of arm movements under various obstacle avoidance conditions. Using the proposed statistical models, we documented three findings: a linearly amplified deviation in mean path related to increase in obstacle height; a consistent asymmetric pattern of variation along the movement path related to obstacle placement; and the existence of obstacle-distance invariant focal points where mean trajectories intersect in the frontal and vertical planes.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>FKZ 01GQ0951</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Schöner</surname> <given-names>Gregor</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>The authors acknowledge support from the German Federal Ministry of Education and Research within the National Network Computational Neuroscience - Bernstein Fokus: "Learning behavioral models: From human experiment to technical assistance", grant FKZ 01GQ0951. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="14"/>
<table-count count="2"/>
<page-count count="27"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data files are available from the following repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/larslau/Bochum_movement_data" xlink:type="simple">https://github.com/larslau/Bochum_movement_data</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>When humans move and manipulate objects, their hand paths are smooth, but also highly flexible. Humans do not move in a jerky, robot-like way that is sometimes humorously invoked to illustrated “unnatural” movement behavior. In fact, humans have a hard time making “arbitrary” movements. Even when they scribble freely in three dimensions, their hand moves in a regular way that is typically piecewise planar [<xref ref-type="bibr" rid="pcbi.1005092.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005092.ref002">2</xref>]. Movement generation by the nervous systems, the neuro-muscular systems, and the body is constrained by implied laws of motion signatures which are found empirically through invariances of movement trajectories and movement paths. Among these, laws decoupling space and time are of particular importance. For instance, the fact that the trajectories of the hand have approximately bell-shaped velocity profiles across varying movement amplitudes [<xref ref-type="bibr" rid="pcbi.1005092.ref003">3</xref>] implies a scaling of the time dependence of velocity. The 2/3 power law [<xref ref-type="bibr" rid="pcbi.1005092.ref004">4</xref>] establishes an analogous scaling of time with the spatial path of the hand’s movement. Similarly, the isochrony principle [<xref ref-type="bibr" rid="pcbi.1005092.ref005">5</xref>] captures that the same spatial segment of a movement takes up the same proportion of movement time as movement amplitude is rescaled. Several of these invariances can be linked to geometrical invariance principles [<xref ref-type="bibr" rid="pcbi.1005092.ref006">6</xref>].</p>
<p>These invariances imply that movements as a whole have a reproducible temporal form, which can be characterized by movement parameters. Their values are specified before a movement begins, so that one may predict the movement’s time course and path based on just an initial portion of the trajectory [<xref ref-type="bibr" rid="pcbi.1005092.ref007">7</xref>]. Movement parameters are assumed to reside at the level of end-effector trajectories in space and their neural encoding begins to be known [<xref ref-type="bibr" rid="pcbi.1005092.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1005092.ref010">10</xref>]. The set of possible movements can thus be spanned by a limited number of such parameters. Moreover, the choices of these movement parameters are constrained. For instance, in sequences of movements, earlier segments predict later segments [<xref ref-type="bibr" rid="pcbi.1005092.ref011">11</xref>].</p>
<p>A key source of variance of kinematic variables is, of course, the time course of the movement itself. The invariance principles suggest that this source of variance can be disentangled from the variation induced when the movement task varies. In this paper, we will first address time as a source of variance, focussing on a fixed movement task, and then use the methods developed to address how movements vary when the task is varied.</p>
<p>Given a fixed movement task, movement trajectories also vary across individuals. Individual differences in movement, a personal movement style, are reproducible and stable over time, as witnessed, for instance, by the possibility to identify individuals or individual characteristics such as gender by movement information alone [<xref ref-type="bibr" rid="pcbi.1005092.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1005092.ref014">14</xref>].</p>
<p>A third source of variation are fluctuations in how movements are performed from trial to trial or across movement cycles in rhythmic movements. Such fluctuations are of particular interest to movement scientists, because they reflect not only sources of random variability such as neural or muscular noise, but also the extent to which the mechanisms of movement generation stabilize movement against such noise. Instabilities in patterns of coordination have been detected by an increase of fluctuations [<xref ref-type="bibr" rid="pcbi.1005092.ref015">15</xref>] and differences in variance among different degrees of freedom have been used to establish priorities of neural control [<xref ref-type="bibr" rid="pcbi.1005092.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005092.ref017">17</xref>].</p>
<p>A systematic method to disentangle these three sources of movement variation, time, individual differences, and fluctuations, would be a very helpful research tool. Such a method would decompose sets of observed kinematic time series into a common trajectory (that may be specific to the task), participant-specific movement traits, and random effects. Given the observed decoupling of space and time, such a decomposition would also separate the rescaling of time across these three factors from the variation of the spatial characteristics of movement.</p>
<p>The statistical subfield that deals with analysis of temporal trajectories is the field of functional data analysis. In the literature on functional data, the typical approach for handling continuous signals with time-warping effects is to pre-align samples under an oversimplified noise model in the hope of eliminating the effects of movement timing [<xref ref-type="bibr" rid="pcbi.1005092.ref018">18</xref>]. In contrast, we propose an analytic framework in which the decomposition of the signal is done simultaneously with the estimation of movement timing effects, so that samples are continually aligned under an estimated noise model. Furthermore, we account for both the task-dependent variation of movement and for individual differences (a brief review of warping in the modeling of biological motion is provided in the Methods section).</p>
<p>Decomposition of time series into a common effect (the time course of the movement given a fixed task), an individual effect, and random variation naturally leads to a mixed-effects formulation [<xref ref-type="bibr" rid="pcbi.1005092.ref019">19</xref>]. The addition of nonlinear timing effects gives the model the structure of a hierarchical nonlinear mixed-effects model [<xref ref-type="bibr" rid="pcbi.1005092.ref020">20</xref>]. We present a framework for maximum-likelihood estimation in the model and demonstrate that the method leads to high-quality templates that foster subsequent analysis (e.g., classification). We then show that the results of this analysis can be combined with other models to test hypotheses about the invariance of movement patterns across participants and task conditions. We demonstrate this by using the individual warping functions in a novel factor analysis model that captures variation of movement trajectories with task conditions.</p>
<p>We use as of yet unpublished data from a study of naturalistic movement that extends published work [<xref ref-type="bibr" rid="pcbi.1005092.ref021">21</xref>]. In the study, human participants transport a wooden cylinder from a starting to a target location while avoiding obstacles at different spatial positions along the path. Earlier work has shown that movement paths and trajectories in this relatively unconstrained, naturalistic movement task clearly reflect typical invariances of movement generation, including the planar nature of movement paths, spatiotemporal invariance of velocity profiles, and a local isochrony principle that reflects the decoupling of space and time [<xref ref-type="bibr" rid="pcbi.1005092.ref021">21</xref>]. By varying the obstacle configuration, the data include significant and non-trivial task-level variation. We begin by modeling a one-dimensional projection of the time courses of acceleration of the hand in space, which we decompose into a common pattern and the deviations from it that characterize each participant. The timing of the acceleration profiles is determined by individual time warping functions which are of higher quality than conventional estimates, since timing and movement noise are modeled simultaneously. The high quality of the estimates is demonstrated by classifying movements according to participant. Finally, the results of the nonlinear mixed model are analyzed using a novel factor analysis model that estimates a low-dimensional subspace within which movement paths change when the task conditions are varied. This combination of statistical models makes it possible to separate and visualize the variation caused by experimental conditions, participants and repetition. Furthermore, we can formulate and test hypotheses about the effects of experimental conditions on movement paths. Using the proposed statistical models, we document three findings: a linearly amplified deviation in mean path related to increase in obstacle height; a consistent asymmetric pattern of variation along the movement path related to obstacle placement; and the existence of obstacle-distance invariant focal points where mean trajectories intersect in the frontal and vertical plane.</p>
<p>Software for performing the described types of simultaneous analyses of timing and movement effects are publicly available through the <monospace>pavpop</monospace> R package [<xref ref-type="bibr" rid="pcbi.1005092.ref022">22</xref>]. A short guide on model building and fitting in the proposed framework is available as Supporting Information, along with an application to handwritten signature data.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Experimental data set</title>
<p>Ten participants performed a series of simple, naturalistic motor acts in which they moved a wooden cylinder from a starting to a target position while avoiding a cylindric obstacle. The obstacle’s height and positition along the movement path were varied across experiments (<xref ref-type="fig" rid="pcbi.1005092.g001">Fig 1</xref>).</p>
<fig id="pcbi.1005092.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Obstacle avoidance paradigm.</title>
<p>Participants move the cylindrical object <italic>O</italic> from the starting platform (green) to the target platform by lifting it over an obstacle. Obstacles of three different heights, small (<italic>S</italic>), medium (<italic>M</italic>), and tall (<italic>T</italic>), were used in the experiment, and the distance from starting position to obstacle <italic>d</italic> was varied.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g001" xlink:type="simple"/>
</fig>
<p>The movements were recorded with the Visualeyez (Phoenix Technologies Inc.) motion capture system VZ 4000. Two trackers, each equipped with three cameras, were mounted on the wall 1.5 m above the working surface, so that both systems had an excellent view of the table. A wireless infrared light-emitting diode (IRED) was attached to the wooden cylinder. The trajectories of markers were recorded in three Cartesian dimensions at a sampling rate of 110 Hz based on a reference frame anchored on the table. The starting position projected to the table was taken as the origin of each trajectory in three-dimensional Cartesian space. Recorded movement paths for two experimental conditions are shown in <xref ref-type="fig" rid="pcbi.1005092.g002">Fig 2</xref>. The acceleration profiles considered in the following sections were obtained by using finite difference approximations of the raw velocity magnitude data, see <xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3</xref>.</p>
<fig id="pcbi.1005092.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Recorded paths of the hand-held object in space for two experimental conditions: (a) <italic>d</italic> = 15, <italic>S</italic>, (b) <italic>d</italic> = 30, <italic>T</italic>.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g002" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005092.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Surface plots of acceleration profiles ordered by repetition (<italic>y</italic>-axis) in the experiment with <italic>d</italic> = 30, <italic>T</italic>.</title>
<p>The figures display (a) raw acceleration in recorded time, (b) raw acceleration in percentual time, (c) smoothed acceleration in recorded time, and (d) smoothed acceleration in percentual time. The plots allow visualization of the variation across participants and repetitions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g003" xlink:type="simple"/>
</fig>
<p>Obstacle avoidance was performed in 15 different conditions that combined three obstacle heights <italic>S</italic>, <italic>M</italic>, or <italic>T</italic> with five distances of the obstacle from the starting position <italic>d</italic> ∈ {15, 22.5, 30, 37.5, 45}. A control condition had no obstacle. The participants performed each condition 10 times. Each <italic>experimental condition</italic> provided <italic>n</italic> = 100 functional samples for a total of <italic>n</italic><sub><italic>f</italic></sub> = 1600 functional samples in the dataset, leading to a total data size of <italic>m</italic> = 175,535 observed time points.</p>
<p>The present data set is described in detail in [<xref ref-type="bibr" rid="pcbi.1005092.ref023">23</xref>]. The experiment is a refined version of the experiment described in [<xref ref-type="bibr" rid="pcbi.1005092.ref021">21</xref>].</p>
</sec>
<sec id="sec004">
<title>Time warping of functional data</title>
<p>Not every movement has the exact same duration. Comparisons across movement conditions, participants, and repetitions are hampered by the resulting lack of alignment of the movement trajectories. For a single condition, this is illustrated in <xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3(a) and 3(c)</xref>, in which the duration of the movement clearly varies from participant to participant but also from repetition to repetition. Without alignment, it is difficult to compare movements. In an experiment such as the present, in which start and target positions are fixed, the standard solution for aligning samples is to use <italic>percentual time</italic>; the onset of the individual movement corresponds to time 0% and the end of the movement to time 100%. Such linear warping is based on detecting movement onset and offset through threshold criteria. As can be seen in <xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3(b) and 3(c)</xref>, linear warping does not align the characteristic features of the acceleration signals very well, however, as there is still considerable variation in the times at which acceleration peaks. There is, in other words, a nonlinear component to the variation of timing.</p>
<p>To handle nonlinear variation of timing, the signal must be time warped based on an estimated, continuous, and monotonically increasing function that maps percentual time to warped percentual time, such that the functional profiles of the signals are best aligned with each other. Such warping has traditionally been achieved by using the dynamic-time warping (DTW) algorithm [<xref ref-type="bibr" rid="pcbi.1005092.ref024">24</xref>] which offers a fast approach for globally optimal alignment under a prespecified distance measure (for reviews of time warping in the domains of biological movement modeling see [<xref ref-type="bibr" rid="pcbi.1005092.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005092.ref026">26</xref>]). DTW is both simple and elegant, but while it will often produce much better results than cross-sectional comparison of time-warped curves [<xref ref-type="bibr" rid="pcbi.1005092.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1005092.ref029">29</xref>], it does suffer from some problems. In particular, DTW requires a pointwise distance measure such as Euclidean distance. Therefore, the algorithm cannot take serially correlated noise effects in a signal into account. As a result, basic unconstrained DTW will overfit in the sense of producing perfect fits whenever possible, and for areas that cannot be perfectly matched, either stretch them or compress them to a single point. In other words, DTW cannot model curves with systematic amplitude differences, and using DTW to naively compute time warped mean curves is in general problematic [<xref ref-type="bibr" rid="pcbi.1005092.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005092.ref031">31</xref>]. This lacking ability to model serial correlated effects can be somewhat mitigated by restricting the DTW step pattern, in particular through a reduced search window for the warping function and constraints on the maximal step sizes. These are, however, hard model choices, they are restrictions on the set of possible warping functions, and they are a difficult to interpret since they seek to fix a problem in amplitude variation by penalizing warping variation. Instead, a much more natural approach would be to use a data term that models the amplitude variation encountered in data, and to impose warp regularization by using a cost function that puts high cost on undesired warping functions. In the following sections, we will propose a model with these properties, which, in addition, allows for estimating the data term, warp regularization and their relative weights from the data.</p>
<p>To illustrate the difference between DTW and the proposed method, consider the example displayed in <xref ref-type="fig" rid="pcbi.1005092.g004">Fig 4</xref> where the recorded <italic>z</italic>-coordinates (elevation) of one participant’s 10 movements in the control condition (without obstacle) are plotted in recorded time (a) and percentual time (b). These samples have been aligned using DTW by iteratively estimating a pointwise mean function and aligning the samples to the mean function (10 iterations). The three rows of <xref ref-type="fig" rid="pcbi.1005092.g005">Fig 5</xref> display the results of the procedure using three different step patterns. We first note the strong overfitting of the symmetric and asymmetric step patterns, where the sequences with highest elevation are collapsed to minimize the residual. Secondly, we note the jagged warping functions that are results of the discrete nature of the DTW procedure. For comparison, we fitted a variant of the proposed model with a continuous model for the warping function controlled by 13 basis functions. We modeled both amplitude and warping effects as random Gaussian processes using simple, but versatile classes of covariance functions (see Supporting Information), and estimated the internal weighting of the effect directly from the samples. The results are displayed in <xref ref-type="fig" rid="pcbi.1005092.g006">Fig 6</xref>. We see that the warped elevation trajectories seem perfectly aligned, and that the corresponding warping functions are relatively simple, with the majority of variation being near the end of the movement. It is evident from the figures that both the alignment is much more reasonable, and the warping functions are much simpler than the warping functions found using DTW.</p>
<fig id="pcbi.1005092.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Elevation (<italic>z</italic>-dimension) in (a) observed time and (b) percentual time for one participant’s (no.10) repetitions of the control condition without obstacle plotted on different time scales.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005092.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g005</object-id>
<label>Fig 5</label>
<caption>
<title>The elevation trajectories from <xref ref-type="fig" rid="pcbi.1005092.g004">Fig 4</xref> warped with dynamic time warping using different step patterns.</title>
<p>(a)-(b) <italic>Symmetric</italic> step pattern denotes the so-called White-Neely step pattern that has no local constraints, (c)-(d) <italic>asymmetric</italic> step pattern denotes a slope-constrained step pattern where local slopes are required to be between 0 and 2, and (e)-(f) <italic>Sakoe-Chiba</italic> step pattern denotes the asymmetric step pattern proposed in [<xref ref-type="bibr" rid="pcbi.1005092.ref024">24</xref>, Table I] with a slope constraint of 2.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g005" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005092.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g006</object-id>
<label>Fig 6</label>
<caption>
<title>The elevation trajectories from <xref ref-type="fig" rid="pcbi.1005092.g004">Fig 4</xref> warped with the proposed model (a), and the corresponding predicted warping functions (b).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g006" xlink:type="simple"/>
</fig>
<p>Two questions naturally arise. Firstly, are the warping functions unique? Other warping functions could perhaps have produced similarly well-aligned data. Secondly, do we want perfectly aligned trajectories? There is still considerable variation of the amplitude in the warped <italic>z</italic>-coordinates of the movement trajectories in <xref ref-type="fig" rid="pcbi.1005092.g004">Fig 4(c)</xref>, for instance. Some of the variation visible in the unwarped variant in <xref ref-type="fig" rid="pcbi.1005092.g004">Fig 4(b)</xref> could be due to random variations in amplitude rather than timing.</p>
<p>Using the time-warping functions that were determined by aligning the z-coordinates of the movements to now warp the trajectories for the <italic>x</italic>- and <italic>y</italic>-coordinates (<xref ref-type="fig" rid="pcbi.1005092.g007">Fig 7</xref>), we see that the alignment obtained is not perfect. Conversely, were we to use warping functions determined for the <italic>x</italic>- or <italic>y</italic>-coordinate to warp the z-coordinate we would encounter similarly imperfect alignment. Thus, we need a method that avoids over-aligning, and represents a trade-off between the complexity of the warping functions and of the amplitude variation in data. In the next section, we introduce a statistical model that handle this trade-off in a data-driven fashion by using the patterns of variation in the data to find the most likely separation of amplitude and timing variation.</p>
<fig id="pcbi.1005092.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g007</object-id>
<label>Fig 7</label>
<caption>
<title>The other two spatial coordinates of the movements from <xref ref-type="fig" rid="pcbi.1005092.g004">Fig 4</xref> warped with the warping functions from <xref ref-type="fig" rid="pcbi.1005092.g006">Fig 6</xref>, that were estimated from the elevation component <italic>z</italic>.</title>
<p>(a) displays the warped <italic>x</italic>-coordinate trajectories and (b) displays the warped <italic>y</italic>-coordinate trajectories.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g007" xlink:type="simple"/>
</fig>
<sec id="sec005">
<title>Statistical modeling of movement data to achieve time warping</title>
<p>In the following, we describe inference for a single experimental condition. For a given experimental condition—an object that needs to be moved to a target and an obstacle that needs to be avoided—we assume there is a common underlying pattern in all acceleration profiles; all <italic>n</italic><sub><italic>p</italic></sub> = 10 participants will lift the object and move it toward the target, lifting it over the obstacle at some point. This assumption is supported by the pattern in the data that <xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3</xref> visualizes. We denote the hypothesized underlying acceleration profile shared across participants and repetitions by <italic>θ</italic>. In addition to this fixed acceleration profile, we assume that each participant, <italic>i</italic>, has a typical deviation <italic>φ</italic><sub><italic>i</italic></sub> from <italic>θ</italic>, so that the acceleration profile that is characteristic of that participant is <italic>θ</italic> + <italic>φ</italic><sub><italic>i</italic></sub>. Such a systematic pattern characteristic of each participant is apparent in <xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3(c) and 3(d)</xref>. The individual trials (repetitions) of the movement deviate from this characteristic profile of the individual. We model these deviations as additive random effects with serial correlations so that for each repetition, <italic>j</italic>, of the experimental condition we have an additive random effect <italic>x</italic><sub><italic>ij</italic></sub> that causes deviation from the ideal profile. Finally we assume that the data contains observation noise <italic>ε</italic><sub><italic>ij</italic></sub> tied to the tracking system and data processing.</p>
<p>Time was implicit, up to this point, and the observed acceleration profile was decomposed into additive, linear contributions. We now assume, in addition, that each participant, <italic>i</italic>, has a consistent timing of the movement across repetitions, that is reflected in the temporal deformation of the acceleration profile (<xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3(a) and 3(c)</xref>) and is captured by the time warping function <italic>ν</italic><sub><italic>i</italic></sub>. On each repetition, <italic>j</italic>, of the condition, the timing of participant, <italic>i</italic>, contains a random variation of timing around <italic>ν</italic><sub><italic>i</italic></sub> captured by a random warping function <italic>v</italic><sub><italic>ij</italic></sub> (see <xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3</xref>).</p>
<p>Altogether, we have described the following statistical model of the observed acceleration profiles across participants:
<disp-formula id="pcbi.1005092.e001"><alternatives><graphic id="pcbi.1005092.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>φ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∘</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ε</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where ∘ denotes functional composition, <italic>t</italic> denotes time, <inline-formula id="pcbi.1005092.e002"><alternatives><graphic id="pcbi.1005092.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>φ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>:</mml:mo> <mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> are fixed effects and <italic>v</italic><sub><italic>ij</italic></sub>, <italic>x</italic><sub><italic>ij</italic></sub> and <italic>ε</italic><sub><italic>ij</italic></sub> are random effects. The serially correlated effect <italic>x</italic><sub><italic>ij</italic></sub> is assumed to be a zero-mean Gaussian process with a parametric covariance function <inline-formula id="pcbi.1005092.e003"><alternatives><graphic id="pcbi.1005092.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi mathvariant="script">S</mml:mi> <mml:mspace width="0.166667em"/><mml:mo>:</mml:mo> <mml:mspace width="0.166667em"/><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>×</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>; the randomness of the warping function <italic>v</italic><sub><italic>ij</italic></sub> is assumed to be completely characterized by a latent vector of <italic>n</italic><sub><italic>w</italic></sub> zero-mean Gaussian random variables <bold><italic>w</italic></bold><sub><italic>ij</italic></sub> with covariance matrix <italic>σ</italic><sup>2</sup><italic>C</italic>; and <italic>ε</italic><sub><italic>ij</italic></sub> is Gaussian white noise with variance <italic>σ</italic><sup>2</sup>.</p>
<p>Compared to conventional methods for achieving time warping, the proposed <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref> models amplitude and warping variation between repetition as random effects, which enables separation of the effects from the joint likelihood. Conventional approaches for warping model warping functions as fixed effects and do not contain amplitude effects [<xref ref-type="bibr" rid="pcbi.1005092.ref018">18</xref>]. The idea of modeling warping functions as random effects have previously been considered by [<xref ref-type="bibr" rid="pcbi.1005092.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1005092.ref034">34</xref>] where warps were modeled as random shifts or random polynomials. None of these works however included amplitude variation. Recently, some works have considered models with random affine transformations for warps and amplitude variation in relation to growth curve analysis [<xref ref-type="bibr" rid="pcbi.1005092.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005092.ref036">36</xref>]. A generalization that does not require affine transformations for warp and amplitude variation is presented in [<xref ref-type="bibr" rid="pcbi.1005092.ref037">37</xref>]. The presented <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref> is a hierarchical generalization of the model presented in [<xref ref-type="bibr" rid="pcbi.1005092.ref037">37</xref>]. In the context of aligning image sequences in human movement analysis, morphable models [<xref ref-type="bibr" rid="pcbi.1005092.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005092.ref038">38</xref>] model an observed movement pattern as a linear combination of prototypical patterns using both nonlinear warping functions (estimated using DTW) and spatial shifts. Thus morphable models are similar to the warping approaches that model both warp and amplitude effects as fixed [<xref ref-type="bibr" rid="pcbi.1005092.ref039">39</xref>].</p>
</sec>
<sec id="sec006">
<title>Maximum likelihood estimation of parameters</title>
<p>
<xref ref-type="disp-formula" rid="pcbi.1005092.e001">Model (1)</xref> has a considerable number of parameters, both for linear and nonlinear dependencies on the underlying state variable acceleration. The model also has effects that interact. This renders direct simultaneous likelihood estimation intractable. Instead we propose a scheme in which fixed effects and parameters are estimated and random effects are predicted iteratively on three different levels of modeling.</p>
<list list-type="simple">
<list-item>
<p><bold>Nonlinear model</bold> At the nonlinear level, we consider the original <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref>, and simultaneously perform conditional likelihood estimation of the participant-specific warping functions and predict the random warping functions from the negative log posterior. All other parameters remain fixed.</p>
</list-item>
<list-item>
<p><bold>Fixed warp model</bold> At the fixed warp level, we fix the participant-specific warping effect <italic>ν</italic><sub><italic>i</italic></sub> at the conditional maximum likelihood estimate, and the random warping function <italic>v</italic><sub><italic>ij</italic></sub>, at the predicted values. The resulting model is an approximate linear mixed-effects model with Gaussian random effects <italic>x</italic><sub><italic>ij</italic></sub> and <italic>ε</italic><sub><italic>ij</italic></sub>, that allows direct maximum-likelihood estimation of the remaining fixed effects, <italic>θ</italic> and <italic>φ</italic><sub><italic>i</italic></sub>.</p>
</list-item>
<list-item>
<p><bold>Linearized model</bold> At the linearized level, we consider the first-order Taylor approximation of <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref> in the random warp <italic>v</italic><sub><italic>ij</italic></sub>. This linearization is done around the estimate of <italic>ν</italic><sub><italic>i</italic></sub> plus the given prediction of <italic>v</italic><sub><italic>ij</italic></sub> from the nonlinear model. The result is again a linear mixed-effects model, for which one can compute the likelihood explicitly, while taking the uncertainty of all random effects—including the nonlinear effect <italic>v</italic><sub><italic>ij</italic></sub>—into account. At this level all variance parameters are estimated using maximum-likelihood estimation.</p>
</list-item>
</list>
<p>The estimation/prediction procedure is inspired by the algorithmic framework proposed in [<xref ref-type="bibr" rid="pcbi.1005092.ref037">37</xref>]. The estimation procedure is, however, adapted to the hierarchical structure of data and refined in several respects. On the linearized model level, the nonlinear Gaussian random effects are approximated by linear combinations of correlated Gaussian variables around the mode of the nonlinear density. The linearization step thus corresponds to a Laplace approximation of the likelihood, and the quality of this approximation is approximately second order [<xref ref-type="bibr" rid="pcbi.1005092.ref040">40</xref>].</p>
<p>Let <bold><italic>y</italic></bold><sub><italic>ij</italic></sub> be the vector of the <italic>m</italic><sub><italic>ij</italic></sub> observations for participant <italic>i</italic>’s <italic>j</italic>th replication of the given experimental condition, and let <bold><italic>y</italic></bold><sub><italic>i</italic></sub> denote the concatenation of all functional observations of participant <italic>i</italic> in the experimental condition, and <bold><italic>y</italic></bold> the concatenation all these observations across participants. We denote the lengths of these vectors by <italic>m</italic><sub><italic>i</italic></sub> and <italic>m</italic>. Furthermore, let <italic>σ</italic><sup>2</sup><italic>S</italic><sub><italic>ij</italic></sub>, <italic>σ</italic><sup>2</sup><italic>S</italic><sub><italic>i</italic></sub> and <italic>σ</italic><sup>2</sup><italic>S</italic> denote the covariance matrices of <bold><italic>x</italic></bold><sub><italic>ij</italic></sub> = (<italic>x</italic><sub><italic>ij</italic></sub>(<italic>t</italic><sub><italic>k</italic></sub>))<sub><italic>k</italic></sub>, <bold><italic>x</italic></bold><sub><italic>i</italic></sub> = (<bold><italic>x</italic></bold><sub><italic>ij</italic></sub>)<sub><italic>j</italic></sub>, and <bold><italic>x</italic></bold> = (<bold><italic>x</italic></bold><sub><italic>i</italic></sub>)<sub><italic>i</italic></sub> respectively. We note that the index set for <italic>k</italic> depends on <italic>i</italic> and <italic>j</italic> since the covariance matrices <italic>S</italic><sub><italic>ij</italic></sub> vary in size due to the different durations of the movements and because of possible missing values when markers are occluded.</p>
<p>We note that all random effects are scaled by the noise standard deviation <italic>σ</italic>. This parametrization is chosen because it simplifies the likelihood computations, as we shall see. Finally, we denote the norm induced by a full-rank covariance matrix <italic>A</italic> by <inline-formula id="pcbi.1005092.e004"><alternatives><graphic id="pcbi.1005092.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo> <mml:mi>z</mml:mi> <mml:mo>‖</mml:mo></mml:mrow> <mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow> <mml:mi>⊤</mml:mi></mml:msup> <mml:msup><mml:mi>A</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec007">
<title>Fixed warp level</title>
<p>We model the underlying profile, <italic>θ</italic>, and the participant-specific variation around this trajectory, <italic>φ</italic><sub><italic>i</italic></sub>, in the common (warped) functional basis <inline-formula id="pcbi.1005092.e005"><alternatives><graphic id="pcbi.1005092.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>×</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, with weights <bold><italic>c</italic></bold> = (<italic>c</italic><sub>1</sub>, …, <italic>c</italic><sub><italic>K</italic></sub>) for <italic>θ</italic> and <bold><italic>d</italic></bold><sub><italic>i</italic></sub> = (<italic>d</italic><sub><italic>i</italic>1</sub>, …, <italic>d</italic><sub><italic>iK</italic></sub>) for <italic>φ</italic><sub><italic>i</italic></sub>. We assume that the participant-specific variations, <italic>φ</italic><sub><italic>i</italic></sub>, are centered around <italic>θ</italic> and thus <inline-formula id="pcbi.1005092.e006"><alternatives><graphic id="pcbi.1005092.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="bold-italic">d</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">0</mml:mn> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>K</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Furthermore, the square magnitude of the weights, <bold><italic>d</italic></bold><sub><italic>i</italic></sub>, is penalized with a weighting factor <italic>η</italic>. This penalization helps guiding the alignment process in the direction of the highest possible level of detail in the common profile <italic>θ</italic> when the initial alignment is poor.</p>
<p>For fixed warping functions <italic>ν</italic><sub><italic>i</italic></sub> and <italic>v</italic><sub><italic>ij</italic></sub>, the negative log likelihood function in <italic>θ</italic> = <bold>Φ</bold><bold><italic>c</italic></bold> is proportional to
<disp-formula id="pcbi.1005092.e007"><alternatives><graphic id="pcbi.1005092.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mrow><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo mathvariant="bold-italic">c</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo> <mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mo>-</mml:mo> <mml:mo mathvariant="bold">Φ</mml:mo> <mml:mo mathvariant="bold-italic">c</mml:mo> <mml:mo>‖</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>S</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1005092.e045"><alternatives><graphic id="pcbi.1005092.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> denotes the <italic>n</italic> × <italic>n</italic> identity matrix. This yields the estimate
<disp-formula id="pcbi.1005092.e008"><alternatives><graphic id="pcbi.1005092.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:mover accent="true"><mml:mo mathvariant="bold-italic">c</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow> <mml:mi>⊤</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo mathvariant="bold">Φ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo mathvariant="bold">Φ</mml:mo></mml:mrow> <mml:mi>⊤</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
The penalized negative profile log likelihood for the weights <bold><italic>d</italic></bold><sub><italic>i</italic></sub> for <italic>φ</italic><sub><italic>i</italic></sub> is proportional to
<disp-formula id="pcbi.1005092.e009"><alternatives><graphic id="pcbi.1005092.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo mathvariant="bold-italic">d</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo> <mml:msub><mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mo mathvariant="bold-italic">c</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mo mathvariant="bold-italic">d</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>‖</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mi>η</mml:mi> <mml:msubsup><mml:mo mathvariant="bold-italic">d</mml:mo> <mml:mi>i</mml:mi> <mml:mi>⊤</mml:mi></mml:msubsup> <mml:msub><mml:mo mathvariant="bold-italic">d</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
which gives the maximum likelihood estimator
<disp-formula id="pcbi.1005092.e010"><alternatives><graphic id="pcbi.1005092.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold-italic">d</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>⊤</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>η</mml:mi> <mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:mi>K</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msubsup><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>⊤</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mo mathvariant="bold">Φ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mover accent="true"><mml:mo mathvariant="bold-italic">c</mml:mo> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
</sec>
<sec id="sec008">
<title>Nonlinear level</title>
<p>Similarly to the linear mixed-effects setting [<xref ref-type="bibr" rid="pcbi.1005092.ref041">41</xref>], it is natural to predict nonlinear random effects from the posterior [<xref ref-type="bibr" rid="pcbi.1005092.ref020">20</xref>], since these predictions correspond to the most likely values of the random effects given the observed data. Recall that the Gaussian variables, <bold><italic>w</italic></bold><sub><italic>ij</italic></sub>, parametrize the randomness of the repetition-specific warping function <italic>v</italic><sub><italic>ij</italic></sub>. Since the conditional negative (profile) log likelihood function in <italic>ν</italic><sub><italic>i</italic></sub> given the random warping function <italic>v</italic><sub><italic>ij</italic></sub> and the negative (profile) log posterior for <bold><italic>w</italic></bold><sub><italic>ij</italic></sub> coincide, we propose to simultaneously estimate the fixed warping effects <italic>ν</italic><sub><italic>i</italic></sub> and predict the random warping effects <italic>v</italic><sub><italic>ij</italic></sub> from the joint conditional negative log likelihood/negative log posterior which is proportional to
<disp-formula id="pcbi.1005092.e011"><alternatives><graphic id="pcbi.1005092.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∘</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>‖</mml:mo></mml:mrow> <mml:mo mathvariant="bold-italic">c</mml:mo> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
Since the variables <bold><italic>w</italic></bold><sub><italic>ij</italic></sub> can be arbitrarily transformed through the choice of warping function <italic>v</italic><sub><italic>ij</italic></sub>, the assumption that variables are Gaussian is merely one of computational convenience.</p>
</sec>
<sec id="sec009">
<title>Linearized level</title>
<p>We can write the local linearization of <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref> in the random warping parameters <bold><italic>w</italic></bold><sub><italic>ij</italic></sub> around a given prediction <inline-formula id="pcbi.1005092.e012"><alternatives><graphic id="pcbi.1005092.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi mathvariant="bold-italic">w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> as a vectorized linear mixed-effects model
<disp-formula id="pcbi.1005092.e013"><alternatives><graphic id="pcbi.1005092.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mo>≈</mml:mo> <mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>+</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">w</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
with effects given by
<disp-formula id="pcbi.1005092.e014"><alternatives><graphic id="pcbi.1005092.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>φ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∘</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>m</mml:mi></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1005092.e015"><alternatives><graphic id="pcbi.1005092.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:mi>Z</mml:mi> <mml:mo>=</mml:mo> <mml:mtext>diag</mml:mtext> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold-italic">t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>φ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∘</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mi mathvariant="bold-italic">w</mml:mi></mml:msub> <mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>⊤</mml:mi></mml:msup> <mml:mo>}</mml:mo></mml:mrow> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>×</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>w</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1005092.e016"><alternatives><graphic id="pcbi.1005092.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:msub><mml:mi>n</mml:mi> <mml:mi>w</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:msub> <mml:mo>⊗</mml:mo> <mml:mi>C</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>∼</mml:mo> <mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi mathvariant="bold-italic">ε</mml:mi> <mml:mo>∼</mml:mo> <mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mo mathvariant="double-struck">I</mml:mo> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1005092.e017"><alternatives><graphic id="pcbi.1005092.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msubsup><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> indicates that the warping function is evaluated at the prediction <inline-formula id="pcbi.1005092.e018"><alternatives><graphic id="pcbi.1005092.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mi mathvariant="bold-italic">w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, diag(<italic>Z</italic><sub><italic>ij</italic></sub>)<sub><italic>ij</italic></sub> is the block diagonal matrix with the <italic>Z</italic><sub><italic>ij</italic></sub> matrices along its diagonal, and ⊗ denotes the Kronecker product.</p>
<p>Altogether, twice the negative profile log likelihood function for the linearized <xref ref-type="disp-formula" rid="pcbi.1005092.e013">model (3)</xref> is
<disp-formula id="pcbi.1005092.e019"><alternatives><graphic id="pcbi.1005092.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>m</mml:mi> <mml:mtext> log </mml:mtext> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mtext>log det</mml:mtext> <mml:mi>V</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:msubsup><mml:mrow><mml:mo>‖</mml:mo> <mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold-italic">ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mi>Z</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msup> <mml:mo>‖</mml:mo></mml:mrow> <mml:mrow><mml:mi>V</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1005092.e020"><alternatives><graphic id="pcbi.1005092.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:mi>V</mml:mi> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi> <mml:mo>+</mml:mo> <mml:mi>Z</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">I</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>⊗</mml:mo> <mml:mi>C</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msup><mml:mi>Z</mml:mi> <mml:mo>⊤</mml:mo></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">I</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec010">
<title>Modeling of effects and algorithmic approach</title>
<p>So far, the <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref> has only been presented in a general sense. We now consider the specific modeling choices. The acceleration data has been rescaled using a common scaling for all experimental conditions, such that the span of data values has length 1 and the global timespan is the interval [0, 1].</p>
<p>To model the amplitude effects, we use a cubic B-spline basis <bold>Φ</bold> with <italic>K</italic> knots [<xref ref-type="bibr" rid="pcbi.1005092.ref042">42</xref>].</p>
<p>We require that the fixed warping function <italic>ν</italic><sub><italic>i</italic></sub> is an increasing piecewise linear homeomorphism parametrized by <italic>n</italic><sub><italic>w</italic></sub> equidistant anchor points in (0, 1), and assume that <italic>v</italic><sub><italic>ij</italic></sub> is of the form
<disp-formula id="pcbi.1005092.e021"><alternatives><graphic id="pcbi.1005092.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="script">E</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1005092.e022"><alternatives><graphic id="pcbi.1005092.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msub><mml:mi mathvariant="script">E</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the linear interpolation at <italic>t</italic> of the values <bold><italic>w</italic></bold><sub><italic>ij</italic></sub> placed at the <italic>n</italic><sub><italic>w</italic></sub> anchor points in (0, 1). In the given experimental setting, the movement path is fixed at the onset and the end of the movement. The movement starts when the cylindrical object is lifted and ends when it is placed at its target position. Thus, we would expect the biggest variation in timing to be in the middle of the movement (in percentual time). These properties can be modeled by assuming that <bold><italic>w</italic></bold><sub><italic>ij</italic></sub> is a discretely observed zero-drift Brownian bridge with scale <italic>σ</italic><sup>2</sup> <italic>γ</italic><sup>2</sup> [<xref ref-type="bibr" rid="pcbi.1005092.ref043">43</xref>], which means that the covariance matrix <italic>σ</italic><sup>2</sup><italic>C</italic> is given by point evaluation of the covariance function
<disp-formula id="pcbi.1005092.e023"><alternatives><graphic id="pcbi.1005092.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mi mathvariant="script">C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mi>γ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="0.166667em"/><mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
for <italic>t</italic> ≤ <italic>t</italic>′. When predicting the warps from the negative log posterior we restrict the search space to warps <italic>ν</italic><sub><italic>i</italic></sub> and <italic>ν</italic><sub><italic>i</italic></sub> + <italic>v</italic><sub><italic>ij</italic></sub> that are increasing homeomorphic maps of the domain [0, 1] onto itself. The conditional distribution of <italic>ν</italic><sub><italic>ij</italic></sub> given this restriction is slightly changed. For the used numbers of anchor points <italic>n</italic><sub><italic>w</italic></sub> and the estimated variance parameters the difference is however minuscule, and we use the original Brownian model as a high-quality approximation of the true distribution.</p>
<p>We assume that the sample paths of the serially correlated effects <italic>x</italic><sub><italic>ij</italic></sub> are continuous and that the process is stationary [<xref ref-type="bibr" rid="pcbi.1005092.ref044">44</xref>]. A natural choice of covariance is then the Matérn covariance with smoothness parameter <italic>μ</italic>, scale <italic>σ</italic><sup>2</sup><italic>τ</italic><sup>2</sup> and range 1/<italic>α</italic> [<xref ref-type="bibr" rid="pcbi.1005092.ref045">45</xref>], since it offers a broad class of stationarity covariance functions.</p>
<p>Finally, in order to consistently penalize the participant-specific spline across experimental conditions with varying variance parameters, we will use penalization weights that are normalized with the variance of the amplitude effects, <italic>η</italic> = <italic>λ</italic>/(1 + <italic>τ</italic><sup>2</sup>).</p>
<p>The algorithm for doing inference in <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref> is outlined in Algorithm 1. We have found that <italic>i</italic><sub>max</sub> = <italic>j</italic><sub>max</sub> = 5 outer and inner loops are sufficient for convergence. A wide variety of these types of models can be fitted using the <monospace>pavpop</monospace> R package [<xref ref-type="bibr" rid="pcbi.1005092.ref022">22</xref>]. A short guide on model building and fitting is available as Supporting Information.</p>
<p><bold>Algorithm 1</bold> Maximum likelihood estimation for <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref></p>
<p specific-use="line">1: <bold>procedure</bold> MLE (<bold><italic>y</italic></bold>, <italic>η</italic>, <italic>τ</italic><sup>2</sup>, <italic>α</italic>, <italic>γ</italic><sup>2</sup>)</p>
<p specific-use="line">2:  Compute <inline-formula id="pcbi.1005092.e024"><alternatives><graphic id="pcbi.1005092.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005092.e025"><alternatives><graphic id="pcbi.1005092.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> assuming an identity warp                        ⊳ Initialize</p>
<p specific-use="line">3:  <bold>for</bold> <italic>i</italic> = 1, …, <italic>i</italic><sub>max</sub> <bold>do</bold>                                         ⊳ Outer iterations</p>
<p specific-use="line">4:   <bold>for</bold> <italic>j</italic> = 1, …, <italic>j</italic><sub>max</sub> <bold>do</bold>                                        ⊳ Inner iterations</p>
<p specific-use="line">5:    Estimate and predict warping functions by minimizing the posterior <xref ref-type="disp-formula" rid="pcbi.1005092.e011">Eq (2)</xref></p>
<p specific-use="line">6:    <bold>if</bold> Estimates and predictions do not change <bold>then break</bold></p>
<p specific-use="line">7:    <bold>end if</bold></p>
<p specific-use="line">8:    Recompute <inline-formula id="pcbi.1005092.e026"><alternatives><graphic id="pcbi.1005092.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005092.e027"><alternatives><graphic id="pcbi.1005092.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
<p specific-use="line">9:   <bold>end for</bold></p>
<p specific-use="line">10:   Estimate variance parameters by minimizing the linearized likelihood <xref ref-type="disp-formula" rid="pcbi.1005092.e019">Eq (4)</xref></p>
<p specific-use="line">11:  <bold>end for</bold></p>
<p specific-use="line">12:  <bold>return</bold> <inline-formula id="pcbi.1005092.e028"><alternatives><graphic id="pcbi.1005092.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005092.e029"><alternatives><graphic id="pcbi.1005092.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>φ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005092.e030"><alternatives><graphic id="pcbi.1005092.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005092.e031"><alternatives><graphic id="pcbi.1005092.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msup><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005092.e032"><alternatives><graphic id="pcbi.1005092.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005092.e033"><alternatives><graphic id="pcbi.1005092.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msup><mml:mover accent="true"><mml:mi>τ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005092.e034"><alternatives><graphic id="pcbi.1005092.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mover accent="true"><mml:mi>α</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005092.e035"><alternatives><graphic id="pcbi.1005092.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msup><mml:mover accent="true"><mml:mi>γ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>     ⊳ Maximum likelihood estimates</p>
<p specific-use="line">13: <bold>end procedure</bold></p>
<p>In the following we consider two approaches, with (1) samples parametrized by recorded time (<xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3a</xref>) and (2) samples parametrized by percentual time (<xref ref-type="fig" rid="pcbi.1005092.g003">Fig 3b</xref>). Parameters for the latter case will be denoted by a subscript p.</p>
<p>The number of basis functions <italic>K</italic>, the number of warping anchor points <italic>n</italic><sub><italic>w</italic></sub>, and the regularization parameter <italic>λ</italic> were determined by the average 5-fold cross-validation score on each of three experimental conditions (<italic>d</italic> = 30 cm and obstacle heights <italic>S</italic>, <italic>M</italic>, and <italic>T</italic>). The models were fitted using the method described in the previous section, and the quality of the models was evaluated through the accuracy of classifying the participant from a given movement in the test set, using posterior distance between the sample and the combined estimates for the fixed effects (<italic>θ</italic> + <italic>φ</italic><sub><italic>i</italic></sub>) ∘ <italic>ν</italic><sub><italic>i</italic></sub>. The cross-validation was done over a grid of the following values <italic>μ</italic>, <italic>μ</italic><sub>p</sub> ∈ {0.5, 1, 2}, <italic>K</italic> ∈ {8, 13, 18, 23, 28, 33}, <italic>K</italic><sub>p</sub> ∈ {8, 9, …, 18}, <italic>n</italic><sub><italic>w</italic></sub>, <italic>n</italic><sub><italic>w</italic>p</sub> ∈ {0, 1, 2, 3, 5, 10}, <italic>λ</italic>, <italic>λ</italic><sub>p</sub> ∈ {0, 1, 2, 3}. The best values were found to be <italic>μ</italic> = 2, <italic>K</italic> = 23, <italic>n</italic><sub><italic>w</italic></sub> = 2, <italic>λ</italic> = 2 and <italic>μ</italic><sub>p</sub> = 1 <italic>K</italic><sub>p</sub> = 12, <italic>n</italic><sub><italic>w</italic>p</sub> = 1, <italic>λ</italic><sub>p</sub> = 0. We note that the smoothness parameter <italic>μ</italic> = 2 is on the boundary of the cross-validation grid. The qualitative difference between second order smoothness <italic>μ</italic> = 2 (corresponding to twice differentiable sample paths of amplitude effects) and higher order is so small, however, that we chose to ignore higher order smoothness. Furthermore, <italic>λ</italic><sub>p</sub> = 0 indicates that we do not need to penalize participant-specific amplitude effects when working with percentual time. The reason is most likely that the samples have better initial alignment in percentual time. The estimated participant-specific acceleration profiles using percentual time can be seen in <xref ref-type="fig" rid="pcbi.1005092.g008">Fig 8</xref>.</p>
<fig id="pcbi.1005092.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Estimated fixed effects (<italic>θ</italic> + <italic>φ</italic><sub><italic>i</italic></sub>) ∘ <italic>ν</italic><sub><italic>i</italic></sub> in the 15 obstacle avoidance experiments using percentual time.</title>
<p>The dashed trajectory shows the estimate for <italic>θ</italic>. The average percentual warped time between two white vertical bars corresponds to 0.2 seconds.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g008" xlink:type="simple"/>
</fig>
<p>A simulation study that validates the method and implementation on data simulated using the maximum likelihood estimates of the central experimental condition (<italic>d</italic> = 30.0 cm, medium obstacle) is available as Supporting Information.</p>
</sec>
</sec>
</sec>
<sec id="sec011" sec-type="results">
<title>Results</title>
<sec id="sec012">
<title>Identification of individual differences</title>
<p>A first assessment of the strength of the statistical <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref> is to examine the extent to which the model captures individual differences. Proper modeling of systematic individual differences is not only of scientific interest per se, but also provides perspective for interpreting any observed experimental effects. To validate the capability of the model to capture systematic individual differences, we use the model to identify an individual from the estimated individual templates. Such identification of individuals is becoming increasingly relevant also in a practical sense with the recent technological advances in motion tracking systems, and the growing array of digital sensors in handheld consumer electronics. Consistent with the framing of <xref ref-type="disp-formula" rid="pcbi.1005092.e001">model (1)</xref>, we perform identification of individual participants on the basis of the data from a single experimental condition. This is, in a sense, a conservative approach. Combining data across the different conditions of the experimental tasks would likely provide more discriminative power given that personal movement styles tend to be reproducible.</p>
<p>The classification of the movement data is based on the characteristic acceleration profile computed for each participant. For this to work it is important that individual movement differences are not smoothed away. The hyperparameters of the model were chosen with this requirement in mind. In the following, we describe alternative methods we considered. For all approaches, the stated parameters have been chosen by 5-fold cross-validation on the experimental conditions with obstacle distance <italic>d</italic> = 30.0 cm. The grids used for cross-validation are given as Supporting Information section. Recall that subscript <italic>p</italic> indicates the use of percentuall time.</p>
<list list-type="simple">
<list-item><p><bold>Nearest Participant (NP)</bold> NP classification classifies using the minimum combined pointwise <italic>L</italic><sup>2</sup> distance to all samples for every individual in the training set.</p>
</list-item>
<list-item><p><bold>Modified Band Median (MBM)</bold> MBM classification estimates templates using the modified band median proposed in [<xref ref-type="bibr" rid="pcbi.1005092.ref046">46</xref>], which under mild conditions is a consistent estimator of the underlying fixed amplitude effects warped according to the modified band medians of the warping functions. Classification is done using <italic>L</italic><sup>2</sup> distance to the estimated templates. In the computations we count the number of bands defined by <italic>J</italic> = 4 curves [<xref ref-type="bibr" rid="pcbi.1005092.ref046">46</xref>, Section 2.2]. MBM<sub>p</sub> used <italic>J</italic><sub>p</sub> = 2.</p>
</list-item>
<list-item><p><bold>Robust Manifold Embedding (RME)</bold> RME classification estimates templates using the robust manifold embedding algorithm proposed in [<xref ref-type="bibr" rid="pcbi.1005092.ref047">47</xref>], which, assuming that data lies on a low-dimensional smooth manifold, approximates the geodesic distance and computes the empirical Fréchet median function. Classification is done using <italic>L</italic><sup>2</sup> distance to the estimated templates.</p>
</list-item>
<list-item><p><bold>Dynamic Time Warping (DTW)</bold> DTW classification estimates templates by iteratively time warping samples to the current estimated personal template (5 iterations per template) using an asymmetric step pattern (slopes between 0 and 2). The template is modeled by a B-spline with 33 degrees of freedom. DTW<sub>p</sub> used 16 degrees of freedom.</p>
</list-item>
<list-item><p><bold>Fisher-Rao (FR)</bold> FR classification estimates templates as Karcher means under the Fisher-Rao Riemannian metric [<xref ref-type="bibr" rid="pcbi.1005092.ref048">48</xref>] of the data represented using a single principal component [<xref ref-type="bibr" rid="pcbi.1005092.ref049">49</xref>]. Čencov’s theorem states that the Fisher-Rao distance is the only distance that is preserved under warping [<xref ref-type="bibr" rid="pcbi.1005092.ref050">50</xref>], and in practice the distance is computed by using a dynamic time warping algorithm on the square-root slope functions of the data. Classification is done using <italic>L</italic><sup>2</sup> distance to the estimated templates.</p>
</list-item>
<list-item><p><bold>Elastic Fisher-Rao (FR<sub>E</sub>)</bold> FR<sub>E</sub> classification estimates templates analogously to FR, but classifies using the weighted sum of elastic amplitude and phase distances [<xref ref-type="bibr" rid="pcbi.1005092.ref051">51</xref>, Definition 1 and Section 3.1]. The phase distance was weighted by a factor 1.5. FR<sub>Ep</sub> uses two principal components and a phase distance weight of 1.</p>
</list-item>
<list-item><p><bold>Timing and Motion Separation (TMS)</bold> The proposed TMS classification estimates templates of the fixed effects (<italic>θ</italic> + <italic>φ</italic><sub><italic>i</italic></sub>) ∘ <italic>ν</italic><sub><italic>i</italic></sub> using Algorithm 1. Classification is done using least distance measured in the negative log posterior <xref ref-type="disp-formula" rid="pcbi.1005092.e011">Eq (2)</xref> as a function of the test samples. The parameters were set as described in the previous section.</p>
</list-item>
</list>
<p>We evaluate classification accuracy using 5-fold cross-validation, which means that eight samples are available in the training set for every participant. The folds of the cross-validation are chosen chronologically, such that the first fold contains replications 1 and 2, the second contains 3 and 4 and so on. The results are available in <xref ref-type="table" rid="pcbi.1005092.t001">Table 1</xref>. We see that TMS and TMS<sub>p</sub> achieve the highest classification rates, followed by FR<sub>Ep</sub>, FR<sub>p</sub> and RME<sub>p</sub>. Thus, the model enables identification of individual movement style. Furthermore, we note that there is little effect of using percentual time for the proposed method, which for all other methods gives a considerable boost in accuracy. This suggests that the TMS methods align data well without the initial linear warping and the endpoint constraints of percentual time.</p>
<table-wrap id="pcbi.1005092.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.t001</object-id>
<label>Table 1</label>
<caption>
<title>Classification accuracies of various methods.</title> <p><bold>Bold</bold> indicates best result(s), <italic>italic</italic> indicates that the given experiments were used for training.</p>
</caption>
<alternatives>
<graphic id="pcbi.1005092.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" style="border-bottom:thick"><italic>d</italic></th>
<th align="center" style="border-bottom:thick">obstacle</th>
<th align="center" style="border-bottom:thick">NP</th>
<th align="center" style="border-bottom:thick">NP<sub>p</sub></th>
<th align="center" style="border-bottom:thick">MBM</th>
<th align="center" style="border-bottom:thick">MBM<sub>p</sub></th>
<th align="center" style="border-bottom:thick">RME</th>
<th align="center" style="border-bottom:thick">RME<sub>p</sub></th>
<th align="center" style="border-bottom:thick">DTW</th>
<th align="center" style="border-bottom:thick">DTW<sub>p</sub></th>
<th align="center" style="border-bottom:thick">FR</th>
<th align="center" style="border-bottom:thick">FR<sub>p</sub></th>
<th align="center" style="border-bottom:thick">FR<sub>E</sub></th>
<th align="center" style="border-bottom:thick">FR<sub>Ep</sub></th>
<th align="center" style="border-bottom:thick">TMS</th>
<th align="center" style="border-bottom:thick">TMS<sub>p</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="3">15.0 cm</td>
<td align="center"><italic>S</italic></td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">0.53</td>
<td align="char" char=".">0.43</td>
<td align="char" char=".">0.55</td>
<td align="char" char=".">0.57</td>
<td align="char" char=".">0.52</td>
<td align="char" char=".">0.52</td>
<td align="char" char=".">0.47</td>
<td align="char" char=".">0.54</td>
<td align="char" char=".">0.62</td>
<td align="char" char=".">0.51</td>
<td align="char" char=".">0.70</td>
<td align="char" char="."><bold>0.76</bold></td>
</tr>
<tr>
<td align="center"><italic>M</italic></td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">0.46</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.41</td>
<td align="char" char=".">0.43</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.56</td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.47</td>
<td align="char" char=".">0.46</td>
<td align="char" char="."><bold>0.69</bold></td>
<td align="char" char=".">0.66</td>
</tr>
<tr>
<td align="center"><italic>T</italic></td>
<td align="char" char=".">0.41</td>
<td align="char" char=".">0.47</td>
<td align="char" char=".">0.41</td>
<td align="char" char=".">0.46</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">0.43</td>
<td align="char" char=".">0.43</td>
<td align="char" char=".">0.32</td>
<td align="char" char=".">0.56</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.49</td>
<td align="char" char="."><bold>0.64</bold></td>
<td align="char" char=".">0.62</td>
</tr>
<tr>
<td align="center" rowspan="3">22.5 cm</td>
<td align="center"><italic>S</italic></td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.34</td>
<td align="char" char=".">0.46</td>
<td align="char" char=".">0.37</td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.44</td>
<td align="char" char=".">0.44</td>
<td align="char" char=".">0.51</td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">0.51</td>
<td align="char" char="."><bold>0.70</bold></td>
<td align="char" char=".">0.68</td>
</tr>
<tr>
<td align="center"><italic>M</italic></td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.44</td>
<td align="char" char=".">0.42</td>
<td align="char" char=".">0.53</td>
<td align="char" char=".">0.46</td>
<td align="char" char=".">0.55</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.42</td>
<td align="char" char=".">0.32</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.42</td>
<td align="char" char=".">0.55</td>
<td align="char" char=".">0.62</td>
<td align="char" char="."><bold>0.74</bold></td>
</tr>
<tr>
<td align="center"><italic>T</italic></td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.54</td>
<td align="char" char=".">0.46</td>
<td align="char" char=".">0.57</td>
<td align="char" char=".">0.40</td>
<td align="char" char=".">0.53</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">0.57</td>
<td align="char" char=".">0.53</td>
<td align="char" char="."><bold>0.64</bold></td>
<td align="char" char=".">0.61</td>
<td align="char" char="."><bold>0.64</bold></td>
</tr>
<tr>
<td align="center" rowspan="3">30.0 cm</td>
<td align="center"><italic>S</italic></td>
<td align="char" char=".">0.27</td>
<td align="char" char=".">0.29</td>
<td align="char" char="."><italic>0.37</italic></td>
<td align="char" char="."><italic>0.47</italic></td>
<td align="char" char=".">0.41</td>
<td align="char" char=".">0.45</td>
<td align="char" char="."><italic>0.43</italic></td>
<td align="char" char="."><italic>0.44</italic></td>
<td align="char" char="."><italic>0.40</italic></td>
<td align="char" char="."><italic>0.43</italic></td>
<td align="char" char="."><italic>0.46</italic></td>
<td align="char" char="."><italic>0.55</italic></td>
<td align="char" char="."><italic>0.63</italic></td>
<td align="char" char="."><italic><bold>0.65</bold></italic></td>
</tr>
<tr>
<td align="center"><italic>M</italic></td>
<td align="char" char=".">0.30</td>
<td align="char" char=".">0.42</td>
<td align="char" char="."><italic>0.38</italic></td>
<td align="char" char="."><italic>0.46</italic></td>
<td align="char" char=".">0.40</td>
<td align="char" char=".">0.45</td>
<td align="char" char="."><italic>0.34</italic></td>
<td align="char" char="."><italic>0.49</italic></td>
<td align="char" char="."><italic>0.36</italic></td>
<td align="char" char="."><italic>0.48</italic></td>
<td align="char" char="."><italic>0.46</italic></td>
<td align="char" char="."><italic>0.47</italic></td>
<td align="char" char="."><italic><bold>0.65</bold></italic></td>
<td align="char" char="."><italic><bold>0.65</bold></italic></td>
</tr>
<tr>
<td align="center"><italic>T</italic></td>
<td align="char" char=".">0.37</td>
<td align="char" char=".">0.44</td>
<td align="char" char="."><italic>0.42</italic></td>
<td align="char" char="."><italic>0.50</italic></td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">0.45</td>
<td align="char" char="."><italic>0.44</italic></td>
<td align="char" char="."><italic>0.44</italic></td>
<td align="char" char="."><italic>0.37</italic></td>
<td align="char" char="."><italic>0.50</italic></td>
<td align="char" char="."><italic>0.39</italic></td>
<td align="char" char="."><italic>0.43</italic></td>
<td align="char" char="."><italic><bold>0.74</bold></italic></td>
<td align="char" char="."><italic>0.69</italic></td>
</tr>
<tr>
<td align="center" rowspan="3">37.5 cm</td>
<td align="center"><italic>S</italic></td>
<td align="char" char=".">0.28</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.41</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.42</td>
<td align="char" char=".">0.51</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">0.51</td>
<td align="char" char=".">0.39</td>
<td align="char" char=".">0.56</td>
<td align="char" char=".">0.69</td>
<td align="char" char="."><bold>0.74</bold></td>
</tr>
<tr>
<td align="center"><italic>M</italic></td>
<td align="char" char=".">0.26</td>
<td align="char" char=".">0.33</td>
<td align="char" char=".">0.33</td>
<td align="char" char=".">0.37</td>
<td align="char" char=".">0.35</td>
<td align="char" char=".">0.41</td>
<td align="char" char=".">0.40</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.35</td>
<td align="char" char=".">0.37</td>
<td align="char" char=".">0.32</td>
<td align="char" char=".">0.53</td>
<td align="char" char=".">0.57</td>
<td align="char" char="."><bold>0.62</bold></td>
</tr>
<tr>
<td align="center"><italic>T</italic></td>
<td align="char" char=".">0.31</td>
<td align="char" char=".">0.43</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.43</td>
<td align="char" char=".">0.40</td>
<td align="char" char=".">0.46</td>
<td align="char" char=".">0.37</td>
<td align="char" char=".">0.29</td>
<td align="char" char=".">0.50</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">0.49</td>
<td align="char" char=".">0.55</td>
<td align="char" char=".">0.63</td>
<td align="char" char="."><bold>0.65</bold></td>
</tr>
<tr>
<td align="center" rowspan="3">45.0 cm</td>
<td align="center"><italic>S</italic></td>
<td align="char" char=".">0.25</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.33</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.32</td>
<td align="char" char=".">0.42</td>
<td align="char" char=".">0.34</td>
<td align="char" char=".">0.51</td>
<td align="char" char=".">0.32</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.37</td>
<td align="char" char=".">0.41</td>
<td align="char" char="."><bold>0.68</bold></td>
<td align="char" char=".">0.65</td>
</tr>
<tr>
<td align="center"><italic>M</italic></td>
<td align="char" char=".">0.29</td>
<td align="char" char=".">0.31</td>
<td align="char" char=".">0.29</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.39</td>
<td align="char" char=".">0.43</td>
<td align="char" char=".">0.43</td>
<td align="char" char=".">0.36</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.53</td>
<td align="char" char="."><bold>0.57</bold></td>
</tr>
<tr>
<td align="center"><italic>T</italic></td>
<td align="char" char=".">0.29</td>
<td align="char" char=".">0.39</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">0.48</td>
<td align="char" char=".">0.57</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.45</td>
<td align="char" char=".">0.39</td>
<td align="char" char=".">0.44</td>
<td align="char" char=".">0.44</td>
<td align="char" char=".">0.47</td>
<td align="char" char="."><bold>0.66</bold></td>
<td align="char" char=".">0.58</td>
</tr>
<tr>
<td align="left" colspan="2">average</td>
<td align="char" char=".">0.323</td>
<td align="char" char=".">0.418</td>
<td align="char" char=".">0.393</td>
<td align="char" char=".">0.460</td>
<td align="char" char=".">0.427</td>
<td align="char" char=".">0.482</td>
<td align="char" char=".">0.417</td>
<td align="char" char=".">0.463</td>
<td align="char" char=".">0.387</td>
<td align="char" char=".">0.484</td>
<td align="char" char=".">0.449</td>
<td align="char" char=".">0.487</td>
<td align="char" char=".">0.649</td>
<td align="char" char="."><bold>0.660</bold></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec013">
<title>Factor analysis of spatial movement paths</title>
<p>In the previous section, the proposed modeling framework was shown to give unequalled accuracy of modeling the time series data for acceleration. In this section we use the warping functions obtained to analyze the spatial movement paths and their dependence on task conditions. Temporal alignment of the spatial positions along the path for different repetitions and participants is necessary to avoid spurious spatial variance of the paths. The natural alignment of two movement paths is the one that matches their acceleration signatures. In other words, spatial positions along the paths at which similar accelerations are experienced should correspond to the same times. Thus, each individual spatial trajectory was aligned using the time warping predicted from the TMS<sub>p</sub>-results of the previous section. Every sample path was represented by 30 equidistant sample points in time at which values were obtained by fitting a three-dimensional B-splines with 10 equidistantly spaced knots to each trajectory.</p>
<p>As an exemplary study, we analyze how spatial paths depend on obstacle height. We do this separately for each distance, so that we perform five separate analyses, one for each obstacle placement. In each analysis we have 10 participants with 10 repetitions for each of 3 obstacle heights. The three-dimensional spatial positions along the movement path, <inline-formula id="pcbi.1005092.e036"><alternatives><graphic id="pcbi.1005092.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msub><mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>h</mml:mi></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>30</mml:mn> <mml:mo>×</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, depend on participant <italic>i</italic> = 1,…,10, repetition <italic>j</italic> = 1,…,10 and height <italic>h</italic> = 1,2,3.</p>
<p>We are interested in understanding how the space-time structure of movement captured in the 30 by 3 dimensions of the trajectories, <bold><italic>y</italic></bold><sub><italic>ijh</italic></sub>, varies when obstacle height is varied. We seek to find a low-dimensional affine subspace of the space-time representation of the movements within which movements vary, once properly aligned. That subspace provides a low-dimensional model of movement paths on the basis of which we can analyze the data.</p>
<p>We identify the low-dimensional subspace based on a novel factor analysis model. In analogy to principal component analysis (PCA), <italic>q</italic> so-called <italic>loadings</italic> are estimated that represent dominant patterns of variation along movement trajectories. In contrast to PCA, the factor analysis model does not only model the residual-variance of independent paths around the mean, but also allows one to include covariates from the experimental design, for example by taking the repetition structure of participants and systematic effects of obstacle height into account. In other words, the proposed factor analysis model is a generalization of PCA suitable for addressing the question at hand while obeying the study design.</p>
<p>The idea is to use the mean movement trajectory, <inline-formula id="pcbi.1005092.e037"><alternatives><graphic id="pcbi.1005092.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>30</mml:mn> <mml:mo>×</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, of one condition, the lowest obstacle height, as a reference. The movement trajectories <bold><italic>y</italic></bold><sub><italic>ijh</italic></sub> (30 time steps and 3 Cartesian coordinates; participant <italic>i</italic>; repetition <italic>j</italic>; and experimental condition with height <italic>h</italic>) are then represented through their deviation from the reference path. We estimate the hypothesized low-dimensional affine subspace in which these deviations lie. That subspace is spanned by the <italic>q</italic> orthonormal (30 × 3)-dimensional columns of the loadings matrix <inline-formula id="pcbi.1005092.e038"><alternatives><graphic id="pcbi.1005092.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>30</mml:mn> <mml:mo>×</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo> <mml:mo>×</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. We assume a mixed-effect structure on the weights for the loadings that takes into account both the categorical effect of obstacle-height and random effects of participant and repetition. This amounts to a statistical model
<disp-formula id="pcbi.1005092.e039"><alternatives><graphic id="pcbi.1005092.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mrow><mml:msub><mml:mo mathvariant="bold-italic">y</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>h</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mi>β</mml:mi> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>3</mml:mn></mml:munderover> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>W</mml:mi> <mml:mi>⊤</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ε</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where <inline-formula id="pcbi.1005092.e040"><alternatives><graphic id="pcbi.1005092.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>×</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> represents the covariate design that indicates obstacle heights: <italic>S</italic>: <italic>X</italic><sub>1</sub> = (0,0); <italic>M</italic>: <italic>X</italic><sub>2</sub> = (1,0); and <italic>T</italic>: <italic>X</italic><sub>3</sub> = (0,1). The parameters, <inline-formula id="pcbi.1005092.e041"><alternatives><graphic id="pcbi.1005092.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mi>β</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>×</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, are the weights for the loadings that account for the systematic deviation of obstacle heights, <italic>M</italic> and <italic>T</italic> from the reference height, <italic>S</italic>. <italic>g</italic><sub><italic>l</italic></sub> is the factor that describes the <italic>l</italic>th level random effects design (participant, participants’ reaction to obstacle-height change, and repetition). <inline-formula id="pcbi.1005092.e042"><alternatives><graphic id="pcbi.1005092.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>×</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are independent latent Gaussian variables with zero-mean and a covariance structure modeled with three <italic>q</italic> × <italic>q</italic> covariance matrices, each describing the covariance between loadings within a level of the random-effect design. <inline-formula id="pcbi.1005092.e043"><alternatives><graphic id="pcbi.1005092.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:msub><mml:mi>ε</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>30</mml:mn> <mml:mo>×</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is zero-mean Gaussian noise with diagonal covariance matrix Λ with one variance parameter per dimension.</p>
<p>The loading matrix <italic>W</italic> is identifiable in a similar way as for usual PCA. Firstly, the scaling of <italic>W</italic> is identified by the assumption that <italic>W</italic><sup>⊤</sup><italic>W</italic> is the <italic>q</italic>-dimensional identity matrix. Secondly, the rotation of <italic>W</italic> is identified by the assumption that the total variance of the latent variables for a single curve
<disp-formula id="pcbi.1005092.e044"><alternatives><graphic id="pcbi.1005092.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005092.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>3</mml:mn></mml:munderover> <mml:mtext>Var</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
is a diagonal matrix. This identifies the loading matrix <italic>W</italic> with probability 1.</p>
<p>The models were fitted using maximum likelihood estimation by using an ECM algorithm [<xref ref-type="bibr" rid="pcbi.1005092.ref052">52</xref>] that had been accelerated using the SQUAREM method [<xref ref-type="bibr" rid="pcbi.1005092.ref053">53</xref>].</p>
<p>
<xref ref-type="fig" rid="pcbi.1005092.g009">Fig 9</xref> shows the percentage of explained variance for various values of <italic>q</italic> across different obstacle distances. For <italic>q</italic> &gt; 8, the average percentage of variance explained by the ninth loading ranges from 1% to 2% and the combined percentage of variance explained by the loadings beyond number eight remains under 3%. From this perspective, <italic>q</italic> = 8 seems like a reasonable choice, with the loadings explaining 97.1% of the variance, meaning that the error term <italic>ε</italic><sub><italic>ij</italic></sub> should account for the remaining 2.9%. In the following, all results are based on the model with <italic>q</italic> = 8.</p>
<fig id="pcbi.1005092.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Percentage of variance explained by individual loadings under different total number of loadings <italic>q</italic> and obstacle distance.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g009" xlink:type="simple"/>
</fig>
<sec id="sec014">
<title>Modeling obstacle height</title>
<p>The fitted mean trajectories for the three different obstacle heights at distance <italic>d</italic> = 30.0 cm can be found in <xref ref-type="fig" rid="pcbi.1005092.g010">Fig 10</xref>. A striking feature of the mean paths is the apparent linear scaling of elevation, but also of the lateral excursion with height. (The difference in the frontal plane, not shown, was very small, but follows a similar pattern). This leads to the hypothesis that the scaling of the mean trajectory with obstacle height can be described by a one-parameter regression model in height increase (<italic>X</italic><sub>1</sub> = 0, <italic>X</italic><sub>2</sub> = 7.5, <italic>X</italic><sub>3</sub> = 15) rather than a more generic two-parameter ANOVA model.</p>
<fig id="pcbi.1005092.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Mean paths for the three obstacle heights (green: small; yellow: middle, orange: tall) at obstacle distance <italic>d</italic> = 30.0 cm.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g010" xlink:type="simple"/>
</fig>
<p>We fitted both models for every obstacle distance and performed likelihood-ratio tests. The p-values can be found in <xref ref-type="table" rid="pcbi.1005092.t002">Table 2</xref>. They were obtained by evaluating twice the difference in log likelihood for the two models using a <italic>χ</italic><sup>2</sup>-distribution at <italic>q</italic> = 8 degrees of freedom. We see that no p-values are significant, so there is no significant loss in the descriptive power of the linear scaling model compared to the ANOVA model. The remaining results in the paper are all based on the model with a regression design.</p>
<table-wrap id="pcbi.1005092.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.t002</object-id>
<label>Table 2</label>
<caption>
<title>p-values for the hypothesis of linearly amplified path changes in obstacle height increase factor.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005092.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" style="border-bottom:thick">Obstacle distance</th>
<th align="center" style="border-bottom:thick">15.0 cm</th>
<th align="center" style="border-bottom:thick">22.5 cm</th>
<th align="center" style="border-bottom:thick">30.0 cm</th>
<th align="center" style="border-bottom:thick">37.5 cm</th>
<th align="center" style="border-bottom:thick">45.0 cm</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">p-value</td>
<td align="char" char=".">0.478</td>
<td align="char" char=".">0.573</td>
<td align="char" char=".">0.093</td>
<td align="char" char=".">0.764</td>
<td align="char" char=".">0.362</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec015">
<title>Discovering the time-structure of variance along movement trajectory</title>
<p>A strength of our approach to time warping is that we can estimate variability more reliably. In addition to observation noise, we model three sources of variation in the observed movement trajectories: individual differences in the trajectory, individual differences caused by changing obstacle height, and variation from repetition to repetition. The variances described from these three sources are independent of obstacle height. In Figs <xref ref-type="fig" rid="pcbi.1005092.g011">11</xref> and <xref ref-type="fig" rid="pcbi.1005092.g012">12</xref>, two spatial representations of the mean movement path for the medium obstacle height are shown. The five distances of the obstacle from the starting position are shown in the five rows of the figures. The three columns show variance originating from individual differences in the trajectory, individual differences caused by changing obstacle height, and variation from repetition to repetition (from left to right). Variance is illustrated at eight equidistant points in time along the mean path by ellipsoids that mark 95% prediction for each level of variation.</p>
<fig id="pcbi.1005092.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Illustration of the experimental setup for the medium height obstacle at all obstacle distances (rows) with the mean trajectory plotted.</title>
<p>Along the trajectory eight equidistant points (in percentual warped time) are marked, and at each point 95% prediction ellipsoids are drawn. The three columns represent the random effects tied to participant, subjective reaction to height change and repetition, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g011" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005092.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Top-view of the experimental setup from the top for the medium height obstacle at all obstacle distances with the mean trajectory plotted.</title>
<p>Along the trajectory eight equidistant points (in percentual warped time) are marked, and at each point 95% prediction ellipsoids are drawn. The ordering is the same as in <xref ref-type="fig" rid="pcbi.1005092.g011">Fig 11</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g012" xlink:type="simple"/>
</fig>
<p>Note the asymmetry of the movements with respect to obstacle position, both in terms of path and variation. This asymmetry reflects the direction of the movement. Generally, variability is higher in the middle of the movement than early and late in the movement. Individual differences caused by change in obstacle height (middle column) are small and lie primarily along the path. That is, individuals adapt the timing of the movement differently as height is varied. Individual differences in the movement path itself (left column) are largely differences in movement parameters: individuals differ in the maximal elevation and in the lateral positioning of their paths, not as much in the time structure of the movements. Variance from trial to trial (right column) is more evenly distributed, but is largest along the path reflecting variation in timing.</p>
<p>These descriptions are corroborated by the comparisons of the amounts of variance explained by the three effects in <xref ref-type="fig" rid="pcbi.1005092.g013">Fig 13</xref>. The obstacle distance of 45, in which the obstacle is close to the target lead to the largest variance in movement trajectory, with most of the increase over other conditions coming from repetition and individual differences caused by change in obstacle height. This suggests that this experimental condition is more difficult than the others, and perhaps much more so for the tall obstacle. Apart from this condition, we see that the largest source of variation is individual differences in movement trajectory. The second largest source of variation is repetition. Individual differences caused by change in obstacle height were are systematically the smallest source of variance.</p>
<fig id="pcbi.1005092.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Amount of variance explained by random effects.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g013" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec016">
<title>Trajectory focal points</title>
<p>A final demonstration of the strength of the method of analysis is illustrated in <xref ref-type="fig" rid="pcbi.1005092.g014">Fig 14</xref>, which shows the mean paths for all obstacle distances and all obstacle heights. For each obstacle height, the paths from different obstacle distances intersect both in the frontal and the vertical plane. These focal points occur approximately at the same distance along the imagined line connecting start and end position. This pattern is clearly visible in the front view of the mean trajectories in <xref ref-type="fig" rid="pcbi.1005092.g014">Fig 14</xref>. Due to the limited variation of the path in the horizontal plane (<xref ref-type="fig" rid="pcbi.1005092.g014">Fig 14</xref> top view), this effect is less clear in the horizontal plane. This pattern may reflect a scaling law, a form of invariance of an underlying path generation mechanism.</p>
<fig id="pcbi.1005092.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005092.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Front and top view of the mean trajectories for the 15 obstacle avoidance setups.</title>
<p>Green lines correspond to low obstacles, yellow to medium obstacles and orange to tall obstacles.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.g014" xlink:type="simple"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>We have proposed a statistical framework for the modeling of human movement data. The hierarchical nonlinear mixed-effects model systematically decomposes movements into a common effect that reflects the variation of movement variables with time during the movement, individual effects, that reflect individual differences, variation from trial to trial, as well as measurement noise. The model amounts to a nonlinear time-warping approach that treats all sources of variances simultaneously.</p>
<p>We have outlined a method for performing maximum likelihood estimation of the model parameters, and demonstrated the approach by analyzing a set of human movement data on the basis of acceleration profiles in arm movements with obstacle avoidance. The quality of the estimates was evaluated in a classification task, in which our model was better able to determine if a sample movement came from a particular participant compared to state-of-the-art template-based curve classification methods. These results indicate that the templates that emerge from our nonlinear warping procedure are both more consistent and richer in detail.</p>
<p>We used the nonlinear time warping obtained from the acceleration profiles to analyze the spatial movement trajectories and their dependence on task conditions, here the dependence on obstacle height and obstacle placement along the path. We discovered that the warped movement path scales linearly with increasing obstacle height. Furthermore, we separated the variation around the mean paths into three levels: individual differences of movement trajectory, individual differences caused by change in obstacle height, and trial to trial variability. This combination of models uncovered clear and coherent patterns in the structure of variance. Individual differences in trajectory and variance from trial to trial were the largest sources of variance, with individual differences being primarily at the level of movement parameters such as elevation and lateral extent of the movement while variance from trial to trial contained a larger amount of timing variance. We documented a remarkable property of the movement paths when obstacle distance along the path is varied at fixed obstacle height: all paths intersect at a single point in space.</p>
<p>We believe that the approach we describe enhances the power of time series analysis as demonstrated in human movement data. The nonlinear time warping procedure makes it possible to obtain reliable estimates of variance along the movement trajectories and is strong in extracting individual differences. This advantage can be leveraged by combining the nonlinear time warping with factor analysis to extract systematic dependencies of movements on task conditions at the same time as tracking individual differences, both base-line and with respect to the dependence on task conditions, as well as variance across repetitions of the movement.</p>
<p>Recent theoretical accounts have used the analysis of variance across repetitions of movements to uncover coordination among the many degrees of freedom of human movement systems [<xref ref-type="bibr" rid="pcbi.1005092.ref017">17</xref>]. Differences in variance between the subspace that keeps hypothesized relevant task variables invariant and the subspace within which such task variables vary support hypotheses about the task-dependent structure of the underlying control systems. Because variance is modulated in time differently across the two subspaces, a more principled decomposition of time dependence and variance from trial to trial would give such analyses new strength. Because this application requires the extension of the proposed method to multivariate time series, it is beyond the scope of this paper. Together with the considerable practical interest in identifying individual differences, these theoretical developments underscore that the method proposed here is timely and worth the methodological investment.</p>
</sec>
<sec id="sec018">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005092.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supporting information contains a primer on model building using the proposed framework, an example analysis with accompanying R code, a simulation study that evaluates the proposed algorithm for maximum likelihood estimation, and the different parameter grids used for cross-validation in the paper.</title>
<p>(TEX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005092.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Twelve acceleration functions corresponding to repetitions of a signature being written.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005092.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>The aligned acceleration functions from <xref ref-type="supplementary-material" rid="pcbi.1005092.s002">S1 Fig</xref> (a), along with the predicted warping functions (b).</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005092.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Densities of the integrated square estimation errors (<italic>L</italic><sup>2</sup> errors) for the common and participant-specific mean functions in the simulation study.</title>
<p>The left panel shows results for ordinary least square (OLS) estimation and the right panel shows the results for the proposed model and estimation algorithm. Both models were fitted using the correctly specified spline model for the mean. Note that the density is displayed on squareroot scale.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005092.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Densities of the difference between the estimated and the true participant-specific warping parameters across participants.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005092.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005092.s006" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Densities of the estimated variance parameters in the simulated experimental setups.</title>
<p>Dashed red lines indicate the true values of the parameters.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005092.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morasso</surname> <given-names>P</given-names></name>. <article-title>Three dimensional arm trajectories</article-title>. <source>Biological Cybernetics</source>. <year>1983</year>;<volume>48</volume>(<issue>3</issue>):<fpage>187</fpage>–<lpage>194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00318086" xlink:type="simple">10.1007/BF00318086</ext-link></comment> <object-id pub-id-type="pmid">6639982</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Soechting</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Terzuolo</surname> <given-names>CA</given-names></name>. <article-title>Organization of arm movements in three-dimensional space. Wrist motion is piecewise planar</article-title>. <source>Neuroscience</source>. <year>1987</year>;<volume>23</volume>(<issue>1</issue>):<fpage>53</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0306-4522(87)90270-3" xlink:type="simple">10.1016/0306-4522(87)90270-3</ext-link></comment> <object-id pub-id-type="pmid">3683869</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morasso</surname> <given-names>P</given-names></name>. <article-title>Spatial control of arm movements</article-title>. <source>Experimental Brain Research</source>. <year>1981</year>;<volume>42</volume>(<issue>2</issue>):<fpage>223</fpage>–<lpage>227</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00236911" xlink:type="simple">10.1007/BF00236911</ext-link></comment> <object-id pub-id-type="pmid">7262217</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lacquaniti</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Terzuolo</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Viviani</surname> <given-names>P</given-names></name>. <article-title>The law relating the kinematic and figural aspects of drawing movements</article-title>. <source>Acta psychologica</source>. <year>1983</year>;<volume>54</volume>(<issue>1</issue>):<fpage>115</fpage>–<lpage>130</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0001-6918(83)90027-6" xlink:type="simple">10.1016/0001-6918(83)90027-6</ext-link></comment> <object-id pub-id-type="pmid">6666647</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Viviani</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>McCollum</surname> <given-names>G</given-names></name>. <article-title>The relation between linear extent and velocity in drawing movements</article-title>. <source>Neuroscience</source>. <year>1983</year>;<volume>10</volume>(<issue>1</issue>):<fpage>211</fpage>–<lpage>218</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0306-4522(83)90094-5" xlink:type="simple">10.1016/0306-4522(83)90094-5</ext-link></comment> <object-id pub-id-type="pmid">6646421</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bennequin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fuchs</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Berthoz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Flash</surname> <given-names>T</given-names></name>. <article-title>Movement timing and invariance arise from several geometries</article-title>. <source>PLoS Computational Biology</source>. <year>2009</year>;<volume>5</volume>(<issue>7</issue>):<fpage>e1000426</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000426" xlink:type="simple">10.1371/journal.pcbi.1000426</ext-link></comment> <object-id pub-id-type="pmid">19593380</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Erlhagen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Schöner</surname> <given-names>G</given-names></name>. <article-title>Dynamic field theory of movement preparation</article-title>. <source>Psychological Review</source>. <year>2002</year>;<volume>109</volume>(<issue>3</issue>):<fpage>545</fpage>–<lpage>572</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/0033-295X.109.3.545" xlink:type="simple">10.1037/0033-295X.109.3.545</ext-link></comment> <object-id pub-id-type="pmid">12088245</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Georgopoulos</surname> <given-names>AP</given-names></name>. <article-title>Current issues in directional motor control</article-title>. <source>Trends in Neurosciences</source>. <year>1995</year>;<volume>18</volume>:<fpage>506</fpage>–<lpage>510</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0166-2236(95)92775-L" xlink:type="simple">10.1016/0166-2236(95)92775-L</ext-link></comment> <object-id pub-id-type="pmid">8592761</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwartz</surname> <given-names>AB</given-names></name>. <article-title>Useful signals from motor cortex</article-title>. <source>The Journal of Physiology</source>. <year>2007</year>;<volume>579</volume>(<issue>3</issue>):<fpage>581</fpage>–<lpage>601</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.2006.126698" xlink:type="simple">10.1113/jphysiol.2006.126698</ext-link></comment> <object-id pub-id-type="pmid">17255162</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harpaz</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Flash</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Dinstein</surname> <given-names>I</given-names></name>. <article-title>Scale-invariant movement encoding in the human motor system</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>81</volume>(<issue>2</issue>):<fpage>452</fpage>–<lpage>462</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2013.10.058" xlink:type="simple">10.1016/j.neuron.2013.10.058</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Rosenbaum</surname> <given-names>DA</given-names></name>. <article-title>Planning for manual positioning: the end-state comfort effect for manual abduction–adduction</article-title>. <source>Experimental Brain Research</source>. <year>2008</year>;<volume>184</volume>(<issue>3</issue>):<fpage>383</fpage>–<lpage>389</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00221-007-1106-x" xlink:type="simple">10.1007/s00221-007-1106-x</ext-link></comment> <object-id pub-id-type="pmid">17763845</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cutting</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Kozlowski</surname> <given-names>LT</given-names></name>. <article-title>Recognizing friends by their walk: Gait perception without familiarity cues</article-title>. <source>Society, Bulleting of the Psychonomic</source>. <year>1977</year>;<volume>9</volume>(<issue>5</issue>):<fpage>353</fpage>–<lpage>356</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3758/BF03337021" xlink:type="simple">10.3758/BF03337021</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pollick</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Kay</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Heim</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Stringer</surname> <given-names>R</given-names></name>. <article-title>Gender recognition from point-light walkers</article-title>. <source>Journal of Experimental Psychology: Human Perception and Performance</source>. <year>2005</year>;<volume>31</volume>(<issue>6</issue>):<fpage>1247</fpage>. <object-id pub-id-type="pmid">16366787</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Moulin</surname> <given-names>P</given-names></name>. <article-title>Human identity and gender recognition from gait sequences with arbitrary walking directions</article-title>. <source>Information Forensics and Security, IEEE Transactions on</source>. <year>2014</year>;<volume>9</volume>(<issue>1</issue>):<fpage>51</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TIFS.2013.2291969" xlink:type="simple">10.1109/TIFS.2013.2291969</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schöner</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kelso</surname> <given-names>JAS</given-names></name>. <article-title>Dynamic pattern generation in behavioral and neural systems</article-title>. <source>Science</source>. <year>1988</year>;<volume>239</volume>:<fpage>1513</fpage>–<lpage>1520</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.3281253" xlink:type="simple">10.1126/science.3281253</ext-link></comment> <object-id pub-id-type="pmid">3281253</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scholz</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Schöner</surname> <given-names>G</given-names></name>. <article-title>The Uncontrolled Manifold Concept: Identifying Control Variables for a Functional Task</article-title>. <source>Experimental Brain Research</source>. <year>1999</year>;<volume>126</volume>:<fpage>289</fpage>–<lpage>306</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s002210050738" xlink:type="simple">10.1007/s002210050738</ext-link></comment> <object-id pub-id-type="pmid">10382616</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Latash</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Scholz</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Schöner</surname> <given-names>G</given-names></name>. <article-title>Toward a new theory of motor synergies</article-title>. <source>Motor Control</source>. <year>2007</year>;<volume>11</volume>:<fpage>276</fpage>–<lpage>308</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1123/mcj.11.3.276" xlink:type="simple">10.1123/mcj.11.3.276</ext-link></comment> <object-id pub-id-type="pmid">17715460</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref018">
<label>18</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ramsay</surname> <given-names>JO</given-names></name>, <name name-style="western"><surname>Silverman</surname> <given-names>BW</given-names></name>. <source>Functional Data Analysis</source>. <edition>2nd ed</edition>. <publisher-name>Springer</publisher-name>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pinheiro</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Bates</surname> <given-names>DM</given-names></name>. <source>Mixed effects models in S and S-PLUS.</source> <publisher-name>Springer</publisher-name>; <year>2000</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lindstrom</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Bates</surname> <given-names>DM</given-names></name>. <article-title>Nonlinear Mixed Effects Models for Repeated Measures Data</article-title>. <source>Biometrics</source>. <year>1990</year>;<volume>46</volume>(<issue>3</issue>):<fpage>673</fpage>–<lpage>687</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2532087" xlink:type="simple">10.2307/2532087</ext-link></comment> <object-id pub-id-type="pmid">2242409</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grimme</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lipinski</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schöner</surname> <given-names>G</given-names></name>. <article-title>Naturalistic arm movements during obstacle avoidance in 3D and the identification of movement primitives</article-title>. <source>Experimental Brain Research</source>. <year>2012</year>;<volume>222</volume>(<issue>3</issue>):<fpage>185</fpage>–<lpage>200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00221-012-3205-6" xlink:type="simple">10.1007/s00221-012-3205-6</ext-link></comment> <object-id pub-id-type="pmid">22996050</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref022">
<label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Raket LL. pavpop version 0.10; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/larslau/pavpop/" xlink:type="simple">https://github.com/larslau/pavpop/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref023">
<label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Grimme B. Analysis and identification of elementary invariants as building blocks of human arm movements. International Graduate School of Biosciences, Ruhr-Universität Bochum; 2014. (In German).</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sakoe</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chiba</surname> <given-names>S</given-names></name>. <article-title>Dynamic programming algorithm optimization for spoken word recognition</article-title>. <source>Acoustics, Speech and Signal Processing, IEEE Transactions on</source>. <year>1978</year>;<volume>26</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>49</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TASSP.1978.1163055" xlink:type="simple">10.1109/TASSP.1978.1163055</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Bruderlin A, Williams L. Motion signal processing. In: Proceedings of the 22nd annual conference on Computer graphics and interactive techniques. ACM; 1995. p. 97–104.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Troje</surname> <given-names>NF</given-names></name>. <article-title>Decomposing biological motion: A framework for analysis and synthesis of human gait patterns</article-title>. <source>Journal of Vision</source>. <year>2002</year>;<volume>2</volume>(<issue>5</issue>):<fpage>371</fpage>–<lpage>387</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1167/2.5.2" xlink:type="simple">10.1167/2.5.2</ext-link></comment> <object-id pub-id-type="pmid">12678652</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref027">
<label>27</label>
<mixed-citation publication-type="other" xlink:type="simple">Berndt DJ, Clifford J. Using Dynamic Time Warping to Find Patterns in Time Series. In: KDD workshop. vol. 10. Seattle, WA; 1994. p. 359–370.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref028">
<label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Gavrila D, Davis L, et al. Towards 3-D model-based tracking and recognition of human movement: a multi-view approach. In: In International Workshop on Automatic Face- and Gesture-Recognition. IEEE Computer Society; 1995. p. 272–277.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Giese</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Poggio</surname> <given-names>T</given-names></name>. <article-title>Morphable models for the analysis and synthesis of complex motion patterns</article-title>. <source>International Journal of Computer Vision</source>. <year>2000</year>;<volume>38</volume>(<issue>1</issue>):<fpage>59</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1008118801668" xlink:type="simple">10.1023/A:1008118801668</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref030">
<label>30</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Niennattrakul</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ratanamahatana</surname> <given-names>CA</given-names></name>. <chapter-title>Inaccuracies of shape averaging method using dynamic time warping for time series data</chapter-title>. In: <source>Computational Science–ICCS 2007</source>. <publisher-name>Springer</publisher-name>; <year>2007</year>. p. <fpage>513</fpage>–<lpage>520</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Petitjean</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ketterlin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gançarski</surname> <given-names>P</given-names></name>. <article-title>A global averaging method for dynamic time warping, with applications to clustering</article-title>. <source>Pattern Recognition</source>. <year>2011</year>;<volume>44</volume>(<issue>3</issue>):<fpage>678</fpage>–<lpage>693</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.patcog.2010.09.013" xlink:type="simple">10.1016/j.patcog.2010.09.013</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rønn</surname> <given-names>BB</given-names></name>. <article-title>Nonparametric maximum likelihood estimation for shifted curves</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2001</year>;<volume>63</volume>(<issue>2</issue>):<fpage>243</fpage>–<lpage>259</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1467-9868.00283" xlink:type="simple">10.1111/1467-9868.00283</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gervini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gasser</surname> <given-names>T</given-names></name>. <article-title>Nonparametric maximum likelihood estimation of the structural mean of a sample of curves</article-title>. <source>Biometrika</source>. <year>2005</year>;<volume>92</volume>(<issue>4</issue>):<fpage>801</fpage>–<lpage>820</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/92.4.801" xlink:type="simple">10.1093/biomet/92.4.801</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rønn</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Skovgaard</surname> <given-names>IM</given-names></name>. <article-title>Nonparametric maximum likelihood estimation of randomly time-transformed curves</article-title>. <source>Brazilian Journal of Probability and Statistics</source>. <year>2009</year>;<volume>23</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/08-BJPS004" xlink:type="simple">10.1214/08-BJPS004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Beath</surname> <given-names>KJ</given-names></name>. <article-title>Infant growth modelling using a shape invariant model with random effects</article-title>. <source>Statistics in medicine</source>. <year>2007</year>;<volume>26</volume>(<issue>12</issue>):<fpage>2547</fpage>–<lpage>2564</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/sim.2718" xlink:type="simple">10.1002/sim.2718</ext-link></comment> <object-id pub-id-type="pmid">17061310</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cole</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Donaldson</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Ben-Shlomo</surname> <given-names>Y</given-names></name>. <article-title>SITAR—a useful instrument for growth curve analysis</article-title>. <source>International Journal of Epidemiology</source>. <year>2010</year>;<volume>39</volume>:<fpage>1558</fpage>–<lpage>1566</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/ije/dyq115" xlink:type="simple">10.1093/ije/dyq115</ext-link></comment> <object-id pub-id-type="pmid">20647267</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raket</surname> <given-names>LL</given-names></name>, <name name-style="western"><surname>Sommer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Markussen</surname> <given-names>B</given-names></name>. <article-title>A nonlinear mixed-effects model for simultaneous smoothing and registration of functional data</article-title>. <source>Pattern Recognition Letters</source>. <year>2014</year>;<volume>38</volume>:<fpage>1</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.patrec.2013.10.018" xlink:type="simple">10.1016/j.patrec.2013.10.018</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref038">
<label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">Ilg W, Bakir G, Franz M, Giese M. Hierarchical spatio-temporal morphable models for representation of complex movements for imitation learning. In: Nunes U., de Almeida A., Bejczy A., Kosuge K., and Machado J., In Proceeding of The 11th International Conference on Advanced Robotics. vol. 2; 2003. p. 453–458.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marron</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Ramsay</surname> <given-names>JO</given-names></name>, <name name-style="western"><surname>Sangalli</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Srivastava</surname> <given-names>A</given-names></name>. <article-title>Functional data analysis of amplitude and phase variation</article-title>. <source>Statistical Science</source>. <year>2015</year>;<volume>30</volume>(<issue>4</issue>):<fpage>468</fpage>–<lpage>484</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/15-STS524" xlink:type="simple">10.1214/15-STS524</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wolfinger</surname> <given-names>R</given-names></name>. <article-title>Laplace’s approximation for nonlinear mixed models</article-title>. <source>Biometrika</source>. <year>1993</year>;<volume>80</volume>(<issue>4</issue>):<fpage>791</fpage>–<lpage>795</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/80.4.791" xlink:type="simple">10.1093/biomet/80.4.791</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>GK</given-names></name>. <article-title>That BLUP is a Good Thing: The Estimation of Random Effects</article-title>. <source>Statistical Science</source>. <year>1991</year>;<volume>6</volume>(<issue>1</issue>):<fpage>15</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/ss/1177011933" xlink:type="simple">10.1214/ss/1177011933</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>de Boor</surname> <given-names>C</given-names></name>. <source>A Practical Guide to Splines</source>. <edition>Revised ed</edition>. <publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>Berlin</publisher-loc>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref043">
<label>43</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Billingsley</surname> <given-names>P</given-names></name>. <source>Convergence of probability measures. vol. 493 of Wiley Series in Probability and Statistics</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>1999</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Flash</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hogan</surname> <given-names>N</given-names></name>. <article-title>The coordination of arm movements: an experimentally confirmed mathematical model</article-title>. <source>The Journal of Neuroscience</source>. <year>1985</year>;<volume>5</volume>(<issue>7</issue>):<fpage>1688</fpage>–<lpage>1703</lpage>. <object-id pub-id-type="pmid">4020415</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref045">
<label>45</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Stein</surname> <given-names>ML</given-names></name>. <source>Interpolation of Spatial Data: Some Theory for Kriging</source>. <publisher-name>Springer</publisher-name>; <year>1999</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arribas-Gil</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Romo</surname> <given-names>J</given-names></name>. <article-title>Robust depth-based estimation in the time warping model</article-title>. <source>Biostatistics</source>. <year>2012</year>;<volume>13</volume>(<issue>3</issue>):<fpage>398</fpage>–<lpage>414</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biostatistics/kxr037" xlink:type="simple">10.1093/biostatistics/kxr037</ext-link></comment> <object-id pub-id-type="pmid">22058080</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dimeglio</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gallón</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Loubes</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Maza</surname> <given-names>E</given-names></name>. <article-title>A robust algorithm for template curve estimation based on manifold embedding</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2014</year>;<volume>70</volume>:<fpage>373</fpage>–<lpage>386</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.csda.2013.09.030" xlink:type="simple">10.1016/j.csda.2013.09.030</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref048">
<label>48</label>
<mixed-citation publication-type="other" xlink:type="simple">Kurtek SA, Srivastava A, Wu W. Signal estimation under random time-warpings and nonlinear signal alignment. In: Advances in Neural Information Processing Systems; 2011. p. 675–683.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref049">
<label>49</label>
<mixed-citation publication-type="other" xlink:type="simple">Tucker JD. fdasrvf: Elastic Functional Data Analysis; 2014. R package version 1.4.2. Available from: <ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=fdasrvf" xlink:type="simple">http://CRAN.R-project.org/package=fdasrvf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref050">
<label>50</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Čencov</surname> <given-names>NN</given-names></name>. <source>Statistical decision rules and optimal inference</source>. <publisher-name>American Mathematical Society</publisher-name>; <year>2000</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005092.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tucker</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Srivastava</surname> <given-names>A</given-names></name>. <article-title>Generative models for functional data using phase and amplitude separation</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2013</year>;<volume>61</volume>:<fpage>50</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.csda.2012.12.001" xlink:type="simple">10.1016/j.csda.2012.12.001</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meng</surname> <given-names>XL</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <article-title>Maximum likelihood estimation via the ECM algorithm: A general framework</article-title>. <source>Biometrika</source>. <year>1993</year>;<volume>80</volume>(<issue>2</issue>):<fpage>267</fpage>–<lpage>278</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/80.2.267" xlink:type="simple">10.1093/biomet/80.2.267</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005092.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Varadhan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Roland</surname> <given-names>C</given-names></name>. <article-title>Simple and globally convergent methods for accelerating the convergence of any EM algorithm</article-title>. <source>Scandinavian Journal of Statistics</source>. <year>2008</year>;<volume>35</volume>(<issue>2</issue>):<fpage>335</fpage>–<lpage>353</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9469.2007.00585.x" xlink:type="simple">10.1111/j.1467-9469.2007.00585.x</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>