<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-01310</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002687</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Metagenomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Ecology</subject>
            <subj-group>
              <subject>Community ecology</subject>
              <subj-group>
                <subject>Community assembly</subject>
                <subject>Species interactions</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Microbial ecology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Inferring Correlation Networks from Genomic Survey Data</article-title><alt-title alt-title-type="running-head">Correlation Networks of Genomic Surveys</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Friedman</surname>
            <given-names>Jonathan</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Alm</surname>
            <given-names>Eric J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1">
        <label>1</label>
        <addr-line>Computational &amp; Systems Biology Initiative, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line>
      </aff><aff id="aff2">
        <label>2</label>
        <addr-line>Departments of Biological Engineering &amp; Civil and Environmental Engineering, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line>
      </aff><aff id="aff3">
        <label>3</label>
        <addr-line>The Broad Institute, Cambridge, Massachusetts, United States of America</addr-line>
      </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>von Mering</surname>
            <given-names>Christian</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">
        <addr-line>University of Zurich and Swiss Institute of Bioinformatics, Switzerland</addr-line>
      </aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">ejalm@mit.edu</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: JF EJA. Performed the experiments: JF. Analyzed the data: JF. Wrote the paper: JF EJA.</p>
        </fn>
      </author-notes><pub-date pub-type="collection">
        <month>9</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>20</day>
        <month>9</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>9</issue><elocation-id>e1002687</elocation-id><history>
        <date date-type="received">
          <day>2</day>
          <month>9</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>23</day>
          <month>7</month>
          <year>2012</year>
        </date>
      </history><permissions>
        
        <copyright-holder>Friedman and Alm</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions><abstract>
        <p>High-throughput sequencing based techniques, such as 16S rRNA gene profiling, have the potential to elucidate the complex inner workings of natural microbial communities - be they from the world's oceans or the human gut. A key step in exploring such data is the identification of dependencies between members of these communities, which is commonly achieved by correlation analysis. However, it has been known since the days of Karl Pearson that the analysis of the type of data generated by such techniques (referred to as compositional data) can produce unreliable results since the observed data take the form of relative fractions of genes or species, rather than their absolute abundances. Using simulated and real data from the Human Microbiome Project, we show that such compositional effects can be widespread and severe: in some real data sets many of the correlations among taxa can be artifactual, and true correlations may even appear with opposite sign. Additionally, we show that community diversity is the key factor that modulates the acuteness of such compositional effects, and develop a new approach, called SparCC (available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/yonatanf/sparcc" xlink:type="simple">https://bitbucket.org/yonatanf/sparcc</ext-link>), which is capable of estimating correlation values from compositional data. To illustrate a potential application of SparCC, we infer a rich ecological network connecting hundreds of interacting species across 18 sites on the human body. Using the SparCC network as a reference, we estimated that the standard approach yields 3 spurious species-species interactions for each true interaction and misses 60% of the true interactions in the human microbiome data, and, as predicted, most of the erroneous links are found in the samples with the lowest diversity.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Genomic survey data, such as those obtained from 16S rRNA gene sequencing, are subject to underappreciated mathematical difficulties that can undermine standard data analysis techniques. We show that these effects can lead to erroneous correlations among taxa within the human microbiome despite the statistical significance of the associations. To overcome these difficulties, we developed SparCC; a novel procedure, tailored to the properties of genomic survey data, that allow inference of correlations between genes or species. We use SparCC to elucidate networks of interaction among microbial species living in or on the human body.</p>
      </abstract><funding-group>
        <funding-statement>This work was conducted by ENIGMA- Ecosystems and Networks Integrated with Genes and Molecular Assemblies (<ext-link ext-link-type="uri" xlink:href="http://enigma.lbl.gov" xlink:type="simple">http://enigma.lbl.gov</ext-link>), a Scientific Focus Area Program at Lawrence Berkeley National Laboratory, was supported by the Office of Science, Office of Biological and Environmental Research, of the U. S. Department of Energy under Contract No. DE-AC02-05CH11231. JF was supported by the Merck-MIT Fellowship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group><counts>
        <page-count count="11"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>The study of natural communities using high throughput genomic surveys, such as 16S rRNA gene profiling, has become routine <xref ref-type="bibr" rid="pcbi.1002687-Medini1">[1]</xref>, yet the development of appropriate, well validated analysis methods is still ongoing. The first challenge is obtaining reliable and informative counts from 16S rRNA gene sequences by filtering spurious reads and grouping the remaining reads in a meaningful way <xref ref-type="bibr" rid="pcbi.1002687-Huse1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-Haas1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-Degnan1">[4]</xref>. Once such counts have been obtained, analysis techniques which are appropriate for discrete survey data need to be applied <xref ref-type="bibr" rid="pcbi.1002687-Bent1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-Kuczynski1">[6]</xref> <xref ref-type="bibr" rid="pcbi.1002687-Lovell1">[7]</xref>.</p>
      <p>A common goal of genomic surveys is to identify correlations between taxa within ecological communities. Correlation analysis provides a well trodden path to achieving this goal, but we show that it is not valid when applied to genomic survey data (GSD), and may produce misleading results. The challanges associated with GSD stem from the fact that they are a relative, rather than absolute, measure of abundances of community components. The counts comprising these data (e.g., 16S rRNA gene reads) are set by the amount of genetic material extracted from the community or the sequencing depth, and analysis typically begins by normalizing the observed counts by the total number of counts. The resulting fractions fall into a class of data termed closed or compositional, and poses its particular geometrical and statistical properties <xref ref-type="bibr" rid="pcbi.1002687-Jackson1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-Lovell1">[7]</xref>. Specifically, standard methods for computing correlations from GSD are theoretically invalid. Correlation estimates are biased by the fact that, since they must sum to 1, fractions are not independent and tend to have a negative correlation regardless of the true correlation between the underlying absolute abundances (termed the basis abundances) <xref ref-type="bibr" rid="pcbi.1002687-Buccianti1">[9]</xref>. Thus, correlations estimates often reflect the compositional nature of the data, and are not indicative of the underlying biological processes <xref ref-type="bibr" rid="pcbi.1002687-Aitchison1">[10]</xref>. In fact, in 1897 Karl Pearson warned against “attempts to interpret correlations between ratios whose numerators and denominators contain common parts” <xref ref-type="bibr" rid="pcbi.1002687-Pearson1">[11]</xref>, and since that time it has been shown that many other standard analysis techniques are invalid when applied to such compositional data, and that their interpretation is unreliable and often misleading <xref ref-type="bibr" rid="pcbi.1002687-Aitchison1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-Aitchison2">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-PawlowskyGlahn1">[13]</xref>. Nonetheless, these methods remain the primary tools used in studies of microbial ecology.</p>
      <p>Although approaches to compositional data analysis have been developed (e.g. <xref ref-type="bibr" rid="pcbi.1002687-PawlowskyGlahn1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-Aitchison3">[14]</xref>), the basic task of inferring dependencies between components remains an outstanding challenge. A widely used method is Aitchison's test for complete subcompositional independence <xref ref-type="bibr" rid="pcbi.1002687-Aitchison4">[15]</xref>, which tests whether any dependencies are present, but does not indicate which components are correlated, nor the magnitude of the correlation. Filzmoser and Hron <xref ref-type="bibr" rid="pcbi.1002687-Filzmoser1">[16]</xref> recently developed a method for inferring correlations in compositional data after an appropriate mathematical transformation, but their method does not provide a mapping relating the correlations of the transformed variables to those of the underlying genes or species.</p>
      <p>In this paper, we first use simulations and real-world data from the Human Microbiome Project (HMP) to demonstrate that GSD can be severely biased by “compositional” effects, and then identify the factors the modulate their severity. Finally, we present a novel method, called SparCC, and show that it can infer correlations with high accuracy even in the most challenging data sets.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Standard correlation inference techniques perform poorly on GSD</title>
        <p>To what extent do compositional artifacts affect real-world GSD? We applied standard statistical methods to 16S rRNA gene survey data from the Human Microbiome Project (HMP) <xref ref-type="bibr" rid="pcbi.1002687-The1">[17]</xref>, which measure the compositions of microbial communities found in different body sites of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e001" xlink:type="simple"/></inline-formula> individuals. The composition of each community is described in terms of operational taxonomic units (OTUs). Because only relative abundances for each OTU are available, these data qualify as compositional and are thus subject to potential biases as described above.</p>
        <p>Networks inferred from Standard Pearson correlation display distinct patterns within different body sites, suggestive of biological structure (<xref ref-type="fig" rid="pcbi-1002687-g001">Fig. 1</xref>, left column. See <xref ref-type="supplementary-material" rid="pcbi.1002687.s002">Fig. S1</xref> for all 18 HMP body sites). Specifically, a prominent feature of the mid-vagina, retroauricular crease, and buccal mucosa networks is the presence of an OTU that is negatively correlated with multiple other OTUs. Despite the temptation to attribute biological significance to these observations, correlation networks inferred from randomly shuffled data with similar taxon abundances, but lacking any correlations between OTUs (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), reproduce this feature (<xref ref-type="fig" rid="pcbi-1002687-g001">Fig. 1</xref>, middle column) indicating that it may arise from the closure (normalization) process.</p>
        <fig id="pcbi-1002687-g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002687.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Similar correlation networks are observed for real world vs. randomly shuffled bacterial abundance data.</title>
            <p>Correlation networks based on 16S rRNA gene survey data collected as part of the Human Microbiome Project (HMP), inferred using Pearson correlations (left column), and SparCC (right column). Additionally, Pearson correlation networks were inferred from shuffled HMP data (middle column), where all OTUs are independent. The Pearson networks inferred from shuffled data show patterns similar to the ones seen in the Pearson networks of the real data, especially for low diversity body sites. This indicates that the observed Pearson network structure may be due to biases inherent in compositional data rather than a real biological signal. In contrast, no significant correlation were inferred from the shuffled data using SparCC (data not shown). Nodes represent OTUs, with size reflecting the OTU's average fraction in the community. Edges between nodes represent correlations between the nodes they connect, with edge width and shade indicating the correlation magnitude, and green and red colors indicating positive and negative correlations, respectively. For clarity, only edges corresponding to correlations whose magnitude is greater than 0.3 are drawn. See <xref ref-type="supplementary-material" rid="pcbi.1002687.s002">Fig. S1</xref> for all 18 HMP body sites.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.g001" xlink:type="simple"/>
        </fig>
        <p>The mechanism behind these spurious correlations is straightforward. The pattern observed in the mid-vagina network results from the dominance of OTU 3, a <italic>Lactobacillus</italic>. This OTU has a median abundance of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e002" xlink:type="simple"/></inline-formula>, so fluctuations in its relative abundance have a strong effect on the abundance of the rest of the community simply due to the requirement that the relative abundances of all OTUs sum to 100%: when the abundance of <italic>Lactobacillus</italic> varies, all other OTUs' relative abundances vary in unison in the opposite direction creating artificial negative correlations with <italic>Lactobacillus</italic>, and artificial positive correlations with each other.</p>
      </sec>
      <sec id="s2b">
        <title>Diversity and correlation density control the severity of compositional effects</title>
        <p>Compositional effects are severe in some datasets, but mild in others. We found that diversity of the samples in the dataset (often referred to as alpha diversity), is a good predictor of the strength of compositional effects, which diminish with increased diversity. Intuitively, the fewer OTUs comprise the community, the worse the compositional effects are, with the extreme case of a community composed of only two OTUs, which will always appear to be perfectly negatively correlated. Moreover, compositional effects can be significant even in communities comprised of multiple OTUs, if only a few OTUs dominate the community. This notion of diversity can be quantified using the Shannon effective number of OTUs,(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e003" xlink:type="simple"/></inline-formula>) <xref ref-type="bibr" rid="pcbi.1002687-Jost1">[18]</xref>, which quantifies both the number of OTUs and the dominance in a community. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e004" xlink:type="simple"/></inline-formula> ranges from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e005" xlink:type="simple"/></inline-formula>, when the community is completely dominated by a single OTU, to the number of OTUs in the community (richness), when all OTUs are equally abundant.</p>
        <p>Simulated networks of varying <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e006" xlink:type="simple"/></inline-formula> (see Material and Methods) with known correlations illustrate the effect of diversity on compositional artifacts. True correlations (<xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2A–C</xref>) are only recovered when the community is diverse (<xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2F</xref>). In networks of similar diversity to the HMP samples, inferred connections are often dominated by negative correlations to the dominant OTU, which leads to positive correlations among the remaining OTUs (<xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2D,E</xref>). This effect is so strong that it eliminates the negative correlation between OTU 4 and OTUs 3 and 5, and positive correlation between OTUs 1 and 2 (<xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2E</xref>). Worse yet, as diversity decreases further, the negative correlation between OTU 4 and OTUs 3 and 5 is turned into an apparently positive one (<xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2D</xref>). It is important to note that these compositional effects are not limited to Pearson correlation, and are also present in non-parametric correlations, such as Spearman correlations (<xref ref-type="supplementary-material" rid="pcbi.1002687.s003">Fig. S2</xref>).</p>
        <fig id="pcbi-1002687-g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002687.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Pearson correlations inference quality deteriorates with decreasing diversity.</title>
            <p>Basis data was simulated with a known correlation structure. OTU counts were generated by randomly drawing from the basis, and were subsequently subject to both correlation inference procedures. (A–C) True basis correlation network. (D–F) Networks inferred using standard procedure. (G–I) Networks inferred using SparCC. The average community diversities, as given by the Shannon entropy effective number of components <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e007" xlink:type="simple"/></inline-formula>, used in the simulations and observed in the HMP data are indicated on left indicates. As in <xref ref-type="fig" rid="pcbi-1002687-g001">Fig. 1</xref>, nodes represent OTUs, with size reflecting the OTU's average fraction in the community. Nodes represent OTUs, with size reflecting the OTU's average fraction in the community. Edges between nodes represent correlations between the nodes they connect, with edge width and shade indicating the correlation magnitude, and green and red colors indicating positive and negative correlations, respectively. For clarity, only edges corresponding to correlations whose magnitude is greater than 0.3 are drawn.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.g002" xlink:type="simple"/>
        </fig>
        <p>If the underlying network has true positive correlations, then compositional effects can be even more pronounced than expected based on the community diversity. This happens because strong correlations between components lowers the effective diversity of the sample (i.e., two OTUs that are perfectly correlated behave as a single OTU). This effect can confound naive efforts to correct for compositional effects by comparing observed correlations against shuffled networks. When the data are shuffled, as in the middle column of <xref ref-type="fig" rid="pcbi-1002687-g001">Fig. 1</xref>, few spurious connections may arise relative to the structure observed for the unshuffled data (as observed for the buccal mucosa samples), creating false confidence in the observed network. Thus, randomization is not sufficent to establish significance of observed correlations, nor is it possible to identify correlations by comparing against (or “subtracting out”) a randomized network.</p>
      </sec>
      <sec id="s2c">
        <title>SparCC: a novel procedure for inferring correlations from GSD</title>
        <p>Here, we describe a new technique for inferring correlations from compositional data called SparCC (Sparse Correlations for Compositional data). SparCC estimates the linear Pearson correlations between the log-transformed components. Since these correlations cannot be computed exactly (as described below), SparCC utilizes an approximation which is based on the assumptions that: (i) the number of different components (e.g., OTUs or genes) is large, and (ii) the true correlation network is ‘sparse’ (i.e., most components are not strongly correlated with each other). Later, we show that SparCC is surprisingly robust to violations of the sparsity assumption. SparCC does not rely on any particular distribution of the basis variables, i.e. the true abundances in the community can follow any distribution, and the choice of the log-normal distribution in subsequent examples is motivated solely by ease of implementation and empirical fit. For clarity, we present the method in the context of 16S rRNA gene data, where the components are OTUs and the basis variables are their true abundances in a community, but SparCC can be applied to any compositional data for which its approximation is valid.</p>
        <p>Like most compositional data analysis techniques, SparCC is based on the log-ratio transformation:<disp-formula id="pcbi.1002687.e008"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e008" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e009" xlink:type="simple"/></inline-formula> is the fraction of OTU <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e010" xlink:type="simple"/></inline-formula>. This transformation carries several advantages: First, the new variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e011" xlink:type="simple"/></inline-formula> contain information regarding the true abundances of OTUs, as the ratio of fractions is equal to the ratio of the true abundances. Second, unlike the fractions themselves, the ratio of the fractions of two OTUs is independent of which other OTUs are included in the analysis, a property termed subcompositional coherence. Third, this transformation is mathematically convenient, as the new variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e012" xlink:type="simple"/></inline-formula> are no longer limited to the simplex, but are free to assume any real value. Taking the logarithm removed the positivity constraint, and induces (anti) symmetry in the treatment of the variables.</p>
        <p>To describe the dependencies in a compositional dataset, Aitchison suggested using the quantity<disp-formula id="pcbi.1002687.e013"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e013" xlink:type="simple"/><label>(2)</label></disp-formula>where the variance is taken across all samples <xref ref-type="bibr" rid="pcbi.1002687-Aitchison2">[12]</xref>. When OTUs are perfectly correlated, their ratio is constant, therefore <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e014" xlink:type="simple"/></inline-formula>, whereas the ratio of uncorrelated OTUs varies and the corresponding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e015" xlink:type="simple"/></inline-formula> is large. Though <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e016" xlink:type="simple"/></inline-formula> contains information regarding the dependence between the OTUs, it is hard to interpret as it lacks a scale. That is, it is unclear what constitutes a large or small value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e017" xlink:type="simple"/></inline-formula> (does a value of 0.1 indicate strong dependence, weak dependence, or no dependence?). This can be further appreciated by relating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e018" xlink:type="simple"/></inline-formula> to our quantity of interest, the correlation between the true abundances of the OTUs. The relation is given by<disp-formula id="pcbi.1002687.e019"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e019" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e020" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e021" xlink:type="simple"/></inline-formula> are the variances of the log-transformed basis abundances of OTUs <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e022" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e023" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e024" xlink:type="simple"/></inline-formula> is the correlation between them. It is now evident that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e025" xlink:type="simple"/></inline-formula> can only be interpreted in relation to the basis abundance's variances: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e026" xlink:type="simple"/></inline-formula> indicates a positive correlation, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e027" xlink:type="simple"/></inline-formula> indicates a negative correlation. Ideally, we would like to solve the set of <xref ref-type="disp-formula" rid="pcbi.1002687.e019">eqs. 3</xref> for all OTU pairs and simultaneously infer both the basis variances and correlations. However, because there are more unknown variables than equations, this is not generally possible. Nonetheless, it is possible to obtain a good approximation of the variances if, on average, OTUs are uncorrelated. Once we obtain estimates of the basis variances, these can be plugged into <xref ref-type="disp-formula" rid="pcbi.1002687.e019">eqs. 3</xref> to infer the correlations between each OTU pair, which, unlike the average correlations, needn't be small.</p>
        <p>More accurate estimation can be achieved by iterating the above procedure. At each iteration the strongest correlated OTU pair identified in the previous iteration is excluded from the basis variance estimation. This reinforces sparsity among the remaining pairs and yields better variance and correlation estimates.</p>
        <p>OTU fractions need to be estimated from the observed counts to apply SparCC. Normalizing each OTU by the total counts in the sample (the maximum-likelihood estimate) is unreliable for rare OTU because it overestimates the number of zero fractions <xref ref-type="bibr" rid="pcbi.1002687-Agresti1">[19]</xref>. This can give rise to artifacts that are driven by variations in the sequencing depth. These artifacts have motivated some authors to downsample their data such that all samples have the same total counts, however downsampling does nothing to alleviate compositional effects, and requires discarding a substantial portion of the available data. Therefore, we employed a Bayesian approach to estimate component fractions (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), which allows the assessment of the robustness of downstream analysis and the assignment of confidence values.</p>
      </sec>
      <sec id="s2d">
        <title>SparCC is highly accurate on simulated data</title>
        <p>We used the previously described simulated datasets to demonstrate the accuracy of SparCC at inferring correlations, even in highly problematic compositional data dominated by a single OTU (<xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2G–I</xref>). A more systematic evaluation of SparCC was performed by creating multiple simulated datasets of varying diversity and density. We measure density as the average Pearson correlation between OTUs, such that denser datasets have more strongly correlated OTUs, challenging the sparsity assumption used by SparCC. For each combination of density and diversity, multiple true correlation networks were assigned, and corresponding data was sampled. Networks inferred by SparCC or standard correlations were evaluated using the root-mean-square error (RMSE) (<xref ref-type="fig" rid="pcbi-1002687-g003">Fig. 3</xref>). Standard techniques only gave reasonable estimates for very diverse, sparse networks (Pearson RMSE <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e028" xlink:type="simple"/></inline-formula>), whereas for networks with diversity comparable to those observed in the HMP set, the Pearson RMSE was unacceptably high, reaching <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e029" xlink:type="simple"/></inline-formula> for communities with diversity similar to the mid-vagina. Spearman correlations performed only marginally better (<xref ref-type="supplementary-material" rid="pcbi.1002687.s004">Fig. S3A</xref>). By contrast, the performance of SparCC was independent of diversity, and gave improved results for all parameter values, even for dense networks in which the sparsity assumption is violated. In fact, the worst accuracy achieved by SparCC (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e030" xlink:type="simple"/></inline-formula>, for unrealistically dense networks), was comparable to the best accuracy achieved using standard correlations on highly diverse samples. Moreover, though stronger correlation can be estimated more reliably, using standard methods, attention needs to be restricted to exceptionally strong correlations before the accuracy improves significantly, and the resulting accuracy is at best comparable to SparCC's accuracy (<xref ref-type="supplementary-material" rid="pcbi.1002687.s006">Fig. S5</xref>).</p>
        <fig id="pcbi-1002687-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002687.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>SparCC outperforms standard inference.</title>
            <p>Root-mean-square error (RMSE) of both Pearson (A) and SparCC (B) inferred correlations, as a function of the density of the underlying correlation network, as given by the probability that any pair of components be strongly correlated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e031" xlink:type="simple"/></inline-formula>, and community diversity, as given by the Shannon entropy effective number of components <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e032" xlink:type="simple"/></inline-formula>. SparCC errors are smaller than Pearson errors for all parameter values. For the maximal diversity plotted, 50 effective OTU, the inference error obtained using Pearson correlations is greatly decreased. Therefore, it is likely that Pearson correlations perform well on gene expression data, where the effective number of genes is typically in the hundreds or thousands. For each combination of density and diversity, multiple basis correlation networks were randomly generated, and corresponding data was sampled and used for correlation estimation. Dots labeled mid-vagina and gut indicate the average diversity observed in the mid-vagina and gut communities, and the density of their estimated correlation networks. Dots labeled 2D–I indicate the diversity and density used to generate the communities analyzed in <xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2</xref>.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.g003" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2e">
        <title>SparCC identifies phylogenetically structured correlations in HMP data</title>
        <p>We used SparCC to infer the taxon-taxon interaction networks from the HMP data sets (<xref ref-type="fig" rid="pcbi-1002687-g001">Fig. 1</xref>, right column, <xref ref-type="fig" rid="pcbi-1002687-g004">Fig. 4</xref>), and from their corresponding shuffled datasets (in which all OTUs are uncorrelated). In contrast to the naive approach shown in <xref ref-type="fig" rid="pcbi-1002687-g001">Fig. 1</xref>, SparCC found no significant correlations in the shuffled dataset (<xref ref-type="supplementary-material" rid="pcbi.1002687.s001">Dataset S1</xref>). For the real data, however, numerous correlations are found, which differed significantly from the standard Pearson correlations. SparCC inference indicated that on average <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e033" xlink:type="simple"/></inline-formula> of the correlated OTU pairs identified using Pearson were false, and that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e034" xlink:type="simple"/></inline-formula> of the correlated OTU pairs were missed using Pearson (see <xref ref-type="supplementary-material" rid="pcbi.1002687.s008">Table S1</xref> for breakdown by body site.). Of particular note, we observe a positive correlation between OTU 3 and OTU 148, both belonging to the <italic>Lactobacillus</italic> genus, which was absent from the Pearson network, likely because of the bias of the highly abundant OTU 3 toward making negative correlations. Intriguingly, using SparCC we observe a higher likelihood of positive correlations between phylogenetically related taxa (<xref ref-type="supplementary-material" rid="pcbi.1002687.s009">Table S2</xref>), a finding that on its surface seems to support a role for neutral community dynamics as related organisms are likely to inhabit similar niches, but do not seem to dominate by competitive exclusion (although more complicated scenarios are certainly possible). We anticipate that techniques such as SparCC will play a major role in analyzing these data to address this and other basic ecological questions.</p>
        <fig id="pcbi-1002687-g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002687.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>HMP correlation networks inferred using SparCC.</title>
            <p>Networks inferred using SparCC from the same data as in <xref ref-type="fig" rid="pcbi-1002687-g001">Fig. 1</xref> (see <xref ref-type="supplementary-material" rid="pcbi.1002687.s003">Fig. S2</xref> for SparCC networks of all HMP body sites). No correlations with magnitude greater than the 0.3 cutoff were inferred from the shuffled data (not shown). Nodes represent OTUs, with size reflecting the OTU's average fraction in the community, and color corresponding to the phylum to which the OTU belongs. Edges between nodes represent correlations between the nodes they connect, with edge width and shade indicating the correlation magnitude, and green and red colors indicating positive and negative correlations, respectively. For clarity, only edges corresponding to correlations whose magnitude is greater than 0.3 are drawn, and unconnected nodes are omitted. See <xref ref-type="supplementary-material" rid="pcbi.1002687.s007">Fig. S6</xref> for all 18 HMP body sites.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.g004" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>In this study we have focused on an outstanding challenge of compositional data analysis – inference of correlations. We have demonstrated that compositional effects are pronounced in 16S rRNA gene surveys of the human microbiome, and, motivated by the properties of this data, have developed a novel procedure for estimating correlations.</p>
      <p>We found that diversity of species and density of interactions are the two key factors that influence the severity of compositional effects on correlation estimates, with low diversity, high density data being the most challenging to infer correlation from using standard methods. SparCC does not rely on high diversity, rather it only requires sparsity of correlations, but in practice is robust even when the sparsity assumption is strongly violated (%30 of all component pairs are strongly correlated). Therefore, we recommend that SparCC be used on any GSD that has low diversity: as a rule of thumb we recommend an effective number of components of at least 50 for standard techniques (with the potential caveat that if strong positive correlations are present among many OTUs, the effective diversity may be much lower than estimated). We emphasize that simply having many components is not sufficient to avoid compositional effects. For example, 16S rRNA gene surveys from the HMP include hundreds to thousands of distinct OTUs, yet have have a relatively low effective number of species, with a small number of species dominating most samples.</p>
      <p>An important subclass of GSD are genome-wide surveys conducted using techniques such as DNA microarrays, RNA-seq and ChIP-seq. These genome-wide data are also subject to compositional effects, however, as these data tend to have high diversity, they are likely to be much less severe or negligible. For example, the average effective number of genes in microarray experiments available through the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e035" xlink:type="simple"/></inline-formula> database <xref ref-type="bibr" rid="pcbi.1002687-Faith1">[20]</xref> was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e036" xlink:type="simple"/></inline-formula> for <italic>S. cerevisiae</italic> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e037" xlink:type="simple"/></inline-formula> for <italic>E. coli</italic>. This may explain why to date comparatively less attention has been paid to compositional effects in the biological sciences than in other disciplines.</p>
      <p>The preponderance of zero values are another area of concern with GSD. These zeros can represent either components that are truly absent from the community, or rare components that, by chance, were not present in the sample drawn from the community. Without additional knowledge, these options are indistinguishable, and, depending on goal of the analysis, the researcher must decide how to interpret them, and choose analysis methods accordingly. We emphasize that the treatment of zero values is a challenge that is in no way unique to compositional data, but is merely highlighted by the log-ratio transformations employed to analyze these data <xref ref-type="bibr" rid="pcbi.1002687-MartnFernndez1">[21]</xref>. In this study, we eliminate zero fractions by adding small pseudocounts, as detailed in the <xref ref-type="sec" rid="s4">Materials and Methods</xref>. Complementary approaches, where zeros are treated differently than non-zero values, are substantially more challenging, and are the subject of ongoing research <xref ref-type="bibr" rid="pcbi.1002687-Aitchison5">[22]</xref>.</p>
      <p>Though the method presented in this paper allows detection of correlation within communities, many challenges still remain. First, SparCC relies on having reliable component counts, which as noted in the introduction, is not trivial. Second, the correlations estimated by SparCC measure the linear relationship between log transformed abundances. Compositional methods for inferring more general dependencies between components, equivalent to rank correlations and mutual information for non-compositional data, have not yet been developed. Third, relating the patterns detected within a community to external factors (e.g. relating the composition of a human gut microbial community to human health status), and detecting temporal patterns within and between communities requires non-standard, compositional approaches. While some such methods exist <xref ref-type="bibr" rid="pcbi.1002687-PawlowskyGlahn1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-Aitchison2">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002687-BarceloVidal1">[23]</xref> they are rarely employed in the context of GSD, and are not tailored for its particular properties. Finally, GSD is often associated with phylogenetic information (relatedness of species or genes), which ideally would be included in the analysis (e.g. the weighted UniFrac distance, which attempts to capture differences in both abundance and phylogenetic composition of communities.). We believe that developing systematic, statistically-sound methods for such analyses of compositional GSD is a necessary step on the road to understanding the structure of biological communities, the processes by which they evolve, and the forces that shape them, and thus represents an important direction for future research.</p>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>HMP 16S rRNA gene data</title>
        <p>HMP OTU counts and their taxonomic classification were obtained from the HMPOC dataset, build 1.0, available at <ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/" xlink:type="simple">http://hmpdacc.org/</ext-link> <xref ref-type="bibr" rid="pcbi.1002687-Schloss1">[24]</xref>. The dataset corresponding to high-quality reads from the v3–5 region was used. Only samples from the May <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e038" xlink:type="simple"/></inline-formula> production study were included in the analysis. Additionally, if multiple samples were obtained from the same body site of an individual, only the first sample collected was included in the analysis. For each body site, the data was further filtered by removing samples for which less than 500 reads were collected and OTUs that were, on average, represented by less than 2 reads per sample.</p>
      </sec>
      <sec id="s4b">
        <title>Shuffled HMP datasets</title>
        <p>Shuffled datasets are created by assigning each OTU in each sample a number of counts that is randomly sampled from the OTU's observed counts across all samples, with replacement. This procedure ensures that the resulting marginal distributions of counts of each OTU alone are the same as in the real data, and that there are no correlations between the OTUs in the simulated data.</p>
      </sec>
      <sec id="s4c">
        <title>Simulated basis datasets for basis correlations estimation</title>
        <p>Simulated communities were generated by sampling the joint abundances of 50 OTUs from a log-normal distribution with a given mean and covariance matrix. The mean abundances were equal for all OTUs except OTU 1, whose abundance was set such that the community will have a given effective number of OTUs (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e039" xlink:type="simple"/></inline-formula>), on average. The variance was set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e040" xlink:type="simple"/></inline-formula> for all OTUs, and random covariance matrices were generated by assigning each OTU pair a probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e041" xlink:type="simple"/></inline-formula> of being perfectly correlated, with positive or negative correlations being equally probable. The resulting random symmetric matrix was then converted to the nearest positive-definite matrix to ensure it is a valid covariance matrix. 500 individuals were randomly sampled from each of these communities to give counts data similar to the one contained in GSD.</p>
        <p>For each combination of the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e042" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e043" xlink:type="simple"/></inline-formula>, 50 such random communities were simulated, and the correlation inference accuracy was quantified using the root-mean-squared error averaged over all OTU pairs, given by:<disp-formula id="pcbi.1002687.e044"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e044" xlink:type="simple"/><label>(4)</label></disp-formula>The final inference error is given by averaging the inference error of all 50 runs.</p>
      </sec>
      <sec id="s4d">
        <title>Effective number of species</title>
        <p>The entropy effective number of species of a community, is defined as<disp-formula id="pcbi.1002687.e045"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e045" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e046" xlink:type="simple"/></inline-formula> is the entropy of the community <xref ref-type="bibr" rid="pcbi.1002687-Jost1">[18]</xref>. Sample entropies were computed according to the method descried by Chao and Shen <xref ref-type="bibr" rid="pcbi.1002687-Chao1">[25]</xref>, as implemented in the R ‘entropy’ package <xref ref-type="bibr" rid="pcbi.1002687-Hausser1">[26]</xref>. For each body-site, the effective number of species reported in the main text is the average of the effective number of species of all samples corresponding to that body-site.</p>
      </sec>
      <sec id="s4e">
        <title>Estimation of component fractions</title>
        <p>We adopt a bayesian framework for estimating the true fractions from the observed counts. Assuming unbiased sampling in the sequencing procedure, and a uniform prior, the posterior joint fractions distribution is the Dirichlet distribution <xref ref-type="bibr" rid="pcbi.1002687-Gelman1">[27]</xref>:<disp-formula id="pcbi.1002687.e047"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e047" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e048" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e049" xlink:type="simple"/></inline-formula> are vectors of the components' true fractions and observed counts, respectively. Unlike Maximum-Likelihood estimation, the bayesian approach results in the full joint distribution of fractions, rather than their point estimates.</p>
        <p>Point estimates of fraction values, if desired, can be given by the the mean of the posterior distribution:<disp-formula id="pcbi.1002687.e050"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e050" xlink:type="simple"/><label>(7)</label></disp-formula>which is equivalent to adding a pseudocount of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e051" xlink:type="simple"/></inline-formula> to all count values, and normalize by the total number of counts in each sample. However, we prefer setting the estimator of true fractions to be a random sample from this posterior distribution. This randomness avoids the detection of spurious correlations between rare components, which arrises since the fractions resulting from adding a fixed value pseudocount mirror the sampling depth. Additionally, repeating downstream analysis using many such randomly drawn estimators allows the quantification of the effects of sampling noise on the analysis (one can attempt to model the noise analytically, but this often challenging in practice).</p>
        <p>It is important to note that in SparCC, like in any method employing log transformations, some pre-processing is required to eliminate zero values. As described above, SparCC employes a variation of the well-known pseudocounts method which assigns a small fraction to OTUs that were not detected in a sample. This approach implicitly assumes that all components are in fact present in the sample, and that all zero value result from finite detection resolution <xref ref-type="bibr" rid="pcbi.1002687-Agresti1">[19]</xref>. For very rare OTUs who are only present at a few samples, this may not be a reasonable assumption. Even if this assumption holds, typically there is not enough information to reliably estimate correlations involving such components, and such components should not be included in the correlation analysis.</p>
      </sec>
      <sec id="s4f">
        <title>Basic SparCC</title>
        <p>As noted in the main text, the quantity<disp-formula id="pcbi.1002687.e052"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e052" xlink:type="simple"/><label>(8)</label></disp-formula>contains information about the dependence between components <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e053" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e054" xlink:type="simple"/></inline-formula>, and can be related to the basis correlations. The relation is obtained<disp-formula id="pcbi.1002687.e055"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e055" xlink:type="simple"/><label>(9)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e056" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e057" xlink:type="simple"/></inline-formula> are the variances of the log-transformed basis variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e058" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e059" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e060" xlink:type="simple"/></inline-formula> is the correlation between them <xref ref-type="bibr" rid="pcbi.1002687-Aitchison1">[10]</xref>. Our aim is to exploit relation 9 to infer the unobserved covariance matrix of the log transformed basis variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e061" xlink:type="simple"/></inline-formula>, from Aitchison's variation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e062" xlink:type="simple"/></inline-formula>, whose elements are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e063" xlink:type="simple"/></inline-formula>. Unfortunately, this is impossible for the most general case, since the basis variances are unknown a priori, and the system of equations for all pairs of components is underdetermined, as it involves <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e064" xlink:type="simple"/></inline-formula> equations and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e065" xlink:type="simple"/></inline-formula> variables (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e066" xlink:type="simple"/></inline-formula> variances and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e067" xlink:type="simple"/></inline-formula> correlations). In fact, even the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e068" xlink:type="simple"/></inline-formula> variance variables alone, with all correlations set to zero, allow solving <xref ref-type="disp-formula" rid="pcbi.1002687.e055">eq. 9</xref> for up to three components. Therefore, at least four components are required to detect deviations from complete independence between all components (this is related to the fact that Aitchison's test for complete subcompositional independence is only effective when at least four components are analyzed <xref ref-type="bibr" rid="pcbi.1002687-Woronow1">[28]</xref>).</p>
        <p>Since an exact solution cannot be found, we SparCC utilizes an approximation, which is valid when there are many components which are only sparsely correlated. <xref ref-type="disp-formula" rid="pcbi.1002687.e055">Eq. 9</xref> can be rearranged to give the following expression for the correlation:<disp-formula id="pcbi.1002687.e069"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e069" xlink:type="simple"/><label>(10)</label></disp-formula>which, given the basis variances can be solved to give the basis correlations. Therefore, we employ the following approximation procedure to estimate the basis variances: First, define the variation of component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e070" xlink:type="simple"/></inline-formula> as<disp-formula id="pcbi.1002687.e071"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e071" xlink:type="simple"/><label>(11)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e072" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e073" xlink:type="simple"/></inline-formula> represents averaging over all pairs involving component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e074" xlink:type="simple"/></inline-formula>. Next, assume that the correlation terms in <xref ref-type="disp-formula" rid="pcbi.1002687.e071">eq. 11</xref> are small, i.e.<disp-formula id="pcbi.1002687.e075"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e075" xlink:type="simple"/><label>(12)</label></disp-formula>and neglect them, yielding the approximate set of equations:<disp-formula id="pcbi.1002687.e076"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e076" xlink:type="simple"/><label>(13)</label></disp-formula>Finally, solve <xref ref-type="disp-formula" rid="pcbi.1002687.e076">eq. 13</xref> to obtain the approximated basis variances to be plugged into <xref ref-type="disp-formula" rid="pcbi.1002687.e069">eq. 10</xref>, yielding values of the basis correlations.</p>
        <p>To elucidate the nature of this approximation, consider the case where all the basis variables have the same variance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e077" xlink:type="simple"/></inline-formula>. The assumption made in <xref ref-type="disp-formula" rid="pcbi.1002687.e075">eq. 12</xref> simplifies to:<disp-formula id="pcbi.1002687.e078"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e078" xlink:type="simple"/><label>(14)</label></disp-formula>i.e., we assume that the average correlations are small, rather than requiring that any particular correlation be small.</p>
        <p>Using the above approximation, the basic inference procedure is the following:</p>
        <list list-type="order">
          <list-item>
            <p>Estimate the component fractions in all the samples as outlined above, to obtain the fractions matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e079" xlink:type="simple"/></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>Compute the variation matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e080" xlink:type="simple"/></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>Compute the component variations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e081" xlink:type="simple"/></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>Solve <xref ref-type="disp-formula" rid="pcbi.1002687.e076">eqs. 13</xref> to get an approximate value for all basis variances <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e082" xlink:type="simple"/></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>Plug the estimated log-basis variances into <xref ref-type="disp-formula" rid="pcbi.1002687.e055">eqs. 9</xref> to obtain the basis correlations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e083" xlink:type="simple"/></inline-formula>.</p>
          </list-item>
        </list>
      </sec>
      <sec id="s4g">
        <title>Iterative SparCC</title>
        <p>The basic inference procedure can be improved upon by employing the following iterative refinement scheme (<xref ref-type="fig" rid="pcbi-1002687-g005">Fig. 5</xref>):</p>
        <list list-type="order">
          <list-item>
            <p>Estimate correlations using the basic procedure described above.</p>
          </list-item>
          <list-item>
            <p>Identify the most strongly correlated pair of components that was not previously excluded. If the magnitude of this strongest correlation exceeds a given threshold, add this pair to the set of excluded pairs. Otherwise, terminate the estimation procedure.</p>
          </list-item>
          <list-item>
            <p>Identify components that form only excluded pairs and completely exclude them from the analysis. Since the assumptions of our method are not met by such components, it is unable to infer their correlations. If all components but three are excluded, terminate the estimation procedure, as the sparsity assumption is violated for the whole system.</p>
          </list-item>
          <list-item>
            <p>If any components were excluded, re-estimate the fractions of the remaining components. Note that the new fractions are relative to the new subset of components.</p>
          </list-item>
          <list-item>
            <p>Calculate the component variations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e084" xlink:type="simple"/></inline-formula>, excluding all strongly correlated pairs. That is, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e085" xlink:type="simple"/></inline-formula> is the set of indices of components identified to be strongly correlated with component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e086" xlink:type="simple"/></inline-formula> at the previous, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e087" xlink:type="simple"/></inline-formula>, iteration, then<disp-formula id="pcbi.1002687.e088"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e088" xlink:type="simple"/><label>(15)</label></disp-formula></p>
          </list-item>
          <list-item>
            <p>Use the newly computed component variations to compute the basis correlations, as in steps 4 and 5 of the basic inference procedure.</p>
          </list-item>
          <list-item>
            <p>Repeat steps 2 through 6 for a given number of iterations, or until no new strongly correlated pairs are identified.</p>
          </list-item>
        </list>
        <fig id="pcbi-1002687-g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002687.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Flow chart of iterative basis correlation inference procedure.</title>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.g005" xlink:type="simple"/>
        </fig>
        <p>Note that the iterative procedure can result in correlations whose magnitude is greater than 1, indicating that too many pairs were excluded. Setting a higher exclusion threshold, or a lower iteration number will remedy this fallacy, though the resulting approximation is likely to be of poor accuracy.</p>
        <p>Basis correlation can also be inferred using transformed variables (see <xref ref-type="supplementary-material" rid="pcbi.1002687.s010">Text S1</xref>). However, the iterative exclusion detailed above improves the quality of the approximation, making SparCC superior to these alternatives (<xref ref-type="supplementary-material" rid="pcbi.1002687.s002">Fig. S1</xref>)</p>
        <p>To account for the sampling noise, the inference procedure is repeated multiple times, each time with fraction values drawn randomly from their posterior distribution, generating a distribution of each pairwise correlation. The median value of each pairwise correlation distribution is taken as its estimated value. In this work, a threshold of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e089" xlink:type="simple"/></inline-formula> and a maximal number of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e090" xlink:type="simple"/></inline-formula> iterations were chosen, and the iterative procedure was repeated 100 times.</p>
      </sec>
      <sec id="s4h">
        <title>Comparison of HMP networks inferred using Pearson and SparCC</title>
        <p>For each body site, pairwise correlations between all OTUs were inferred using both Pearson and SparCC as described above. Interaction networks were subsequently build by connecting all OTU pairs that had a correlation magnitude greater than a given threshold. <xref ref-type="sec" rid="s2">Results</xref> reported in the main text were obtained using a threshold value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002687.e091" xlink:type="simple"/></inline-formula>. Comparison between corresponding Pearson and SparCC networks was done by treating the SparCC network as the true one, and computing the number of true-positives (TP), false-positives (FP), true-negatives (TN) and false-negatives (FN) detected in the Pearson network. The above quantities were calculated as following:<disp-formula id="pcbi.1002687.e092"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e092" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1002687.e093"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e093" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1002687.e094"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e094" xlink:type="simple"/></disp-formula><disp-formula id="pcbi.1002687.e095"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002687.e095" xlink:type="simple"/></disp-formula></p>
      </sec>
      <sec id="s4i">
        <title>Assessing statistical significance</title>
        <p>The statistical significance of the inferred correlations can be assessed using a bootstrap procedure. First, a large number of simulated datasets, where all components are uncorrelated, are generated as described in Material and Methods. Next, correlations are inferred from each simulated dataset using SparCC with the same parameter setting as is used for the original data. Finally, for each component pair, pseudo p-values are assigned to be proportion of simulated data sets for which a correlation value at least as extreme as the one computed for the original data was obtained.</p>
      </sec>
      <sec id="s4j">
        <title>Computer implementation</title>
        <p>All analysis and procedures were implemented in Python, utilizing the Numpy <xref ref-type="bibr" rid="pcbi.1002687-Oliphant1">[29]</xref> and Networkx <xref ref-type="bibr" rid="pcbi.1002687-Hagberg1">[30]</xref> modules. Plotting was done using the Matplotlib <xref ref-type="bibr" rid="pcbi.1002687-Hunter1">[31]</xref> module.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002687.s001" mimetype="application/zip" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s001" xlink:type="simple">
        <label>Dataset S1</label>
        <caption>
          <p>Correlation values for all HMP body sites inferred using both Pearson and SparCC from real and shuffled data.</p>
          <p>(ZIP)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s002" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s002" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>Similar correlation networks are observed for real world vs. randomly shuffled bacterial abundance data.</bold> Correlation networks based on 16S survey data collected as part of the Human Microbiome Project (HMP), inferred using Pearson correlations (left column), and SparCC (right column). Additionally, Pearson correlation networks were inferred from shuffled HMP data (middle column), where all OTUs are independent. This figures is extends <xref ref-type="fig" rid="pcbi-1002687-g001">Fig. 1</xref> to include all 18 HMP body sites.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s003" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s003" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>Spearman correlations inference quality deteriorates with decreasing diversity.</bold> Like Pearson correlations, Spearman correlations are also affected by the compositionally of the data and yield correlation networks that are only marginally more accurate than Pearson correlation networks (compare <xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2</xref>). Data simulation procedure and parameter values are identical to those used in <xref ref-type="fig" rid="pcbi-1002687-g002">Fig. 2</xref>.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s004" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s004" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Root-mean-square error (RMSE) of both Spearman CLR inferred correlations.</bold> The accuracy of Spearman correlations (A) is comparable to that of Pearson correlations. CLR correlations (B) are more accurate than both Pearson and Spearman correlation, but not as accurate as SparCC correlations (compare <xref ref-type="fig" rid="pcbi-1002687-g003">Fig. 3</xref>). Note that the Spearman correlations estimated from the fractions were compared to the true basis Spearman correlations, rather than Pearson correlations. Data simulation procedure and parameter values are identical to those used in <xref ref-type="fig" rid="pcbi-1002687-g003">Fig. 3</xref>.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s005" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s005" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p><bold>CLR correlations are strongly biased when a small number of components is analyzed.</bold> RMSE of SparCC (A) and CLR (B) correlations for datasets composed of 5 components. Data is simulated as described in <xref ref-type="sec" rid="s4">Materials and Methods</xref> section of main text.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s006" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s006" xlink:type="simple">
        <label>Figure S5</label>
        <caption>
          <p><bold>SparCC is more accurate than alternative correlations even when considering only the strongest detected correlations.</bold> RMSE of SparCC, Pearson and Spearman correlations whose inferred magnitude exceeds a given threshold. Data is simulated as described in <xref ref-type="sec" rid="s4">Materials and Methods</xref> section of main text. Note that the Spearman correlations estimated from the fractions were compared to the true basis Spearman correlations, rather than Pearson correlations.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s007" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s007" xlink:type="simple">
        <label>Figure S6</label>
        <caption>
          <p><bold>HMP correlation networks inferred using SparCC.</bold> Networks inferred using SparCC from the same data as in Fig. 6. This figures is extends <xref ref-type="fig" rid="pcbi-1002687-g004">Fig. 4</xref> to include all 18 HMP body sites.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s008" mimetype="application/msword" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s008" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p>Accuracy of HMP Pearson networks compared to SparCC networks.</p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s009" mimetype="application/msword" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s009" xlink:type="simple">
        <label>Table S2</label>
        <caption>
          <p>Correlation between OTUs decreases with phylogenetic distance.</p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002687.s010" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002687.s010" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>Correlation inference using transformed variables.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors thank Lawrence David, Chris Smillie, Otto Cordero, Olivier Devauchelle, and Dr. Alex Petroff for many helpful discussions.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002687-Medini1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Medini</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Serruto</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Parkhill</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Relman</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Donati</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Microbiology in the post-genomic era</article-title>. <source>Nat Rev Microbiol</source> <volume>6</volume>: <fpage>419</fpage>–<lpage>430</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Huse1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huse</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Welch</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Morrison</surname><given-names>HG</given-names></name>, <name name-style="western"><surname>Sogin</surname><given-names>ML</given-names></name> (<year>2010</year>) <article-title>Ironing out the wrinkles in the rare biosphere through improved otu clustering</article-title>. <source>Environ Microbiol</source> <volume>12</volume>: <fpage>1889</fpage>–<lpage>1898</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Haas1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haas</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Gevers</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Earl</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Feldgarden</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ward</surname><given-names>DV</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Chimeric 16s rrna sequence formation and detection in sanger and 454-pyrosequenced pcr amplicons</article-title>. <source>Gen Res</source> <volume>21</volume>: <fpage>494</fpage>–<lpage>504</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Degnan1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Degnan</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ochman</surname><given-names>H</given-names></name> (<year>2011</year>) <article-title>Illumina-based analysis of microbial community diversity</article-title>. <source>ISME J</source> <volume>6</volume>: <fpage>183</fpage>–<lpage>194</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Bent1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bent</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Forney</surname><given-names>LJ</given-names></name> (<year>2008</year>) <article-title>The tragedy of the uncommon: understanding limitations in the analysis of microbial diversity</article-title>. <source>ISME J</source> <volume>2</volume>: <fpage>689</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Kuczynski1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuczynski</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Lozupone</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Mcdonald</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Fierer</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Microbial community resemblance methods differ in their ability to detect biologically relevant patterns</article-title>. <source>Nat Meth</source> <volume>7</volume>: <fpage>813</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Lovell1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lovell</surname><given-names>D</given-names></name>, <name name-style="western"><surname>uller</surname><given-names>WM</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Zwart</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Helliwell</surname><given-names>C</given-names></name> (<year>2010</year>) <article-title>Caution! compositions! can constraints on omics data lead analyses astray?</article-title> <source>CSIRO</source> <fpage>1</fpage>–<lpage>44</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Jackson1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jackson</surname><given-names>D</given-names></name> (<year>1997</year>) <article-title>Compositional data in community ecology: the paradigm or peril of proportions?</article-title> <source>Ecology</source> <volume>78</volume>: <fpage>929</fpage>–<lpage>940</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Buccianti1">
        <label>9</label>
        <mixed-citation publication-type="other" xlink:type="simple">Buccianti A, Mateu-Figueras G, Pawlowsky-Glahn V, editors (2006) Compositional data analysis in the geosciences : from theory to practice. Number 24 in Special Publication. London, UK: Geological Society. 224 pp.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Aitchison1">
        <label>10</label>
        <mixed-citation publication-type="other" xlink:type="simple">Aitchison J (2003) The statistical analysis of compositional data. Caldwell, New JerseyUSA: Blackburn Press, 416 pp.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Pearson1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pearson</surname><given-names>K</given-names></name> (<year>1897</year>) <article-title>On a form of spurious correlation which may arise when indices are used in the measurement of organs</article-title>. <source>Proceedings of the Royal Society of London</source> <volume>60</volume>: <fpage>489</fpage>–<lpage>502</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Aitchison2">
        <label>12</label>
        <mixed-citation publication-type="other" xlink:type="simple">Aitchison J (2003) A concise guide to compositional data analysis. In: 2nd Compositional Data Analysis Workshop; Girona, Italy. Available: <ext-link ext-link-type="uri" xlink:href="http://ima.udg.edu/Activitats/CoDaWork05/A" xlink:type="simple">http://ima.udg.edu/Activitats/CoDaWork05/A</ext-link> concise guide to compositional data analysis.pdf. Accessed 8 August 2012.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-PawlowskyGlahn1">
        <label>13</label>
        <mixed-citation publication-type="other" xlink:type="simple">Pawlowsky-Glahn V, Buccianti A, editors (2011) Compositional data analysis : theory and applications. Chichester, West SussexUK: Wiley. 400 pp.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Aitchison3">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aitchison</surname><given-names>J</given-names></name> (<year>1992</year>) <article-title>On criteria for measures of compositional difference</article-title>. <source>Math Geol</source> <volume>24</volume>: <fpage>365</fpage>–<lpage>379</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Aitchison4">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aitchison</surname><given-names>J</given-names></name> (<year>1981</year>) <article-title>A new approach to null correlations of proportions</article-title>. <source>Math Geol</source> <volume>13</volume>: <fpage>175</fpage>–<lpage>189</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Filzmoser1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Filzmoser</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Hron</surname><given-names>K</given-names></name> (<year>2009</year>) <article-title>Correlation analysis for compositional data</article-title>. <source>Mathematical Geosciences</source> <volume>41</volume>: <fpage>905</fpage>–<lpage>919</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-The1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">The Human Microbiome Project Consortium</collab> (<year>2012</year>) <article-title>A framework for human microbiome research</article-title>. <source>Nature</source> <volume>486</volume>: <fpage>215</fpage>–<lpage>221</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Jost1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jost</surname><given-names>L</given-names></name> (<year>2006</year>) <article-title>Entropy and diversity</article-title>. <source>Oikos</source> <volume>113</volume>: <fpage>363</fpage>–<lpage>375</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Agresti1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Agresti</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hitchcock</surname><given-names>DB</given-names></name> (<year>2005</year>) <article-title>Bayesian inference for categorical data analysis</article-title>. <source>Stat Methods Appt</source> <volume>14</volume>: <fpage>297</fpage>–<lpage>330</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Faith1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Faith</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Driscoll</surname><given-names>ME</given-names></name>, <name name-style="western"><surname>Fusaro</surname><given-names>VA</given-names></name>, <name name-style="western"><surname>Cosgrove</surname><given-names>EJ</given-names></name>, <name name-style="western"><surname>Hayete</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Many microbe microarrays database: Uniformly normalized affymetrix compendia with structured experimental metadata</article-title>. <source>Nucleic Acids Res</source> <volume>36</volume>: <fpage>D866</fpage>–<lpage>D870</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-MartnFernndez1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martín-Fernández</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Barceló-Vidal</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name> (<year>2003</year>) <article-title>Dealing with zeros and missing values in compositional data sets using nonparametric imputation</article-title>. <source>Math Geol</source> <volume>35</volume>: <fpage>253</fpage>–<lpage>278</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Aitchison5">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aitchison</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Egozcue</surname><given-names>JJ</given-names></name> (<year>2005</year>) <article-title>Compositional data analysis: Where are we and where should we be heading?</article-title> <source>Math Geol</source> <volume>37</volume>: <fpage>829</fpage>–<lpage>850</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-BarceloVidal1">
        <label>23</label>
        <mixed-citation publication-type="other" xlink:type="simple">Barcelo-Vidal C, Aguilar L, Martin-Fernandez JA (2011) Compositional VARIMA time series. In: Pawlowsky-Glahn V, Buccianti A, editors. Compositional Data Analysis. Chichester, West SussexUK: Wiley. pp. 87–103.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Schloss1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schloss</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Gevers</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Westcott</surname><given-names>SL</given-names></name> (<year>2011</year>) <article-title>Reducing the effects of PCR amplification and sequencing artifacts on 16S rRNA-Based studies</article-title>. <source>PLoS ONE</source> <volume>6</volume>: <fpage>e27310</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Chao1">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chao</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Shen</surname><given-names>T</given-names></name> (<year>2003</year>) <article-title>Nonparametric estimation of shannon's index of diversity when there are unseen species in sample</article-title>. <source>Environ Ecol Stat</source> <volume>10</volume>: <fpage>429</fpage>–<lpage>443</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Hausser1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hausser</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Strimmer</surname><given-names>K</given-names></name> (<year>2009</year>) <article-title>Entropy inference and the james-stein estimator, with application to nonlinear gene association networks</article-title>. <source>J Mach Learn Res</source> <volume>10</volume>: <fpage>1469</fpage>–<lpage>1484</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Gelman1">
        <label>27</label>
        <mixed-citation publication-type="other" xlink:type="simple">Gelman A, Carlin J, Stern H, Rubin D (2003) Bayesian data analysis. London, UK: Chapman and Hall/CRC press. 696 pp.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Woronow1">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Woronow</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Butler</surname><given-names>J</given-names></name> (<year>1986</year>) <article-title>Complete subcompositional independence testing of closed arrays</article-title>. <source>Comput Geosci</source> <volume>12</volume>: <fpage>267</fpage>–<lpage>279</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Oliphant1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oliphant</surname><given-names>T</given-names></name> (<year>2007</year>) <article-title>Python for scientific computing</article-title>. <source>Comput Sci Eng</source> <volume>9</volume>: <fpage>10</fpage>–<lpage>20</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Hagberg1">
        <label>30</label>
        <mixed-citation publication-type="other" xlink:type="simple">Hagberg AA, Schult DA, Swart PJ (2008) Exploring network structure, dynamics, and function using networkx. In: Varoquaux G, Vaught T, Millman J, editors. Proceedings of the 7th Python in Science Conference; 19–24 August, 2008; Pasadena, California, United States. pp. 11–15.</mixed-citation>
      </ref>
      <ref id="pcbi.1002687-Hunter1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hunter</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Matplotlib: A 2d graphics environment</article-title>. <source>Comput Sci Eng</source> <volume>9</volume>: <fpage>90</fpage>–<lpage>95</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>