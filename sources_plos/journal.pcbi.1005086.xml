<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01705</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005086</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject><subj-group><subject>Hidden Markov models</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Immune receptors</subject><subj-group><subject>B cell receptors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Immune receptors</subject><subj-group><subject>B cell receptors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Immune receptors</subject><subj-group><subject>B cell receptors</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Immune receptors</subject><subj-group><subject>B cell receptors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Mutation</subject><subj-group><subject>Insertion mutation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Likelihood-Based Inference of B Cell Clonal Families</article-title>
<alt-title alt-title-type="running-head">Likelihood-Based Inference of B Cell Clonal Families</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ralph</surname> <given-names>Duncan K.</given-names></name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id>
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A.</given-names> <suffix>IV</suffix></name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Fred Hutchinson Cancer Research Center, Seattle, Washington, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Peters</surname> <given-names>Bjoern</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>La Jolla Institute for Allergy and Immunology, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item><p><bold>Conceived and designed the experiments:</bold> DKR FAM.</p></list-item> <list-item><p><bold>Performed the experiments:</bold> DKR.</p></list-item> <list-item><p><bold>Analyzed the data:</bold> DKR FAM.</p></list-item> <list-item><p><bold>Contributed reagents/materials/analysis tools:</bold> DKR.</p></list-item> <list-item><p><bold>Wrote the paper:</bold> DKR FAM.</p></list-item></list></p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">matsen@fredhutch.org</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>17</day>
<month>10</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>10</issue>
<elocation-id>e1005086</elocation-id>
<history>
<date date-type="received">
<day>8</day>
<month>10</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>7</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Ralph, Matsen</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005086"/>
<abstract>
<p>The human immune system depends on a highly diverse collection of antibody-making B cells. B cell receptor sequence diversity is generated by a random recombination process called “rearrangement” forming progenitor B cells, then a Darwinian process of lineage diversification and selection called “affinity maturation.” The resulting receptors can be sequenced in high throughput for research and diagnostics. Such a collection of sequences contains a mixture of various lineages, each of which may be quite numerous, or may consist of only a single member. As a step to understanding the process and result of this diversification, one may wish to reconstruct lineage membership, i.e. to cluster sampled sequences according to which came from the same rearrangement events. We call this clustering problem “clonal family inference.” In this paper we describe and validate a likelihood-based framework for clonal family inference based on a multi-hidden Markov Model (multi-HMM) framework for B cell receptor sequences. We describe an agglomerative algorithm to find a maximum likelihood clustering, two approximate algorithms with various trade-offs of speed versus accuracy, and a third, fast algorithm for finding specific lineages. We show that under simulation these algorithms greatly improve upon existing clonal family inference methods, and that they also give significantly different clusters than previous methods when applied to two real data sets.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Antibodies must recognize a great diversity of antigens to protect us from infectious disease. The binding properties of antibodies are determined by the DNA sequences of their corresponding B cell receptors (BCRs). These BCR sequences are created in naive form by VDJ recombination, which randomly selects and trims the ends of V, D, and J genes, then joins the resulting segments together with additional random nucleotides. If they pass initial screening and bind an antigen, these sequences then undergo an evolutionary process of reproduction, mutation, and selection, revising the BCR to improve binding to its cognate antigen. It has recently become possible to determine the BCR sequences resulting from this process in high throughput. Although these sequences implicitly contain a wealth of information about both antigen exposure and the process by which we learn to resist pathogens, this information can only be extracted using computer algorithms. In this paper we describe a likelihood-based statistical method to determine, given a collection of BCR sequences, which of them are derived from the same recombination events. It is based on a hidden Markov model (HMM) of VDJ rearrangement which is able to calculate likelihoods for many sequences at once.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>GM113246</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0607-6025</contrib-id>
<name name-style="western">
<surname>Matsen</surname> <given-names>Frederick A.</given-names> <suffix>IV</suffix></name>
</principal-award-recipient>
</award-group>
<funding-statement>Both authors were supported by National Institutes of Health R01 GM113246 (PI Matsen), R01 AI103981, and U19 AI117891. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="13"/>
<table-count count="1"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The "Adaptive" data set is available at <ext-link ext-link-type="uri" xlink:href="http://adaptivebiotech.com/link/mat2015" xlink:type="simple">http://adaptivebiotech.com/link/mat2015</ext-link>. The "Vollmers" data set is available at <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs000656.v1.p1" xlink:type="simple">http://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs000656.v1.p1</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>B cells effect the antibody-mediated component of the adaptive immune system. The antigen-binding properties of B cells are defined by their B cell receptor, or BCR. BCRs bind a wide variety of antigens, and this flexibility arises from their developmental pathway. B cells begin life as hematopoietic stem cells. After a number of differentiation steps the cells perform somatic recombination, or rearrangement. For the heavy chain locus, a V gene, D gene, and J gene are randomly selected, trimmed some random amount by an exonuclease, and then joined together with random nucleotides (forming so-called N-regions). The light chain process is slightly simpler, in that only a V and J recombine, but proceeds via similar trimming and joining processes. These processes form the third complementarity determining region (CDR3) in each of the heavy and the light chain, which are important determinants of antibody binding properties. Then a series of checkpoints on the BCRs ensure that the resulting immunoglobulin is functional and not self-reactive through negative selection (reviewed in [<xref ref-type="bibr" rid="pcbi.1005086.ref001">1</xref>]). This process results in naive B cells with fully functioning receptors. When stimulated by binding to antigen in a germinal center, naive cells reproduce and mutate by via the process of somatic hypermutation, and then are selected on the basis of antigen binding and presentation to T follicular helper cells [<xref ref-type="bibr" rid="pcbi.1005086.ref002">2</xref>]. This process is called <italic>affinity maturation</italic>. It is now possible to sequence B cell receptors in high throughput, which in principle describes not only the collections of antigens to which the immune system is ready to react, but also implicitly narrates how they came to be.</p>
<p>It is of great practical interest for researchers to be able to reconstruct events of this development process using BCR sequence data. Such reconstruction would shed light on the process of B cell receptor maturation, a subject of continual study since the landmark work of Eisen and Siskind in 1964 [<xref ref-type="bibr" rid="pcbi.1005086.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref004">4</xref>]. Furthermore, there are specific maturation pathways of great importance, such as the B cell lineages leading to broadly neutralizing antibodies to HIV [<xref ref-type="bibr" rid="pcbi.1005086.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref006">6</xref>]. Being able to reconstruct the structure and history of these lineages allows investigation of the binding properties of these intermediates, which could be helpful to design effective vaccination strategies to elicit high-affinity antibodies [<xref ref-type="bibr" rid="pcbi.1005086.ref007">7</xref>]. For example, recent studies have shown the promise of a sequential immunization program for eliciting these antibodies [<xref ref-type="bibr" rid="pcbi.1005086.ref008">8</xref>]; lineage reconstruction will aid in identifying desirable intermediate BCRs.</p>
<p>The <italic>clonal family inference problem</italic> is an intermediate step to such lineage reconstruction (<xref ref-type="fig" rid="pcbi.1005086.g001">Fig 1</xref>). Rather than trying to reconstruct the full lineage history of the set of sequences, the goal is only to reconstruct which sequences came from the same rearrangement event. Full lineage reconstruction would also require building phylogenetic trees for each of the clonal families. However, these clonal families can be an object of interest themselves [<xref ref-type="bibr" rid="pcbi.1005086.ref009">9</xref>].</p>
<fig id="pcbi.1005086.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The clonal family inference problem.</title>
<p>The B cell receptor generation process begins by VDJ recombination, which makes a naive B cell. When stimulated by antigen, those naive cells diversify through the mutation and selection processes of <italic>affinity maturation</italic>, creating many lineages of B cells shown here as phylogenetic trees with the naive cells at the root of the tree. The ensemble of B cells descending from a single rearrangement event is called a <italic>clonal family</italic>. In this paper we develop methods to reconstruct clonal families from B cell receptor sequences.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g001" xlink:type="simple"/>
</fig>
<p>The motivation behind our approach to the clonal family inference problem, like many before us, is to use the special structure of BCR sequences (which for simplicity we describe for the heavy chain; the same concepts and approaches can be applied to the light chain). This structure follows from VDJ recombination and affinity maturation: for example, by definition the identity of the germline genes cannot change through affinity maturation. Thus, if the per-read germline gene identity could be inferred without error, then any pair of sequences from a clonal family must have the same inferred germline gene identity. If one also assumes that sequences evolve only through point mutation, then sequences must have identical-length CDR3s if they are to be in the same clonal family.</p>
<p>Most current methods for B cell clonal family inference make these assumptions, and proceed by first stratifying sequences by inferred V and J germline genes and CDR3 length, then only consider pairs of sequences within a stratum as potential members of the same clonal family. If one assumes further that any clonal families with pairs of highly diverged sequences also contain intermediates between those sequences, one might assume that there is a path between any pair of sequences such that neighboring sequences in a path are similar. This suggests a strategy in which pairs of sequences that are similar at some level (such as 90% similar in terms of nucleotides) in the CDR3 are considered to be in the same clonal family, and where membership is transitive, which corresponds to an application of single-linkage clustering.</p>
<p>Instead of designing such an algorithm that works only when a set of rigid, predefined assumptions are satisfied, an alternative is to formalize a model of B cell affinity maturation into a generative probabilistic process with a corresponding likelihood function. Once this likelihood function is defined, one can infer clonal families by finding the clustering that maximizes the likelihood of generating the observed sequences.</p>
<p>Likelihood methods in the form of a hidden Markov models (HMM) have been applied to B cell receptor sequences for a decade [<xref ref-type="bibr" rid="pcbi.1005086.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1005086.ref013">13</xref>]. This previous work has been to use HMMs to analyze individual sequences. For likelihood-based clustering we are only aware of the work of Laserson [<xref ref-type="bibr" rid="pcbi.1005086.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref015">15</xref>], who uses Markov chain Monte Carlo to infer clusters via a Dirichlet mixture model (reviewed in [<xref ref-type="bibr" rid="pcbi.1005086.ref016">16</xref>]). Unfortunately the Laserson algorithm is only described in a PhD thesis and does not appear to be publicly available. In related work, Kepler [<xref ref-type="bibr" rid="pcbi.1005086.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref018">18</xref>] uses a likelihood-based phylogenetics framework to perform joint reconstruction of annotated ancestor sequence and a phylogenetic tree.</p>
<p>In this paper we present a method for inferring clonal families in an HMM-based framework that comfortably scales to tens of thousands of sequences via parallel algorithms, with approximations that scale to hundreds of thousands of sequences. For situations in which specific lineages are of interest, users can specify “seed” sequences and find the clonal family containing that seed in repertoires with one million sequences. Our clustering algorithm is based on a “multi-HMM” framework for BCR sequences that we have previously applied to the <italic>annotation problem</italic>: to infer the origin of each nucleotide in a BCR (or TCR) sequence from the VDJ rearrangement process [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>]. We use this framework to define a likelihood ratio comparing two models which differ by the collapse of two clonal families into one, and use it for agglomerative clustering. Because this likelihood ratio comes from an application of the forward algorithm for HMMs, it integrates out all possible VDJ annotations. We find that it outperforms previous algorithms on simulated data, and that it makes a significant difference when applied to real data.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Likelihood framework</title>
<p>In order to calculate a set of probabilities suitable for use in the clonal family inference problem, we begin with the HMM framework introduced in [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>]. In that paper we focused on inferring parameters of an HMM and using it to obtain BCR annotated ancestor sequences, which was primarily based on the most likely path through each HMM, i.e. the Viterbi path. We also described Viterbi annotation with a multi-HMM, i.e. annotation using a collection of sequences that were assumed to form a clonal family.</p>
<p>In this application, we will use the forward algorithm for HMMs [<xref ref-type="bibr" rid="pcbi.1005086.ref020">20</xref>] to obtain the corresponding marginal probability, which is the sum of sequence generation probabilities over all possible paths through the HMM. This is a more appropriate tool for the clonal family inference problem because here we are interested in integrating over annotated ancestor sequences (that is, paths through the HMM) to decide whether sequences are related. By using a multi-HMM, we can use this total probability to calculate a likelihood ratio that two clusters derive from the same, or from different, rearrangement events. We perform agglomerative clustering using this likelihood ratio to group sequences for which the probability of a common ancestry is higher than that of separate ancestry (details in the <xref ref-type="sec" rid="sec012">Methods</xref>). This approach allows us to calculate the total probability of the partition (i.e. clustering) at each stage in the clustering process, which provides both an objective measure of partition quality, and easy access to not only the most likely partition but also to a range of likely partitions of varying degrees of refinement. As in our previous work, the parameters of the HMM can be inferred “on the fly” given a sufficiently large data set or be inferred on some other data set. Briefly, we do a cycle of Viterbi training, which is started with an application of Smith-Waterman alignment, in which the best annotation for each sequence with a current parameter set is used to infer parameters for the next cycle. As described in detail elsewhere [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>], data is aggregated if there are insufficient observations for a given allele for training.</p>
</sec>
<sec id="sec004">
<title>Approximate methods</title>
<p>In addition to this principled method for full-repertoire reconstruction, we have implemented two more approximate versions which trade some accuracy for substantial increases in speed. In the first, which we call <italic>point <monospace>partis</monospace></italic>, we forgo integration over all possible annotated ancestor sequences and instead find the most likely naive sequence point estimate for each cluster. Clusters are then compared based on the Hamming fraction (Hamming distance divided by sequence length) between their respective naive sequences, and are merged if the distance is smaller than some threshold. This threshold is set dynamically based on the observed mutation rate in the sample at hand.</p>
<p>In order to achieve further improvements in speed, we can also avoid both complete all-versus-all comparison of the sequences at each step, and calculation of the joint naive sequence for each merged cluster. For this we find the most likely naive sequence for each individual sequence, and then pass the results, together with a dynamically-set clustering threshold, to the clustering functionality of the <monospace>vsearch</monospace> program [<xref ref-type="bibr" rid="pcbi.1005086.ref021">21</xref>]. We call this <italic><monospace>vsearch partis</monospace></italic>.</p>
</sec>
<sec id="sec005">
<title>Reconstruction of selected lineages</title>
<p>We have also included a method which, using the full likelihood, reconstructs the clonal family containing a given “seed” sequence. Because clonal families are generally significantly smaller than the total repertoire, this option is much faster than the full-repertoire reconstruction methods. We see this option as being useful when specific sequences are identified as interesting through a binding assay or because they are shared between repertoire samples. This is labeled <italic>full <monospace>partis</monospace> (seed)</italic>.</p>
</sec>
<sec id="sec006">
<title>Implementation</title>
<p>This clustering has been implemented as part of continued development of <monospace>partis</monospace> (<ext-link ext-link-type="uri" xlink:href="http://github.com/psathyrella/partis" xlink:type="simple">http://github.com/psathyrella/partis</ext-link>). As before, the license is GPL v3, and we have made use of continuous integration and containerization via Docker for ease of use and reproducibility [<xref ref-type="bibr" rid="pcbi.1005086.ref022">22</xref>]. A Docker image with <monospace>partis</monospace> installed is available at <ext-link ext-link-type="uri" xlink:href="https://registry.hub.docker.com/u/psathyrella/partis/" xlink:type="simple">https://registry.hub.docker.com/u/psathyrella/partis/</ext-link>.</p>
</sec>
<sec id="sec007">
<title>Results on simulation</title>
<p>In the absence of real data sets with many sequences for which the true annotations and lineage structures are known, we compare these new clustering methods against previous methods using simulated sequences generated as described in [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>]. These simulations were done for the heavy chain locus only. We performed comparison both on samples, which we call 1×, which mimic mutation frequencies in data (overall mean frequency of about 10%) and on samples, which we call 4×, with quadrupled branch lengths (overall mean frequency of about 25%) to explore results in a more challenging regime. Per-sequence mutation frequencies are distributed according to the empirical distribution (see [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>]). We compare the three <monospace>partis</monospace> methods to three methods from the literature. The first, labeled “VJ CDR3 0.9”, is representative of annotation- and distance-based methods which have been used in a number of papers [<xref ref-type="bibr" rid="pcbi.1005086.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1005086.ref026">26</xref>]. It begins by annotating each individual sequence, and proceeds to group sequences which share the same V and J gene and the same CDR3 length, and have CDR3 sequence similarity above some threshold, which is commonly 0.9 [<xref ref-type="bibr" rid="pcbi.1005086.ref024">24</xref>]. For this comparison we use <monospace>partis</monospace> annotation; for a comparison of annotation methods themselves see [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>]. We also compare against <monospace>Change-O</monospace>’s clustering functionality [<xref ref-type="bibr" rid="pcbi.1005086.ref027">27</xref>] fed with annotations from <monospace>IMGT</monospace>, with <monospace>IMGT</monospace> failures (when it does not return an annotation) classified as singletons. We perform a partial comparison against <monospace>MiXCR</monospace> [<xref ref-type="bibr" rid="pcbi.1005086.ref028">28</xref>]. Since this method does not currently report which sequences go into which clusters, and instead only reports cluster summary statistics, we cannot perform a detailed evaluation. The authors of <monospace>MiXCR</monospace> note in personal communication, however, that they plan to report this information in future versions.</p>
<p>We use per-read averages of precision and sensitivity to quantify clustering accuracy. In this context, the precision for a given read is the fraction of sequences in its inferred cluster which are actually in its clonal family, while sensitivity for a given read is the fraction of sequences in its true clonal family that appear in its inferred cluster (details in <xref ref-type="sec" rid="sec012">Methods</xref>). We find that <monospace>partis</monospace> is much more sensitive than previous methods, at the cost of some loss of precision (<xref ref-type="fig" rid="pcbi.1005086.g002">Fig 2</xref>). The point <monospace>partis</monospace> approximate implementation is less specific than the full implementation, while the even faster <monospace>vsearch</monospace> approximation loses some precision and some sensitivity.</p>
<fig id="pcbi.1005086.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Similarity between inferred and true partitions for the various clustering methods at typical (1×) mutation levels via per-read averages of precision (top left), sensitivity (top right), and their harmonic mean (bottom, called F1 score).</title>
<p>Results are on simulated sequences which span the entire V, D, and J segments; the number of leaves (BCR sequences per clonal family) is distributed geometrically with the indicated mean value. Precision measures the extent to which inferred clusters contain truly clonal sequences, while sensitivity measures the extent to which the entirety of each sequence’s clonal family appears in its inferred cluster.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g002" xlink:type="simple"/>
</fig>
<p>We investigate these differences in more detail for the first simulation replicate via an <italic>intersection matrix</italic> with entries equal to the size of the intersection between each of the 40 largest clusters returned by pairs of algorithms (Figs <xref ref-type="fig" rid="pcbi.1005086.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1005086.g004">4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005086.s006">S6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005086.s007">S7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005086.s008">S8</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005086.s009">S9</xref> Figs). Full <monospace>partis</monospace> infers clonal families correctly the majority of the time at typical mutation levels, and in this experiment it incorrectly split a cluster of true size around 45. These results degraded somewhat with the point <monospace>partis</monospace> approximation, and somewhat more with the <monospace>vsearch</monospace> approximation. The VJ CDR3 0.9 method consistently under-clustered for the largest cluster sizes. The seeded full <monospace>partis</monospace> method correctly reconstructed the lineage of interest starting from a randomly sampled sequence, while ignoring all others.</p>
<fig id="pcbi.1005086.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Fraction of sequences per cluster in common with the true partition on simulation for each method at typical (1×) levels of mutation.</title>
<p>For these plots, we took the 40 largest clusters resulting from the given clustering and took their intersection with the 40 largest clusters generated by the simulation. Each non-white square indicates that there was a non-empty intersection between the two clusters; the square is shaded by the size of the clusters’ intersection divided by their mean size. The position of the square shows the relative sizes of the two clusters. Results are shown for the simulation sample in which the size of each clonal family is drawn from a geometric distribution with mean 50 (other values are shown in <xref ref-type="supplementary-material" rid="pcbi.1005086.s006">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005086.s008">S8</xref> Figs).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g003" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005086.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Fraction of sequences per cluster in common with the true partition on simulation for each method with high (4×) mutation.</title>
<p>Plot layout as in <xref ref-type="fig" rid="pcbi.1005086.g003">Fig 3</xref>. Results are shown for the simulation sample in which the size of each clonal family is drawn from a geometric distribution with mean 50 (other values are shown in <xref ref-type="supplementary-material" rid="pcbi.1005086.s007">S7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005086.s009">S9</xref> Figs).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g004" xlink:type="simple"/>
</fig>
<p>In order to understand performance on the many smaller clusters and to get a simpler overall picture, we also compared cluster size distributions for the various methods with the simulated distribution (Figs <xref ref-type="fig" rid="pcbi.1005086.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1005086.g006">6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005086.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005086.s002">S2</xref> Figs). Here we can see that <monospace>partis</monospace> is able to accurately infer the true cluster size in a variety of regimes, whereas other methods tend to under-merge clusters of all sizes.</p>
<fig id="pcbi.1005086.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g005</object-id>
<label>Fig 5</label>
<caption>
<title>True and inferred cluster size distributions at normal (1×) mutation levels for each of the methods for geometrically distributed simulated cluster sizes with various means.</title>
<p>Results are the mean of three simulated samples with 1000 sequences each.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g005" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005086.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g006</object-id>
<label>Fig 6</label>
<caption>
<title>True and inferred cluster size distributions at high mutation levels (×4) for each of the methods for geometrically distributed simulated cluster sizes with various means.</title>
<p>Results are the mean of three simulated samples with 1000 sequences each.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g006" xlink:type="simple"/>
</fig>
<p>In order to further understand the source of these differences, we also compare results against two methods of generating incorrect partitions starting from the true partition, which we call <italic>synthetic</italic> partitions (<xref ref-type="supplementary-material" rid="pcbi.1005086.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005086.s004">S4</xref> Figs). The first, called <italic>synthetic 60% singleton</italic> is generated from the true partition by splitting 60% of the sequences into singleton clusters. The second, called <italic>synthetic neighbor 0.03</italic>, merges together true clonal families which have true naive sequences closer than 0.03 in Hamming distance divided by sequence length. We find that the performance of synthetic 60% singleton tracks that of the VJ CDR3 method, while the performance of synthetic neighbor 0.03 tracks that of <monospace>partis</monospace>.</p>
<p>Finally, to investigate the performance of the seeded full <monospace>partis</monospace> method, we calculate the precision and sensitivity of this method on a number of widely varying sample sizes (<xref ref-type="fig" rid="pcbi.1005086.g007">Fig 7</xref>). For these simulations we used a Zipf (power-law) distribution of cluster sizes with exponent 2.3, and randomly selected one seed sequence from a randomly selected large cluster. We find that seeded <monospace>partis</monospace> frequently obtains very high sensitivity, although precision decreases as sample size increases. This precision decrease is from incorrect merges of clusters. We have manually checked these incorrect merges, and found that the true (i.e. simulated) naive sequences of clusters which are incorrectly merged with the seeded cluster typically differ by one to six bases. Because these differences occur either within the bounds of the true eroded D segment, or within the true non-templated insertions, it is difficult to distinguish them from somatic hypermutation. This echoes the observation that <monospace>partis</monospace> precision is driven by the presence or absence of clusters which stem from different rearrangements, but which are very similar in naive sequence (compare <monospace>partis</monospace> and synthetic neighbor 0.03 in <xref ref-type="supplementary-material" rid="pcbi.1005086.s005">S5 Fig</xref>).</p>
<fig id="pcbi.1005086.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Similarity between inferred and true partitions for seed <monospace>partis</monospace> via per-read averages of precision (left) and sensitivity (right) with increasing sample size.</title>
<p>There is one point at each indicated <italic>x</italic> value except for one hundred thousand, five hundred thousand, and one million, which have three points each. Results are shown for a sample with cluster sizes distributed as a Zipf (power law) distribution with exponent 2.3, given a randomly selected seed sequence from a randomly selected large cluster.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Insertion and deletion mutations</title>
<p>In order to handle insertion-deletion (indel) mutations which occur during somatic hypermutation, we have implemented a heuristic method in the preliminary Smith-Waterman alignment step in <monospace>partis</monospace>. In short, this works by “reversing” inferred indel mutations in germline-encoded regions and proceeding with the clustering algorithm. We find that <monospace>partis</monospace> performance is typically unaffected when indels occur in non-CDR3 germline-encoded regions, although performance suffers when indels occur in the CDR3 (<xref ref-type="fig" rid="pcbi.1005086.g008">Fig 8</xref>). This is because indel mutations in the CDR3 are quite difficult to distinguish from insertions and deletions stemming from the VDJ rearrangement process using indel-handling schemes (such as ours) that only take one sequence at a time into account.</p>
<fig id="pcbi.1005086.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Overall clustering quality, parameterized by the harmonic mean of precision and sensitivity (the F1 score), in the presence of indel mutations.</title>
<p>For these simulations, half of the simulated sequences have a single indel, whose position is distributed evenly either in the V segment (left, specifically between position 10 and the conserved cysteine) or in the CDR3 (right). Indels substantially decrease performance only when they occur within the CDR3. Results are the mean of 3 samples of 1000 sequences each.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Application to data</title>
<p>In order to understand the difference this method makes on real data, we applied <monospace>partis</monospace> and the other algorithms to subjects in the Adaptive data set from [<xref ref-type="bibr" rid="pcbi.1005086.ref029">29</xref>] used in previous publications [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref031">31</xref>], as well as the data set from [<xref ref-type="bibr" rid="pcbi.1005086.ref024">24</xref>], which we will call the “Vollmers” data set. These data sets were Illumina sequenced via amplicons covering the heavy chain CDR3, and thus do not have complete V or J sequences. Especially in the case of the V region for the Vollmers data, it is not possible to confidently identify the germline V gene for each of the BCR sequences. Thus, these data sets make for an interesting comparison between methods (such as VJ CDR3) which require single germline gene identifications, to our method, which integrates over such identifications. Results are shown for Adaptive subject A (<xref ref-type="fig" rid="pcbi.1005086.g009">Fig 9</xref>), and for a subject from the Vollmers data set (<xref ref-type="fig" rid="pcbi.1005086.g010">Fig 10</xref>). The rest may be found on <monospace>figshare</monospace> at <ext-link ext-link-type="uri" xlink:href="http://figshare.com/s/9b85e4ac54d011e5bd3e06ec4b8d1f61" xlink:type="simple">http://figshare.com/s/9b85e4ac54d011e5bd3e06ec4b8d1f61</ext-link>. Note that the identifiers shown for the Vollmers data are an obfuscated version of the original identifiers in the data; contact the authors for more details. These results are not presented to make any strong statement about the true cluster size distribution, the correctness of which cannot be be independently evaluated, but rather to show that the <monospace>partis</monospace> results are different from those of other methods on real data, as seen under simulation.</p>
<fig id="pcbi.1005086.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Results of the various methods on data from subject A in the Adaptive data set.</title>
<p>We show cluster size distributions (top) and intersection matrices, which show the fraction of sequences per cluster in common between the various methods. Results are on a randomly-chosen subsample of 20,000 sequences.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g009" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005086.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Results of the various methods on data from subject 15-12 in the Vollmers data set.</title>
<p>We show cluster size distributions (top) and intersection matrices, which show the fraction of sequences per cluster in common between the various methods. Results are on a randomly-chosen subsample of 20,000 sequences.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g010" xlink:type="simple"/>
</fig>
<p>When we applied the various methods to a randomly chosen set of 20,000 sequences from two different sets, we found that the various methods agree that both samples are dominated by singletons, but there is substantial discord at the high end of the distribution, especially in Adaptive subject A (Figs <xref ref-type="fig" rid="pcbi.1005086.g009">9</xref> and <xref ref-type="fig" rid="pcbi.1005086.g010">10</xref>). These differences in composition are examined in more detail using cluster intersection matrices. The cluster size distribution inferred by <monospace>partis</monospace> approximately follows a power-law, with exponent about 2.3.</p>
<p>Adaptive subject A (<xref ref-type="fig" rid="pcbi.1005086.g009">Fig 9</xref>) has mutation levels two and a half times higher than Vollmers subject 15-12 (<xref ref-type="fig" rid="pcbi.1005086.g010">Fig 10</xref>), making inference more challenging for A. Both of these data sets consist of shorter sequences than the simulated sequences, which contain the entire V and J regions. Reads in the Adaptive samples are 130 base pairs (losing about two thirds of the V and one half of the J), while those in the Vollmers data set vary in length, but typically span all of the J but only 20 to 30 bases in the V.</p>
</sec>
<sec id="sec010">
<title>Time required</title>
<p>Likelihood-based clustering using <monospace>partis</monospace> is computationally demanding, though within a range applicable to real questions given appropriate computing power (<xref ref-type="fig" rid="pcbi.1005086.g011">Fig 11</xref>). On a computing cluster with about 25 8-core machines, full and point <monospace>partis</monospace> can cluster ten thousand sequences in 4 to 7 hours, while <monospace>vsearch</monospace> <monospace>partis</monospace> can cluster one hundred thousand sequences in 4 hours. Our implementation of “VJ CDR3 0.9” used <monospace>partis</monospace> annotation, but this approach could be made much faster by using a fast method for annotation [<xref ref-type="bibr" rid="pcbi.1005086.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref032">32</xref>]. Time required can also vary by an order of magnitude depending on the structure of the sample (cluster size and mutation level).</p>
<fig id="pcbi.1005086.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Run time for the various methods.</title>
<p>Results are from running on a cluster with about 25 8-core machines. The time required for <monospace>Change-O</monospace> is difficult to measure, as the sequences are first annotated by manual submission to the IMGT website, which takes from 1–6 days to return results. The actual clustering time for <monospace>Change-O</monospace> once these annotations are obtained is very small, on par with the <monospace>MiXCR</monospace> results shown in this plot. Time required also varies by an order of magnitude depending on the structure of the sample (cluster size and mutation level).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g011" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011" sec-type="conclusions">
<title>Discussion</title>
<p>We have developed an algorithm to infer clonal families using a likelihood-based framework. Although the framework does take annotation information into account by using a VDJ-based HMM, the algorithm is distinguished from other clustering methods in that it does not fix a single annotation first and then use that annotation for downstream steps. Instead we find that by integrating over annotated ancestor sequences using an HMM, we are able to obtain better clonal family inference than with the current common practice of rigidly inferring VJ annotation and then clustering on HCDR3 identity for heavy chain sequences. Our simulations show that existing algorithms frequently do not sufficiently cluster sequences which sit in the same clonal family. Our application to real data shows that the <monospace>partis</monospace> algorithms using our default clustering thresholds return more large clusters on two real data sets, indicating that this difference in clustering is not simply an artifact of our simulation setup.</p>
<p>The performance differences between our various approximate algorithms indicates the sources of the <monospace>partis</monospace>’ improved performance. The reasonably good performance of the point <monospace>partis</monospace> variant shows the importance of clustering on inferred naive sequences rather than observed sequences and inferring these naive sequences with an accurate probabilistic method. Furthermore, the difference between point and full <monospace>partis</monospace> is some measure of the importance of integrating out uncertainty in annotated ancestor sequences.</p>
<p>We find that <monospace>partis</monospace>’ main weakness is in separating out clusters with highly similar naive sequences. Indeed, its performance tracks a simulated method that merges clonal families with true (i.e. simulated) naive sequences that are closer than 3% in nucleotides, in simulations with about 10% divergence from the naive sequence. Although the VDJ rearrangement process generates a very diverse repertoire, biases in gene family use and other rearrangement parameters mean that pairs of highly similar naive sequences are frequently generated. This may indicate an inherent limitation in clonal family inference methods that only use data from heavy chain.</p>
<p>Our method builds on previous work for doing likelihood-based analysis of BCR sequences. In particular, we are indebted to Tom Kepler for initiating the use of HMMs in BCR sequence analysis [<xref ref-type="bibr" rid="pcbi.1005086.ref010">10</xref>] and for developing likelihood-based methods to infer unmutated common ancestor sequences while integrating over rearrangement uncertainty [<xref ref-type="bibr" rid="pcbi.1005086.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1005086.ref035">35</xref>].</p>
<p>We did not compare to several related methods that have been described in the literature. <monospace>ClonalRelate</monospace> [<xref ref-type="bibr" rid="pcbi.1005086.ref036">36</xref>] is an extension to the “VJ CDR3” method that allows some flexibility in requiring V and J calls to be the same by combining various mismatch penalties into a distance that is used for agglomerative clustering. <monospace>IMSEQ</monospace> [<xref ref-type="bibr" rid="pcbi.1005086.ref032">32</xref>] is a recent method which is reported to be quite fast; however the current version appears mainly aimed toward T cell receptors, as it does not handle somatic hypermutation. As it clusters based on V and J genes and 100% CDR3 similarity, it is equivalent to the annotation-based method described above, except with a threshold inappropriate to B cells. <monospace>Cloanalyst</monospace> performs joint reconstruction of annotated ancestor sequence and a phylogenetic tree given a collection of sequences assumed to form a clonal family [<xref ref-type="bibr" rid="pcbi.1005086.ref017">17</xref>]. <monospace>Immunitree</monospace> apparently uses a Dirichlet process mixture model for clustering, however, the algorithm is only fully described in a PhD thesis [<xref ref-type="bibr" rid="pcbi.1005086.ref014">14</xref>], and does not appear to be publicly available (note that <ext-link ext-link-type="uri" xlink:href="https://github.com/laserson/vdj" xlink:type="simple">https://github.com/laserson/vdj</ext-link> performs straightforward single-linkage clustering and is in fact written by a sibling of the <monospace>Immunitree</monospace> author). <monospace>IgSCUEAL</monospace> [<xref ref-type="bibr" rid="pcbi.1005086.ref037">37</xref>] is a recent method that performs annotation and clustering using a phylogenetic approach. Its clustering algorithm, however, is not part of the public distribution and is apparently undergoing revision.</p>
<p>There are several opportunities to improve <monospace>partis</monospace>. First, our current approach requires likelihood ratios to exceed a value based on cluster size; these cluster sizes are based on observing distributions of likelihood ratios under simulation. A more principled approach would be preferable. Second, our approach to insertion-deletion mutations in affinity maturation only uses one sequence at a time. Thus it has an inherent difficulty differentiating between mutations in the course of affinity maturation versus insertion-deletion events that are part of VDJ rearrangement. Third, our current code is only for the heavy chain alone or the light chain chain alone. Extending the work to paired heavy and light chain BCR data is conceptually straightforward, although will require additional software engineering. Fourth, HMMs have certain inherent limitations, stemming from the central Markov assumption that the current state is ignorant of all states except for the previous one. As reviewed in [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>], this limits the scope of events that can be modeled using <monospace>partis</monospace>, excluding correlation between different segments of the BCR [<xref ref-type="bibr" rid="pcbi.1005086.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref039">39</xref>], palindromic N-additions [<xref ref-type="bibr" rid="pcbi.1005086.ref040">40</xref>], complex strand interaction events [<xref ref-type="bibr" rid="pcbi.1005086.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref042">42</xref>], or the appearance of tandem D segments [<xref ref-type="bibr" rid="pcbi.1005086.ref043">43</xref>]. Some of these limitations could be avoided by using Conditional Random Fields (reviewed in [<xref ref-type="bibr" rid="pcbi.1005086.ref044">44</xref>]), and although linear-chain conditional random fields enjoy many of the attractive computational properties of HMMs, this flexibility will come with a computational cost. Fifth, <monospace>partis</monospace> does not attempt to infer germline genotype, as do [<xref ref-type="bibr" rid="pcbi.1005086.ref045">45</xref>], and so treats genes and alleles on an equal footing. We will treat this as a model-based inference problem in future development. Sixth, we will continue to refine heuristics to provide the accuracy of the full likelihood-ratio calculation with minimal compute time. We note, for instance, that a small decrease in the lower naive Hamming fraction threshold substantially improves performance for the seed <monospace>partis</monospace> simulation compared to that shown here (in <xref ref-type="fig" rid="pcbi.1005086.g007">Fig 7</xref>).</p>
<p>In additional future work, we will explore opportunities to combine clonal family inference and phylogenetics to obtain inference of complete B cell lineages. This could potentially take the form of a phylo-HMM [<xref ref-type="bibr" rid="pcbi.1005086.ref046">46</xref>], although a more straightforward approach would be to take the product of a phylogenetic likelihood and a rearrangement likelihood [<xref ref-type="bibr" rid="pcbi.1005086.ref017">17</xref>]. For example, one might use HMM-based clustering as is described here with a high likelihood ratio cutoff to obtain a conservative collection of clusters, and then a phylogenetic criterion to direct further clustering.</p>
<p>In addition to these methodological improvements, we will also apply <monospace>partis</monospace> to a variety of data sets for validation and to learn about the structure of natural repertoire. For validation, there are some data sets, e.g. [<xref ref-type="bibr" rid="pcbi.1005086.ref047">47</xref>], which due to experimental setup have sequences known to make a clonal lineage. Also, new microfluidics technology applied to BCR sequencing also gives heavy and light chain data [<xref ref-type="bibr" rid="pcbi.1005086.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1005086.ref049">49</xref>]; although a single heavy chain clonal lineage can have light chains from independent rearrangement events, this type of data does provide further evidence of clonality for validation of clonal family inference procedures. In addition to this sort of validation, there are now an abundance of data sets that can be used to characterize the size distribution of the clonal families in various immune states, such as health, immunization, and disease.</p>
<p>As a final note, <monospace>partis</monospace> works to solve a challenging likelihood-based inference problem. We recognize that in contrast to existing heuristic approaches based on sequence identity, our software is quite computationally demanding. In this first paper we have developed the framework and overall approach, as well as many computational optimizations. This optimization work is ongoing, and there remain many avenues for improvement. As a comparison, likelihood-based phylogenetic inference has taken two decades of optimization to scale to tens of thousands of sequences at a time with approximate algorithms [<xref ref-type="bibr" rid="pcbi.1005086.ref050">50</xref>]. We are continually making improvements to the algorithm to make it scale to larger data sets and are committed to building algorithms that scale to the size of contemporary data sets. Although such algorithms may end up being rather different than this version of <monospace>partis</monospace>, we believe that likelihood-based algorithms will provide a solid foundation for large-scale molecular evolution studies of B cell maturation.</p>
</sec>
</sec>
<sec id="sec012" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec013">
<title>Likelihood framework</title>
<p>To introduce the way in which we use HMMs for BCR clustering, consider the canonical “dishonest casino” HMM [<xref ref-type="bibr" rid="pcbi.1005086.ref020">20</xref>]. In this introductory example, one imagines that a casino offers a game in which the casino alternates between a fair die and a die that is biased towards a given number, say 6. Assume the dice are switched with probability <italic>p</italic> each roll, corresponding to the HMM on two states, with a transition probability of <italic>p</italic> between the states. One favorite game of bioinformaticians is to infer the maximum likelihood identity of the die for each roll given a sampled sequence of roll outcomes, which is solved by the Viterbi algorithm. The so-called forward algorithm, on the other hand, infers the marginal probability of a sequence of outcomes.</p>
<p>The likelihood ratio used in this paper fits into the metaphor with a slight variant of the game (<xref ref-type="fig" rid="pcbi.1005086.g012">Fig 12</xref>). In this variant, a pair of outcomes (a.k.a. <italic>emissions</italic>, in this case integers in the range 1 to 6) are sampled at each step. The player knows that either the emissions came from rolling the same die twice and then switching out the die with probability <italic>p</italic> after each step, or they came from rolling two dice which are independently switched out with probability <italic>p</italic>. The new game, corresponding to the methods in this paper, is to figure out which of these scenarios is correct, and with what support.</p>
<fig id="pcbi.1005086.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Single and pair HMM likelihoods by analogy with a game of dice.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g012" xlink:type="simple"/>
</fig>
<p>The marginal probability of a sequence of emissions under the “double roll” scenario is that of a pair-HMM with transition probability <italic>p</italic> with identical emission probabilities, while the latter “two dice” scenario is that of two independent HMMs. The ratio of these two marginal probabilities is a likelihood ratio quantifying the strength of evidence for the “double roll” scenario.</p>
<p>Now, stepping back into the world of VDJ recombination, we will apply this logic to the HMM structure introduced in [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>]. This HMM, building on prior work [<xref ref-type="bibr" rid="pcbi.1005086.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1005086.ref012">12</xref>], has one state for each position in every V, D, and J gene, and a state for each of the joining N-regions for heavy chain sequences. Light chain sequences are simpler, in that they have only V, J, and one N-region, and so for the rest of this methods section we will only describe the heavy chain procedure.</p>
<p>Continuing with the metaphor, the identity of the die (of which there are now many) for each roll corresponds either to an annotation of that nucleotide as being from a given non-templated insertion base, or as being from a specific nucleotide in a specific V, D, or J gene. That is, a path through the HMM corresponds to an annotated ancestor sequence. Our previous paper [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>] was focused on inferring these annotated ancestor sequences using the Viterbi algorithm. Here we focus on the question of whether a group of sequences came from the same rearrangement event rather than on the annotated ancestor sequences themselves. However, this distribution of annotated ancestor sequences is highly informative about the clonality of a group of sequences. We would like use these annotated ancestor sequence inferences but avoid putting too much trust in one specific and necessarily uncertain inference, and instead account for the diversity for possible annotations. We do so as follows.</p>
<p>Using <italic>σ</italic> to designate paths and <italic>x</italic> for a sequence, the marginal probability <inline-formula id="pcbi.1005086.e001"><alternatives><graphic id="pcbi.1005086.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of generating <italic>x</italic> via any path is
<disp-formula id="pcbi.1005086.e002"><alternatives><graphic id="pcbi.1005086.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>σ</mml:mi></mml:munder> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>;</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1005086.e003"><alternatives><graphic id="pcbi.1005086.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>;</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> designates the probability of generating <italic>x</italic> with the path <italic>σ</italic> through the HMM. Now for a pair of sequences <italic>x</italic> and <italic>y</italic>,
<disp-formula id="pcbi.1005086.e004"><alternatives><graphic id="pcbi.1005086.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>σ</mml:mi></mml:munder> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>;</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
is the probability of generating both <italic>x</italic> and <italic>y</italic> using emissions from a single pass through the HMM. Thus <inline-formula id="pcbi.1005086.e005"><alternatives><graphic id="pcbi.1005086.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a likelihood ratio such that values above 1 support the hypothesis that <italic>x</italic> and <italic>y</italic> come from the same rearrangement event and values less than 1 support the hypothesis that they do not. Recall that all of these probabilities can be calculated efficiently via the forward algorithm.</p>
<p>More generally, if we would like to evaluate whether sequence sets <italic>A</italic> and <italic>B</italic> (each of which are assumed to descend from single rearrangement events) actually all came from a single rearrangement event. For that we can calculate
<disp-formula id="pcbi.1005086.e006"><alternatives><graphic id="pcbi.1005086.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mfrac><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>∪</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo> <mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></alternatives> <label>(1)</label></disp-formula>
where <inline-formula id="pcbi.1005086.e007"><alternatives><graphic id="pcbi.1005086.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> can be calculated by a (simple) HMM if <italic>X</italic> has one element, a pair-HMM if <italic>X</italic> has two elements, etc., so in general a multi-HMM. Note that this not a phylogenetic likelihood, but a rather strictly HMM-based likelihood, and so does not attempt to incorporate any tree structure into the computations.</p>
<p>We use this likelihood ratio for agglomerative clustering. Specifically, at each step we pick the pair <italic>A</italic> and <italic>B</italic> that have the largest likelihood ratio <xref ref-type="disp-formula" rid="pcbi.1005086.e006">Eq (1)</xref> and merge them by replacing <italic>A</italic> and <italic>B</italic> from the list of clusters and adding <italic>A</italic>∪<italic>B</italic> (<xref ref-type="fig" rid="pcbi.1005086.g013">Fig 13</xref>). We stop agglomerating according to a likelihood ratio threshold, as described in the section after next. Agglomerative clustering has been applied before for clonal family inference [<xref ref-type="bibr" rid="pcbi.1005086.ref036">36</xref>], however in this case rather than averaging the distances for the merged clusters (as for average linkage clustering) we recompute likelihood ratios with the newly merged set of sequences.</p>
<fig id="pcbi.1005086.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Cartoon of agglomerative clustering.</title>
<p>Starting with singleton clusters, at each step we find the pair of clusters that maximizes <xref ref-type="disp-formula" rid="pcbi.1005086.e006">Eq (1)</xref> and merge them.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.g013" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Review of the HMM machinery of [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>]</title>
<p>The HMM architecture we use is the same as that of [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>], which for the most part follows previous work [<xref ref-type="bibr" rid="pcbi.1005086.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1005086.ref012">12</xref>] by representing each germline base in each V, D, and J allele as an HMM state. All of these states can be combined to create a single HMM for the entire VDJ rearrangement process. In order to allow likelihood contributions from the N-region, we replace the single insert state found in previous work with four states, corresponding to naive-sequence N-addition of A, C, G, and T. The emissions of these four states are then treated as for actual germline states: the A state, for example, has a large probability of emitting an A, and a complementary probability (equal to the observed mutation probability) of emitting one of the other three bases.</p>
<p>Our application of HMMs also differs from previous work using HMMs for B cell receptor sequence analysis in that we do inference under a model which simultaneously emits an arbitrary number of symbols <italic>k</italic>. When <italic>k</italic> = 2 this is typically called a pair HMM [<xref ref-type="bibr" rid="pcbi.1005086.ref020">20</xref>], and we call the generalized form a multi-HMM (<italic>k</italic> ≥ 2). One can also think of this as doing inference while constraining all of the sequences to come from the same path through the hidden states of the HMM. In our setting, the <italic>k</italic> sequences resulting from such a multi-HMM model are the various sequences deriving from a single rearrangement event (which differ only according to point substitution from somatic hypermutation). HMM inference is performed by an efficient new HMM compiler, called <monospace>ham</monospace>, which we wrote to inference on an arbitrary (multi-)HMM specified via a simple text file (<ext-link ext-link-type="uri" xlink:href="https://github.com/psathyrella/ham/" xlink:type="simple">https://github.com/psathyrella/ham/</ext-link>).</p>
</sec>
<sec id="sec015">
<title>Naive Hamming fraction thresholds</title>
<p>A straightforward application of hierarchical clustering in this setting, in which the likelihood ratio is computed for every cluster at every stage of the algorithm, would not scale to more than a few hundred sequences. Thus as described above, we also use Hamming fraction (Hamming distance divided by sequence length) between inferred naive sequences to avoid expensive likelihood ratio computation. In order to compare unequal-length sequences, we first align the conserved cysteine in every sequence, and then pad all sequences on both ends with ambiguous nucleotides until they are all the same length. In addition to point <monospace>partis</monospace> described as an approximate method above, we also use naive Hamming fraction in the full <monospace>partis</monospace> method in order to identify sequences that are either very likely or very unlikely to be clones. We assume that clusters which differ by more than 0.08 in naive Hamming fraction are not clonal, and therefore avoid calculating the full likelihood for these cases. This threshold is for repertoires with typical mutation levels (around 5%); we find that increasing the threshold as mutation increases (to 0.15 at 20% mutation) provides optimal performance. We interpolate and extrapolate linearly for other mutation levels. In addition, we assume that clusters that are closer than 0.015 (regardless of mutation levels) in naive Hamming fraction are clonal, and merge these without calculating the full likelihood. While the naive Hamming fraction only takes into account the Viterbi path (i.e. it does not sum over all potential annotated ancestor sequences), and it has no probabilistic interpretation, it has the not insignificant virtue of being much faster to calculate.</p>
</sec>
<sec id="sec016">
<title>Likelihood ratio thresholds</title>
<p>According to standard statistical theory, we should merge an <italic>a priori</italic> specified pair of clusters <italic>A</italic> and <italic>B</italic> when the likelihood ratio <xref ref-type="disp-formula" rid="pcbi.1005086.e006">Eq (1)</xref> is greater than one. However, in the midst of a series of agglomerations, we are not in the setting of a single decision for clusters that have been presented to us. Instead, at every stage we are comparing a quadratic number of potential merges and asking if the pair of clusters with the <italic>largest</italic> likelihood ratio deserve to be merged. This effectively presents substantial multiple testing issues: even when no more clusters should be merged, the nonzero-width of the empirical likelihood ratio distribution will typically have points above one. Furthermore, the marginal probability <inline-formula id="pcbi.1005086.e008"><alternatives><graphic id="pcbi.1005086.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of, say, the <italic>k</italic>th largest cluster after some number of merges is going to be biased by the fact that the sequences in that cluster were selected to merge. Such issues are not new in computational biology [<xref ref-type="bibr" rid="pcbi.1005086.ref051">51</xref>]. We also note that we are only calculating this likelihood ratio when pairs of sequences are similar enough in their inferred naive sequences to merit such a likelihood ratio calculation, further taking us from the statistically ideal setting.</p>
<p>We have found it useful to use a likelihood ratio threshold greater than 1, and use a threshold that decreases as the <italic>candidate cluster size</italic>, i.e. the size of a proposed cluster, increases (<xref ref-type="table" rid="pcbi.1005086.t001">Table 1</xref>). These values were selected as a trade-off between accurate reconstruction of large clonal families on the one hand, and accuracy at the low end of the cluster size distribution on the other. Thus if we want to minimize the chance of missing highly-mutated members of a large clonal family we should choose lower thresholds, but if we instead want to avoid mistakenly merging unrelated singletons we should choose higher ones. In light of this, the thresholds can be set on the command line.</p>
<table-wrap id="pcbi.1005086.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005086.t001</object-id>
<label>Table 1</label>
<caption>
<title>Log likelihood ratio merging threshold as a function of candidate cluster size.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005086.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">candidate cluster size</th>
<th align="center">log ratio threshold</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">2</td>
<td align="center">18</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">15</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">14</td>
</tr>
<tr>
<td align="center">≥6</td>
<td align="center">13</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec017">
<title>Insertion and deletion mutations</title>
<p>While it would be straightforward in principle to account for insertions and deletions (<italic>indels</italic>) during somatic hypermutation within the HMM by adding extra transitions for deletions and extra states for insertion, this approach would entail a very substantial computational cost. When restricting to substitution mutations, each germline state can either transition to the next germline state, or it can leave the region. If we allowed indels within the V, D, and J segments, however, each state would also need to investigate the probability to transition to a special insertion state as well as to any subsequent germline state. This would introduce a quadratic dependence on the number of states and the resulting algorithm would not be able to analyze realistically-sized data sets.</p>
<p>We thus instead adopt an approach to indel mutations based on the annotation from our preliminary Smith-Waterman step (implemented with <monospace>ighutil</monospace> [<xref ref-type="bibr" rid="pcbi.1005086.ref030">30</xref>]). In cases where <monospace>ighutil</monospace> detects an insertion with respect to a germline segment, we “reverse” the insertion by removing it from the query sequence. Similarly, candidate deletions are reversed by inserting the corresponding germline bases from the best germline match when the putative deletion happens in a germline segment. In both cases the original sequences are maintained, but the <monospace>partis</monospace> processing of the sequences is done on the modified sequences.</p>
<p>As with any Smith-Waterman implementation, this approach depends on several arbitrary parameters: the match and mismatch scores and the gap-opening penalty. In particular, a larger gap-opening penalty relative to the match/mismatch scores decreases sensitivity to indels. On all samples which we have encountered, a good initial set of match:mismatch scores is 5:1. Sequences with lower mutation rates, for which 5:1 is less optimal, are returned with no D segment match, and then re-run with match:mismatch scores of 5:2. Sequences which still have no D matches are then rerun with scores of 5:3. This procedure gives good results in all parameter regimes which we have encountered in the data. Similarly, we find that a gap-opening penalty of 30 provides good sensitivity to indel mutations in simulation. Each of these parameters may also be set with a command line flag.</p>
<p>In order to test the effectiveness of this method, we made simulated samples in which each sequence has a 50% chance of having an indel mutation after being generated on a tree. Each indel has equal probability of being an insertion or a deletion, and the indel’s position is chosen from the uniform distribution either on the bulk of the V segment (between position 10 and the conserved cysteine), or on the CDR3. The length of each indel is drawn from a geometric distribution with mean 5. These samples are not intended to mimic any particular data set, but are instead designed to provide an extremely stringent test of performance in the presence of indel mutations (<xref ref-type="fig" rid="pcbi.1005086.g008">Fig 8</xref>).</p>
</sec>
<sec id="sec018">
<title>Approximate methods</title>
<p>The accuracy of the full likelihood framework which we have described above does not come without some computational cost. As such we have also implemented two other algorithms which make some reasonable trade-offs in accuracy in order to gain some speed.</p>
<p><bold>Point <monospace>partis</monospace>.</bold> One of the biggest contributors to both annotation and partitioning accuracy comes from our multi-HMM framework’s ability to run simultaneously on an arbitrary number of sequences. Since this ability is entirely separate to the summation over all possible rearrangements, it makes sense to decouple the two in order to optimize for speed. We can, in other words, cluster using the single best (Viterbi) annotated ancestor sequence for all sequences in a cluster (inferred simultaneously on the whole cluster with the multi-HMM), without summing over all germline genes and all rearrangement boundaries. We call this <italic>point <monospace>partis</monospace></italic>, to emphasize that it uses the best point (i.e. single) annotation inference to do clustering. In order to cluster on these inferred naive sequences, we use the hierarchical agglomeration described above, but with Hamming fraction as the metric (instead of log likelihood ratio). As in the case of the likelihood ratio merging thresholds described above, we perform a simple optimization procedure on a wide variety of simulation samples which span the range of possible lineage structures and mutation levels that we observe in real data. For typical (low) mutation levels near 5%, we use a threshold of 0.035; the threshold then increases to 0.06 as the mutation frequency reaches 20%. Simple linear interpolation (extrapolation) is used inside (outside) of this range. Note that these thresholds are much tighter than those mentioned above for full <monospace>partis</monospace> optimization: while above we were trying to exclude cases where there was any doubt as to their clonality, here we are attempting to accurately divide clonal from non-clonal clusters in the naive Hamming distribution. Comparing to Fig 7 in [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>], we note that this threshold is equivalent to the expected fractional error in the inferred naive sequence.</p>
<p><bold><monospace>vsearch</monospace> <monospace>partis</monospace>.</bold> The <italic>point</italic> method, however, still performs full all-vs-all comparisons on the entire data set, and recalculates the full Viterbi naive sequence on each cluster each time more sequences are added. While this is a good way to ensure the best accuracy, there exist clustering algorithms with many optimizations which trade some of this accuracy for improved speed. <monospace>vsearch</monospace> [<xref ref-type="bibr" rid="pcbi.1005086.ref021">21</xref>] is one such tool, and we have included a version of <monospace>partis</monospace> which infers the Viterbi naive sequence for each single query, and then passes these sequences to <monospace>vsearch</monospace>. This sacrifices some accuracy, particularly on larger clonal families, but is extremely fast. We use <monospace>vsearch</monospace> version 1.1.3 in <monospace>cluster fast</monospace> mode with the maximum accept and reject thresholds set to zero, and the <monospace>id</monospace> threshold set (again, based on coarse heuristic optimization) to one-half the threshold described above for point <monospace>partis</monospace>.</p>
</sec>
<sec id="sec019">
<title>Reconstruction of selected lineages</title>
<p>We have added an option to reconstruct the lineage of a user-specified sequence using full <monospace>partis</monospace>, for situations in which one is only interested in one specific clonal family. We call such a user-specified sequence a <italic>seed</italic> sequence. This is shown as “full <monospace>partis</monospace> (seed)” (Figs <xref ref-type="fig" rid="pcbi.1005086.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1005086.g004">4</xref>). Here we chose a seed sequence at random from a randomly-selected “large” cluster, where “large” means with size greater than or equal to the mean <italic>N</italic> leaves for the sample. It can be seen that this method accurately reconstructs the single lineage of interest while running much more quickly than the other methods (<xref ref-type="fig" rid="pcbi.1005086.g011">Fig 11</xref>).</p>
</sec>
<sec id="sec020">
<title>Simulation and validation</title>
<p>To benchmark results, we simulate sequences using the procedure described in [<xref ref-type="bibr" rid="pcbi.1005086.ref019">19</xref>]. This provides a bountiful supply of sequences for which the correct lineage structures are known, and with any desired combination of tree topologies and mutation parameters, but with all other properties mimicking empirical values. Briefly, the simulation proceeds by sampling a set of parameters defining a single rearrangement (e.g. V exonuclease deletion length, V allele, etc.) from their empirical joint distribution observed in a data set. Then TreeSim [<xref ref-type="bibr" rid="pcbi.1005086.ref052">52</xref>] is used to simulate a tree and Bio++ [<xref ref-type="bibr" rid="pcbi.1005086.ref053">53</xref>] is used to simulate sequences. We emphasize that these sequences are not generated at any stage using <monospace>partis</monospace>’ HMM, and no information concerning the simulation is fed to the clustering code other than the simulated sequences. The number of leaves (BCR sequences per clonal family) is distributed geometrically with the indicated mean value in all figures except Figs <xref ref-type="fig" rid="pcbi.1005086.g007">7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005086.s001">S1</xref>. In <xref ref-type="fig" rid="pcbi.1005086.g007">Fig 7</xref> we have used a Zipf (power law) distribution. In <xref ref-type="supplementary-material" rid="pcbi.1005086.s001">S1 Fig</xref>, on the other hand, we have used a box-shaped distribution to check that our methods do not depend on a monotonically decreasing distribution. In order to simulate a given number of sequences, we simply divide the desired number of sequences by the expected number of sequences per clone and simulate the resulting number of clones. For indel simulations, half of the simulated sequences have a single indel, whose length is drawn from a geometric distribution with mean 5. In order to emphasize the importance of the indel’s location, we show samples where they are distributed evenly either within the CDR3, or within the bulk of the V segment (specifically between position 10 and the conserved cysteine).</p>
<p>We use per-sequence averages of sensitivity and precision to quantify clustering accuracy. In this context, a true positive (TP) statement about a sequence <italic>x</italic> is the correct identification of another sequence in <italic>x</italic>’s clonal family, i.e. correctly clustering a sequence with <italic>x</italic>. A false postive (FP) statement is incorrectly clustering a sequence with <italic>x</italic>, while a false negative (FN) statement is not clustering a sequence with <italic>x</italic> that should be clustered.
<disp-formula id="pcbi.1005086.e009"><alternatives><graphic id="pcbi.1005086.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005086.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:msub><mml:mo form="prefix">Sensitivity</mml:mo> <mml:mi>x</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo form="prefix">TP</mml:mo> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo form="prefix">TP</mml:mo> <mml:mi>x</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mo form="prefix">FN</mml:mo> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mspace width="2.em"/><mml:msub><mml:mo form="prefix">Precision</mml:mo> <mml:mi>x</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo form="prefix">TP</mml:mo> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo form="prefix">TP</mml:mo> <mml:mi>x</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mo form="prefix">FP</mml:mo> <mml:mi>x</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>
Thus, as described above, the precision for a given read is the fraction of sequences in its inferred cluster to which it is truly clonally related. The sensitivity for a given read is the fraction of sequences in its true cluster that appear in its inferred cluster. We average these two quantities over all sequences (Figs <xref ref-type="fig" rid="pcbi.1005086.g002">2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005086.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005086.s004">S4</xref>). These figures also show the average harmonic mean of this sensitivity and precision (a.k.a. F1 score), as an aggregate measure of the quality of the clustering.</p>
<p>We also show <italic>intersection matrices</italic>: the matrix of intersection sizes between pairs of large clusters in two partitions (examples in Figs <xref ref-type="fig" rid="pcbi.1005086.g003">3</xref>, and <xref ref-type="fig" rid="pcbi.1005086.g004">4</xref>, <xref ref-type="fig" rid="pcbi.1005086.g009">9</xref> and <xref ref-type="fig" rid="pcbi.1005086.g010">10</xref>; the full set of plots is available at <monospace>figshare</monospace> at <ext-link ext-link-type="uri" xlink:href="http://figshare.com/s/9b85e4ac54d011e5bd3e06ec4b8d1f61" xlink:type="simple">http://figshare.com/s/9b85e4ac54d011e5bd3e06ec4b8d1f61</ext-link>. To make these plots, we first take the 40 largest clusters from each of the two partitions. Each non-white square indicates that there was a non-empty intersection between the two clusters; the square is shaded by the size of the clusters’ intersection divided by their mean size. The position of the square shows the relative sizes of the two clusters. Thus a value of 1.0 implies identity, so very similar partitions will show many dark squares near the diagonal, and will also have similar cluster sizes marked on the <italic>x</italic> and <italic>y</italic> axes.</p>
<p><bold>Performance versus sample size.</bold> Given the large size of modern deep sequencing data sets, we have also investigated performance as a function of sample size. This function depends on the clonal lineage structure. At one extreme, a sample with only a few sequences stemming from a few clonal families is generally trivial to partition even just by visual inspection. As the number of clonal families increases, however, each family becomes closer and closer to other families, and it becomes more and more difficult to distinguish between them. At the point where the naive sequences corresponding to each family are separated by only a few bases, accurate overall clustering becomes impossible even in principle, since a difference of only a few bases which stems from rearrangement cannot be distinguished from somatic hypermutation.</p>
<p>In order to evaluate this performance we show several performance metrics as a function of sample size (<xref ref-type="supplementary-material" rid="pcbi.1005086.s005">S5 Fig</xref>). Here we show the two complementary precision and sensitivity metrics in the top row, and their harmonic mean (F1 score) in the bottom row. It can be seen the behavior of the <monospace>partis</monospace> with sample size is similar to that of the synthetic partition which joins neighboring true clusters which are closer than some threshold. This is expected, and demonstrates that performance of the <monospace>partis</monospace> method decreases as the number of true naive rearrangements in the sample increases, and thus the clonal family inference problem is becoming inherently more difficult.</p>
</sec>
<sec id="sec021">
<title>Parallelization</title>
<p>Non-independence of clustering steps poses a challenge for parallelization, and we approach this challenge with a combination of principled probability calculations and reasonable heuristics. The basic strategy is to begin with a large number of processes, each running on a small subset of the data sample. When each of these processes finishes clustering its allotted sequences, it reports back to the parent program, which collects the results from each subprocess and reapportions the resulting clusters among a new, smaller number of processes for the next step. The process then repeats until we arrive at a single process which is comparing all clusters against all other clusters. On the face of it, each step in this scheme would take much longer than the previous one since it is comparing more sequences. However, because each process caches all the likelihoods it calculates, and because both factors in the denominator for each likelihood ratio <xref ref-type="disp-formula" rid="pcbi.1005086.e006">Eq (1)</xref> is guaranteed to have been calculated in a previous step, we can choose the process number reduction ratio such that each stage of paralellization takes roughly the same time.</p>
<p>An important part of this process is the allotment of sequences to processors. At present we apportion them randomly in order to achieve a (very) roughly equal number of computations per process. This is far from ideal, however, because we want to merge clonal sequences as soon as possible in order to avoid unnecessary comparisons to non-clonal sequences. This must be balanced, however, by the need to evenly distribute the workload across all processes. In the future we will study in more detail the optimal allotment scheme, and anticipate substantial speed increases.</p>
</sec>
</sec>
<sec id="sec022">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005086.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>True and inferred cluster size distributions for simulation with non-geometric cluster size distributions.</title>
<p>Results are shown for box distributions with mean 30 (left) and 150 (right).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005086.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>True and inferred cluster size distributions for simulation with shorter read lengths.</title>
<p>Results are shown for samples with reads of length 130 bases centered on the CDR3 (which mimics the Adaptive data set), for geometric cluster size distributions with mean 3 (left) and 10 (right).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005086.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Similarity between inferred and true partitions for the various clustering methods at typical (1×) mutation levels via per-read averages of precision (top left), sensitivity (top right), and their harmonic mean (bottom, called F1 score).</title>
<p>Results are on simulated sequences which span the entire V, D, and J segments; the number of leaves (BCR sequences per clonal family) is distributed geometrically with the indicated mean value. Precision measures the extent to which inferred clusters contain truly clonal sequences, while sensitivity measures the extent to which the entirety of each sequence’s clonal family appears in its inferred cluster. These plots also include <italic>synthetic</italic> partitions, which for purposes of comparison generate incorrect partitions starting from the true partition (“synth.”, see text for details).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005086.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Similarity between inferred and true partitions for the various clustering methods at high (4×) mutation levels with the same labels as in <xref ref-type="supplementary-material" rid="pcbi.1005086.s003">S3 Fig</xref>.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005086.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Overall clustering quality metrics as a function of sample size, on simulation corresponding to patient 15-12 in the Vollmers data set.</title>
<p>See <xref ref-type="supplementary-material" rid="pcbi.1005086.s003">S3 Fig</xref>.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005086.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Fraction of sequences per cluster in common with the true partition on simulation with a mean 2 geometric distribution for the number of leaves at typical (1×) mutation levels.</title>
<p>For these plots, we took the 40 largest clusters resulting from the given clustering and took their intersection with the 40 largest clusters generated by the simulation. Each non-white square indicates that there was a non-empty intersection between the two clusters; the square is shaded by the size of the clusters’ intersection divided by their mean size. The position of the square shows the relative sizes of the two clusters.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005086.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Fraction of sequences per cluster in common with the true partition on simulation with a mean 2 geometric distribution for the number of leaves at high (4×) mutation levels.</title>
<p>For these plots, we took the 40 largest clusters resulting from the given clustering and took their intersection with the 40 largest clusters generated by the simulation. Each non-white square indicates that there was a non-empty intersection between the two clusters; the square is shaded by the size of the clusters’ intersection divided by their mean size. The position of the square shows the relative sizes of the two clusters.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005086.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Fraction of sequences per cluster in common with the true partition on simulation with a mean 200 geometric distribution for the number of leaves at typical (1×) mutation levels.</title>
<p>For these plots, we took the 40 largest clusters resulting from the given clustering and took their intersection with the 40 largest clusters generated by the simulation. Each non-white square indicates that there was a non-empty intersection between the two clusters; the square is shaded by the size of the clusters’ intersection divided by their mean size. The position of the square shows the relative sizes of the two clusters.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005086.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005086.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Fraction of sequences per cluster in common with the true partition on simulation with a mean 200 geometric distribution for the number of leaves at high (4×) mutation levels.</title>
<p>Results are shown for the simulation sample with a mean 200 geometric distribution for the number of leaves. For these plots, we took the 40 largest clusters resulting from the given clustering and took their intersection with the 40 largest clusters generated by the simulation. Each non-white square indicates that there was a non-empty intersection between the two clusters; the square is shaded by the size of the clusters’ intersection divided by their mean size. The position of the square shows the relative sizes of the two clusters.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Vu Dinh, Julie Overbaugh, Vladimir Minin, and Chaim Schramm for support and helpful discussions. Jakub Otwinowski gave excellent feedback on software usability.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005086.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Melchers</surname> <given-names>F</given-names></name>. <article-title>Checkpoints that control B cell development</article-title>. <source>J Clin Invest</source>. <year>2015</year> <month>Jun</month>;<volume>125</volume>(<issue>6</issue>):<fpage>2203</fpage>–<lpage>2210</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1172/JCI78083" xlink:type="simple">http://dx.doi.org/10.1172/JCI78083</ext-link>. <object-id pub-id-type="pmid">25938781</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Victora</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Mesin</surname> <given-names>L</given-names></name>. <article-title>Clonal and cellular dynamics in germinal centers</article-title>. <source>Curr Opin Immunol</source>. <year>2014</year> <month>Jun</month>;<volume>28</volume>:<fpage>90</fpage>–<lpage>96</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.coi.2014.02.010" xlink:type="simple">http://dx.doi.org/10.1016/j.coi.2014.02.010</ext-link>. <object-id pub-id-type="pmid">24681449</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eisen</surname> <given-names>HN</given-names></name>, <name name-style="western"><surname>Siskind</surname> <given-names>GW</given-names></name>. <article-title>Variations in affinities of antibodies during the immune response</article-title>. <source>Biochemistry</source>. <year>1964</year> <month>Jul</month>;<volume>3</volume>:<fpage>996</fpage>–<lpage>1008</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/14214095" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/14214095</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/bi00895a027" xlink:type="simple">10.1021/bi00895a027</ext-link></comment> <object-id pub-id-type="pmid">14214095</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cooper</surname> <given-names>MD</given-names></name>. <article-title>The early history of B cells</article-title>. <source>Nat Rev Immunol</source>. <year>2015</year> <month>Mar</month>;<volume>15</volume>(<issue>3</issue>):<fpage>191</fpage>–<lpage>197</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nri3801" xlink:type="simple">http://dx.doi.org/10.1038/nri3801</ext-link>. <object-id pub-id-type="pmid">25656707</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doria-Rose</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Schramm</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Gorman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Bhiman</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>DeKosky</surname> <given-names>BJ</given-names></name>, <etal>et al</etal>. <article-title>Developmental pathway for potent V1V2-directed HIV-neutralizing antibodies</article-title>. <source>Nature</source>. <year>2014</year> <day>2</day> <month>Mar</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature13036" xlink:type="simple">http://dx.doi.org/10.1038/nature13036</ext-link>. <object-id pub-id-type="pmid">24590074</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Schramm</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Joyce</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Do Kwon</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Maturation and Diversity of the VRC01-Antibody Lineage over 15 Years of Chronic HIV-1 Infection</article-title>. <source>Cell</source>. <year>2015</year> <day>8</day> <month>Apr</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2015.03.004" xlink:type="simple">http://dx.doi.org/10.1016/j.cell.2015.03.004</ext-link>. <object-id pub-id-type="pmid">25865483</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mascola</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Haynes</surname> <given-names>BF</given-names></name>. <article-title>HIV-1 neutralizing antibodies: understanding nature’s pathways</article-title>. <source>Immunol Rev</source>. <year>2013</year> <month>Jul</month>;<volume>254</volume>(<issue>1</issue>):<fpage>225</fpage>–<lpage>244</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/imr.12075" xlink:type="simple">http://dx.doi.org/10.1111/imr.12075</ext-link>. <object-id pub-id-type="pmid">23772623</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dosenovic</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>von Boehmer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Escolano</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jardine</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Freund</surname> <given-names>NT</given-names></name>, <name name-style="western"><surname>Gitlin</surname> <given-names>AD</given-names></name>, <etal>et al</etal>. <article-title>Immunization for HIV-1 Broadly Neutralizing Antibodies in Human Ig Knockin Mice</article-title>. <source>Cell</source>. <year>2015</year> <day>18</day> <month>Jun</month>;<volume>161</volume>(<issue>7</issue>):<fpage>1505</fpage>–<lpage>1515</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2015.06.003" xlink:type="simple">http://dx.doi.org/10.1016/j.cell.2015.06.003</ext-link>. <object-id pub-id-type="pmid">26091035</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bashford-Rogers</surname> <given-names>RJM</given-names></name>, <name name-style="western"><surname>Palser</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Huntly</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Rance</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vassiliou</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Follows</surname> <given-names>GA</given-names></name>, <etal>et al</etal>. <article-title>Network properties derived from deep sequencing of human B-cell receptor repertoires delineate B-cell populations</article-title>. <source>Genome Res</source>. <year>2013</year> <month>Nov</month>;<volume>23</volume>(<issue>11</issue>):<fpage>1874</fpage>–<lpage>1884</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.154815.113" xlink:type="simple">10.1101/gr.154815.113</ext-link></comment> <object-id pub-id-type="pmid">23742949</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Volpe</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Cowell</surname> <given-names>LG</given-names></name>, <name name-style="western"><surname>Kepler</surname> <given-names>TB</given-names></name>. <article-title>SoDA: implementation of a 3D alignment algorithm for inference of antigen receptor recombinations</article-title>. <source>Bioinformatics</source>. <year>2005</year> <day>15</day> <month>Dec</month>;<volume>22</volume>(<issue>4</issue>):<fpage>438</fpage>–<lpage>444</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btk004" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btk004</ext-link>. <object-id pub-id-type="pmid">16357034</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gaëta</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Malming</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>, <name name-style="western"><surname>Bain</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>. <article-title>iHMMune-align: hidden Markov model-based alignment and identification of germline genes in rearranged immunoglobulin gene sequences</article-title>. <source>Bioinformatics</source>. <year>2007</year> <day>26</day> <month>Apr</month>;<volume>23</volume>(<issue>13</issue>):<fpage>1580</fpage>–<lpage>1587</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm147" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btm147</ext-link>. <object-id pub-id-type="pmid">17463026</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Munshaw</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kepler</surname> <given-names>TB</given-names></name>. <article-title>SoDA2: a Hidden Markov Model approach for identification of immunoglobulin rearrangements</article-title>. <source>Bioinformatics</source>. <year>2010</year> <day>1</day> <month>Apr</month>;<volume>26</volume>(<issue>7</issue>):<fpage>867</fpage>–<lpage>872</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq056" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btq056</ext-link>. <object-id pub-id-type="pmid">20147303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elhanati</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Marcou</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Mora</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Walczak</surname> <given-names>AM</given-names></name>. <article-title>repgenHMM: a dynamic programming tool to infer the rules of immune receptor generation from sequence data</article-title>. <source>Bioinformatics</source>. <year>2016</year> <day>26</day> <month>Feb</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btw112" xlink:type="simple">http://dx.doi.org/10.1093/bioinformatics/btw112</ext-link>. <object-id pub-id-type="pmid">27153709</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref014">
<label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Laserson J. Bayesian assembly of reads from high throughput sequencing. Stanford; 2012. Available from: <ext-link ext-link-type="uri" xlink:href="http://purl.stanford.edu/xp796hy4748" xlink:type="simple">http://purl.stanford.edu/xp796hy4748</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005086.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Laserson</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Vigneault</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gadala-Maria</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Uduman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>High-resolution antibody dynamics of vaccine-induced immune responses</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year> <day>17</day> <month>Mar</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1323862111" xlink:type="simple">http://dx.doi.org/10.1073/pnas.1323862111</ext-link>. <object-id pub-id-type="pmid">24639495</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Neal</surname> <given-names>RM</given-names></name>. <article-title>Markov Chain Sampling Methods for Dirichlet Process Mixture Models</article-title>. <source>J Comput Graph Stat</source>. <year>2000</year> <day>1</day> <month>Jun</month>;<volume>9</volume>(<issue>2</issue>):<fpage>249</fpage>–<lpage>265</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/1390653" xlink:type="simple">http://www.jstor.org/stable/1390653</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005086.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kepler</surname> <given-names>TB</given-names></name>. <article-title>Reconstructing a B-cell clonal lineage. I. Statistical inference of unobserved ancestors</article-title>. <source>F1000Res</source>. <year>2013</year> <day>3</day> <month>Apr</month>;<volume>2</volume>:<fpage>103</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.12688/f1000research.2-103.v1" xlink:type="simple">http://dx.doi.org/10.12688/f1000research.2-103.v1</ext-link>. <object-id pub-id-type="pmid">24555054</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kepler</surname> <given-names>TB</given-names></name>, <name name-style="western"><surname>Munshaw</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wiehe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Woods</surname> <given-names>CW</given-names></name>, <etal>et al</etal>. <article-title>Reconstructing a B-cell Clonal Lineage. II. Mutation, Selection, and Affinity Maturation</article-title>. <source>Front Immunol</source>. <year>2014</year> <day>22</day> <month>Apr</month>;<volume>5</volume>:<fpage>170</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fimmu.2014.00170" xlink:type="simple">http://dx.doi.org/10.3389/fimmu.2014.00170</ext-link>. <object-id pub-id-type="pmid">24795717</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ralph</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names> <suffix>IV</suffix></name>. <article-title>Consistency of VDJ Rearrangement and Substitution Parameters Enables Accurate B Cell Receptor Sequence Annotation</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year> <month>Jan</month>;<volume>12</volume>(<issue>1</issue>):<fpage>e1004409</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004409" xlink:type="simple">http://dx.doi.org/10.1371/journal.pcbi.1004409</ext-link>. <object-id pub-id-type="pmid">26751373</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref020">
<label>20</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mitchison</surname> <given-names>G</given-names></name>. <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>1998</year>. Available from: <ext-link ext-link-type="uri" xlink:href="http://books.google.com/books?id=R5P2GlJvigQC" xlink:type="simple">http://books.google.com/books?id=R5P2GlJvigQC</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/CBO9780511790492" xlink:type="simple">10.1017/CBO9780511790492</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref021">
<label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Rognes T. Github Repository. 2015;Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/torognes/vsearch" xlink:type="simple">https://github.com/torognes/vsearch</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005086.ref022">
<label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Boettiger C. An introduction to Docker for reproducible research, with examples from the R environment. 2014 2 Oct;Available from: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1410.0846" xlink:type="simple">http://arxiv.org/abs/1410.0846</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005086.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jiang</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Weinstein</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Penland</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>RA</given-names> <suffix>3rd</suffix></name>, <name name-style="western"><surname>Fisher</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Quake</surname> <given-names>SR</given-names></name>. <article-title>Determinism and stochasticity during maturation of the zebrafish antibody repertoire</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year> <day>29</day> <month>Mar</month>;<volume>108</volume>(<issue>13</issue>):<fpage>5348</fpage>–<lpage>5353</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1014277108" xlink:type="simple">http://dx.doi.org/10.1073/pnas.1014277108</ext-link>. <object-id pub-id-type="pmid">21393572</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vollmers</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sit</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Weinstein</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Dekker</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Quake</surname> <given-names>SR</given-names></name>. <article-title>Genetic measurement of memory B-cell recall using antibody repertoire sequencing</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2013</year> <day>13</day> <month>Aug</month>;<volume>110</volume>(<issue>33</issue>):<fpage>13463</fpage>–<lpage>13468</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1312146110" xlink:type="simple">http://dx.doi.org/10.1073/pnas.1312146110</ext-link>. <object-id pub-id-type="pmid">23898164</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stern</surname> <given-names>JNH</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Church</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Donahue</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Hintzen</surname> <given-names>RQ</given-names></name>, <etal>et al</etal>. <article-title>B cells populating the multiple sclerosis brain mature in the draining cervical lymph nodes</article-title>. <source>Sci Transl Med</source>. <year>2014</year> <day>6</day> <month>Aug</month>;<volume>6</volume>(<issue>248</issue>):<fpage>248.a107</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/scitranslmed.3008879" xlink:type="simple">http://dx.doi.org/10.1126/scitranslmed.3008879</ext-link>. <object-id pub-id-type="pmid">25100741</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Benichou</surname> <given-names>JIC</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Kleinstein</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Louzoun</surname> <given-names>Y</given-names></name>. <article-title>The mutation patterns in B-cell immunoglobulin receptors reflect the influence of selection acting at multiple time-scales</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2015</year> <day>5</day> <month>Sep</month>;<volume>370</volume> (<issue>1676</issue>). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2014.0242" xlink:type="simple">http://dx.doi.org/10.1098/rstb.2014.0242</ext-link>. <object-id pub-id-type="pmid">26194756</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gupta</surname> <given-names>NT</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Uduman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gadala-Maria</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kleinstein</surname> <given-names>SH</given-names></name>. <article-title>Change-O: a toolkit for analyzing large-scale B cell immunoglobulin repertoire sequencing data</article-title>. <source>Bioinformatics</source>. <year>2015</year> <day>10</day> <month>Jun</month>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv359" xlink:type="simple">10.1093/bioinformatics/btv359</ext-link></comment> <object-id pub-id-type="pmid">26069265</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bolotin</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Poslavsky</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mitrophanov</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Shugay</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mamedov</surname> <given-names>IZ</given-names></name>, <name name-style="western"><surname>Putintseva</surname> <given-names>EV</given-names></name>, <etal>et al</etal>. <article-title>MiXCR: software for comprehensive adaptive immunity profiling</article-title>. <source>Nat Methods</source>. <year>2015</year> <day>29</day> <month>Apr</month>;<volume>12</volume>(<issue>5</issue>):<fpage>380</fpage>–<lpage>381</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3364" xlink:type="simple">10.1038/nmeth.3364</ext-link></comment> <object-id pub-id-type="pmid">25924071</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref029">
<label>29</label>
<mixed-citation publication-type="other" xlink:type="simple">DeWitt WS, Lindau P, Snyder TM, Emerson RO, Sherwood AM, Vignali M, et al. A public immunosequencing database of memory and naïve B cell receptors; 2015.</mixed-citation>
</ref>
<ref id="pcbi.1005086.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McCoy</surname> <given-names>CO</given-names></name>, <name name-style="western"><surname>Bedford</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Minin</surname> <given-names>VN</given-names></name>, <name name-style="western"><surname>Bradley</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Robins</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names> <suffix>IV</suffix></name>. <article-title>Quantifying evolutionary constraints on B-cell affinity maturation</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2015</year> <day>5</day> <month>Sep</month>;<volume>370</volume> (<issue>1676</issue>). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2014.0244" xlink:type="simple">http://dx.doi.org/10.1098/rstb.2014.0244</ext-link>. <object-id pub-id-type="pmid">26194758</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elhanati</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sethna</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Marcou</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Callan</surname> <given-names>CG</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Mora</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Walczak</surname> <given-names>AM</given-names></name>. <article-title>Inferring processes underlying B-cell repertoire diversity</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2015</year> <day>5</day> <month>Sep</month>;<volume>370</volume> (<issue>1676</issue>). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2014.0243" xlink:type="simple">http://dx.doi.org/10.1098/rstb.2014.0243</ext-link>. <object-id pub-id-type="pmid">26194757</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuchenbecker</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Nienen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hecht</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Neumann</surname> <given-names>AU</given-names></name>, <name name-style="western"><surname>Babel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Reinert</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>IMSEQ—a fast and error aware approach to immunogenetic sequence analysis</article-title>. <source>Bioinformatics</source>. <year>2015</year> <day>18</day> <month>May</month>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv309" xlink:type="simple">10.1093/bioinformatics/btv309</ext-link></comment> <object-id pub-id-type="pmid">25987567</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bonsignori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hwang</surname> <given-names>KK</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Tsao</surname> <given-names>CY</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Analysis of a clonal lineage of HIV-1 envelope V2/V3 conformational epitope-specific broadly neutralizing antibodies and their inferred unmutated common ancestors</article-title>. <source>J Virol</source>. <year>2011</year> <month>Oct</month>;<volume>85</volume>(<issue>19</issue>):<fpage>9998</fpage>–<lpage>10009</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.05045-11" xlink:type="simple">http://dx.doi.org/10.1128/JVI.05045-11</ext-link>. <object-id pub-id-type="pmid">21795340</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liao</surname> <given-names>HX</given-names></name>, <name name-style="western"><surname>Lynch</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Alam</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Boyd</surname> <given-names>SD</given-names></name>, <etal>et al</etal>. <article-title>Co-evolution of a broadly neutralizing HIV-1 antibody and founder virus</article-title>. <source>Nature</source>. <year>2013</year> <day>25</day> <month>Apr</month>;<volume>496</volume>(<issue>7446</issue>):<fpage>469</fpage>–<lpage>476</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12053" xlink:type="simple">http://dx.doi.org/10.1038/nature12053</ext-link>. <object-id pub-id-type="pmid">23552890</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gao</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bonsignori</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Liao</surname> <given-names>HX</given-names></name>, <name name-style="western"><surname>Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Xia</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Cooperation of B Cell Lineages in Induction of HIV-1-Broadly Neutralizing Antibodies</article-title>. <source>Cell</source>. <year>2014</year> <day>23</day> <month>Jul</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.06.022" xlink:type="simple">http://dx.doi.org/10.1016/j.cell.2014.06.022</ext-link>. <object-id pub-id-type="pmid">25065977</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Gaëta</surname> <given-names>BA</given-names></name>. <article-title>Clustering-based identification of clonally-related immunoglobulin gene sequence sets</article-title>. <source>Immunome Res</source>. <year>2010</year> <day>27</day> <month>Sep</month>;<volume>6</volume> <issue>Suppl 1</issue>:<fpage>S4</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1745-7580-6-S1-S4" xlink:type="simple">http://dx.doi.org/10.1186/1745-7580-6-S1-S4</ext-link>. <object-id pub-id-type="pmid">20875155</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frost</surname> <given-names>SDW</given-names></name>, <name name-style="western"><surname>Murrell</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hossain</surname> <given-names>ASMM</given-names></name>, <name name-style="western"><surname>Silverman</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Pond</surname> <given-names>SLK</given-names></name>. <article-title>Assigning and visualizing germline genes in antibody repertoires</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2015</year> <day>5</day> <month>Sep</month>;<volume>370</volume> (<issue>1676</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2014.0240" xlink:type="simple">10.1098/rstb.2014.0240</ext-link></comment> <object-id pub-id-type="pmid">26194754</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Volpe</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Kepler</surname> <given-names>TB</given-names></name>. <article-title>Large-scale analysis of human heavy chain V(D)J recombination patterns</article-title>. <source>Immunome Res</source>. <year>2008</year> <day>27</day> <month>Feb</month>;<volume>4</volume>:<fpage>3</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1745-7580-4-3" xlink:type="simple">http://dx.doi.org/10.1186/1745-7580-4-3</ext-link>. <object-id pub-id-type="pmid">18304322</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kidd</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>, <name name-style="western"><surname>Boyd</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>. <article-title>DJ Pairing during VDJ Recombination Shows Positional Biases That Vary among Individuals with Differing IGHD Locus Immunogenotypes</article-title>. <source>J Immunol</source>. <year>2015</year> <day>23</day> <month>Dec</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4049/jimmunol.1501401" xlink:type="simple">http://dx.doi.org/10.4049/jimmunol.1501401</ext-link>. <object-id pub-id-type="pmid">26700767</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Saada</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Weinberger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Shahaf</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mehr</surname> <given-names>R</given-names></name>. <article-title>Models for antigen receptor gene rearrangement: CDR3 length</article-title>. <source>Immunol Cell Biol</source>. <year>2007</year> <day>3</day> <month>Apr</month>;<volume>85</volume>(<issue>4</issue>):<fpage>323</fpage>–<lpage>332</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/sj.icb.7100055" xlink:type="simple">http://dx.doi.org/10.1038/sj.icb.7100055</ext-link>. <object-id pub-id-type="pmid">17404591</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kepler</surname> <given-names>TB</given-names></name>, <name name-style="western"><surname>Borrero</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rugerio</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>McCray</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Clarke</surname> <given-names>SH</given-names></name>. <article-title>Interdependence of N nucleotide addition and recombination site choice in V(D)J rearrangement</article-title>. <source>The Journal of Immunology</source>. <year>1996</year> <day>15</day> <month>Nov</month>;<volume>157</volume>(<issue>10</issue>):<fpage>4451</fpage>–<lpage>4457</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.jimmunol.org/content/157/10/4451.abstract" xlink:type="simple">http://www.jimmunol.org/content/157/10/4451.abstract</ext-link>. <object-id pub-id-type="pmid">8906821</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>, <name name-style="western"><surname>Gaëta</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>. <article-title>Identifying highly mutated IGHD genes in the junctions of rearranged human immunoglobulin heavy chain genes</article-title>. <source>J Immunol Methods</source>. <year>2007</year> <day>15</day> <month>May</month>;<volume>324</volume>(<issue>1–2</issue>):<fpage>26</fpage>–<lpage>37</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jim.2007.04.011" xlink:type="simple">http://dx.doi.org/10.1016/j.jim.2007.04.011</ext-link>. <object-id pub-id-type="pmid">17553518</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Larimore</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>McCormick</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Robins</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Greenberg</surname> <given-names>PD</given-names></name>. <article-title>Shaping of human germline IgH repertoires revealed by deep sequencing</article-title>. <source>J Immunol</source>. <year>2012</year> <day>3</day> <month>Aug</month>;<volume>189</volume>(<issue>6</issue>):<fpage>3221</fpage>–<lpage>3230</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4049/jimmunol.1201303" xlink:type="simple">http://dx.doi.org/10.4049/jimmunol.1201303</ext-link>. <object-id pub-id-type="pmid">22865917</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sutton</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>McCallum</surname> <given-names>A</given-names></name>. <article-title>An Introduction to Conditional Random Fields</article-title>. <source>Foundations and Trends in Machine Learning</source>. <year>2011</year>;<volume>4</volume>(<issue>4</issue>):<fpage>267</fpage>–<lpage>373</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1561/2200000013" xlink:type="simple">http://dx.doi.org/10.1561/2200000013</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005086.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gadala-Maria</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Uduman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kleinstein</surname> <given-names>SH</given-names></name>. <article-title>Automated analysis of high-throughput B-cell sequencing data reveals a high frequency of novel immunoglobulin V gene segment alleles</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2015</year> <day>9</day> <month>Feb</month>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1417683112" xlink:type="simple">10.1073/pnas.1417683112</ext-link></comment> <object-id pub-id-type="pmid">25675496</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref046">
<label>46</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Siepel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Haussler</surname> <given-names>D</given-names></name>. <chapter-title>Phylogenetic Hidden Markov Models</chapter-title>. In: <source>Statistical Methods in Molecular Evolution. Statistics for Biology and Health</source>. <publisher-name>Springer</publisher-name> <publisher-loc>New York</publisher-loc>; <year>2005</year>. p. <fpage>325</fpage>–<lpage>351</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/chapter/10.1007/0-387-27733-1_12" xlink:type="simple">http://link.springer.com/chapter/10.1007/0-387-27733-1_12</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005086.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>YJ</given-names></name>, <name name-style="western"><surname>Banchereau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pascual</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Capra</surname> <given-names>JD</given-names></name>. <article-title>Receptor revision of immunoglobulin heavy chain variable region genes in normal human B lymphocytes</article-title>. <source>J Exp Med</source>. <year>2000</year> <day>5</day> <month>Jun</month>;<volume>191</volume>(<issue>11</issue>):<fpage>1881</fpage>–<lpage>1894</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/10839804" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/10839804</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1084/jem.191.11.1881" xlink:type="simple">10.1084/jem.191.11.1881</ext-link></comment> <object-id pub-id-type="pmid">10839804</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>DeKosky</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Ippolito</surname> <given-names>GC</given-names></name>, <name name-style="western"><surname>Deschner</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Lavinder</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Wine</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Rawlings</surname> <given-names>BM</given-names></name>, <etal>et al</etal>. <article-title>High-throughput sequencing of the paired human immunoglobulin heavy and light chain repertoire</article-title>. <source>Nat Biotechnol</source>. <year>2013</year> <month>Feb</month>;<volume>31</volume>(<issue>2</issue>):<fpage>166</fpage>–<lpage>169</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2492" xlink:type="simple">http://dx.doi.org/10.1038/nbt.2492</ext-link>. <object-id pub-id-type="pmid">23334449</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McDaniel</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>DeKosky</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Tanno</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ellington</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Georgiou</surname> <given-names>G</given-names></name>. <article-title>Ultra-high-throughput sequencing of the immune receptor repertoire from millions of lymphocytes</article-title>. <source>Nat Protoc</source>. <year>2016</year> <month>Mar</month>;<volume>11</volume>(<issue>3</issue>):<fpage>429</fpage>–<lpage>442</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nprot.2016.024" xlink:type="simple">http://dx.doi.org/10.1038/nprot.2016.024</ext-link>. <object-id pub-id-type="pmid">26844430</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Price</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Dehal</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>AP</given-names></name>. <article-title>FastTree 2–approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>e9490</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.plos.org/10.1371/journal.pone.0009490.g003" xlink:type="simple">http://dx.plos.org/10.1371/journal.pone.0009490.g003</ext-link>. <object-id pub-id-type="pmid">20224823</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goldman</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Rodrigo</surname> <given-names>AG</given-names></name>. <article-title>Likelihood-Based Tests of Topologies in Phylogenetics</article-title>. <source>Syst Biol</source>. <year>2000</year> <month>Dec</month>;<volume>49</volume>(<issue>4</issue>):<fpage>652</fpage>–<lpage>670</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/106351500750049752" xlink:type="simple">http://dx.doi.org/10.1080/106351500750049752</ext-link>. <object-id pub-id-type="pmid">12116432</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stadler</surname> <given-names>T</given-names></name>. <article-title>Simulating trees with a fixed number of extant species</article-title>. <source>Syst Biol</source>. <year>2011</year> <month>Oct</month>;<volume>60</volume>(<issue>5</issue>):<fpage>676</fpage>–<lpage>684</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syr029" xlink:type="simple">http://dx.doi.org/10.1093/sysbio/syr029</ext-link>. <object-id pub-id-type="pmid">21482552</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005086.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>J</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>B</surname> <given-names>B</given-names></name>. <article-title>Non-homogeneous models of sequence evolution in the Bio++ suite of libraries and programs</article-title>. <source>BMC Evol Biol</source>. <year>2008</year> <month>Sep</month>;<volume>8</volume>(<issue>1</issue>):<fpage>255</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2148-8-255" xlink:type="simple">10.1186/1471-2148-8-255</ext-link></comment> <object-id pub-id-type="pmid">18808672</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>