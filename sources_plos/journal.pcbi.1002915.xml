<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00961</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1002915</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
          </subj-group>
          <subj-group>
            <subject>Ecology</subject>
            <subj-group>
              <subject>Behavioral ecology</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Systems biology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computational Biology</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Collective States, Multistability and Transitional Behavior in Schooling Fish</article-title>
        <alt-title alt-title-type="running-head">Collective States in Schooling Fish</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Tunstrøm</surname>
            <given-names>Kolbjørn</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Katz</surname>
            <given-names>Yael</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ioannou</surname>
            <given-names>Christos C.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Huepe</surname>
            <given-names>Cristián</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Lutz</surname>
            <given-names>Matthew J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Couzin</surname>
            <given-names>Iain D.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Department of Ecology and Evolutionary Biology, Princeton University, Princeton, New Jersey, United States of America</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>School of Biological Sciences, University of Bristol, Bristol, United Kingdom</addr-line>
      </aff>
      <aff id="aff3">
        <label>3</label>
        <addr-line>Cristian Huepe Labs Inc., Chicago, Illinois, United States of America</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Ben-Jacob</surname>
            <given-names>Eshel</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>Tel Aviv University, Israel</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">tunstrom@princeton.edu</email> (KT); <email xlink:type="simple">icouzin@princeton.edu</email> (IDC)</corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: YK IDC. Performed the experiments: YK CCI MJL IDC. Analyzed the data: KT YK CCI CH IDC. Wrote the paper: KT CCI CH IDC.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>2</month>
        <year>2013</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>28</day>
        <month>2</month>
        <year>2013</year>
      </pub-date>
      <volume>9</volume>
      <issue>2</issue>
      <elocation-id>e1002915</elocation-id>
      <history>
        <date date-type="received">
          <day>12</day>
          <month>6</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>21</day>
          <month>12</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2013</copyright-year>
        <copyright-holder>Tunstrom et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>The spontaneous emergence of pattern formation is ubiquitous in nature, often arising as a collective phenomenon from interactions among a large number of individual constituents or sub-systems. Understanding, and controlling, collective behavior is dependent on determining the low-level dynamical principles from which spatial and temporal patterns emerge; a key question is whether different group-level patterns result from all components of a system responding to the same external factor, individual components changing behavior but in a distributed self-organized way, or whether multiple collective states co-exist for the same individual behaviors. Using schooling fish (golden shiners, in groups of 30 to 300 fish) as a model system, we demonstrate that collective motion can be effectively mapped onto a set of order parameters describing the macroscopic group structure, revealing the existence of at least three dynamically-stable collective states; swarm, milling and polarized groups. Swarms are characterized by slow individual motion and a relatively dense, disordered structure. Increasing swim speed is associated with a transition to one of two locally-ordered states, milling or highly-mobile polarized groups. The stability of the discrete collective behaviors exhibited by a group depends on the number of group members. Transitions between states are influenced by both external (boundary-driven) and internal (changing motion of group members) factors. Whereas transitions between locally-disordered and locally-ordered group states are speed dependent, analysis of local and global properties of groups suggests that, congruent with theory, milling and polarized states co-exist in a bistable regime with transitions largely driven by perturbations. Our study allows us to relate theoretical and empirical understanding of animal group behavior and emphasizes dynamic changes in the structure of such groups.</p>
      </abstract>
      <abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>The patterns exhibited by moving animal groups like flocks of birds and schools of fish are typical of self-organizing systems in which global structural and dynamical properties arise from local interactions between individuals. Despite their apparent complexity, such systems can often be described, and understood, in terms of these emergent properties, rather than the detailed low-level description needed for depicting the individual dynamics. Here we show that schooling fish (in groups of 30 to 300 golden shiners) can be described in terms of the degree of alignment and degree of rotation among group members. We demonstrate that shiner schools exhibit three distinct behaviors: a swarm state with low speeds and little order; a strongly aligned state where the fish move with higher speeds; and a milling state, where each fish moves around the center of the group. Simulations have previously predicted this type of behavior, and we relate our findings to a well-known model of collective motion to help highlight similarities and differences between models and animal groups. Our results give insight into the regulation of group structure among animals, and also inform us generally about how global structures arise naturally from interactions among components of dynamical systems.</p>
      </abstract>
      <funding-group>
        <funding-statement>KT acknowledges the Research Council of Norway. YK acknowledges the National Science Foundation (NSF) Postdoctoral Fellowship in Biological Informatics (0905970). CH and IDC acknowledge NSF Grant PHY-0848755. IDC also acknowledges Searle Scholar Award 08-SPP- 201, Defense Advanced Research Projects Agency Grant HR0011-05-1-0057 to Princeton University, Office of Naval Research Award N00014-09-1-1074 and Army Research Office Grant W911NG-11-1-0385. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="11"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Many animal groups display coordinated motion in which individuals exhibit attraction towards others and also a tendency to align their direction of travel with near-neighbors <xref ref-type="bibr" rid="pcbi.1002915-Couzin1">[1]</xref>. The functional complexity of such aggregates are thought to result from relatively local, self-organizing interactions among individuals that endow many groups, such as flocking birds and schooling fish, with the capacity to move, respond to threats and make decisions collectively <xref ref-type="bibr" rid="pcbi.1002915-Sumpter1">[2]</xref>. Thus the way in which collective dynamics emerge from inter-individual social interactions likely has profound consequences on the selection pressures experienced by group living organisms.</p>
      <p>Theoretical considerations of the self-structuring properties of groups have suggested that certain features of interaction among individuals may give rise to a relatively small number of specific collective states <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1002915-Biggs1">[7]</xref>. For example, models representing local repulsion, directional alignment and longer-range attraction among individuals <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Gautrais1">[5]</xref> predict that groups in which individuals follow these behavioral rules exhibit only three collective states; a <italic>swarm</italic> state in which individuals aggregate but are locally and globally disordered, a <italic>milling</italic> state in which individuals have a high degree of alignment with local neighbors but overall the group exhibits a rotating milling formation (or torus, in three-dimensional space) and a <italic>polarized</italic> state in which individuals tend to be aligned with each other over a long range and consequently the group experiences net movement. While these patterns have all been observed in nature among different organisms <xref ref-type="bibr" rid="pcbi.1002915-Parrish1">[8]</xref> and can evolve in simulations of simple predator and prey behaviour <xref ref-type="bibr" rid="pcbi.1002915-Wood1">[9]</xref>, experimental support for the existence of these states, and for any one system transitioning between them, has not previously been determined.</p>
      <p>In addition to displaying commonly observed group structures these models also emphasize an important unifying feature—that collectively moving animal groups can be considered as a dynamical system in which multiple group states, or dynamically-stable states, exist, and that collective properties, such as the spatio-temporal configurations exhibited, may be robust to exactly how behavioral tendencies such as repulsion, alignment and attraction are mediated. Furthermore, under this scenario, animal groups are also predicted to exhibit ‘multistability’ whereby more than one collective state coexist for identical individual behavior, with groups transitioning relatively quickly between the alternate structural configurations. In the model of Couzin et al. <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>, for example, the milling and polarized state co-exist over a region of parameter space (see Paley et al. <xref ref-type="bibr" rid="pcbi.1002915-Paley1">[10]</xref> for a formal analysis of this bistable regime). The question of which collective behavior is adopted therefore depends on the initial configuration of the system, in this case the positions and orientations of individuals: if groups start in a relatively disordered state they tend to form a milling formation; but tend to remain in the polarized configuration if they begin sufficiently aligned with one another. Perturbations, such as disruption induced by predator attacks <xref ref-type="bibr" rid="pcbi.1002915-Couzin1">[1]</xref>, or more generally, sources of intrinsic <xref ref-type="bibr" rid="pcbi.1002915-Kolpas1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Yates1">[12]</xref> or extrinsic noise <xref ref-type="bibr" rid="pcbi.1002915-Grgoire1">[13]</xref>, can cause the system to leave its existing dynamically-stable state and enter an unstable transitional regime. Depending on the degree and type of perturbation the group may find itself either drawn back towards the previous state, or if perturbed sufficiently far, to be drawn into the alternative dynamically-stable state.</p>
      <p>Thus even though the group behavior results from a large number of relatively local interactions, the group-level dynamics can be described using relatively few and simple lower-dimensional ‘order parameters’ that portray the collective dynamics, such as global polarization and the degree of collective rotation. This approach is familiar to us in physical systems where a multitude of different inter-molecular interactions result in only four fundamental states of matter; solid, liquid, gas and plasma. When properties such as density and energy are altered, a physical system can undergo ‘phase transitions’ between these states. Similarly, at a certain level of description, we can view animal groups as having the potential to exhibit abrupt changes in spatial or temporal patterns, and thus phase transition-like behavior (see Buhl et al. <xref ref-type="bibr" rid="pcbi.1002915-Buhl1">[14]</xref> for an experimental example of density-driven transitions in locust swarms).</p>
      <p>However, biological systems are not in equilibrium. There are no conserved thermodynamic quantities, such as momentum and energy, and individual motion typically results not from thermal fluctuations or external forcing, but from individual self-propulsion and decision-making. Nevertheless, the concept that local interactions reduce to common non-equilibrium collective states is a key insight provided by computational modeling of collective animal behavior <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Dorsogna1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Vicsek1">[15]</xref> which relates more generally to phase transition theory in non-equilibrium systems <xref ref-type="bibr" rid="pcbi.1002915-Schner1">[16]</xref>. Additionally, despite individual motion likely being governed by a complex stochastic decision-making process based on the positions, movement and size of neighbors (and even hidden features like individual's state), two recent studies of schooling fish—Katz et al. <xref ref-type="bibr" rid="pcbi.1002915-Katz1">[17]</xref> and Herbert-Read et al. <xref ref-type="bibr" rid="pcbi.1002915-HerbertRead1">[18]</xref>—demonstrate that interactions can be effectively reduced to local tendencies to be repelled from, or attracted towards, neighbors. Similar evidence exists for aggregating ducks <xref ref-type="bibr" rid="pcbi.1002915-Lukeman1">[19]</xref> and swarming locusts <xref ref-type="bibr" rid="pcbi.1002915-Romanczuk1">[20]</xref>.</p>
      <p>Despite these advances, to date, no experimental study has quantified the dynamical states of collective motion exhibited by any species of group-living animal, nor determined whether the general predictions of existing models of collective behavior hold—notably, that groups will exhibit, and transition among, relatively few (dynamically-stable) states. Here we investigate the emergence of macroscopic collective states under highly controlled laboratory conditions using schooling fish (golden shiner, <italic>Notemigonus crysoleucas</italic>). This is a convenient model system for investigating collective behavior since individuals are relatively small (average length approximately 5 cm in our study), and naturally form highly cohesive schools in very shallow and still water <xref ref-type="bibr" rid="pcbi.1002915-Whittier1">[21]</xref>. Digital tracking of fish in a range of group sizes (from 30 to 300 fish) allows us to obtain detailed data regarding the individual positions and velocities of schooling fish over long periods of time. We use these data to analyze how group size and perturbations (driven both by inevitable contact with the boundary of the tank, but also by changes in motion by individuals within the group in the absence of boundary influence) affect group behavior and function to transition the group between alternative dynamical states.</p>
    </sec>
    <sec id="s2">
      <title>Results/Discussion</title>
      <p>Seven replicate experiments were conducted for group sizes 30, 70 and 150 fish, and three replicates were conducted for 300 fish (due to limitations in our capacity to house very large numbers of fish). Each replicate consisted of filming fish swimming in a large shallow tank (2.1 m×1.2 m, water depth 5 cm) for 56 minutes (at 30 frames per second). A similar approach has been taken previously <xref ref-type="bibr" rid="pcbi.1002915-Katz1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-HerbertRead1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Radakov1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Becco1">[23]</xref>. Individual fish were tracked following the methodology of Katz et al. <xref ref-type="bibr" rid="pcbi.1002915-Katz1">[17]</xref> to obtain time series of the positions and velocities. These time series constitute the raw data from which we base our analyses.</p>
      <p>To describe the collective structure of the fish shoals we use two order parameters, identical to previous categorization in simulation models <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Kolpas1">[11]</xref>. First, the polarization order parameter <italic>O<sub>p</sub></italic>, which provides a measure of how aligned the individuals in a group are. It is defined as the absolute value of the mean individual heading,<disp-formula id="pcbi.1002915.e001"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002915.e001" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002915.e002" xlink:type="simple"/></inline-formula> is the unit direction of fish number <italic>i</italic>. <italic>O<sub>p</sub></italic> takes values between 0 (no alignment on average) and 1 (all fish are aligned). Second, the rotation order parameter <italic>O<sub>r</sub></italic>, which describes a group's degree of rotation about its center of mass. To define this measure we introduce the unit vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002915.e003" xlink:type="simple"/></inline-formula> pointing from the shoal's center of mass towards fish <italic>i</italic>. The rotation order parameter <italic>O<sub>r</sub></italic> is then defined by the mean (normalized) angular momentum<disp-formula id="pcbi.1002915.e004"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002915.e004" xlink:type="simple"/></disp-formula>which, by construction also takes values between 0 (no rotation) and 1 (strong rotation).</p>
      <p>Time series of these two order parameters give us valuable information about the global structure of a group and how the structure changes during an experiment. However, important pieces of information are not captured, like the group density, the average individual speed, and how close a group swims to the tank boundary. For a fuller picture of the collective dynamics, we will also use these order parameters. Other group properties could also be measured.</p>
      <sec id="s2a">
        <title>Collective states exhibited and the role of group size</title>
        <p>Throughout our entire period of filming the fish were cohesive, and for all group sizes three dynamically-stable collective behaviors were observed <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>; the <italic>swarm</italic> (S), <italic>polarized</italic> (P) and <italic>milling</italic> (M) group state. Snapshots of these distinct patterns are shown in <xref ref-type="fig" rid="pcbi-1002915-g001">Fig. 1A</xref> for a group of 150 fish (<xref ref-type="supplementary-material" rid="pcbi.1002915.s013">Videos S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s014">S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s015">S3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s016">S4</xref> contain video extracts of all group sizes). As in <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>, these separate modes of motion can be categorized by only two structural properties (order parameters) of the group—its polarization <italic>O<sub>p</sub></italic> and its degree of collective rotation <italic>O<sub>r</sub></italic>. Groups repeatedly transitioned between these collective states, as is evident in representative time series of the order parameters shown in <xref ref-type="fig" rid="pcbi-1002915-g001">Fig. 1B</xref>.</p>
        <fig id="pcbi-1002915-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002915.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Dynamical states of schooling fish.</title>
            <p>(<italic>A</italic>) Snapshots of a group of 150 golden shiners swimming in a shallow tank. The different images (thresholded for clarity) demonstrate the typical configurations displayed by the fish school: swarm state (S), polarized state (P) and milling state (M). (<italic>B</italic>) Extracts of time series of order parameters for groups of 30, 70, 150, and 300 golden shiners. Polarization <italic>O<sub>p</sub></italic> (in blue) measures how aligned the fish are, while rotation <italic>O<sub>r</sub></italic> (in red) measures the degree of rotation around the center of mass of the fish shoal.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002915.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>To demonstrate more clearly these dynamically-stable states, in <xref ref-type="fig" rid="pcbi-1002915-g002">Fig. 2</xref> we consider the proportion of time groups spend in different regions of the two-dimensional phase space spanned by the order parameters <italic>O<sub>p</sub></italic> and <italic>O<sub>r</sub></italic> (red representing more time spent in a given region and blue the least time; black areas signify regions of the phase space not visited by groups in our experiments). While all three states of motion were manifest in all groups, there are also visible differences relating to increasing group size. For the smallest group size of 30 fish we see that the polarized group state predominates (high <italic>O<sub>p</sub></italic> and low <italic>O<sub>r</sub></italic>). Only rarely did groups of this size exhibit swarm behavior (low <italic>O<sub>p</sub></italic> and low <italic>O<sub>r</sub></italic>), and even less frequently did they adopt the rotating group state (low <italic>O<sub>p</sub></italic> and high <italic>O<sub>r</sub></italic>). The fluctuations in the order parameters are also most frequent for this group size (<xref ref-type="fig" rid="pcbi-1002915-g001">Fig. 1B</xref>). For a group size of 70 fish the frequency of transitions decreases and the collective states corresponding to the three dynamically-stable states become clearly distinguishable as ‘hotspots’: the polarized state is no longer dominant, with milling and swarm behavior also being common. As group size is increased further, to 150 and then 300 fish, groups spend most of their time milling, displaying fewer transitions into (and among) the polar state and swarm state. For all group sizes the milling state has an equal probability of rotating clockwise and counter-clockwise, i.e. groups did not exhibit a handedness (see <xref ref-type="supplementary-material" rid="pcbi.1002915.s001">Fig. S1</xref>).</p>
        <fig id="pcbi-1002915-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002915.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Density plots of polarization vs. rotation from experiments.</title>
            <p>The data shown are averaged over all replicates for each of the groups of 30, 70, 150, and 300 golden shiners. The order parameter space is divided into four regions—swarm (S), polarized (P), milling (M), and transition (T)—each being characterized by the dominant dynamical state of the fish school in that particular region. Different values of p<sub>min</sub> and p<sub>max</sub> were used for each group size to emphasize the density patterns and regions with no data are colored black. The insert in the 30 fish plot shows the density plot from an experiment with 30 fish and the tank area reduced to one tenth of the original.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002915.g002" position="float" xlink:type="simple"/>
        </fig>
        <p>A natural consequence of increasing the number of fish in the tank is that the mean density within the experimental arena becomes higher, and hence the effects of the tank boundary become more pronounced. To reveal whether the higher density of fish per tank area in larger groups could cause the increased stability of the milling state we performed an experiment (4 replicates) with 30 fish in a smaller tank (0.66×0.38 m), which corresponds to the mean density of 300 fish in the larger tank. The density plot of the order parameters is shown as an inset in the 30 fish density plot in <xref ref-type="fig" rid="pcbi-1002915-g002">Fig. 2</xref>, and reveals that confinement by the boundaries and higher mean density do not lead to increased time spent milling. However, the time spent in the polarized state was reduced; contact with the smaller tank caused this group size to exhibit more frequent transitions to the swarm state than when it was in the larger tank. At least for the 30 fish, and possibly as a general result, the presence of the boundary does not increase the stability of the milling state per se. Rather, the stability of milling is largely determined by the size of the group. Although the functional reason for milling is not yet known, it does, however, allow individuals to be locally polarized, which could be important for information transfer, while allowing the group to remain in a specific area. Swarm behavior allows the group to remain in an area but is locally disordered and this may be more susceptible to predation <xref ref-type="bibr" rid="pcbi.1002915-Couzin1">[1]</xref>.</p>
        <p>To gain further understanding of the relationship between group size and the stability of the different group structures we employed the canonical model of grouping of Couzin et al. <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>, in which there are no boundary interactions. Exploring the collective behavior of simulated individuals (see <xref ref-type="sec" rid="s3">Methods</xref> for simulation set up and details) we find that the model produces qualitatively similar results across the range of group size in our experiments (30, 70, 150 and 300 agents), with the polarized states being dominant for the smallest group size, and an increasing proportion of the group's time is spent in the milling state as group size increases (see <xref ref-type="fig" rid="pcbi-1002915-g003">Fig. 3</xref>).</p>
        <fig id="pcbi-1002915-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002915.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Density plots of polarization vs. rotation from simulations.</title>
            <p>The data shown are from simulations with 30, 70, 150, and 300 agents, employing a constant-speed agent based simulation model of collective behavior where no boundary is present (See <xref ref-type="sec" rid="s3">Methods</xref> for simulation details). Regions with no data are colored black. As for the experimental data, the milling state grows in stability with group size.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002915.g003" position="float" xlink:type="simple"/>
        </fig>
        <p>Another aspect of group size is the self-regulation of density. Theoretically, when more members are added to a group of self-propelled particles, the density can either remain approximately constant, in which case the system is H-stable, or the density can increase, and the system is catastrophic <xref ref-type="bibr" rid="pcbi.1002915-Dorsogna1">[4]</xref>. In our experiments, the individuals within the group regulate their spacing such that density tends to remain stable regardless of group size. The mean area occupied by the fish grows approximately linearly with group size and the packing fraction (and density) remains nearly constant (See <xref ref-type="supplementary-material" rid="pcbi.1002915.s002">Fig. S2</xref>). This regulatory behavior places the fish in the category of H-stable systems.</p>
      </sec>
      <sec id="s2b">
        <title>Transitions between collective states</title>
        <p>To quantify the relation between group size and collective state we need to explicitly define the different states. Given the relatively clear demarcation of states revealed by our data in <xref ref-type="fig" rid="pcbi-1002915-g002">Fig. 2</xref> we employed a simple approach in which we discretize the phase space in terms of the order parameters. The specific range of values were motivated by the high-density regions observed in <xref ref-type="fig" rid="pcbi-1002915-g002">Fig. 2</xref>. We thus define that the school is in: the polar state (P) when O<sub>p</sub>&gt;0.65 and O<sub>r</sub>&lt;0.35; the milling state (M) when O<sub>p</sub>&lt;0.35 and O<sub>r</sub>&gt;0.65; and the swarm state (S) when O<sub>p</sub>&lt;0.35 and O<sub>r</sub>&lt;0.35. Outside these ranges we define the system to be in a transitional regime (T). On average, therefore, each region is characterized by the dominant dynamical state of the fish school within that particular region. The regions defining the dynamical states are overlaid the density plots in <xref ref-type="fig" rid="pcbi-1002915-g002">Fig. 2</xref> (the qualitative nature of our results does not depend on the precise nature of how these regions are defined, see <xref ref-type="supplementary-material" rid="pcbi.1002915.s003">Fig. S3</xref>).</p>
        <p>As shown in <xref ref-type="fig" rid="pcbi-1002915-g001">Fig. 1B</xref>, groups frequently transitioned between the three collective states. A transition is considered completed if the group moves from one of the three states to another. By this definition, a school can move from one of the dynamical states, into the transition region, and then back to its previous state, without having undergone a transition. We quantify, statistically, the transitions between states and investigate how the transition patterns depend on the group size.</p>
        <p>As we previously saw in <xref ref-type="fig" rid="pcbi-1002915-g002">Fig. 2</xref>, the proportion of time spent in the polarized state decreases strongly with group size from 0.57 to 0.26, 0.18 and 0.05 (30 to 300 fish shoals, respectively, light blue columns in <xref ref-type="fig" rid="pcbi-1002915-g004">Fig. 4A</xref>). Likewise, the proportion of time in the milling state increases with group size from 0.03 to 0.18, 0.36 and 0.45 (yellow columns <xref ref-type="fig" rid="pcbi-1002915-g004">Fig. 4A</xref>). The group size has however little effect on the proportion of time spent in the swarm state or in the transition region, which varies between 0.09 and 0.11 (dark blue columns <xref ref-type="fig" rid="pcbi-1002915-g004">Fig. 4A</xref>), and 0.31 and 0.44 (brown columns in <xref ref-type="fig" rid="pcbi-1002915-g004">Fig. 4A</xref>), respectively. The fraction of transitions between states, as illustrated by <xref ref-type="fig" rid="pcbi-1002915-g004">Fig. 4B</xref>, exhibit little variation between the group sizes. The only visible trend is a small increase in the number of transitions between the milling state and the swarm state (see also <xref ref-type="supplementary-material" rid="pcbi.1002915.s004">Fig. S4</xref> for alternative graphics).</p>
        <fig id="pcbi-1002915-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002915.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Statistics of state transitions.</title>
            <p>(<italic>A</italic>) Fraction of time spent in the different dynamical states shown for each group size. The error bars are showing the standard deviation measured across replicates. The group of 30 fish is predominantly in the polarized state, but less time is spent in this state with increasing group size (GLM: F1,22 = 36.21, P = 4.6e-06). As the group size increases, the groups gradually spend more time in the milling state (GLM: F1,22 = 19.31, P = 0.00023). The amount of time spent in the transition regime is high, but constant, for all group sizes (GLM: F1,22 = 0.67, P = 0.42). Across all group sizes (GLM: F1,22 = 0.053, P = 0.82) little time is spent in the swarm state. (<italic>B</italic>) Fraction of transitions from one state to another for the different groups. The error bars are showing the standard deviation measured across replicates. For all group sizes, the polar state predominantly transitions into the swarm state compared to the milling state (GLMM: F1,23 = 58.77, P&lt;0.0001). The swarm state is dominated by transitions into the polarized state (GLMM: F1,23 = 55.69, P&lt;0.0001). Although these transitions are consistent across group sizes, there is a significant interaction between group size and the frequencies of transitioning from the milling state to the swarm and polarized states (GLMM: F1,22 = 13.30, P = 0.0014). While the milling state tended to transition into the polar state, for 300 fish there was a roughly equal probability of transitioning to the polar or swarm states. (<italic>C</italic>) Rank plots showing the probability of being in a state longer than time T<sub>s</sub> before moving into a different regime. There was no significant difference between group sizes in the persistence of the polar state (GLMM: F1,22 = 0.58, P = 0.45), although group size increased the persistence of the transition (F1,22 = 24.52, P = 1e-04) and milling states (F1,22 = 17.54, P = 4.0e-04), and to a lesser degree, the swarm state (F1,22 = 5.31, P = 0.031).</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002915.g004" position="float" xlink:type="simple"/>
        </fig>
        <p>To complement this picture it is important to note two (inter-related) features that do change with group size: Firstly the rate at which groups exhibit transitions decreases as a function of group size (from 2.0 transitions/min for 30 fish, to 1.4, 1.2, and 0.8 transitions/min for 70, 150, and 300 fish respectively); Secondly, the stability of the milling state increases as a function of group size (the longest time a group of 30 spent milling was 17 s, this increased to 110 s, 708 s, and 1245 s for group sizes 70, 150 and 300, respectively. See <xref ref-type="fig" rid="pcbi-1002915-g004">Fig. 4C</xref> for rank plots of time spent in a state before transitioning). This means that the large proportion of time the 30 fish spent in the polarized state is an accumulated effect of many visits into the state, while the proportion of time the 300 fish spent in the milling state is greatly affected by the milling state being more stable for larger groups.</p>
        <p>A further feature of the transitional behavior of groups is that transitions from one dynamical state to another only accounted for 47% (n = 1943) of the total number of visits into the transition zone (n = 4119), counting only visits lasting longer than 1 s. This demonstrates that the schools experience frequent perturbations, of which some result in transitions to another state (<xref ref-type="fig" rid="pcbi-1002915-g004">Fig. 4B</xref>), and the others back to the preceding state.</p>
        <p>From observing the schooling behavior it appears that perturbations to the group act as triggers to transitions between collective states (see <xref ref-type="supplementary-material" rid="pcbi.1002915.s013">Videos S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s014">S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s015">S3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s016">S4</xref>) and we can identify two main sources for fluctuations that result in transitions; interactions with the tank wall (boundary effects) and fluctuations due to the intrinsically noisy nature of individual motion. We note that these processes are not mutually exclusive.</p>
      </sec>
      <sec id="s2c">
        <title>Boundary effects and state transitions</title>
        <p>In order to reveal more clearly the role of boundary effects on state transitions we use our extensive time series to characterize the typical nature of transitions and relate these to whether the group tends to be relatively close to, or far from, the boundary. We present data for 150 fish in <xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5</xref> (for other group sizes see <xref ref-type="supplementary-material" rid="pcbi.1002915.s005">Fig. S5</xref>). In <xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5A</xref> the arrows represent the average trajectories that groups take through <italic>O<sub>p</sub></italic> and <italic>O<sub>r</sub></italic> space when transitions occur and, unlike <xref ref-type="fig" rid="pcbi-1002915-g002">Fig. 2</xref>, the density plot now depicts the distance <italic>d<sub>b</sub></italic> from the center of mass of the group to the closest point at the tank boundary; red colors represent a relatively large distance and blue colors relative proximity to the boundary. A more detailed view of the transition dynamics is presented in <xref ref-type="fig" rid="pcbi-1002915-g005">Figs. 5B–D</xref>. Here, for each of the transitions from polar to milling, polar to swarm and milling to swarm state, the average trajectories are plotted as a velocity field in the <italic>O<sub>p</sub></italic> and <italic>O<sub>r</sub></italic> phase space overlaid on the density plot showing the distribution of trajectories (for the reverse transitions and other group sizes see <xref ref-type="supplementary-material" rid="pcbi.1002915.s006">Figs. S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002915.s007">S7</xref>).</p>
        <fig id="pcbi-1002915-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002915.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Transition patterns for 150 fish.</title>
            <p>(<italic>A</italic>) Density plot of the smallest distance from the center of mass of the fish shoal to the tank boundary as a function of rotation and polarization (d<sub>min</sub> = 26 and d<sub>max</sub> = 52 cm). The overlaid arrows are the averaged trajectories of all transitions in the rotation-polarization phase space. (<italic>B–D</italic>) Density plots of transitions from polarized to milling state (<italic>B</italic>), from polarized to swarm state (C) and from milling to swarm state (D). Overlaid the density plots are the corresponding velocity fields of the transition data (in the rotation-polarization phase space). Plots of the reverse transitions and group sizes 30, 70 and 300 are provided in SI.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002915.g005" position="float" xlink:type="simple"/>
        </fig>
        <p>The data shown in <xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5</xref> verify that transitions happen both close to the wall of the tank, and in the center of the tank. For large parts of the transition region schools are relatively close to the boundary, such as from the polarized state to the swarm state, where most transitions take place (<xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5C</xref>). Although not as clear, the transitions between the milling state and the swarm state are also characterized by being, on average, closer to the wall (<xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5D</xref>). The exception is for transitions that occur with high values of the order parameters, that is, between the polarized state and the milling state (<xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5B</xref>), and vice versa. These tend to occur both close to and also away from the wall. This indicates, as evidenced by the video footage (<xref ref-type="supplementary-material" rid="pcbi.1002915.s013">Videos S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s014">S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s015">S3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002915.s016">S4</xref>), that both boundary and other triggering mechanisms are important for inducing transitions between collective states.</p>
        <p>When in the milling state, interactions with the boundary can result in a local increase in density near the wall, due to the inherently constrained nature of motion when abutting the boundary. This can cause the mill to transition into a polarized state as shown in <xref ref-type="fig" rid="pcbi-1002915-g006">Fig. 6A</xref>. Another way in which the mill can break down is due to the action of individuals at the group edge; if fish turn or move away from the edge of the group this can seed the unraveling of the milling formation into a polarized state. Conversely, when in a polarized state individuals at the front of the group can turn towards the main mass resulting in a perturbation that prompts the group to turn, potentially initiating the mill formation. This last example is evidenced in <xref ref-type="fig" rid="pcbi-1002915-g006">Fig. 6B</xref> and demonstrates that the milling formation can emerge as a group effect from the individual interactions—without direct interaction with the tank boundary.</p>
        <fig id="pcbi-1002915-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002915.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Time-lapse examples demonstrating transition mechanisms.</title>
            <p>(<italic>A</italic>) Transition initiated by interaction with the tank wall. In the first picture, the fish is in a milling state, indicated by the blue arrow, and the lower part of the group is close to the tank wall (grey line). In the second picture, the interaction with the wall has caused a local increase in density, marked by the blue region, and a few individuals have started to turn opposite the milling direction. This cascades, and in the third picture the flow of the mill is interrupted as a large proportion is breaking away from the milling direction. The result is total unraveling of the milling state and transition into the polar state, seen in the last picture. (<italic>B</italic>) Transition from the polar state to the milling state, initiated by individuals in the shoal. In the first picture, the group is in a polar state, signified by the red arrow. A few individuals in the front, visible in the red region, have started to turn downwards. This leads the group as a whole into a sharp right turn, and as picture two demonstrates, the group is forced into a shape with larger curvature. Now, when the individuals in front of the group can spot the back of the group, they continue the turning and start following the back, as seen in the third picture. In the final picture, as the front individuals catches up with the tail, the loop closes and the transition into the milling state is complete.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002915.g006" position="float" xlink:type="simple"/>
        </fig>
        <p>In the case of polarized groups the boundary also has inevitable consequences on transitions; a polarized group may swim directly towards a wall, or corner, of the tank. Individuals reaching the wall slow down and tend to become disordered (unaligned) and the group can transition into the swarm state. That this mechanism of transition is dominating is demonstrated both by the average transition path from polarized to swarm in <xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5A</xref>, which crosses a region where <italic>d<sub>b</sub></italic> is small, as well as the short average time groups spend in the polarized state before transitioning, as shown in <xref ref-type="fig" rid="pcbi-1002915-g004">Fig. 4C</xref>.</p>
      </sec>
      <sec id="s2d">
        <title>The relationship between speed, density and group state</title>
        <p>For tractability many previous models of animal grouping (including that of Couzin et al. <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>) have assumed that individuals move at constant speed and social response is represented by adjusting direction of travel in response to the positions and/or orientations of near neighbors. Recently, however, two experimental studies on schooling fish, Katz et al. <xref ref-type="bibr" rid="pcbi.1002915-Katz1">[17]</xref>, involving golden shiners (<italic>Notemigonus crysoleucas</italic>—the species used here), and Herbert-read et al. <xref ref-type="bibr" rid="pcbi.1002915-HerbertRead1">[18]</xref>, involving mosquitofish (<italic>Gambusia holbrooki</italic>), have highlighted the importance of speed regulation to collective behaviors. In the former study it was found that individual social interactions can be approximated qualitatively by pairwise interactions that are functions of the position and speed of each individual. While the spatial nature of these interactions was found to be relatively independent of individual speed, the magnitude, or strength, of response to neighbors decreased greatly as individual speed decreased. Also Viscido et al. <xref ref-type="bibr" rid="pcbi.1002915-Viscido1">[24]</xref> found a positive correlation between average group speed and polarity for shoals of 4 and 8 giant danios (<italic>Devario aequipinnatus</italic>). This suggests that there is an important relationship between individual speed and the degree to which individuals coordinate their motion with neighbors, a relationship that is not captured in many models of collective motion <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Vicsek1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Czirk1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Chat1">[26]</xref>.</p>
        <p>Examining the relationship between the mean speed of individuals in the group and the ‘packing fraction’ (a measure of the density of individuals within the group) and the order parameters <italic>O<sub>p</sub></italic> and <italic>O<sub>r</sub></italic>, we observe that low speed is associated with the group being relatively dense and both locally- and globally-disordered (the swarm state). The two locally-ordered (milling and polarized) states are characterized by higher mean speed and a decreased packing fraction (see <xref ref-type="fig" rid="pcbi-1002915-g007">Fig. 7A</xref> for group size of 150 fish; this relationship is common among all group sizes as shown in <xref ref-type="supplementary-material" rid="pcbi.1002915.s008">Fig. S8</xref>). Consequently the relationship between density and order is the <italic>opposite</italic> of that predicted by the most studied models of grouping behavior, notably the Vicsek model <xref ref-type="bibr" rid="pcbi.1002915-Vicsek1">[15]</xref>; although we note that such simple models have been extremely useful in developing understanding of group dynamics for other animal aggregates, such as locusts <xref ref-type="bibr" rid="pcbi.1002915-Buhl1">[14]</xref>, and other species of schooling fish <xref ref-type="bibr" rid="pcbi.1002915-Becco1">[23]</xref>.</p>
        <fig id="pcbi-1002915-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002915.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Structural properties.</title>
            <p>(<italic>A</italic>) Density plots of packing fraction and average individual speed (averaged per frame) as functions of rotation <italic>O<sub>p</sub></italic> and polarization <italic>O<sub>r</sub></italic> for 150 fish. (<italic>B</italic>) The plot illustrates the correlation between individual speed and local polarization estimated in two ways from the underlying density maps (the example shown in the background is for 150 fish). The stapled curves are produced by averaging across individual speeds for each value of the order parameter; the solid curves from averaging across the order parameter values for each individual speed. The local polarization of an individual fish is defined as the polarization Op restricted to the area inside a circle with radius 15.6 cm (approximately 3 body lengths) centered at the individual fish. (<italic>C</italic>) Average individual speed at different radial positions in the milling state. (<italic>D</italic>) Average rotational order parameter at the same positions. The radial division of the milling state in (<italic>C</italic>) and (<italic>D</italic>) is constructed by centering six shells outside each other, where the outermost shell has a radius defined by the distance from the group's center of mass to the median distance of the five most peripheral fish (see illustration in <xref ref-type="supplementary-material" rid="pcbi.1002915.s011">Fig. S11</xref>). The width of each shell is the radius of the outer shell divided by six. The averages are calculated for each shell, where the outer shell even includes peripheral fish.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002915.g007" position="float" xlink:type="simple"/>
        </fig>
        <p>From our data we cannot distinguish between two, not mutually exclusive, hypotheses regarding the causal relationship between speed and order; does decreasing speed induce local disorder through weakened social interactions, or does perception of local disorder reduce an individual's speed? Since golden shiners do not appear to explicitly respond to the body orientation of neighbors, and rather respond more-or-less exclusively to individuals' positions in space <xref ref-type="bibr" rid="pcbi.1002915-Katz1">[17]</xref>, increasing speed likely increases local order. However, a dense, slow moving and disordered group is also likely to further reduce individual speed (not least through increased risk of collision) - thus both causal relationships likely co-exist.</p>
        <p>To demonstrate the plausibility (and indeed, generality) of speed-induced transitions, we return to the model employed above, from <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>. We verify that changing individual speed does result in qualitatively the same transitional behavior seen here; swarm behavior for relatively low speed and bistable milling and parallel group motion as individual speed increases. This result holds up to 150 agents. For groups of 300 agents the milling state is dominant and no instances of the polar state are found. (see <xref ref-type="fig" rid="pcbi-1002915-g008">Fig. 8</xref> for results from simulations with 150 agents and <xref ref-type="supplementary-material" rid="pcbi.1002915.s009">Fig. S9</xref> for remaining group sizes. Simulation details are found in <xref ref-type="sec" rid="s3">Methods</xref>).</p>
        <fig id="pcbi-1002915-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002915.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Relationship between agent speed and order in constant-speed agent based simulation model with 150 agents.</title>
            <p>(<italic>A</italic>) Density plot of agent speed as function of rotation <italic>O<sub>r</sub></italic> and polarization <italic>O<sub>p</sub></italic>, revealing a bistable regime between the milling and the polar states for high speeds. (<italic>B</italic>) Normalized probability plot of polarization <italic>O<sub>p</sub></italic> as function of agent speed. (<italic>C</italic>) Normalized probability plot of rotation <italic>O<sub>r</sub></italic> as function of agent speed. The last two plots illustrate the bifurcation that occurs as the speed is increased, where the system transitions from a swarm state and is found either in a highly polarized state or in a milling state. (See <xref ref-type="sec" rid="s3">Methods</xref> for simulation details).</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002915.g008" position="float" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2e">
        <title>Local social interactions are similar across group size and dynamical state</title>
        <p>In order to deepen our understanding of the local dynamics we also quantified the relationship between the speed of an individual and the degree of order in its immediate vicinity (within a radius distance of 15.5 cm). In <xref ref-type="fig" rid="pcbi-1002915-g007">Fig. 7B</xref> we show the resulting relationship as a contour plot for groups of 150 fish (see <xref ref-type="supplementary-material" rid="pcbi.1002915.s010">Fig. S10</xref> for corresponding plots of 30, 70 and 300 fish, and for different radial proximity distances). A strong association is evident between individual speed and local order. Assuming an unknown causal direction in the relation between the speed and the local order, as discussed above, there are two ways we can average the contour plots; either over all values of the speed for each value of the local order, or vice versa, for each value of the speed we average over the local order. The results of both procedures, for all group sizes, are overlaid on the contour plot in <xref ref-type="fig" rid="pcbi-1002915-g007">Fig. 7B</xref>. While the two approaches yield disparate curves, they both demonstrate a similar relationship between individual speed and local order. Although the fish have to align at higher speeds to maintain group cohesion, it is unclear why they should become disordered at low speeds. There is also a much greater variance in local order at low speeds, demonstrating a wide degree of flexibility when individual speeds are low. Interestingly, across the group sizes the two sets of curves are close to identical. This suggests that, from the perspective of a focal individual, it may simply adopt the same local rules regardless of group size (consistent with the findings of Katz et al. <xref ref-type="bibr" rid="pcbi.1002915-Katz1">[17]</xref> for groups of 10 and 30 fish).</p>
        <p>Contrary to the polarization order parameter, the rotation order parameter has little meaning on a purely local scale. Rather we compute the rotation order parameter separately for a series of shells placed around the center of mass of the group, as illustrated in <xref ref-type="supplementary-material" rid="pcbi.1002915.s011">Fig. S11</xref>. This allows us to obtain a well-defined measure that provides insight into the structural organization of the milling state. As can be seen in <xref ref-type="fig" rid="pcbi-1002915-g007">Figs. 7C and 7D</xref> this state is characterized by a center with low speed and low degree of structure that contributes little to the milling state, while as we move towards the edge of the group the speed and impact from each shell on the milling state increases. In <xref ref-type="fig" rid="pcbi-1002915-g007">Fig. 7D</xref> the curves are almost identical for all group sizes suggesting that, again, scaling the size of the group has little effect on the local structural signature of this collective state.</p>
        <p>These results demonstrate that the ordered polarized and milling states are locally near identical from the perspective of a focal individual, regardless of group size. These data also support the prediction of a multi-stable locally-ordered regime in which the group can transition back and forth between the polarized and milling state through stochastic and boundary-induced effects.</p>
      </sec>
      <sec id="s2f">
        <title>Conclusions</title>
        <p>Despite the multitude of local interactions that result in coordinated group motion we demonstrate that schooling golden shiners predominantly exist in three ‘fundamental’ dynamically-stable states of the underlying dynamics: swarm, milling and polarized motion. We establish that group states, and transitional behavior, can be represented in low-dimensional space, a projection that allows us to see the path taken by groups between the three dynamically-stable states as well as to relate the collective states exhibited to properties such as group size, individual speed and perturbations to the group. We note that it is possible that further collective states may be found within the classified dynamically stable regimes described here, but the present states are highly consistent with the theoretical predictions of three regimes</p>
        <p>A key question in the study of collective behavior is whether different group-level patterns result from all individuals responding to the same external factor <xref ref-type="bibr" rid="pcbi.1002915-Hoare1">[27]</xref>, or individuals changing behavior <xref ref-type="bibr" rid="pcbi.1002915-Couzin1">[1]</xref>, or whether multiple dynamically-stable collective states co-exist for the same individual behaviors <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>. Our results provide evidence for the importance of the two latter processes in the behavior of schooling fish: transitions from the swarm, to the milling or parallel group states (and vice versa) involve a social feedback whereby individuals adjust behavior—in this case their speed—in response to prevailing local conditions. Low average speeds among group members correspond to them occupying the dense, disordered swarm regime.</p>
        <p>Higher speeds correspond to higher local order (alignment among group members) and groups existing in either the milling or polarized state. Transitions between these states occur with negligible, or no, change in local density, order or speed; instead perturbations such as collisions with the boundary, or (seemingly stochastic) fluctuations in motion at the group edge (in the case of milling to polarized state transitions) or front (in the case of polarized to milling transitions) result in the group leaving one dynamically-stable state, and either then returning to that state, or transitioning to the alternative locally-ordered regime. Thus the milling and polarized states appear to be bistable; the state exhibited by the group effectively being dependent on starting conditions and/or the nature of perturbations, as well as the group size. Theoretically <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref> and experimentally (analysis of shoals of 30 fish in small tank), milling states are seen to be less stable for small groups, when controlling for boundary condition effects. It is likely that the relationship we found between speed and local order is a generic feature of mobile groups with local interactions. Furthermore, qualitatively similar features have been observed in small groups (4 and 8 fish) of the giant danios <xref ref-type="bibr" rid="pcbi.1002915-Viscido1">[24]</xref>.</p>
        <p>A key challenge for animal behavior in this, and future, decades is to understand how the microscopic mechanisms of interactions among molecules, physiological systems and neural circuits result in behavior at higher levels of organization. Whereas we focused on collective behavior resulting from interactions among individual organisms, the general approach adopted shares commonalities with approaches that have successfully been used to characterize the dynamical properties of gene interaction networks <xref ref-type="bibr" rid="pcbi.1002915-Erban1">[28]</xref>, neuronal circuits <xref ref-type="bibr" rid="pcbi.1002915-Yu1">[29]</xref>, how locomotion is coordinated among limbs, each of which has many degrees of freedom <xref ref-type="bibr" rid="pcbi.1002915-Sanger1">[30]</xref>, and how the behavior of individual organisms (such as <italic>Caenorhabditis elegans</italic>), despite apparent complexity, can be deconstructed into a discrete number of low-dimensional behavioral dynamically-stable states (see Stephens et al. <xref ref-type="bibr" rid="pcbi.1002915-Stephens1">[31]</xref>). We suggest that development, and adoption of, such techniques in the behavioral sciences could facilitate the advent of increasingly integrative and quantitative insights.</p>
        <p>Our work demonstrates that such an approach to data collection and analysis can reveal underlying simplicity in the dynamical properties of collective behavior in groups. Collective behavioral states appear to result from both behavioral feedback processes whereby individuals both adopt, and influence, the behavior of near neighbors and also as multi-stable regimes in which individual behavior does not change, but rather perturbations induce relatively abrupt transitions between alternate and co-existing dynamically-stable behavioral states. Prey groups have been observed to switch states upon detecting a predator <xref ref-type="bibr" rid="pcbi.1002915-Partridge1">[32]</xref> and risk can be dependent on these states <xref ref-type="bibr" rid="pcbi.1002915-Wood1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002915-Ioannou1">[33]</xref>. Whether the mechanisms for switching between states as identified here are somehow themselves adaptive would be an interesting question to address in future work.</p>
      </sec>
    </sec>
    <sec id="s3" sec-type="methods">
      <title>Methods</title>
      <sec id="s3a">
        <title>Experiments and data extraction</title>
        <p>The experimental setup, the automated tracking procedure and the methods for constructing detailed trajectory data were the same as described in Yael et al. <xref ref-type="bibr" rid="pcbi.1002915-Katz1">[17]</xref> and details are found there. The data used for the analyses in this work are time series of positions and velocities of the individual fish. The tracking accuracy varied with the structure of the groups. As we show in <xref ref-type="supplementary-material" rid="pcbi.1002915.s012">Fig. S12</xref>, ordered groups were more precisely tracked, while dense and disordered groups were more prone to tracking errors. On average the percentage of frames with tracking accuracy above 80% were 88% for 30 fish, 91% for 70 fish, 80% for 150 fish and 71% for 300 fish. Since our focus in this paper does not rely on us maintaining identities for long periods of time there is ample data from which to calculate global patterns and distributions of properties such as speed.</p>
      </sec>
      <sec id="s3b">
        <title>Order parameters</title>
        <p>We calculated the polarization order parameter <italic>O<sub>p</sub></italic> and the rotation order parameter <italic>O<sub>r</sub></italic> (see definitions in <xref ref-type="sec" rid="s2">Results and Discussion</xref>) for each frame and smoothed the resulting time series using a moving average with a span of 30 frames (corresponding to 1 second). In <xref ref-type="fig" rid="pcbi-1002915-g007">Fig. 7B</xref> we used a definition of the polarization order parameter that is restricted to the local neighborhood around a focal individual. Similarly, we used a radial version of the rotation order parameter in <xref ref-type="fig" rid="pcbi-1002915-g007">Fig. 7D</xref>, in which only fish inside a shell of given radius surrounding the full shoal's center of mass were included.</p>
      </sec>
      <sec id="s3c">
        <title>Density plots</title>
        <p>All <italic>O<sub>r</sub>-O<sub>p</sub></italic> density plots were made by dividing up the phase space into 30 times 30 bins and counting the number of values falling into the respective bins (<xref ref-type="fig" rid="pcbi-1002915-g002">Figs. 2</xref>, <xref ref-type="fig" rid="pcbi-1002915-g003">3</xref> and <xref ref-type="fig" rid="pcbi-1002915-g005">5B–C</xref>) or calculating the average value in the bins (<xref ref-type="fig" rid="pcbi-1002915-g005">Figs. 5A</xref> and <xref ref-type="fig" rid="pcbi-1002915-g007">7A</xref>). Only bins with counts above a certain threshold were included (100 counts in <xref ref-type="fig" rid="pcbi-1002915-g002">Figs. 2</xref> and <xref ref-type="fig" rid="pcbi-1002915-g007">7A</xref> and 20 counts in <xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5</xref>). Before plotting, the bin values were interpolated over a finer mesh of 300 times 300 points.</p>
      </sec>
      <sec id="s3d">
        <title>Defining states</title>
        <p>Deciding exact thresholds for when a shoal is in a certain state or not is hardly possible, even though it is easy to approximately mark out the regions in the O<sub>r</sub>-<italic>O<sub>p</sub></italic> phase space that corresponds to the swarming, polar and milling states. Since the analyses we did were not critically dependent on whether precise demarcations could be made, we used a heuristic approach and—motivated by the high density regions observed in <xref ref-type="fig" rid="pcbi-1002915-g002">Fig. 2</xref>, as well as visual verification from the videos—defined the dynamic states as follows: polar state (P) when <italic>O<sub>p</sub></italic>&gt;0.65 and <italic>O<sub>r</sub></italic>&lt;0.35; milling state (M) when <italic>O<sub>p</sub></italic>&lt;0.35 and <italic>O<sub>r</sub></italic>&gt;0.65; and swarm state (S) when <italic>O<sub>p</sub></italic>&lt;0.35 and <italic>O<sub>r</sub></italic>&lt;0.35. Outside these ranges we defined the system to be in a transitional state (T).</p>
      </sec>
      <sec id="s3e">
        <title>Packing fraction</title>
        <p>To calculate the packing fraction of a group we first used an alpha-shape algorithm <xref ref-type="bibr" rid="pcbi.1002915-Cavagna1">[34]</xref> to measure the area spanned by the group. Dividing the number of fish by the measured area and then multiplying by the average area of a fish body (40 times 5 pixels) produced the packing fraction value.</p>
      </sec>
      <sec id="s3f">
        <title>Transition paths</title>
        <p>To calculate the average transition paths in <xref ref-type="fig" rid="pcbi-1002915-g005">Fig. 5A</xref> we first interpolated all transition time series to have the same length. Then we averaged the interpolated transition paths between one state and another. The vector plots in <xref ref-type="fig" rid="pcbi-1002915-g005">FigS. 5B–D</xref> were constructed by first differentiating each of the transition time series to create a velocity vector field, which we then coarse-grained by dividing the <italic>O<sub>r</sub>-O<sub>p</sub></italic> phase space into 30 times 30 bins and averaging over the vector field in each bin.</p>
      </sec>
      <sec id="s3g">
        <title>Simulations</title>
        <p>Simulations were performed using the constant-speed agent-based model described in Couzin et al. <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref> with 30, 70, 150 and 300 individuals. In this model the individuals move with constant speed and interact with each other through three types of interactions: repulsion, alignment of orientation and attraction. Centered on each individual are three spherical non-overlapping behavioral zones; zone of repulsion, zone of orientation and zone of attraction. The distribution of neighbors across these three zones is what decides the desired heading of an individual. For a detailed description of the model algorithm, see <xref ref-type="bibr" rid="pcbi.1002915-Couzin2">[3]</xref>. In our simulations we varied the speed from 0.1 to 4.1 unit lengths per unit time in increments of 0.1 and performed 500 replicates for each value of the speed. Each simulation was run for 2500 time steps and the order parameters in the final simulation step recorded. The remaining model parameters remained fixed throughout the simulations and were: zone of repulsion 1; zone of orientation 3; zone of attraction 15; field of perception 270 degrees; turning rate 60 degrees; error 0.2 radians; time step increment 0.1. Note that the simulations are not parametrized to fit the schools of fish. Rather, we use the simulations to display a generic quality of self-propelled particle models that aligns with experimental observations.</p>
      </sec>
      <sec id="s3h">
        <title>Statistical analyses</title>
        <p>The frequency of the milling state rotating in a clockwise or counter-clockwise direction was analysed using a quasi-poisson distributed Generalised Linear Mixed Model (GLMM). Direction (a within-subject fixed factor) and group size (between-subject covariate) were the explanatory variables along with their interaction term, and shoal identity the random variable. The time spent in each state as a proportion of the total trial time was calculated for each group of fish, and then was analyzed as a function of group size using quasi-binomial Generalised Linear Models (GLM). Each state was analyzed separately, as well as the time spent in transition between states. Quasi-negative binomial GLMMs were used to analyse the frequency of transitions from each state (swarm, milling and polarised) to a different state (the ‘to’ state, a within-subject fixed factor), again with group size as an additional explanatory variable and shoal identity the random variable. These models were run separately for each ‘from’ state and included the ‘to’ state×group size interaction. The persistence of each visit to a state before transitioning into a different state (i.e. its stability) was analysed using quasi-negative binomial GLMMs. As a visit to a state within one shoal was not independent from the duration of other visits within that shoal, the analysis was carried out separately for each state. Group size was used as an explanatory variable and shoal identity as the random variable. The parameter theta for the quasi-negative binomial GLMMs was estimated from running negative-binomial GLMs without the random variable first, which gives an estimate for theta. Non-significant interaction terms were removed before testing main effects, but with the statistics given for main effects including any other main effects regardless of their significance. All statistical tests were carried out using R 2.14.2.</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002915.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s001" position="float" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>No signature of handedness.</bold> The plot shows the mean and standard deviation of the number of transitions (per replicate) resulting in a clockwise (blue) or counter-clockwise (red) milling state. Transitions into the milling state were no more likely to go clockwise or counterclockwise (GLMM: F1,23 = 0.7191, P = 0.4052), and neither was this affected by group size (direction×group size interaction: F1,22 = 2.9966, P = 0.0974).</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s002" position="float" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>Relation between group size and group area and packing fraction.</bold> (<italic>A</italic>) shows the mean group area plotted as a function of group size, including standard deviations. The dashed red line is a linear fit. (<italic>B</italic>) shows the mean packing fraction as a function of group size, also with standard deviations incuded.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s003" position="float" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Statistics of state transitions for varying definitions of dynamical state.</bold> We define the dynamical states as: polar state (P) when O<sub>p</sub>&gt;1−k and O<sub>r</sub>&lt;k; milling state (M) when O<sub>p</sub>&lt;k and O<sub>r</sub>&gt;1−k; and swarm state (S) when O<sub>p</sub>&lt;k and O<sub>r</sub>&lt;k. The plots show the transition statistics for k = 0.25 (first row), 0.35 (second row and the value used in the paper—included for ease of comparison) and 0.40 (third row). As in the paper: (A) Fraction of time spent in the different dynamical states shown for each group size. The error bars are showing the standard deviation measured across replicates. (B) Fraction of transitions from one state to another for the different groups.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s004" position="float" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p><bold>Schematic overview of transitions between dynamical states.</bold> The filled circles represent the fraction of time spent in a dynamical state and the arrows represent the fraction of transitions from one dynamical state to another. The absolute number of transitions from one state to another is placed at the tip of the respective transition arrow.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s005" position="float" xlink:type="simple">
        <label>Figure S5</label>
        <caption>
          <p><bold>Average transition paths.</bold> Density plot of the smallest distance from the center of mass of the fish shoal to the tank boundary as a function of rotation and polarization. The overlaid arrows are the averaged trajectories of all transitions in the rotation-polarization phase space. For the different group sizes we used d<sub>min</sub> = 19.5 cm and d<sub>max</sub> = 36 cm (30 fish), d<sub>min</sub> = 23 cm and d<sub>max</sub> = 49 cm (70 fish), d<sub>min</sub> = 26 cm and d<sub>max</sub> = 52 cm (150 fish), d<sub>min</sub> = 29 cm and d<sub>max</sub> = 55 cm (300 fish). Both the distance distribution and the transition paths are similar across group sizes. The transitions between the swarm state and the polarized state on average happen when the center of mass is close to the boundary, indicating that these transitions are mostly caused by interactions with the boundary. The same is the case with the transitions between the swarm state and the milling state, if not as clear. Between the polar state and the milling state, the transitions on average happen further away from the boundary, suggesting that these transitions can be caused both by interactions with the boundary or by local perturbations in the school.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s006" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s006" position="float" xlink:type="simple">
        <label>Figure S6</label>
        <caption>
          <p><bold>Transition patterns.</bold> Density plots of transitions between states for (<italic>A</italic>) 30 fish and (<italic>B</italic>) 70 fish. Overlaid the density plots are the corresponding velocity fields of the transition data (in the rotation-polarization phase space).</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s007" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s007" position="float" xlink:type="simple">
        <label>Figure S7</label>
        <caption>
          <p><bold>Transition patterns.</bold> Density plots of transitions between states for (<italic>A</italic>) 150 fish and (<italic>B</italic>) 300 fish. Overlaid the density plots are the corresponding velocity fields of the transition data (in the rotation-polarization phase space).</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s008" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s008" position="float" xlink:type="simple">
        <label>Figure S8</label>
        <caption>
          <p><bold>Packing fraction and average speed.</bold> Density plots of packing fraction and average individual speed (averaged per frame) as functions of rotation <italic>O<sub>p</sub></italic> and polarization <italic>O<sub>r</sub></italic> for (<italic>A</italic>) 30 fish, (<italic>B</italic>) 70 fish and (C) 300 fish.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s009" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s009" position="float" xlink:type="simple">
        <label>Figure S9</label>
        <caption>
          <p><bold>Relationship between agent speed and order in constant-speed agent based simulation model with 30, 70 and 300 agents.</bold> (<italic>A</italic>) Density plot of agent speed as function of rotation <italic>O<sub>r</sub></italic> and polarization <italic>O<sub>p</sub></italic>, revealing a bistable regime between the milling and the polar states for high speeds in simulations with 30 and 70 agents. For 300 agents the milling state becomes dominant and the bistable regime dissappears. (<italic>B</italic>) Normalized probability plot of polarization <italic>O<sub>p</sub></italic> as function of agent speed. (<italic>C</italic>) Normalized probability plot of rotation <italic>O<sub>r</sub></italic> as function of agent speed. (See <xref ref-type="sec" rid="s3">Methods</xref> for simulation details).</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s010" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s010" position="float" xlink:type="simple">
        <label>Figure S10</label>
        <caption>
          <p><bold>Relation between local polarization and individual speed.</bold> The plots show the correlation between individual speed and local polarization estimated in two ways from the underlying density maps. The stapled curves are produced by averaging across individual speeds for each value of the order parameter; the solid curves from averaging across the order parameter values for each individual speed. The local polarization of an individual fish is defined as the polarization <italic>O<sub>p</sub></italic> restricted to the area inside a circle centered at the individual fish. The plots show the results from using neighborhoods of 1–3 body lengths (BL), where BL is 5.2 cm.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s011" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s011" position="float" xlink:type="simple">
        <label>Figure S11</label>
        <caption>
          <p><bold>Radial division of milling state.</bold> The figure shows the division of fish in the milling state into shells, where the distance of the outer shell (dashed lines) is defined as the median distance to the group's centre of mass of the five most peripheral fish, and the width of each shell is the radius of the outer shell divided by six.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s012" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s012" position="float" xlink:type="simple">
        <label>Figure S12</label>
        <caption>
          <p><bold>Tracking accuracy.</bold> (<italic>A</italic>) shows histograms of how many fish are tracked in each frame. The red line in each histogram denotes the threshold for 80% tracking accuracy. The percentage of frames above 80% accuracy are 88% for 30 fish, 91% for 70 fish, 80% for 150 fish and 71% for 300 fish. (<italic>B</italic>) shows the density distributions of tracking accuracy as a function of the rotational (<italic>O<sub>r</sub></italic>) and polarization (<italic>O<sub>p</sub></italic>) order parameters.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s013" mimetype="video/x-m4v" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s013" position="float" xlink:type="simple">
        <label>Video S1</label>
        <caption>
          <p><bold>30 golden shiners swimming in shallow water in the laboratory.</bold> The video plays at 16× normal speed to clearly depict the different dynamical patterns occurring.</p>
          <p>(M4V)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s014" mimetype="video/x-m4v" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s014" position="float" xlink:type="simple">
        <label>Video S2</label>
        <caption>
          <p><bold>70 golden shiners swimming in shallow water in the laboratory.</bold> The video plays at 16× normal speed to clearly depict the different dynamical patterns occurring.</p>
          <p>(M4V)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s015" mimetype="video/x-m4v" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s015" position="float" xlink:type="simple">
        <label>Video S3</label>
        <caption>
          <p><bold>150 golden shiners swimming in shallow water in the laboratory.</bold> The video plays at 16× normal speed to clearly depict the different dynamical patterns occurring.</p>
          <p>(M4V)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002915.s016" mimetype="video/x-m4v" xlink:href="info:doi/10.1371/journal.pcbi.1002915.s016" position="float" xlink:type="simple">
        <label>Video S4</label>
        <caption>
          <p><bold>300 golden shiners swimming in shallow water in the laboratory.</bold> The video plays at 16× normal speed to clearly depict the different dynamical patterns occurring.</p>
          <p>(M4V)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We are grateful to members of the Couzin Laboratory (particularly Nikolai Bode, Noam Miller and Colin Torney) for useful discussions and critical reading of the manuscript.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002915-Couzin1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Couzin</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Krause</surname><given-names>J</given-names></name> (<year>2003</year>) <article-title>Self-organization and collective behavior in vertebrates</article-title>. <source>Adv Study Behav</source> <volume>32</volume>: <fpage>1</fpage>–<lpage>75</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Sumpter1">
        <label>2</label>
        <mixed-citation publication-type="other" xlink:type="simple">Sumpter DJT (2010) Collective Animal Behavior. Princeton: Princeton University Press. 312 p.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Couzin2">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Couzin</surname><given-names>ID</given-names></name>, <name name-style="western"><surname>Krause</surname><given-names>J</given-names></name>, <name name-style="western"><surname>James</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Ruxton</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Franks</surname><given-names>NR</given-names></name> (<year>2002</year>) <article-title>Collective memory and spatial sorting in animal groups</article-title>. <source>J Theor Biol</source> <volume>218</volume>: <fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Dorsogna1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>D orsogna</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Chuang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Bertozzi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Chayes</surname><given-names>L</given-names></name> (<year>2006</year>) <article-title>Self-Propelled Particles with Soft-Core Interactions: Patterns, Stability, and Collapse</article-title>. <source>Phys Rev Lett</source> <volume>96</volume>: <fpage>104302</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Gautrais1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gautrais</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Jost</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Theraulaz</surname><given-names>G</given-names></name> (<year>2008</year>) <article-title>Key behavioural factors in a self-organised fish school model</article-title>. <source>Ann Zool Fennici</source> <volume>45</volume>: <fpage>415</fpage>–<lpage>428</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Strefler1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strefler</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Erdmann</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Schimansky-Geier</surname><given-names>L</given-names></name> (<year>2008</year>) <article-title>Swarming in three dimensions</article-title>. <source>Phys Rev E</source> <volume>78</volume>: <fpage>031927</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Biggs1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Biggs</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bennet</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Dadzie</surname><given-names>SK</given-names></name> (<year>2012</year>) <article-title>Time-delayed autosynchronous swarm control</article-title>. <source>Phys Rev E</source> <volume>85</volume>: <fpage>016105</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Parrish1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parrish</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Edelstein-Keshet</surname><given-names>L</given-names></name> (<year>1999</year>) <article-title>Complexity, Pattern, and Evolutionary Trade-Offs in Animal Aggregation</article-title>. <source>Science</source> <volume>284</volume>: <fpage>99</fpage>–<lpage>101</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Wood1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wood</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ackland</surname><given-names>G</given-names></name> (<year>2007</year>) <article-title>Evolving the selfish herd: emergence of distinct aggregating strategies in an individual-based model</article-title>. <source>Proc R Soc Lond B Biol Sci</source> <volume>274</volume>: <fpage>1637</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Paley1">
        <label>10</label>
        <mixed-citation publication-type="other" xlink:type="simple">Paley D, Leonard N, Sepulchre R, Couzin I (2007) Spatial models of bistability in biological collectives. In: Proceedings of the 46th IEEE Conference on Decision and Control; 12–14 December 2007; New Orleans, LA, USA. pp. 4851–4856.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Kolpas1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kolpas</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Moehlis</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kevrekidis</surname><given-names>IG</given-names></name> (<year>2007</year>) <article-title>Coarse-grained analysis of stochasticity-induced switching between collective motion states</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>104</volume>: <fpage>5931</fpage>–<lpage>5935</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Yates1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yates</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Erban</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Escudero</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Couzin</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Buhl</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Inherent noise can facilitate coherence in collective swarm motion</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>106</volume>: <fpage>5464</fpage>–<lpage>5469</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Grgoire1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grégoire</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Chaté</surname><given-names>H</given-names></name> (<year>2004</year>) <article-title>Onset of Collective and Cohesive Motion</article-title>. <source>Phys Rev Lett</source> <volume>92</volume>: <fpage>025702</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Buhl1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buhl</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sumpter</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Couzin</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Hale</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Despland</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>From disorder to order in marching locusts</article-title>. <source>Science</source> <volume>312</volume>: <fpage>1402</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Vicsek1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vicsek</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Czirók</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ben-Jacob</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Cohen</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Shochet</surname><given-names>O</given-names></name> (<year>1995</year>) <article-title>Novel type of phase transition in a system of self-driven particles</article-title>. <source>Phys Rev Lett</source> <volume>75</volume>: <fpage>1226</fpage>–<lpage>1229</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Schner1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schöner</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Kelso</surname><given-names>JA</given-names></name> (<year>1988</year>) <article-title>Dynamic pattern generation in behavioral and neural systems</article-title>. <source>Science</source> <volume>239</volume>: <fpage>1513</fpage>–<lpage>1520</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Katz1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katz</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Tunstrøm</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Ioannou</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Huepe</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Couzin</surname><given-names>ID</given-names></name> (<year>2011</year>) <article-title>Inferring the structure and dynamics of interactions in schooling fish</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>18720</fpage>–<lpage>18725</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-HerbertRead1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Herbert-Read</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Perna</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Mann</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Schaerf</surname><given-names>TM</given-names></name>, <name name-style="western"><surname>Sumpter</surname><given-names>DJT</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Inferring the rules of interaction of shoaling fish</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>18726</fpage>–<lpage>18731</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Lukeman1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lukeman</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Y-X</given-names></name>, <name name-style="western"><surname>Edelstein-Keshet</surname><given-names>L</given-names></name> (<year>2010</year>) <article-title>Inferring individual rules from collective behavior</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>107</volume>: <fpage>12576</fpage>–<lpage>12580</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Romanczuk1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Romanczuk</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Couzin</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Schimansky-Geier</surname><given-names>L</given-names></name> (<year>2009</year>) <article-title>Collective Motion due to Individual Escape and Pursuit Response</article-title>. <source>Phys Rev Lett</source> <volume>102</volume>: <fpage>010602</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Whittier1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whittier</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Halliwell</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Daniels</surname><given-names>R</given-names></name> (<year>2000</year>) <article-title>Distributions of Lake Fishes in the Northeast: II. The Minnows (Cyprinidae)</article-title>. <source>Northeast Nat</source> <volume>7</volume>: <fpage>131</fpage>–<lpage>156</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Radakov1">
        <label>22</label>
        <mixed-citation publication-type="other" xlink:type="simple">Radakov DV (1973) Schooling and Ecology of Fish. New York: Wiley. 173 p.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Becco1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Becco</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Vandewalle</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Delcourt</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Poncin</surname><given-names>P</given-names></name> (<year>2006</year>) <article-title>Experimental evidences of a structural and dynamical transition in fish school</article-title>. <source>Phys A</source> <volume>367</volume>: <fpage>487</fpage>–<lpage>493</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Viscido1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Viscido</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Parrish</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Grünbaum</surname><given-names>D</given-names></name> (<year>2004</year>) <article-title>Individual behavior and emergent properties of fish schools: a comparison of observation and theory</article-title>. <source>Mar Ecol Prog. Ser</source> <volume>273</volume>: <fpage>239</fpage>–<lpage>249</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Czirk1">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Czirók</surname><given-names>A</given-names></name>, <name name-style="western"><surname>VICSEK</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Vicsek</surname><given-names>T</given-names></name> (<year>1999</year>) <article-title>Collective motion of organisms in three dimensions</article-title>. <source>Phys A</source> <volume>264</volume>: <fpage>299</fpage>–<lpage>304</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Chat1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chaté</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Ginelli</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Raynaud</surname><given-names>F</given-names></name> (<year>2008</year>) <article-title>Collective motion of self-propelled particles interacting without cohesion</article-title>. <source>Phys Rev E</source> <volume>77</volume>: <fpage>046113</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Hoare1">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hoare</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Couzin</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Godin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Krause</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Context-dependent group size choice in fish</article-title>. <source>Anim Behav</source> <volume>67</volume>: <fpage>155</fpage>–<lpage>164</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Erban1">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Erban</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Frewen</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Elston</surname><given-names>TC</given-names></name>, <name name-style="western"><surname>Coifman</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Variable-free exploration of stochastic models: A gene regulatory network example</article-title>. <source>J Chem Phys</source> <volume>126</volume>: <fpage>155103</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Yu1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname><given-names>BM</given-names></name>, <name name-style="western"><surname>Cunningham</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Santhanam</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Ryu</surname><given-names>SI</given-names></name>, <name name-style="western"><surname>Shenoy</surname><given-names>KV</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Gaussian-process factor analysis for low-dimensional single-trial analysis of neural population activity</article-title>. <source>J Neurophysiol</source> <volume>102</volume>: <fpage>614</fpage>–<lpage>635</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Sanger1">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sanger</surname><given-names>TD</given-names></name> (<year>2000</year>) <article-title>Human arm movements described by a low-dimensional superposition of principal components</article-title>. <source>J Neurosci</source> <volume>20</volume>: <fpage>1066</fpage>–<lpage>1072</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Stephens1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stephens</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Bueno de Mesquita</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ryu</surname><given-names>WS</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name> (<year>2011</year>) <article-title>Emergence of long timescales and stereotyped behaviors in Caenorhabditis elegans</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>7286</fpage>–<lpage>7289</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Partridge1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Partridge</surname><given-names>BL</given-names></name> (<year>1980</year>) <article-title>The effect of school size on the structure and dynamics of minnow schools</article-title>. <source>Anim Behav</source> <volume>28</volume>: <fpage>68</fpage>–<lpage>77</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Ioannou1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ioannou</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Guttal</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Couzin</surname><given-names>ID</given-names></name> (<year>2012</year>) <article-title>Predatory Fish Select for Coordinated Collective Motion in Virtual Prey</article-title>. <source>Science</source> <volume>337</volume>: <fpage>1212</fpage>–<lpage>1215</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002915-Cavagna1">
        <label>34</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cavagna</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Giardina</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Orlandi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Parisi</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Procaccini</surname><given-names>A</given-names></name> (<year>2008</year>) <article-title>The STARFLAG handbook on collective animal behaviour: 2. Three-dimensional analysis</article-title>. <source>Anim Behav</source> <volume>76</volume>: <fpage>237</fpage>–<lpage>248</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>