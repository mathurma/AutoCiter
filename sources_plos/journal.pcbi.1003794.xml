<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-00317</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003794</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Stem cells</subject></subj-group></subj-group></subj-group></subj-group><subj-group><subject>Computational biology</subject></subj-group><subj-group><subject>Developmental biology</subject></subj-group><subj-group><subject>Population biology</subject></subj-group><subj-group><subject>Systems biology</subject></subj-group><subj-group><subject>Theoretical biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer and information sciences</subject><subj-group><subject>Computerized simulations</subject></subj-group><subj-group><subject>Computer modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Stochastic Dynamics of Interacting Haematopoietic Stem Cell Niche Lineages</article-title>
<alt-title alt-title-type="running-head">Stochastic Dynamics of Stem Cell Lineages</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Székely</surname><given-names>Tamás</given-names><suffix>Jr</suffix></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Burrage</surname><given-names>Kevin</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mangel</surname><given-names>Marc</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bonsall</surname><given-names>Michael B.</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Computer Science, University of Oxford, Oxford, United Kingdom</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Mathematics, Queensland University of Technology, Brisbane, Queensland, Australia</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Applied Mathematics and Statistics, University of California Santa Cruz, Santa Cruz, California, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Department of Biology, University of Bergen, Bergen, Norway</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Mathematical Ecology Research Group, Department of Zoology, University of Oxford, Oxford, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Santos</surname><given-names>Francisco C.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>ATP-Group, Portugal</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">tamas.szekely@cs.ox.ac.uk</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: TS MM MBB. Performed the experiments: TS. Analyzed the data: TS. Wrote the paper: TS KB MM MBB. Developed the simulation methods: TS KB. Implemented the simulations: TS. Supervised the work: MBB MM.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>9</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>4</day><month>9</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>9</issue>
<elocation-id>e1003794</elocation-id>
<history>
<date date-type="received"><day>19</day><month>2</month><year>2014</year></date>
<date date-type="accepted"><day>4</day><month>7</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Székely et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Since we still know very little about stem cells in their natural environment, it is useful to explore their dynamics through modelling and simulation, as well as experimentally. Most models of stem cell systems are based on deterministic differential equations that ignore the natural heterogeneity of stem cell populations. This is not appropriate at the level of individual cells and niches, when randomness is more likely to affect dynamics. In this paper, we introduce a fast stochastic method for simulating a metapopulation of stem cell niche lineages, that is, many sub-populations that together form a heterogeneous metapopulation, over time. By selecting the common limiting timestep, our method ensures that the entire metapopulation is simulated synchronously. This is important, as it allows us to introduce interactions between separate niche lineages, which would otherwise be impossible. We expand our method to enable the coupling of many lineages into niche groups, where differentiated cells are pooled within each niche group. Using this method, we explore the dynamics of the haematopoietic system from a demand control system perspective. We find that coupling together niche lineages allows the organism to regulate blood cell numbers as closely as possible to the homeostatic optimum. Furthermore, coupled lineages respond better than uncoupled ones to random perturbations, here the loss of some myeloid cells. This could imply that it is advantageous for an organism to connect together its niche lineages into groups. Our results suggest that a potential fruitful empirical direction will be to understand how stem cell descendants communicate with the niche and how cancer may arise as a result of a failure of such communication.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Stem cells portend great potential for advances in medicine. However, these advances require detailed understanding of the dynamics of stem cells. <italic>In vitro</italic> studies are now routine and challenge our preconceptions about stem cell biology, but the dynamics of stem cells <italic>in vivo</italic> remain poorly understood. Thus, there is a real need for novel computational frameworks for general understanding and predictions about experiments on stem cells in their native environments. By implementing a stochastic model of stem cell dynamics, generically based on the bone marrow system, in a novel, fast and computationally efficient way, we show how different couplings of stem cell niche lineages lead to different predictions about homeostatic control. Understanding the demand control of stem cell systems is essential to both predicting <italic>in vivo</italic> stem cell dynamics and also how its breakdown may lead to the development of cancers of the blood system.</p>
</abstract>
<funding-group><funding-statement>TS was supported during part of this work by the Engineering and Physical Sciences Research Council through the Systems Biology Doctoral Training Centre, University of Oxford. MM was partially funded by NSF grant EF-0924195. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="19"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Stem cells offer exciting potential for regenerative therapy, with ultimate possibilities being the ability to regenerate limbs and heal genetic diseases <xref ref-type="bibr" rid="pcbi.1003794-Mason1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Wagers1">[2]</xref>. Although studies have begun to address these issues, much work remains to be done <xref ref-type="bibr" rid="pcbi.1003794-Weissman1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Gurtner1">[4]</xref>. Indeed, much of our knowledge of stem cells is derived from <italic>in vitro</italic> experiments, where the stem cells have been relocated from their native environment. For instance, in haematopoietic (blood-producing) stem cell experiments the stem cells are often isolated from a donor, expanded <italic>in vitro</italic>, and transplanted into a lethally irradiated host, with the question of interest being how the stem cells respond to this new environment (e.g., <xref ref-type="bibr" rid="pcbi.1003794-Till1">[5]</xref>). However, it is difficult to draw conclusions about the role and behaviour of stem cells <italic>in vivo</italic>, when experimentally we must investigate them in foreign environments <xref ref-type="bibr" rid="pcbi.1003794-Fuchs1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Metcalf1">[7]</xref>. Thus, theoretical models of stem cell systems are valuable tools, allowing us to think about stem cells in their native environments when this cannot yet be done experimentally.</p>
<p><italic>In vivo</italic>, stem cells are generally found in special microenvironments, or niches, which are defined by a complex set of biochemical and physical conditions that feed back on each other <xref ref-type="bibr" rid="pcbi.1003794-Wagers1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Scadden1">[8]</xref>. Niches play a critical role in the function and behaviour of stem cells <xref ref-type="bibr" rid="pcbi.1003794-Wagers1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Lander1">[9]</xref>. For instance, experimentally changing certain niche attributes affects the dynamics of the stem cells inside them <xref ref-type="bibr" rid="pcbi.1003794-Peerani1">[10]</xref>. In addition, stem cells are often not single entities that exist independently of each other, but instead form an interacting population that includes stem cells and their more differentiated products, both within and outside the niche <xref ref-type="bibr" rid="pcbi.1003794-Stine1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Hsu1">[12]</xref>. Moreover, even separate niches can affect each other, for instance through the effects of their daughter cells or migration (e.g., <xref ref-type="bibr" rid="pcbi.1003794-Takeda1">[13]</xref>).</p>
<p>We focus on modelling the haematopoietic stem cell (HSC) system, for two reasons. Firstly, it is probably the most well-characterised stem cell system; secondly, it is representative of stem cell systems in general, incorporating their essential properties such as self-renewal, differentiation, multiple lineage choices and feedbacks to regulate cell populations <xref ref-type="bibr" rid="pcbi.1003794-Lander1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Orkin1">[14]</xref>. This allows us to start thinking about heterogeneity and the introduction of population interactions in a comparatively simple setting <xref ref-type="bibr" rid="pcbi.1003794-Mangel1">[15]</xref>. It seems that there are a minimum of two distinct niche types in bone marrow, although their relationship to each other is not fully clear, nor has their connection to the different primitive cell types been unambiguously elucidated <xref ref-type="bibr" rid="pcbi.1003794-LoCelso1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003794-Morrison2">[20]</xref>. Spatially, the HSCs themselves are spread throughout the bone marrow (as well as certain other organs, such as the liver and spleen), each in its own individual ‘facultative niche’ <xref ref-type="bibr" rid="pcbi.1003794-Morrison1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Kiel2">[21]</xref>–<xref ref-type="bibr" rid="pcbi.1003794-Hawkins1">[24]</xref>. To be precise in our definition, henceforth we refer only to these facultative niches as ‘niches’. Bone marrow thus contains an entire population of niches, with each niche containing small numbers of HSCs, and these HSCs can differentiate into blood cells, which eventually join the bloodstream.</p>
<p>The HSC system operates by demand control <xref ref-type="bibr" rid="pcbi.1003794-Metcalf2">[25]</xref>: there is a target level of differentiated blood cells, the homeostatic level, which is set by natural selection <xref ref-type="bibr" rid="pcbi.1003794-Mangel1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Mangel2">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>, and which the organism attains by differentiation of the HSCs and blood progenitor cells into appropriate differentiated blood cell types <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Lander2">[28]</xref>. This seems to be achieved by feedback from the differentiated progeny of the HSCs in the bloodstream <xref ref-type="bibr" rid="pcbi.1003794-Lander2">[28]</xref>–<xref ref-type="bibr" rid="pcbi.1003794-deGraaf1">[30]</xref>. In addition, there is also feedback from differentiated progeny that have not entered the bloodstream, but remain localised to the niche <xref ref-type="bibr" rid="pcbi.1003794-Hsu1">[12]</xref>. The HSC system must respond rapidly to perturbations such as wounding or infection, and even under normal conditions the blood cell turnover of an average human being is around one trillion cells per day <xref ref-type="bibr" rid="pcbi.1003794-Ogawa1">[31]</xref>. Such enormous numbers mean that it is important to have a robust feedback mechanism for proper functioning of the system.</p>
<p>The complex nature of the HSC system, with different blood cell types and feedbacks, as well as many spatially separate niches, means that it is difficult to model. In general, current models of stem cell dynamics involve either only one focal stem cell, or a homogeneous population of each cell type, and are modelled using ordinary differential equations (ODEs) <xref ref-type="bibr" rid="pcbi.1003794-Mangel1">[15]</xref>. Although such models can give useful results, it is important to include heterogeneity in the picture <xref ref-type="bibr" rid="pcbi.1003794-Huang1">[32]</xref>. For example, there is considerable heterogeneity between individual stem cell clones <xref ref-type="bibr" rid="pcbi.1003794-Osafune1">[33]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Sieburg1">[34]</xref>; this heterogeneity is also present <italic>within</italic> clonal cell lines <xref ref-type="bibr" rid="pcbi.1003794-Huang2">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Lander3">[36]</xref>, and was even observed many years ago by Till et al. <xref ref-type="bibr" rid="pcbi.1003794-Till1">[5]</xref>, as well as by Suda et al. <xref ref-type="bibr" rid="pcbi.1003794-Suda1">[37]</xref>. However, in the intervening decades the deterministic view of stem cell differentiation has taken hold with great success and has led towards understanding the feedback between differentiated and primitive cells <xref ref-type="bibr" rid="pcbi.1003794-Lander2">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-MarciniakCzochra1">[38]</xref>. More recently there has been a shift in emphasis, with stochastic models being used to examine the dynamics and the evolution of mutations in a stem cell population <xref ref-type="bibr" rid="pcbi.1003794-Dingli1">[39]</xref>, phenotypic equilibrium in a cancer cell population <xref ref-type="bibr" rid="pcbi.1003794-Gupta1">[40]</xref>, and the effects of different control mechanisms on stem cell populations <xref ref-type="bibr" rid="pcbi.1003794-Sun1">[41]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Komarova1">[42]</xref>.</p>
<p>Two of us have already proposed a population biology framework for stem cell dynamics, with the theme “stem cell biology is population biology” <xref ref-type="bibr" rid="pcbi.1003794-Mangel1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>. We used an ODE model of one niche lineage to show how evolution affects the decision of whether to differentiate into myeloid or lymphoid cells. In this paper, we expand on this framework by considering the stochastic dynamics of a heterogeneous metapopulation of niche lineages, comprised of stem, progenitor and differentiated blood cells. For simplicity, we restrict our study to intrinsic heterogeneity only (that is heterogeneity arising in a clonal cell population in an identical environment). We take into account the further consideration that while the niches (containing the primitive cells) may be distinct, the blood cells are mixed in the bloodstream, and the niche lineages could be controlled by feedback from the entire bloodstream rather than just their own, possibly localised, descendants. Thus we <italic>couple together</italic> separate niche lineages, allowing them to interact with each other through their differentiated progeny. Our main aims in this paper are to 1) establish the stochastic framework, 2) investigate the dynamics of the stochastic system, 3) explore how coupling niche lineages together into niche groups affects the system dynamics, and 4) whether it has any effect on the response of the entire system to a perturbation.</p>
<p>We first develop the stochastic modelling framework. Since stochastic simulations can be slow, we introduce a fast, approximate method for simulating an entire metapopulation of HSC niche lineages. We then describe how to take into account the interactions (feedbacks) from the differentiated blood cells on to the primitive cells in the niche (stem and progenitor cells) in our simulations. We simulate a metapopulation of lineages through time, which first settles to homeostasis and is then perturbed by reducing blood cell numbers. After the perturbation, there is a peak in blood cell numbers as the stem and progenitor cells replenish them. We investigate the effects of coupling niche lineages together: that is, what happens when the feedbacks are averaged across many niche lineages (the number of niches averaged over is called the ‘niche group size’). We find that 1) coupling niche lineages shifts the mean cell populations at steady state, and changes the shape of the cells’ distributions; 2) as more lineages are coupled together, the total blood cells in each coupled niche group approach the target steady state of the system; 3) different perturbation types elicit a different response from the system, and when blood cells are perturbed randomly, niche lineages coupled into larger groups respond better than smaller groups and uncoupled lineages. Taken together, these results imply that for the organism, connecting the individual niche lineages into larger niche groups is advantageous, both for optimal regulation of the overall system and for responding to random perturbations.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>HSC Model</title>
<p>We begin with the model of the HSC system as developed by Mangel and Bonsall <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>, which characterises the stem cell niche and its products as a control system driven ultimately by demand from the organism (<xref ref-type="fig" rid="pcbi-1003794-g001">Fig. 1</xref>). The system consists of a HSC niche, containing stem and progenitor cells, and its fully differentiated progeny cells in the bloodstream. The demand from the organism occurs via changes in the levels of differentiated blood cells, which feed back this demand to the primitive (stem and progenitor) cells.</p>
<fig id="pcbi-1003794-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g001</object-id><label>Figure 1</label><caption>
<title>One niche lineage of the stochastic system, with all state transitions and feedbacks shown.</title>
<p>Functions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e001" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e002" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e003" xlink:type="simple"/></inline-formula> are feedbacks on to the activity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e004" xlink:type="simple"/></inline-formula>, differentiation rate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e005" xlink:type="simple"/></inline-formula> and activity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e006" xlink:type="simple"/></inline-formula>, respectively, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e007" xlink:type="simple"/></inline-formula> is the so-called MPCR, which determines the probability of an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e008" xlink:type="simple"/></inline-formula> transitioning to either the lymphoid or myeloid lineages, and is defined in Eq. (2).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g001" position="float" xlink:type="simple"/></fig>
<p>Specifically, the model is comprised of the populations of stem cells (<italic>S</italic>), multipotent progenitor cells (<italic>MPP</italic>), common lymphoid and common myeloid progenitor cells (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e010" xlink:type="simple"/></inline-formula>, respectively) and their fully differentiated products, lymphoid and myeloid blood cells (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e011" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e012" xlink:type="simple"/></inline-formula>, respectively). Although there are many differentiated blood cell types (see, for example, <xref ref-type="bibr" rid="pcbi.1003794-Orkin1">[14]</xref>), here we classify them as myeloid and lymphoid types for the sake of simplicity. Thus our model has six state variables, to correspond to the population of each cell type, with certain transitions allowed between the states: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e013" xlink:type="simple"/></inline-formula> self-renewal via either symmetric or asymmetric division; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e014" xlink:type="simple"/></inline-formula> (symmetric) differentiation; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e015" xlink:type="simple"/></inline-formula> multiplication or differentiation into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e016" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e017" xlink:type="simple"/></inline-formula>, i.e. either the lymphoid or myeloid route, with relative probabilities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e018" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e019" xlink:type="simple"/></inline-formula>, respectively (see below); <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e020" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e021" xlink:type="simple"/></inline-formula> differentiation into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e022" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e023" xlink:type="simple"/></inline-formula>, respectively; in addition, all cell types can die. In <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>, these transitions are written down as a set of ODEs (also given in Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref>, Section 1), which give the rate of change of each state in time as a function of the current state. Here, we use the stochastic version of this model, given by formulae for each transition between the states, which occur probabilistically (<xref ref-type="table" rid="pcbi-1003794-t001">Table 1</xref>).</p>
<table-wrap id="pcbi-1003794-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.t001</object-id><label>Table 1</label><caption>
<title>Transitions in the stochastic model.</title>
</caption><alternatives><graphic id="pcbi-1003794-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">#</td>
<td align="left" rowspan="1" colspan="1">Transition</td>
<td align="left" rowspan="1" colspan="1">Transition propensity</td>
<td align="left" rowspan="1" colspan="1">Process</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e024" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e025" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e026" xlink:type="simple"/></inline-formula> symmetric division (self-renewal)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e027" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e028" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e029" xlink:type="simple"/></inline-formula> asymmetric division (self-renewal)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e030" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e031" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e032" xlink:type="simple"/></inline-formula> symmetric differentiation</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e033" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e034" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e035" xlink:type="simple"/></inline-formula> death</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e036" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e037" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e038" xlink:type="simple"/></inline-formula> renewal</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e039" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e040" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e041" xlink:type="simple"/></inline-formula> differentiation to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e042" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e043" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e044" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e045" xlink:type="simple"/></inline-formula> differentiation to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e046" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">8</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e047" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e048" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e049" xlink:type="simple"/></inline-formula> death</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e050" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e051" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e052" xlink:type="simple"/></inline-formula> differentiation</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">10</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e053" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e054" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e055" xlink:type="simple"/></inline-formula> death</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">11</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e056" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e057" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e058" xlink:type="simple"/></inline-formula> differentiation</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e059" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e060" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e061" xlink:type="simple"/></inline-formula> death</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">13</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e062" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e063" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e064" xlink:type="simple"/></inline-formula> death</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e065" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e066" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e067" xlink:type="simple"/></inline-formula> death</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>The time-dependence of the state variables has been explicitly stated in the transition propensities to differentiate the state variables from parameters.</p></fn></table-wrap-foot></table-wrap>
<p>The model also incorporates four different feedbacks from the blood cells <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e068" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e069" xlink:type="simple"/></inline-formula> on to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e070" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e071" xlink:type="simple"/></inline-formula> cells. Three of these, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e072" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e073" xlink:type="simple"/></inline-formula>, take the form<disp-formula id="pcbi.1003794.e074"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003794.e074" xlink:type="simple"/><label>(1)</label></disp-formula>where their respective parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e075" xlink:type="simple"/></inline-formula> are defined in <xref ref-type="table" rid="pcbi-1003794-t002">Table 2</xref>. These inhibit the activity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e076" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e077" xlink:type="simple"/></inline-formula> when blood cell levels are high. Specifically, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e078" xlink:type="simple"/></inline-formula> inhibits all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e079" xlink:type="simple"/></inline-formula> activity (both self-renewal and differentiation), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e080" xlink:type="simple"/></inline-formula> inhibits <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e081" xlink:type="simple"/></inline-formula> symmetric differentiation only and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e082" xlink:type="simple"/></inline-formula> inhibits all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e083" xlink:type="simple"/></inline-formula> activity. The form of Eq. (1) is based on earlier studies <xref ref-type="bibr" rid="pcbi.1003794-Lander2">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-MarciniakCzochra1">[38]</xref>, and conforms to the assumptions that: 1) numbers of both blood cell types have an effect on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e084" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e085" xlink:type="simple"/></inline-formula> activity, 2) their effects are additive, 3) the strength is different for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e086" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e087" xlink:type="simple"/></inline-formula> cells, and 4) when numbers of either fall, the activity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e088" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e089" xlink:type="simple"/></inline-formula> increases again. Note that feedbacks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e090" xlink:type="simple"/></inline-formula> always take values on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e091" xlink:type="simple"/></inline-formula>.</p>
<table-wrap id="pcbi-1003794-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.t002</object-id><label>Table 2</label><caption>
<title>Constants and parameters in the stochastic model.</title>
</caption><alternatives><graphic id="pcbi-1003794-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Parameter</td>
<td align="left" rowspan="1" colspan="1">Value</td>
<td align="left" rowspan="1" colspan="1">Description</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e092" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">varied</td>
<td align="left" rowspan="1" colspan="1">Niche group size</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e093" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">10</td>
<td align="left" rowspan="1" colspan="1">Niche carrying capacity of stem cells</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e094" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Eq. (2)</td>
<td align="left" rowspan="1" colspan="1">MPCR</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e095" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">varied</td>
<td align="left" rowspan="1" colspan="1">MPCR parameter (exponent)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e096" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">varied</td>
<td align="left" rowspan="1" colspan="1">MPCR parameter (multiplier)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e097" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Eq. (1)</td>
<td align="left" rowspan="1" colspan="1">Feedback from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e098" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e099" xlink:type="simple"/></inline-formula> on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e100" xlink:type="simple"/></inline-formula> activity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e101" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Eq. (1)</td>
<td align="left" rowspan="1" colspan="1">Feedback from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e102" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e103" xlink:type="simple"/></inline-formula> on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e104" xlink:type="simple"/></inline-formula> differentiation</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e105" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Eq. (1)</td>
<td align="left" rowspan="1" colspan="1">Feedback from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e106" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e107" xlink:type="simple"/></inline-formula> on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e108" xlink:type="simple"/></inline-formula> activity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e109" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">2.5</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e110" xlink:type="simple"/></inline-formula> symmetric division (self-renewal) rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e111" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e112" xlink:type="simple"/></inline-formula> asymmetric division (self-renewal) rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e113" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.001</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e114" xlink:type="simple"/></inline-formula> (symmetric) differentiation rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e115" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e116" xlink:type="simple"/></inline-formula> differentiation rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e117" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e118" xlink:type="simple"/></inline-formula> differentiation rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e119" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.1</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e120" xlink:type="simple"/></inline-formula> differentiation rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e121" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.25</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e122" xlink:type="simple"/></inline-formula> multiplication rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e123" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.004</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e124" xlink:type="simple"/></inline-formula> death rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e125" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.02</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e126" xlink:type="simple"/></inline-formula> death rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e127" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.001</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e128" xlink:type="simple"/></inline-formula> death rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e129" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.001</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e130" xlink:type="simple"/></inline-formula> death rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e131" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.028</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e132" xlink:type="simple"/></inline-formula> death rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e133" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.01</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e134" xlink:type="simple"/></inline-formula> death rate</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e135" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e136" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Feedback parameter of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e137" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e138" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e139" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e140" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Feedback parameter of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e141" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e142" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e143" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e144" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Feedback parameter of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e145" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e146" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e147" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e148" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Feedback parameter of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e149" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e150" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e151" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e152" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Feedback parameter of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e153" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e154" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e155" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e156" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">Feedback parameter of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e157" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e158" xlink:type="simple"/></inline-formula></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>*Note: these parameters change depending on the niche group size, in order to maintain the same stable state at homeostasis, thus allowing equal comparison between them.</p></fn></table-wrap-foot></table-wrap>
<p>The last feedback is perhaps the most interesting, and is one aspect that differentiates this model from previous work. We refer to it as the Multipotent Progenitor Commitment Response, or MPCR <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>. This feedback determines the probability of an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e159" xlink:type="simple"/></inline-formula> cell differentiating into either the lymphoid or myeloid routes. The idea behind this is that when blood cell numbers are not at their homeostatic levels (defined as a specific target value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e160" xlink:type="simple"/></inline-formula>), the MPCR aims to shift the production of new blood cells to the appropriate type. We model the MPCR as<disp-formula id="pcbi.1003794.e161"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003794.e161" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e162" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e163" xlink:type="simple"/></inline-formula> are positive parameters. When either <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e164" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e165" xlink:type="simple"/></inline-formula> (states that are not reached in practice by the deterministic model, but do occur in the stochastic model) this causes a problem in Eq. (2), so in this event we simply treat <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e166" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e167" xlink:type="simple"/></inline-formula>, respectively, for the purposes of evaluating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e168" xlink:type="simple"/></inline-formula>; this has the advantage of affecting the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e169" xlink:type="simple"/></inline-formula> by only a small amount whilst keeping the MPCR pressure towards the correct cell type.</p>
<p>We set the MPCR parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e170" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e171" xlink:type="simple"/></inline-formula> to give a target homeostatic blood cell ratio, which here is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e172" xlink:type="simple"/></inline-formula> to loosely correspond to that in humans. To do this, we note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e173" xlink:type="simple"/></inline-formula> is defined as the probability of an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e174" xlink:type="simple"/></inline-formula> differentiating to a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e175" xlink:type="simple"/></inline-formula>, i.e. at homeostasis we have on average <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e176" xlink:type="simple"/></inline-formula>. From this, we can also specify steady states using the blood cell numbers, i.e. as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e177" xlink:type="simple"/></inline-formula>, provided that the differentiation and death rates are identical for both <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e178" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e179" xlink:type="simple"/></inline-formula>, as well as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e180" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e181" xlink:type="simple"/></inline-formula> (however, we examine the general case and use a parameter setup where the death rates of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e182" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e183" xlink:type="simple"/></inline-formula> are not equal, but the only consequence is that the homeostatic state will not be exactly equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e184" xlink:type="simple"/></inline-formula> for the chosen <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e185" xlink:type="simple"/></inline-formula>; we explain this issue further in Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref>, Section 2). Now, at homeostasis we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e186" xlink:type="simple"/></inline-formula>. We then substitute these values into Eq. (2), choose a value for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e187" xlink:type="simple"/></inline-formula> and so calculate the corresponding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e188" xlink:type="simple"/></inline-formula>. We can do this for different combinations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e189" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e190" xlink:type="simple"/></inline-formula>, thus varying the strength of the response whilst retaining the same target cell ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e191" xlink:type="simple"/></inline-formula>.</p>
<p>Although many combinations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e192" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e193" xlink:type="simple"/></inline-formula> can give the same homeostatic ratio of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e194" xlink:type="simple"/></inline-formula>, they strongly affect the sensitivity of the MPCR to changes in cell numbers and its response to perturbations. In <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>, we used this model to examine the behaviour of the haematopoietic system from an evolutionary perspective. Treating it as a demand control system, where the demand comes from the entire organism, we showed that there is varying selection on organisms with different MPCR parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e195" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e196" xlink:type="simple"/></inline-formula>. Different organisms can thus evolve a range of parameters as their environments vary, and this affects the dynamics of their haematopoietic system as well as its response to perturbations. This implies that it is important to take into account the evolutionary background of an organism when examining the dynamics of the haematopoietic system, and stem cell systems in general. This is consistent with the idea that stem cells are units of evolution <xref ref-type="bibr" rid="pcbi.1003794-Weissman2">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Laird1">[44]</xref>.</p>
</sec><sec id="s2b">
<title>Stochastic HSC Model</title>
<p>The system of ODEs for the deterministic HSC model (Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref>, Section 1 and Ref. <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>) can be considered the <italic>continuously-conditioned average</italic> of the stochastic system <xref ref-type="bibr" rid="pcbi.1003794-Gillespie1">[45]</xref>. If these ODEs were linear, we could say that they represent the mean of the stochastic system (that is, the initially-conditioned average: see <xref ref-type="bibr" rid="pcbi.1003794-Gillespie1">[45]</xref>); however, as they are non-linear due to the feedback functions, we cannot tell <italic>a priori</italic> the relationship between the deterministic and stochastic solutions (although having said this, initial explorations of a much simpler stem cell system found the ODE solution to be reasonably close to the stochastic mean in the case of a single lineage with feedbacks <xref ref-type="bibr" rid="pcbi.1003794-Mangel1">[15]</xref>). In general, ODE models are not able to account for the full range of dynamics of highly stochastic systems, and in extreme cases can even give results that are unrepresentative of the full behaviour of the system <xref ref-type="bibr" rid="pcbi.1003794-Goutsias1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Wilkinson1">[47]</xref>. The stochastic formulation of the ODE model also has six states and fourteen transitions between the states. However, rather than occurring at deterministic <italic>rates</italic>, these transitions now occur with particular <italic>propensities</italic> at each step of the simulation.</p>
<p>The stochastic simulation algorithm (SSA), developed by Gillespie <xref ref-type="bibr" rid="pcbi.1003794-Gillespie2">[48]</xref>, allows us to simulate such a system in a statistically exact way. We first describe it in general terms and then discuss its application to the HSC system. In general, we consider a set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e197" xlink:type="simple"/></inline-formula> types of transitions between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e198" xlink:type="simple"/></inline-formula> kinds of cells. We track cell populations through time with the state vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e199" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e200" xlink:type="simple"/></inline-formula> represents the number of cells of type <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e201" xlink:type="simple"/></inline-formula> at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e202" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e203" xlink:type="simple"/></inline-formula> denotes the matrix transpose. We let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e204" xlink:type="simple"/></inline-formula> denote the cell type index and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e205" xlink:type="simple"/></inline-formula> denote the transition index; boldface font represents a vector of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e206" xlink:type="simple"/></inline-formula>.</p>
<p>The SSA is a simple and powerful method, and essentially consists of finding, at each step, the time until the next transition and which transition occurs. To do this, we define the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e207" xlink:type="simple"/></inline-formula> vector of propensity functions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e208" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e209" xlink:type="simple"/></inline-formula> is the probability of transition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e210" xlink:type="simple"/></inline-formula> occurring in an infinitesimal time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e211" xlink:type="simple"/></inline-formula>, and where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e212" xlink:type="simple"/></inline-formula> represents terms of higher order in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e213" xlink:type="simple"/></inline-formula> (for further details about the importance of this term, see <xref ref-type="bibr" rid="pcbi.1003794-Mangel4">[49]</xref>). In addition, we have a stoichiometric matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e214" xlink:type="simple"/></inline-formula> of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e215" xlink:type="simple"/></inline-formula>, which represents how each transition affects the numbers of cells. Knowledge of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e216" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e217" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e218" xlink:type="simple"/></inline-formula> is all that we need in order to simulate the time dependence of the HSC system.</p>
<p>The time until the next transition, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e219" xlink:type="simple"/></inline-formula>, is sampled from an exponential random variable with parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e220" xlink:type="simple"/></inline-formula>, where<disp-formula id="pcbi.1003794.e221"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003794.e221" xlink:type="simple"/></disp-formula></p>
<p>This implies that the probability of no transition in the next <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e222" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e223" xlink:type="simple"/></inline-formula>, which can be expanded as a Taylor series to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e224" xlink:type="simple"/></inline-formula>. Given that a transition occurs, the probability that it has index <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e225" xlink:type="simple"/></inline-formula> is<disp-formula id="pcbi.1003794.e226"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003794.e226" xlink:type="simple"/></disp-formula></p>
<p>Once these two have been chosen, the state vector is updated as<disp-formula id="pcbi.1003794.e227"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003794.e227" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e228" xlink:type="simple"/></inline-formula> is the index of the transition that occurred and</p>
<p><disp-formula id="pcbi.1003794.e229"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003794.e229" xlink:type="simple"/></disp-formula></p>
<p>The SSA was initially developed to simulate the interactions of different chemical species in a dilute gas, and has since been extended to dilute solutions <xref ref-type="bibr" rid="pcbi.1003794-Gillespie3">[50]</xref>. Both of these scenarios assume that the system is macroscopically well-stirred and homogeneous. The usual mass-action form of its propensity functions are directly based on these assumptions. In order to use the SSA with the HSC system, which does not necessarily obey either assumption, we adopt instead a <italic>phenomenological</italic> approach to definining the propensity functions, as is the custom when constructing ODE population models. In effect, we simply convert the transition rates of the ODE system into transition propensities. The form of the propensities depends on our assumptions regarding the processes involved: thus here, the propensities are dependent upon a rate constant, the population of the transitioning cell type, and in the case of stem and progenitor cells, also the feedbacks that we have assumed exist (<xref ref-type="table" rid="pcbi-1003794-t001">Table 1</xref>). Note that the propensities give the probability of a reaction occurring <italic>per unit time</italic>, and therefore are not required to remain on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e230" xlink:type="simple"/></inline-formula>. For our HSC model simulations, we define the state vector as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e231" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2c">
<title>Fast Stochastic Simulations</title>
<p>The SSA framework of the previous section is both simple and statistically exact, meaning that a histogram built up of an infinite number of simulations is identical to the true histogram of the system. However, especially for systems with larger populations (generally, hundreds or thousands of cells, or more), faster transitions or those whose transition rates have a complicated form, it can become slow. For such systems, if computational time is an issue, it is more appropriate to use an approximate method. A common example of such a method is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e232" xlink:type="simple"/></inline-formula>-leap method <xref ref-type="bibr" rid="pcbi.1003794-Gillespie4">[51]</xref>, which evaluates many transitions in one (larger) step, thereby speeding up computation.</p>
<p>The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e233" xlink:type="simple"/></inline-formula>-leap update formula also takes the form in Eq. (3), but rather than a single transition, now the number of transitions occurring in each channel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e234" xlink:type="simple"/></inline-formula> over each step <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e235" xlink:type="simple"/></inline-formula>, represented by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e236" xlink:type="simple"/></inline-formula>, is given by<disp-formula id="pcbi.1003794.e237"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003794.e237" xlink:type="simple"/><label>(4)</label></disp-formula>i.e. it is a Poisson random number with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e238" xlink:type="simple"/></inline-formula>. This approach can greatly speed up computation, although it incurs a loss in accuracy. The stepsize can be varied, and is commonly chosen to be sufficiently small to achieve reasonable accuracy but sufficiently large to increase the computational speed. A simple way of doing this is to bound the change in each cell population over one step, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e239" xlink:type="simple"/></inline-formula>, by a small fraction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e240" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e241" xlink:type="simple"/></inline-formula>. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e242" xlink:type="simple"/></inline-formula> is a random variable, in practice this means bounding its mean and standard deviation. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e243" xlink:type="simple"/></inline-formula> can then be chosen to be consistent with these bounds. For the simulations in this paper, we have used a simple version of this scheme (set out in detail in <xref ref-type="bibr" rid="pcbi.1003794-Cao1">[52]</xref>, specifically, Eqs.(32) and (33)), without any consideration of reaction criticality. Several similar methods have been proposed with higher efficiency or accuracy (for example, <xref ref-type="bibr" rid="pcbi.1003794-Hu1">[53]</xref>–<xref ref-type="bibr" rid="pcbi.1003794-Szkely2">[55]</xref>). Since we introduce additional complexity by simulating an entire metapopulation of lineages and coupling them, here we have chosen to use a simple stepsize-adapting scheme.</p>
</sec><sec id="s2d">
<title>Simulating a Metapopulation of Niche Lineages: Vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e244" xlink:type="simple"/></inline-formula>-Leap</title>
<p>In order to simulate a large number of niche lineages, we expand the Gillespie SSA/<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e245" xlink:type="simple"/></inline-formula>-leap approach from just one sub-simulation (i.e., lineage) to many. By including interaction terms between each individual niche lineage, we can easily simulate an entire interacting heterogeneous metapopulation of niche lineages. The heterogeneity results only from intrinsic noise, that is, noise arising from random thermal fluctuations, which is present even in genetically identical populations in the same environment <xref ref-type="bibr" rid="pcbi.1003794-Huang2">[35]</xref>. Our method almost resembles a compartment-based model, which consists of many discrete spatial compartments, each of which is assumed to be homogeneous inside. However, as details of the spatial aspects of stem cell niches are still emerging, we chose not to explicitly equate each sub-simulation with a discrete spatial compartment; rather, each sub-simulation represents a niche lineage whose physical locations are not taken into account.</p>
<p>We take advantage of the native matrix structures of the Matlab programming language, with the state vector of each niche lineage forming one column of the overall state matrix. Thus, if there are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e246" xlink:type="simple"/></inline-formula> separate niche lineages, instead of an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e247" xlink:type="simple"/></inline-formula> state vector, we now manipulate an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e248" xlink:type="simple"/></inline-formula> <italic>state matrix</italic>. This approach is conceptually simple, easily allows for the introduction of coupling and interactions, and is especially fast (as Matlab is optimised for matrix calculations, calculating each step of the SSA scheme on a matrix rather than a vector has little effect on the speed, whereas doing the same for each niche lineage in turn would be very much slower). This state matrix approach could easily be implemented in other programming languages, and although it would not necessarily result in a large computational speedup (for instance, this is likely to be the case in the popular programming language C), we argue that it is favourable even for its inherent simplicity alone.</p>
<p>Since each sub-simulation of the SSA chooses timesteps randomly, the metapopulation of niche lineages would not be simulated in time synchronously, akin to a running race where some runners are ahead and some lag behind. Since we want to simulate an interacting, coupled metapopulation, all lineages must stay in step otherwise the interactions would effectively be averaging over time. The solution is to switch to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e249" xlink:type="simple"/></inline-formula>-leap method from the previous section, use it to choose a suitable timestep and evolve every niche lineage over this timestep. It is important to note that this does <italic>not</italic> bias our results in any way: we are only selecting a common timestep for all the lineages, but the reactions that occur in each lineage are then chosen according to the true Markov process.</p>
<p>To explain this, let us go back to basics: the evolution of each lineage is governed by a Markov jump process <xref ref-type="bibr" rid="pcbi.1003794-Kurtz1">[56]</xref>, which is approximated by the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e250" xlink:type="simple"/></inline-formula>-leap method. If we wanted to simulate a population of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e251" xlink:type="simple"/></inline-formula> niche lineages using a standard <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e252" xlink:type="simple"/></inline-formula>-leap, we would run <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e253" xlink:type="simple"/></inline-formula> repeat simulations of a single lineage. This could be done with either a fixed or an adaptive timestep, and we would sample the Markov process (carry out the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e254" xlink:type="simple"/></inline-formula>-leap update) at the time points given by those timesteps. However, the process itself is <italic>independent</italic> of the times at which we sample it (although, of course, the same cannot be said for the solution of our approximate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e255" xlink:type="simple"/></inline-formula>-leap method, which approaches the true Markov process as the timesteps decrease). Thus we are free to sample the Markov process at whatever time points we choose, provided we remember the condition on our approximate solution. Now, a reasonable part of the computational time of a leaping method is taken up with the overhead of calculating the timestep adaptively. By simulating the metapopulation simultaneously, our method allows us to choose just one timestep for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e256" xlink:type="simple"/></inline-formula> niche lineages, reducing the total overhead. The only disadvantage is that if one lineage contains unusually large populations, this would pose as a bottleneck on the common stepsize.</p>
<p>We must thus find the common limiting timestep from the whole metapopulation. First, the propensities of each transition in each niche lineage are calculated. Then, we find the lineage with the largest <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e257" xlink:type="simple"/></inline-formula>, that is the sum of the propensities. Now, we simply continue with the stepsize selection as if we were only simulating a single lineage, and its propensities were those of the selected one. Once the stepsize has been chosen, the entire metapopulation is evolved over that step using Eqs. (3) and (4). We describe this more precisely in Algorithm 1.</p>
<sec id="s2d1">
<title>Algorithm 1</title>
<p>Vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e258" xlink:type="simple"/></inline-formula>-leap</p>
<p><italic>At time </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e259" xlink:type="simple"/></inline-formula><italic>, with a metapopulation of niche lineages of size </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e260" xlink:type="simple"/></inline-formula><italic>, each taking initial states of </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e261" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e262" xlink:type="simple"/></inline-formula>:</p>
<p>0. Initialise state matrix containing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e263" xlink:type="simple"/></inline-formula> niche lineages, each with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e264" xlink:type="simple"/></inline-formula> distinct cell types: this is an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e265" xlink:type="simple"/></inline-formula> matrix containing the initial state vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e266" xlink:type="simple"/></inline-formula>. <italic>With the system in state </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e267" xlink:type="simple"/></inline-formula><italic> at time </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e268" xlink:type="simple"/></inline-formula>:</p>
<list list-type="order"><list-item>
<p>Calculate propensities of each niche lineage to get an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e269" xlink:type="simple"/></inline-formula> matrix of propensities, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e270" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e271" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Find <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e272" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Find <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e273" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e274" xlink:type="simple"/></inline-formula>, the niche lineage with highest total propensity, and assign its lineage index to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e275" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Calculate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e276" xlink:type="simple"/></inline-formula> using the stepsize-adapting procedure in <xref ref-type="bibr" rid="pcbi.1003794-Cao1">[52]</xref>, with the propensities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e277" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e278" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Update state matrix as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e279" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e280" xlink:type="simple"/></inline-formula>. If any cell type in any niche lineage goes negative, redo step using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e281" xlink:type="simple"/></inline-formula>. Otherwise, return to Step 1.</p>
</list-item></list>
<p>We select the lineage index of the highest total propensity, as this is the niche lineage with the most frequent transitions, and thus the limiting factor on the stepsize. Of course, the actual number of transitions at each step is probabilistic, so if by chance too many transitions occur for any cell type in any niche and its population goes negative, the step should be redone with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e282" xlink:type="simple"/></inline-formula> (standard procedure in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e283" xlink:type="simple"/></inline-formula>-leap methods). For even tighter control of the stepsize, instead of selecting a single niche lineage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e284" xlink:type="simple"/></inline-formula> and taking its total propensity as the limiting factor, we could instead find the lineage index of the maximum propensity of <italic>each</italic> transition. This would set a tighter bound on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e285" xlink:type="simple"/></inline-formula>, as each transition would partake in the stepsize-selection process. However we found the current method to be satisfactory.</p>
<p> Although in this paper we have used a procedure from Ref. <xref ref-type="bibr" rid="pcbi.1003794-Cao1">[52]</xref> to find the timestep, we are not restricted to this particular method. The matrix scheme we have described above is flexible, in that it can easily be fitted into <italic>any</italic> procedure for adapting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e286" xlink:type="simple"/></inline-formula>, including advanced and efficient methods such as the Stochastic Bulirsch-Stoer method <xref ref-type="bibr" rid="pcbi.1003794-Szkely2">[55]</xref> or the Theta-trapezoidal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e287" xlink:type="simple"/></inline-formula>-leap method <xref ref-type="bibr" rid="pcbi.1003794-Hu1">[53]</xref>. As long as we find the niche lineage with the most frequent reactions, we can choose a timestep based on this lineage for the entire metapopulation using any <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e288" xlink:type="simple"/></inline-formula>-adapting scheme.</p>
</sec></sec><sec id="s2e">
<title>Coupling Niche Lineages</title>
<p>Each HSC niche does not exist in isolation in the bone marrow; in fact HSCs often circulate around the bone marrow and bloodstream <xref ref-type="bibr" rid="pcbi.1003794-Wright1">[57]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Adams1">[58]</xref>. Differentiated blood cells are also, in general, ejected from the niche and enter the bloodstream, although certain differentiated cell types can remain localised to the niche <xref ref-type="bibr" rid="pcbi.1003794-Hsu1">[12]</xref>. Thus, cells from each niche lineage are mixed to various degrees after they have fully differentiated and leave the niche. To investigate the dynamics of coupling together separate niche lineages, we introduce the implementation of the coupling.</p>
<p>We assume that there is no interaction between cells that are not fully differentiated (that is, any cell type except for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e289" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e290" xlink:type="simple"/></inline-formula>). The coupling comes into effect only through the feedback functions of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e291" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e292" xlink:type="simple"/></inline-formula> cells on to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e293" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e294" xlink:type="simple"/></inline-formula> cells (although it should be noted that our computational method can handle any form of coupling). To capture this, we create ‘niche groups’, where the feedbacks on the stem and progenitor cells in each niche lineage depend on the <italic>total</italic> levels of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e295" xlink:type="simple"/></inline-formula> in the entire niche group of that lineage. In practice, this means that the blood cells <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e296" xlink:type="simple"/></inline-formula> in each lineage of a niche group are replaced in the feedback equations by the total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e297" xlink:type="simple"/></inline-formula> in that niche group (whilst normalising the parameters by the niche group size). The propensities for each niche lineage are then calculated as described in the previous section and the populations of each niche lineage updated separately (Algorithm 2).</p>
<p>To aid in visualising this, we give an example using a population of four niche lineages coupled into niche groups of size two, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e298" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003794-g002">Fig. 2</xref>). When the lineages are coupled, the feedbacks are taken over the total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e299" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e300" xlink:type="simple"/></inline-formula> in the respective niche group. Then, denoting by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e301" xlink:type="simple"/></inline-formula> the population of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e302" xlink:type="simple"/></inline-formula> from niche lineage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e303" xlink:type="simple"/></inline-formula>, and similarly for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e304" xlink:type="simple"/></inline-formula>, the feedbacks of the first two niche lineages would be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e305" xlink:type="simple"/></inline-formula>, and the last two would be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e306" xlink:type="simple"/></inline-formula>. This is the case for all feedback functions, including the MPCR. The factor of one half is necessary to normalise the steady states to be directly comparable, regardless of niche group size.</p>
<fig id="pcbi-1003794-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g002</object-id><label>Figure 2</label><caption>
<title>A population of four coupled niche lineages with a niche group size of two.</title>
<p>The MPCR from the total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e307" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e308" xlink:type="simple"/></inline-formula> cells in the niche group is fed back to both lineages. This is also the case for the feedbacks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e309" xlink:type="simple"/></inline-formula>, which are not shown.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g002" position="float" xlink:type="simple"/></fig><sec id="s2e1">
<title>Algorithm 2</title>
<p>Coupled vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e310" xlink:type="simple"/></inline-formula>-leap</p>
<p><italic>With the system in state </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e311" xlink:type="simple"/></inline-formula><italic> at time </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e312" xlink:type="simple"/></inline-formula><italic>, and </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e313" xlink:type="simple"/></inline-formula><italic> niche lineages coupled into </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e314" xlink:type="simple"/></inline-formula><italic> niche groups, i.e. niche group size </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e315" xlink:type="simple"/></inline-formula>:</p>
<list list-type="order"><list-item>
<p>Find total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e316" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e317" xlink:type="simple"/></inline-formula> for each niche group, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e318" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e319" xlink:type="simple"/></inline-formula>; i.e. take the sum of all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e320" xlink:type="simple"/></inline-formula> over each niche group and normalise by niche group size, and similarly for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e321" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Calculate MPCR values <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e322" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e323" xlink:type="simple"/></inline-formula>, and similarly for feedbacks <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e324" xlink:type="simple"/></inline-formula> to find <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e325" xlink:type="simple"/></inline-formula>. This gives a vector with length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e326" xlink:type="simple"/></inline-formula> of values for each feedback function.</p>
</list-item><list-item>
<p>From these, formulate individual feedback functions for each niche lineage (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e327" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e328" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e329" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e330" xlink:type="simple"/></inline-formula>) by taking <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e331" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e332" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e333" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e334" xlink:type="simple"/></inline-formula>, and similarly for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e335" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e336" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e337" xlink:type="simple"/></inline-formula> (i.e. assign to each individual niche lineage's feedbacks the value of its niche group's feedbacks). These are vectors of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e338" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Now proceed with Steps 1 to 5 of Algorithm 1.</p>
</list-item></list>
<p>This method allows us to evolve an entire metapopulation of niche lineages in time, and to take into account the interactions between the blood cells of different lineages in the feedbacks.</p>
</sec></sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Fast Stochastic Simulations</title>
<p>We begin by evaluating the performance of our computational method. Although it is not exact, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e339" xlink:type="simple"/></inline-formula>-leap is in general a much faster simulation method than the SSA. The error parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e340" xlink:type="simple"/></inline-formula> (introduced in the Fast Stochastic Simulation section) indicates the amount of error we allow into the leaping approximation. Common values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e341" xlink:type="simple"/></inline-formula> are of the order of 0.01, meaning roughly that the timestep selected allows at most a 1% change in the population of the rarest cell type; a value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e342" xlink:type="simple"/></inline-formula> typically corresponds to high accuracy and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e343" xlink:type="simple"/></inline-formula> to low accuracy, but this can vary.</p>
<p>We ran simulations of a metapopulation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e344" xlink:type="simple"/></inline-formula> uncoupled niche lineages with the vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e345" xlink:type="simple"/></inline-formula>-leap method described in Algorithm 1 for a wide range of values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e346" xlink:type="simple"/></inline-formula>, as well as with a vectorised SSA, and recorded the average runtimes on a standard desktop computer. The SSA can be regarded as finding the exact solution (for uncoupled niche lineages only — it loses this exactness when the lineages are coupled, see Vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e347" xlink:type="simple"/></inline-formula>-leap section). Therefore we compared the probability density functions (PDFs) returned by the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e348" xlink:type="simple"/></inline-formula>-leap to the exact PDF given by the SSA to get an idea of how the errors of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e349" xlink:type="simple"/></inline-formula>-leap simulations changed as the error parameter was varied.</p>
<p>The simulation runtimes are listed in <xref ref-type="table" rid="pcbi-1003794-t003">Table 3</xref>, as are the total errors of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e350" xlink:type="simple"/></inline-formula>-leap results. We calculated these by taking the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e351" xlink:type="simple"/></inline-formula>-distance between the weight of each bin (that is, probability density multiplied by bin width) of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e352" xlink:type="simple"/></inline-formula>-leap PDFs and that of the SSA. The runtimes decrease as the error parameters increase, with the SSA taking the longest, as expected. The self-distance of two different SSA simulations is relatively large (<xref ref-type="table" rid="pcbi-1003794-t003">Table 3</xref>, top row), indicating that the differences in errors between the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e353" xlink:type="simple"/></inline-formula>-leap with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e354" xlink:type="simple"/></inline-formula> may be due to Monte Carlo error. This means that the vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e355" xlink:type="simple"/></inline-formula>-leap with these error parameters is about as accurate as the SSA. With <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e356" xlink:type="simple"/></inline-formula>, however, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e357" xlink:type="simple"/></inline-formula>-leap does become substantially less accurate. Accordingly, in the rest of our simulations, we used <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e358" xlink:type="simple"/></inline-formula> <xref ref-type="table" rid="pcbi-1003794-t003">Table 3</xref> shows that the vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e359" xlink:type="simple"/></inline-formula>-leap is indeed faster than the SSA, significantly so when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e360" xlink:type="simple"/></inline-formula>. However, even with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e361" xlink:type="simple"/></inline-formula>, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e362" xlink:type="simple"/></inline-formula>-leap finds remarkably accurate solutions. This is compounded with the fact that the SSA should not be used to simulate coupled niche lineages, as each lineage proceeds at its own pace. These factors mean that approximate, fast methods that can sample the state matrix synchronously are most ideal for simulating larger, interacting systems such as our HSC system.</p>
<table-wrap id="pcbi-1003794-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.t003</object-id><label>Table 3</label><caption>
<title>Runtimes and errors of the vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e363" xlink:type="simple"/></inline-formula>-leap method compared to the SSA.</title>
</caption><alternatives><graphic id="pcbi-1003794-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Simulation method</td>
<td align="left" rowspan="1" colspan="1">Runtime (hours)</td>
<td align="left" rowspan="1" colspan="1">Total error</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">SSA</td>
<td align="left" rowspan="1" colspan="1">67.4</td>
<td align="left" rowspan="1" colspan="1">0.201</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e364" xlink:type="simple"/></inline-formula>-leap, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e365" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">44.6</td>
<td align="left" rowspan="1" colspan="1">0.173</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e366" xlink:type="simple"/></inline-formula>-leap, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e367" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">6.7</td>
<td align="left" rowspan="1" colspan="1">0.175</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e368" xlink:type="simple"/></inline-formula>-leap, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e369" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">2.9</td>
<td align="left" rowspan="1" colspan="1">0.189</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e370" xlink:type="simple"/></inline-formula>-leap, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e371" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.9</td>
<td align="left" rowspan="1" colspan="1">0.214</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e372" xlink:type="simple"/></inline-formula>-leap, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e373" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">0.7</td>
<td align="left" rowspan="1" colspan="1">0.312</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt103"><label/><p>The errors are calculated by subtracting the weight of each point of the PDF (that is, value multiplied by bin width) from the corresponding point of the SSA PDF. The error in the SSA row is the SSA self-distance, i.e. the error between two different SSA simulations. These simulations are of uncoupled niche lineages <italic>only</italic>, hence the SSA can be regarded as the true solution.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3b">
<title>Stochastic Model Dynamics</title>
<p>We then ran simulations of the HSC system on metapopulations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e374" xlink:type="simple"/></inline-formula> uncoupled and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e375" xlink:type="simple"/></inline-formula> coupled niche lineages for each set of parameters, using our vectorised <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e376" xlink:type="simple"/></inline-formula>-leap method from above with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e377" xlink:type="simple"/></inline-formula>. In order to investigate the coupling between different lineages, this was grouped into sub-populations (for example, 200 sub-populations of niche groups of size 100). The model is not parametrised using any specific data: the parameters in <xref ref-type="table" rid="pcbi-1003794-t002">Table 2</xref> are a canonical parameter set, chosen to elucidate general principles rather than make specific biological predictions. Due to the number of parameters, a thorough parameter sweep or sensitivity analysis was beyond the scope of this paper; however, manual experimentation using several parameter sets showed relative robustness in the system dynamics (for instance, see Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref>, Section 3). In one or two cases, we observed consistent oscillations in cell populations, qualitatively similar to Ref. <xref ref-type="bibr" rid="pcbi.1003794-Colijn1">[59]</xref>; here, we have used parameters that settle down to homeostatic cell populations. Between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e378" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e379" xlink:type="simple"/></inline-formula> seconds, transitions do not occur faster, as it may seem from some of the plots; not all transitions are recorded, and we have sampled the ones in this time period more often to give an accurate picture of the system dynamics after a perturbation.</p>
<p>We elucidate the basic dynamics of the model in <xref ref-type="fig" rid="pcbi-1003794-g003">Fig. 3</xref>, which shows a stochastic simulation of a single niche lineage along with the ODE model for comparison. We started all our simulations in the state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e380" xlink:type="simple"/></inline-formula>, i.e. with one <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e381" xlink:type="simple"/></inline-formula> and no other cells. All cell populations experience an initial surge, which then dies down to a steady state. At <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e382" xlink:type="simple"/></inline-formula> seconds, we perturbed the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e383" xlink:type="simple"/></inline-formula> cells by removing 75% of them (indicated by yellow dashed line; ODE model not perturbed). The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e384" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e385" xlink:type="simple"/></inline-formula> surge just after the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e386" xlink:type="simple"/></inline-formula> are depleted, but there seems to be little response from the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e387" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e388" xlink:type="simple"/></inline-formula> cells. Significantly, there is also little response from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e389" xlink:type="simple"/></inline-formula> cells. After around 1000 seconds the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e390" xlink:type="simple"/></inline-formula> cells return to their pre-perturbation numbers, and all three cell types then settle back to their steady states. We set the MPCR parameters to reach homeostasis at the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e391" xlink:type="simple"/></inline-formula> (corresponding to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e392" xlink:type="simple"/></inline-formula>). However, as the death rates of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e393" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e394" xlink:type="simple"/></inline-formula> were not equal, we did not expect to observe this exact homeostatic ratio; indeed, <xref ref-type="fig" rid="pcbi-1003794-g003">Fig. 3</xref> shows that the homeostatic state of the model using this particular parameter space is around <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e395" xlink:type="simple"/></inline-formula>, corresponding to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e396" xlink:type="simple"/></inline-formula> from Eq. (2) (see HSC Model section and Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref>, Section 2). The ODE model roughly follows the stochastic simulations, with both indicating similar homeostatic states.</p>
<fig id="pcbi-1003794-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g003</object-id><label>Figure 3</label><caption>
<title>Single stochastic trajectories of all cell types over time.</title>
<p>Shown are levels of A) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e397" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e398" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e399" xlink:type="simple"/></inline-formula>, and B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e400" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e401" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e402" xlink:type="simple"/></inline-formula> in a single niche lineage over the full simulation time. For comparison, ODE trajectories (with no perturbation) have been included. Yellow dashes show time at which the lineage is perturbed by removing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e403" xlink:type="simple"/></inline-formula> of its <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e404" xlink:type="simple"/></inline-formula> cells.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g003" position="float" xlink:type="simple"/></fig>
<p>In <xref ref-type="fig" rid="pcbi-1003794-g004">Fig. 4A,B,C</xref> we show the time evolution of six separate simulations each, of both uncoupled and coupled (niche group size 100) niche lineages. The first thing we notice is that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e405" xlink:type="simple"/></inline-formula> cells in some lineages die out (<xref ref-type="fig" rid="pcbi-1003794-g004">Figs. 4A and S</xref>1), but the rest of the lineage keeps functioning (<xref ref-type="supplementary-material" rid="pcbi.1003794.s001">Fig. S1</xref>). Over one quarter of all lineages had lost their <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e406" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e407" xlink:type="simple"/></inline-formula> seconds, and this number went up to over one half by the end of the simulations. Only in a handful of these cases did the entire lineage die out; the rest were maintained by the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e408" xlink:type="simple"/></inline-formula> cells. Next, the total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e409" xlink:type="simple"/></inline-formula> numbers per niche group (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e410" xlink:type="simple"/></inline-formula>, normalised by niche group size; <xref ref-type="fig" rid="pcbi-1003794-g004">Fig. 4D</xref>) are close but not identical for uncoupled and coupled niche lineages. This is supported by <xref ref-type="fig" rid="pcbi-1003794-g004">Fig. 4F</xref>, where colour indicates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e411" xlink:type="simple"/></inline-formula> numbers and which shows 100 trajectories each of uncoupled and coupled niche groups. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e412" xlink:type="simple"/></inline-formula> numbers are consistent for all niche groups, and there is also little difference between uncoupled and coupled <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e413" xlink:type="simple"/></inline-formula> numbers. In contrast, <xref ref-type="fig" rid="pcbi-1003794-g004">Fig. 4E</xref> highlights the differences between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e414" xlink:type="simple"/></inline-formula> per individual lineage seen in <xref ref-type="fig" rid="pcbi-1003794-g004">Fig. 4C:</xref> uncoupled lineage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e415" xlink:type="simple"/></inline-formula> numbers fluctuate in an uncorrelated way over time and all lineages behave in a similar way, whereas those of coupled lineages show a distinct correlation over their own trajectories, as well as considerable variation between individual niche lineages. <xref ref-type="supplementary-material" rid="pcbi.1003794.s001">Fig. S1</xref> demonstrates that this also happens, to varying degrees, for the other cell types. It is difficult to tell whether this is also the case for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e416" xlink:type="simple"/></inline-formula>, where stochastic fluctuations are large compared to cell numbers, but <xref ref-type="supplementary-material" rid="pcbi.1003794.s002">Fig. S2</xref> helps to clarify the issue: the steady states of the uncoupled and coupled <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e417" xlink:type="simple"/></inline-formula> are also fairly close but not identical (<xref ref-type="supplementary-material" rid="pcbi.1003794.s002">Fig. S2A</xref>,C), and in <xref ref-type="supplementary-material" rid="pcbi.1003794.s002">Fig. S2B</xref> we can make out the distinct lines made by the coupled lineage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e418" xlink:type="simple"/></inline-formula> levels, implying their fluctuations are correlated compared to the uncoupled lineages. To sum up so far, <xref ref-type="fig" rid="pcbi-1003794-g004">Figs. 4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003794.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003794.s002">S2</xref> tell us that 1) although there is a large surge in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e419" xlink:type="simple"/></inline-formula> numbers, there is a smaller relative response in numbers of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e420" xlink:type="simple"/></inline-formula>; 2) there is also a large surge in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e421" xlink:type="simple"/></inline-formula> numbers to replenish the lost <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e422" xlink:type="simple"/></inline-formula>, which corresponds to a modest drop in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e423" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e424" xlink:type="simple"/></inline-formula> numbers followed by a small surge to return to their steady states; 3) cell populations in individual uncoupled niche lineages fluctuate considerably with time, whereas those of coupled niche lineages less so; 4) however, cell numbers between individual coupled lineages are much more varied than those of uncoupled lineages, which are all roughly similar.</p>
<fig id="pcbi-1003794-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g004</object-id><label>Figure 4</label><caption>
<title>Trajectories of stochastic simulations of uncoupled and coupled niche lineages.</title>
<p>Shown are six individual lineage A) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e425" xlink:type="simple"/></inline-formula>, B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e426" xlink:type="simple"/></inline-formula> and C) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e427" xlink:type="simple"/></inline-formula> cell levels over time, with means superimposed; D) total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e428" xlink:type="simple"/></inline-formula> (normalised by niche group size) for six uncoupled and six coupled entire niche groups (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e429" xlink:type="simple"/></inline-formula>) over time; E) trajectories of 100 simulations of uncoupled (top half) and coupled (bottom half), where colour represents the populations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e430" xlink:type="simple"/></inline-formula> in each lineage, and similarly for F), where colour now represents total niche group <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e431" xlink:type="simple"/></inline-formula>, normalised by niche group size.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>HSC Steady State Distributions</title>
<sec id="s3c1">
<title>Varying MPCR parameters</title>
<p>In <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>, we investigated the dynamics of MPCRs with different parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e432" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e433" xlink:type="simple"/></inline-formula> and showed that different values give a different response following a perturbation; thus they are linked to the evolutionary background of the organism. In this paper, their values were always chosen to give <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e434" xlink:type="simple"/></inline-formula>, to approximately correspond to the ratio of blood cells in humans. As the choice of values is constrained to the curve given by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e435" xlink:type="simple"/></inline-formula>, we henceforth refer only to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e436" xlink:type="simple"/></inline-formula>, with the implication that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e437" xlink:type="simple"/></inline-formula> is also varied according to this curve. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e438" xlink:type="simple"/></inline-formula> can take on any positive value; zero implies a non-responsive MPCR, that is it does not react to changes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e439" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e440" xlink:type="simple"/></inline-formula>; as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e441" xlink:type="simple"/></inline-formula> increases, so does the strength of the response to non-homeostatic ratios of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e442" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e443" xlink:type="simple"/></inline-formula>. Once <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e444" xlink:type="simple"/></inline-formula> goes into the tens, the MPCR is extremely reactive, even creating extra fast-scale fluctuations in the post-perturbation cell numbers on top of the normal fluctuations involved in relaxing back to homeostatic levels. Above this, it becomes impossible to evaluate in practice, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e445" xlink:type="simple"/></inline-formula> is too small. Therefore, reasonable values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e446" xlink:type="simple"/></inline-formula> most likely lie somewhere in the range from 0.1 to 5.</p>
<p>Now, we examine the distribution of each cell type at homeostasis and how the choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e447" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e448" xlink:type="simple"/></inline-formula> affects the steady-state behaviour of the HSC system. As <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e449" xlink:type="simple"/></inline-formula> is increased, so the mean values of the cell distributions change. For some cell types the means increase (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e450" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e451" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e452" xlink:type="simple"/></inline-formula>), and for others they decrease (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e453" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e454" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e455" xlink:type="simple"/></inline-formula>), following the dynamics of the ODE model. Associated with these changes in the mean are corresponding changes in the variance of the distribution of each cell type: increasing mean also implies increasing variance, and decreasing mean decreasing variance. As examples, we highlight <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e456" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003794-g005">Fig. 5</xref>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e457" xlink:type="simple"/></inline-formula> (<xref ref-type="supplementary-material" rid="pcbi.1003794.s003">Fig. S3</xref>) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e458" xlink:type="simple"/></inline-formula> cells (<xref ref-type="supplementary-material" rid="pcbi.1003794.s004">Fig. S4</xref>), and summarise for all cell types in <xref ref-type="supplementary-material" rid="pcbi.1003794.s005">Fig. S5</xref>.</p>
<fig id="pcbi-1003794-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g005</object-id><label>Figure 5</label><caption>
<title>PDFs of both uncoupled and coupled total niche group <italic>M</italic>, for five different MPCR parameter sets.</title>
<p>The parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e459" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e460" xlink:type="simple"/></inline-formula> were always set to give cell steady state ratios of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e461" xlink:type="simple"/></inline-formula>. The plot consists of ten PDFs, five each of uncoupled and coupled niche lineages. The axes for each PDF are identical, and quantified on the left and top. MPCR parameters are varied on the bottom axis. The inset shows the variance of each PDF as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e462" xlink:type="simple"/></inline-formula> (note the broken y-axis).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g005" position="float" xlink:type="simple"/></fig>
<p>The distribution mean of the MPCR also increases with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e463" xlink:type="simple"/></inline-formula>, as does its variance (<xref ref-type="fig" rid="pcbi-1003794-g006">Fig. 6</xref>). Although the mean MPCR remains reasonably close for both coupled and uncoupled lineages, the uncoupled MPCRs have a particularly high variance, with the bulk of the distribution away from the mean as well as a long tail. The mean values of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e464" xlink:type="simple"/></inline-formula> feedbacks also increase with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e465" xlink:type="simple"/></inline-formula> (very little in the case of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e466" xlink:type="simple"/></inline-formula>; <xref ref-type="supplementary-material" rid="pcbi.1003794.s006">Fig. S6</xref>) but their variance does not seem to change consistently. However, it is possible that we observed this because the variances are very low (between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e467" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e468" xlink:type="simple"/></inline-formula>). The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e469" xlink:type="simple"/></inline-formula> feedbacks take values consistent with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e470" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e471" xlink:type="simple"/></inline-formula> cell populations.</p>
<fig id="pcbi-1003794-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g006</object-id><label>Figure 6</label><caption>
<title>PDFs of both uncoupled and coupled MPCR values in each individual niche lineage, for five different MPCR parameter sets.</title>
<p>The axes for each histogram are identical, and quantified on the left and top. MPCR parameters are varied on the bottom axis.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g006" position="float" xlink:type="simple"/></fig>
<p>Thus different <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e472" xlink:type="simple"/></inline-formula> (and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e473" xlink:type="simple"/></inline-formula>) parameters change the MPCR dynamics, which affects the homeostatic cell populations, which then affects all four feedbacks, which in turn affects the cell populations, and so on. We find that both coupled and uncoupled niche lineages behave in a similar way as the MPCR parameters are altered, albeit to varying degrees. We explore more fully why the cell populations are affected by MPCR parameters in Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref>, Section 2.</p>
</sec><sec id="s3c2">
<title>Coupling niche lineages</title>
<p>We now fix the MPCR parameters at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e474" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e475" xlink:type="simple"/></inline-formula>, to again correspond to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e476" xlink:type="simple"/></inline-formula>. These values represent a reactive but not hyperactive MPCR intended to highlight any dynamics arising from coupling niche lineages, to which we now turn our attention. When taken individually, it is the uncoupled niche lineages that are regulated more tightly, with the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e477" xlink:type="simple"/></inline-formula> numbers of the coupled lineages having a much wider distribution (<xref ref-type="fig" rid="pcbi-1003794-g007">Fig. 7A</xref>). In contrast, from a systemic view the situation is the opposite: when looking at total cell numbers per niche group (normalised by niche group size), the coupled niche groups <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e478" xlink:type="simple"/></inline-formula> have narrower distributions compared to the uncoupled ones (<xref ref-type="fig" rid="pcbi-1003794-g007">Figs. 7B and S</xref>5). This comes about because when niche lineages are coupled, blood cell numbers are regulated only at the niche group level, allowing the blood cell numbers in individual lineages to vary widely.</p>
<fig id="pcbi-1003794-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g007</object-id><label>Figure 7</label><caption>
<title>Steady-state PDFs of <italic>M</italic> cell levels and MPCR and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e479" xlink:type="simple"/></inline-formula> feedbacks for various niche group sizes.</title>
<p>Shown are A) individual niche lineage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e480" xlink:type="simple"/></inline-formula>; B) total niche group <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e481" xlink:type="simple"/></inline-formula> normalised by niche group size (inset shows the variance of the PDFs as niche group size is changed); C) individual niche MPCR values; D) individual niche <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e482" xlink:type="simple"/></inline-formula> at steady state, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e483" xlink:type="simple"/></inline-formula> seconds.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g007" position="float" xlink:type="simple"/></fig>
<p>A key difference between the distributions of the coupled and uncoupled niche group cell numbers is their mean (<xref ref-type="fig" rid="pcbi-1003794-g007">Figs. 7A,B, S</xref>7A,B and S5). Of course, this is also true for individual lineage cell populations, but is harder to notice visually; when the cell numbers are summed over niche groups, the distributions of the coupled and uncoupled niche lineages are separated (<xref ref-type="fig" rid="pcbi-1003794-g007">Figs. 7B and S</xref>7B). In all cases, the coupled and uncoupled lineage cell numbers are centred around different values. However, as the MPCR parameters affect cell steady state populations, it is not trivial to pin down which distribution is more closely centred around the target cell ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e484" xlink:type="simple"/></inline-formula>. Using a different model parameter setup (with equal death rates, thus allowing the system to reach exactly <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e485" xlink:type="simple"/></inline-formula>), we found that it was indeed the coupled niche lineages that regulated their cell populations to be closer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e486" xlink:type="simple"/></inline-formula> (Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref>, Section 3).</p>
<p>The corresponding homeostatic distributions of two of the feedback functions are shown in <xref ref-type="fig" rid="pcbi-1003794-g007">Fig. 7C,D</xref>. In contrast to the cell populations, it is the feedbacks of coupled individual niche lineages that are more tightly distributed, and this effect becomes stronger as niche group size is increased. This suggests that it may be due to the niche lineage grouping, because within each niche group the feedbacks are identical. To check this, we next calculated the mean feedbacks in each niche group. It turns out that the distribution of the feedbacks is indeed controlled by the coupling, and the mean feedbacks per niche group have similar distributions, whether they are coupled or uncoupled (<xref ref-type="supplementary-material" rid="pcbi.1003794.s008">Fig. S8</xref>). The figure also shows that the niche group size changes the feedbacks' distribution means. This is again a case of the coupled MPCRs affecting the mean cell numbers in each niche group, which then affect the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e487" xlink:type="simple"/></inline-formula> feedbacks, which in turn affect the cell numbers.</p>
<p>We find that coupling individual niche lineages together into niche groups, by pooling the blood cells of the group in the feedbacks, has an effect on the distributions of the cells as well as of the feedbacks. This effect is positive, in that it allows the blood cell numbers to be regulated more closely to the target homeostatic levels dictated by the model.</p>
</sec></sec><sec id="s3d">
<title>Perturbation Analysis</title>
<p>Next, we look more closely at the response of the system to perturbations. We examine three types of perturbation: even perturbations (37.5% reduction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e488" xlink:type="simple"/></inline-formula> from every niche lineage), uneven perturbations (75% reduction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e489" xlink:type="simple"/></inline-formula> from every <italic>second</italic> lineage only), and random, or more precisely, probabilistic, where each lineage has a 50% chance that its <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e490" xlink:type="simple"/></inline-formula> are reduced by 75%. The perturbations were chosen to cause, on average, an identical change in cell numbers across the entire population of niche lineages, that is the removal of 37.5% of the entire population of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e491" xlink:type="simple"/></inline-formula>. The actual values of 37.5% and 75% are illustrative in nature, rather than realistic examples of blood loss from injury.</p>
<p>The response of the system to perturbations is given by two main indicators: return time to homeostatic levels, and overshoot/oscillation size, defined as the difference between the maximum of the post-perturbation spike in cell numbers (and feedbacks) and their steady states. Return time, much like the homeostatic levels of the system, is dictated by the model parameters. Moreover, it is difficult to accurately measure, as even in homeostasis, there is a continuous turnover of cells, leading to fluctuations in the cell numbers. We did not find a substantial difference in return time between uncoupled and coupled niche lineages for any type of perturbation, and the ODE model and the mean of the stochastic system closely matched in this respect.</p>
<sec id="s3d1">
<title>Coupling niche lineages</title>
<p>In the interest of brevity, we first restrict ourselves to a random-type perturbation only and again fix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e492" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e493" xlink:type="simple"/></inline-formula>, and focus on coupling niche lineages. We have already seen that the distribution means of both coupled <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e494" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e495" xlink:type="simple"/></inline-formula> more closely approached the target <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e496" xlink:type="simple"/></inline-formula> as niche group size was increased; this is supported by <xref ref-type="fig" rid="pcbi-1003794-g008">Fig. 8A,B</xref>, which show the mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e497" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e498" xlink:type="simple"/></inline-formula> over time. It is important to realise that this is <italic>not</italic> a result of the averaging process to calculate total niche group <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e499" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e500" xlink:type="simple"/></inline-formula>. As a control, we also plot the distribution means of the uncoupled niche lineages, each of which were summed over niche groups as with their coupled counterparts; their mean numbers are so similar that they are almost indistinguishable from each other in the figures. In Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref> (Section 3) we show that the ODE model does give a good indication of the target mean cell populations for a given parameter set; the mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e501" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e502" xlink:type="simple"/></inline-formula> approach the ODE solution as niche group size is increased (<xref ref-type="fig" rid="pcbi-1003794-g008">Fig. 8A,B</xref>).</p>
<fig id="pcbi-1003794-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g008</object-id><label>Figure 8</label><caption>
<title>Evolution of population means and distributions of cell levels around the perturbation.</title>
<p>Population means of A) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e503" xlink:type="simple"/></inline-formula>; B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e504" xlink:type="simple"/></inline-formula> for various niche group sizes during and after the perturbation. In addition, we plot PDFs of C) individual lineage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e505" xlink:type="simple"/></inline-formula> and D) total niche group <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e506" xlink:type="simple"/></inline-formula> at the time points labelled with blue arrows in B). Arrows indicate which direction the peaks are moving with time.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g008" position="float" xlink:type="simple"/></fig>
<p>We examine the distributions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e507" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e508" xlink:type="simple"/></inline-formula> at various times throughout a random-type perturbation and its aftermath (<xref ref-type="fig" rid="pcbi-1003794-g008">Fig. 8C,D</xref>; the distribution peaks move in the directions specified by the arrows). We begin at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e509" xlink:type="simple"/></inline-formula> seconds, with the system in its homeostatic state. At <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e510" xlink:type="simple"/></inline-formula> seconds, the perturbation is applied, reducing the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e511" xlink:type="simple"/></inline-formula> cells of roughly half the niche lineages by 75%. This results in a bimodal distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e512" xlink:type="simple"/></inline-formula> (from unperturbed and perturbed lineages) for both uncoupled and coupled niche lineages (<xref ref-type="fig" rid="pcbi-1003794-g008">Fig. 8C</xref>(ii)); when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e513" xlink:type="simple"/></inline-formula> the distribution of total niche group <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e514" xlink:type="simple"/></inline-formula> is trimodal, since the possibilities are either zero, one or two perturbed niches per niche group (<xref ref-type="fig" rid="pcbi-1003794-g008">Fig. 8D</xref>(ii)). By <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e515" xlink:type="simple"/></inline-formula> seconds, the individual coupled lineages' <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e516" xlink:type="simple"/></inline-formula> cells had resumed their previous unimodal shape, but the uncoupled niches retained their bimodality (<xref ref-type="fig" rid="pcbi-1003794-g008">Fig. 8C</xref>(iii)). By <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e517" xlink:type="simple"/></inline-formula> seconds, the individual uncoupled lineages' <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e518" xlink:type="simple"/></inline-formula> cells were also starting to coalesce into a unimodal distribution again (<xref ref-type="fig" rid="pcbi-1003794-g008">Fig. 8C</xref>(v)). Throughout, except for very close to the perturbation time, the distributions of the total niche group <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e519" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e520" xlink:type="simple"/></inline-formula> kept their shape, with the coupled lineages remaining centred closer to the target homeostatic state (<xref ref-type="fig" rid="pcbi-1003794-g008">Fig. 8D</xref>).</p>
<p>Repeating this for the MPCR and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e521" xlink:type="simple"/></inline-formula> feedbacks, we see that the response of the feedbacks after the perturbation is approximately similar, albeit again with small differences in steady state (<xref ref-type="fig" rid="pcbi-1003794-g009">Fig. 9</xref>). Similarly to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e522" xlink:type="simple"/></inline-formula>, the uncoupled lineage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e523" xlink:type="simple"/></inline-formula> take a long time to recover, and even after over 200 seconds they have not returned to their initial unimodal distribution. In contrast, the coupled <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e524" xlink:type="simple"/></inline-formula> was already re-forming its unimodal distribution 5 seconds after the perturbation.</p>
<fig id="pcbi-1003794-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g009</object-id><label>Figure 9</label><caption>
<title>Evolution of population means and distributions of feedbacks around the perturbation.</title>
<p>Population means of A) MPCR values and B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e525" xlink:type="simple"/></inline-formula> for various niche group sizes during and after the perturbation. In addition, C) shows PDFs of individual MPCR and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e526" xlink:type="simple"/></inline-formula> values at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e527" xlink:type="simple"/></inline-formula>, and D) at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e528" xlink:type="simple"/></inline-formula> seconds.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g009" position="float" xlink:type="simple"/></fig></sec><sec id="s3d2">
<title>Different perturbation types</title>
<p>Finally, we investigate how the overshoots of the mean cell and feedback levels vary for all three different perturbation types: even, uneven and random (<xref ref-type="fig" rid="pcbi-1003794-g010">Fig. 10</xref>). The overshoot response of the cell populations is different for each perturbation type (<xref ref-type="fig" rid="pcbi-1003794-g010">Fig. 10A,B</xref>): even perturbations affect all lineages equally, with the overshoots of uncoupled lineages slightly lower than coupled ones. Uneven perturbations, where the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e529" xlink:type="simple"/></inline-formula> of every second niche lineage are perturbed, result in a smaller overshoot for coupled lineages than uncoupled ones, but this does not vary with niche grouping size. In contrast, random perturbations result in both a difference in overshoot between coupled and uncoupled lineages, with coupled ones having smaller overshoot, as well as a further decrease in the overshoot of the coupled lineages as more and more lineages are coupled together. The feedbacks also respond in a very similar way (<xref ref-type="fig" rid="pcbi-1003794-g010">Fig. 10C,D</xref>). Thus, we see that the response of the system is strongly dependent on perturbation type, with niche group size having no effect in the case of even and uneven perturbations, but random perturbations eliciting a more ideal response when the niche lineages are coupled in larger groups.</p>
<fig id="pcbi-1003794-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003794.g010</object-id><label>Figure 10</label><caption>
<title>Overshoots of mean cell levels and feedbacks for various niche group sizes and perturbation types.</title>
<p>Overshoots of mean A) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e530" xlink:type="simple"/></inline-formula>; B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e531" xlink:type="simple"/></inline-formula>; C) MPCR; D) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e532" xlink:type="simple"/></inline-formula> for various niche group sizes and three perturbation types. An even perturbation signifies a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e533" xlink:type="simple"/></inline-formula> reduction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e534" xlink:type="simple"/></inline-formula> in every niche lineage, uneven means a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e535" xlink:type="simple"/></inline-formula> reduction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e536" xlink:type="simple"/></inline-formula> in every second lineage and random means a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e537" xlink:type="simple"/></inline-formula> chance of each lineage losing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e538" xlink:type="simple"/></inline-formula> of its <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e539" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003794.g010" position="float" xlink:type="simple"/></fig></sec></sec></sec><sec id="s4">
<title>Discussion</title>
<p>Most of the results above were concerned with linking together separate niche lineages into groups. A large niche group size indicates that the feedback from the blood cells (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e540" xlink:type="simple"/></inline-formula>) to the primitive cells (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e541" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e542" xlink:type="simple"/></inline-formula>) is regulated by a large fraction of the overall blood cell numbers in the organism. We found that as niche group size was increased, the mean levels of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e543" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e544" xlink:type="simple"/></inline-formula> moved closer to the ODE model solutions. This is not a huge surprise: summing the blood cells in each niche group and normalising is equivalent to averaging over niche groups; the larger the niche group, therefore, the less the noise in total cell numbers per niche group, and the closer the system is to the ODE model. This is also a possible explanation for the lower variance of cell distributions in coupled niche groups. This reduction in noise can be useful for biological systems, for which noise is often detrimental. However, the question remained of whether it was the uncoupled lineages or the coupled ones (and the ODEs) that better achieved the target cell populations. From the control system perspective that we have taken, good control is defined as regulation of the cell populations to the target ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e545" xlink:type="simple"/></inline-formula>. Given the interactions of the MPCR parameters and this ratio in setting the cell steady states (see Supporting <xref ref-type="supplementary-material" rid="pcbi.1003794.s009">Text S1</xref>, Section 3), it was the ODE solutions, and therefore the coupled niche lineages, that followed the target cell levels more closely than the uncoupled ones. Thus, it seems that on a systemic level, it is advantageous to connect together niche lineages. This hints at some intriguing possibilities for understanding the emergence of tissues, which are interacting populations of single cells.</p>
<p>The difference between the overshoots for the three perturbation types can be understood as follows. The even perturbation should result in a similar overshoot from both uncoupled and coupled niche lineages, since it affects all niches equally. This is roughly consistent with our results for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e546" xlink:type="simple"/></inline-formula>, but it is unclear why the overshoot of the uncoupled <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e547" xlink:type="simple"/></inline-formula> is considerably lower. The uneven perturbation affects uncoupled and coupled lineages differently, with coupled niches having smaller overshoot, but there is no variation with niche group size. Because it is a regular perturbation, coupling lineages (into even-sized groups) reduces the niche group overshoot, and it does not change with niche group size as in every case 37.5% of the cells in each niche group are lost. However, random perturbations elicited yet another response. With smaller groups or individual lineages, it is more likely that the entire niche group is perturbed, resulting in a larger overshoot. At the extreme ends of the scale, one could conceivably have one niche group with all niche lineages perturbed, and another with none. As niche group size is increased the chances of this decrease and the percentage of total niche group <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e548" xlink:type="simple"/></inline-formula> that is lost tends asymptotically to 37.5%, with the overshoot declining to the same levels as for an uneven perturbation. This shows that in environments with even perturbations, it may be advantageous to not couple niche lineages – however such environments are unlikely to occur in nature. In contrast, in natural environments with random perturbations, coupling niche lineages results in a more favourable response. This overshoot of blood cells following a perturbation is an important aspect of our model. There has been little work on this, although experimental studies have found that some types of T-cells are reconstituted very quickly and exceed normal levels, possibly supporting our results <xref ref-type="bibr" rid="pcbi.1003794-Fallen1">[60]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-DumontGirard1">[61]</xref>. We do not know of similar results for other blood cell types.</p>
<p>An interesting result from our simulations is the large variation we see in cell populations of coupled lineages between different lineages in the same niche group, and the relatively low variation over time of the populations in each lineage. This indicates that the activity of the primitive cells of each lineage varies, with some inactive/less active and others continuously differentiating to produce more cells, in order to achieve the correct homeostatic cell levels, somewhat akin to the HSC subsets found by Sieburg et al. <xref ref-type="bibr" rid="pcbi.1003794-Sieburg2">[62]</xref>. Although we have not explicitly considered it here, our model also naturally captures the cycling behaviour of HSCs, with periods of quiescence and activity in each lineage <xref ref-type="bibr" rid="pcbi.1003794-Cheshier2">[63]</xref>. In addition, after a perturbation, our model finds a response from both stem and progenitor cells. This is in agreement with studies finding stem cell activation after injury (e.g., <xref ref-type="bibr" rid="pcbi.1003794-Cheshier1">[29]</xref>), but also supports the suggestion that at least part of the response is from progenitor cells <xref ref-type="bibr" rid="pcbi.1003794-Morrison3">[64]</xref>.</p>
<p>Our results indicate that, in order to regulate blood cell populations tightly and for a less severe response following random perturbations, it is advantageous to the organism to couple haematopoietic lineages together via the feedbacks from blood cells on to primitive cells. There are three biologically-viable possibilities for the nature of this feedback mechanism: lineage-dependent feedback, where the primitive cells in one lineage can only sense numbers of their own differentiated progeny; local feedback, where the primitive cells can sense blood cells of any lineage in proximity to them; global feedback, where all primitive cells can sense all blood cells in the organism. Lineage-dependent feedback would require a biochemical mechanism in which niche lineages (or niche groups) can identify signals from their descendants and respond to the demand control from those cells, but not others in the blood; this could imply an epigenetic process. Indeed, studies have found that stem cell daughters of HSCs have a similar lifetime to their parents <xref ref-type="bibr" rid="pcbi.1003794-Sieburg1">[34]</xref>, and such an epigenetic mechanism could also exist in non-primitive progeny to regulate their feedback. Local feedback implies a spatial constraint on the feedbacks; although this has already been found to exist in the case of certain HSC progeny as well as other niche cells <xref ref-type="bibr" rid="pcbi.1003794-Hsu1">[12]</xref>, it may not be a universal mechanism for the haematopoietic system because most blood cells enter the bloodstream rather than localising around the niche. However, in other stem cell systems, it is quite a plausible mode of feedback <xref ref-type="bibr" rid="pcbi.1003794-OBrien1">[65]</xref>. Finally, global feedback would require the HSCs to sense every blood cell in the bloodstream. Since it is likely that the feedbacks from the blood cells occur via growth factors <xref ref-type="bibr" rid="pcbi.1003794-Lander2">[28]</xref>, which naturally have a limit on their range of action, it does not seem likely that the HSC system incorporates global feedbacks from all blood cells. More likely is some combination of the above mechanisms. Looking for groups of epigenetic markers shared by HSCs, progenitor cells and differentiated blood cells could be a useful avenue for further experimental work. Finally, as evidenced by the dynamics of our model, the feedbacks are essential for achieving homeostatic cell rates <xref ref-type="bibr" rid="pcbi.1003794-Lander2">[28]</xref>. Although we have not explored this issue further, our results also support the idea that cancers may be a failure of the signalling mechanism and the associated feedback control <xref ref-type="bibr" rid="pcbi.1003794-RodriguezBrenes1">[66]</xref>.</p>
<p>In ODE models, we can only account for a single, or at best an identical set of deterministic niche lineages, so that the interactions between a <italic>heterogeneous metapopulation</italic> of lineages is underexplored theoretically. This is important for two reasons: first, the dynamics of the entire system cannot be determined just by looking at its parts, and second, we can take a much broader point of view by looking at an entire population <xref ref-type="bibr" rid="pcbi.1003794-Mangel2">[26]</xref>. Indeed, Huang <xref ref-type="bibr" rid="pcbi.1003794-Huang1">[32]</xref> suggests that this is one of three as-yet-neglected perspectives that should be adopted in stem cell modelling. For example, maintaining homeostasis at the population level can be achieved by several possible strategies <xref ref-type="bibr" rid="pcbi.1003794-Morrison3">[64]</xref>; only looking at a single stem cell restricts consideration to just one strategy, asymmetric division, which does not reveal the full picture. A stochastic treatment is needed to be able to incorporate population-level strategies such as a combination of both asymmetric and symmetric division and differentiation. Our work also links with the idea of a potential landscape of cell states <xref ref-type="bibr" rid="pcbi.1003794-Wang2">[67]</xref> (although here, the axes of the landscape represent not, say, expression levels of a protein, but numbers of cells in each sub-population): one simulation represents a niche lineage moving along the landscape and falling into a stable state (the homeostatic state for that lineage), and many simulations, as we have done, could allow us to reconstruct the potential landscape by randomly generating trajectories until we can see its full shape. Thus Monte Carlo simulations offer a computational way to explore the potential landscape.</p>
<p>In this paper, we first introduced a fast method of simulating an entire metapopulation of interacting niche lineages (or cells or biochemical species) synchronously through time. This is based on a version of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e549" xlink:type="simple"/></inline-formula>-leap method <xref ref-type="bibr" rid="pcbi.1003794-Gillespie4">[51]</xref> and then generalised to the metapopulation level. It compares favourably with the popular stochastic simulation algorithm method <xref ref-type="bibr" rid="pcbi.1003794-Gillespie2">[48]</xref>, both in terms of speed and accuracy – when interactions are to be included, the stochastic simulation algorithm averages them over time, as each member of the population proceeds through time at a different pace. The computational method we have proposed here can be combined with many stochastic simulation schemes in order to allow one to quickly and easily simulate whole metapopulations. Naturally, it is not limited to cell metapopulations, and can be used in <italic>any</italic> context where we would otherwise use Gillespie's standard SSA to simulate biochemical populations without tracking individual particles. For instance, with no interactions specified, it can be used to simultaneously run many repeat simulations of the same chemical reaction system (by regarding each sub-simulation as an independent repeat simulation), in order to find the full distribution of possible states, arising from intrinsic noise, at some time. However, it is especially useful when we are interested in interacting populations/metapopulations; for instance, this is often the case in ecological systems. It could also be used in condensed matter and chemical physics and in any biochemical context with spatial homogeneity. Finally, it is a very short logical step away from a spatial stochastic model made up of separate compartments (e.g., <xref ref-type="bibr" rid="pcbi.1003794-Hattne1">[68]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-MarquezLago1">[69]</xref>), and this is one obvious extension.</p>
<p>We used this method to build upon the haematopoietic stem cell model introduced in <xref ref-type="bibr" rid="pcbi.1003794-Mangel3">[27]</xref>, to simulate a heterogeneous metapopulation of haematopoietic stem cell lineages in time. Using this model, we considered the coupling of individual niche lineages into niche groups. We found that the more niche lineages are coupled, the more closely the mean blood cell numbers approached the target cell ratio. Moreover, when perturbations affected each lineage randomly, as would be the case in a natural environment, a larger number of niche lineages being coupled leads to a smaller overshoot in cell numbers, implying a more ideal response. This suggests that it is advantageous for an organism to couple haematopoietic lineages in order to better regulate homeostasis in the haematopoietic system, as well as respond better to natural perturbations.</p>
<p>Our work leads naturally on to questions about linking cells into whole tissues <xref ref-type="bibr" rid="pcbi.1003794-OBrien1">[65]</xref>; for instance, an obvious question is whether these are evolutionarily favourable compared to single niche lineages (or cells). One advantage might be the ability of larger systems to ‘average out’ excessive noise, as is the case with our coupled niche groups. So far, there are few studies investigating whole populations of stem cells, and even fewer on the consequences of linking them into tissues. It is well-known that HSCs routinely leave the niche and migrate in the bloodstream <xref ref-type="bibr" rid="pcbi.1003794-Yin1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Wright1">[57]</xref>, <xref ref-type="bibr" rid="pcbi.1003794-Bhattacharya1">[70]</xref>. Using our current model, an easy modification is to allow for this migration into and out of the niches (which might mitigate the instances of all stem cells in one lineage dying out, as we observed). Another extension of our work would be to introduce environmental or even genetic heterogeneity into the picture. Then it becomes possible to investigate the effects of mutations, for instance by introducing niche lineages with different parameters, in a similar way to evolutionary invasion analysis.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003794.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Trajectories of stochastic simulations of all cell species, with six uncoupled and six coupled niche lineages.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003794.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Trajectories of stochastic simulations of uncoupled and coupled niche lineages.</bold> Shown are six individual lineage A) total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e550" xlink:type="simple"/></inline-formula> (normalised by niche group size) for six uncoupled and six coupled entire niche groups (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e551" xlink:type="simple"/></inline-formula>) over time; B) trajectories of 100 simulations of uncoupled (top half) and coupled (bottom half), where colour represents the populations of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e552" xlink:type="simple"/></inline-formula> in each niche lineage, and similarly for C), where colour now represents total niche group <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e553" xlink:type="simple"/></inline-formula>, normalised by niche group size.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003794.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>PDFs of both uncoupled and coupled individual niche lineage </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e554" xlink:type="simple"/></inline-formula><bold>, for five different MPCR parameter sets.</bold> The axes for each histogram are identical, and quantified on the left and top. MPCR parameters are varied on the bottom axis.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003794.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>PDFs of both uncoupled and coupled total niche group </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e555" xlink:type="simple"/></inline-formula><bold>, for five different MPCR parameter sets.</bold> The axes for each histogram are identical, and quantified on the left and top. MPCR parameters are varied on the bottom axis.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003794.s005" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>Means and variances of total niche group cell distributions for various MPCR parameter sets.</bold> Distribution means of A) cell types with low numbers; B) cell types with high numbers. Variances of C) cell types with low numbers; D) cell types with high numbers. ODE solutions have been added to A) and B) to show how closely they follow the means of the stochastic distributions.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003794.s006" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p><bold>Means and variances of feedback distributions for various MPCR parameter sets.</bold> A) Feedback distribution means, B) individual niche lineage variances, and C) total niche group variances for different MPCR parameter sets.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003794.s007" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s007" position="float" xlink:type="simple"><label>Figure S7</label><caption>
<p><bold>Steady-state distributions of </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e556" xlink:type="simple"/></inline-formula><bold> cell numbers for various niche group sizes.</bold> PDFs of A) individual niche lineage <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e557" xlink:type="simple"/></inline-formula> and B) niche group total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e558" xlink:type="simple"/></inline-formula>, normalised by niche group size, at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e559" xlink:type="simple"/></inline-formula> seconds for various niche group sizes. Inset shows the variance of niche group total <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e560" xlink:type="simple"/></inline-formula> PDFs as a function of niche group size.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003794.s008" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s008" position="float" xlink:type="simple"><label>Figure S8</label><caption>
<p><bold>Steady-state distributions of feedbacks for various niche group sizes.</bold> PDFs of A) niche group mean MPCR and B) niche group mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e561" xlink:type="simple"/></inline-formula> at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003794.e562" xlink:type="simple"/></inline-formula> seconds for various niche group sizes.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003794.s009" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003794.s009" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Supporting information text.</bold> Section 1: Deterministic model of the HSC system, with the differential equations listed for each species. Section 2: System parameters and steady states, where the effects of the MPCR and other parameters on the homeostatic cell levels of the system are explored. Section 3: Investigating the target homeostatic cell levels, where we examine whether it is the coupled or uncoupled niche lineages that better find the target cell levels using a different parameter set for the HSC model.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>MM thanks Simone Vincenzi for conversations on various aspects of this work.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003794-Mason1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mason</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Dunnill</surname><given-names>P</given-names></name> (<year>2008</year>) <article-title>A brief definition of regenerative medicine</article-title>. <source>Regenerative Medicine</source> <volume>3</volume>: <fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Wagers1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wagers</surname><given-names>AJ</given-names></name> (<year>2012</year>) <article-title>The stem cell niche in regenerative medicine</article-title>. <source>Cell Stem Cell</source> <volume>10</volume>: <fpage>362</fpage>–<lpage>369</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Weissman1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weissman</surname><given-names>IL</given-names></name> (<year>2000</year>) <article-title>Translating stem and progenitor cell biology to the clinic: barriers and opportunities</article-title>. <source>Science</source> <volume>287</volume>: <fpage>14421446</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Gurtner1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gurtner</surname><given-names>GC</given-names></name>, <name name-style="western"><surname>Callaghan</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Longaker</surname><given-names>MT</given-names></name> (<year>2007</year>) <article-title>Progress and potential for regenerative medicine</article-title>. <source>Annual Review of Medicine</source> <volume>58</volume>: <fpage>299</fpage>–<lpage>312</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Till1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Till</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>McCulloch</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Siminovitch</surname><given-names>L</given-names></name> (<year>1964</year>) <article-title>A stochastic model of stem cell proliferation, based on the growth of spleen colony-forming cells</article-title>. <source>PNAS</source> <volume>51</volume>: <fpage>29</fpage>–<lpage>36</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Fuchs1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuchs</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Tumbar</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Guasch</surname><given-names>G</given-names></name> (<year>2004</year>) <article-title>Socializing with the neighbors: stem cells and their niche</article-title>. <source>Cell</source> <volume>116</volume>: <fpage>769778</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Metcalf1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Metcalf</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Concise review: hematopoietic stem cells and tissue stem cells: current concepts and unanswered questions</article-title>. <source>Stem Cells</source> <volume>25</volume>: <fpage>2390</fpage>–<lpage>2395</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Scadden1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scadden</surname><given-names>DT</given-names></name> (<year>2006</year>) <article-title>The stem-cell niche as an entity of action</article-title>. <source>Nature</source> <volume>441</volume>: <fpage>1075</fpage>–<lpage>1079</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Lander1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lander</surname><given-names>AD</given-names></name> (<year>2009</year>) <article-title>The stem cell concept: is it holding us back?</article-title> <source>Journal of Biology</source> <volume>8</volume>: <fpage>70</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Peerani1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peerani</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Rao</surname><given-names>BM</given-names></name>, <name name-style="western"><surname>Bauwens</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Yin</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Wood</surname><given-names>GA</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Niche-mediated control of human embryonic stem cell self-renewal and differentiation</article-title>. <source>EMBO Journal</source> <volume>26</volume>: <fpage>4744</fpage>–<lpage>4755</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Stine1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stine</surname><given-names>RR</given-names></name>, <name name-style="western"><surname>Matunis</surname><given-names>EL</given-names></name> (<year>2013</year>) <article-title>Stem cell competition: finding balance in the niche</article-title>. <source>Trends in Cell Biology</source> <volume>23</volume>: <fpage>357</fpage>–<lpage>364</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Hsu1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hsu</surname><given-names>YC</given-names></name>, <name name-style="western"><surname>Fuchs</surname><given-names>E</given-names></name> (<year>2012</year>) <article-title>A family business: stem cell progeny join the niche to regulate homeostasis</article-title>. <source>Nature Reviews Molecular Cell Biology</source> <volume>13</volume>: <fpage>103</fpage>–<lpage>114</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Takeda1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Takeda</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Jain</surname><given-names>R</given-names></name>, <name name-style="western"><surname>LeBoeuf</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Lu</surname><given-names>MM</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Interconversion between intestinal stem cell populations in distinct niches</article-title>. <source>Science</source> <volume>334</volume>: <fpage>1420</fpage>–<lpage>1424</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Orkin1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Orkin</surname><given-names>SH</given-names></name>, <name name-style="western"><surname>Zon</surname><given-names>LI</given-names></name> (<year>2008</year>) <article-title>Hematopoiesis: an evolving paradigm for stem cell biology</article-title>. <source>Cell</source> <volume>132</volume>: <fpage>631644</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Mangel1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mangel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bonsall</surname><given-names>MB</given-names></name> (<year>2008</year>) <article-title>Phenotypic evolutionary models in stem cell biology: replacement, quiescence, and variability</article-title>. <source>PLoS ONE</source> <volume>3</volume>: <fpage>e1591</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-LoCelso1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lo Celso</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Scadden</surname><given-names>DT</given-names></name> (<year>2011</year>) <article-title>The haematopoietic stem cell niche at a glance</article-title>. <source>Journal of Cell Science</source> <volume>124</volume>: <fpage>35293535</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Morrison1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morrison</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Spradling</surname><given-names>AC</given-names></name> (<year>2008</year>) <article-title>Stem cells and niches: mechanisms that promote stem cell maintenance throughout life</article-title>. <source>Cell</source> <volume>132</volume>: <fpage>598611</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Kiel1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kiel</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Morrison</surname><given-names>SJ</given-names></name> (<year>2008</year>) <article-title>Uncertainty in the niches that maintain haematopoietic stem cells</article-title>. <source>Nature Reviews Immunology</source> <volume>8</volume>: <fpage>290</fpage>–<lpage>301</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Yin1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yin</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>L</given-names></name> (<year>2006</year>) <article-title>The stem cell niches in bone</article-title>. <source>Journal of Clinical Investigation</source> <volume>116</volume>: <fpage>11951201</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Morrison2"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morrison</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Scadden</surname><given-names>DT</given-names></name> (<year>2014</year>) <article-title>The bone marrow niche for haematopoietic stem cells</article-title>. <source>Nature</source> <volume>505</volume>: <fpage>327</fpage>–<lpage>334</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Kiel2"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kiel</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Yilmaz</surname><given-names>OH</given-names></name>, <name name-style="western"><surname>Iwashita</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Terhorst</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Morrison</surname><given-names>SJ</given-names></name> (<year>2005</year>) <article-title>Slam family receptors distinguish hematopoietic stem and progenitor cells and reveal endothelial niches for stem cells</article-title>. <source>Cell</source> <volume>121</volume>: <fpage>11091121</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Sugiyama1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sugiyama</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Kohara</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Noda</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nagasawa</surname><given-names>T</given-names></name> (<year>2006</year>) <article-title>Maintenance of the hematopoietic stem cell pool by cxcl12-cxcr4 chemokine signaling in bone marrow stromal cell niches</article-title>. <source>Immunity</source> <volume>25</volume>: <fpage>977988</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Wang1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Benedito</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bixel</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Zeuschner</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stehling</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Identification of a clonally expanding haematopoietic compartment in bone marrow</article-title>. <source>EMBO Journal</source> <volume>32</volume>: <fpage>219</fpage>–<lpage>230</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Hawkins1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hawkins</surname><given-names>ED</given-names></name>, <name name-style="western"><surname>Lo Celso</surname><given-names>C</given-names></name> (<year>2013</year>) <article-title>Subdivision of bone marrow microenvironments: purpose built homes for haematopoietic stem cells</article-title>. <source>EMBO Journal</source> <volume>32</volume>: <fpage>176</fpage>–<lpage>177</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Metcalf2"><label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Metcalf D (1988) The Molecular Control of Blood Cells. Cambridge, MA: Harvard University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Mangel2"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mangel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bonsall</surname><given-names>MB</given-names></name> (<year>2007</year>) <article-title>The evolutionary ecology of stem cells and their niches - the time is now</article-title>. <source>Oikos</source> <volume>116</volume>: <fpage>17791781</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Mangel3"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mangel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bonsall</surname><given-names>MB</given-names></name> (<year>2013</year>) <article-title>Stem cell biology is population biology: differentiation of hematopoietic multipotent progenitors to common lymphoid and myeloid progenitors</article-title>. <source>Theoretical Biology and Medical Modelling</source> <volume>10</volume>: <fpage>5</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Lander2"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lander</surname><given-names>AD</given-names></name>, <name name-style="western"><surname>Gokoffski</surname><given-names>KK</given-names></name>, <name name-style="western"><surname>Wan</surname><given-names>FYM</given-names></name>, <name name-style="western"><surname>Nie</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Calof</surname><given-names>AL</given-names></name> (<year>2009</year>) <article-title>Cell lineages and the logic of proliferative control</article-title>. <source>PLoS Biology</source> <volume>7</volume>: <fpage>e1000015</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Cheshier1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cheshier</surname><given-names>SH</given-names></name>, <name name-style="western"><surname>Prohaska</surname><given-names>SS</given-names></name>, <name name-style="western"><surname>Weissman</surname><given-names>IL</given-names></name> (<year>2007</year>) <article-title>The effect of bleeding on hematopoietic stem cell cycling and self-renewal</article-title>. <source>Stem Cells and Development</source> <volume>16</volume>: <fpage>707</fpage>–<lpage>717</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-deGraaf1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Graaf</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Kauppi</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Baldwin</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hyland</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Metcalf</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Regulation of hematopoietic stem cells by their mature progeny</article-title>. <source>PNAS</source> <volume>107</volume>: <fpage>2168921694</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Ogawa1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ogawa</surname><given-names>M</given-names></name> (<year>1993</year>) <article-title>Differentiation and proliferation of hematopoietic stem cells</article-title>. <source>Blood</source> <volume>81</volume>: <fpage>2844</fpage>–<lpage>2853</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Huang1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>S</given-names></name> (<year>2011</year>) <article-title>Systems biology of stem cells: three useful perspectives to help overcome the paradigm of linear pathways</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>366</volume>: <fpage>2247</fpage>–<lpage>2259</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Osafune1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Osafune</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Caron</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Borowiak</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Martinez</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Fitz-Gerald</surname><given-names>CS</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Marked differences in differentiation propensity among human embryonic stem cell lines</article-title>. <source>Nature Biotechnology</source> <volume>26</volume>: <fpage>313</fpage>–<lpage>315</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Sieburg1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sieburg</surname><given-names>HB</given-names></name>, <name name-style="western"><surname>Rezner</surname><given-names>BD</given-names></name>, <name name-style="western"><surname>Muller-Sieburg</surname><given-names>CE</given-names></name> (<year>2011</year>) <article-title>Predicting clonal self-renewal and extinction of hematopoietic stem cells</article-title>. <source>PNAS</source> <volume>108</volume>: <fpage>43704375</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Huang2"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Non-genetic heterogeneity of cells in development: more than just noise</article-title>. <source>Development</source> <volume>136</volume>: <fpage>38533862</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Lander3"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lander</surname><given-names>AD</given-names></name> (<year>2011</year>) <article-title>The individuality of stem cells</article-title>. <source>BMC Biology</source> <volume>9</volume>: <fpage>40</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Suda1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suda</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Suda</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ogawa</surname><given-names>M</given-names></name> (<year>1983</year>) <article-title>Single-cell origin of mouse hemopoietic colonies expressing multiple lineages in variable combinations</article-title>. <source>PNAS</source> <volume>80</volume>: <fpage>66896693</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-MarciniakCzochra1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marciniak-Czochra</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Stiehl</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Ho</surname><given-names>AD</given-names></name>, <name name-style="western"><surname>Jäger</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Wagner</surname><given-names>W</given-names></name> (<year>2009</year>) <article-title>Modeling of asymmetric cell division in hematopoietic stem cells – regulation of self-renewal is essential for efficient repopulation</article-title>. <source>Stem Cells and Development</source> <volume>18</volume>: <fpage>377</fpage>–<lpage>385</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Dingli1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dingli</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pacheco</surname><given-names>JM</given-names></name> (<year>2011</year>) <article-title>Stochastic dynamics and the evolution of mutations in stem cells</article-title>. <source>BMC Biology</source> <volume>9</volume>: <fpage>41</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Gupta1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gupta</surname><given-names>PB</given-names></name>, <name name-style="western"><surname>Fillmore</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Shapira</surname><given-names>SD</given-names></name>, <name name-style="western"><surname>Tao</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Stochastic state transitions give rise to phenotypic equilibrium in populations of cancer cells</article-title>. <source>Cell</source> <volume>146</volume>: <fpage>633</fpage>–<lpage>644</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Sun1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Komarova</surname><given-names>NL</given-names></name> (<year>2012</year>) <article-title>Stochastic modeling of stem-cell dynamics with control</article-title>. <source>Mathematical Biosciences</source> <volume>240</volume>: <fpage>231240</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Komarova1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Komarova</surname><given-names>NL</given-names></name> (<year>2013</year>) <article-title>Principles of regulation of self-renewing cell lineages</article-title>. <source>PLoS ONE</source> <volume>8</volume>: <fpage>e72847</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Weissman2"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weissman</surname><given-names>IL</given-names></name> (<year>2000</year>) <article-title>Stem cells: units of development, units of regeneration, and units in evolution</article-title>. <source>Cell</source> <volume>100</volume>: <fpage>157</fpage>–<lpage>168</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Laird1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Laird</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Tomaso</surname><given-names>AWD</given-names></name>, <name name-style="western"><surname>Weissman</surname><given-names>IL</given-names></name> (<year>2005</year>) <article-title>Stem cells are units of natural selection in a colonial ascidian</article-title>. <source>Cell</source> <volume>123</volume>: <fpage>1351</fpage>–<lpage>1360</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Gillespie1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Mangel</surname><given-names>M</given-names></name> (<year>1981</year>) <article-title>Conditioned averages in chemical kinetics</article-title>. <source>Journal of Chemical Physics</source> <volume>75</volume>: <fpage>704</fpage>–<lpage>709</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Goutsias1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goutsias</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Classical versus stochastic kinetics modeling of biochemical reaction systems</article-title>. <source>Biophysical Journal</source> <volume>92</volume>: <fpage>2350</fpage>–<lpage>2365</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Wilkinson1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilkinson</surname><given-names>DJ</given-names></name> (<year>2009</year>) <article-title>Stochastic modelling for quantitative description of heterogeneous biological systems</article-title>. <source>Nature Reviews Genetics</source> <volume>10</volume>: <fpage>122</fpage>–<lpage>133</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Gillespie2"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name> (<year>1977</year>) <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>Journal of Physical Chemistry</source> <volume>81</volume>: <fpage>2340</fpage>–<lpage>2361</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Mangel4"><label>49</label>
<mixed-citation publication-type="other" xlink:type="simple">Mangel M (2006) The Theoretical Biologist's Toolbox: Quantitative Methods for Ecology and Evolutionary Biology. Cambridge, UK: Cambridge University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Gillespie3"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name> (<year>2009</year>) <article-title>A diffusional bimolecular propensity function</article-title>. <source>Journal of Chemical Physics</source> <volume>131</volume>: <fpage>164109</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Gillespie4"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name> (<year>2001</year>) <article-title>Approximate accelerated stochastic simulation of chemically reacting systems</article-title>. <source>Journal of Chemical Physics</source> <volume>115</volume>: <fpage>1716</fpage>–<lpage>1733</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Cao1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Petzold</surname><given-names>LR</given-names></name> (<year>2006</year>) <article-title>Efficient step size selection for the tau-leaping simulation method</article-title>. <source>Journal of Chemical Physics</source> <volume>124</volume>: <fpage>044109</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Hu1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Min</surname><given-names>B</given-names></name> (<year>2011</year>) <article-title>A weak second order tau-leaping method for chemical kinetic systems</article-title>. <source>Journal of Chemical Physics</source> <volume>135</volume>: <fpage>024113</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Szkely1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Székely</surname><given-names>T</given-names><suffix>Jr</suffix></name>, <name name-style="western"><surname>Burrage</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Erban</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Zygalakis</surname><given-names>KC</given-names></name> (<year>2012</year>) <article-title>A higher-order numerical framework for stochastic simulation of chemical reaction systems</article-title>. <source>BMC Systems Biology</source> <volume>6</volume>: <fpage>85</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Szkely2"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Székely</surname><given-names>T</given-names><suffix>Jr</suffix></name>, <name name-style="western"><surname>Burrage</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Zygalakis</surname><given-names>KC</given-names></name>, <name name-style="western"><surname>Barrio</surname><given-names>M</given-names></name> (<year>2014</year>) <article-title>Efficient simulation of stochastic chemical kinetics with the Stochastic Bulirsch-Stoer extrapolation method</article-title>. <source>BMC Systems Biology</source> <volume>8</volume>: <fpage>71</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Kurtz1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kurtz</surname><given-names>TG</given-names></name> (<year>1978</year>) <article-title>Strong approximation theorems for density dependent markov chains</article-title>. <source>Stochastic Processes and their Applications</source> <volume>6</volume>: <fpage>223</fpage>–<lpage>240</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Wright1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Wagers</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Gulati</surname><given-names>AP</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>FL</given-names></name>, <name name-style="western"><surname>Weissman</surname><given-names>IL</given-names></name> (<year>2001</year>) <article-title>Physiological migration of hematopoietic stem and progenitor cells</article-title>. <source>Science</source> <volume>294</volume>: <fpage>1933</fpage>–<lpage>1936</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Adams1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adams</surname><given-names>GB</given-names></name>, <name name-style="western"><surname>Scadden</surname><given-names>DT</given-names></name> (<year>2006</year>) <article-title>The hematopoietic stem cell in its place</article-title>. <source>Nature Immunology</source> <volume>7</volume>: <fpage>333</fpage>–<lpage>337</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Colijn1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Colijn</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Mackey</surname><given-names>MC</given-names></name> (<year>2005</year>) <article-title>A mathematical model of hematopoiesis - I. periodic chronic myelogenous leukemia</article-title>. <source>Journal of Theoretical Biology</source> <volume>237</volume>: <fpage>117</fpage>–<lpage>132</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Fallen1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fallen</surname><given-names>PR</given-names></name>, <name name-style="western"><surname>McGreavey</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Madrigal</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Potter</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ethell</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Factors affecting reconstitution of the T cell compartment in allogeneic haematopoietic cell transplant recipients</article-title>. <source>Bone Marrow Transplantation</source> <volume>32</volume>: <fpage>1001</fpage>–<lpage>1014</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-DumontGirard1"><label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dumont-Girard</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Roux</surname><given-names>E</given-names></name>, <name name-style="western"><surname>van Lier</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Hale</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Helg</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>1998</year>) <article-title>Reconstitution of the T-cell compartment after bone marrow transplantation: restoration of the repertoire by thymic emigrants</article-title>. <source>Blood</source> <volume>92</volume>: <fpage>4464</fpage>–<lpage>4471</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Sieburg2"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sieburg</surname><given-names>HB</given-names></name>, <name name-style="western"><surname>Cho</surname><given-names>RH</given-names></name>, <name name-style="western"><surname>Dykstra</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Uchida</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Eaves</surname><given-names>CJ</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>The hematopoietic stem compartment consists of a limited number of discrete stem cell subsets</article-title>. <source>Blood</source> <volume>107</volume>: <fpage>2311</fpage>–<lpage>2316</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Cheshier2"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cheshier</surname><given-names>SH</given-names></name>, <name name-style="western"><surname>Morrison</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Liao</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Weissman</surname><given-names>IL</given-names></name> (<year>1999</year>) <article-title>In vivo proliferation and cell cycle kinetics of long-term self-renewing hematopoietic stem cells</article-title>. <source>PNAS</source> <volume>96</volume>: <fpage>3120</fpage>–<lpage>3125</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Morrison3"><label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morrison</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Kimble</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>Asymmetric and symmetric stem-cell divisions in development and cancer</article-title>. <source>Nature</source> <volume>441</volume>: <fpage>1068</fpage>–<lpage>1074</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-OBrien1"><label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O'Brien</surname><given-names>LE</given-names></name>, <name name-style="western"><surname>Bilder</surname><given-names>D</given-names></name> (<year>2013</year>) <article-title>Beyond the niche: tissue-level coordination of stem cell dynamics</article-title>. <source>Annual Review of Cell and Developmental Biology</source> <volume>29</volume>: <fpage>107</fpage>–<lpage>136</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-RodriguezBrenes1"><label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodriguez-Brenes</surname><given-names>IA</given-names></name>, <name name-style="western"><surname>Komarova</surname><given-names>NL</given-names></name>, <name name-style="western"><surname>Wodarz</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>Evolutionary dynamics of feedback escape and the development of stem-cell-driven cancers</article-title>. <source>PNAS</source> <volume>108</volume>: <fpage>18983</fpage>–<lpage>18988</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Wang2"><label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>The potential landscape of genetic circuits imposes the arrow of time in stem cell differentiation</article-title>. <source>Biophysical Journal</source> <volume>99</volume>: <fpage>29</fpage>–<lpage>39</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Hattne1"><label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hattne</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Fange</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Elf</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>Stochastic reaction-diffusion simulation with MesoRD</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>2923</fpage>–<lpage>2924</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-MarquezLago1"><label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marquez-Lago</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Burrage</surname><given-names>K</given-names></name> (<year>2007</year>) <article-title>Binomial tau-leap spatial stochastic simulation algorithm for applications in chemical kinetics</article-title>. <source>Journal of Chemical Physics</source> <volume>127</volume>: <fpage>104101</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003794-Bhattacharya1"><label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bhattacharya</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Czechowicz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ooi</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Rossi</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Bryder</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Niche recycling through division-independent egress of hematopoietic stem cells</article-title>. <source>Journal of Experimental Medicine</source> <volume>206</volume>: <fpage>2837</fpage>–<lpage>2850</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>