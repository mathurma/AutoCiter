<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-00478</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003778</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary theory</subject><subject>Population genetics</subject></subj-group></subj-group><subj-group><subject>Population biology</subject><subj-group><subject>Population dynamics</subject></subj-group></subj-group><subj-group><subject>Theoretical biology</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Quantifying the Role of Population Subdivision in Evolution on Rugged Fitness Landscapes</article-title>
<alt-title alt-title-type="running-head">Population Subdivision and Rugged Landscapes</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bitbol</surname><given-names>Anne-Florence</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Schwab</surname><given-names>David J.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
</contrib-group>
<aff id="aff1"><addr-line>Lewis-Sigler Institute for Integrative Genomics and Department of Physics, Princeton University, Princeton, New Jersey, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Ben-Tal</surname><given-names>Nir</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Tel Aviv University, Israel</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">afbitbol@princeton.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: AFB DJS. Performed the experiments: AFB DJS. Analyzed the data: AFB DJS. Contributed reagents/materials/analysis tools: AFB DJS. Contributed to the writing of the manuscript: AFB DJS.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>8</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>14</day><month>8</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>8</issue>
<elocation-id>e1003778</elocation-id>
<history>
<date date-type="received"><day>18</day><month>3</month><year>2014</year></date>
<date date-type="accepted"><day>29</day><month>6</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Bitbol, Schwab</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Natural selection drives populations towards higher fitness, but crossing fitness valleys or plateaus may facilitate progress up a rugged fitness landscape involving epistasis. We investigate quantitatively the effect of subdividing an asexual population on the time it takes to cross a fitness valley or plateau. We focus on a generic and minimal model that includes only population subdivision into equivalent demes connected by global migration, and does not require significant size changes of the demes, environmental heterogeneity or specific geographic structure. We determine the optimal speedup of valley or plateau crossing that can be gained by subdivision, if the process is driven by the deme that crosses fastest. We show that isolated demes have to be in the sequential fixation regime for subdivision to significantly accelerate crossing. Using Markov chain theory, we obtain analytical expressions for the conditions under which optimal speedup is achieved: valley or plateau crossing by the subdivided population is then as fast as that of its fastest deme. We verify our analytical predictions through stochastic simulations. We demonstrate that subdivision can substantially accelerate the crossing of fitness valleys and plateaus in a wide range of parameters extending beyond the optimal window. We study the effect of varying the degree of subdivision of a population, and investigate the trade-off between the magnitude of the optimal speedup and the width of the parameter range over which it occurs. Our results, obtained for fitness valleys and plateaus, also hold for weakly beneficial intermediate mutations. Finally, we extend our work to the case of a population connected by migration to one or several smaller islands. Our results demonstrate that subdivision with migration alone can significantly accelerate the crossing of fitness valleys and plateaus, and shed light onto the quantitative conditions necessary for this to occur.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Experimental evidence has recently been accumulating to suggest that fitness landscape ruggedness is common in a variety of organisms. Rugged landscapes arise from interactions between genetic variants, called epistasis, which can lead to fitness valleys or plateaus. The time needed to cross such fitness valleys or plateaus exhibits a rich dependence on population size, since stochastic effects have higher importance in small populations, increasing the probability of fixation of neutral or deleterious mutants. This may lead to an advantage of population subdivision, a possibility which has been strongly debated for nearly one hundred years. In this work, we quantitatively determine when, and to what extent, population subdivision accelerates valley and plateau crossing. Using the simple model of an asexual population subdivided into identical demes connected by gobal migration, we derive the conditions under which crossing by a subdivided population is driven by its fastest deme, thus giving rise to the maximal speedup. Our analytical predictions are verified using stochastic simulations. We investigate the effect of varying the degree of subdivision of a population. We generalize our results to weakly beneficial intermediates and to different population structures. We discuss the magnitude and robustness of the effect for realistic parameter values.</p>
</abstract>
<funding-group><funding-statement>AFB acknowledges the support of the Human Frontier Science Program (<ext-link ext-link-type="uri" xlink:href="http://www.hfsp.org/" xlink:type="simple">http://www.hfsp.org/</ext-link>). DJS was supported by National Institutes of Health Grant K25 GM098875 (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov/" xlink:type="simple">http://www.nih.gov/</ext-link>). This work was also supported in part by National Science Foundation Grant PHY-0957573 (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov/" xlink:type="simple">http://www.nsf.gov/</ext-link>) and National Institutes of Health Grant R01 GM082938 (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov/" xlink:type="simple">http://www.nih.gov/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="15"/></counts><custom-meta-group><custom-meta id="data-availability" xlink:type="simple"><meta-name>Data Availability</meta-name><meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper.</meta-value></custom-meta></custom-meta-group></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Natural selection drives populations towards higher fitness (i.e. reproductive success), but crossing fitness valleys or plateaus may facilitate progress up a rugged fitness landscape. Rugged fitness landscapes arise from epistasis, i.e. interactions between genetic variants. For instance, two mutations together can yield a benefit while each of them alone is detrimental: such reciprocal sign epistasis can give rise to a fitness valley <xref ref-type="bibr" rid="pcbi.1003778-Dawid1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Draghi1">[2]</xref>. While the high dimensionality of genotype space makes it challenging to probe the structure of fitness landscapes <xref ref-type="bibr" rid="pcbi.1003778-Franke1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Szendro1">[4]</xref>, evidence has been accumulating for frequent landscape ruggedness, especially in recent years <xref ref-type="bibr" rid="pcbi.1003778-Dawid1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Draghi1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Szendro1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1003778-stman1">[15]</xref>.</p>
<p>Population structure can play an important role in evolution <xref ref-type="bibr" rid="pcbi.1003778-Korona1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003778-Hermsen1">[24]</xref>. In particular, the time taken to cross a fitness valley or plateau depends on population size since stochastic effects such as genetic drift have an increased importance in small populations, allowing neutral and deleterious mutations to fix with increased probability <xref ref-type="bibr" rid="pcbi.1003778-Ewens1">[25]</xref>–<xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Population subdivision into demes can allow the maintenance of larger genetic diversity due to increased genetic drift as well as to the quasi-independent explorations of the fitness landscape that are run in parallel by each deme. Subdivision may thereby facilitate valley or plateau crossing locally and subsequent migration can then spread beneficial mutations throughout the entire subdivided population ("metapopulation''). This idea was first discussed by Wright in his shifting balance theory <xref ref-type="bibr" rid="pcbi.1003778-Wright1">[29]</xref>–<xref ref-type="bibr" rid="pcbi.1003778-Wright4">[32]</xref> and the importance of this effect has been the subject of a long debate <xref ref-type="bibr" rid="pcbi.1003778-Lande1">[33]</xref>–<xref ref-type="bibr" rid="pcbi.1003778-Wade3">[42]</xref>. In this work, we investigate the role of subdivision with global migration alone, without additional effects such as strong dependence of deme size on fitness, including extinction and refounding of demes, which played a crucial role in Wright's theory. Our generic and minimal model enables us to quantatively determine the conditions under which population subdivision accelerates fitness valley or plateau crossing.</p>
<p>Studying quantitatively the effect of subdivision on evolution may help in inferring fitness landscape structure from evolution experiments <xref ref-type="bibr" rid="pcbi.1003778-Desai1">[43]</xref>. Work on structured populations has been used as qualitative proof of landscape ruggedness <xref ref-type="bibr" rid="pcbi.1003778-Korona1">[16]</xref>. Current experiments investigating the evolution of subdivided populations at various migration rates have produced mixed results, some demonstrating faster adaptation of subdivided populations <xref ref-type="bibr" rid="pcbi.1003778-Kerr1">[44]</xref>, and others not <xref ref-type="bibr" rid="pcbi.1003778-Kryazhimskiy2">[45]</xref>. It is therefore important to determine under what conditions subdivision accelerates fitness valley or plateau crossing. Additionally, population subdivision is extremely common in natural systems. For instance, evidence has recently been found for compartmentalization of HIV in different organs of a single patient <xref ref-type="bibr" rid="pcbi.1003778-vanMarle1">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Schnell1">[47]</xref>.</p>
<p>Here we show that subdivision can significantly accelerate fitness valley or plateau crossing over a wide parameter range, both with respect to a non-subdivided population and with respect to a single deme. Intuitively, deleterious or neutral intermediate mutations may fix in individual demes, allowing for the maintenance of a larger proportion of these mutants in a metapopulation than in a well-mixed population. We first determine the optimal speedup of valley or plateau crossing by subdivision, in the best possible scenario where valley or plateau crossing by the metapopulation is driven by that of its fastest deme. This enables us to demonstrate that isolated demes must be in the sequential fixation regime for subdivision to significantly accelerate crossing. We then determine the conditions under which the best possible scenario can be realized. Using Markov chain theory, we obtain analytical expressions for the parameter range where valley or plateau crossing by a metapopulation is as fast as that of its fastest deme. Our analytical predictions are verified using stochastic simulations. Furthermore, we discuss the effect of varying the degree of subdivision of a population, and investigate the trade-off between the magnitude of the optimal speedup and the width of the parameter range over which it occurs. Finally, we extend our work to weakly beneficial mutations and to a population connected to smaller islands, and we discuss the magnitude and robustness of the effect for realistic parameter values.</p>
</sec><sec id="s2">
<title>Results</title>
<p>Our results are organized as follows. First, we specify our model for the evolutionary dynamics of a subdivided population with migration. Then, we focus on the ‘best possible' scenario where the metapopulation is driven by its fastest deme. We calculate the ratio of the valley-crossing time for the metapopulation to the valley-crossing time for an equally-sized well-mixed population under this strong assumption. This yields the optimal speedup that may be obtained by subdivision, and enables us to demonstrate that sequential fixation in individual demes is necessary to achieve a significant speedup. Then, we determine the range of parameter values for which the best possible scenario is attained, i.e. the valley-crossing time for the metapopulation is indeed dominated by the valley-crossing time of its fastest deme. Qualitatively, migration has to be both rare enough to enable demes to cross the fitness valley or plateau quasi-independently and frequent enough to allow fast spreading of the final beneficial mutation to the whole metapopulation once it has fixed in the fastest deme: these conditions yield an optimal window of migration rates. Finally, we compare our analytical predictions with results from stochastic simulations.</p>
<sec id="s2a">
<title>Model of evolutionary dynamics in a subdivided population</title>
<p>We focus on asexual individuals, characterized by their genotype and associated fitness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e001" xlink:type="simple"/></inline-formula>. Each individual has a division rate proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e002" xlink:type="simple"/></inline-formula>, and a death rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e003" xlink:type="simple"/></inline-formula>, which is the same for all. We consider an ensemble of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e004" xlink:type="simple"/></inline-formula> identical demes, each with a constant number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e005" xlink:type="simple"/></inline-formula> of individuals. The division rate averaged over the individuals of a deme is thus equal to the death rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e006" xlink:type="simple"/></inline-formula>. We treat migration as a random exchange of two individuals between two different demes, occurring at rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e007" xlink:type="simple"/></inline-formula> per individual. In our model, exchange between any two demes is equally likely, as in Wright's "island model'' <xref ref-type="bibr" rid="pcbi.1003778-Wright1">[29]</xref>. This constitutes a generic and minimal model of subdivision with migration, without any dependence of migration rate on the average fitness of a deme (in contrast with models where demes containing beneficial mutants increase significantly in size and migrate more rapidly <xref ref-type="bibr" rid="pcbi.1003778-Wright2">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Lande1">[33]</xref>), or additional effects of extinction and re-founding of demes <xref ref-type="bibr" rid="pcbi.1003778-Wright2">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Wright4">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Lande1">[33]</xref>, specific geographic structure <xref ref-type="bibr" rid="pcbi.1003778-Korona1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Hallatschek1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Martens1">[19]</xref>–<xref ref-type="bibr" rid="pcbi.1003778-Otwinowski1">[21]</xref>, or spatially heterogeneous environments <xref ref-type="bibr" rid="pcbi.1003778-Waclaw1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Zhang1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1003778-Hermsen1">[24]</xref>, on which previous studies focused.</p>
<p>We consider the simplest fitness valley or plateau, involving three successive genotypes denoted by ‘0', ‘1' and ‘2' (see <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1A</xref>). The initial genotype is taken as reference for fitness: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e008" xlink:type="simple"/></inline-formula>. We denote the fitnesses of the subsequent genotypes by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e010" xlink:type="simple"/></inline-formula>. The first mutation is assumed to be either neutral (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e011" xlink:type="simple"/></inline-formula>), which yields a fitness plateau, or deleterious (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e012" xlink:type="simple"/></inline-formula>), which corresponds to a fitness valley, while the second mutation is assumed to be beneficial (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e013" xlink:type="simple"/></inline-formula>). We focus on first mutations that are not too strongly deleterious: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e014" xlink:type="simple"/></inline-formula>. We only allow forward mutations, and note that including back mutations does not qualitatively affect crossing times <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Finally, we assume that all mutations have probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e015" xlink:type="simple"/></inline-formula> per division, but generalization to different mutation probabilities is straightforward.</p>
<fig id="pcbi-1003778-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003778.g001</object-id><label>Figure 1</label><caption>
<title>Population subdivision with migration can accelerate fitness valley crossing.</title>
<p><bold>A.</bold> Fitness valley: fitness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e016" xlink:type="simple"/></inline-formula> versus genotype <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e017" xlink:type="simple"/></inline-formula>. <bold>B.</bold> Schematic representation of the best possible scenario, for a metapopulation with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e018" xlink:type="simple"/></inline-formula> demes. Each square represents a deme of identical size, and a row represents the metapopulation. Colors represent genotypes, with the color-code defined in A. Initially (top row), all demes have genotype '0'. The demes explore the fitness landscape described in A quasi-independently, and one of them, the "champion'' deme (second from the left here), crosses the fitness valley first (second and third row). Individual demes are assumed to be in the sequential fixation regime, so this deme fixes first mutation '1' and then mutation '2'. The beneficial mutation '2' then spreads by migration, which is modeled by random exchange of individuals between demes (arrow on the fourth row), leading to fixation of mutation '2' in the whole metapopulation (fifth row). <bold>C.</bold> Average valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e019" xlink:type="simple"/></inline-formula> of a non-structured population, as a function of its carrying capacity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e020" xlink:type="simple"/></inline-formula>, in logarithmic scale. Dots are simulation results, averaged over 1000 runs for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e021" xlink:type="simple"/></inline-formula>; error bars represent 95% confidence intervals (CI). Theoretical predictions from Ref. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref> are plotted for the sequential fixation regime (blue line) and for the tunneling regime (red line), using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e022" xlink:type="simple"/></inline-formula> (see text) to make the correspondence. The transition between these two regimes is indicated by a dotted line. The carrying capacities at stake in D are highlighted in green (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e023" xlink:type="simple"/></inline-formula>: isolated deme; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e024" xlink:type="simple"/></inline-formula>: non-subdivided population). Parameter values: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e025" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e026" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e027" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e028" xlink:type="simple"/></inline-formula>. <bold>D.</bold> Average valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e029" xlink:type="simple"/></inline-formula> of a metapopulation composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e030" xlink:type="simple"/></inline-formula> demes each with carrying capacity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e031" xlink:type="simple"/></inline-formula> (total carrying capacity: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e032" xlink:type="simple"/></inline-formula>), plotted versus the migration-to-mutation rate ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e033" xlink:type="simple"/></inline-formula>, in logarithmic scale. Parameter values are the same as in C, and only the migration rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e034" xlink:type="simple"/></inline-formula> is varied. Dots represent simulation results averaged over 1000 runs for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e035" xlink:type="simple"/></inline-formula>, and error bars are 95% CI. Black vertical lines represent the limits of the interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e036" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref>. Blue (resp. red) line: valley crossing time for an isolated deme (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e037" xlink:type="simple"/></inline-formula>) with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e038" xlink:type="simple"/></inline-formula> (resp. a non-subdivided population (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e039" xlink:type="simple"/></inline-formula>) with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e040" xlink:type="simple"/></inline-formula>) for the same parameter values, averaged over 1000 runs; shaded regions: 95% CI. Dashed blue (resp. red) lines: corresponding theoretical predictions from Ref. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref> (see C).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003778.g001" position="float" xlink:type="simple"/></fig>
<p>In this paper, we focus on the average time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e041" xlink:type="simple"/></inline-formula> required for the whole metapopulation to cross the fitness valley or plateau, i.e. to fix mutation ‘2' in all demes, starting from an initial state where all individuals have genotype ‘0’.</p>
</sec><sec id="s2b">
<title>The best possible scenario</title>
<p>For small enough migration rates, each deme in the metapopulation performs a quasi-independent trial at crossing the valley or plateau. At best, the valley or plateau crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e042" xlink:type="simple"/></inline-formula> of the whole metapopulation is dominated by that, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e043" xlink:type="simple"/></inline-formula>, of the “champion'' deme in the metapopulation, i.e. the deme that crosses the fitness valley or plateau fastest.</p>
<p>We now focus on this best possible scenario, which is illustrated schematically in <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1B:</xref> first, the champion deme crosses the valley or plateau by sequential fixation, and then the beneficial mutation rapidly spreads by migration of through the whole metapopulation. Once this best possible scenario is characterized, the crucial question will be whether, and under what conditions, it can be attained: this point will be addressed in the following section.</p>
<sec id="s2b1">
<title>Determination of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e044" xlink:type="simple"/></inline-formula></title>
<p>Valley or plateau crossing by a non-structured, well-mixed population can occur by two different mechanisms: sequential fixation and tunneling. The former corresponds to fixation of mutation ‘1' in the whole population, and to subsequent fixation of the beneficial mutation ‘2'. Conversely, the latter occurs when the beneficial mutation arises in a small fluctuating minority of first-mutants, and fixes directly: tunneling does not involve fixation of the intermediate mutation ‘1' <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. For given values of the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e045" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e046" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e047" xlink:type="simple"/></inline-formula>, sequential fixation is the fastest process for small populations, where genetic drift plays an important part. Tunneling becomes the dominant process of valley or plateau crossing when the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e048" xlink:type="simple"/></inline-formula> of individuals per deme exceeds a threshold value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e049" xlink:type="simple"/></inline-formula>, which depends on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e050" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e051" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e052" xlink:type="simple"/></inline-formula> (see Ref. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref> for a full discussion of this threshold value). <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1C</xref> shows simulation results for the valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e053" xlink:type="simple"/></inline-formula> of a non-subdivided population versus its size, and illustrates these two different regimes and the transition between them. Note that in our simulations (described in <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 1), we hold fixed the carrying capacity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e054" xlink:type="simple"/></inline-formula> of populations (or demes) instead of the number of individuals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e055" xlink:type="simple"/></inline-formula>. This softer constraint is more realistic and avoids some possible biases in the metapopulation case (see <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 1.2). In practice, each individual divides at a rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e056" xlink:type="simple"/></inline-formula> and dies at a constant rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e057" xlink:type="simple"/></inline-formula>: hence, at steady-state, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e058" xlink:type="simple"/></inline-formula>. We choose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e059" xlink:type="simple"/></inline-formula>, and fitnesses <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e060" xlink:type="simple"/></inline-formula> of order one, thus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e061" xlink:type="simple"/></inline-formula>.</p>
<p>We now consider <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e062" xlink:type="simple"/></inline-formula> independent demes with no migration, and we determine the crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e063" xlink:type="simple"/></inline-formula> of the fastest of these <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e064" xlink:type="simple"/></inline-formula> demes, both for demes in the sequential fixation regime and for demes in the tunneling regime.</p>
</sec><sec id="s2b2">
<title>Demes in the sequential fixation regime</title>
<p>Let<disp-formula id="pcbi.1003778.e065"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e065" xlink:type="simple"/><label>(1)</label></disp-formula>denote the probability of fixation of genotype ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e066" xlink:type="simple"/></inline-formula>', with fitness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e067" xlink:type="simple"/></inline-formula>, starting from a single individual with genotype ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e068" xlink:type="simple"/></inline-formula>' in a deme where all other individuals initially have genotype ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e069" xlink:type="simple"/></inline-formula>' and fitness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e070" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003778-Ewens1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e071" xlink:type="simple"/></inline-formula>, the probability of fixation of genotype ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e072" xlink:type="simple"/></inline-formula>' reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e073" xlink:type="simple"/></inline-formula>. Valley or plateau crossing by sequential fixation involves two successive steps. The first step, fixation of the intermediate mutation ‘1', occurs with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e074" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e075" xlink:type="simple"/></inline-formula> is the total mutation rate in the deme. (Recall that the deme size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e076" xlink:type="simple"/></inline-formula> is fixed, and that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e077" xlink:type="simple"/></inline-formula> represents the birth/death rate. Note that the correspondence with Ref. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref> is obtained by multiplying by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e078" xlink:type="simple"/></inline-formula> all the timescales in this reference, which are expressed in numbers of generations.) Similarly, the second step, fixation of the final beneficial mutation ‘2', has rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e079" xlink:type="simple"/></inline-formula>. The first step is longer than the second one since mutation ‘1' is neutral or deleterious, while mutation ‘2' is beneficial. If the first step dominates, the distribution of crossing times is approximately exponential with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e080" xlink:type="simple"/></inline-formula>. The shortest crossing time among <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e081" xlink:type="simple"/></inline-formula> independent demes is then distributed exponentially with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e082" xlink:type="simple"/></inline-formula> (see <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 2). Thus, the average crossing time of the champion deme reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e083" xlink:type="simple"/></inline-formula>. Denoting by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e084" xlink:type="simple"/></inline-formula> the average crossing time for an isolated deme, we obtain</p>
<p><disp-formula id="pcbi.1003778.e085"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e085" xlink:type="simple"/><label>(2)</label></disp-formula>Hence, the champion deme crosses the valley <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e086" xlink:type="simple"/></inline-formula> times faster on average than a single deme. This simple result holds for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e087" xlink:type="simple"/></inline-formula>. For simplicity, we restrict ourselves to this regime in the main text, but we provide the general method for calculating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e088" xlink:type="simple"/></inline-formula> in <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 2. We use this general method to calculate numerically the exact value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e089" xlink:type="simple"/></inline-formula> in our examples below.</p>
</sec><sec id="s2b3">
<title>Demes in the tunneling regime</title>
<p>Assuming that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e090" xlink:type="simple"/></inline-formula>, so that there is no competition between different mutant lineages, valley or plateau crossing by tunneling involves a single event with constant rate, namely the appearance of a “successful'' ‘1'-mutant, whose lineage includes a ‘2'-mutant that fixes <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Crossing time is thus exponentially distributed. Therefore, in this case too, the crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e091" xlink:type="simple"/></inline-formula> of the champion deme among <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e092" xlink:type="simple"/></inline-formula> isolated demes is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e093" xlink:type="simple"/></inline-formula> times smaller than that of an average isolated deme (see <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 2): <xref ref-type="disp-formula" rid="pcbi.1003778.e085">Eq. 2</xref> is valid in the tunneling regime too.</p>
</sec><sec id="s2b4">
<title>Sequential fixation in individual demes is necessary for significant speedups</title>
<p>In the best possible scenario, where crossing by the metapopulation is dominated by that of the champion deme, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e094" xlink:type="simple"/></inline-formula>, the previous paragraph shows that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e095" xlink:type="simple"/></inline-formula>, both when isolated demes are in the sequential fixation regime and when they are in the tunneling regime. Hence, it is necessary to have<disp-formula id="pcbi.1003778.e096"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e096" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e097" xlink:type="simple"/></inline-formula> is the average crossing time of the non-subdivided population, for subdivision to speed up valley or plateau crossing in the best scenario (i.e. for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e098" xlink:type="simple"/></inline-formula> to be smaller than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e099" xlink:type="simple"/></inline-formula>). This necessary condition is general since it holds <italic>a fortiori</italic> beyond the best scenario. Graphically, in <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1C</xref>, which is a logarithmic plot of crossing time versus population size for a non-structured population, the slope of the line joining the isolated deme to the non-subdivided population has to be less negative than -1 in order for speedups to be possible. Recall indeed that the nonsubdivided population is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e100" xlink:type="simple"/></inline-formula> times larger than an isolated deme. The necessary condition in <xref ref-type="disp-formula" rid="pcbi.1003778.e096">Eq. 3</xref> leaves the possibility of significant speedups in the non-trivial case where a single isolated deme crosses slower than a non-subdivided population (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e101" xlink:type="simple"/></inline-formula>). <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1D</xref> demonstrates a significant speedup by subdivision obtained in this regime where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e102" xlink:type="simple"/></inline-formula>.</p>
<p>Let us consider a metapopulation such that isolated demes are in the tunneling regime. Then, the larger non-subdivided population with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e103" xlink:type="simple"/></inline-formula> individuals is also in the tunneling regime <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Assuming that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e104" xlink:type="simple"/></inline-formula>, valley or plateau crossing by this non-subdivided population follows the same laws as crossing by the demes. Since the average crossing time by tunneling is inversely proportional to population size (see Ref. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref> and <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1C</xref>), we obtain <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e105" xlink:type="simple"/></inline-formula>, in contradiction with <xref ref-type="disp-formula" rid="pcbi.1003778.e096">Eq. 3</xref>. This implies that, even in the best possible scenario, subdivision cannot accelerate crossing if isolated demes are in the tunneling regime (since here, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e106" xlink:type="simple"/></inline-formula>). Thus, having isolated demes in the sequential fixation regime is a necessary condition for subdivision to accelerate crossing. Importantly, however, the non-subdivided population is not required to be in the sequential fixation regime. For instance, in <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1D</xref>, the non-subdivided population is in the tunneling regime. Note that when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e107" xlink:type="simple"/></inline-formula>, the population enters the semi-deterministic regime <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref> and the average crossing time need not be proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e108" xlink:type="simple"/></inline-formula>. Minor speedups may exist in this regime, but such effects are beyond the scope of this work. In all the following, we will focus on the regime <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e109" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2b5">
<title>Maximal possible speedup by subdivision</title>
<p>The speedup gained by subdividing a population of a given total size is directly described by the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e110" xlink:type="simple"/></inline-formula> of the valley crossing time of a metapopulation to that of a non-subdivided population. Here, we discuss the values this ratio can take in the best possible scenario, where valley crossing by the metapopulation is dominated by that of the champion deme, and we determine the valley depth for which the highest speedups are obtained (i.e. for which this ratio is smallest).</p>
<p>Let us first focus on the case where both the non-subdivided population and the isolated deme are in the sequential fixation regime. The average valley crossing time by the champion deme reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e111" xlink:type="simple"/></inline-formula> (see our calculation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e112" xlink:type="simple"/></inline-formula> above). In the best possible scenario, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e113" xlink:type="simple"/></inline-formula>. The average valley crossing time by the non-subdivided population is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e114" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e115" xlink:type="simple"/></inline-formula> is the fixation probability of an individual with genotype ‘1' in a population of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e116" xlink:type="simple"/></inline-formula> individuals where all the others initially have genotype ‘0' (see <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>). Hence, we obtain<disp-formula id="pcbi.1003778.e117"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e117" xlink:type="simple"/><label>(4)</label></disp-formula></p>
<p>In the case of a plateau, this reduces to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e118" xlink:type="simple"/></inline-formula>. These results demonstrate that if both the non-subdivided population and the isolated deme are in the sequential fixation regime, then subdivision significantly accelerates crossing in the best scenario. The speedup by subdivision becomes larger (i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e119" xlink:type="simple"/></inline-formula> becomes smaller) when the number of demes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e120" xlink:type="simple"/></inline-formula> is increased at fixed valley depth <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e121" xlink:type="simple"/></inline-formula> and fixed deme size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e122" xlink:type="simple"/></inline-formula> (or fixed total population size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e123" xlink:type="simple"/></inline-formula>). Besides, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e124" xlink:type="simple"/></inline-formula>, the ratio in <xref ref-type="disp-formula" rid="pcbi.1003778.e117">Eq. 4</xref> decreases when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e125" xlink:type="simple"/></inline-formula> is increased at fixed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e126" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e127" xlink:type="simple"/></inline-formula>: the highest speedups are obtained for the deepest valleys. However, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e128" xlink:type="simple"/></inline-formula> is increased, the non-subdivided population will eventually enter the tunneling regime (see <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1C</xref>).</p>
<p>Let us now consider the alternative case, where the non-subdivided population is in the tunneling regime, while the isolated demes are in the sequential fixation regime. In this case, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e129" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e130" xlink:type="simple"/></inline-formula> is the fixation probability of a ‘1'-mutant in an isolated deme (see <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>), while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e131" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e132" xlink:type="simple"/></inline-formula> is the probability that a ‘1'-mutant is “successful'' in the tunneling process, i.e. that its lineage includes a ‘2'-mutant that fixes in the non-subdivided population <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Hence, in the best scenario, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e133" xlink:type="simple"/></inline-formula>, we obtain<disp-formula id="pcbi.1003778.e134"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e134" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e135" xlink:type="simple"/></inline-formula> is independent from population size <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>, it also represents the probability of successful tunneling <italic>in an isolated deme</italic>. For isolated demes in the sequential fixation regime, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e136" xlink:type="simple"/></inline-formula> by definition <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Hence, <xref ref-type="disp-formula" rid="pcbi.1003778.e134">Eq. 5</xref> entails <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e137" xlink:type="simple"/></inline-formula>. Thus, speedups always exist in the best scenario, provided that the necessary condition that isolated demes cross the plateau by sequential fixation is satisfied. In the case of a fitness plateau, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e138" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e139" xlink:type="simple"/></inline-formula>. Hence, <xref ref-type="disp-formula" rid="pcbi.1003778.e134">Eq. 5</xref> yields<disp-formula id="pcbi.1003778.e140"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e140" xlink:type="simple"/><label>(6)</label></disp-formula></p>
<p>In the other extreme case of a sufficiently deep valley that satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e141" xlink:type="simple"/></inline-formula>, we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e142" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Using the condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e143" xlink:type="simple"/></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref> yields <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e144" xlink:type="simple"/></inline-formula>. Hence, <xref ref-type="disp-formula" rid="pcbi.1003778.e134">Eq. 5</xref> gives<disp-formula id="pcbi.1003778.e145"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e145" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>Interestingly, these expressions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e146" xlink:type="simple"/></inline-formula> are independent of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e147" xlink:type="simple"/></inline-formula> at fixed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e148" xlink:type="simple"/></inline-formula>. This stands into contrast with the regime discussed above where the non-subdivided population is in the sequential fixation regime. At fixed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e149" xlink:type="simple"/></inline-formula>, the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e150" xlink:type="simple"/></inline-formula> expressed in <xref ref-type="disp-formula" rid="pcbi.1003778.e145">Eq. 7</xref> is minimal for<disp-formula id="pcbi.1003778.e151"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e151" xlink:type="simple"/><label>(8)</label></disp-formula></p>
<p>The minimum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e152" xlink:type="simple"/></inline-formula>, corresponding to the largest speedup by subdivision, is obtained for this value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e153" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003778.e154"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e154" xlink:type="simple"/><label>(9)</label></disp-formula></p>
<p>The small values of mutation probabilities in nature ensure that the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e155" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003778.e140">Eqs. 6</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e154">9</xref> can be very small.</p>
</sec></sec><sec id="s2c">
<title>Conditions for subdivision to maximally accelerate valley or plateau crossing</title>
<p>The previous section was dedicated to the study of the best possible scenario, where the valley or plateau crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e156" xlink:type="simple"/></inline-formula> of the whole metapopulation is dominated by that, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e157" xlink:type="simple"/></inline-formula>, of the champion deme in the metapopulation (i.e. the one that crosses fastest). We now determine analytically the conditions under which this best possible scenario is attained. For this, we focus on migration rates much smaller than division/death rates, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e158" xlink:type="simple"/></inline-formula>, such that fixation or extinction of a mutant lineage in a deme is not perturbed by migration. In addition, we assume that isolated demes are in the sequential fixation regime, since we showed above that it is a necessary condition for subdivision to significantly accelerate crossing, and that it is a sufficient condition for subdivision to accelerate crossing in the best scenario.</p>
<p>In a nutshell, migration must be rare enough for demes to evolve quasi-independently, but frequent enough to spread the beneficial mutation rapidly. The analytical results below allow for predicting the range of migration rates such that subdivision maximally accelerates valley or plateau crossing.</p>
<sec id="s2c1">
<title>First condition: Quasi-independence</title>
<p>Migration must be rare enough for demes to remain shielded from migration while they harbor the intermediate mutation. Hence, the average time for a deme of ‘1'-mutants to fix the beneficial mutation ‘2', which reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e159" xlink:type="simple"/></inline-formula>, must be smaller than the average extinction time, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e160" xlink:type="simple"/></inline-formula>, for a deme of ‘1'-mutants to be wiped out by migration from other demes with genotype ‘0'. The total rate of migration events in the metapopulation is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e161" xlink:type="simple"/></inline-formula>, so <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e162" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e163" xlink:type="simple"/></inline-formula> is the average total number of migration events required for the ‘1'-mutants to go extinct. The first condition, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e164" xlink:type="simple"/></inline-formula>, thus yields<disp-formula id="pcbi.1003778.e165"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e165" xlink:type="simple"/><label>(10)</label></disp-formula></p>
<p>Let us now estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e166" xlink:type="simple"/></inline-formula>. If one deme has fixed genotype ‘1' while all the others still have genotype ‘0', the probability that a migration event involves the mutant deme is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e167" xlink:type="simple"/></inline-formula>. Following such a “relevant” migration event, extinction of the mutant (‘1') lineage occurs if the ‘0' migrant fixes in the ‘1' deme while the ‘1' migrant does not fix in the ‘0' deme: this occurs with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e168" xlink:type="simple"/></inline-formula>. Conversely, the number of mutant demes increases to two with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e169" xlink:type="simple"/></inline-formula>, and otherwise remains constant. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e170" xlink:type="simple"/></inline-formula>, using also <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e171" xlink:type="simple"/></inline-formula>, we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e172" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>). Hence, migration-induced increases in the number of mutant demes can be neglected, and we obtain<disp-formula id="pcbi.1003778.e173"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e173" xlink:type="simple"/><label>(11)</label></disp-formula></p>
<p>In <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 3, we derive the general expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e174" xlink:type="simple"/></inline-formula>, which does not require <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e175" xlink:type="simple"/></inline-formula>, using finite Markov chain theory <xref ref-type="bibr" rid="pcbi.1003778-Ewens1">[25]</xref>. Note that this general expression is important because subdivision generically most accelerates valley crossing for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e176" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003778.e151">Eq. 8</xref>).</p>
</sec><sec id="s2c2">
<title>Second condition: Rapid spreading</title>
<p>Migration must be frequent enough for the average spreading time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e177" xlink:type="simple"/></inline-formula> of the final mutation through the whole metapopulation to be shorter than the valley or plateau crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e178" xlink:type="simple"/></inline-formula> by the champion deme. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e179" xlink:type="simple"/></inline-formula> be the average number of migration events required for the final beneficial mutants (with genotype ‘2') to spread by migration, once the champion deme has fixed genotype ‘2'. Then, we can write <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e180" xlink:type="simple"/></inline-formula>, and the second condition reads<disp-formula id="pcbi.1003778.e181"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e181" xlink:type="simple"/><label>(12)</label></disp-formula></p>
<p>Let us now estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e182" xlink:type="simple"/></inline-formula>, starting from a state where the champion deme has fixed genotype ‘2', while all others still contain genotype ‘0'. (Note that some demes may have genotype ‘1', but this is rare since fixation of mutation ‘1' is the slowest step. Moreover, this would not change the spreading time for a plateau and would shorten it for a valley.) Let us focus on the regime where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e183" xlink:type="simple"/></inline-formula> but <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e184" xlink:type="simple"/></inline-formula>, such that mutation ‘2' is substantially, but not overwhelmingly, beneficial <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. As in the above discussion about <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e185" xlink:type="simple"/></inline-formula>, we then obtain <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e186" xlink:type="simple"/></inline-formula>. Thus, it is possible to neglect any migration-induced decrease in the number of demes with genotype ‘2', which we denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e187" xlink:type="simple"/></inline-formula>. The probability that a migration step exchanges individuals with different genotypes is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e188" xlink:type="simple"/></inline-formula>, and the probability that such a relevant migration step increases <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e189" xlink:type="simple"/></inline-formula> by one is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e190" xlink:type="simple"/></inline-formula>. Hence, we obtain<disp-formula id="pcbi.1003778.e191"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e191" xlink:type="simple"/><label>(13)</label></disp-formula>where the last expression is obtained for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e192" xlink:type="simple"/></inline-formula>. In <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 3, we use finite Markov chain theory to derive the general analytical expression for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e193" xlink:type="simple"/></inline-formula>, which does not require <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e194" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2c3">
<title>Combination of the two conditions</title>
<p>Together, <xref ref-type="disp-formula" rid="pcbi.1003778.e165">Eqs. 10</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e181">12</xref> yield the interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e195" xlink:type="simple"/></inline-formula> over which subdivision maximally accelerates valley or plateau crossing. For<disp-formula id="pcbi.1003778.e196"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e196" xlink:type="simple"/><label>(14)</label></disp-formula>we expect the valley or plateau crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e197" xlink:type="simple"/></inline-formula> of the whole metapopulation to be dominated by that of the champion deme: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e198" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e199" xlink:type="simple"/></inline-formula> is the average crossing time for an isolated deme, and in the best scenario, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e200" xlink:type="simple"/></inline-formula>.</p>
<p>In the regime where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e201" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e202" xlink:type="simple"/></inline-formula>, we can use the simple expressions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e203" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e204" xlink:type="simple"/></inline-formula> given in <xref ref-type="disp-formula" rid="pcbi.1003778.e173">Eqs. 11</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e191">13</xref>, which yields<disp-formula id="pcbi.1003778.e205"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e205" xlink:type="simple"/><label>(15)</label></disp-formula></p>
<p>The ratio, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e206" xlink:type="simple"/></inline-formula>, of the upper to lower bound in <xref ref-type="disp-formula" rid="pcbi.1003778.e205">Eq. 15</xref> reads<disp-formula id="pcbi.1003778.e207"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e207" xlink:type="simple"/><label>(16)</label></disp-formula></p>
<p>This ratio increases exponentially with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e208" xlink:type="simple"/></inline-formula> (this dependence on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e209" xlink:type="simple"/></inline-formula> comes from that of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e210" xlink:type="simple"/></inline-formula>). This entails that, in this regime, the interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e211" xlink:type="simple"/></inline-formula> where subdivision most accelerates crossing becomes wider as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e212" xlink:type="simple"/></inline-formula> increases. However, the width of this interval is limited by the fact that isolated demes have to be in the sequential fixation regime (see <xref ref-type="sec" rid="s3">Discussion</xref>). While the expressions of the interval bounds in <xref ref-type="disp-formula" rid="pcbi.1003778.e205">Eq. 15</xref> are more illuminating and easier to derive than the general ones, the latter, given in <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 3, actually play important roles since the highest speedups of valley crossing gained by subdivision are generically obtained for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e213" xlink:type="simple"/></inline-formula> (see Eq. 8).</p>
</sec><sec id="s2c4">
<title>Case of the fitness plateau</title>
<p>We have obtained an explicit expression of the interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e214" xlink:type="simple"/></inline-formula> over which subdivision maximally accelerates valley crossing in the case of a relatively deep fitness valley where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e215" xlink:type="simple"/></inline-formula> while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e216" xlink:type="simple"/></inline-formula>. In the opposite limit of a fitness plateau (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e217" xlink:type="simple"/></inline-formula>), retaining the assumptions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e218" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e219" xlink:type="simple"/></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> can also be simplified. For this, we use the expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e220" xlink:type="simple"/></inline-formula> obtained in <xref ref-type="disp-formula" rid="pcbi.1003778.e648">Eq. 35</xref> of <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 3, and the expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e221" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003778.e191">Eq. 13</xref>, and we note that, since mutation ‘1' is neutral, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e222" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e223" xlink:type="simple"/></inline-formula>. <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> then becomes:<disp-formula id="pcbi.1003778.e224"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e224" xlink:type="simple"/><label>(17)</label></disp-formula>where we have used <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e225" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e226" xlink:type="simple"/></inline-formula>. The ratio, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e227" xlink:type="simple"/></inline-formula>, of the upper to lower bound in <xref ref-type="disp-formula" rid="pcbi.1003778.e224">Eq. 17</xref> reads</p>
<p><disp-formula id="pcbi.1003778.e228"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e228" xlink:type="simple"/><label>(18)</label></disp-formula>This simple expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e229" xlink:type="simple"/></inline-formula> demonstrates that the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e230" xlink:type="simple"/></inline-formula> over which subdivision maximally accelerates plateau crossing increases as the deme size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e231" xlink:type="simple"/></inline-formula> becomes larger, and that this range is quite wide as long as the number of demes satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e232" xlink:type="simple"/></inline-formula>, which is a realistic condition (recall that we are in the regime <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e233" xlink:type="simple"/></inline-formula>).</p>
</sec></sec><sec id="s2d">
<title>Simulation results</title>
<p>We now present numerical simulations of the evolutionary dynamics described above, which enable us to test our analytical predictions, and to gain additional insight in the process beyond the optimal scenario. Our simulations are based on a Gillespie algorithm <xref ref-type="bibr" rid="pcbi.1003778-Gillespie1">[48]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Gillespie2">[49]</xref>, and described in detail in <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 1.</p>
<p>Let us first focus on the example presented in <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1D</xref>, which shows an example plot of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e234" xlink:type="simple"/></inline-formula> as a function of the ratio of migration to mutation rates, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e235" xlink:type="simple"/></inline-formula>, obtained through our simulations when varying only the migration rate. With the parameter values used in this figure, the interval of <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e236" xlink:type="simple"/></inline-formula>. Note that here, and in the following examples, we use the general expressions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e237" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e238" xlink:type="simple"/></inline-formula> given in <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 3, to compute the interval of <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref>. <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1D</xref> features a minimum right at the center of this theoretically predicted optimal interval. Moreover, this minimum corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e239" xlink:type="simple"/></inline-formula>, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e240" xlink:type="simple"/></inline-formula>: hence, the metapopulation crosses the valley on average 6.54 times faster than an isolated deme. This is very close to the limit of the best possible scenario, where the metapopulation would cross 7 times faster than an isolated deme (since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e241" xlink:type="simple"/></inline-formula> here). This example illustrates that speedups tend towards those predicted in the best scenario, when the interval in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> is sufficiently wide (here the ratio between its upper and its lower bound is 359). Besides, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e242" xlink:type="simple"/></inline-formula> here: comparing it to the above-mentioned value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e243" xlink:type="simple"/></inline-formula> yields a 3.47-fold speedup of valley crossing by subdivision. The simulation results in <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1D</xref> also show that significant (albeit smaller) speedups exist beyond the optimal parameter window.</p>
<p><xref ref-type="fig" rid="pcbi-1003778-g002">Fig. 2</xref> shows heatmaps of the valley crossing time of a metapopulation as a function of the migration-to-mutation rate ratio, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e244" xlink:type="simple"/></inline-formula> (varied by varying <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e245" xlink:type="simple"/></inline-formula>), and of the fitness valley depth, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e246" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1003778-g002">Fig. 2A</xref> shows that the optimal interval of <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> (solid lines) describes well the region where the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e247" xlink:type="simple"/></inline-formula> of the crossing time of the metapopulation to that of an isolated deme is smallest and tends to the best-scenario limit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e248" xlink:type="simple"/></inline-formula>. For migration rates lower than those in this interval, the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e249" xlink:type="simple"/></inline-formula> increases when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e250" xlink:type="simple"/></inline-formula> decreases. This can be understood qualitatively by noting that if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e251" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e252" xlink:type="simple"/></inline-formula> is determined by the valley crossing time of the slowest among the independent demes. In the opposite case of migration rates larger than those in the optimal interval, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e253" xlink:type="simple"/></inline-formula> increases with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e254" xlink:type="simple"/></inline-formula>, and it tends to the non-subdivided case, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e255" xlink:type="simple"/></inline-formula>, at high values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e256" xlink:type="simple"/></inline-formula>, as expected. Above a threshold value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e257" xlink:type="simple"/></inline-formula> (dashed line), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e258" xlink:type="simple"/></inline-formula> becomes smaller than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e259" xlink:type="simple"/></inline-formula>, in which case large values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e260" xlink:type="simple"/></inline-formula>, such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e261" xlink:type="simple"/></inline-formula> tends to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e262" xlink:type="simple"/></inline-formula>, give a low <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e263" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1003778-g002">Fig. 2A</xref>).</p>
<fig id="pcbi-1003778-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003778.g002</object-id><label>Figure 2</label><caption>
<title>Effect of subdivision on valley crossing time for various migration rates and valley depths.</title>
<p><bold>A.</bold> Heatmap of the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e264" xlink:type="simple"/></inline-formula> of the average valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e265" xlink:type="simple"/></inline-formula> of a metapopulation with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e266" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e267" xlink:type="simple"/></inline-formula> to that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e268" xlink:type="simple"/></inline-formula> of an isolated deme with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e269" xlink:type="simple"/></inline-formula>, as a function of valley depth <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e270" xlink:type="simple"/></inline-formula> and migration-to-mutation rate ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e271" xlink:type="simple"/></inline-formula>, in logarithmic scale. All numerical results are averaged over 100 simulation runs, and the heatmap is interpolated. Solid lines: bounds of the interval in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref>. Dashed line: value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e272" xlink:type="simple"/></inline-formula> above which a non-subdivided population crosses the valley faster than an isolated deme. Dotted line: value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e273" xlink:type="simple"/></inline-formula> above which an isolated deme is in the tunneling regime. Dash-dotted line: value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e274" xlink:type="simple"/></inline-formula> above which the non-subdivided population is in the tunneling regime. Parameter values: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e275" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e276" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e277" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e278" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e279" xlink:type="simple"/></inline-formula> are varied. <bold>B.</bold> Similar heatmap for the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e280" xlink:type="simple"/></inline-formula> of the average valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e281" xlink:type="simple"/></inline-formula> of a metapopulation to that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e282" xlink:type="simple"/></inline-formula> of a non-subdivided population (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e283" xlink:type="simple"/></inline-formula>). Solid line: predicted value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e284" xlink:type="simple"/></inline-formula>, from <xref ref-type="disp-formula" rid="pcbi.1003778.e151">Eq. 8</xref>, for which the largest speedup by subdivision is expected.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003778.g002" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1003778-g002">Fig. 2B</xref> plots the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e285" xlink:type="simple"/></inline-formula> of the crossing time of the metapopulation to that of the non-subdivided population, which directly yields the speedup obtained by subdividing a population. It shows that, for the parameter values chosen, subdivision accelerates valley crossing over a large range of valley depths and migration rates, extending far beyond the optimal range given by <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref>, and that the metapopulation can cross valleys orders of magnitude faster than a single large population. In addition, above a second, larger threshold value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e286" xlink:type="simple"/></inline-formula> (dotted line in <xref ref-type="fig" rid="pcbi-1003778-g002">Fig. 2</xref>), isolated demes enter the tunneling regime <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>: <xref ref-type="fig" rid="pcbi-1003778-g002">Fig. 2B</xref> shows that sufficiently above this threshold, the metapopulation no longer crosses the valley faster than the non-subdivided population, as predicted above. While having isolated demes in the sequential fixation regime is a necessary condition to obtain significant speedups by subdivision, the non-subdivided population is not required to be in the sequential fixation regime (see above, and <xref ref-type="fig" rid="pcbi-1003778-g001">Fig. 1C–D</xref>). The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e287" xlink:type="simple"/></inline-formula> above which the non-subdivided population enters the tunneling regime is indicated by a dash-dotted line in <xref ref-type="fig" rid="pcbi-1003778-g002">Fig. 2:</xref> significant speedups are obtained both below and above this line. The highest speedups are actually obtained above it, i.e. when the non-subdivided population is in the tunneling regime. With the parameter values used, <xref ref-type="disp-formula" rid="pcbi.1003778.e151">Eq. 8</xref> predicts a minimum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e288" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e289" xlink:type="simple"/></inline-formula> (solid line in <xref ref-type="fig" rid="pcbi-1003778-g002">Fig. 2B</xref>), which agrees very well with the results of our numerical simulations. (Note that this value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e290" xlink:type="simple"/></inline-formula> satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e291" xlink:type="simple"/></inline-formula>, and is such that the non-subdivided population is in the tunneling regime. These conditions were used in our derivation of <xref ref-type="disp-formula" rid="pcbi.1003778.e151">Eq. 8</xref>.)</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<sec id="s3a">
<title>Limits on the parameter range where subdivision maximally accelerates crossing</title>
<p>In the Results section, we have shown that having isolated demes in the sequential fixation regime is a necessary condition for subdivision to significantly accelerate crossing. This requirement limits the interval of the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e292" xlink:type="simple"/></inline-formula> over which the highest speedups by subdivision are obtained. The extent of this interval can be characterized by the ratio, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e293" xlink:type="simple"/></inline-formula>, of the upper to lower bound in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref>. Let us express the bound on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e294" xlink:type="simple"/></inline-formula> imposed by the requirement of sequential fixation in isolated demes.</p>
<p>If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e295" xlink:type="simple"/></inline-formula>, the threshold value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e296" xlink:type="simple"/></inline-formula> below which an isolated deme is in the sequential fixation regime satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e297" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Let us also assume that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e298" xlink:type="simple"/></inline-formula>, and that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e299" xlink:type="simple"/></inline-formula> while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e300" xlink:type="simple"/></inline-formula>, to be in the domain of validity of <xref ref-type="disp-formula" rid="pcbi.1003778.e205">Eqs. 15</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e207">16</xref>. Combining the condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e301" xlink:type="simple"/></inline-formula> with the expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e302" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003778.e207">Eq. 16</xref> yields<disp-formula id="pcbi.1003778.e303"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e303" xlink:type="simple"/><label>(19)</label></disp-formula></p>
<p>For plateaus, isolated demes are in the sequential fixation regime if their size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e304" xlink:type="simple"/></inline-formula> is smaller than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e305" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. In the regime of validity of <xref ref-type="disp-formula" rid="pcbi.1003778.e224">Eqs. 17</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e228">18</xref> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e306" xlink:type="simple"/></inline-formula> while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e307" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e308" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e309" xlink:type="simple"/></inline-formula>), this condition can be combined with <xref ref-type="disp-formula" rid="pcbi.1003778.e228">Eq. 18</xref>, which yields<disp-formula id="pcbi.1003778.e310"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e310" xlink:type="simple"/><label>(20)</label></disp-formula></p>
<p>Both <xref ref-type="disp-formula" rid="pcbi.1003778.e303">Eq. 19</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e310">Eq. 20</xref> show that increasing the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e311" xlink:type="simple"/></inline-formula> of demes decreases the range where the highest speedup by subdivision is reached. This is because having more subpopulations makes the spreading of the beneficial mutation slower. In addition, we find that the bound on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e312" xlink:type="simple"/></inline-formula> is proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e313" xlink:type="simple"/></inline-formula>. Hence, despite this bound, the interval where subdivision most accelerates plateau crossing can span several orders of magnitude, given the small values of the actual mutation probabilities <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e314" xlink:type="simple"/></inline-formula> in nature.</p>
</sec><sec id="s3b">
<title>Effect of varying the degree of subdivision of a metapopulation</title>
<p>An interesting question raised by our results regards the optimal degree of subdivision. Given a certain total metapopulation size, into how many demes should it be subdivided in order to obtain the highest speedup possible? We first attack this question using our analytical results, and then we present simulation results, which allow for going beyond the best scenario and its associated parameter window.</p>
<p>Let us consider a metapopulation of given total size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e315" xlink:type="simple"/></inline-formula>. Our analytical results show that increasing subdivision, i.e. increasing the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e316" xlink:type="simple"/></inline-formula> of subpopulations at constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e317" xlink:type="simple"/></inline-formula>, leads to stronger speedups of valley crossing (see <xref ref-type="disp-formula" rid="pcbi.1003778.e117">Eqs. 4</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e145">7</xref>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e318" xlink:type="simple"/></inline-formula>). However, <xref ref-type="disp-formula" rid="pcbi.1003778.e207">Eqs. 16</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e228">18</xref>, and the previous paragraph, show that when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e319" xlink:type="simple"/></inline-formula> is increased, the parameter range where the speedup by subdivision tends to the best-scenario value becomes smaller and smaller. Eventually, this parameter range ceases to exist altogether: this occurs when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e320" xlink:type="simple"/></inline-formula> becomes of order 1 and below. This sheds light on an interesting trade-off in the degree of subdivision <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e321" xlink:type="simple"/></inline-formula>, between the magnitude of the optimal speedup gained by subdivision and the width of the parameter range over which the actual speedup is close to this optimal value. This effect can be observed qualitatively in <xref ref-type="fig" rid="pcbi-1003778-g003">Fig. 3A</xref>, where the valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e322" xlink:type="simple"/></inline-formula> of a metapopulation with fixed total size is shown versus the migration-to-mutation rate ratio, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e323" xlink:type="simple"/></inline-formula>, for different values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e324" xlink:type="simple"/></inline-formula>: when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e325" xlink:type="simple"/></inline-formula> is increased, the minimum becomes deeper but less broad.</p>
<fig id="pcbi-1003778-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003778.g003</object-id><label>Figure 3</label><caption>
<title>Varying the degree of subdivision of a metapopulation.</title>
<p><bold>A.</bold> Valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e326" xlink:type="simple"/></inline-formula> of a metapopulation with total carrying capacity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e327" xlink:type="simple"/></inline-formula>, versus migration-to-mutation rate ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e328" xlink:type="simple"/></inline-formula>, for four different numbers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e329" xlink:type="simple"/></inline-formula> of demes. Dots are simulation results, averaged over 1000 runs for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e330" xlink:type="simple"/></inline-formula> (500 runs for a few points far from the minima); error bars represent 95% CI. Vertical lines represent the limits of the interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e331" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> in each case, except for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e332" xlink:type="simple"/></inline-formula>, where this interval does not exist. Black horizontal line: plateau crossing time for a non-subdivided population with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e333" xlink:type="simple"/></inline-formula> for the same parameter values, averaged over 1000 runs; shaded regions: 95% CI. Dashed line: corresponding theoretical prediction from Ref. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Parameter values: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e334" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e335" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e336" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e337" xlink:type="simple"/></inline-formula> (same as in Fig. 1C–D); <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e338" xlink:type="simple"/></inline-formula> is varied. <bold>B.</bold> Valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e339" xlink:type="simple"/></inline-formula> of a metapopulation with total carrying capacity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e340" xlink:type="simple"/></inline-formula>, versus the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e341" xlink:type="simple"/></inline-formula> of demes, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e342" xlink:type="simple"/></inline-formula> (i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e343" xlink:type="simple"/></inline-formula>). Dots are simulation results, averaged over 1000 runs for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e344" xlink:type="simple"/></inline-formula>; error bars represent 95% CI. Parameter values: same as in A. <bold>C.</bold> Valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e345" xlink:type="simple"/></inline-formula>, minimized over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e346" xlink:type="simple"/></inline-formula> for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e347" xlink:type="simple"/></inline-formula>, of a metapopulation with total carrying capacity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e348" xlink:type="simple"/></inline-formula>, versus the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e349" xlink:type="simple"/></inline-formula> of demes. For each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e350" xlink:type="simple"/></inline-formula>, the valley crossing time of the metapopulation was computed for several values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e351" xlink:type="simple"/></inline-formula>, different by factors of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e352" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e353" xlink:type="simple"/></inline-formula> in the vicinity of the minimum (see A): <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e354" xlink:type="simple"/></inline-formula> corresponds to the smallest value obtained in this process. Results obtained for the actual metapopulation (blue) are compared to the best-scenario limit (red) where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e355" xlink:type="simple"/></inline-formula>, calculated using the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e356" xlink:type="simple"/></inline-formula> obtained from our simulations. Dots are simulation results, averaged over 1000 runs for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e357" xlink:type="simple"/></inline-formula>; error bars represent 95% CI. Dashed line: value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e358" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e359" xlink:type="simple"/></inline-formula>. Dotted line: value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e360" xlink:type="simple"/></inline-formula> above which the deleterious mutation is effectively neutral in the isolated demes. Solid line: value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e361" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e362" xlink:type="simple"/></inline-formula>. Parameter values: same as in A and B.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003778.g003" position="float" xlink:type="simple"/></fig>
<p>In addition, <xref ref-type="disp-formula" rid="pcbi.1003778.e205">Eqs. 15</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e224">17</xref> show that when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e363" xlink:type="simple"/></inline-formula> is increased, the lower bound of the interval where the speedup by subdivision tends to the best-scenario value decreases, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e364" xlink:type="simple"/></inline-formula> for plateaus (<xref ref-type="disp-formula" rid="pcbi.1003778.e224">Eq. 17</xref>) and even more rapidly for deep valleys (<xref ref-type="disp-formula" rid="pcbi.1003778.e205">Eq. 15</xref>). Qualitatively, this is because spreading of the beneficial mutation gets longer when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e365" xlink:type="simple"/></inline-formula> increases. Conversely, the upper bound of this parameter range is independent of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e366" xlink:type="simple"/></inline-formula> for deep valleys (<xref ref-type="disp-formula" rid="pcbi.1003778.e205">Eq. 15</xref>), and grows only logarithmically with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e367" xlink:type="simple"/></inline-formula> for plateaus (<xref ref-type="disp-formula" rid="pcbi.1003778.e224">Eq. 17</xref>). Hence, when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e368" xlink:type="simple"/></inline-formula> is increased, the center of the interval where the actual speedup is close to the optimal value shifts towards higher migration rates. This effect, which can be observed in <xref ref-type="fig" rid="pcbi-1003778-g003">Fig. 3A</xref>, is studied more precisely in <xref ref-type="fig" rid="pcbi-1003778-g003">Fig. 3B:</xref> at fixed migration rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e369" xlink:type="simple"/></inline-formula>, the crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e370" xlink:type="simple"/></inline-formula> of a metapopulation exhibits a minimum at an intermediate value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e371" xlink:type="simple"/></inline-formula>. Indeed, the crossing time of the metapopulation first decreases when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e372" xlink:type="simple"/></inline-formula> is increased because the minimum crossing time then decreases. But beyond a certain value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e373" xlink:type="simple"/></inline-formula>, the migration rate that yields the highest speedup becomes larger than the fixed migration rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e374" xlink:type="simple"/></inline-formula>, so <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e375" xlink:type="simple"/></inline-formula> increases when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e376" xlink:type="simple"/></inline-formula> is increased further.</p>
<p>Next, we study the dependence on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e377" xlink:type="simple"/></inline-formula> of the valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e378" xlink:type="simple"/></inline-formula> minimized over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e379" xlink:type="simple"/></inline-formula> for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e380" xlink:type="simple"/></inline-formula>, again for a metapopulation with fixed total size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e381" xlink:type="simple"/></inline-formula>. For values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e382" xlink:type="simple"/></inline-formula> small enough for the interval in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> to be broad, we expect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e383" xlink:type="simple"/></inline-formula> to be close to the optimal scenario value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e384" xlink:type="simple"/></inline-formula>. But, as discussed above, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e385" xlink:type="simple"/></inline-formula> increases, this interval will become smaller and then vanish. In such a regime, our analytical results are no longer sufficient to predict the dependence of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e386" xlink:type="simple"/></inline-formula> on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e387" xlink:type="simple"/></inline-formula>, but our simulations can provide additional insight. <xref ref-type="fig" rid="pcbi-1003778-g003">Fig. 3C</xref> shows that, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e388" xlink:type="simple"/></inline-formula> (left of the dashed line), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e389" xlink:type="simple"/></inline-formula> is close to the best-scenario value. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e390" xlink:type="simple"/></inline-formula> is increased beyond this point, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e391" xlink:type="simple"/></inline-formula> decreases slower than the best-scenario value. Indeed, the interval in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> is no longer wide enough for the best-scenario limit to be approached. Note also that when demes become small enough, verifying <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e392" xlink:type="simple"/></inline-formula> (right of the dotted line in <xref ref-type="fig" rid="pcbi-1003778-g003">Fig. 3C</xref>), mutation ‘1' becomes effectively neutral in individual demes, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e393" xlink:type="simple"/></inline-formula> tends to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e394" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>). For even higher values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e395" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e396" xlink:type="simple"/></inline-formula> is observed to saturate rather than exhibiting a unique minimum. Interestingly, this occurs for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e397" xlink:type="simple"/></inline-formula> such that the interval in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> fully vanishes (i.e. when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e398" xlink:type="simple"/></inline-formula> passes below 1, right of the solid line on <xref ref-type="fig" rid="pcbi-1003778-g003">Fig. 3C</xref>). While we do not have rigorous proof of the generic existence of this saturation, we have explored this point for other parameters, and found similar behavior (data not shown). Importantly, this indicates that there is a whole class of nearly optimal population structures.</p>
</sec><sec id="s3c">
<title>Extension to weakly beneficial intermediates</title>
<p>Our work has focused on fitness valleys (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e399" xlink:type="simple"/></inline-formula>), such that mutation ‘1' is deleterious, and on fitness plateaus (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e400" xlink:type="simple"/></inline-formula>), such that mutation ‘1' is neutral. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e401" xlink:type="simple"/></inline-formula>, mutation ‘1' is effectively neutral, as far as valley crossing is concerned, in a population with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e402" xlink:type="simple"/></inline-formula> individuals <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. (This condition holds both in the sequential fixation regime and in the tunneling regime.) This implies that our arguments and our results obtained in the case of the fitness plateau also hold for weakly beneficial intermediates. This point is illustrated in <xref ref-type="fig" rid="pcbi-1003778-g004">Fig. 4A</xref>.</p>
<fig id="pcbi-1003778-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003778.g004</object-id><label>Figure 4</label><caption>
<title>Extension to effectively neutral intermediates and to a large population connected to smaller islands.</title>
<p><bold>A.</bold> Valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e403" xlink:type="simple"/></inline-formula> of a metapopulation composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e404" xlink:type="simple"/></inline-formula> demes with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e405" xlink:type="simple"/></inline-formula>, versus migration-to-mutation rate ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e406" xlink:type="simple"/></inline-formula>, in logarithmic scale, for three values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e407" xlink:type="simple"/></inline-formula> in the effectively neutral regime. Dots are simulation results, averaged over 100 runs for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e408" xlink:type="simple"/></inline-formula>; error bars represent 95% CI. Black vertical lines represent the limits of the interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e409" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref>. Black horizontal line: plateau crossing time for an isolated deme with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e410" xlink:type="simple"/></inline-formula> for the same parameter values, averaged over 100 runs; shaded regions: 95% CI. Dashed line: corresponding theoretical prediction from Ref. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. Note that the plateau crossing time of the non-subdivided population with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e411" xlink:type="simple"/></inline-formula> is indistinguishable from that of the isolated deme here (as both are in the sequential fixation regime). Parameter values: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e412" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e413" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e414" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e415" xlink:type="simple"/></inline-formula> is varied. <bold>B.</bold> Valley crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e416" xlink:type="simple"/></inline-formula> of a large population with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e417" xlink:type="simple"/></inline-formula> connected to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e418" xlink:type="simple"/></inline-formula> smaller islands with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e419" xlink:type="simple"/></inline-formula>, versus migration-to-mutation rate ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e420" xlink:type="simple"/></inline-formula>, in logarithmic scale. Dots represent simulation results averaged over 100 runs for each value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e421" xlink:type="simple"/></inline-formula>, and error bars are 95% CI. Vertical lines represent the limits of the interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e422" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003778.e757">Eq. 49</xref>. Blue (resp. red) line: valley crossing time for an isolated population with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e423" xlink:type="simple"/></inline-formula> (resp. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e424" xlink:type="simple"/></inline-formula>) for the same parameter values, averaged over 100 runs; shaded regions: 95% CI. Dashed blue (resp. red) lines: corresponding theoretical predictions from Ref. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e425" xlink:type="simple"/></inline-formula>, the observed minimum <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e426" xlink:type="simple"/></inline-formula> satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e427" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e428" xlink:type="simple"/></inline-formula> is the average valley crossing time of an isolated island. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e429" xlink:type="simple"/></inline-formula>, the observed minimum satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e430" xlink:type="simple"/></inline-formula>. Parameter values: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e431" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e432" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e433" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e434" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e435" xlink:type="simple"/></inline-formula> is varied.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003778.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s3d">
<title>Extension to a population coupled to small island populations</title>
<p>Thus far, we focused on demes of equal size for simplicity, but demes of different sizes are relevant in practice. As a step toward more general populations structures, we now consider a population connected by migration to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e436" xlink:type="simple"/></inline-formula> smaller satellite populations of identical size, assumed to be in the sequential fixation regime. We only allow migration between the large population and each of the smaller islands, and the total migration rate is denoted by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e437" xlink:type="simple"/></inline-formula>. The small island affected by migration is chosen randomly at each migration event. It is straightforward to adapt our work to this case (see <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 4). We obtain an interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e438" xlink:type="simple"/></inline-formula> over which the crossing time for the large population is dominated by the crossing time of the champion island. This is corroborated by our simulations (see <xref ref-type="fig" rid="pcbi-1003778-g004">Fig. 4B</xref>).</p>
</sec><sec id="s3e">
<title>Realistic parameter values</title>
<p>Let us consider the example of <italic>Escherichia coli</italic>, for which the mutation probability per base pair per division is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e439" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003778-Wielgoss1">[50]</xref>. In order to gain a speedup of crossing by subdivision, we require demes to be in the sequential fixation regime. For plateaus, this condition reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e440" xlink:type="simple"/></inline-formula>. Let us consider deme sizes such that this condition is satisfied.</p>
<p>First, let us choose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e441" xlink:type="simple"/></inline-formula>, which is within the smallest range of sizes used in current evolution experiments. For instance, it is the number of bacteria transferred at each dilution step for small populations in <xref ref-type="bibr" rid="pcbi.1003778-Rozen1">[27]</xref>. For this value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e442" xlink:type="simple"/></inline-formula>, all plateaus with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e443" xlink:type="simple"/></inline-formula> are in the sequential fixation regime (from the condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e444" xlink:type="simple"/></inline-formula>). Let us also consider <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e445" xlink:type="simple"/></inline-formula>, since 96-well plates are often used in these experiments <xref ref-type="bibr" rid="pcbi.1003778-Rozen1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Kerr2">[51]</xref>. This yields a total population size of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e446" xlink:type="simple"/></inline-formula> individuals, which is in the tunneling regime for all plateaus with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e447" xlink:type="simple"/></inline-formula>. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e448" xlink:type="simple"/></inline-formula>, isolated demes are in the sequential fixation regime for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e449" xlink:type="simple"/></inline-formula>. (Subdivision cannot significantly accelerate crossing for deeper valleys since isolated demes are then in tunneling, but those valleys take longer to cross than shallow ones and are thus probably less often crossed in practice.) The ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e450" xlink:type="simple"/></inline-formula> of the bounds of the interval in <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref> satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e451" xlink:type="simple"/></inline-formula> throughout this range of valleys, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e452" xlink:type="simple"/></inline-formula> for the plateau and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e453" xlink:type="simple"/></inline-formula> for the deepest valleys in the range. Thus, actual speedups will approach the best-scenario one, and significant speedups will exist in a wide parameter window. <xref ref-type="disp-formula" rid="pcbi.1003778.e151">Eq. 8</xref> predicts that the highest speedup is obtained for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e454" xlink:type="simple"/></inline-formula>, and <xref ref-type="disp-formula" rid="pcbi.1003778.e154">Eq. 9</xref> then yields a speedup factor by subdivision of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e455" xlink:type="simple"/></inline-formula>. (Using instead the full expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e456" xlink:type="simple"/></inline-formula> obtained from <xref ref-type="disp-formula" rid="pcbi.1003778.e539">Eq. 23</xref> (see <xref ref-type="sec" rid="s4">Methods</xref>, Sec. 2) yields <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e457" xlink:type="simple"/></inline-formula>, i.e. a correction of 7%.) Moreover, for all valleys with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e458" xlink:type="simple"/></inline-formula>, the best-scenario speedup ranges from 18 to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e459" xlink:type="simple"/></inline-formula>. Thus, subdivision significantly accelerates crossing for this entire class of valleys.</p>
<p>It should be noted that the timescales obtained in this example are long compared to experimental ones. For instance, for the plateau, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e460" xlink:type="simple"/></inline-formula> corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e461" xlink:type="simple"/></inline-formula> divisions while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e462" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e463" xlink:type="simple"/></inline-formula> divisions. However, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e464" xlink:type="simple"/></inline-formula> can become smaller if the number of subpopulations <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e465" xlink:type="simple"/></inline-formula> is increased, as discussed in our previous section. Besides, we have chosen to focus on standard <italic>Escherichia coli</italic> for simplicity. Organisms with a higher mutation rate, e.g. viruses such as HIV, or mutator strains, would have much shorter timescales, but smaller subpopulations would then be required for demes to be in the sequential fixation regime.</p>
<p>Our example thus far focused on a small but realistic deme size, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e466" xlink:type="simple"/></inline-formula>. Experimentally more frequent values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e467" xlink:type="simple"/></inline-formula> are in the range <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e468" xlink:type="simple"/></inline-formula> – <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e469" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003778-Rozen1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Kerr2">[51]</xref>. Increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e470" xlink:type="simple"/></inline-formula> at fixed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e471" xlink:type="simple"/></inline-formula> decreases the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e472" xlink:type="simple"/></inline-formula> for which demes are in the sequential fixation regime. For a plateau, this condition reads <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e473" xlink:type="simple"/></inline-formula>. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e474" xlink:type="simple"/></inline-formula>, this yields <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e475" xlink:type="simple"/></inline-formula>, and for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e476" xlink:type="simple"/></inline-formula>, this yields <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e477" xlink:type="simple"/></inline-formula>. Hence, the range of plateaus (and similarly, of valleys) for which subdivision accelerates crossing becomes more restricted when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e478" xlink:type="simple"/></inline-formula> is increased. Nevertheless, if these increasingly stringent conditions on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e479" xlink:type="simple"/></inline-formula> are satisfied, significant speedups by subdivision are still expected. Indeed, <xref ref-type="disp-formula" rid="pcbi.1003778.e154">Eq. 9</xref> shows that the smallest value of the ratio <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e480" xlink:type="simple"/></inline-formula> is proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e481" xlink:type="simple"/></inline-formula>, so if one increases <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e482" xlink:type="simple"/></inline-formula> while decreasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e483" xlink:type="simple"/></inline-formula> as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e484" xlink:type="simple"/></inline-formula>, the maximal speedup by subdivision will remain unchanged.</p>
<p>In this work, we have considered the crossing of one particular valley or plateau corresponding to a specific pair of two mutations. Given the complexity and high dimensionality of actual fitness landscapes, there may be a large number of parallel valleys or plateaus, so that one of these could be crossed quite frequently even though the crossing time for a single valley or plateau remains large. Our work shows that, under specific conditions, subdivision can significantly accelerate crossing for whole classes of valleys and plateaus. Furthermore, in a generic, high-dimensional fitness landscape that contains both valleys and/or plateaus and uphill paths, subdivision can provide an additional effect: it “shields'' some demes in the metapopulation from adaptation via the uphill paths, leaving them time to explore valley-crossing paths that may be better in the longer term. While this effect is outside the scope of the present paper, it could lead to additional advantages of subdivision in evolution on rugged fitness landscapes.</p>
</sec><sec id="s3f">
<title>Conclusion</title>
<p>Our study of a generic and minimal model of population subdivision with migration demonstrates that subdividing a population into demes connected by migration can significantly accelerate the crossing of fitness plateaus and valleys, without the need for additional ingredients. We have derived quantitative conditions on the various parameters for subdivision to accelerate crossing, and for the resulting speedup to be maximal. In particular, isolated demes have to be in the sequential fixation regime for a significant speedup to occur. This condition is quite strong, but provided that it is met, significant speedups can be obtained in a wide range of migration rates, with the fastest deme driving the crossing of the whole metapopulation in the best scenario. We have derived the interval of migration rates for which this best scenario is reached. In addition, we have shown that increasing the degree of subdivision of a population enables higher speedups to be reached, but that this effect can saturate.</p>
<p>Our quantitative assessment of the conditions under which subdivision significantly speeds up valley or plateau crossing can aid in optimally designing future experiments, enabling one to choose the sizes and the number of demes, as well as the migration rates, such that subdivision can accelerate valley and plateau crossing.</p>
<p>Further directions include investigating the evolution of a metapopulation with a distribution of deme sizes on a more general rugged landscape, as well as assessing the impact of specific geographic structure. Our work could also be extended to sexual populations, where recombination plays an important role in valley or plateau crossing <xref ref-type="bibr" rid="pcbi.1003778-Weissman2">[52]</xref>. The interplay between recombination and subdivision, which respectively alleviate and exacerbate clonal interference, would be interesting to study.</p>
</sec></sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<sec id="s4a">
<title>1 Simulation methods</title>
<p>Our simulations are based on a Gillespie algorithm <xref ref-type="bibr" rid="pcbi.1003778-Gillespie1">[48]</xref>, <xref ref-type="bibr" rid="pcbi.1003778-Gillespie2">[49]</xref> that we coded in the C language. Here we will describe our algorithm for the case of a metapopulation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e485" xlink:type="simple"/></inline-formula> demes of identical size, which is the primary situation discussed in our work. In our simulations, each deme has a fixed carrying capacity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e486" xlink:type="simple"/></inline-formula>–we discuss this choice further in this section.</p>
<sec id="s4a1">
<title>1.1 Algorithm</title>
<p>A number of different events occur in our simulations, each with an independent rate:</p>
<list list-type="bullet"><list-item>
<p>Each individual divides at rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e487" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e488" xlink:type="simple"/></inline-formula> is the fitness associated with the genotype <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e489" xlink:type="simple"/></inline-formula> of the individual, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e490" xlink:type="simple"/></inline-formula> is the current total number of individuals in the deme <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e491" xlink:type="simple"/></inline-formula> to which the individual belongs. This corresponds to logistic growth.</p>
</list-item><list-item>
<p>If a dividing cell has <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e492" xlink:type="simple"/></inline-formula>, upon division, its offspring (i.e., one of the two individuals resulting from the division) mutates with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e493" xlink:type="simple"/></inline-formula>, to have genotype <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e494" xlink:type="simple"/></inline-formula> instead of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e495" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Each individual dies at rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e496" xlink:type="simple"/></inline-formula>. Hence, at steady-state, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e497" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e498" xlink:type="simple"/></inline-formula> is the average fitness of deme <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e499" xlink:type="simple"/></inline-formula>. In practice, we choose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e500" xlink:type="simple"/></inline-formula>, and fitnesses of order one, thus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e501" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Migration occurs at total rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e502" xlink:type="simple"/></inline-formula>. Two different demes are chosen at random, an individual is chosen at random from each of these two demes, and the two individuals are exchanged. There is no geographic structure in our model, i.e. exchange between any two demes is equally likely.</p>
</list-item></list>
<p>In practice, the number of individuals with each genotype in each deme is stored, as well as the corresponding division rate. This data fully describes the state of the metapopulation, and allows determination of the rates of all events. For each event in the simulation, the following steps are performed:</p>
<list list-type="bullet"><list-item>
<p>A timestep <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e503" xlink:type="simple"/></inline-formula> is drawn from an exponential distribution with rate equal to the total rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e504" xlink:type="simple"/></inline-formula> of events (i.e., the sum of all rates), and time is increased from its previous value, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e505" xlink:type="simple"/></inline-formula>, to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e506" xlink:type="simple"/></inline-formula>. In other words, the next event occurs at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e507" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>The event that occurs at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e508" xlink:type="simple"/></inline-formula> is chosen randomly, in such a way that the probability of an event with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e509" xlink:type="simple"/></inline-formula> is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e510" xlink:type="simple"/></inline-formula>: either a cell divides, or a cell dies, or a migration event occurs.</p>
</list-item><list-item>
<p>The event is performed, and the relevant data is updated. Since we store the number of individuals with each genotype in each deme, only one or two of these numbers need to be updated at each step. In addition, the division rates of the affected deme <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e511" xlink:type="simple"/></inline-formula> must be updated upon division and death because <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e512" xlink:type="simple"/></inline-formula> is modified. Note, however, that this represents only three numbers at most (one for each genotype).</p>
</list-item></list>
<p>The advantage of the Gillespie algorithm is that it is exact, and does not involve any artificial discretization of time.</p>
</sec><sec id="s4a2">
<title>1.2 Working at fixed carrying capacity</title>
<p>In our simulations, demes have a fixed carrying capacity, and the number of individuals per deme fluctuates weakly around its equilibrium value. This approach, also used in e.g. <xref ref-type="bibr" rid="pcbi.1003778-Greulich1">[23]</xref>, has the advantage of realism. Alternatively, we could impose a constant number of individuals per deme.</p>
<list list-type="roman-lower"><list-item>
<p>First, we could choose a dividing individual in the whole metapopulation with probability proportional to its fitness, and simultaneously suppress another individual, chosen at random in the same deme. However, in this case, individuals in demes of higher fitness would exhibit shorter lifespans, which is not realistic and may introduce a bias.</p>
</list-item><list-item>
<p>A second possibility would be to choose a dividing individual (according to fitness) in each of the demes, and to simultaneously suppress another individual, chosen at random, in each deme. However, in this case, unless migration events are far less frequent than these collective division-death events (i.e., these <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e513" xlink:type="simple"/></inline-formula> division-death events), the time interval between them becomes artificially discretized. This introduces biases unless the total migration rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e514" xlink:type="simple"/></inline-formula> is much smaller than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e515" xlink:type="simple"/></inline-formula>, i.e. unless <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e516" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
<p>Consequently, while imposing a constant number of individuals is a good simulation approach for a non-subdivided population (see e.g. <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>), it tends to introduce biases in the study of metapopulations. While we chose to perform simulations with fixed carrying capacities in order to avoid any of these biases, we checked that, for small enough migration rates, our results are completely consistent with simulation scheme (ii) described above. This consistency check also demonstrates that it is legitimate to compare our simulation results obtained with fixed carrying capacities to our analytical work carried out with constant population size per deme.</p>
</sec></sec><sec id="s4b">
<title>2 Crossing time of the champion deme</title>
<p>In this section, we give more details on the calculation of the average valley or plateau crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e517" xlink:type="simple"/></inline-formula> by the champion deme amongst <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e518" xlink:type="simple"/></inline-formula> independent ones. We show in the Results section that, in the best scenario, the crossing time of the whole metapopulation is determined by this time.</p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e519" xlink:type="simple"/></inline-formula> is the average shortest crossing time of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e520" xlink:type="simple"/></inline-formula> independent demes. This minimum crossing time, which we denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e521" xlink:type="simple"/></inline-formula>, is also called the smallest (or first) order statistic of the deme crossing time amongst a sample of size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e522" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003778-Bolch1">[53]</xref>.</p>
<p>Let us denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e523" xlink:type="simple"/></inline-formula> the probability density function of valley or plateau crossing time for a single deme, and let us introduce <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e524" xlink:type="simple"/></inline-formula> (it satisfies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e525" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e526" xlink:type="simple"/></inline-formula> is the cumulative distribution function of valley or plateau crossing by a single deme). The probability that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e527" xlink:type="simple"/></inline-formula> is larger than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e528" xlink:type="simple"/></inline-formula> is equal to the probability that the crossing times of each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e529" xlink:type="simple"/></inline-formula> independent demes are all larger than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e530" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e531" xlink:type="simple"/></inline-formula>. By differentiating this expression, one obtains the probability density function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e532" xlink:type="simple"/></inline-formula> of the crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e533" xlink:type="simple"/></inline-formula> by the champion deme (see e.g. <xref ref-type="bibr" rid="pcbi.1003778-Bolch1">[53]</xref>):<disp-formula id="pcbi.1003778.e534"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e534" xlink:type="simple"/><label>(21)</label></disp-formula></p>
<p>We now express <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e535" xlink:type="simple"/></inline-formula> explicitly. Since demes are assumed to be in the sequential fixation regime, valley or plateau crossing involves two successive steps. The first step, fixation of a ‘1'-mutant, occurs with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e536" xlink:type="simple"/></inline-formula>, and the second step, fixation of a ‘2'-mutant, occurs with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e537" xlink:type="simple"/></inline-formula> (see the <xref ref-type="sec" rid="s2">Results</xref> section for expressions of these rates). The total crossing time is thus a sum of two independent exponential random variables, with probability density function given by a two-parameter hypoexponential distribution <xref ref-type="bibr" rid="pcbi.1003778-Bolch1">[53]</xref>:<disp-formula id="pcbi.1003778.e538"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e538" xlink:type="simple"/><label>(22)</label></disp-formula></p>
<p>Combining <xref ref-type="disp-formula" rid="pcbi.1003778.e534">Eqs. 21</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e538">22</xref>, we obtain<disp-formula id="pcbi.1003778.e539"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e539" xlink:type="simple"/><label>(23)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e540" xlink:type="simple"/></inline-formula> given by <xref ref-type="disp-formula" rid="pcbi.1003778.e538">Eq. 22</xref>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e541" xlink:type="simple"/></inline-formula> can then be determined for any value of the parameters by computing the average value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e542" xlink:type="simple"/></inline-formula> over this distribution.</p>
<p>Since mutation ‘1' is deleterious or neutral while mutation ‘2' is beneficial, the first step of valley crossing is much longer than the second one over a broad range of parameter values. In this case, we can approximate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e543" xlink:type="simple"/></inline-formula> with a simple exponential distribution,<disp-formula id="pcbi.1003778.e544"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e544" xlink:type="simple"/><label>(24)</label></disp-formula></p>
<p><xref ref-type="disp-formula" rid="pcbi.1003778.e534">Eq. 21</xref> then yields<disp-formula id="pcbi.1003778.e545"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e545" xlink:type="simple"/><label>(25)</label></disp-formula>i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e546" xlink:type="simple"/></inline-formula> is distributed exponentially with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e547" xlink:type="simple"/></inline-formula>. In this case, we simply have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e548" xlink:type="simple"/></inline-formula>, which can be written as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e549" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e550" xlink:type="simple"/></inline-formula> is the average crossing time for an isolated deme. Hence, in this case, on which our analytical discussion focuses, the champion deme crosses the valley <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e551" xlink:type="simple"/></inline-formula> times faster on average than an isolated deme.</p>
<p>For this approximation to be valid, the second step of valley crossing must be negligible even for the champion deme, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e552" xlink:type="simple"/></inline-formula>. For very large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e553" xlink:type="simple"/></inline-formula>, the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e554" xlink:type="simple"/></inline-formula> will not be as small as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e555" xlink:type="simple"/></inline-formula>, since the second step will no longer be negligible (see <xref ref-type="bibr" rid="pcbi.1003778-Weissman2">[52]</xref> for a discussion of similar issues). The crossover to this regime can be determined by computing the average of the distribution in <xref ref-type="disp-formula" rid="pcbi.1003778.e539">Eq. 23</xref> and comparing it to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e556" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4c">
<title>3 Number of migration events for extinction or spreading in a metapopulation</title>
<p>In our Results section, we have derived an interval of the ratio of migration rate to mutation rate over which subdivision most reduces valley or plateau crossing time (see <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref>). The upper bound involves <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e557" xlink:type="simple"/></inline-formula>, the average number of migration events required for the ‘1'-mutants to be wiped out by migration, starting from a state where one deme has fixed genotype ‘1', while all other demes have genotype ‘0'. Similarly, the lower bound involves <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e558" xlink:type="simple"/></inline-formula>, the average number of migration events required for the ‘2'-mutants to spread by migration to the whole metapopulation, starting from a state where one deme has fixed genotype ‘2', while all other demes have genotype ‘0'. In our Results section, we have provided intuitive derivations of the simple expressions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e559" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e560" xlink:type="simple"/></inline-formula>, valid for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e561" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e562" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e563" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e564" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003778.e205">Eq. 15</xref>). However, it is important to derive more general expressions, especially since subdivision generically most accelerates valley crossing in the intermediate regime where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e565" xlink:type="simple"/></inline-formula> (see <xref ref-type="sec" rid="s2">Results</xref>, <xref ref-type="disp-formula" rid="pcbi.1003778.e151">Eq. 8</xref>).</p>
<p>Here, we derive general analytical expressions for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e566" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e567" xlink:type="simple"/></inline-formula>, both for fitness plateaus and for fitness valleys. These more general expressions are those used for numerical calculations of the bounds in our examples. Throughout this section, we consider a metapopulation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e568" xlink:type="simple"/></inline-formula> demes composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e569" xlink:type="simple"/></inline-formula> individuals each, and we assume that individual demes are in the sequential fixation regime (see <xref ref-type="sec" rid="s2">Results</xref>).</p>
<sec id="s4c1">
<title>3.1 A finite Markov chain</title>
<p>In order to determine <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e570" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e571" xlink:type="simple"/></inline-formula>, we study the evolution of the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e572" xlink:type="simple"/></inline-formula> of demes that have fixed the mutant genotype (‘1' for the calculation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e573" xlink:type="simple"/></inline-formula>; ‘2' for that of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e574" xlink:type="simple"/></inline-formula>), while other demes have genotype ‘0'. Given that the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e575" xlink:type="simple"/></inline-formula> just before a migration step fully determines the probabilities of the outcomes of this migration step, and given that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e576" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e577" xlink:type="simple"/></inline-formula> are absorbing states, the number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e578" xlink:type="simple"/></inline-formula> evolves according to a finite Markov chain, each step being a migration event. We next express the transition matrix of this Markov chain.</p>
<p>The only migration events that can affect <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e579" xlink:type="simple"/></inline-formula> are those that exchange individuals from two demes with different genotypes. Let us call these migration events “relevant''. The probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e580" xlink:type="simple"/></inline-formula> of a migration event being relevant corresponds to the probability that this migration affects one of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e581" xlink:type="simple"/></inline-formula> mutant populations and one of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e582" xlink:type="simple"/></inline-formula> ‘0' populations: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e583" xlink:type="simple"/></inline-formula>. We only focus on the final outcome of a migration event, after fixation or extinction of each of the two migrants' lineages has occurred. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e584" xlink:type="simple"/></inline-formula> denote the probability that the mutant migrant fixes in the ‘0' deme, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e585" xlink:type="simple"/></inline-formula> the probability that the ‘0' migrant fixes in the mutant deme. As a result of one such relevant migration event:</p>
<list list-type="bullet"><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e586" xlink:type="simple"/></inline-formula> increases by one with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e587" xlink:type="simple"/></inline-formula>, if the migrant mutant fixes in the ‘0' deme while ‘0' migrant does not fix in the mutant deme.</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e588" xlink:type="simple"/></inline-formula> decreases by one with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e589" xlink:type="simple"/></inline-formula>, in the opposite case.</p>
</list-item><list-item>
<p>Otherwise, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e590" xlink:type="simple"/></inline-formula> does not change. This happens either if both migrants fix (with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e591" xlink:type="simple"/></inline-formula>) or if no migrant fixes (with probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e592" xlink:type="simple"/></inline-formula>).</p>
</list-item></list>
<p>These probabilities, multiplied by the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e593" xlink:type="simple"/></inline-formula> that a migration event is relevant, yield the transition matrix of our finite Markov chain, which is tri-diagonal (or continuant) since each migration step can either leave <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e594" xlink:type="simple"/></inline-formula> constant, or increase or decrease it by one:<disp-formula id="pcbi.1003778.e595"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e595" xlink:type="simple"/><label>(26)</label></disp-formula></p>
<p><disp-formula id="pcbi.1003778.e596"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e596" xlink:type="simple"/><label>(27)</label></disp-formula></p>
<p><disp-formula id="pcbi.1003778.e597"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e597" xlink:type="simple"/><label>(28)</label></disp-formula>for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e598" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e599" xlink:type="simple"/></inline-formula>. We have denoted by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e600" xlink:type="simple"/></inline-formula> the probability that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e601" xlink:type="simple"/></inline-formula> varies from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e602" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e603" xlink:type="simple"/></inline-formula> as the final outcome of one migration event.</p>
<p>Here, we do not account for independent mutations arising and fixing in other demes during the process of spreading (or extinction) of the mutant's lineage in the metapopulation. Indeed, our aim is to compare the timescales of migration and mutation processes, so we treat them separately. Note that, in practice, this hypothesis is reasonable if mutations that fix are sufficiently rarer than migration events. We also consider that the time between two successive migration events is large enough for fixation to occur in the demes affected by migration before the next migration event occurs, which is true in the low-migration rate regime that we study in our work (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e604" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e605" xlink:type="simple"/></inline-formula> is the migration rate per individual, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e606" xlink:type="simple"/></inline-formula> is the death and division rate per individual).</p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e607" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e608" xlink:type="simple"/></inline-formula> can be directly expressed as the average number of steps of the Markov chain necessary to go from the initial state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e609" xlink:type="simple"/></inline-formula> to absorption in a particular absorbing state, either <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e610" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e611" xlink:type="simple"/></inline-formula>. Let us present general expressions of these average numbers of steps, before using them to obtain explicit expressions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e612" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e613" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4c2">
<title>3.2 Some results regarding finite Markov chains with tri-diagonal probability matrices</title>
<p>We are interested in the average number of steps <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e614" xlink:type="simple"/></inline-formula> until the system reaches each of the absorbing states <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e615" xlink:type="simple"/></inline-formula>, starting from the state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e616" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003778.e617"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e617" xlink:type="simple"/><label>(29)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e618" xlink:type="simple"/></inline-formula> is the average number of steps that the system spends in the state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e619" xlink:type="simple"/></inline-formula> before absorption, given that it starts in the state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e620" xlink:type="simple"/></inline-formula> and finally absorbs in state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e621" xlink:type="simple"/></inline-formula>. It can be expressed as <xref ref-type="bibr" rid="pcbi.1003778-Ewens1">[25]</xref><disp-formula id="pcbi.1003778.e622"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e622" xlink:type="simple"/><label>(30)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e623" xlink:type="simple"/></inline-formula> is the average number of steps the system spends in state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e624" xlink:type="simple"/></inline-formula> before absorption in either of the two absorbing states, given that it started in state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e625" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e626" xlink:type="simple"/></inline-formula> is the probability that the system finally absorbs in state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e627" xlink:type="simple"/></inline-formula> if it starts in state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e628" xlink:type="simple"/></inline-formula>.</p>
<p>Using the explicit expressions given in <xref ref-type="bibr" rid="pcbi.1003778-Ewens1">[25]</xref> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e629" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e630" xlink:type="simple"/></inline-formula> in the case of a tri-diagonal probability matrix, we obtain:<disp-formula id="pcbi.1003778.e631"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e631" xlink:type="simple"/><label>(31)</label></disp-formula></p>
<p><disp-formula id="pcbi.1003778.e632"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e632" xlink:type="simple"/><label>(32)</label></disp-formula>where we have introduced</p>
<p><disp-formula id="pcbi.1003778.e633"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e633" xlink:type="simple"/><label>(33)</label></disp-formula></p>
</sec><sec id="s4c3">
<title>3.3 Explicit expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e634" xlink:type="simple"/></inline-formula></title>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e635" xlink:type="simple"/></inline-formula>, in fact, corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e636" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e637" xlink:type="simple"/></inline-formula> is the probability that a ‘1'-mutant fixes in a deme of ‘0' individuals (i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e638" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e639" xlink:type="simple"/></inline-formula> is the probability that a ‘0'-individual fixes in a deme of ‘1'-mutants (i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e640" xlink:type="simple"/></inline-formula>). Hence, it can be expressed explicitly from <xref ref-type="disp-formula" rid="pcbi.1003778.e631">Eqs. 31</xref>, <xref ref-type="disp-formula" rid="pcbi.1003778.e595">26</xref>, and <xref ref-type="disp-formula" rid="pcbi.1003778.e596">27</xref>. Since the expressions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e641" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e642" xlink:type="simple"/></inline-formula> depend whether mutation ‘1' is neutral or deleterious, we obtain different expressions for the fitness plateau and for the fitness valley.</p>
<p><bold>Fitness plateau.</bold> For a fitness plateau (i.e. a neutral intermediate ‘1'), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e643" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e644" xlink:type="simple"/></inline-formula> is the number of individuals per deme. Hence,<disp-formula id="pcbi.1003778.e645"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e645" xlink:type="simple"/><label>(34)</label></disp-formula>which implies that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e646" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e647" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003778.e633">Eq. 33</xref>). Thus, <xref ref-type="disp-formula" rid="pcbi.1003778.e631">Eq. 31</xref> yields<disp-formula id="pcbi.1003778.e648"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e648" xlink:type="simple"/><label>(35)</label></disp-formula>where the last expression holds for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e649" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e650" xlink:type="simple"/></inline-formula>.</p>
<p><bold>Fitness valley.</bold> <xref ref-type="disp-formula" rid="pcbi.1003778.e633">Eqs. 33</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e595">26</xref>, <xref ref-type="disp-formula" rid="pcbi.1003778.e596">27</xref> yield <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e651" xlink:type="simple"/></inline-formula>, with<disp-formula id="pcbi.1003778.e652"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e652" xlink:type="simple"/><label>(36)</label></disp-formula>and <xref ref-type="disp-formula" rid="pcbi.1003778.e631">Eq. 31</xref> gives:</p>
<p><disp-formula id="pcbi.1003778.e653"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e653" xlink:type="simple"/><label>(37)</label></disp-formula>In these expressions, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e654" xlink:type="simple"/></inline-formula> is the probability of fixation of a deleterious ‘1'-mutant, with fitness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e655" xlink:type="simple"/></inline-formula>, in a deme where all other individuals have genotype ‘0' and fitness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e656" xlink:type="simple"/></inline-formula>. It can be obtained from <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>, as well as the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e657" xlink:type="simple"/></inline-formula> of the opposite process.</p>
</sec><sec id="s4c4">
<title>3.4 Explicit expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e658" xlink:type="simple"/></inline-formula></title>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e659" xlink:type="simple"/></inline-formula> corresponds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e660" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e661" xlink:type="simple"/></inline-formula> is the probability that a ‘2'-mutant (with fitness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e662" xlink:type="simple"/></inline-formula>) fixes in a deme of ‘0' individuals (with fitness 1), and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e663" xlink:type="simple"/></inline-formula> is the probability that a ‘0'-individual fixes in a deme of ‘2'-mutants. Hence, it can be expressed explicitly from <xref ref-type="disp-formula" rid="pcbi.1003778.e632">Eqs. 32</xref>, <xref ref-type="disp-formula" rid="pcbi.1003778.e595">26</xref>, and <xref ref-type="disp-formula" rid="pcbi.1003778.e596">27</xref>, using <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref> to express the fixation probabilities. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e664" xlink:type="simple"/></inline-formula>, there is no difference between the valley and the plateau, since genotype ‘1' is not involved.</p>
<p>As above, <xref ref-type="disp-formula" rid="pcbi.1003778.e595">Eqs. 26</xref>, <xref ref-type="disp-formula" rid="pcbi.1003778.e596">27</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e633">33</xref> yield <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e665" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e666" xlink:type="simple"/></inline-formula> defined in <xref ref-type="disp-formula" rid="pcbi.1003778.e652">Eq. 36</xref>. Thus, <xref ref-type="disp-formula" rid="pcbi.1003778.e632">Eq. 32</xref> gives<disp-formula id="pcbi.1003778.e667"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e667" xlink:type="simple"/><label>(38)</label></disp-formula></p>
</sec><sec id="s4c5">
<title>3.5 Simplified expressions for deep valleys and for plateaus</title>
<p>In our Results section, we have shown that the benefit of subdivision is highest when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e668" xlink:type="simple"/></inline-formula> is situated between a lower bound,<disp-formula id="pcbi.1003778.e669"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e669" xlink:type="simple"/><label>(39)</label></disp-formula>and an upper bound,<disp-formula id="pcbi.1003778.e670"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e670" xlink:type="simple"/><label>(40)</label></disp-formula>(see <xref ref-type="disp-formula" rid="pcbi.1003778.e196">Eq. 14</xref>), where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e671" xlink:type="simple"/></inline-formula> denotes the probability of fixation of a single mutant with genotype ‘2' in a background of ‘1'-mutants. Here we present simplified expressions for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e672" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e673" xlink:type="simple"/></inline-formula>, and hence of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e674" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e675" xlink:type="simple"/></inline-formula>, in particular parameter regimes.</p>
<p>Throughout this section, we focus on the regime where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e676" xlink:type="simple"/></inline-formula> but <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e677" xlink:type="simple"/></inline-formula>, such that mutation ‘2' is substantially, but not overwhelmingly, beneficial <xref ref-type="bibr" rid="pcbi.1003778-Weissman1">[28]</xref>. We then have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e678" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e679" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>). To leading (i.e. zeroth) order in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e680" xlink:type="simple"/></inline-formula>, we obtain from <xref ref-type="disp-formula" rid="pcbi.1003778.e667">Eq. 38</xref> that<disp-formula id="pcbi.1003778.e681"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e681" xlink:type="simple"/><label>(41)</label></disp-formula>where the last expression holds for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e682" xlink:type="simple"/></inline-formula>. This expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e683" xlink:type="simple"/></inline-formula> is identical to <xref ref-type="disp-formula" rid="pcbi.1003778.e191">Eq. 13</xref>, which was demonstrated more intuitively in the Results section by directly assuming <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e684" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e685" xlink:type="simple"/></inline-formula>.</p>
<p>We now consider the case of a plateau (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e686" xlink:type="simple"/></inline-formula>) and the case of a valley such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e687" xlink:type="simple"/></inline-formula> but <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e688" xlink:type="simple"/></inline-formula>. We demonstrate that the latter case is consistent with the simplified derivations in our Results section.</p>
<p><bold>Fitness plateau.</bold> For a fitness plateau, combining <xref ref-type="disp-formula" rid="pcbi.1003778.e648">Eqs. 35</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e670">40</xref>, the upper bound <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e689" xlink:type="simple"/></inline-formula> reads<disp-formula id="pcbi.1003778.e690"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e690" xlink:type="simple"/><label>(42)</label></disp-formula>where we have used <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e691" xlink:type="simple"/></inline-formula>, since mutation ‘1' is neutral, and assumed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e692" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e693" xlink:type="simple"/></inline-formula>.</p>
<p>Additionally, <xref ref-type="disp-formula" rid="pcbi.1003778.e681">Eqs. 41</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e669">39</xref> can be combined to write the lower bound <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e694" xlink:type="simple"/></inline-formula> as<disp-formula id="pcbi.1003778.e695"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e695" xlink:type="simple"/><label>(43)</label></disp-formula>again to lowest order in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e696" xlink:type="simple"/></inline-formula>. Here, we have used <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e697" xlink:type="simple"/></inline-formula>, since in the case of the plateau, mutation ‘1' is neutral. This expression too holds for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e698" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e699" xlink:type="simple"/></inline-formula>.</p>
<p>Combining <xref ref-type="disp-formula" rid="pcbi.1003778.e690">Eqs. 42</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e695">43</xref> yields <xref ref-type="disp-formula" rid="pcbi.1003778.e224">Eq. 17</xref>.</p>
<p><bold>Fitness valley.</bold> Next we focus on valleys such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e700" xlink:type="simple"/></inline-formula> but <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e701" xlink:type="simple"/></inline-formula>. (Note that, in the opposite limit <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e702" xlink:type="simple"/></inline-formula>, mutation ‘1' is effectively neutral, and the above discussion regarding the fitness plateau applies.) Then, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e703" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>). To lowest (i.e. zeroth) order in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e704" xlink:type="simple"/></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1003778.e653">Eq. 37</xref> becomes<disp-formula id="pcbi.1003778.e705"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e705" xlink:type="simple"/><label>(44)</label></disp-formula>where we have used the approximation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e706" xlink:type="simple"/></inline-formula>, which holds for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e707" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e708" xlink:type="simple"/></inline-formula>. This expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e709" xlink:type="simple"/></inline-formula> coincides with <xref ref-type="disp-formula" rid="pcbi.1003778.e173">Eq. 11</xref>, which is obtained in the Results section through a more intuitive argument that directly assumes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e710" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e711" xlink:type="simple"/></inline-formula>. Hence, from <xref ref-type="disp-formula" rid="pcbi.1003778.e670">Eq. 40</xref>, the upper bound <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e712" xlink:type="simple"/></inline-formula> is<disp-formula id="pcbi.1003778.e713"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e713" xlink:type="simple"/><label>(45)</label></disp-formula>where we used the conditions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e714" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e715" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e716" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e717" xlink:type="simple"/></inline-formula> to simplify the expression of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e718" xlink:type="simple"/></inline-formula>.</p>
<p>Meanwhile, from <xref ref-type="disp-formula" rid="pcbi.1003778.e669">Eq. 39</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e681">41</xref>, the lower bound <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e719" xlink:type="simple"/></inline-formula> takes the form<disp-formula id="pcbi.1003778.e720"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e720" xlink:type="simple"/><label>(46)</label></disp-formula>where, again, we used the conditions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e721" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e722" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e723" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e724" xlink:type="simple"/></inline-formula> to simplify the expressions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e725" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e726" xlink:type="simple"/></inline-formula>.</p>
<p>Combining <xref ref-type="disp-formula" rid="pcbi.1003778.e720">Eqs. 46</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e713">45</xref> yields <xref ref-type="disp-formula" rid="pcbi.1003778.e205">Eq. 15</xref>.</p>
</sec></sec><sec id="s4d">
<title>4 A population connected by migration to smaller population islands</title>
<p>Let us consider a population of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e727" xlink:type="simple"/></inline-formula> individuals connected by migration to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e728" xlink:type="simple"/></inline-formula> smaller population islands with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e729" xlink:type="simple"/></inline-formula> individuals each. These islands of identical size are assumed to be in the sequential fixation regime. For the sake of simplicity, we consider that migration only occurs between the large population and the islands: a migration step is a random exchange of two individuals between the large population and one of the islands (chosen at random at each migration event), and the total migration rate is denoted by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e730" xlink:type="simple"/></inline-formula>. Here, we focus on the valley or plateau crossing time of the large population. We demonstrate that the evolution of a large population can be driven by that of satellite islands.</p>
<p>In the optimal case, the crossing time of the large population is determined by that of the champion island, i.e., that which crosses the fitness valley or plateau fastest. We now determine the conditions under which this optimum is achieved, focusing on migration rates much smaller than division/death rates, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e731" xlink:type="simple"/></inline-formula>, such that fixation or extinction of a mutant lineage in either the large population or an island is not significantly perturbed by migration. Again, migration should be rare enough for islands to remain effectively shielded from migration events while they have fixed the intermediate mutation, until the final beneficial mutation arises. Second, migration should also be frequent enough for the spreading time of the final beneficial mutation from the champion island to the large population to be negligible with respect to the crossing time of the champion island. These two criteria again provide upper and lower bounds on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e732" xlink:type="simple"/></inline-formula>.</p>
<p>The average time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e733" xlink:type="simple"/></inline-formula> (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e734" xlink:type="simple"/></inline-formula> from <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>) required for an island of ‘1'-mutants to fix the beneficial mutation ‘2' must be smaller than the average time, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e735" xlink:type="simple"/></inline-formula>, for an island of ‘1'-mutants to be wiped out by migration from the large population, which still exhibits genotype ‘0'. The rate of migration events between the island of ‘1'-mutants and the large population is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e736" xlink:type="simple"/></inline-formula>. Hence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e737" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e738" xlink:type="simple"/></inline-formula> is the probability of fixation of the lineage of a single migrant with genotype ‘0' in an island where all other individuals are ‘1'-mutants: for valleys, it is given by <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>, while for plateaus, it is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e739" xlink:type="simple"/></inline-formula>. The first condition, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e740" xlink:type="simple"/></inline-formula>, thus yields<disp-formula id="pcbi.1003778.e741"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e741" xlink:type="simple"/><label>(47)</label></disp-formula></p>
<p>The second condition is that the average spreading time, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e742" xlink:type="simple"/></inline-formula>, for the final beneficial mutation to fix in a large population after it has fixed in the champion island, must be smaller than the average valley or plateau crossing time, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e743" xlink:type="simple"/></inline-formula>, of the champion island. Similar to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e744" xlink:type="simple"/></inline-formula> previously, we obtain <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e745" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e746" xlink:type="simple"/></inline-formula> is the probability of fixation of a migrant with genotype ‘2' in the large population, which is assumed to exhibit genotype ‘0' before migration (see <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>). <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e747" xlink:type="simple"/></inline-formula> is the average of the minimum crossing time among <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e748" xlink:type="simple"/></inline-formula> independent islands. We again focus, for simplicity, on the limit where the first step of valley or plateau crossing, which occurs at rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e749" xlink:type="simple"/></inline-formula>, is much longer than the second. Then, we simply have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e750" xlink:type="simple"/></inline-formula> (see <xref ref-type="sec" rid="s2">Results</xref>). In this expression, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e751" xlink:type="simple"/></inline-formula> (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e752" xlink:type="simple"/></inline-formula> obtained from <xref ref-type="disp-formula" rid="pcbi.1003778.e065">Eq. 1</xref>) is the average crossing time for an isolated island. Hence, the champion island crosses the valley <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e753" xlink:type="simple"/></inline-formula> times faster on average than a single isolated island. The second condition, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e754" xlink:type="simple"/></inline-formula>, finally yields<disp-formula id="pcbi.1003778.e755"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e755" xlink:type="simple"/><label>(48)</label></disp-formula></p>
<p>Together, <xref ref-type="disp-formula" rid="pcbi.1003778.e741">Eqs. 47</xref> and <xref ref-type="disp-formula" rid="pcbi.1003778.e755">48</xref> yield the interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e756" xlink:type="simple"/></inline-formula> over which we expect subdivision to maximally accelerate crossing:<disp-formula id="pcbi.1003778.e757"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003778.e757" xlink:type="simple"/><label>(49)</label></disp-formula></p>
<p>In this range, we expect the valley or plateau crossing time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e758" xlink:type="simple"/></inline-formula> of the large population to be dominated by the crossing time of the champion island, so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003778.e759" xlink:type="simple"/></inline-formula>. This prediction is confirmed by our simulations (see <xref ref-type="fig" rid="pcbi-1003778-g004">Fig. 4B</xref>).</p>
</sec></sec></body>
<back>
<ack>
<p>We thank Ned S. Wingreen for stimulating discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003778-Dawid1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dawid</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kiviet</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Kogenaru</surname><given-names>M</given-names></name>, <name name-style="western"><surname>de Vos</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Tans</surname><given-names>SJ</given-names></name> (<year>2010</year>) <article-title>Multiple peaks and reciprocal sign epistasis in an empirically determined genotype-phenotype landscape</article-title>. <source>Chaos</source> <volume>20</volume>: <fpage>026105</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Draghi1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Draghi</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Plotkin</surname><given-names>JB</given-names></name> (<year>2013</year>) <article-title>Selection biases the prevalence and type of epistasis along adaptive trajectories</article-title>. <source>Evolution</source> <volume>67</volume>: <fpage>3120</fpage>–<lpage>3131</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Franke1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Franke</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Klözer</surname><given-names>A</given-names></name>, <name name-style="western"><surname>de Visser</surname><given-names>JAGM</given-names></name>, <name name-style="western"><surname>Krug</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Evolutionary accessibility of mutational pathways</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1002134</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Szendro1"><label>4</label>
<mixed-citation publication-type="other" xlink:type="simple">Szendro IG, Schenk MF, Franke J, Krug J, de Visser JAGM (2013) Quantitative analyses of empirical fitness landscapes. J Stat Mech Theor Exp: P01005.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Whitlock1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whitlock</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Phillips</surname><given-names>PC</given-names></name>, <name name-style="western"><surname>Moore</surname><given-names>FBG</given-names></name>, <name name-style="western"><surname>Tonsor</surname><given-names>SJ</given-names></name> (<year>1995</year>) <article-title>Multiple fitness peaks and epistasis</article-title>. <source>Annual Review of Ecology and Systematics</source> <volume>26</volume>: <fpage>601</fpage>–<lpage>629</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Schrag1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schrag</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Perrot</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Levin</surname><given-names>BR</given-names></name> (<year>1997</year>) <article-title>Adaptation to the fitness cost of antibiotic resistance in <italic>E. coli</italic></article-title>. <source>Proc R Soc Lond B</source> <volume>264</volume>: <fpage>1287</fpage>–<lpage>1291</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Beerenwinkel1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>, <name name-style="western"><surname>B</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Elena</surname><given-names>SF</given-names></name>, <name name-style="western"><surname>Lenski</surname><given-names>RE</given-names></name> (<year>2007</year>) <article-title>Analysis of epistatic interactions and fitness landscapes using a new geometric approach</article-title>. <source>BMC Evolutionary Biology</source> <volume>7</volume>: <fpage>60</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Trindade1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trindade</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sousa</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Xavier</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Dionisio</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Ferreira</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Positive epistasis drives the acquisition of multidrug resistance</article-title>. <source>PLoS Genetics</source> <volume>5</volume>: <fpage>e1000578</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Andersson1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andersson</surname><given-names>DI</given-names></name>, <name name-style="western"><surname>Hughes</surname><given-names>D</given-names></name> (<year>2010</year>) <article-title>Antibiotic resistance and its cost: is it possible to reverse resistance?</article-title> <source>Nat Rev Microbiol</source> <volume>8</volume>: <fpage>260</fpage>–<lpage>271</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Bloom1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bloom</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Gong</surname><given-names>LI</given-names></name>, <name name-style="western"><surname>Baltimore</surname><given-names>D</given-names></name> (<year>2010</year>) <article-title>Permissive secondary mutations enable the evolution of influenza oseltamivir resistance</article-title>. <source>Science</source> <volume>328</volume>: <fpage>1272</fpage>–<lpage>1275</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Kryazhimskiy1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kryazhimskiy</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dushoff</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bazykin</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Plotkin</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Prevalence of epistasis in the evolution of influenza A surface proteins</article-title>. <source>PLoS Genetics</source> <volume>7</volume>: <fpage>e1001301</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Breen1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Breen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kemena</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Vlasov</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Notredame</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kondrashov</surname><given-names>F</given-names></name> (<year>2012</year>) <article-title>Epistasis as the primary factor in molecular evolution</article-title>. <source>Nature</source> <volume>490</volume>: <fpage>535</fpage>–<lpage>538</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Gong1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gong</surname><given-names>LI</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Bloom</surname><given-names>JD</given-names></name> (<year>2013</year>) <article-title>Stability-mediated epistasis constrains the evolution of an influenza protein</article-title>. <source>eLife</source> <volume>2</volume>: <fpage>e00631</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Covert1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Covert</surname><given-names>AW</given-names></name>, <name name-style="western"><surname>Lenski</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>Wilke</surname><given-names>CO</given-names></name>, <name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name> (<year>2013</year>) <article-title>Experiments on the role of deleterious mutations as stepping stones in adaptive evolution</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>110</volume>: <fpage>E3171</fpage>–<lpage>E3178</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-stman1"><label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Østman B, Adami C (2014) Predicting Evolution and Visualizing High-Dimensional Fitness Landscapes. In: Richter H, Engelbrecht A, editors, Recent Advances in the Theory and Application of Fitness Landscapes, Springer, volume 6 of <italic>Emergence, Complexity and Computation</italic>. pp. 509–526.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Korona1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Korona</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Nakatsu</surname><given-names>CH</given-names></name>, <name name-style="western"><surname>Forney</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Lenski</surname><given-names>RE</given-names></name> (<year>1994</year>) <article-title>Evidence for multiple adaptive peaks from populations of bacteria evolving in a structured habitat</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>91</volume>: <fpage>9037</fpage>–<lpage>9041</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Hallatschek1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hallatschek</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Hersen</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ramanathan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>DR</given-names></name> (<year>2007</year>) <article-title>Genetic drift at expanding frontiers promotes gene segregation</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>104</volume>: <fpage>19926</fpage>–<lpage>19930</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Waclaw1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Waclaw</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Allen</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Evans</surname><given-names>MR</given-names></name> (<year>2010</year>) <article-title>Dynamical phase transition in a model for evolution with migration</article-title>. <source>Phys Rev Lett</source> <volume>105</volume>: <fpage>268101</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Martens1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martens</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hallatschek</surname><given-names>O</given-names></name> (<year>2011</year>) <article-title>Interfering waves of adaptation promote spatial mixing</article-title>. <source>Genetics</source> <volume>189</volume>: <fpage>1045</fpage>–<lpage>1060</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Martens2"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martens</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Kostadinov</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Maley</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Hallatschek</surname><given-names>O</given-names></name> (<year>2011</year>) <article-title>Spatial structure increases the waiting time for cancer</article-title>. <source>New J Phys</source> <volume>189</volume>: <fpage>115014</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Otwinowski1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otwinowski</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Boettcher</surname><given-names>S</given-names></name> (<year>2011</year>) <article-title>Accumulation of beneficial mutations in one dimension</article-title>. <source>Phys Rev E</source> <volume>84</volume>: <fpage>011925</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Zhang1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Lambert</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Liao</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Robin</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Acceleration of emergence of bacterial antibiotic resistance in connected microenvironments</article-title>. <source>Science</source> <volume>333</volume>: <fpage>1764</fpage>–<lpage>1767</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Greulich1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greulich</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Waclaw</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Allen</surname><given-names>RJ</given-names></name> (<year>2012</year>) <article-title>Mutational pathway determines whether drug gradients accelerate evolution of drug-resistant cells</article-title>. <source>Phys Rev Lett</source> <volume>109</volume>: <fpage>088101</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Hermsen1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hermsen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Deris</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name> (<year>2012</year>) <article-title>On the rapidity of antibiotic resistance evolution facilitated by a concentration gradient</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>109</volume>: <fpage>10775</fpage>–<lpage>10780</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Ewens1"><label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Ewens WJ (1979) Mathematical Population Genetics. Springer-Verlag.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Weinreich1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weinreich</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Chao</surname><given-names>L</given-names></name> (<year>2005</year>) <article-title>Rapid evolutionary escape in large populations from local peaks on the Wrightian fitness landscape</article-title>. <source>Evolution</source> <volume>59</volume>: <fpage>1175</fpage>–<lpage>1182</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Rozen1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rozen</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Habets</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Handel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>de Visser</surname><given-names>JAGM</given-names></name> (<year>2008</year>) <article-title>Heterogeneous adaptive trajectories of small populations on complex fitness landscapes</article-title>. <source>PLoS ONE</source> <volume>3</volume>: <fpage>e1715</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Weissman1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weissman</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Desai</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Fisher</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Feldman</surname><given-names>MW</given-names></name> (<year>2009</year>) <article-title>The rate at which asexual populations cross fitness valleys</article-title>. <source>Theor Pop Biol</source> <volume>75</volume>: <fpage>286</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Wright1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>S</given-names></name> (<year>1931</year>) <article-title>Evolution in Mendelian populations</article-title>. <source>Genetics</source> <volume>16</volume>: <fpage>97</fpage>–<lpage>159</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Wright2"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>S</given-names></name> (<year>1932</year>) <article-title>The roles of mutation, inbreeding, crossbreeding and selection in evolution</article-title>. <source>Proc 6th Int Congress of Genetics</source> <volume>1</volume>: <fpage>356</fpage>–<lpage>366</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Wright3"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>S</given-names></name> (<year>1940</year>) <article-title>Breeding Structure of Populations in Relation to Speciation</article-title>. <source>The American Naturalist</source> <volume>74</volume>: <fpage>232</fpage>–<lpage>248</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Wright4"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>S</given-names></name> (<year>1982</year>) <article-title>The shifting balance theory and macroevolution</article-title>. <source>Ann Rev Genet</source> <volume>16</volume>: <fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Lande1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lande</surname><given-names>R</given-names></name> (<year>1985</year>) <article-title>The fixation of chromosomal rearrangements in a subdivided population with local extinction and colonization</article-title>. <source>Heredity</source> <volume>54</volume>: <fpage>323</fpage>–<lpage>332</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Slatkin1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Slatkin</surname><given-names>M</given-names></name> (<year>1989</year>) <article-title>Population structure and evolutionary progress</article-title>. <source>Genome</source> <volume>31</volume>: <fpage>196</fpage>–<lpage>202</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Wade1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wade</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Goodnight</surname><given-names>CJ</given-names></name> (<year>1991</year>) <article-title>Wright shifting balance theory - an experimental study</article-title>. <source>Science</source> <volume>253</volume>: <fpage>1015</fpage>–<lpage>1018</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Barton1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barton</surname><given-names>NH</given-names></name>, <name name-style="western"><surname>Rouhani</surname><given-names>S</given-names></name> (<year>1993</year>) <article-title>Adaptation and the shifting balance</article-title>. <source>Genetics Research</source> <volume>61</volume>: <fpage>57</fpage>–<lpage>74</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Coyne1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Coyne</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Barton</surname><given-names>NH</given-names></name>, <name name-style="western"><surname>Turelli</surname><given-names>M</given-names></name> (<year>1997</year>) <article-title>A critique of Sewall Wright's shifting balance theory of evolution</article-title>. <source>Evolution</source> <volume>51</volume>: <fpage>643</fpage>–<lpage>671</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Gavrilets1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gavrilets</surname><given-names>S</given-names></name> (<year>1997</year>) <article-title>Evolution and speciation on holey adaptive landscapes</article-title>. <source>Trends in Ecology &amp; Evolution</source> <volume>12</volume>: <fpage>307</fpage>–<lpage>312</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Wade2"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wade</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Goodnight</surname><given-names>CJ</given-names></name> (<year>1998</year>) <article-title>Perspective: The theories of Fisher and Wright in the context of metapopulations: When nature does many small experiments</article-title>. <source>Evolution</source> <volume>52</volume>: <fpage>1537</fpage>–<lpage>1553</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Coyne2"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Coyne</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Barton</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Turelli</surname><given-names>M</given-names></name> (<year>2000</year>) <article-title>Is Wright's shifting balance process important in evolution?</article-title> <source>Evolution</source> <volume>54</volume>: <fpage>306</fpage>–<lpage>317</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Crow1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crow</surname><given-names>JF</given-names></name> (<year>2008</year>) <article-title>Mid-Century Controversies in Population Genetics</article-title>. <source>Annual Review of Genetics</source> <volume>42</volume>: <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Wade3"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wade</surname><given-names>MJ</given-names></name> (<year>2013</year>) <article-title>Phase III of Wright's shifting balance process and the variance among demes in migration rate</article-title>. <source>Evolution</source> <volume>67</volume>: <fpage>1591</fpage>–<lpage>1597</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Desai1"><label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Desai MM (2013) Statistical questions in experimental evolution. J Stat Mech Theor Exp: P01003.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Kerr1"><label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Kerr B (2013) QCB Seminar at Princeton University, and private communication.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Kryazhimskiy2"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kryazhimskiy</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Rice</surname><given-names>DP</given-names></name>, <name name-style="western"><surname>Desai</surname><given-names>MM</given-names></name> (<year>2011</year>) <article-title>Population subdivision and adaptation in asexual populations of <italic>Saccharomyces cerevisiae</italic></article-title>. <source>Evolution</source> <volume>66</volume>: <fpage>1931</fpage>–<lpage>1941</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-vanMarle1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Marle</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Gill</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Kolodka</surname><given-names>D</given-names></name>, <name name-style="western"><surname>McManus</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Grant</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Compartmentalization of the gut viral reservoir in HIV-1 infected patients</article-title>. <source>Retrovirology</source> <volume>4</volume>: <fpage>87</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Schnell1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schnell</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Price</surname><given-names>RW</given-names></name>, <name name-style="western"><surname>R</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Spudich</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Compartmentalization and clonal amplification of HIV-1 variants in the cerebrospinal fluid during primary infection</article-title>. <source>J Virol</source> <volume>84</volume>: <fpage>2395</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Gillespie1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name> (<year>1976</year>) <article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title>. <source>J Comput Phys</source> <volume>22</volume>: <fpage>403</fpage>–<lpage>434</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Gillespie2"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name> (<year>1977</year>) <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>J Phys Chem</source> <volume>81</volume>: <fpage>2340</fpage>–<lpage>2361</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Wielgoss1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wielgoss</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Barrick</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Tenaillon</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Cruveiller</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Chane-Woon-Ming</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Mutation rate dynamics in a bacterial population reflect tension between adaptation and genetic load</article-title>. <source>G3</source> <volume>1</volume>: <fpage>183</fpage>–<lpage>186</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Kerr2"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kerr</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Neuhauser</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bohannan</surname><given-names>BJM</given-names></name>, <name name-style="western"><surname>Dean</surname><given-names>AM</given-names></name> (<year>2006</year>) <article-title>Local migration promotes competitive restraint in a host-pathogen 'tragedy of the commons'</article-title>. <source>Nature</source> <volume>442</volume>: <fpage>75</fpage>–<lpage>78</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Weissman2"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weissman</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Feldman</surname><given-names>MW</given-names></name>, <name name-style="western"><surname>Fisher</surname><given-names>DS</given-names></name> (<year>2010</year>) <article-title>The rate of fitness-valley crossing in sexual populations</article-title>. <source>Genetics</source> <volume>186</volume>: <fpage>1389</fpage>–<lpage>1410</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003778-Bolch1"><label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Bolch G, Greiner S, de Meer H, Trivedi KS (2006) Queuing networks and Markov chains (2nd edition). Wiley.</mixed-citation>
</ref>
</ref-list></back>
</article>