<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-0143R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000633</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biochemistry/Structural Genomics</subject><subject>Computational Biology/Macromolecular Sequence Analysis</subject><subject>Computational Biology/Macromolecular Structure Analysis</subject><subject>Computational Biology/Protein Structure Prediction</subject><subject>Genetics and Genomics/Bioinformatics</subject><subject>Mathematics/Statistics</subject></subj-group></article-categories><title-group><article-title>Disentangling Direct from Indirect Co-Evolution of Residues in Protein Alignments</article-title><alt-title alt-title-type="running-head">Disentangling Direct from Indirect Co-Evolution</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Burger</surname><given-names>Lukas</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>van Nimwegen</surname><given-names>Erik</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1">          <addr-line>Biozentrum, University of Basel, and Swiss Institute of Bioinformatics, Basel, Switzerland</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Bourne</surname><given-names>Philip E.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University of California San Diego, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">erik.vannimwegen@unibas.ch</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: EvN. Performed the experiments: LB. Analyzed the data: LB. Wrote the paper: LB EvN.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>1</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>1</day><month>1</month><year>2010</year></pub-date><volume>6</volume><issue>1</issue><elocation-id>e1000633</elocation-id><history>
<date date-type="received"><day>11</day><month>2</month><year>2009</year></date>
<date date-type="accepted"><day>4</day><month>12</month><year>2009</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Burger, van Nimwegen</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Predicting protein structure from primary sequence is one of the ultimate challenges in computational biology. Given the large amount of available sequence data, the analysis of co-evolution, i.e., statistical dependency, between columns in multiple alignments of protein domain sequences remains one of the most promising avenues for predicting residues that are contacting in the structure. A key impediment to this approach is that strong statistical dependencies are also observed for many residue pairs that are distal in the structure. Using a comprehensive analysis of protein domains with available three-dimensional structures we show that co-evolving contacts very commonly form chains that percolate through the protein structure, inducing indirect statistical dependencies between many distal pairs of residues. We characterize the distributions of length and spatial distance traveled by these co-evolving contact chains and show that they explain a large fraction of observed statistical dependencies between structurally distal pairs. We adapt a recently developed Bayesian network model into a rigorous procedure for disentangling direct from indirect statistical dependencies, and we demonstrate that this method not only successfully accomplishes this task, but also allows contacts with weak statistical dependency to be detected. To illustrate how additional information can be incorporated into our method, we incorporate a phylogenetic correction, and we develop an informative prior that takes into account that the probability for a pair of residues to contact depends strongly on their primary-sequence distance and the amount of conservation that the corresponding columns in the multiple alignment exhibit. We show that our model including these extensions dramatically improves the accuracy of contact prediction from multiple sequence alignments.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Whenever two residues are in close contact in the structure of a protein, their interaction will often constrain which amino acid substitutions can occur without perturbing the functionality of the protein, leading to “co-evolution” of the residues. With the large amount of data currently available, deep multiple alignments can be constructed of protein sequences that likely fold into a common structure, and several methods have been proposed for predicting contacting residues from statistical dependencies exhibited by pairs of alignment columns. Unfortunately, strong statistical dependencies are also observed between many pairs of residues that are distal in the structure. Through a comprehensive analysis of 2009 protein domains, we show that a large fraction of these distal dependencies are indirect and result from chains of contacting pairs that percolate through the protein. We present a Bayesian network model that rigorously disentangles direct from indirect dependencies and show that this greatly improves contact prediction. Additionally, we develop an informative prior that takes into account that the probability for residues to be in contact depends on their primary sequence separation, and that highly conserved residues tend to participate in a larger number of contacts. With this prior, the accuracy of the contact predictions is dramatically improved.</p>
</abstract><funding-group><funding-statement>The work in this study was funded by the University of Basel and partially by an SNF (<ext-link ext-link-type="uri" xlink:href="http://www.snf.ch" xlink:type="simple">http://www.snf.ch</ext-link>) grant (number 3100A0-118318) to EvN. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="18"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The identification of functionally and structurally important elements in DNA, RNA and proteins from their sequences has been a major focus of computational biology for several decades. A common approach is to create a multiple alignment of homologous sequences, which places ‘equivalent’ residues into the same column and as such gives a hint of the evolutionary constraints that are acting on related sequences. In particular, so-called profile hidden Markov models <xref ref-type="bibr" rid="pcbi.1000633-Eddy1">[1]</xref> of protein families and domains have been highly successful in identifying sequences that have similar function and fold into a common structure, making them among the most important tools in functional genomics, see e.g. <xref ref-type="bibr" rid="pcbi.1000633-Hunter1">[2]</xref>. These hidden Markov models typically assume that the residues occurring at a given position are probabilistically independent of the residues occurring at other positions. At the time at which these models were developed, it was entirely reasonable to ignore dependencies between residues at different positions, since the amount of available sequence data was generally insufficient to estimate joint probabilities of multiple residues. However, currently the multiple alignments of many protein families and domains include hundreds and sometimes even thousands of sequences, making it possible to systematically investigate dependencies between the residues at different positions.</p>
<p>As the functionality of biomolecules crucially depends on their three-dimensional structures, whose stabilities depend on interactions between residues that are near to each other in space, it is of course to be expected that significant dependencies between residues at different positions will exist. Indeed such dependencies are evident for RNA (eg <xref ref-type="bibr" rid="pcbi.1000633-Eddy2">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Lindgreen1">[4]</xref>) and protein sequences <xref ref-type="bibr" rid="pcbi.1000633-Yanovsky1">[5]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Fitch1">[6]</xref>. The existence of dependencies between residues at different positions is also supported by the observation of correlated mutations in which mutations at one residue tend to be compensated by a correlated mutation in a particular other residue <xref ref-type="bibr" rid="pcbi.1000633-Yanovsky1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1000633-MaisnierPatin1">[7]</xref>.</p>
<p>Recently there has been a significant amount of work in which multiple alignments of single protein families have been used in order to predict pairs of residues that are functionally linked or interact directly in the tertiary structure (see eg <xref ref-type="bibr" rid="pcbi.1000633-Wollenberg1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref> and references therein). This work has shown that pairs of residues which show statistical dependencies are generally significantly closer in the structure than randomly chosen pairs. However, it has been repeatedly noted that there exist many highly statistically-dependent residues that are distant in space (eg <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>–<xref ref-type="bibr" rid="pcbi.1000633-Pazos1">[16]</xref>). <xref ref-type="fig" rid="pcbi-1000633-g001">Figure 1</xref> illustrates these points. One of the most commonly used measures of dependency between two residues is the mutual information <xref ref-type="bibr" rid="pcbi.1000633-Lindgreen1">[4]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Tillier1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Cover1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Chiu1">[18]</xref> between the distributions of amino acids occurring in the two corresponding alignment columns. We collected a comprehensive set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e001" xlink:type="simple"/></inline-formula> multiple alignments of protein domains from the Pfam database <xref ref-type="bibr" rid="pcbi.1000633-Bateman1">[19]</xref> for which a three dimensional structure was available (see <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>) and calculated, for each pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e002" xlink:type="simple"/></inline-formula> of columns in each alignment, the statistical dependency using a measure, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e003" xlink:type="simple"/></inline-formula>, which is a finite-size corrected version of mutual information (see <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>). Since the distribution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e004" xlink:type="simple"/></inline-formula> values for an alignment depends strongly on the number of sequences in the alignment, their phylogenetic relationship, and the length of the alignment, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e005" xlink:type="simple"/></inline-formula> values cannot be directly compared across different alignments. Therefore, we calculated the mean and variance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e006" xlink:type="simple"/></inline-formula> values for each alignment and transformed the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e007" xlink:type="simple"/></inline-formula> values to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e008" xlink:type="simple"/></inline-formula>-values (number of standard deviations from the mean). Finally, for each alignment, we divided all pairs of residues into those that are contacting in the three-dimensional structure, and those that are distant in the structure, and calculated the distribution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e009" xlink:type="simple"/></inline-formula>-values for these two sets of residue pairs. As in previous work (e.g. <xref ref-type="bibr" rid="pcbi.1000633-Fodor1">[10]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Shackelford1">[20]</xref>) and as defined for CASP <xref ref-type="bibr" rid="pcbi.1000633-Izarzugaza1">[21]</xref>, two residues were considered in contact if their <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e010" xlink:type="simple"/></inline-formula> distance (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e011" xlink:type="simple"/></inline-formula> for glycines) in the structure was smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e012" xlink:type="simple"/></inline-formula>. Combining the data from all alignments, the left panel of <xref ref-type="fig" rid="pcbi-1000633-g001">Figure 1</xref> shows the fraction of all pairs of contacting residues (red) and distal residues (blue) larger than a given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e013" xlink:type="simple"/></inline-formula>-value as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e014" xlink:type="simple"/></inline-formula>. The right panel shows, as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e015" xlink:type="simple"/></inline-formula>, what fraction of all residue pairs with at least this <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e016" xlink:type="simple"/></inline-formula>-value are contacting in the structure.</p>
<fig id="pcbi-1000633-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g001</object-id><label>Figure 1</label><caption>
<title>Statistical dependencies of structurally close and distal residue pairs.</title>
<p>Left panel: Reverse-cumulative distribution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e017" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e018" xlink:type="simple"/></inline-formula>-values (horizontal axis) for structurally close (red) and distal (blue) residue pairs. Right panel: The fraction of all residue pairs that are distal in the structure as a function of their statistical dependency (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e019" xlink:type="simple"/></inline-formula>-value).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g001" xlink:type="simple"/></fig>
<p>The left panel of <xref ref-type="fig" rid="pcbi-1000633-g001">Figure 1</xref> illustrates that, indeed, a higher fraction of contacting residues shows strong statistical dependencies than distal residues. However, we also see that the difference in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e020" xlink:type="simple"/></inline-formula>-distribution of close and distal pairs is only moderate. Since there are generally many more distal pairs than close pairs, this implies that, even at high <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e021" xlink:type="simple"/></inline-formula>-values, the majority of residue-pairs are in fact distal in the structure (<xref ref-type="fig" rid="pcbi-1000633-g001">Figure 1</xref>, right panel). This result shows that simple measures of statistical dependency, such as mutual information, are poor at predicting which pairs of residues are directly contacting in the structure.</p>
<p>The main question is why so many structurally distal pairs show statistical dependencies in their amino-acid distributions that are stronger than those between directly contacting residues. First, whereas measures such as mutual information treat the sequences in the multiple alignments as statistically independent, in reality many of the sequences are phylogenetically closely related, which can cause ‘spurious’ statistical dependencies to appear between independent residue pairs which can be larger than the true statistical dependencies between contacting pairs. Several groups have investigated this confounding factor in contact prediction and several methods have been proposed for correcting these spurious phylogenetic correlations <xref ref-type="bibr" rid="pcbi.1000633-Wollenberg1">[8]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Tillier1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-GouveiaOliveira1">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>, which we will make use of below.</p>
<p>Although important, many strong statistical dependencies between distal residues remain even when spurious phylogenetic dependencies are corrected for (see below). Some of these distant dependencies have been suggested to be caused by homo-oligomeric interactions <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Weigt1">[22]</xref>. Thus, in this interpretation, some of the ‘distal’ pairs with strong statistical dependencies are in fact contacting in the homo-oligomer. Although it is not clear how many of the distal dependencies can be explained by this mechanism, it seems likely that only a relatively small number of residue pairs on the surface can be responsible for such homo-oligomeric interactions.</p>
<p>A third explanation that has been offered for the large number of distal pairs with strong statistical dependencies is that these dependencies are induced by <italic>indirect</italic> interactions that are mediated either by intermediate molecules <xref ref-type="bibr" rid="pcbi.1000633-Yeang1">[15]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Lockless1">[23]</xref> or by chains of directly interacting residue pairs that run through the protein and connect distal pairs <xref ref-type="bibr" rid="pcbi.1000633-Lockless1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1000633-Gloor1">[25]</xref>. Indeed, for a small number of example domains, the existence of such chains of thermodynamically directly coupled residues has been demonstrated <xref ref-type="bibr" rid="pcbi.1000633-Lockless1">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Sel1">[24]</xref>. However, the connection between thermodynamic coupling and covariation is still under debate as there is little evidence that thermodynamic coupling of residues is limited to covarying positions <xref ref-type="bibr" rid="pcbi.1000633-Fodor2">[26]</xref>.</p>
<p>In this paper, we comprehensively investigate to what extent statistical dependencies between distal pairs can be explained by indirect dependencies. The conceptual idea is illustrated in <xref ref-type="fig" rid="pcbi-1000633-g002">figure 2</xref>.</p>
<fig id="pcbi-1000633-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g002</object-id><label>Figure 2</label><caption>
<title>Statistical dependencies between pairs of residues reflect both direct and indirect interactions.</title>
<p>The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e022" xlink:type="simple"/></inline-formula> letters (A through E) represent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e023" xlink:type="simple"/></inline-formula> residues and their distances in the figure reflect their distances in the three-dimensional structure. We assume that the pairs A–B, B–C, and D–E are in contact and interact directly. The thickness of the edges between pairs of nodes reflect the statistical dependencies between the corresponding columns in the multiple alignment.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g002" xlink:type="simple"/></fig>
<p>In this illustration, the letters reflect different residues, their distances in the figure reflect their distances in the three dimensional structure, i.e. only the pairs A–B, B–C, and D–E interact directly, and the strength of the statistical dependencies between the different pairs are represented by the thickness of the lines connecting them. Because the pairs A–B and B–C have very high statistical dependency, a strong dependency between A and C is <italic>induced</italic>, which is larger even than the statistical dependency of the directly interacting pair D–E. Any method that considers the statistical dependencies of each pair independently would thus erroneously assign higher confidence to the interaction of A–C than that of D–E.</p>
<p>It should be noted that mutual information and variants thereof have been used extensively for the inference of interacting nucleic acid pairs (see <xref ref-type="bibr" rid="pcbi.1000633-Lindgreen1">[4]</xref> for a review) in the secondary structures of RNA sequences. In these approaches too, the significance of the statistical dependency between a pair of potentially interacting positions is typically evaluated in isolation, i.e. independent of the dependencies between all other pairs. However, in contrast to protein structures, RNA secondary structures per definition consist of <italic>disjoint pairs</italic> of directly interacting residues, i.e. those that form Watson-Crick base pairs. Thus, for RNA secondary structures the ‘percolation’ of statistical dependencies to pairs that are distal in the structure cannot occur (ignoring tertiary structure).</p>
<p>Below we show that chains of statistically dependent contacts are very common in protein structures, explaining a significant fraction of observed dependencies between structurally distal pairs, and we characterize the distribution of lengths and distance traveled by such chains. We show that a Bayesian network model which we recently developed to predict protein-protein interactions <xref ref-type="bibr" rid="pcbi.1000633-Burger1">[27]</xref> can be adapted to rigorously disentangle direct from indirect statistical dependencies between residues, and we demonstrate that such an approach much improves the prediction of pairs of residues that are in contact in the three-dimensional structure. We then investigate to what extent our Bayesian network algorithm can be further improved by incorporating a correction for the phylogenetic dependencies between sequences in the alignment <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>, and by incorporating prior information regarding possible interactions. In particular we develop an informative prior that incorporates the observations that the probability for two residues to interact depends strongly on their distance in the primary sequence, and that highly conserved positions in the multiple alignment tend to interact with a higher number of other residues. We show that incorporating these additional features into our Bayesian network model dramatically improves the accuracy of the predictions.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Distant co-evolving pairs can frequently be explained by chains of co-evolving contacts</title>
<p>As mentioned above, it has been suggested that statistical dependencies between structurally distant residue pairs can be explained by chains of contacts that are all statistically dependent. However, the existence of such ‘co-evolving chains’ of contacts has only been demonstrated for a small number of examples <xref ref-type="bibr" rid="pcbi.1000633-Lockless1">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Sel1">[24]</xref>. To examine comprehensively and systematically to what extent statistical dependencies between structurally distal residues can be explained by co-evolving chains of contacts we extracted, for each multiple alignment, all pairs of residues that showed high statistical dependency (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e024" xlink:type="simple"/></inline-formula>). We then divided these ‘co-evolving pairs’ into co-evolving contacts and co-evolving distal pairs. As illustrated in <xref ref-type="fig" rid="pcbi-1000633-g003">Figure 3</xref>, we then determined for each distal pair whether there exists a chain of contacts that each show stronger co-evolution than the distal pair, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e025" xlink:type="simple"/></inline-formula> for all contacts in the chain.</p>
<fig id="pcbi-1000633-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g003</object-id><label>Figure 3</label><caption>
<title>Illustration of a chain that explains the dependency between two distant residues <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e026" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e027" xlink:type="simple"/></inline-formula>.</title>
<p>The distance between the nodes illustrates the spatial separation and the thickness of the edges represents the strength of the dependence. Nodes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e028" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e029" xlink:type="simple"/></inline-formula> can be connected indirectly via a chain of contacts (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e030" xlink:type="simple"/></inline-formula>) through nodes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e031" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e032" xlink:type="simple"/></inline-formula> (in blue) whose edges all have higher dependency (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e033" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e034" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e035" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g003" xlink:type="simple"/></fig>
<p>However, since our <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e036" xlink:type="simple"/></inline-formula>-values are in all likelihood only a very noisy measure of the true co-evolution of pairs, we expect that frequently one or more of the contacts in the chain may have a lower <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e037" xlink:type="simple"/></inline-formula>-value, even if their true co-evolution is higher than the co-evolution of pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e038" xlink:type="simple"/></inline-formula>. We therefore also consider chains where some contacts <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e039" xlink:type="simple"/></inline-formula> have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e040" xlink:type="simple"/></inline-formula> and define the total score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e041" xlink:type="simple"/></inline-formula> of a chain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e042" xlink:type="simple"/></inline-formula> as the sum of the difference in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e043" xlink:type="simple"/></inline-formula>-value for all edges that have lower <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e044" xlink:type="simple"/></inline-formula>-value than the distal pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e045" xlink:type="simple"/></inline-formula>, i.e<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e046" xlink:type="simple"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e047" xlink:type="simple"/></inline-formula> is the Heaviside-function which is one when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e048" xlink:type="simple"/></inline-formula> and zero otherwise. For each distal co-evolving pair, we determined the chain of contacts <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e049" xlink:type="simple"/></inline-formula> that has minimal total score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e050" xlink:type="simple"/></inline-formula>. Since pairs that are very distal per definition require longer chains, and since <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e051" xlink:type="simple"/></inline-formula> generally grows with the length of the chain, we define the final score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e052" xlink:type="simple"/></inline-formula> of the best path for a given pair as the average score per contact, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e053" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e054" xlink:type="simple"/></inline-formula> is the number of contacts in the best path.</p>
<p>The left panel of <xref ref-type="fig" rid="pcbi-1000633-g004">Figure 4</xref> shows the cumulative distribution of the scores <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e055" xlink:type="simple"/></inline-formula> of the best chains (blue curve). We see that for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e056" xlink:type="simple"/></inline-formula> of the distal co-evolving pairs, there exists a chain with score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e057" xlink:type="simple"/></inline-formula>, i.e. where all contacts in the chain have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e058" xlink:type="simple"/></inline-formula>. The median score of the best contact path is a little larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e059" xlink:type="simple"/></inline-formula>, and the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e060" xlink:type="simple"/></inline-formula>th and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e061" xlink:type="simple"/></inline-formula> percentiles occur at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e062" xlink:type="simple"/></inline-formula>-values of about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e063" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e064" xlink:type="simple"/></inline-formula> respectively. Note that, as all distal co-evolving pairs have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e065" xlink:type="simple"/></inline-formula>, even at a score of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e066" xlink:type="simple"/></inline-formula> the contacts in the path have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e067" xlink:type="simple"/></inline-formula> on average, meaning that they are still among the most significantly co-evolving pairs.</p>
<fig id="pcbi-1000633-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g004</object-id><label>Figure 4</label><caption>
<title>Most distal co-evolving pairs can be explained by chains of co-evolving contacts.</title>
<p>Left panel: Cumulative distributions for the number of distal pairs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e068" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e069" xlink:type="simple"/></inline-formula>) that co-evolve (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e070" xlink:type="simple"/></inline-formula>) that can be explained by chains of co-evolving contacts as a function of the score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e071" xlink:type="simple"/></inline-formula> of the best chain (see text). The blue line shows the distribution for the true data and the red curve for the randomized data. Right panel: Ratio (fold-enrichment) of the fraction of distal co-evolving pairs that can be explained by chains versus the fraction that can be explained by chains from the randomized data. The vertical axis is shown on a logarithmic scale.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g004" xlink:type="simple"/></fig>
<p>To assess the significance of the cumulative distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e072" xlink:type="simple"/></inline-formula> we performed a randomization test by randomly permuting the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e073" xlink:type="simple"/></inline-formula>-values of all contacts of each domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e074" xlink:type="simple"/></inline-formula> times and determining the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e075" xlink:type="simple"/></inline-formula> scores of the best paths that are obtained with these permuted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e076" xlink:type="simple"/></inline-formula>-values. The red curve in the left panel of <xref ref-type="fig" rid="pcbi-1000633-g004">Figure 4</xref> shows the cumulative distribution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e077" xlink:type="simple"/></inline-formula>-scores obtained in this randomized set and it is immediately clear that the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e078" xlink:type="simple"/></inline-formula>-scores are much higher for the randomized set. The right panel of <xref ref-type="fig" rid="pcbi-1000633-g004">Figure 4</xref> shows, as a value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e079" xlink:type="simple"/></inline-formula>, the ratio between the fraction of distal pairs that can be explained by a chain with score less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e080" xlink:type="simple"/></inline-formula> for the real and the randomized data. Especially at low values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e081" xlink:type="simple"/></inline-formula> the ratios are enormous. For example, at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e082" xlink:type="simple"/></inline-formula> the ratio is about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e083" xlink:type="simple"/></inline-formula>, meaning that whereas about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e084" xlink:type="simple"/></inline-formula> of the distal pairs can be explained by chains in the real data, in the randomized data virtually no distal pairs can be explained, i.e. only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e085" xlink:type="simple"/></inline-formula>. But strong enrichment persists until much higher values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e086" xlink:type="simple"/></inline-formula>. For example, at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e087" xlink:type="simple"/></inline-formula> about two-thirds of distal pairs can be connected by a chain, whereas the percentage is less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e088" xlink:type="simple"/></inline-formula> for the randomized data.</p>
</sec><sec id="s2b">
<title>Statistics of co-evolving contact chains</title>
<p>Our results show that, across essentially all protein domains for which multiple alignments and structures are available, chains of co-evolving contacts are common and explain a large fraction of statistical dependencies observed between structurally distal pairs. To gain insights in the nature of these co-evolving contact chains in protein structures, we selected all distal pairs that are explained by contact chains with scores <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e089" xlink:type="simple"/></inline-formula> and obtained statistics on the number of steps and the spatial distance covered by these chains (<xref ref-type="fig" rid="pcbi-1000633-g005">Figure 5</xref>).</p>
<fig id="pcbi-1000633-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g005</object-id><label>Figure 5</label><caption>
<title>Statistics of co-evolving contact chains.</title>
<p>Left panel: Reverse-cumulative distribution of the spatial distances between co-evolving pairs that can be explained by chains of co-evolving contacts of score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e090" xlink:type="simple"/></inline-formula>. The vertical axis is shown on a logarithmic scale. The dotted line shows a fit to an exponential distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e091" xlink:type="simple"/></inline-formula>. Right panel: Number of steps in the shortest co-evolving contact chain as a function of the spatial distance of the co-evolving pair. The blue line shows the mean distance and the red dotted lines show mean plus and minus one standard deviation. The black dotted line shows a linear fit, the fitted slope of which corresponds to an increase in distance by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e092" xlink:type="simple"/></inline-formula>Å per additional contact in the chain.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g005" xlink:type="simple"/></fig>
<p>We see that the distance distribution of ‘explainable’ distal co-evolving pairs is roughly exponential with a length scale of about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e093" xlink:type="simple"/></inline-formula> Å. Since ‘distal pairs’ are by definition at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e094" xlink:type="simple"/></inline-formula>Å apart, this means that the typical length scale covered by co-evolving contact chains is about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e095" xlink:type="simple"/></inline-formula>Å. The right panel of <xref ref-type="fig" rid="pcbi-1000633-g005">Figure 5</xref> shows the mean number of steps in the shortest co-evolving contact chain as a function of the structural distance of the co-evolving distal pair. With increasing spatial separation, the number of edges in the chain steadily increases from on average <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e096" xlink:type="simple"/></inline-formula> steps at a separation of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e097" xlink:type="simple"/></inline-formula>Å to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e098" xlink:type="simple"/></inline-formula> steps at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e099" xlink:type="simple"/></inline-formula>Å. Interestingly, the increase in the average number of steps as a function of distance is almost perfectly linear and corresponds to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e100" xlink:type="simple"/></inline-formula>Å per step. We thus see that ‘typical’ co-evolving contact paths contain about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e101" xlink:type="simple"/></inline-formula> steps, demonstrating that statistical dependencies typically percolate along paths with multiple steps. We also note that some chains are very long, consisting of up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e102" xlink:type="simple"/></inline-formula> steps, connecting residues that are as far as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e103" xlink:type="simple"/></inline-formula>Å apart in the structure.</p>
</sec><sec id="s2c">
<title>Bayesian network model</title>
<p>The insight that many of the statistical dependencies between structurally distal pairs result from chains of co-evolving contacts has important consequences for contact prediction methods. That is, any method that aims to predict contacting residues from statistical dependencies should clearly take into account indirect dependencies that are induced by such chains.</p>
<p>In <xref ref-type="bibr" rid="pcbi.1000633-Burger1">[27]</xref> we developed a general Bayesian network model for calculating the probability of a multiple alignment of protein sequences taking into account dependencies between amino acids at all possible pairs of positions. We refer the reader to <xref ref-type="bibr" rid="pcbi.1000633-Burger1">[27]</xref> for a comprehensive explanation of the method. Briefly, our model assumes that the sequences in a multiple alignment <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e104" xlink:type="simple"/></inline-formula> (the data) are drawn from an (unknown) underlying joint probability distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e105" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e106" xlink:type="simple"/></inline-formula> the width of the alignment and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e107" xlink:type="simple"/></inline-formula> the amino acid at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e108" xlink:type="simple"/></inline-formula>. Profile hidden Markov models typically assume that the amino acids at different positions are independent so that one can write <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e109" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e110" xlink:type="simple"/></inline-formula> the probability distribution of amino acids at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e111" xlink:type="simple"/></inline-formula>. Note that, since there are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e112" xlink:type="simple"/></inline-formula> amino acids (disregarding gaps), such models will have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e113" xlink:type="simple"/></inline-formula> parameters in total. Our model of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e114" xlink:type="simple"/></inline-formula> allows general dependencies, such that the probability for an amino acid at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e115" xlink:type="simple"/></inline-formula> depends on the amino acids at other positions. Note that, if the residue at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e116" xlink:type="simple"/></inline-formula> is dependent on a residue at one single other position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e117" xlink:type="simple"/></inline-formula>, there are already <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e118" xlink:type="simple"/></inline-formula> parameters in the distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e119" xlink:type="simple"/></inline-formula>, and that models with dependencies on two other positions, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e120" xlink:type="simple"/></inline-formula>, would have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e121" xlink:type="simple"/></inline-formula> parameters for each residue. Given the current amount of sequence data, it is certainly reasonable to consider models with single dependencies, but there is hardly ever enough data to meaningfully estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e122" xlink:type="simple"/></inline-formula> parameters per position. Our model therefore only considers pairwise conditional dependencies of the form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e123" xlink:type="simple"/></inline-formula>.</p>
<p>Any model that considers only pairwise conditional dependencies factorizes the joint probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e124" xlink:type="simple"/></inline-formula> as a product <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e125" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e126" xlink:type="simple"/></inline-formula> is the single other position which the residue at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e127" xlink:type="simple"/></inline-formula> depends on (note that independence, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e128" xlink:type="simple"/></inline-formula> is contained in this general model). Our Bayesian network model is the most general model of this form. In particular, we do not attempt to estimate the conditional probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e129" xlink:type="simple"/></inline-formula> but rather treat these conditional probabilities as nuisance parameters that we integrate out in calculating the likelihood of the alignment. In addition, and importantly, we do not consider only a single ‘best’ way of choosing which other position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e130" xlink:type="simple"/></inline-formula> each position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e131" xlink:type="simple"/></inline-formula> depends on, but rather we <italic>sum</italic> over all ways in which the dependencies can be chosen. Note that if we consider each column of the alignment as a node in a graph and connect each node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e132" xlink:type="simple"/></inline-formula> to the node it depends on, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e133" xlink:type="simple"/></inline-formula>, then any consistent set of dependencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e134" xlink:type="simple"/></inline-formula>, i.e. any set of dependencies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e135" xlink:type="simple"/></inline-formula> that does not introduce cycles in the graph, corresponds to a <italic>spanning tree</italic> of this graph. Thus, the sum over all consistent ways in which we can assign dependencies is in fact the sum over the set of all possible spanning trees of our graph. As explained in <xref ref-type="bibr" rid="pcbi.1000633-Burger1">[27]</xref> and the <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref> section, all integrals over the unknown conditional probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e136" xlink:type="simple"/></inline-formula> can be performed analytically and, importantly, the sum over all spanning trees can be calculated as a matrix determinant using a generalization of Kirchhoff's theorem <xref ref-type="bibr" rid="pcbi.1000633-Meil1">[28]</xref>. It is thus feasible to do inference with this general Bayesian network for a large number of multiple alignments, including alignments that are hundreds of columns wide.</p>
</sec><sec id="s2d">
<title>Posterior probability of a pairwise interaction</title>
<p>In our model the joint probability of a multiple alignment is given as the sum over all possible spanning trees of node-dependencies, where each spanning tree is weighted according to the product of statistical dependencies across all edges in the tree (see <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>). Here the statistical dependence between any pair of positions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e137" xlink:type="simple"/></inline-formula> is given by the ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e138" xlink:type="simple"/></inline-formula> of the joint probability of the alignment columns <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e139" xlink:type="simple"/></inline-formula> and the product <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e140" xlink:type="simple"/></inline-formula> of their marginal probabilities. Since the number of edges in any spanning tree is limited, there is a natural ‘competition’ in this model between the edges to be included in the spanning tree. Therefore, spanning trees with the highest statistical weight will only use edges whose statistical dependence can <italic>not</italic> be explained by chains of other edges with higher dependency, and edges between pairs with indirect statistical dependency will thus only appear in spanning trees with relatively low statistical weight. The posterior probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e141" xlink:type="simple"/></inline-formula>, given the data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e142" xlink:type="simple"/></inline-formula>, for a pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e143" xlink:type="simple"/></inline-formula> to interact directly can thus very naturally be quantified within our model by calculating the sum of the statistical weights of all spanning trees in which the edge between the pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e144" xlink:type="simple"/></inline-formula> exists. The calculation of this posterior is illustrated in <xref ref-type="fig" rid="pcbi-1000633-g006">Figure 6</xref>.</p>
<fig id="pcbi-1000633-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g006</object-id><label>Figure 6</label><caption>
<title>Illustration of the calculation of the posterior probability.</title>
<p>For the sake of simplicity, we here show an example for an alignment with only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e145" xlink:type="simple"/></inline-formula> columns. The posterior probability for edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e146" xlink:type="simple"/></inline-formula> is the statistical weight of all spanning trees that contain this edge relative to the weight of all possible spanning trees.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g006" xlink:type="simple"/></fig>
<p>Note that in this calculation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e147" xlink:type="simple"/></inline-formula> depends on the statistical dependencies between all pairs of positions and that all possible spanning trees are included in the calculation. Roughly speaking, a high posterior <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e148" xlink:type="simple"/></inline-formula> indicates that the edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e149" xlink:type="simple"/></inline-formula> is included in most spanning trees that have high probability. In this way indirect dependencies are accounted for in a rigorous way, derived from first principles, and without any free parameters.</p>
</sec><sec id="s2e">
<title>Posterior probabilities significantly improve contact predictions</title>
<p>To compare the performance of the traditional mutual information-based measurement with the predictions of our model, we calculated mutual information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e150" xlink:type="simple"/></inline-formula>, our analogous measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e151" xlink:type="simple"/></inline-formula>, as well as the posterior probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e152" xlink:type="simple"/></inline-formula> for each pair of positions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e153" xlink:type="simple"/></inline-formula> for each domain in our set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e154" xlink:type="simple"/></inline-formula> Pfam alignments with available three dimensional structure.</p>
<p>Different domains have widely varying widths and also widely varying numbers of sequences in the alignments. With regard to the former, it is well-known that the number of pairs that are in contact in three-dimensional protein structures increases with the length of the protein sequence. To compare prediction accuracies for proteins with different lengths, the consensus, also used by the CASP assessors <xref ref-type="bibr" rid="pcbi.1000633-Izarzugaza1">[21]</xref>, has been to compare the number of predictions per residue. However, although there is a large variation across domains, we find that the number of contacts scales slightly super-linearly, with an exponent of roughly <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e155" xlink:type="simple"/></inline-formula> for all pairs of residues, and up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e156" xlink:type="simple"/></inline-formula> if we consider only pairs of residues that are distal in the primary sequence (see <xref ref-type="supplementary-material" rid="pcbi.1000633.s001">Figure S1</xref>). That is, the number of contacts per residue grows with the length of the domain, making it problematic to use predictions-per-residue as a common reference for domains of different length. We therefore decided to compare prediction accuracies as a function of the number of predictions relative to the total number of contacts in the protein. In particular, we compare predictions for different proteins at the same <italic>sensitivity</italic>, i.e. the fraction of all true contacts that are predicted.</p>
<p>As mentioned previously, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e157" xlink:type="simple"/></inline-formula> values typically increase with the number of sequences in the alignment and also depend on the phylogenetic distances of the sequences present in the alignment, such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e158" xlink:type="simple"/></inline-formula> values cannot be directly compared across different domains. Therefore, for each domain we produced three lists of predicted edges, one sorted by mutual information, one by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e159" xlink:type="simple"/></inline-formula>, and one by posterior probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e160" xlink:type="simple"/></inline-formula>. For different fractions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e161" xlink:type="simple"/></inline-formula>, we selected the top edges from each list such that the fraction of all true edges among the predictions (sensitivity) equals <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e162" xlink:type="simple"/></inline-formula>, separately for each domain. For each value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e163" xlink:type="simple"/></inline-formula> and all three measures, we then calculated the average positive predictive value, i.e. the fraction of all predicted edges that are truly in contact in the three-dimensional structure of the domain, by averaging over all domains. These results are shown in the left panel of <xref ref-type="fig" rid="pcbi-1000633-g007">Figure 7</xref>.</p>
<fig id="pcbi-1000633-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g007</object-id><label>Figure 7</label><caption>
<title>Accuracy of contact predictions for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e164" xlink:type="simple"/></inline-formula> alignments.</title>
<p>Shown are the performances of mutual information (black), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e165" xlink:type="simple"/></inline-formula> (blue), and the posterior probabilities (red). The vertical axis shows mean positive predictive value (PPV, solid line) plus and minus one standard error (dashed lines) as a function of sensitivity (horizontal axis, shown on a logarithmic scale). The left panel shows predictions for all residue pairs, the middle using only predictions for residues separated by at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e166" xlink:type="simple"/></inline-formula> positions in the primary sequence, and the right panel for pairs separated by at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e167" xlink:type="simple"/></inline-formula> positions.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g007" xlink:type="simple"/></fig>
<p>Not surprisingly, residues that are close in the primary sequence are much more likely to contact each other in the structure than distant pairs, see <xref ref-type="bibr" rid="pcbi.1000633-Shackelford1">[20]</xref> and <xref ref-type="fig" rid="pcbi-1000633-g011">figure 11</xref> below. In particular, residues that are neighbors in the primary sequence are (by the definition used) <italic>always</italic> contacts and residues at distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e168" xlink:type="simple"/></inline-formula> are contacting almost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e169" xlink:type="simple"/></inline-formula> of the time, whereas contacts between residues more distal in the primary sequence are relatively rare. Therefore, if one considers all contacts, the accuracy of the predictions is dominated by the large number of contacts between residues at primary sequence distances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e170" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e171" xlink:type="simple"/></inline-formula>, which almost always exist, and are therefore not informative regarding protein structure. Therefore, the middle panel of <xref ref-type="fig" rid="pcbi-1000633-g007">Figure 7</xref> shows the results when considering only pairs that are at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e172" xlink:type="simple"/></inline-formula> residues apart in primary sequence. In addition, following the practice established in the contact prediction literature, we also show results when considering only pairs at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e173" xlink:type="simple"/></inline-formula> residues apart in primary sequence (<xref ref-type="fig" rid="pcbi-1000633-g007">Figure 7</xref>, right panel) and at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e174" xlink:type="simple"/></inline-formula> residues apart (<xref ref-type="supplementary-material" rid="pcbi.1000633.s002">Figure S2</xref>).</p>
<p>As expected, the accuracy of predictions for mutual information and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e175" xlink:type="simple"/></inline-formula> are very similar and demonstrate that these two measures can be considered equivalent in this context (we will only refer to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e176" xlink:type="simple"/></inline-formula> from hereon). Most importantly, <xref ref-type="fig" rid="pcbi-1000633-g007">Figure 7</xref> shows that the predictions based on posterior probabilities (red curves) outperform the other methods by a large margin, i.e. with an almost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e177" xlink:type="simple"/></inline-formula> larger PPV at some sensitivities. This confirms that rigorous treatment of indirect dependencies strongly improves contact predictions. It should be noted, however, that at cut-offs where the positive predictive value is reasonably high, sensitivities are only on the order of one percent. It is thus clear that at high PPV, our method in its current form can only predict a minor fraction of all true interacting pairs, which is in accordance with results from previous studies <xref ref-type="bibr" rid="pcbi.1000633-Fodor1">[10]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>.</p>
<p>For completeness, we also considered the accuracy of prediction that would be obtained if, instead of summing over all possible spanning trees, we determine the maximum-likelihood tree and use only the links in this tree in our predictions, i.e. as done in <xref ref-type="bibr" rid="pcbi.1000633-Yeang1">[15]</xref>. As shown in <xref ref-type="supplementary-material" rid="pcbi.1000633.s003">Figure S3</xref>, although this leads to an improvement over using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e178" xlink:type="simple"/></inline-formula>, the accuracy of the posterior probability measure by far outperforms the predictions based on the maximum-likelihood tree. This nicely demonstrates the value of summing over all possible spanning trees which is employed in the calculation of the posterior for a given edge.</p>
</sec><sec id="s2f">
<title>The posterior removes indirect dependencies and predicts contacts with weaker statistical dependency</title>
<p>To demonstrate that our model successfully prevents the prediction of interactions between pairs with indirect dependency, we collected all distal pairs that showed significant statistical dependence (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e179" xlink:type="simple"/></inline-formula>) and ordered them by the score of the best co-evolving contact chain that can explain their statistical dependency, i.e. as shown in <xref ref-type="fig" rid="pcbi-1000633-g004">Figure 4</xref>. <xref ref-type="fig" rid="pcbi-1000633-g008">Figure 8</xref> shows the reverse-cumulative distributions of the posteriors that these distal pairs obtain in our model for different cut-offs on the best path score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e180" xlink:type="simple"/></inline-formula>, as well as the distribution of posteriors of all contacting pairs with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e181" xlink:type="simple"/></inline-formula>.</p>
<fig id="pcbi-1000633-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g008</object-id><label>Figure 8</label><caption>
<title>Posteriors reflect the extent to which co-evolving pairs can be explained by contact chains.</title>
<p>Shown are the reverse cumulative distributions of the posteriors of distal co-evolving pairs (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e182" xlink:type="simple"/></inline-formula>) that can be explained by contact chains of scores <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e183" xlink:type="simple"/></inline-formula> (red), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e184" xlink:type="simple"/></inline-formula> (dark blue), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e185" xlink:type="simple"/></inline-formula> (light blue), and for all distal co-evolving pairs (green). For comparison the reverse cumulative distribution of posteriors for co-evolving contacts (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e186" xlink:type="simple"/></inline-formula>) is also shown (black).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g008" xlink:type="simple"/></fig>
<p>First of all, we see that co-evolving contacts have dramatically higher posteriors than distal pairs in general, which confirms the improved accuracy of contact predictions that our method accomplishes. Moreover, we see that distal pairs that can be explained with the most strongly co-evolving contact chains, i.e. with the lowest scores <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e187" xlink:type="simple"/></inline-formula>, obtain the lowest posterior probabilities. For example, less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e188" xlink:type="simple"/></inline-formula> of the distal pairs with a chain at score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e189" xlink:type="simple"/></inline-formula> have a posterior larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e190" xlink:type="simple"/></inline-formula> and virtually no pair has a posterior as large as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e191" xlink:type="simple"/></inline-formula>. As the score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e192" xlink:type="simple"/></inline-formula> of the best chains increases, so generally do the posteriors. This confirms that the posterior as calculated by our model correctly captures the extent to which a statistical dependency is direct.</p>
<p>Instead of selecting all distal co-evolving pairs with contact chains below some score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e193" xlink:type="simple"/></inline-formula>, we also selected all co-evolving pairs with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e194" xlink:type="simple"/></inline-formula> scores larger than various cut-offs and determined the distributions of their posteriors. These distributions are shown in <xref ref-type="supplementary-material" rid="pcbi.1000633.s004">Figure S4</xref> and illustrate that distal co-evolving pairs with sufficiently large score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e195" xlink:type="simple"/></inline-formula> obtain posteriors comparable with those of co-evolving contacts. This suggests that the particular subset of distal co-evolving pairs that cannot be explained by any chain of contacts are likely true interacting residues, which may for example form contacts in the interaction surface of oligomers of the domain.</p>
<p>To further demonstrate that our Bayesian network model correctly distinguishes direct from indirect interactions, we also investigated the extent to which the posterior identifies structurally close pairs independent of the direct statistical dependency of the pair. We divided all pairs into bins according to their <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e196" xlink:type="simple"/></inline-formula> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e197" xlink:type="simple"/></inline-formula>-value and calculated, for each bin, the distribution of structural distances of all pairs, and for the subset of pairs that have posterior probability larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e198" xlink:type="simple"/></inline-formula>. <xref ref-type="fig" rid="pcbi-1000633-g009">Figure 9</xref> shows, as a function of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e199" xlink:type="simple"/></inline-formula>-value of the pairs, the median, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e200" xlink:type="simple"/></inline-formula>th, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e201" xlink:type="simple"/></inline-formula>th percentiles of the structural distance distributions of all pairs (blue) and those with posterior larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e202" xlink:type="simple"/></inline-formula> (red).</p>
<fig id="pcbi-1000633-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g009</object-id><label>Figure 9</label><caption>
<title>The posterior predicts structurally close pairs independent of their direct statistical dependence.</title>
<p>The structural distance distribution (vertical axis) is shown for all pairs (blue) and for pairs with posterior probability larger than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e203" xlink:type="simple"/></inline-formula> (red) as a function of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e204" xlink:type="simple"/></inline-formula>-value of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e205" xlink:type="simple"/></inline-formula> statistic (horizontal axis). The solid lines show the medians of the distributions and the dashed lines the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e206" xlink:type="simple"/></inline-formula>th and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e207" xlink:type="simple"/></inline-formula>th percentiles.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g009" xlink:type="simple"/></fig>
<p>At large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e208" xlink:type="simple"/></inline-formula>-values the red and blue curves are essentially identical. In this regime, we are only looking at the most strongly dependent residues in each alignment and any spanning tree of high likelihood must contain edges between these pairs of residues, i.e. almost all of these edges have high posterior probabilities. However, already at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e209" xlink:type="simple"/></inline-formula>-values as high as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e210" xlink:type="simple"/></inline-formula>, the median distance of all pairs starts to increase rapidly, from roughly <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e211" xlink:type="simple"/></inline-formula>Å to more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e212" xlink:type="simple"/></inline-formula>Å at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e213" xlink:type="simple"/></inline-formula>-value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e214" xlink:type="simple"/></inline-formula>. This illustrates again that even at very high values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e215" xlink:type="simple"/></inline-formula> a substantial fraction of pairs are distal in the structure. In contrast, the subset of residues with high posterior probability remains close over the whole range of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e216" xlink:type="simple"/></inline-formula>-values, down to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e217" xlink:type="simple"/></inline-formula>-values of almost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e218" xlink:type="simple"/></inline-formula>. In fact, strikingly, there is very little change in the distribution of structural distances for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e219" xlink:type="simple"/></inline-formula>-values from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e220" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e221" xlink:type="simple"/></inline-formula>. This is very significant because it demonstrates that, independent of the amount of direct statistical dependency between a pair of positions, a high posterior is indicative of close structural distance. Moreover, it demonstrates that our Bayesian network model can detect truly interacting pairs of residues even if they show only a small amount of statistical dependency.</p>
</sec><sec id="s2g">
<title>The Bayesian network model with phylogenetic correction significantly outperforms existing methods</title>
<p>One of the key problems in contact prediction is the large number of distal pairs with high statistical dependency. In the foregoing sections we have shown that many of these distal co-evolving pairs are indirect, induced by chains of dependencies between contacting residues, and we have shown that our Bayesian network model can rigorously disentangle direct from indirect dependencies, thereby greatly improving contact predictions. In the remaining sections we develop a number of extensions of our basic method to further improve the predictions.</p>
<p>As mentioned in the <xref ref-type="sec" rid="s1">introduction</xref>, the phylogenetic relationships of the underlying sequences is a major confounding factor when determining the statistical dependency between several residues (nicely explained in eg <xref ref-type="bibr" rid="pcbi.1000633-Tillier1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-GouveiaOliveira1">[13]</xref>) and it is a difficult task to ‘subtract’ from the apparent statistical dependency between two residues the part that is purely due to phylogeny. The best way to address this difficulty would of course be to construct a phylogenetic tree of all sequences in the multiple alignment and to explicitly model the evolution of the sequences along the tree, using an evolutionary model that takes dependencies between positions into account. Unfortunately, it appears that such a rigorous approach is computationally intractable for several reasons. First, one would either have to accurately reconstruct the phylogenetic tree, which is very challenging for large sets of sequences, or sum over all possible trees, which is computationally infeasible. The second issue is the evolutionary model. In our Bayesian network model, the conditional probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e222" xlink:type="simple"/></inline-formula> are different at every pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e223" xlink:type="simple"/></inline-formula>, introducing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e224" xlink:type="simple"/></inline-formula> parameters per pair, which are integrated over. However, for the evolutionary case analytic integration is no longer possible, which makes such models intractable. Indeed, models that treat dependencies between residues in an explicit phylogenetic setting <xref ref-type="bibr" rid="pcbi.1000633-Fares1">[12]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Yeang1">[15]</xref> consider much simpler evolutionary models in which only correlations in the overall <italic>rates</italic> of mutations at different positions are considered and not the specific identities of the mutations.</p>
<p>As an alternative to explicit phylogenetic methods, recently a number of simple <italic>ad hoc</italic> phylogenetic corrections have been proposed, which do not involve a reconstruction of the phylogenetic tree, which can be efficiently calculated, and which clearly improve contact predictions <xref ref-type="bibr" rid="pcbi.1000633-GouveiaOliveira1">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>. One of these corrections, the so-called <italic>average-product correction</italic> APC has been shown to provide the most accurate contact predictions <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>. It is based on the idea that the statistical dependency between every pair of columns is the sum of a true statistical dependency and a background dependency due to the phylogenetic relationships. In the APC it is assumed that the background dependency is a product of independent factors associated with the two positions. Since a given position will interact with only a small fraction of other positions, the background dependencies can be estimated by calculating, for each column, its average statistical dependence with all other columns. The background dependence for each pair is then subtracted to obtain a corrected statistical dependency. As described in <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>, we adapted the APC to our Bayesian model, essentially replacing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e225" xlink:type="simple"/></inline-formula> with a corrected version <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e226" xlink:type="simple"/></inline-formula> that subtracts out the background dependency. These <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e227" xlink:type="simple"/></inline-formula> values can then be used, analogously to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e228" xlink:type="simple"/></inline-formula> values, to determine corrected posterior probabilities (see <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>).</p>
<p>In <xref ref-type="fig" rid="pcbi-1000633-g010">figure 10</xref>, we show the accuracy of our predictions using the corrected posterior probabilities (in blue) and compare it with predictions based on mutual information using the average-product correction APC (in black). The latter has been recently shown to outperform other existing methods <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>. The red curves show the performance of the method without the phylogenetic correction, i.e. as was shown in <xref ref-type="fig" rid="pcbi-1000633-g007">Figure 7</xref>. It is clear that the predictions based on posterior probability combined with the phylogenetic correction significantly outperform the current best methods. For example, considering pairs at primary sequence separation at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e229" xlink:type="simple"/></inline-formula>, the sensitivities at PPV of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e230" xlink:type="simple"/></inline-formula> are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e231" xlink:type="simple"/></inline-formula> for the uncorrected posterior, about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e232" xlink:type="simple"/></inline-formula> for the APC, and about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e233" xlink:type="simple"/></inline-formula> for the corrected posterior. The clear improvement in prediction accuracy is also evident for pairs with primary sequence separation of at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e234" xlink:type="simple"/></inline-formula> amino acids (<xref ref-type="supplementary-material" rid="pcbi.1000633.s005">Figure S5</xref>).</p>
<fig id="pcbi-1000633-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g010</object-id><label>Figure 10</label><caption>
<title>Improved accuracy of contact predictions when a phylogenetic correction is included.</title>
<p>In blue, we show the performance of the phylogenetically-corrected posterior probabilities, in black the performance of the predictions based on the average-product corrected (APC) mutual information <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>, and in red the performance of the posterior probability without phylogenetic correction. Curves were calculated as in <xref ref-type="fig" rid="pcbi-1000633-g007">figure 7</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g010" xlink:type="simple"/></fig>
<p>Although <xref ref-type="fig" rid="pcbi-1000633-g010">Figure 10</xref> combines results of the predictions on protein domains of differing sizes, the fact that the true interactions are a much smaller fraction of all possible interactions for long sequences makes the prediction task significantly harder for long sequences, see e.g. <xref ref-type="bibr" rid="pcbi.1000633-Olmean1">[29]</xref>. In <xref ref-type="supplementary-material" rid="pcbi.1000633.s006">Figure S6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000633.s007">S7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000633.s008">S8</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1000633.s009">S9</xref>, we show the performance of the various methods separately for short, medium length, and long sequences. We find that, independent of the length of the sequences, our method clearly outperforms current methods.</p>
</sec><sec id="s2h">
<title>Co-evolution of residue pairs is independent of primary sequence separation</title>
<p>In protein structure prediction, where prediction of contacts at large sequence separations is particularly important <xref ref-type="bibr" rid="pcbi.1000633-Izarzugaza1">[21]</xref>, it is well-known that contact prediction accuracy generally decreases with increasing sequence separation (<xref ref-type="bibr" rid="pcbi.1000633-Shackelford1">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Izarzugaza1">[21]</xref>, also seen in <xref ref-type="fig" rid="pcbi-1000633-g010">figure 10</xref>). This is a direct consequence of the fact that the fraction of contacts decreases rapidly as a function of sequence separation (roughly as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e235" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e236" xlink:type="simple"/></inline-formula> is the primary sequence separation, see the left panel in <xref ref-type="fig" rid="pcbi-1000633-g011">figure 11</xref>), which makes the prediction problem much more difficult for contacts at large primary sequence separations. Vice versa, because contacts at large primary distances are rare, they are most informative for protein structure prediction <xref ref-type="bibr" rid="pcbi.1000633-Izarzugaza1">[21]</xref>.</p>
<fig id="pcbi-1000633-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g011</object-id><label>Figure 11</label><caption>
<title>Occurrence of contacts and co-evolution as a function of primary sequence separation.</title>
<p>Left panel: The fraction of residue pairs that are in contact in the structure as a function of primary sequence separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e237" xlink:type="simple"/></inline-formula>. The solid blue line shows the mean, the dashed blue lines the mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e238" xlink:type="simple"/></inline-formula> one standard error. The dashed black line shows the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e239" xlink:type="simple"/></inline-formula>. Right panel: The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e240" xlink:type="simple"/></inline-formula>-value distribution of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e241" xlink:type="simple"/></inline-formula> statistics for all contacting pairs at different primary sequence separations. The blue line represents the median and the red lines represent the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e242" xlink:type="simple"/></inline-formula>th, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e243" xlink:type="simple"/></inline-formula>th, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e244" xlink:type="simple"/></inline-formula>th and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e245" xlink:type="simple"/></inline-formula>th percentiles, respectively. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e246" xlink:type="simple"/></inline-formula>-value was calculated with respect to the mean and standard deviation of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e247" xlink:type="simple"/></inline-formula> distribution of all pairs (including distal ones). In both panels only sequence separations up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e248" xlink:type="simple"/></inline-formula> residues are shown as the curves become very noisy for larger sequence separations.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g011" xlink:type="simple"/></fig>
<p>The left panel of <xref ref-type="fig" rid="pcbi-1000633-g011">Figure 11</xref> shows that there are several regimes in the distribution of contact-density at different primary sequence distances. First, residues at distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e249" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e250" xlink:type="simple"/></inline-formula> are almost always contacts and thus contain very little information about protein structure. In contrast, at distances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e251" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e252" xlink:type="simple"/></inline-formula> the fraction of contacts has already dropped to roughly <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e253" xlink:type="simple"/></inline-formula>, i.e. about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e254" xlink:type="simple"/></inline-formula> bit of information per contact, and the fraction then drops quickly, reaching about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e255" xlink:type="simple"/></inline-formula> at primary sequence separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e256" xlink:type="simple"/></inline-formula>. For distances between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e257" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e258" xlink:type="simple"/></inline-formula> the fraction stays roughly constant at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e259" xlink:type="simple"/></inline-formula> and for even larger distances it drops approximately as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e260" xlink:type="simple"/></inline-formula>.</p>
<p>Clearly, the information contained in <xref ref-type="fig" rid="pcbi-1000633-g011">Figure 11</xref> regarding protein structures can be used to improve contact prediction, i.e. by assigning prior probabilities to different contacts based on their distance in primary sequence. However, before pursuing this we ask to what extent contacts at different primary sequence distances show statistical evidence of co-evolution. The almost ubiquitous contacts at primary sequence distances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e261" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e262" xlink:type="simple"/></inline-formula> are probably mainly the result of geometrical constraints, the contacts at intermediate distances are likely often part of the same secondary structure, and the very distal contacts might correspond to contacts between different secondary structure elements. Given the different nature of these contacts at different primary sequence separations, one might expect very different distributions of statistical dependencies, and this would clearly affect contact prediction.</p>
<p>To investigate this, we determined the distribution of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e263" xlink:type="simple"/></inline-formula>-values of corrected <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e264" xlink:type="simple"/></inline-formula> for all <italic>contacts</italic> at each primary sequence separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e265" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1000633-g011">Figure 11</xref>, right panel). Interestingly, the distribution of statistical dependencies is almost <italic>constant</italic> across the entire range of primary sequence distances. The only significant deviation is a slight peak at sequence separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e266" xlink:type="simple"/></inline-formula>, corresponding to residues on the same side of alpha helices (<xref ref-type="bibr" rid="pcbi.1000633-Pollock1">[30]</xref> and data not shown), which apparently have slightly increased statistical dependency compared to other contacts. However, far more important for the purpose of predicting protein structure is that, with regard to the statistical dependency between alignment columns, all contacts appear to be essentially equal, so that the evidence of statistical dependency between residues can be treated completely independently of the prior information regarding which contacts are more or less likely to exist based on general structural considerations. From a biological and evolutionary perspective this result shows that, interestingly, different ‘types’ of contacts apparently lead to similar evolutionary constraints.</p>
</sec><sec id="s2i">
<title>Influence of entropy on contact prediction</title>
<p>An important, but poorly understood issue in covariation-based contact prediction is the influence of conservation on prediction accuracy. The ‘conservation’ shown by a position in a multiple alignment can be most generally quantified by the entropy of the amino acid distribution in the column. It is well known that this column entropy can vary immensely along protein sequences, most probably due to functional and structural constraints. One would intuitively expect that a position that is contacting many other residues would generally have to satisfy more constraints and would thus be expected to show relatively low entropy.</p>
<p>To investigate this, we calculated, for each position in each domain, the column entropy and the number of contacts of the corresponding residue. As shown in the left panel of <xref ref-type="fig" rid="pcbi-1000633-g012">Figure 12</xref> there is indeed a clear negative correlation between the column entropy and the number of contacts. For very low entropies, i.e. less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e267" xlink:type="simple"/></inline-formula>, the average number of contacts is constant and approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e268" xlink:type="simple"/></inline-formula>. As the entropy increases from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e269" xlink:type="simple"/></inline-formula> to about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e270" xlink:type="simple"/></inline-formula> (which is close to the entropy of a uniform distribution of amino acids) the average number of contacts drops to almost <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e271" xlink:type="simple"/></inline-formula>. That is, very low entropy columns have on average almost twice as many contacts as high entropy columns. Since the number of residues in a sphere of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e272" xlink:type="simple"/></inline-formula>Å around the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e273" xlink:type="simple"/></inline-formula> atom of an amino acid (which is exactly our definition of a contact) is commonly used as a measure for how strongly a residue is buried in the core of the protein (e.g. <xref ref-type="bibr" rid="pcbi.1000633-Kortemme1">[31]</xref>), the left panel of <xref ref-type="fig" rid="pcbi-1000633-g012">Figure 12</xref> reiterates the well-known dependence between surface accessibility and conservation <xref ref-type="bibr" rid="pcbi.1000633-Rost1">[32]</xref>.</p>
<fig id="pcbi-1000633-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g012</object-id><label>Figure 12</label><caption>
<title>Contact-degree and co-evolution as a function of positional entropy.</title>
<p>Left panel: Average number of contacts of a residue (solid line) as a function of the entropy of its alignment column. The dashed lines denote mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e274" xlink:type="simple"/></inline-formula> one standard error. The right panel shows the Z-value distribution of both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e275" xlink:type="simple"/></inline-formula> (blue) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e276" xlink:type="simple"/></inline-formula> (red) for all contacting pairs versus the sum of entropies of the corresponding columns. The solid lines denote the medians and the dashed lines the 25th and 75th percentiles.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g012" xlink:type="simple"/></fig>
<p>It is well appreciated in the literature that the variation of entropy across positions has important effects on predictions based on statistical dependencies. For example, a comparative study of different prediction methods has shown that commonly used co-variation measures differ in their sensitivity to per-site variability and generally, each method has highest accuracy within its specific preferred range of variability <xref ref-type="bibr" rid="pcbi.1000633-Fodor1">[10]</xref>. In analogy to our analysis of statistical dependency as a function of distance in primary sequence (<xref ref-type="fig" rid="pcbi-1000633-g011">Figure 11</xref>, right panel), we investigated how the statistical dependency that different contacts exhibit depends on the column entropies of the residues. As before, we transformed the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e277" xlink:type="simple"/></inline-formula> values to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e278" xlink:type="simple"/></inline-formula>-values and determined the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e279" xlink:type="simple"/></inline-formula>-value distribution of all contacts as a function of the sum of the entropies of the corresponding columns (<xref ref-type="fig" rid="pcbi-1000633-g012">Figure 12</xref>, blue lines). We see that contacts indeed show a strong correlation between the sum of column entropies and statistical dependency. For low entropy columns the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e280" xlink:type="simple"/></inline-formula>-values are mostly negative, and they become only positive at an entropy sum of about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e281" xlink:type="simple"/></inline-formula>. It is thus clear that contact predictions that use mutual information (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e282" xlink:type="simple"/></inline-formula>) will preferentially predict contacts between residues of high entropy columns.</p>
<p>That mutual information and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e283" xlink:type="simple"/></inline-formula> is low for contacts with low entropy columns is to a certain extent unavoidable. It is a basic result of information theory <xref ref-type="bibr" rid="pcbi.1000633-Cover1">[17]</xref> that the mutual information between two variables cannot be larger than the minimum of the marginal entropies of the two variables. Intuitively, one could imagine a position that is so constrained by its function and its many contacts that only a single amino acid is viable at the position. Obviously, since this position shows no variation whatsoever it cannot display any signs of statistical dependency with any other column, even though it may contact many other residues. This is a basic limitation of using statistical dependency for contact prediction that cannot be avoided. However, it has been argued that modified versions of mutual information, such as the product or sum correction <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>, besides correcting for the phylogenetic background signal, are also able to better identify co-evolution between less variable residues. The red lines in the right panel of <xref ref-type="fig" rid="pcbi-1000633-g012">Figure 12</xref> show the mean and standard deviation of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e284" xlink:type="simple"/></inline-formula>-values of product-corrected statistical dependency <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e285" xlink:type="simple"/></inline-formula>. We see that indeed, the correlation between the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e286" xlink:type="simple"/></inline-formula>-values and the sum of column-entropies is significantly reduced when using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e287" xlink:type="simple"/></inline-formula>, and low entropy contacts no longer show negative <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e288" xlink:type="simple"/></inline-formula>-values on average.</p>
<p>Still, a clear correlation between the column-entropy sum and the statistical dependency remains even for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e289" xlink:type="simple"/></inline-formula>. On the one hand this may be the result of the inherent inability to ‘detect’ statistical dependency when columns are very conserved. On the other hand, it is also conceivable that those positions that have low entropy, and that form many contacts, may generally show weaker statistical dependency <italic>per contact</italic>. For example, it could be argued that hydrophobic residues that lie in the core of the protein and thus contact many other residues are less variable because they need to remain on the interior and therefore do not allow for changes towards non-hydrophobic residues. Such residues may not be constrained so much by their contacting residues, but rather by the necessity to stay away from the solvent-exposed protein surface, leading to relatively weak statistical dependencies with the contacting residues.</p>
</sec><sec id="s2j">
<title>Incorporation of prior information improves prediction accuracy</title>
<p>So far our Bayesian method assumes that a contact between any pair of positions is a priori equally likely. However, as seen in the previous sections, the probability for a contact to occur depends strongly on the primary sequence distance between the residues and the column-entropies of the residues. We therefore developed an ‘informative prior’ which makes the prior probability for a contact to occur depend on both of these variables. For a given pair of positions, let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e290" xlink:type="simple"/></inline-formula> be the distance in the primary-sequence of the two positions, and let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e291" xlink:type="simple"/></inline-formula> denote the sum of the column-entropies of these positions. As described in <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>, we estimated the fractions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e292" xlink:type="simple"/></inline-formula> of pairs at sequence distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e293" xlink:type="simple"/></inline-formula> and entropy-sum <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e294" xlink:type="simple"/></inline-formula> that are contacts and using these fractions constructed prior probability distributions that can be easily incorporated into our method.</p>
<p><xref ref-type="fig" rid="pcbi-1000633-g013">Figure 13</xref> shows the results of the contact predictions performed with our Bayesian network model incorporating the informative prior and using posterior probabilities (blue lines). For comparison the results using posteriors based on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e295" xlink:type="simple"/></inline-formula> (the blue lines in <xref ref-type="fig" rid="pcbi-1000633-g010">Figure 10</xref>) are shown as well (red lines). We see that, for the set of all pairs, and all pairs that are at least <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e296" xlink:type="simple"/></inline-formula> apart in primary sequence, the incorporation of the prior probability dramatically improves the predictions. For example, looking at all pairs, our method can predict roughly <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e297" xlink:type="simple"/></inline-formula> of all existing contacts at a positive predictive value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e298" xlink:type="simple"/></inline-formula>. If we restrict ourselves to non-trivial contacts, i.e. those with primary-sequence distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e299" xlink:type="simple"/></inline-formula>, we find that at a positive predictive value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e300" xlink:type="simple"/></inline-formula> our method reaches a sensitivity of roughly <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e301" xlink:type="simple"/></inline-formula>. For comparison, without the prior an approximately <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e302" xlink:type="simple"/></inline-formula> times lower sensitivity is reached at the same positive predictive value.</p>
<fig id="pcbi-1000633-g013" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g013</object-id><label>Figure 13</label><caption>
<title>Improved accuracy of contact prediction when an informative prior is included.</title>
<p>In blue, we show the performance of the posterior probabilities that take primary-sequence separation and column entropy into account. For comparison we show in red the performance of the posteriors with phylogenetic correction but uniform prior, which are the same as the blue lines in <xref ref-type="fig" rid="pcbi-1000633-g010">Figure 10</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g013" xlink:type="simple"/></fig>
<p>Somewhat surprisingly, we find that the quality of the predictions for distal pairs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e303" xlink:type="simple"/></inline-formula> is slightly reduced by the incorporation of the prior, especially at low sensitivities. We speculate that this is a result of the fact that we constructed the prior distribution assuming that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e304" xlink:type="simple"/></inline-formula> is independent of the length of the domain itself. This approximation breaks down most significantly when focusing on distal pairs because, whereas contacts at short primary distances occur in all domains, contacts at long primary distances are more common in long domains. However, it should be noted that, given that contacts at this primary-sequence distance are rare, one would most likely need to perform predictions at reasonably high sensitivity, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e305" xlink:type="simple"/></inline-formula> or more. In this regime, the performance with prior is comparable to or even a tiny bit better than without prior.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>One of the key problems in using co-evolution analysis to predict residue contacts is that so many structurally distal pairs show strong statistical dependencies <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>–<xref ref-type="bibr" rid="pcbi.1000633-Pazos1">[16]</xref>. A number of reasons have been proposed to explain this fact. One explanation is that sequences in multiple alignments are generally phylogenetically related and these phylogenetic relationships can induce strong apparent statistical dependencies between many pairs of columns. Although there is of yet no computationally tractable way for treating the phylogenetic dependencies in a rigorous manner, i.e. by explicitly modeling the evolution of the sequences including arbitrary dependencies, several procedures have been proposed that can correct at least for the main phylogenetic signal <xref ref-type="bibr" rid="pcbi.1000633-Wollenberg1">[8]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Tillier1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Yeang1">[15]</xref>. Indeed the application of such methods has been shown to very significantly improve contact predictions <xref ref-type="bibr" rid="pcbi.1000633-Tillier1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Yeang1">[15]</xref>.</p>
<p>Still, even with the current best phylogenetic corrections, strong statistical dependencies remain evident between many structurally distal pairs. One proposed explanation that has received little attention in the contact prediction literature is that statistical dependencies between distal pairs can be induced by the percolation of statistical dependencies along chains of co-evolving contacts <xref ref-type="bibr" rid="pcbi.1000633-Lockless1">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Sel1">[24]</xref>. Here we have shown that such chains of co-evolving contacts are indeed pervasive across all protein domains and that they explain many if not most of the distal co-evolving pairs. Statistical analysis shows that these chains travel on average <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e306" xlink:type="simple"/></inline-formula>Å per contact, and that the total distance covered by these chains is exponentially distributed with an average of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e307" xlink:type="simple"/></inline-formula>Å, corresponding to a chain that consists of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e308" xlink:type="simple"/></inline-formula> contacts. Note that, whereas residues up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e309" xlink:type="simple"/></inline-formula>Å apart are generally considered contacts, our results strongly suggest that the typical distance between co-evolving contacts is only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e310" xlink:type="simple"/></inline-formula>Å. Another interesting observation is that, although it is likely that contacts between residues at different distances in primary sequences are different in nature, our analysis shows that the statistical dependency shown by contacts is completely independent of their primary-sequence separation. This is an important insight because it demonstrates that co-evolutionary analysis is equally informative about close and distal contacts.</p>
<p>We have adapted our recently evolved Bayesian network model <xref ref-type="bibr" rid="pcbi.1000633-Burger1">[27]</xref> in order to assign, to any pair of positions, a posterior probability that they interact directly. This posterior probability rigorously takes into account all possible ways in which the statistical dependence between the pair can be explained in terms of chains of other co-evolving pairs. Analysis of the predictions of this model shows that it correctly detects distal pairs that can be explained by co-evolving contact chains, and that it also allows one to detect true interacting pairs that have only weak direct statistical dependency.</p>
<p>Recently Halabi et al <xref ref-type="bibr" rid="pcbi.1000633-Halabi1">[33]</xref> have shown that, by a spectral analysis of the matrix of statistical dependencies between positions, one can identify so called ‘protein sectors’: sets of positions that co-evolve significantly with each other, but that are relatively independent of the positions in other sectors. Since in <xref ref-type="bibr" rid="pcbi.1000633-Halabi1">[33]</xref> a rather simple measure of direct statistical dependency is used, we speculate that a much more accurate identification of protein sectors could be obtained by using statistical dependencies as assessed by our posterior probabilities.</p>
<p>While finishing the work in this study, a paper appeared that also aims to disentangle direct from indirect interactions <xref ref-type="bibr" rid="pcbi.1000633-Weigt1">[22]</xref>. Like our approach, <xref ref-type="bibr" rid="pcbi.1000633-Weigt1">[22]</xref> models the joint probability of sequences in the multiple alignment in terms of a set of pairwise interactions. What is appealing about the approach of <xref ref-type="bibr" rid="pcbi.1000633-Weigt1">[22]</xref> is that it is based on the more ‘physical’ assumption that an interaction energy is associated with each pairwise interaction such that a total interaction energy can be calculated for each sequence, and that the probability to observe a particular sequence is given simply by the Boltzmann distribution in terms of this total energy. However, the great disadvantage of this model is that its solution requires a heuristic approximation and is computationally very expensive to calculate. For example, in <xref ref-type="bibr" rid="pcbi.1000633-Weigt1">[22]</xref> the authors were forced to restrict themselves to only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e311" xlink:type="simple"/></inline-formula> positions in the alignment, and even then the calculations for a single alignment took several days. Therefore, an application of the approach of <xref ref-type="bibr" rid="pcbi.1000633-Weigt1">[22]</xref> on as large a scale as in this work, with thousands of multiple alignments of up to several hundred positions, is not feasible. In addition, it is not clear how the approach of <xref ref-type="bibr" rid="pcbi.1000633-Weigt1">[22]</xref> could accommodate a phylogenetic correction, which would be necessary to obtain a competitive performance with this method.</p>
<p>Although the disentangling of direct and indirect statistical dependencies strongly improves contact predictions, and incorporating a phylogenetic correction further improves the performance, the predictions are still far from perfect. In particular, at reasonably high positive predictive value the sensitivity amounts to less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e312" xlink:type="simple"/></inline-formula> of all true contacts. Although it is clear that contact predictions based only on statistical dependencies could be further improved, for example by a more rigorous treatment of the phylogenetic dependencies, we believe that it is unlikely that such improvements would dramatically enhance the performance. First of all, simple inspection of the data shows that a large number of the pairs that are contacts in the sense that they are less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e313" xlink:type="simple"/></inline-formula>Å apart, really show no sign of co-evolution at all. That is, a large fraction of ‘contacts’ may simply not interact directly, and these obviously can never be detected using statistical dependence measurements. On the other end of the scale are residues that contact so many others that they are very strongly constrained, and show almost no variability in evolution. For such highly conserved residues it is also inherently impossible to identify their interaction partners using co-evolutionary analysis.</p>
<p>We thus believe that the largest further improvements to contact prediction are to be expected from incorporating information other than statistical dependency. To illustrate that additional information can be easily incorporated into our model, we developed an informative prior that takes into account that the likelihood of a contact to exist depends on the primary-sequence distance of the residues, and that highly conserved residues tend to have a higher number of contacts. The incorporation of even this simple additional information already leads to dramatic improvements in contact prediction. Clearly more powerful priors could be developed that take into account more sophisticated structural knowledge. In addition, in our current method we integrate over all possible joint probabilities for pairs of interacting residues, effectively assuming that all possible joint probability distributions are equally likely. Here too improvements could likely be made by taking into account prior knowledge on which joint probability distributions are more or less likely for interacting pairs of amino acids. Ultimately the most satisfying approach would be to combine our approach with direct structural modeling, i.e. somewhat along the lines of the approach taken in <xref ref-type="bibr" rid="pcbi.1000633-Miller1">[34]</xref>.</p>
<p>Following the plausible intuition that, the more different kinds of information are taken into account, the greater the prediction accuracy that can be obtained, several machine learning and statistical methods have been proposed that incorporate a much larger number of different features (see <xref ref-type="bibr" rid="pcbi.1000633-Shackelford1">[20]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Miller1">[34]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Cheng1">[35]</xref> and references therein). Besides primary sequence separation and conservation, these methods include features such as domain length, relative solvent accessibility, predicted secondary structure, the amino acid composition in short windows around the positions of interest, chemical properties of the amino acids, and contact potentials. Due to varying training and test sets and varying standards of evaluation, it is very difficult to compare the performance of our method with these approaches. However, some principal differences between these methods and ours should be noted. First, all these methods rely on training sets to fit parameters, so that additional methods are required to avoid over-fitting, whereas our method is essentially without any tunable parameters and does not require any training sets. Second, some of these methods are rather <italic>ad hoc</italic> ‘black box’ methods, e.g. neutral networks <xref ref-type="bibr" rid="pcbi.1000633-Shackelford1">[20]</xref> or support vector machines <xref ref-type="bibr" rid="pcbi.1000633-Cheng1">[35]</xref>, that use partially redundant sets of features, from which it is typically hard to derive mechanistic insights. In contrast, our method is derived directly from first principles. In any case, the results that we have presented show that it is crucial to take indirect dependencies into account when incorporating co-evolution information. We have provided a rigorous method for doing so and it is clear that any contact prediction method that incorporates co-evolution information would strongly benefit from using our method for disentangling direct and indirect dependencies.</p>
<p>Whereas we have here applied our method to predict contacting residues in a single protein, it is straight forward to use the same method for predicting contacting residues between pairs of proteins that are known to interact. That is, given two set of orthologs proteins <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e314" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e315" xlink:type="simple"/></inline-formula>, for which it is known that each member of set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e316" xlink:type="simple"/></inline-formula> interacts with the corresponding member of set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e317" xlink:type="simple"/></inline-formula>, we can simply concatenate the multiple alignments of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e318" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e319" xlink:type="simple"/></inline-formula> into one longer multiple alignment, and apply our method to this longer alignment.</p>
<p>More generally, our method provides a computationally tractable extension of weight matrix models to take into account arbitrary pairwise dependencies, and there are a number of more general applications that we envisage pursuing in the future. First, our method can be generally used to ‘score’ multiple alignments in a way that includes pairwise dependencies. This could be used to discover subfamilies within large multiple alignments or to generally refine multiple alignments. Since the performance of alignment-based contact prediction methods is expected to depend strongly on the quality of the alignments, such a refinement may further improve contact prediction. Finally, another attractive application is to develop a regulatory-motif finding algorithm that takes into account arbitrary pairwise dependencies between positions.</p>
</sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Domain sequences and structures</title>
<p>Domain alignments and the mappings from domains to available structures in the PDB database were downloaded from the Pfam database <xref ref-type="bibr" rid="pcbi.1000633-Bateman1">[19]</xref>,<xref ref-type="bibr" rid="pcbi.1000633-Finn1">[36]</xref>. We only used Pfam A, which is the high-quality and manually curated part of Pfam <xref ref-type="bibr" rid="pcbi.1000633-Bateman1">[19]</xref>. For each Pfam domain with at least one known structure, we reduced the alignment to positions corresponding to match states of the corresponding Pfam hidden Markov model with no more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e320" xlink:type="simple"/></inline-formula> percent gaps. The removal of columns with many gaps is necessary as gaps can cause spurious correlations (see below) and make it difficult to compare the phylogenetic background signal between different columns. We removed from each alignment all multiple copies of identical sequences as well as sequences that had more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e321" xlink:type="simple"/></inline-formula> percent gaps with respect to the match states. Additionally, alignments containing less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e322" xlink:type="simple"/></inline-formula> sequences or less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e323" xlink:type="simple"/></inline-formula> columns were discarded. To keep computational times limited we also removed alignments with more than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e324" xlink:type="simple"/></inline-formula> columns. For each Pfam alignment, all corresponding PDB files were collected according to the iPfam annotation <xref ref-type="bibr" rid="pcbi.1000633-Finn1">[36]</xref> and distances between pairs of residues were determined as the distance between the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e325" xlink:type="simple"/></inline-formula> atoms (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e326" xlink:type="simple"/></inline-formula> for glycines). In the case of NMR models, the minimal distances of all models contained in the PDB entry were chosen. If a Pfam domain was present in multiple protein structures or in several chains of one protein structure, we chose the median distance over all chains and structures. For some alignments the corresponding structure did not cover all columns in the alignment and we discarded the small number of examples where the coverage was less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e327" xlink:type="simple"/></inline-formula>. This resulted in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e328" xlink:type="simple"/></inline-formula> domains with structurally-defined distances between residues. Finally, distance in primary sequence was defined as the distance between the match states of the alignment.</p>
</sec><sec id="s4b">
<title>Probabilistic model</title>
<p>Our Bayesian network model was described in detail in <xref ref-type="bibr" rid="pcbi.1000633-Burger1">[27]</xref>. Briefly, given a single column <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e329" xlink:type="simple"/></inline-formula> of the alignment with observed amino acid counts <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e330" xlink:type="simple"/></inline-formula>, the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e331" xlink:type="simple"/></inline-formula> of the column is given in terms of the (unknown) probability distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e332" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e333" xlink:type="simple"/></inline-formula> the probability that letter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e334" xlink:type="simple"/></inline-formula> occurs at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e335" xlink:type="simple"/></inline-formula>, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e336" xlink:type="simple"/></inline-formula>. Using a Dirichlet prior for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e337" xlink:type="simple"/></inline-formula> with parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e338" xlink:type="simple"/></inline-formula>, we obtain the marginal probability of the column <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e339" xlink:type="simple"/></inline-formula> by integrating over all possible distributions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e340" xlink:type="simple"/></inline-formula>. This integral can be performed analytically and the result can be expressed in terms of gamma functions:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e341" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e342" xlink:type="simple"/></inline-formula> is the number of sequences in the alignment. Similarly, the <italic>joint</italic> probability of the data <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e343" xlink:type="simple"/></inline-formula> in a pair of columns <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e344" xlink:type="simple"/></inline-formula> is given in terms of the number of times <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e345" xlink:type="simple"/></inline-formula> that the combination of letters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e346" xlink:type="simple"/></inline-formula> occurs at positions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e347" xlink:type="simple"/></inline-formula>, i.e.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e348" xlink:type="simple"/><label>(3)</label></disp-formula>Here, we set the parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e349" xlink:type="simple"/></inline-formula> of the Dirichlet prior for the joint probability distribution to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e350" xlink:type="simple"/></inline-formula>. As shown in <xref ref-type="bibr" rid="pcbi.1000633-Meil1">[28]</xref>, in the context of a dependence tree model, consistency requires that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e351" xlink:type="simple"/></inline-formula> equals <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e352" xlink:type="simple"/></inline-formula>.</p>
<p>The statistical dependence between columns <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e353" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e354" xlink:type="simple"/></inline-formula> is quantified by the ratio<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e355" xlink:type="simple"/><label>(4)</label></disp-formula>The connection of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e356" xlink:type="simple"/></inline-formula> to mutual information is easily established by substituting equations (2) and (3) into the logarithm of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e357" xlink:type="simple"/></inline-formula> as given by (4) and using Stirling's approximation to the logarithm of the gamma function. We then find that approximately<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e358" xlink:type="simple"/><label>(5)</label></disp-formula>for large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e359" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e360" xlink:type="simple"/></inline-formula> the mutual information between columns <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e361" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e362" xlink:type="simple"/></inline-formula>. Importantly, when determining the counts <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e363" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e364" xlink:type="simple"/></inline-formula> in order to determine <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e365" xlink:type="simple"/></inline-formula>, we discard all pairs of residues within a given sequence where either <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e366" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e367" xlink:type="simple"/></inline-formula> is a gap. Treating gaps as a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e368" xlink:type="simple"/></inline-formula> amino acid causes strong spurious correlations between residues that are close in primary sequence since gaps usually come in blocks (data not shown).</p>
<p>A <italic>dependence tree</italic> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e369" xlink:type="simple"/></inline-formula> specifies for each position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e370" xlink:type="simple"/></inline-formula> (except for the root of the tree) a parent position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e371" xlink:type="simple"/></inline-formula> which is the residue that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e372" xlink:type="simple"/></inline-formula> depends on. To keep the notation simple, we here use the symbol <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e373" xlink:type="simple"/></inline-formula> to both denote the mapping from a node to its parent node and the dependence tree itself. It can be shown <xref ref-type="bibr" rid="pcbi.1000633-Burger1">[27]</xref> that, given a dependence tree, the joint probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e374" xlink:type="simple"/></inline-formula> of the entire alignment can be written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e375" xlink:type="simple"/><label>(6)</label></disp-formula>where the first product goes over all positions and the second over all positions except for the root <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e376" xlink:type="simple"/></inline-formula>.</p>
<p>Finally, the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e377" xlink:type="simple"/></inline-formula> of the whole alignment is given by summing over all possible dependence trees <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e378" xlink:type="simple"/></inline-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e379" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e380" xlink:type="simple"/></inline-formula> is the prior probability of a particular spanning tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e381" xlink:type="simple"/></inline-formula>. The last product is in fact the product of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e382" xlink:type="simple"/></inline-formula>-values over all edges of the tree given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e383" xlink:type="simple"/></inline-formula> and is independent of the choice of the root. If the prior probability of a spanning tree can be written as a product of probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e384" xlink:type="simple"/></inline-formula> along each edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e385" xlink:type="simple"/></inline-formula> of the tree<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e386" xlink:type="simple"/><label>(8)</label></disp-formula>then equation (7) can be rewritten as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e387" xlink:type="simple"/><label>(9)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e388" xlink:type="simple"/></inline-formula>. Thus, the weight of each edge is simply multiplied by its prior probability. The largest term in the sum of equation (9) is the <italic>maximum spanning tree</italic> when a weight <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e389" xlink:type="simple"/></inline-formula> is assigned to each edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e390" xlink:type="simple"/></inline-formula> and this maximum spanning tree can be easily determined <xref ref-type="bibr" rid="pcbi.1000633-Chow1">[37]</xref>.</p>
<p>The sum over spanning trees in (9) can be calculated using a generalization of Kirchhoff's matrix-tree theorem <xref ref-type="bibr" rid="pcbi.1000633-Meil1">[28]</xref>. For this we need to calculate the Laplacian of the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e391" xlink:type="simple"/></inline-formula>, which is defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e392" xlink:type="simple"/><label>(10)</label></disp-formula>where the sum goes over all columns (or rows) of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e393" xlink:type="simple"/></inline-formula>-matrix and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e394" xlink:type="simple"/></inline-formula> is the Kronecker delta function, which is one if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e395" xlink:type="simple"/></inline-formula> and zero otherwise. We can then write the sum over all spanning trees as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e396" xlink:type="simple"/><label>(11)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e397" xlink:type="simple"/></inline-formula> is the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e398" xlink:type="simple"/></inline-formula> with one line and column removed (the determinant is independent of which line and column are removed). The summation over all spanning trees (there are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e399" xlink:type="simple"/></inline-formula> spanning trees for a full graph with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e400" xlink:type="simple"/></inline-formula> nodes) thus reduces to the calculation of a determinant, which can be done in a time proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e401" xlink:type="simple"/></inline-formula>.</p>
<p>As discussed previously <xref ref-type="bibr" rid="pcbi.1000633-Burger1">[27]</xref>, the calculation of the determinant of the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e402" xlink:type="simple"/></inline-formula> is numerically very challenging since the entries <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e403" xlink:type="simple"/></inline-formula> vary over many orders of magnitude. In order to circumvent this problem, we rescale the entries of the matrix as suggested in <xref ref-type="bibr" rid="pcbi.1000633-Cerquides1">[38]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e404" xlink:type="simple"/><label>(12)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e405" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e406" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e407" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e408" xlink:type="simple"/></inline-formula>) is the logarithm of the maximal (minimal) entry of the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e409" xlink:type="simple"/></inline-formula>. This function maps all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e410" xlink:type="simple"/></inline-formula> values into the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e411" xlink:type="simple"/></inline-formula>, preserves the relative ordering of entries and does not exaggerate relative differences in belief <xref ref-type="bibr" rid="pcbi.1000633-Cerquides1">[38]</xref>. The lower bound <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e412" xlink:type="simple"/></inline-formula> ensures that the rescaled <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e413" xlink:type="simple"/></inline-formula>-matrix remains numerically non-singular. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e414" xlink:type="simple"/></inline-formula> can be set according to the numerical precision of the machine and we set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e415" xlink:type="simple"/></inline-formula>. We then use these rescaled <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e416" xlink:type="simple"/></inline-formula>-values to calculate the posterior probabilities.</p>
</sec><sec id="s4c">
<title>Calculating posteriors</title>
<p>Using expression (7), the posterior probability of a particular edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e417" xlink:type="simple"/></inline-formula> is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e418" xlink:type="simple"/><label>(13)</label></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e419" xlink:type="simple"/><label>(14)</label></disp-formula>which is the sum of the probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e420" xlink:type="simple"/></inline-formula> for all spanning trees <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e421" xlink:type="simple"/></inline-formula> that contain the edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e422" xlink:type="simple"/></inline-formula>. This expression can be calculated by replacing the set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e423" xlink:type="simple"/></inline-formula> nodes with a set of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e424" xlink:type="simple"/></inline-formula> nodes, in which nodes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e425" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e426" xlink:type="simple"/></inline-formula> are contracted to one node, say <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e427" xlink:type="simple"/></inline-formula>, and the edge weights of this new node <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e428" xlink:type="simple"/></inline-formula> are given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e429" xlink:type="simple"/></inline-formula> for all nodes <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e430" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000633-Bollobs1">[39]</xref>. Using this construction we can write the sum over all spanning trees containing edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e431" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e432" xlink:type="simple"/><label>(15)</label></disp-formula>where the sum now goes over all spanning trees <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e433" xlink:type="simple"/></inline-formula> of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e434" xlink:type="simple"/></inline-formula> nodes. This sum over spanning trees can of course also be calculated as a determinant as described above. Roughly speaking, an edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e435" xlink:type="simple"/></inline-formula> will have high posterior if it occurs in the large majority of all spanning trees <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e436" xlink:type="simple"/></inline-formula> that have high probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e437" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4d">
<title>Phylogenetic correction</title>
<p>Due to the phylogenetic relatedness of the sequences in the alignment, there typically will be a statistical dependence between residues even in the absence of a functional linkage of these positions. Previous work <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref> showed that this dependence can be corrected for (to some extent) by assuming that, due to phylogenetic relationships, each position has a certain amount of ‘background’ statistical dependence with other columns. Since each position interacts only with a small fraction of all other positions this background dependence can be estimated by calculating the average mutual information of that position with all the remaining positions. In <xref ref-type="bibr" rid="pcbi.1000633-Dunn1">[14]</xref>, two types of corrections were proposed, a multiplicative one, named APC, and a additive one, named ASC. We here briefly review the derivation of these corrections.</p>
<p>The idea of the ASC is that the mutual information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e438" xlink:type="simple"/></inline-formula> between positions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e439" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e440" xlink:type="simple"/></inline-formula> is the sum of the true mutual information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e441" xlink:type="simple"/></inline-formula> and background mutual informations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e442" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e443" xlink:type="simple"/></inline-formula>, associated with positions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e444" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e445" xlink:type="simple"/></inline-formula>, i.e.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e446" xlink:type="simple"/><label>(16)</label></disp-formula>We define average mutual informations as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e447" xlink:type="simple"/><label>(17)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e448" xlink:type="simple"/></inline-formula> the number of columns of the alignment. Other averages like <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e449" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e450" xlink:type="simple"/></inline-formula>, and so on, are defined analogously. Note that, for notational simplicity, in these averages we have adopted the convention that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e451" xlink:type="simple"/></inline-formula>. We can then derive the equalities<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e452" xlink:type="simple"/><label>(18)</label></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e453" xlink:type="simple"/><label>(19)</label></disp-formula>If one assumes that, since true interactions are relatively rare, the averages <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e454" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e455" xlink:type="simple"/></inline-formula> are much smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e456" xlink:type="simple"/></inline-formula>, we can set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e457" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e458" xlink:type="simple"/></inline-formula> and have<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e459" xlink:type="simple"/><label>(20)</label></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e460" xlink:type="simple"/><label>(21)</label></disp-formula>Finally, under these assumptions the true mutual information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e461" xlink:type="simple"/></inline-formula> is then given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e462" xlink:type="simple"/><label>(22)</label></disp-formula>Motivated by this derivation, the ASC is defined as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e463" xlink:type="simple"/><label>(23)</label></disp-formula></p>
<p>In the product correction APC we assume that the background mutual information between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e464" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e465" xlink:type="simple"/></inline-formula> can be written as a <italic>product</italic> of contributions of the two columns, i.e.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e466" xlink:type="simple"/><label>(24)</label></disp-formula>Assuming again that the true average mutual informations are small we find<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e467" xlink:type="simple"/><label>(25)</label></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e468" xlink:type="simple"/><label>(26)</label></disp-formula>Using this the APC version of the mutual information is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e469" xlink:type="simple"/><label>(27)</label></disp-formula></p>
<p>Since the APC performs better than the ASC we focused on adapting the APC for our Bayesian model. As mentioned above, the logarithms of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e470" xlink:type="simple"/></inline-formula> values are the equivalent of mutual information in our model. Therefore, naively we would simply replace <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e471" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e472" xlink:type="simple"/></inline-formula> in equation (27) above. However, whereas the mutual information naturally has a lower bound of zero, which is reached only for independent positions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e473" xlink:type="simple"/></inline-formula> is off-set with respect to mutual information and becomes <italic>negative</italic> for independent positions. Note also that all posterior probabilities are invariant under a global shift of all the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e474" xlink:type="simple"/></inline-formula> values by a constant. Therefore, we substitute into equation (27) a shifted version of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e475" xlink:type="simple"/></inline-formula> which is guaranteed to be non-negative. For each domain we determine the minimal value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e476" xlink:type="simple"/></inline-formula> and define a shifted version of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e477" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e478" xlink:type="simple"/><label>(28)</label></disp-formula>Using these shifted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e479" xlink:type="simple"/></inline-formula>s we then define the corrected <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e480" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e481" xlink:type="simple"/><label>(29)</label></disp-formula>In our model with phylogenetic correction we simply replace each factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e482" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e483" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4e">
<title>Prior probability of spanning trees</title>
<p>Our Bayesian model easily allows for the incorporation of prior probabilities on each spanning tree via the edge probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e484" xlink:type="simple"/></inline-formula> in equation (9). Here, we use these edge probabilities to include the dependence on both the primary sequence separation of the positions in the pair (<xref ref-type="fig" rid="pcbi-1000633-g011">Figure 11</xref>), as well as the sum of the entropies of the corresponding columns (<xref ref-type="fig" rid="pcbi-1000633-g012">Figure 12</xref>). To estimate the fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e485" xlink:type="simple"/></inline-formula> of all pairs with sequence-separation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e486" xlink:type="simple"/></inline-formula> and entropy-sum <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e487" xlink:type="simple"/></inline-formula> that are contacts, we separated all pairs of columns into entropy bins of width <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e488" xlink:type="simple"/></inline-formula>, spanning the whole range of entropies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e489" xlink:type="simple"/></inline-formula> and compared the dependence on primary sequence separation within the different bins (<xref ref-type="fig" rid="pcbi-1000633-g014">Figure 14</xref>, left panel).</p>
<fig id="pcbi-1000633-g014" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000633.g014</object-id><label>Figure 14</label><caption>
<title>Estimation of prior probabilities.</title>
<p>The left panel shows the dependence between the fraction of pairs that are in contact and primary sequence separation for all pairs (in blue) as well as for pairs whose sum of entropies lies in a given entropy bin (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e490" xlink:type="simple"/></inline-formula> in red, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e491" xlink:type="simple"/></inline-formula> in green, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e492" xlink:type="simple"/></inline-formula> in black and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e493" xlink:type="simple"/></inline-formula> in magenta). For the sake of clarity, only a few selected entropy bins across the entire range are shown. The right panel shows the estimated function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e494" xlink:type="simple"/></inline-formula>, which describes how the probability of an edge to be a contact depends on the sum of entropies of the corresponding columns of the alignment (see text).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.g014" xlink:type="simple"/></fig>
<p>We see that, irrespective of the column entropy sum <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e495" xlink:type="simple"/></inline-formula>, the fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e496" xlink:type="simple"/></inline-formula> has approximately the same shape as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e497" xlink:type="simple"/></inline-formula> as the overall fraction of contacts <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e498" xlink:type="simple"/></inline-formula> which we showed in <xref ref-type="fig" rid="pcbi-1000633-g011">Figure 11</xref>. We find that for distances <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e499" xlink:type="simple"/></inline-formula> or less the fraction is virtually independent of entropy, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e500" xlink:type="simple"/></inline-formula>, while for larger distances the fractions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e501" xlink:type="simple"/></inline-formula> are roughly proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e502" xlink:type="simple"/></inline-formula>, with a proportionality constant that decreases with entropy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e503" xlink:type="simple"/></inline-formula>. That is, we assume the following general form for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e504" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e505" xlink:type="simple"/><label>(30)</label></disp-formula></p>
<p>We first estimated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e506" xlink:type="simple"/></inline-formula> directly from the observed fractions as shown in <xref ref-type="fig" rid="pcbi-1000633-g011">Figure 11</xref> for all sequence separations up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e507" xlink:type="simple"/></inline-formula>. As <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e508" xlink:type="simple"/></inline-formula> is proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e509" xlink:type="simple"/></inline-formula> for sequence separations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e510" xlink:type="simple"/></inline-formula> and becomes very noisy for large sequence separations (data not shown), we approximate the curve as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e511" xlink:type="simple"/></inline-formula> for sequence separations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e512" xlink:type="simple"/></inline-formula> (blue line in <xref ref-type="fig" rid="pcbi-1000633-g014">Figure 14</xref>). The constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e513" xlink:type="simple"/></inline-formula> is chosen so that the curve is continuous at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e514" xlink:type="simple"/></inline-formula>. We then determined the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e515" xlink:type="simple"/></inline-formula> by numerically maximizing, for each fixed entropy bin <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e516" xlink:type="simple"/></inline-formula>, the likelihood of the data, which is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e517" xlink:type="simple"/><label>(31)</label></disp-formula>where the first product runs over all edges <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e518" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e519" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e520" xlink:type="simple"/></inline-formula> that are contacts, the second product over all edges with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e521" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e522" xlink:type="simple"/></inline-formula> that are not contacts, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e523" xlink:type="simple"/></inline-formula> stands for the primary sequence separation of edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e524" xlink:type="simple"/></inline-formula>. The value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e525" xlink:type="simple"/></inline-formula> that maximizes the likelihood of the data determines the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e526" xlink:type="simple"/></inline-formula> for the bin <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e527" xlink:type="simple"/></inline-formula>, i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e528" xlink:type="simple"/></inline-formula>. The resulting function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e529" xlink:type="simple"/></inline-formula> is shown in the right panel of <xref ref-type="fig" rid="pcbi-1000633-g014">figure 14</xref>. Clearly the probability of an edge decreases with the entropy-sum <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e530" xlink:type="simple"/></inline-formula>, i.e. it drops by almost a factor of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e531" xlink:type="simple"/></inline-formula> from the lowest to the highest entropy edges.</p>
<p>Finally, in order to assign prior probabilities to different possible spanning trees, we assume a random graph model where each edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e532" xlink:type="simple"/></inline-formula> occurs with a probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e533" xlink:type="simple"/></inline-formula> that is proportional to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e534" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e535" xlink:type="simple"/></inline-formula> the primary sequence separation, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e536" xlink:type="simple"/></inline-formula> the entropy sum of edge <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e537" xlink:type="simple"/></inline-formula>. Note that each spanning tree only contains <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e538" xlink:type="simple"/></inline-formula> edges for a domain of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e539" xlink:type="simple"/></inline-formula>, and we thus have to ensure that our random graph model produces on average <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e540" xlink:type="simple"/></inline-formula> edges. As the expected number of edges in a random graph is equal to the sum over all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e541" xlink:type="simple"/></inline-formula>, we set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e542" xlink:type="simple"/></inline-formula> to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e543" xlink:type="simple"/><label>(32)</label></disp-formula></p>
<p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e544" xlink:type="simple"/></inline-formula> be the full graph including all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e545" xlink:type="simple"/></inline-formula> edges of a particular domain and let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e546" xlink:type="simple"/></inline-formula> be one particular spanning tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e547" xlink:type="simple"/></inline-formula>. We can now write the prior probability of the tree as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e548" xlink:type="simple"/><label>(33)</label></disp-formula>Here, the first product runs over all edges <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e549" xlink:type="simple"/></inline-formula> in the tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e550" xlink:type="simple"/></inline-formula> and the second one over all edges in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e551" xlink:type="simple"/></inline-formula> that are not in the tree <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e552" xlink:type="simple"/></inline-formula>. Since the posteriors are independent of a global rescaling of all prior probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e553" xlink:type="simple"/></inline-formula>, we divide <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e554" xlink:type="simple"/></inline-formula> by the probability of the graph that contains no edges, to obtain<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e555" xlink:type="simple"/><label>(34)</label></disp-formula>which is independent of the edges that are not contained in the tree. We can thus set the edge weights <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e556" xlink:type="simple"/></inline-formula> in equation 9 to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e557" xlink:type="simple"/><label>(35)</label></disp-formula>Unfortunately, we cannot directly used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e558" xlink:type="simple"/></inline-formula> to calculate the matrix entries <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e559" xlink:type="simple"/></inline-formula> in equation 9. As discussed above, the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e560" xlink:type="simple"/></inline-formula>-values relate to mutual information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e561" xlink:type="simple"/></inline-formula> through <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e562" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e563" xlink:type="simple"/></inline-formula> is the total number of sequences in the alignment. However, even when the phylogenetic correction is employed, because the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e564" xlink:type="simple"/></inline-formula> sequences contain many phylogenetically closely-related sequences, the number of <italic>statistically independent</italic> sequences is generally much smaller than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e565" xlink:type="simple"/></inline-formula>. Because of this, even the corrected <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e566" xlink:type="simple"/></inline-formula>-values still significantly overestimate statistical dependence. To take this into account we define the matrix entries <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e567" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e568" xlink:type="simple"/><label>(36)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e569" xlink:type="simple"/></inline-formula> is a free parameter, which must lie between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e570" xlink:type="simple"/></inline-formula> (only prior information) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e571" xlink:type="simple"/></inline-formula> (original <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e572" xlink:type="simple"/></inline-formula>-values). Note that, through this transformation, we are assuming that instead of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e573" xlink:type="simple"/></inline-formula> independent sequences, there are only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e574" xlink:type="simple"/></inline-formula> effectively independent sequences. The PPV-sensitivity curves for varying values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e575" xlink:type="simple"/></inline-formula> are shown in <xref ref-type="supplementary-material" rid="pcbi.1000633.s010">Figures S10</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000633.s011">S11</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1000633.s012">S12</xref>. For the curve in the main text, we chose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e576" xlink:type="simple"/></inline-formula>, so as to maximize the accuracy for pairs with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e577" xlink:type="simple"/></inline-formula> without a significant decrease in accuracy for pairs with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000633.e578" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000633.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s001" xlink:type="simple"><label>Figure S1</label><caption>
<p>Number of contacts <italic>n</italic> versus the number of residues <italic>l</italic> per protein domain for varying separations in primary sequence. The red lines are the regression lines (in log-space), corresponding to the power-laws <italic>n = 2.43l<sup>1.12</sup></italic>, <italic>n = 0.16l<sup>1.43</sup></italic> and <italic>n = 0.05l<sup>1.62</sup></italic>. The dashed black line corresponds to <italic>n = l</italic>.</p>
<p>(0.33 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s002" xlink:type="simple"><label>Figure S2</label><caption>
<p>Accuracy of contact predictions for all 2009 alignments based on mutual information (black), log<italic>(R)</italic> (blue), and posterior probabilities (red). For different values of sensitivity, the corresponding number of predictions for each domain and each method were selected and their positive predicted value (PPV), i.e. the fraction of correct predictions, was calculated (vertical axis). Dashed lines indicate mean PPV plus/minus one standard error. The top left panel shows predictions for all residue pairs, the top right one using only predictions for residues separated by at least 3 positions in the primary sequence, the bottom left one for pairs separated by at least 12 positions, and the bottom right panel for pairs separated by at least 24 positions.</p>
<p>(0.32 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s003" xlink:type="simple"><label>Figure S3</label><caption>
<p>Comparison of prediction accuracy for log<italic>(R)</italic> (blue), for the log<italic>(R)</italic> values contained in the maximum-likelihood tree (green) and for the posterior probability (red). As the maximum-likelihood tree only predicts <italic>l-1</italic> edges, where <italic>l</italic> is the number of columns of the alignment, the different measures cannot be directly compared in terms of sensitivity (there would be finite-length effects as predictions by the maximum-likelihood tree measure cannot reach a sensitivity of <italic>1</italic>). Instead, we sort the predictions per domain and, for each fixed cut-off on the rank <italic>r</italic>, we show the average positive predictive value (solid lines) for all predictions with rank <italic>r</italic> or higher. The dashed lines indicate plus/minus one standard error. As the shortest domains in our dataset have length 50, all domains are included in the calculation of the green curve for ranks 1 to 49. The blue and green curves are identical for high ranks as all the highest-scoring edges are included in the maximum spanning tree. However, for decreasing ranks, the maximum-spanning tree discards edges that can be explained indirectly, which leads to an improvement in performance. Importantly, the posterior probability significantly outperforms the maximum-spanning tree predictions both for low <italic>and</italic> high ranks.</p>
<p>(0.36 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s004" xlink:type="simple"><label>Figure S4</label><caption>
<p>Posteriors reflect the extent to which co-evolving pairs can be explained by contact chains. Shown are the reverse cumulative distributions of distal co-evolving pairs (Z<italic>&gt;4</italic>) that cannot be easily explained by contact chains, i.e. where the best scoring chain has a score of <italic>S&gt;2</italic> (red), <italic>S&gt;3</italic> (dark blue), or <italic>S&gt;4</italic> (light blue). For comparison the reverse cumulative distributions of posteriors for all co-evolving distal pairs (green) and all co-evolving contacts (black) are also shown.</p>
<p>(0.13 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s005" xlink:type="simple"><label>Figure S5</label><caption>
<p>Accuracy of contact predictions for all alignments. In blue, we show the performance of the phylogenetically-corrected posterior probabilities, in black the performance of the predictions based on the average-product corrected (APC) mutual information, and in red the performance of the posterior probabilities without phylogenetic correction. Curves were calculated as described in the main text.</p>
<p>(0.33 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s006" xlink:type="simple"><label>Figure S6</label><caption>
<p>Accuracy of contact predictions for alignments of length 50 to 100. In blue, we show the performance of the phylogenetically-corrected posterior probabilities, in black the performance of the predictions based on the average-product corrected (APC) mutual information, and in red the performance of the posterior probabilities without phylogenetic correction. Curves were calculated as described in the main text.</p>
<p>(0.33 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s007" xlink:type="simple"><label>Figure S7</label><caption>
<p>Accuracy of contact predictions for alignments of length 101 to 200. In blue, we show the performance of the phylogenetically-corrected posterior probabilities, in black the performance of the predictions based on the average-product corrected (APC) mutual information, and in red the performance of the posterior probabilities without phylogenetic correction. Curves were calculated as described in the main text.</p>
<p>(0.33 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s008" xlink:type="simple"><label>Figure S8</label><caption>
<p>Accuracy of contact predictions for alignments of length 201 to 300. In blue, we show the performance of the phylogenetically-corrected posterior probabilities, in black the performance of the predictions based on the average-product corrected (APC) mutual information, and in red the performance of the posterior probabilities without phylogenetic correction. Curves were calculated as described in the main text.</p>
<p>(0.33 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s009" xlink:type="simple"><label>Figure S9</label><caption>
<p>Accuracy of contact predictions for alignments of length 301 to 400. In blue, we show the performance of the phylogenetically-corrected posterior probabilities, in black the performance of the predictions based on the average-product corrected (APC) mutual information, and in red the performance of the posterior probabilities without phylogenetic correction. Curves were calculated as described in the main text.</p>
<p>(0.33 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s010" xlink:type="simple"><label>Figure S10</label><caption>
<p>Accuracy of contact predictions including the informative prior for different values of the weighting parameter <italic>α</italic>, including the limit of using only the informative prior (<italic>α</italic> = <italic>0</italic>). The positive predictive value (vertical axis) is shown as a function of sensitivity (horizontal axis). Different colors correspond to different values of <italic>α</italic> (see legend) and dashed lines show mean plus and minus one standard error. For comparison, we also show the performance of the posterior when using no prior information (black). Note that the horizontal axis is shown on a logarithmic scale.</p>
<p>(0.37 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s011" xlink:type="simple"><label>Figure S11</label><caption>
<p>Accuracy of contact predictions including the informative prior for different values of the weighting parameter <italic>α</italic>, including the limit of using only the informative prior (<italic>α</italic> = <italic>0</italic>), when considering only pairs that are at least <italic>d = 3</italic> apart in primary sequence. The positive predictive value (vertical axis) is shown as a function of sensitivity (horizontal axis). Different colors correspond to different values of <italic>α</italic> (see legend) and dashed lines show mean plus and minus one standard error. For comparison, we also show the performance of the posterior when using no prior information (black). Note that the horizontal axis is shown on a logarithmic scale.</p>
<p>(0.36 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000633.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000633.s012" xlink:type="simple"><label>Figure S12</label><caption>
<p>Accuracy of contact predictions including the informative prior for different values of the weighting parameter <italic>α</italic>, including the limit of using only the informative prior (<italic>α</italic> = <italic>0</italic>), when considering only pairs that are at least <italic>d = 12</italic> apart in primary sequence. The positive predictive value (vertical axis) is shown as a function of sensitivity (horizontal axis). Different colors correspond to different values of <italic>α</italic> (see legend) and dashed lines show mean plus and minus one standard error. For comparison, we also show the performance of the posterior when using no prior information (black). Note that the horizontal axis is shown on a logarithmic scale.</p>
<p>(0.33 MB TIF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1000633-Eddy1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name>
</person-group>             <year>1998</year>             <article-title>Profile hidden markov models.</article-title>             <source>Bioinformatics</source>             <volume>14</volume>             <fpage>755</fpage>             <lpage>763</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Hunter1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hunter</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Apweiler</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Attwood</surname><given-names>TK</given-names></name>
<name name-style="western"><surname>Bairoch</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Interpro: the integrative protein signature database.</article-title>             <source>Nucleic Acids Res</source>             <volume>35</volume>             <fpage>D224</fpage>             <lpage>228</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Eddy2"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
</person-group>             <year>1994</year>             <article-title>RNA sequence analysis using covariance models.</article-title>             <source>Nucleic Acids Research</source>             <volume>22(11)</volume>             <fpage>2079</fpage>             <lpage>2088</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Lindgreen1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lindgreen</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Gardner</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
</person-group>             <year>2006</year>             <article-title>Measuring covariation in RNA alignments: physical realism improves information measures.</article-title>             <source>Bioinformatics</source>             <volume>22(24)</volume>             <fpage>2988</fpage>             <lpage>2995</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Yanovsky1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yanovsky</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Horn</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Thorpe</surname><given-names>D</given-names></name>
</person-group>             <year>1964</year>             <article-title>Protein structure relationships revealed by mutational analysis.</article-title>             <source>Science</source>             <volume>146</volume>             <fpage>1593</fpage>             <lpage>1594</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Fitch1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fitch</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Markowitz</surname><given-names>E</given-names></name>
</person-group>             <year>1970</year>             <article-title>An improved method for determining codon variability in a gene and its application to the rate of fixation of mutations in evolution.</article-title>             <source>Biochem Genet</source>             <volume>4</volume>             <fpage>579</fpage>             <lpage>593</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-MaisnierPatin1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Maisnier-Patin</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Andersson</surname><given-names>D</given-names></name>
</person-group>             <year>2004</year>             <article-title>Adaptation to the deleterious effect of antimicrobial drug resistance mutations by compensatory evolution.</article-title>             <source>Research in Microbiology</source>             <volume>155</volume>             <fpage>360</fpage>             <lpage>369</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Wollenberg1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wollenberg</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Atchley</surname><given-names>W</given-names></name>
</person-group>             <year>2000</year>             <article-title>Separation of phylogenetic and functional associations in biological sequences by using the parametric bootstrap.</article-title>             <source>PNAS</source>             <volume>97</volume>             <fpage>3288</fpage>             <lpage>3291</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Tillier1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tillier</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>T</given-names></name>
</person-group>             <year>2003</year>             <article-title>Using multiple interdependency to separate functional from phylogenetic correlations in protein alignments.</article-title>             <source>Bioinformatics</source>             <volume>19(6)</volume>             <fpage>750</fpage>             <lpage>755</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Fodor1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fodor</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Aldrich</surname><given-names>R</given-names></name>
</person-group>             <year>2004</year>             <article-title>Influence of conservation on calculations of amino acids covariance in multiple sequence alignments.</article-title>             <source>Proteins: Structure, Function, and Bioinformatics</source>             <volume>56</volume>             <fpage>211</fpage>             <lpage>221</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Martin1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Martin</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Gloor</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Dunn</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Wahl</surname><given-names>L</given-names></name>
</person-group>             <year>2005</year>             <article-title>Using information theory to search for co-evolving residues in proteins.</article-title>             <source>Bioinformatics</source>             <volume>21(22)</volume>             <fpage>4116</fpage>             <lpage>4124</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Fares1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fares</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Travers</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>A novel method for detecting intramolecular coevolution: Adding a further dimension to selective constraints analyses.</article-title>             <source>Genetics</source>             <volume>173</volume>             <fpage>9</fpage>             <lpage>23</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-GouveiaOliveira1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gouveia-Oliveira</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Pedersen</surname><given-names>A</given-names></name>
</person-group>             <year>2007</year>             <article-title>Finding coevolving amino acid residues using row and column weighting of mutual information and multi-dimensional amino acid representation.</article-title>             <source>Algorithms for Molecular Biology</source>             <volume>2</volume>             <fpage>12</fpage>          </element-citation></ref>
<ref id="pcbi.1000633-Dunn1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dunn</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Wahl</surname><given-names>L</given-names></name>
<name name-style="western"><surname>GB</surname><given-names>G</given-names></name>
</person-group>             <year>2008</year>             <article-title>Mutual information without the influence of phylogeny or entropy dramatically improves residue contact prediction.</article-title>             <source>Bioinformatics</source>             <volume>24(3)</volume>             <fpage>333</fpage>             <lpage>340</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Yeang1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yeang</surname><given-names>CH</given-names></name>
<name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name>
</person-group>             <year>2007</year>             <article-title>Detecting coevolution in and among protein domains.</article-title>             <source>PLoS Computational Biology</source>             <volume>3</volume>             <fpage>e211</fpage>          </element-citation></ref>
<ref id="pcbi.1000633-Pazos1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pazos</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name>
</person-group>             <year>2008</year>             <article-title>Protein co-evolution, co-adaptation and interactions.</article-title>             <source>The EMBO Journal</source>             <volume>27</volume>             <fpage>2648</fpage>             <lpage>2655</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Cover1"><label>17</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cover</surname><given-names>TM</given-names></name>
<name name-style="western"><surname>Thomas</surname><given-names>JA</given-names></name>
</person-group>             <year>1991</year>             <source>Elements of information theory</source>             <publisher-name>John Wiley and Sons</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000633-Chiu1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chiu</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Kolodziejczak</surname><given-names>T</given-names></name>
</person-group>             <year>1991</year>             <article-title>Inferring consensus structure from nucleic acid sequences.</article-title>             <source>Comput Appl Biosc</source>             <volume>7</volume>             <fpage>347</fpage>             <lpage>52</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Bateman1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Coin</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Finn</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Hollich</surname><given-names>V</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>The Pfam protein families database.</article-title>             <source>Nucl Acids Res</source>             <volume>32</volume>             <fpage>D138</fpage>             <lpage>D141</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Shackelford1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shackelford</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name>
</person-group>             <year>2007</year>             <article-title>Contact prediction using mutual information and neural nets.</article-title>             <source>Proteins</source>             <volume>69</volume>             <supplement>Suppl 8</supplement>             <fpage>159</fpage>             <lpage>164</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Izarzugaza1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Izarzugaza</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Graña</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Tress</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Clarke</surname><given-names>N</given-names></name>
</person-group>             <year>2007</year>             <article-title>Assessment of intramolecular contact predictions for CASP7.</article-title>             <source>Proteins</source>             <volume>69</volume>             <supplement>Suppl 8</supplement>             <fpage>152</fpage>             <lpage>158</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Weigt1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>
<name name-style="western"><surname>White</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Szurmant</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Hoch</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name>
</person-group>             <year>2009</year>             <article-title>Identification of direct residue contacts in protein-protein interaction by message passing.</article-title>             <source>PNAS</source>             <volume>106</volume>             <fpage>67</fpage>             <lpage>72</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Lockless1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lockless</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name>
</person-group>             <year>1999</year>             <article-title>Evolutionarily conserved pathways of energetic connectivity in protein families.</article-title>             <source>Science</source>             <volume>8(286)</volume>             <fpage>295</fpage>             <lpage>299</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Sel1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Süel</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Lockless</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Wall</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name>
</person-group>             <year>2003</year>             <article-title>Evolutionarily conserved networks of residues mediate allosteric communication in proteins.</article-title>             <source>Nature Structural Biology</source>             <volume>10(1)</volume>             <fpage>59</fpage>             <lpage>69</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Gloor1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gloor</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Martin</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Wahl</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Dunn</surname><given-names>S</given-names></name>
</person-group>             <year>2005</year>             <article-title>Mutual information in protein multiple sequence alignments reveals two classes of coevolving positions.</article-title>             <source>Biochemistry</source>             <volume>44</volume>             <fpage>7156</fpage>             <lpage>7165</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Fodor2"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fodor</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Aldrich</surname><given-names>R</given-names></name>
</person-group>             <year>2004</year>             <article-title>On evolutionary conservation of thermodynamic coupling in proteins.</article-title>             <source>Journal of Biological Chemistry</source>             <volume>279(18)</volume>             <fpage>19046</fpage>             <lpage>19050</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Burger1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Burger</surname><given-names>L</given-names></name>
<name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name>
</person-group>             <year>2008</year>             <article-title>Accurate prediction of protein-protein interactions from sequence alignments using a Bayesian method.</article-title>             <source>Molecular Systems Biology</source>             <volume>4</volume>             <fpage>165</fpage>          </element-citation></ref>
<ref id="pcbi.1000633-Meil1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Meilà</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Jaakkola</surname><given-names>T</given-names></name>
</person-group>             <year>2006</year>             <article-title>Tractable Bayesian learning of tree belief networks.</article-title>             <source>Statistics and Computing</source>             <volume>16(1)</volume>             <fpage>77</fpage>             <lpage>92</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Olmean1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Olmean</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Rost</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name>
</person-group>             <year>1999</year>             <article-title>Effective use of sequence correlation and conservation in fold recognition.</article-title>             <source>J Mol Biol</source>             <volume>295</volume>             <fpage>1221</fpage>             <lpage>1239</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Pollock1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pollock</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Taylor</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name>
</person-group>             <year>1999</year>             <article-title>Coevolving protein residues: maximum likelihood identification and relationship to structure.</article-title>             <source>J Mol Biol</source>             <volume>287</volume>             <fpage>187</fpage>             <lpage>198</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Kortemme1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kortemme</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Baker</surname><given-names>D</given-names></name>
</person-group>             <year>2002</year>             <article-title>A simple physical model for binding energy hot spots in protein-protein complexes.</article-title>             <source>PNAS</source>             <volume>99(22)</volume>             <fpage>14116</fpage>             <lpage>14121</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Rost1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rost</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>
</person-group>             <year>1994</year>             <article-title>Conservation and prediction of solvent accessibility in protein families.</article-title>             <source>Proteins</source>             <volume>20</volume>             <fpage>216</fpage>             <lpage>226</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Halabi1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Halabi</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Rivoire</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name>
</person-group>             <year>2009</year>             <article-title>Protein sectors: evolutionary units of three-dimensional structure.</article-title>             <source>Cell</source>             <volume>138(4)</volume>             <fpage>774</fpage>             <lpage>786</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Miller1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Miller</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Eisenberg</surname><given-names>D</given-names></name>
</person-group>             <year>2008</year>             <article-title>Using inferred residue contacts to distinguish between correct and incorrect protein models.</article-title>             <source>Bioinformatics</source>             <volume>24(14)</volume>          </element-citation></ref>
<ref id="pcbi.1000633-Cheng1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cheng</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Baldi</surname><given-names>P</given-names></name>
</person-group>             <year>2007</year>             <article-title>Improved residue contact prediction using support vector machines and a large feature set.</article-title>             <source>BMC Bioinformatics</source>             <volume>8</volume>             <fpage>113</fpage>          </element-citation></ref>
<ref id="pcbi.1000633-Finn1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Finn</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Marshall</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name>
</person-group>             <year>2005</year>             <article-title>iPfam: visualization of protein-protein interactions in pdb at domain and amino acid resolutions.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>410</fpage>             <lpage>412</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Chow1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chow</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>C</given-names></name>
</person-group>             <year>1968</year>             <article-title>Approximating discrete probability distributions with dependence trees.</article-title>             <source>IEEE Transactions on Information Theory</source>             <volume>IT-14</volume>             <fpage>462</fpage>             <lpage>467</lpage>          </element-citation></ref>
<ref id="pcbi.1000633-Cerquides1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cerquides</surname><given-names>J</given-names></name>
<name name-style="western"><surname>de Màntaras</surname><given-names>RL</given-names></name>
</person-group>             <year>2003</year>             <article-title>Tractable bayesian learning of tree augmented naive bayes classifiers.</article-title>             <source>Proceedings of Twentieth International conference on Machine Learning</source>          </element-citation></ref>
<ref id="pcbi.1000633-Bollobs1"><label>39</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bollobás</surname><given-names>B</given-names></name>
</person-group>             <year>1998</year>             <source>Modern Graph Theory</source>             <publisher-loc>Berlin</publisher-loc>             <publisher-name>Springer, corr. 2nd printing edition</publisher-name>          </element-citation></ref>
</ref-list>

</back>
</article>