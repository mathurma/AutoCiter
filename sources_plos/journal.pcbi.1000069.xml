<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PLCB-RA-0759R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000069</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Protein Homology Detection</subject><subject>Mathematics/Statistics</subject></subj-group></article-categories><title-group><article-title>A Probabilistic Model of Local Sequence Alignment That Simplifies Statistical Significance Estimation</article-title><alt-title alt-title-type="running-head">Probabilistic Local Alignment</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Eddy</surname><given-names>Sean R.</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1">          <addr-line>Howard Hughes Medical Institute, Janelia Farm Research Campus, Ashburn, Virginia, United States of America</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Rost</surname><given-names>Burkhard</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Columbia University, United States of America</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">eddys@janelia.hhmi.org</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: SE. Performed the experiments: SE. Analyzed the data: SE. Contributed reagents/materials/analysis tools: SE. Wrote the paper: SE.</p></fn><fn fn-type="conflict"><p>The author has declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>5</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>30</day><month>5</month><year>2008</year></pub-date><volume>4</volume><issue>5</issue><elocation-id>e1000069</elocation-id><history><date date-type="received"><day>5</day><month>12</month><year>2007</year></date><date date-type="accepted"><day>26</day><month>3</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Sean Eddy</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Sequence database searches require accurate estimation of the statistical significance of scores. Optimal local sequence alignment scores follow Gumbel distributions, but determining an important parameter of the distribution (<italic>λ</italic>) requires time-consuming computational simulation. Moreover, optimal alignment scores are less powerful than probabilistic scores that integrate over alignment uncertainty (“Forward” scores), but the expected distribution of Forward scores remains unknown. Here, I conjecture that both expected score distributions have simple, predictable forms when full probabilistic modeling methods are used. For a probabilistic model of local sequence alignment, optimal alignment bit scores (“Viterbi” scores) are Gumbel-distributed with constant <italic>λ</italic> = log 2, and the high scoring tail of Forward scores is exponential with the same constant <italic>λ</italic>. Simulation studies support these conjectures over a wide range of profile/sequence comparisons, using 9,318 profile-hidden Markov models from the Pfam database. This enables efficient and accurate determination of expectation values (E-values) for both Viterbi and Forward scores for probabilistic local alignments.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>Sequence database searches are a fundamental tool of molecular biology, enabling researchers to identify related sequences in other organisms, which often provides invaluable clues to the function and evolutionary history of genes. The power of database searches to detect more and more remote evolutionary relationships – essentially, to look back deeper in time – has improved steadily, with the adoption of more complex and realistic models. However, database searches require not just a realistic scoring model, but also the ability to distinguish good scores from bad ones – the ability to calculate the <italic>statistical significance</italic> of scores. For many models and scoring schemes, accurate statistical significance calculations have either involved expensive computational simulations, or not been feasible at all. Here, I introduce a probabilistic model of local sequence alignment that has readily predictable score statistics for position-specific profile scoring systems, and not just for traditional optimal alignment scores, but also for more powerful log-likelihood ratio scores derived in a full probabilistic inference framework. These results remove one of the main obstacles that have impeded the use of more powerful and biologically realistic statistical inference methods in sequence homology searches.</p></abstract><funding-group><funding-statement>None.</funding-statement></funding-group><counts><page-count count="14"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Sequence similarity searching was advanced by the introduction of probabilistic modeling methods, such as profile hidden Markov models (profile HMMs) and pair-HMMs <xref ref-type="bibr" rid="pcbi.1000069-Durbin1">[1]</xref>. When parameters are probabilities rather than arbitrary scores, they are more readily optimized by objective mathematical criteria. This enables building more complex, biologically realistic models with large numbers of parameters. For example, profile HMMs use position-specific insertion/deletion probabilities in place of the arbitrary, position-invariant gap costs of more traditional approaches such as BLAST or PSI-BLAST <xref ref-type="bibr" rid="pcbi.1000069-Altschul1">[2]</xref>, and this allows profile HMMs to model the fact that indels occur more frequently in some parts of a protein more than others (e.g., in surface loops as opposed to buried core) <xref ref-type="bibr" rid="pcbi.1000069-Krogh1">[3]</xref>.</p><p>More sophisticated scoring models are desirable but not sufficient. It is also necessary to be able to determine the statistical significance of a score efficiently and accurately <xref ref-type="bibr" rid="pcbi.1000069-Altschul2">[4]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Mitrophanov1">[5]</xref>. One reason that the BLAST suite of programs <xref ref-type="bibr" rid="pcbi.1000069-Altschul1">[2]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Altschul3">[6]</xref> is so useful is that BLAST introduced a robust theory for evaluating the statistical significance of local alignment scores, widely known as Karlin/Altschul statistics <xref ref-type="bibr" rid="pcbi.1000069-Karlin1">[7]</xref>–<xref ref-type="bibr" rid="pcbi.1000069-Altschul4">[9]</xref>. Although the scoring technology in HMM-based profile search and profile/profile search methods is generally an improvement over BLAST and PSI-BLAST <xref ref-type="bibr" rid="pcbi.1000069-Park1">[10]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Edgar1">[11]</xref>, some problems in determining statistical significance of homology search scores have impeded the development and adoption of these or other more complex models and methods <xref ref-type="bibr" rid="pcbi.1000069-Pearson1">[12]</xref>. There are two main problems.</p><p>The first problem is that Karlin/Altschul statistics only rigorously apply to scores of optimal <italic>ungapped</italic> alignments using simple position-independent scoring systems. In this case, alignment scores follow a Gumbel distribution with slope parameter <italic>λ</italic> and location parameter <italic>K</italic> <xref ref-type="bibr" rid="pcbi.1000069-Karlin1">[7]</xref>, and both parameters are readily calculated for any given scoring system <xref ref-type="bibr" rid="pcbi.1000069-Karlin1">[7]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Altschul5">[13]</xref>. In the more relevant case of optimal <italic>gapped</italic> local alignments, although scores empirically still follow a Gumbel distribution for a useful range of gap costs <xref ref-type="bibr" rid="pcbi.1000069-Mott1">[14]</xref>, the key Gumbel <italic>λ</italic> parameter must be estimated by expensive computational simulation for each new scoring system <xref ref-type="bibr" rid="pcbi.1000069-Altschul4">[9]</xref>. Much effort aims to find better ways of determining <italic>λ</italic> <xref ref-type="bibr" rid="pcbi.1000069-Drasdo1">[15]</xref>–<xref ref-type="bibr" rid="pcbi.1000069-Metzler1">[24]</xref>. For traditional pairwise comparison methods (e.g. BLAST), using computational simulations to determine <italic>λ</italic> is not a major limitation. BLAST precalculates Karlin/Altschul parameters <italic>K</italic> and <italic>λ</italic> for the small number of general scoring systems in common use <xref ref-type="bibr" rid="pcbi.1000069-Altschul1">[2]</xref>. However, for position-specific profile scoring models like PSI-BLAST or profile HMMs, each query specifies a customized scoring system, requiring its own <italic>K</italic> and <italic>λ</italic>. PSI-BLAST avoids using simulations to determine <italic>λ</italic> by restricting its profiles to fixed position-invariant gap costs, and assuming (backed by empirical results) that the <italic>λ</italic> of a PSI-BLAST profile is equal to the <italic>λ</italic> of the pairwise scoring system with the same gap costs and the most similar relative entropy (average score) per aligned residue pair <xref ref-type="bibr" rid="pcbi.1000069-Altschul1">[2]</xref>. For models with position-specific gap penalties, though, such as the HMMER profile HMMs used by protein domain databases like Pfam <xref ref-type="bibr" rid="pcbi.1000069-Finn1">[25]</xref> and SMART <xref ref-type="bibr" rid="pcbi.1000069-Letunic1">[26]</xref>, each model still requires a relatively expensive “calibration” by simulation before accurate E-values can be obtained. This lack of computational efficiency particularly hampers the use of profile HMMs in iterative database searches, where each iteration produces another model that needs calibration.</p><p>The second problem is that in terms of probabilistic inference, an optimal alignment score is not the score we should be calculating in a homology search. The quantity we want to calculate is the total log likelihood ratio for the target sequence(s) given an evolutionary model and a null hypothesis, <italic>independent</italic> of any particular alignment. The alignment is uncertain, a so-called “nuisance variable” in the inference that one wants to marginalize (integrate out). In closely related sequences, when the alignment is well determined, the optimal alignment score will approximate the total log likelihood ratio, but the more uncertain the alignment, the more the optimal alignment score and the total log-likelihood ratio differ, so remote homology detection (where alignments are most uncertain) is most affected by the approximation. Benchmarks of profile HMM sensitivity and specificity have shown that “Viterbi” scores (optimal alignment) are significantly outperformed by “Forward” scores (total log likelihood ratios, summed over all alignments) <xref ref-type="bibr" rid="pcbi.1000069-Johnson1">[27]</xref>. However, Karlin/Altschul statistics do not apply to Forward scores, and are not expected to <xref ref-type="bibr" rid="pcbi.1000069-Yu1">[28]</xref>. The distribution that Forward scores follow had been unknown <xref ref-type="bibr" rid="pcbi.1000069-Yu1">[28]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Karplus1">[29]</xref>. Forward score distributions have been empirically fitted to various fat-tailed distributions <xref ref-type="bibr" rid="pcbi.1000069-Karplus1">[29]</xref>, but with unsatisfactory accuracy.</p><p>Here I test two conjectures about the expected distributions of scores for full probabilistic models: that optimal gapped alignment scores (Viterbi scores) follow Gumbel distributions with a constant <italic>λ</italic> (just as in the ungapped alignment case) and that the expected distribution of total log likelihood ratio scores (Forward scores) asymptotes to an exponential tail with the same constant <italic>λ</italic>. I use simulations to show that these conjectures hold for all the models in the current Pfam database (9318 profile HMMs). In achieving these results, I modified the architecture and parameterization of profile HMMs used by HMMER <xref ref-type="bibr" rid="pcbi.1000069-Eddy1">[30]</xref>.</p></sec><sec id="s2"><title>Results</title><p>This work was done as part of a reimplementation of the HMMER profile HMM software package <xref ref-type="bibr" rid="pcbi.1000069-Eddy1">[30]</xref> in what will become version 3 (HMMER3). For concreteness, most of the results are described in HMMER's specific context of profile HMM/sequence comparison, though I expect the same conjectures to apply more broadly (see <xref ref-type="sec" rid="s3">Discussion)</xref>.</p><sec id="s2a"><title>Homology Search As a Statistical Inference Problem</title><p>Let us start with a definition of Viterbi and Forward scores in terms of probabilistic inference. We have a <bold>query</bold> (either a single sequence or a multiple alignment), and we want to ask if a <bold>target</bold> sequence <bold>x</bold> is homologous to our query or not. To set up a hypothesis test, we specify “homology to the query” as a hypothesis (call it <italic>H</italic>) to be compared to (at least) one alternative hypothesis, that <bold>x</bold> is an unrelated sequence (call this hypothesis <italic>R</italic>, random). To apply probabilistic inference, both hypotheses are specified as full probabilistic models, which means that they describe probability distributions <italic>P</italic>(<bold>x</bold>|<italic>H</italic>) and <italic>P</italic>(<bold>x</bold>|<italic>R</italic>), such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e001" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e002" xlink:type="simple"/></inline-formula> over all possible target sequences <bold>x</bold> = <italic>x</italic><sub>1</sub>…<italic>x<sub>L</sub></italic> of length <italic>L</italic> = 1…∞. <italic>H</italic> and <italic>R</italic> would typically be generative stochastic models such as hidden Markov models (HMMs) or stochastic context-free grammars (SCFGs) <xref ref-type="bibr" rid="pcbi.1000069-Durbin1">[1]</xref>. (Note that this does explicitly define a <italic>homology search</italic>, not merely a similarity search <xref ref-type="bibr" rid="pcbi.1000069-Pertsemlidis1">[31]</xref>.)</p><p>Typically, model <italic>H</italic> will generate target residues aligned to (homologous to) residues in the query, along with deletions and insertions relative to the query, so its scoring model depends on an alignment of the query to the target. That is, model <italic>H</italic> directly expresses a joint probability distribution <italic>P</italic>(<bold>x</bold>,<italic>π</italic>|<italic>H</italic>), where <italic>π</italic> represents a particular alignment. To obtain the probability <italic>P</italic>(<bold>x</bold>|<italic>H</italic>), we marginalize the unknown nuisance variable <italic>π</italic>; that is, we sum over all possible alignments, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e003" xlink:type="simple"/></inline-formula>.</p><p>A model might require the complete query and target sequences to be aligned and homologous – a <bold>global</bold> alignment model. Because biological sequences often only share homologous domains, it is more useful for <italic>H</italic> to permit any subsequence <italic>i</italic>…<italic>j</italic> of the query to align to any subsequence <italic>k</italic>…<italic>l</italic> of the target, while treating the remainders of the sequences as nonhomologous – this defines a <bold>local</bold> sequence alignment model.</p><p>The simplest random model <italic>R</italic> is a one-state HMM that generates sequences with each residue drawn from a background frequency distribution. This is the usual independent, identically distributed background model used when calculating standard log-odds scoring matrices, plus a geometric length distribution. In this case, there is only one possible alignment to the target sequence, and <italic>P</italic>(<bold>x</bold>|<italic>R</italic>) is obtained directly.</p><p>The likelihoods of <italic>H</italic> and <italic>R</italic> can be used to define at least two different log likelihood ratio scores for a target sequence <bold>x</bold>. The <bold>Viterbi score</bold> <italic>V</italic> is the score of the optimal alignment <italic>π̅</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e004" xlink:type="simple"/></disp-formula></p><p>The <bold>Forward score</bold> <italic>F</italic> is obtained from the total likelihood of model <italic>H</italic>, a sum over all possible alignments:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e005" xlink:type="simple"/></disp-formula></p><p>The logarithms may be taken to any base <italic>z</italic>. By convention, HMMER reports scores in units of bits, log base <italic>z</italic> = 2. Because both scores are log likelihood ratios, I will be careful to refer to Viterbi versus Forward scores, or to optimal alignment scores versus “total log likelihood ratio” scores.</p><p>The names Viterbi and Forward refer to the standard dynamic programming algorithms used to calculate these scores in the specific case of HMMs <xref ref-type="bibr" rid="pcbi.1000069-Durbin1">[1]</xref>. Other probabilistic models have differently named algorithms (CYK and Inside for stochastic context-free grammars for RNA analysis, for example <xref ref-type="bibr" rid="pcbi.1000069-Durbin1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Eddy2">[32]</xref>), but here I will use the shorthand <italic>V</italic> and <italic>F</italic> to represent optimal alignment scores and total log likelihood ratio scores in general.</p><p>Traditional search algorithms report optimal alignment scores, so the Viterbi score is the probabilistic analog of traditional methods. However, from a probabilistic inference standpoint, the Forward score is what we want, because we are after the probability that sequence <bold>x</bold> is a homologue of the query – that is, the posterior probability of model <italic>H</italic> given data <bold>x</bold>, <italic>P</italic>(<italic>H</italic>|<bold>x</bold>) <xref ref-type="bibr" rid="pcbi.1000069-Jaynes1">[33]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-MacKay1">[34]</xref>. The posterior is a sigmoid function of <italic>F</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e006" xlink:type="simple"/></disp-formula>where <italic>ρ</italic> is a constant offset, the prior log odds ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e007" xlink:type="simple"/></inline-formula>.</p><p>Forward scores are not generally used in traditional sequence comparison, because they only make sense if individual alignments have probabilities <italic>P</italic>(<bold>x</bold>,<italic>π</italic>|<italic>H</italic>) that can be meaningfully summed. Forward scores cannot be calculated directly for arbitrary (nonprobabilistic) scoring systems, except by using approaches based on renormalization and partition functions, where the arbitrary scores are assumed to be unnormalized log probabilities <xref ref-type="bibr" rid="pcbi.1000069-Yu1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1000069-Miyazawa1">[35]</xref>–<xref ref-type="bibr" rid="pcbi.1000069-Webb1">[38]</xref>).</p><p>Local optimal alignment scores of random sequences (<italic>V</italic> scores) are expected to follow Karlin/Altschul statistics <xref ref-type="bibr" rid="pcbi.1000069-Karlin1">[7]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Mott1">[14]</xref>, a special case of a Gumbel distribution (a type I extreme value distribution) <xref ref-type="bibr" rid="pcbi.1000069-Gumbel1">[39]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e008" xlink:type="simple"/></disp-formula>where <italic>μ</italic> and <italic>λ</italic> are location and scale parameters. Karlin/Altschul statistics give a specific dependence of <italic>μ</italic> on query and target sequence lengths <italic>N</italic> and <italic>L</italic>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e009" xlink:type="simple"/></inline-formula>, with parameter <italic>K</italic> essentially representing the fraction of the <italic>NL</italic> residue alignment lattice that is available for initiating independent local alignments. I will use the more general Gumbel notation (in terms of <italic>μ</italic>, <italic>λ</italic>) as opposed to the more usual Karlin/Altschul notation (in terms of <italic>KNL</italic>, <italic>λ</italic>) for reasons that will become clear when I consider how score distributions depend on target sequence length.</p><p>In contrast to optimal alignment scores, the distribution of Forward scores is unknown. It has appeared “fat-tailed” relative to the high-scoring exponential tail of the Gumbel distribution of Viterbi scores <xref ref-type="bibr" rid="pcbi.1000069-Yu1">[28]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Karplus1">[29]</xref>.</p></sec><sec id="s2b"><title>Expected Distributions Conjectured for Local Viterbi and Forward Scores</title><p>I made the following two conjectures about <italic>V</italic> and <italic>F</italic> scores, in the case of full probabilistic models of local sequence alignment:</p><list list-type="bullet"><list-item><p>The Gumbel distribution of Viterbi scores has a fixed <italic>λ</italic> = log <italic>z</italic>, where <italic>z</italic> is the base of the logarithm of the log-odds scoring system.</p></list-item><list-item><p>The high-scoring tail of Forward scores is exponentially distributed with the same <italic>λ</italic> = log <italic>z</italic>.</p></list-item></list><p>These conjectures are based on three main lines of argument, two of which depend heavily on the work of Bundschuh and his collaborators.</p><p>First, for Viterbi scores, Bundschuh's “central conjecture” about the distribution of optimal gapped local alignment scores states that <italic>λ</italic> for the Gumbel distribution is the unique positive solution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e010" xlink:type="simple"/></inline-formula> in the limit of infinite length comparisons <xref ref-type="bibr" rid="pcbi.1000069-Bundschuh1">[22]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Chia1">[23]</xref>. There is a strong analogy to the case of ungapped local alignments with additive pairwise residue scores <italic>σ</italic><italic><sub>ab</sub></italic>, where <italic>λ</italic> is the unique positive solution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e011" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000069-Altschul5">[13]</xref>. When the residue scores <italic>σ</italic><italic><sub>ab</sub></italic> are explicitly probabilistic log-odds scores (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e012" xlink:type="simple"/></inline-formula> in some arbitrary logarithm base <italic>z</italic>) then simple algebra shows that <italic>λ</italic> for ungapped alignment scores is log <italic>z</italic>. Likewise Bundschuh's central conjecture would be satisfied by <italic>λ</italic> = log <italic>z</italic> for full probabilistic models of local alignment, when indels are included as part of the probability model rather than scored with arbitrary penalties.</p><p>Second, for Forward scores, Milosavljević proved in his “algorithmic significance” method that an upper bound for the distribution <italic>P</italic>(<italic>F</italic>&gt;<italic>t</italic>) of log likelihood ratios <italic>F</italic> for full probabilistic models is an exponential <italic>e</italic><sup>−<italic>t</italic> log z</sup> <xref ref-type="bibr" rid="pcbi.1000069-Milosavljevi1">[40]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Barrett1">[41]</xref>. Although this is not a tight bound, it suggests the high-scoring tail cannot be fatter than exponential, and that if it were exponential, it must have <italic>λ</italic>≥log <italic>z</italic>.</p><p>Third, for Forward scores, Yu, Bundschuh, and Hwa argued by a different approach that the high-scoring tail <italic>P</italic>(<italic>F</italic>&gt;<italic>t</italic>) for scores for probabilistic sequence alignment is likely to be approximated by <italic>e</italic><sup>−<italic>t</italic> log z</sup>, i.e. again, an exponential tail with <italic>λ</italic> = log <italic>z</italic> <xref ref-type="bibr" rid="pcbi.1000069-Yu2">[42]</xref>. However, they only used this result as an intermediate in a derivation showing that the scores of a new “hybrid” scoring system for local alignment would probably be Gumbel-distributed with <italic>λ</italic> = log <italic>z</italic>. They stated their approximation in the context of a full probabilistic model of global alignment, not local, and then used that result to derive a further approximation for the expected distributions of scores for a nonprobabilistic model of local alignment. However, I believe their approximation only relies on the model being fully probabilistic, not whether it is of global or local alignment.</p><p>Additionally, one expects the high-scoring tail of Forward scores to approximate the high-scoring tail of Viterbi scores (so Gumbel-distributed Viterbi scores and exponential-tailed Forward scores would have the same <italic>λ</italic>), because for the highest scoring sequences, the optimal alignment should contain most of the probability mass.</p><p>In practice, however, the simulation-calibrated <italic>λ</italic> values for bit scores of Gumbel distributions fitted to Viterbi scores of HMMER2 multihit local alignment models for 9318 Pfam 22.0 models have a mean of 0.6677, with a standard deviation of 0.051 (±8%), and a range of 0.517 to 1.337. Though the mean is suggestively close to the conjectured log2 = 0.6931, the variation is unacceptably broad, well outside traditional tolerance for useful <italic>λ</italic> estimates (which is typically considered to be ≤3% error <xref ref-type="bibr" rid="pcbi.1000069-Altschul6">[20]</xref>). Similarly, another popular profile HMM software package, SAM <xref ref-type="bibr" rid="pcbi.1000069-Krogh1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Karplus2">[43]</xref>, has used <italic>λ</italic> = log <italic>z</italic> in the past, but switched to simulated-calibrated <italic>λ</italic> values because they gave better statistical significance estimates <xref ref-type="bibr" rid="pcbi.1000069-Karplus1">[29]</xref>. Either something is wrong with the conjectures, or something is not quite right with profile HMMs of local alignment.</p></sec><sec id="s2c"><title>A Generative Probabilistic Model of Local Sequence Alignment</title><p>I modified HMMER's profile HMM architecture in several details, with the main goal of achieving a uniform query entry/exit distribution in local alignments. A uniform query entry/exit distribution means that for a query profile of <italic>N</italic> positions 1…<italic>N</italic>, each choice of local alignment to a core model subsequence <italic>i</italic>…<italic>j</italic> (leaving query prefix 1…<italic>i</italic>−1 and suffix <italic>j</italic>+1…<italic>N</italic> unaligned) has the same probability: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e013" xlink:type="simple"/></inline-formula>, since there are <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e014" xlink:type="simple"/></inline-formula> possible choices of <italic>i</italic>…<italic>j</italic>. This assumption is implicit in the traditional Smith/Waterman alignment scoring system <xref ref-type="bibr" rid="pcbi.1000069-Smith1">[44]</xref>, which scores identically (zero) for any choice of entry <italic>i</italic> and exit <italic>j</italic>, therefore corresponding to an implicit assumption of a uniform query fragment distribution (albeit unnormalized). HMMER's previous entry/exit distribution, in contrast, was <italic>ad hoc</italic> and non-uniform, causing scores to be biased by the local alignment's position in the query model. I guessed that a uniform entry/exit distribution might result in simpler, more statistically homogeneous expected score distributions that might asymptotically approach conjectured predictions faster than for nonuniform entry/exit distributions.</p><p>Besides HMMER's previous model, several other probabilistic local alignment models in the literature also imply nonuniform entry/exit distributions. For example, simple pair-HMMs for pairwise local sequence alignment imply a non-uniform (geometric) distribution over local alignment length, because they use a single residue alignment state with a self-loop and an exit probability <xref ref-type="bibr" rid="pcbi.1000069-Durbin1">[1]</xref>. In standard profile HMMs, I see no way to specify a uniform entry/exit distribution when delete states are present, at least not while maintaining a fully probabilistic model.</p><p>The generative probabilistic model of local alignment that I intend to use in HMMER3 is illustrated in <xref ref-type="fig" rid="pcbi-1000069-g001">Figure 1</xref>.</p><fig id="pcbi-1000069-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000069.g001</object-id><label>Figure 1</label><caption><title>A generative probabilistic model of local alignment.</title><p>(A) an example of a core model with five consensus positions. Each consensus position of the query is modeled by a <italic>node</italic> containing three <italic>states</italic>: a <italic>match state (M)</italic> that emits the consensus position (squares), a mute <italic>delete state (D)</italic> that emits nothing and deletes the consensus position (circles), and an <italic>insert state (I)</italic> that emits one or more residues after the consensus position (diamonds). For clarity, the emission probability distributions on match and insert states have been omitted in the figure. Nodes are numbered 1…<italic>N</italic> for a query of length <italic>N</italic> consensus positions. The three states in each node have seven transition probabilities (arrows), implementing a probabilistic model of traditional sequence alignment with affine gap penalties: the <italic>M</italic>→<italic>D</italic> and <italic>M</italic>→<italic>I</italic> probabilities correspond to gap-open costs, and <italic>D</italic>→<italic>D</italic> and <italic>I</italic>→<italic>I</italic> probabilities correspond to gap-extend costs. The core model starts and ends with mute begin (B) and end (E) states (circles). Bold arrows indicate the consensus (all match) path through the model. Blue states and transitions are either modified or removed in a configured search profile. (B) The search profile, with extra states and state transitions (magenta) enabling a model of local or glocal alignment, and unihit versus multihit alignment, as described in the text. States N, C, and J emit on transition (indicated by x's on their transition arrows), in order to be able to generate ≥0 residues rather than ≥1. (C) A partial view of the implicit probabilistic model, showing three of the possible 15 <italic>i</italic>…<italic>j</italic> query segments (1…5, 2…4, and 3) for an <italic>N</italic> = 5-node model, with uniform entry probabilities of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e015" xlink:type="simple"/></inline-formula> and exit probabilities of 1.0. The presence of the remaining 12 query fragments in the model is indicated by dashed entry/exit transitions and vertical ellipses.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.g001" xlink:type="simple"/></fig><p><xref ref-type="fig" rid="pcbi-1000069-g001">Figure 1A</xref> shows the <bold>core model</bold>, which is a standard profile HMM essentially following the original formulation of Krogh <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000069-Krogh1">[3]</xref>. This is a model of global alignment to the original query (a multiple alignment or single sequence). The parameters in the core model (M and I residue emissions, and M, D, and I state transitions) are estimated from counts of residues and indels in the query. Details of model construction and parameter estimation in the core model follow previous work on profile HMMs, and are not particularly relevant to the results reported here except as noted.</p><p><xref ref-type="fig" rid="pcbi-1000069-g001">Figure 1B</xref> shows the <bold>search profile</bold>, which adds extra states and state transitions to the core model to describe various kinds of alignment <italic>modes</italic>, including local versus glocal and unihit versus multihit. For locality with respect to a query segment, there are transitions from the begin state to any match state, and exits from any match or delete state to the end. For locality with respect to a target sequence segment, the search profile generates flanking <italic>unannotated</italic> segments of the target using N and C states. For a “multihit” mode, to generate multiple consistent alignments to the same query in one target sequence (either multiple domains of the same type, or separate pieces of one alignment), the model may cycle from E to the J state, generate an unannotated segment in J, and cycle back to B. The N, C, and J states are all assumed to emit residues with the same background frequencies as in null model <italic>R</italic>, so their log-odds emission scores are zero. This is essentially the same as the HMMER2 “Plan 7” profile architecture, but as it cannot be parameterized to achieve a uniform entry/exit distribution, the following step was taken.</p><p><xref ref-type="fig" rid="pcbi-1000069-g001">Figure 1C</xref> shows the <bold>implicit probabilistic model</bold>. To achieve a uniform entry/exit distribution, we imagine replicating all <italic>N</italic>(<italic>N</italic>+1)/2 possible chunks <italic>i</italic>…<italic>j</italic> of the model, and assigning an entry probability of 2/<italic>N</italic>(<italic>N</italic>+1) and exit probability of 1.0 to each of these fragments. Except for these entry/exit probabilities, all other emission and transition probabilities are the same as in the search profile. Now we have a probabilistic model with a uniform entry/exit distribution, but the model is enormous. Dynamic programming on the implicit probabilistic model would be costly. A key observation is that dynamic programming on the search profile with entry probabilities set to 2/<italic>N</italic>(<italic>N</italic>+1) and exits to 1.0 is provably equivalent to doing dynamic programming on the implicit probabilistic model. Two conditions are sufficient to make this so: first, that there is a one-to-one correspondence between the sets of possible state paths in the two models, and second, that any given state path is assigned identical probability by either model. (The state transition schemes in the search profile and the implicit probabilistic model were carefully designed to fulfill these conditions.) Therefore dynamic programming on one model to find either the optimal state path or the sum over all state paths must give the same answer as the other model would. This holds so long as the probability of entering at <italic>i</italic> is independent of exit point <italic>j</italic>, which is true for a uniform entry distribution.</p><p>Therefore, the search profile is not probabilistic per se. It is a dynamic programming construct that calculates correct probabilities for the implicit probabilistic model. It uses entry probabilities of 2/<italic>N</italic>(<italic>N</italic>+1) and exit probabilities of 1.0 that are properly normalized with respect to the state diagram for the implicit probabilistic model, not the state diagram for the search profile.</p><p>The N, C, J state transitions, plus the self-loop transition in the null hypothesis HMM <italic>R</italic>, comprise the <bold>target length model</bold>, so-called because this parameterization largely controls the expected length of the target sequence. For simplicity, the target length model is expressed in terms of three parameters <italic>p</italic>, <italic>q</italic>, and <italic>r</italic>. <italic>p</italic> is the self-loop transition probability for N, C, and J, so it controls the length of unannotated segments; parameterizing these states identically corresponds to an assumption that prefixes, suffixes, and intervening unannotated regions have identical length distributions. <italic>q</italic> is the E→J transition probability of looping around for another pass through the core model, controlling the expected number of homologous domains per target sequence (<italic>q</italic> = 0 puts the model in a unihit mode, and <italic>q</italic>&gt;0 is a multihit mode; I will only use <italic>q</italic> = 0.5 here). <italic>r</italic> is the self-loop transition for null model <italic>R</italic>'s single HMM state, controlling the length distribution generated by <italic>R</italic>.</p><p>How should the three target length model parameters be set? I will discuss the rationale in more detail in a later section, in the context of illustrative simulation results. For now I will just state that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e016" xlink:type="simple"/></inline-formula>, <italic>q</italic> = 0, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e017" xlink:type="simple"/></inline-formula> in unihit modes, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e018" xlink:type="simple"/></inline-formula>, <italic>q</italic> = 0.5, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e019" xlink:type="simple"/></inline-formula> in multihit modes. That is, these model parameters are recalculated for each target, according to its length <italic>L</italic>: both <italic>H</italic> and <italic>R</italic> are conditional on <italic>L</italic>. With these choices, models <italic>H</italic> and <italic>R</italic> will both generate approximately the same mean target sequence length <italic>L</italic>. Previously HMMER2 used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e020" xlink:type="simple"/></inline-formula> (and the same <italic>q</italic> = 0 or <italic>q</italic> = 0.5 choice of unihit versus multihit mode), independent of target sequence length. Recalculating part of the scoring system based on each target sequence's length is an unusual step, but the reason to condition the hypothesis test (both models <italic>H</italic> and <italic>R</italic>) on target length <italic>L</italic> will become apparent.</p></sec><sec id="s2d"><title>Alignment “Modes”</title><p>Traditional sequence similarity search methods distinguish local, global, and glocal alignments, applying different alignment algorithms, while using the same scoring system. (A <bold>glocal</bold> alignment, also known as a semi-global alignment <xref ref-type="bibr" rid="pcbi.1000069-Kann1">[45]</xref>, is global with respect to the query 1…<italic>N</italic>, and local with respect to a subsequence <italic>k</italic>…<italic>m</italic> of the target; glocal alignment is useful, for example, when a profile HMM models a protein structural domain that may occur one or more times somewhere in a longer, multidomain protein sequence.) Additionally, local and glocal algorithms may allow only one aligned region per target sequence (a <bold>unihit</bold> alignment), or they may allow a combination of one or more aligned regions (a <bold>multihit</bold> alignment). The Smith/Waterman alignment algorithm <xref ref-type="bibr" rid="pcbi.1000069-Smith1">[44]</xref> is a unihit algorithm, for example, whereas BLAST is multihit, implementing “sum statistics” to allow multiple consistent hits to contribute to a target's score <xref ref-type="bibr" rid="pcbi.1000069-Karlin2">[8]</xref>.</p><p>In a probabilistic inference framework, these distinctions are not in the algorithm, but in the parameterization and architecture of the model <italic>H</italic>. A full (generative) probabilistic model <italic>H</italic> must always explicitly model the <italic>complete</italic> target sequence <italic>x</italic><sub>1</sub>…<italic>x<sub>L</sub></italic>, not just part(s) of it. This is why the HMMER model includes additional states and transitions that account for unannotated residues in the target sequence, and transitions allowing a model to loop back and generate one or more consistent alignments to the core model in the same target. Thus, an alignment <italic>π</italic> to a probabilistic model is always complete (and in some sense “global”) in that every residue <italic>x<sub>i</sub></italic> in the target is assigned to a state in the model. The HMM algorithms used to score and align target sequences (Viterbi and Forward) are always the same, regardless of the configuration of the model. In HMMER, searches can be configured in any choice of local, glocal, or global combined with a choice of unihit or multihit, a total of six different standard alignment <italic>modes</italic>, by reparameterizing the entry/exit distribution and the target length distribution. I only explore local alignment modes in this paper, and I generally concentrate on multihit rather than unihit mode because multihit mode is more powerful.</p></sec><sec id="s2e"><title>Local Viterbi Scores Follow Gumbel Distributions with Constant <italic>λ</italic></title><p>Viterbi bit scores are predicted to be Gumbel distributed with parametric <italic>λ</italic> = log 2. To test this prediction on many different profile HMMs, I estimated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula>(<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> represents a maximum likelihood estimate fitted to a finite sample of scores, as distinguished from the parametric true <italic>λ</italic>) for 9,318 different profile HMMs built from Pfam 22.0 seed alignments, by collecting multihit local Viterbi score distributions for <italic>n</italic> = 10<sup>5</sup> i.i.d. random sequences of length 400 generated with the same residue frequencies as the null model <italic>R</italic>. <xref ref-type="fig" rid="pcbi-1000069-g002">Figure 2</xref> shows the results of maximum likelihood fitting these scores to Gumbel distributions. The 9,318 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates are tightly clustered with mean 0.6928, consistent with the conjecture that <italic>λ</italic> = log 2 = 0.6931.</p><fig id="pcbi-1000069-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000069.g002</object-id><label>Figure 2</label><caption><title>Viterbi scores follow Gumbel distributions with constant <italic>λ</italic>.</title><p>(A) A histogram showing the distribution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates determined by maximum likelihood Gumbel fits to multihit local Viterbi scores of <italic>n</italic> = 10<sup>5</sup> i.i.d random sequences of length <italic>L</italic> = 400, for 9318 profile HMMs built from Pfam 22.0 seed alignments. The sharp black peak is from prototype HMMER3, with mean 0.6928 and standard deviation 0.0114, and extreme outliers indicated by arrows. The broader grey histogram is from old HMMER2, for comparison. The conjectured <italic>λ</italic> = log 2 is shown as a vertical dotted red line. (B,C) log survival plots (<italic>P</italic>(<italic>V</italic>&gt;<italic>t</italic>) on a log scale, versus score threshold <italic>t</italic>) showing observed versus expected distributions for multihit local Viterbi scores for two typical Pfam models, RRM_1 and Caudal_act, for <italic>n</italic> = 10<sup>8</sup> i.i.d. random sequences of length <italic>L</italic> = 400. On a log survival plot, the high-scoring tail of a Gumbel distribution is a straight line with slope −<italic>λ</italic>. Black circles show the observed data. The black lines show maximum likelihood fitted Gumbel distributions, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates as indicated. The red lines show the conjectured <italic>λ</italic> = log 2 Gumbel distributions, with <italic>μ</italic> fitted by maximum likelihood. (D,E) log survival plots for the extreme outliers DUF851 and Sulfakinin, as described in the text.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.g002" xlink:type="simple"/></fig><p>As examples, the top right of <xref ref-type="fig" rid="pcbi-1000069-g002">Figure 2</xref> shows the score distributions for two typical Pfam models, for deep simulations with a 1000-fold larger sample size (10<sup>8</sup> random sequences). As “typical” models, I chose RRM_1 and Caudal_act from Pfam 22.0. The RRM_1 model is the RNA recognition motif, a ∼72 residue domain, chosen because it is one of the Pfam domains I am most familiar with. The Caudal_act domain is the activation domain of the Caudal-like homeobox transcription factors, chosen because it is literally typical for Pfam, being closest to the median of Pfam seed alignments in three different characteristics: number of seed sequences (Pfam 22.0 median = 9; Caudal_act = 9), model length (Pfam median = 147; Caudal_act = 147), and average pairwise identity (Pfam median 36%, Caudal_act = 37%). Both observed distributions show good agreement to the predicted Gumbel of <italic>λ</italic> = log 2.</p><p>I examined outliers in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> to look for models for which the conjectured <italic>λ</italic> = log 2 fails. If the 9318 trials were all truly Gumbel distributed with <italic>λ</italic> = log 2, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e021" xlink:type="simple"/></inline-formula> ratios (parametric over maximum likelihood estimate) should be normally distributed around a mean of 1.0 with standard deviation 0.0025 (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e022" xlink:type="simple"/></inline-formula>, <xref ref-type="bibr" rid="pcbi.1000069-Lawless1">[46]</xref>), so in 9318 trials, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> values should range from about 0.687 to 0.700 (±3.7 s.d.). The observed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e023" xlink:type="simple"/></inline-formula> ratios do show a mean close to 1.0 (1.0008), but an s.d. of 0.0167 (six-fold higher than expected), and the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula>'s range from 0.5828 to 0.8368. This suggests source(s) of variation beyond expected noise of fitting finite samples, and that both low and high outliers are more frequent than expected. The bottom right of <xref ref-type="fig" rid="pcbi-1000069-g002">Figure 2</xref> shows multihit local Viterbi score distributions for the most extreme high and low outliers, Sulfakinin and DUF851, for deep simulations (10<sup>8</sup> random <italic>L</italic> = 400 sequences). In both cases, a similar <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> is reproduced in the second (and deeper) simulation, more evidence that these outlying values are not the result of expected statistical variation in estimation.</p><p>The low outlier DUF851 (and all other low outliers I examined) actually fits better visually to the conjectured <italic>λ</italic> = log 2 than to the maximum likelihood fitted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula>. Low outliers are invariably models where the sequences in the seed alignment are highly identical. This discretizes the model's alignment scores (emission probabilities all converge to 1.0 for all consensus residues, regardless of residue type or model position) leading to a non-smooth score distribution (a stairstep-like effect is often seen, corresponding to local alignments of increasing discrete lengths 1, 2, 3…), and this stairstep gets misfit by maximum likelihood estimation. Low information content models (parameterized by entropy weighting, described later) do not show such outliers (not shown). Thus, for low outliers, the error is attributed to artifacts of maximum likelihood fitting.</p><p>The high outlier Sulfakinin (and all other high outliers I examined) does show a higher <italic>λ</italic> (steeper slope) than the conjectured log 2. A distinctive feature of Sulfakinin compared to other Pfam models is that it is tiny, just <italic>N</italic> = 9 consensus positions long. All other high outliers examined were short models. Finite-length sequence comparisons are expected to show an “edge effect” that increases the apparent <italic>λ</italic> relative to an asymptotic theoretical prediction, and finite-length artifacts are maximal for the shortest query models <xref ref-type="bibr" rid="pcbi.1000069-Altschul6">[20]</xref>. A method for compensating for “edge effect” is discussed later in the paper.</p></sec><sec id="s2f"><title>Local Forward Scores Follow Exponential Tails with Constant <italic>λ</italic></title><p>The Forward score distribution is predicted to converge to an exponential with <italic>λ</italic> = log 2, with the approximation holding above some score threshold <italic>τ</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e024" xlink:type="simple"/></disp-formula></p><p><xref ref-type="fig" rid="pcbi-1000069-g003">Figure 3</xref> shows the results of maximum likelihood fitted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> for exponential tails, for multihit local Forward scores of <italic>n</italic> = 500,000 i.i.d. random sequences of length 400, as a function of fitted tail mass, for 9,318 Pfam 22.0 models. We expect a tradeoff between fitted tail mass and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> accuracy. Convergence to <italic>λ</italic> = log 2 is expected to occur as fitted tail mass decreases (e.g. as threshold <italic>τ</italic> increases), but as <italic>τ</italic> increases, the number of fitted samples decreases, so the accuracy of fitting <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> decreases. This tradeoff is seen in the data, with mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates closely approaching log 2 for tail masses of ≤0.001 or so. A tail mass of 0.001 was chosen as a reasonable tail mass for further characterization of Forward exponential tails.</p><fig id="pcbi-1000069-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000069.g003</object-id><label>Figure 3</label><caption><title>Forward scores follow exponential tails with constant <italic>λ</italic>.</title><p>(A) a graph showing how <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates for exponential distributions asymptote towards the conjectured log 2 as the fitted tail mass decreases. Each open circle is the mean of 9,318 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates, one for each Pfam 22.0 model, fitted by maximum likelihood to the high-scoring tail of multihit local Forward scores for <italic>n</italic> = 10<sup>5</sup> i.i.d random sequences of length <italic>L</italic> = 400, with varying tail mass from 1.0 to 0.0001. Variation in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> is represented by plotting quartiles (black bars) and most extreme outliers (grey triangles) in addition to the means. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> approaches the conjectured log 2 as fitted tail mass decreases, but beyond a certain point, variance increases. A tail mass of 0.001 was chosen as an appropriate tradeoff, and the mean (0.6993), standard deviation (0.0338), and outliers at that choice are annotated. (B,C) log survival plots showing observed (black circles) and expected (red lines) <italic>P</italic>(<italic>F</italic>&gt;<italic>t</italic>) distributions versus score <italic>t</italic> for multihit local Forward scores for the “typical” RRM_1 and Caudal_act models, for <italic>n</italic> = 10<sup>8</sup> i.i.d. random sequences of length <italic>L</italic> = 400. On a log survival plot, an exponential tail is a straight line of slope −<italic>λ</italic>. Black circles show the observed data. The black lines show maximum likelihood exponentials fitted to the 0.001 high-scoring tail, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates as indicated. The red lines show the conjectured <italic>λ</italic> = log 2 exponential tails. (D,E) log survival plots for the extreme outliers Ribosomal_L12 and XYPPX.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.g003" xlink:type="simple"/></fig><p>The top right of <xref ref-type="fig" rid="pcbi-1000069-g003">Figure 3</xref> shows score distributions and expected <italic>λ</italic> = log 2 exponential distribution of the 0.001 tail for deep (<italic>n</italic> = 10<sup>8</sup>) simulations for the “typical” RRM_1 and Caudal_act Pfam models, showing that these fits are visually satisfactory.</p><p>In this case, the survey of 9,318 models has limited power to detect significant outliers. Even with <italic>n</italic> = 500,000 scores, the 0.001 tail contains only 500 points, so <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates will exhibit substantial stochastic variation. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e025" xlink:type="simple"/></inline-formula> is expected to be normally distributed with mean 1.0 and standard deviation 0.045 (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e026" xlink:type="simple"/></inline-formula>, <xref ref-type="bibr" rid="pcbi.1000069-Lawless1">[46]</xref>), and the absolute <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> values are expected to range from about 0.590 to 0.840 (±3.7 s.d.). At the chosen tail mass of 0.001, observed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e027" xlink:type="simple"/></inline-formula> ratios have mean 0.9935 and s.d. 0.0473, with absolute <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> values ranging from 0.5949 to 1.0116. The variance of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates is consistent with expected estimation error on the low side, but there appears to be a higher than expected frequency of large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> values.</p><p>The lower right of <xref ref-type="fig" rid="pcbi-1000069-g003">Figure 3</xref> shows score distributions of deep simulations for the most extreme low and high outliers, Ribosomal_L12 and XYPPX, and their expected exponential tails. In both cases (and in other cases examined), deeper simulations change the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimates, bringing them closer to log 2, suggesting expected statistical estimation error is responsible some of the discrepancies. However, for some models, including these two, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> still remain significantly different from log2; Ribosomal_L12 remains −11 s.d. and XYPPX +25 s.d. away from the expected 1.0 for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e028" xlink:type="simple"/></inline-formula> ratios for exponential tails containing 10<sup>5</sup> scores.</p><p>Some low outliers exhibit the same high-identity, discretized-scores, stairstepping-distribution artifact observed with the Viterbi low outliers (DUF851 for example; not shown), but this explanation does not seem reasonable for Ribosomal_L12, where the observed score distribution appears smooth. The Ribosomal_L12 discrepancy (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> = 0.6688 differs from log 2 by 3.5%) is small and can be neglected in practice, but it is worth noting theoretically, because the Milosavljević result suggests that <italic>λ</italic>&lt;log 2 should not occur. The most obvious thing that is unusual about the Ribosomal_L12 seed alignment is that it has strongly biased residue composition.</p><p>The high outlier XYPPX (and some other high outliers examined) remains a high <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e048" xlink:type="simple"/></inline-formula> estimate in the deeper simulation (the observed 0.7519 is lower than the 0.8413 estimated in the smaller survey, but still +25 s.d. of expected given 10<sup>5</sup> scores in the deeper tail). As with the Viterbi scores, XYPPX and these other high outliers are unusually small models (XYPPX is <italic>N</italic> = 5 consensus residues), and likely to be attributable to finite-length edge effect.</p></sec><sec id="s2g"><title>The Target Length Model: Achieving Distributions Independent of <italic>L</italic></title><p>So far, all target sequences have been a typical length of <italic>L</italic> = 400 residues. However, proteins range in length from a few residues to tens of thousands. One must be able to predict how the expected score distribution depends on target sequence length. For expected Gumbel distributions of traditional optimal local alignment scores, Karlin-Altschul statistics predicts that the location parameter <italic>μ</italic> scales as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e029" xlink:type="simple"/></inline-formula> with query length <italic>N</italic> and target length <italic>L</italic>, and that the <italic>λ</italic> parameter (aside from finite-length edge effects) is independent of target length. That is, for each two-fold increase in target sequence length, the expected score distribution shifts by one bit.</p><p>For the old target length model parameterization in HMMER2 (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e030" xlink:type="simple"/></inline-formula> in the target length model, such that all unannotated residues assigned to N, C, J states score zero, an explicit model of Smith/Waterman's implicit assumptions), the Gumbel distributions for multihit local Viterbi scores follow the specific target length dependence predicted by Karlin-Altschul statistics, as shown in the top left of <xref ref-type="fig" rid="pcbi-1000069-g004">Figure 4</xref> for two typical models. Over a range of target sequence lengths from 25 to 25,600 residues in steps of two-fold, observed score distributions are spaced in steps of one bit.</p><fig id="pcbi-1000069-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000069.g004</object-id><label>Figure 4</label><caption><title>Target length modeling makes distributions length-independent.</title><p>Log survival plots for multihit local Viterbi scores (left; [A,B,E,F]) and multihit local Forward scores (right; [C,D,G,H]) for the two “typical” models RRM_1 and Caudal_act, for <italic>n</italic> = 10<sup>6</sup> i.i.d. random sequences of various lengths, for either old HMMER2 scoring (top; [A–D]) or the new target length model in prototype HMMER3 (bottom; [E–H]). Eleven target sequence lengths are used, ranging from 25 to 25,600 in steps of two-fold, with <italic>L</italic> = 25 shown in red, <italic>L</italic> = 400 shown in black, <italic>L</italic> = 25,600 shown in cyan, and other lengths shown in grey. Each line is the observed log survival plot, collected in 0.1 bit intervals. The grey inset in the HMMER2 Viterbi scores (A,B) shows the length dependence predicted by Karlin/Altschul statistics, with location increasing by one bit for each doubling in target sequence length. The HMMER3 results (bottom; [E–H]) show that both Viterbi and Forward scores are essentially independent of target sequence length in the new parameterization of the target length model, even for the previously problematic multihit Forward scores.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.g004" xlink:type="simple"/></fig><p>However, from a probabilistic inference standpoint, seeing the expected score increase with increasing target sequence length raises a red flag. The posterior probability <italic>P</italic>(<italic>H</italic>|<bold>x</bold>) should not increase as the length of a random target sequence increases. If anything, it should decrease. The more data are available (the longer the target), inference should become more accurate, and the more certain we should be that a random sequence was generated by hypothesis <italic>R</italic>, not hypothesis <italic>H</italic>.</p><p>This concern becomes a practical issue when multihit local Forward score distributions are examined for models using the HMMER2 target length model, as shown in the top right of <xref ref-type="fig" rid="pcbi-1000069-g004">Figure 4</xref>. These score distributions shift unpredictably, and by more than one bit per target length doubling. In absence of theory describing this length dependence, one would have to empirically determine a different exponential tail location parameter <italic>τ</italic> for a range of different target lengths in order to assign accurate E-values to multihit local Forward scores. Although I show later that <italic>τ</italic> is not hard to estimate, this is not desirable. (Unihit local Forward scores do scale by one bit per target length doubling; data not shown.)</p><p>A simple argument about the target length model appears to suffice to explain this behavior. Consider the length distribution generated by models <italic>H</italic> and <italic>R</italic>, given the length model parameters <italic>p</italic>, <italic>q</italic>, and <italic>r</italic>. The probability that model <italic>R</italic> generates a target sequence of length <italic>L</italic> is a geometric density:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e031" xlink:type="simple"/></disp-formula>and the expected length generated by model <italic>R</italic> is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e032" xlink:type="simple"/></disp-formula></p><p>If we assume the length distribution of <italic>H</italic> is dominated by the N, C, J states and the target length model, and that the core model contributes negligible length (an assumption that will be most true for local alignment modes and long <italic>L</italic>), then the probability that model <italic>H</italic> generates a sequence of length <italic>L</italic> is a sum of Pascal distributions:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e033" xlink:type="simple"/></disp-formula>where the index <italic>j</italic> counts over the number of times we start a J segment. The expected length generated by model <italic>H</italic> can be derived from this, using the expectations for Pascal and binomial distributions:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e034" xlink:type="simple"/></disp-formula></p><p>Intuitively, this follows from the fact that the expected number of times that we include a J segment is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e035" xlink:type="simple"/></inline-formula>. Thus, counting the two segments emitted by the N and C states, the total number of unannotated segments is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e036" xlink:type="simple"/></inline-formula>, each of which follows an independent geometric distribution with expected length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e037" xlink:type="simple"/></inline-formula>.</p><p>We can then approximate the component of the log-odds Forward score that is attributable to target length modeling alone:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e038" xlink:type="simple"/><label>(1)</label></disp-formula></p><p>In the case of unihit modes (<italic>q</italic> = 0), this becomes:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e039" xlink:type="simple"/><label>(2)</label></disp-formula>So, when <italic>p</italic> = <italic>r</italic> (HMMER2's old parameterization), for unihit Forward scores, Equation 2 predicts that the target length model's score contribution will increase as log(<italic>L</italic>+1), essentially the same scaling for unihit local Forward scores that Karlin/Altschul statistics predicts for Viterbi (optimal alignment) scores. However, with <italic>p</italic> = <italic>r</italic>, for multihit local Forward scores, Equation 1 predicts that the length model's score contribution will scale as log(<italic>L</italic>+1) at small <italic>L</italic>, but will increase more rapidly at larger <italic>L</italic>. Qualitatively, this appears to be the behavior observed in <xref ref-type="fig" rid="pcbi-1000069-g004">Figure 4</xref> (upper right). Intuitively, the problem is that under a target length model with <italic>p</italic> = <italic>r</italic>, model <italic>H</italic> favors longer sequences than model <italic>R</italic>, because there are at least two states (N,C) generating unannotated segments (plus additional contribution from J states in multihit mode). The longer the target sequence, the more <italic>H</italic> is favored, simply because it generates longer sequences with higher probability than <italic>R</italic>.</p><p>One way to “fix” this behavior would be to set <italic>p</italic> such that model <italic>H</italic> generates the same expected target length as model <italic>R</italic>. For example, in a unihit model, we might set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e040" xlink:type="simple"/></inline-formula>, so that the N and C states each generate a mean length of 175, adding up to the same “typical protein” mean length 350 that <italic>R</italic> generates. But setting any constant <italic>p</italic> and <italic>r</italic> still has problems, because the length model then becomes informative - target sequences of length ∼350 get higher scores than shorter or longer sequences - and this creates a nonlinear dependence of scores on log <italic>L</italic>. In general we probably want target length modeling to be <italic>uninformative</italic>, because target sequence lengths are unpredictable. For example, the target sequence may be a fragment, or a huge multidomain protein.</p><p>How can we set an uninformative target length model? One way to do this is to make the parameterization of models <italic>H</italic> and <italic>R</italic> conditional on the length of the target sequence <italic>L</italic>. That is, as each new target sequence is examined, model <italic>M</italic> and <italic>R</italic> are set on the fly to generate sequences of mean length <italic>L</italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e041" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e042" xlink:type="simple"/></disp-formula></p><p>Under this scheme, according to Equation 1, the length model is predicted to contribute a nearly constant score, independent of target sequence length <italic>L</italic>. Empirically, using this scheme, expected score distributions indeed do become essentially target length independent (<xref ref-type="fig" rid="pcbi-1000069-g004">Figure 4</xref>, bottom) over a wide range of lengths <italic>L</italic>, both for Viterbi and for Forward scoring, and whether the model is configured for unihit or multihit alignment modes.</p><p>Target length independence is an important result. It not only means that single choices of location parameters <italic>μ</italic> and <italic>τ</italic> work for all lengths <italic>L</italic>; it also means that simulations that determine <italic>μ</italic> and <italic>τ</italic> can be done for a small <italic>L</italic>, further decreasing computational cost.</p></sec><sec id="s2h"><title>Fast Determination of Location <italic>τ</italic> for Forward Tails</title><p>For the expected Gumbel distribution of local Viterbi scores, the location parameter <italic>μ</italic> can be determined by a maximum likelihood Gumbel fit <xref ref-type="bibr" rid="pcbi.1000069-Lawless1">[46]</xref> to a small simulation. When <italic>λ</italic> is known, <italic>n</italic> = 200 Viterbi scores of random sequences of <italic>L</italic> = 100 suffices to determine <italic>μ</italic> with a standard deviation of 0.1 bits. This estimation error is within tolerance. We would accept estimated E-values within about two-fold error, corresponding to an accuracy of <italic>μ</italic> of ±1 bit; so if we want less than one estimate in 10,000 to deviate by that much, we want a standard deviation of &lt;0.25 or so. The time required for this simulation is essentially negligible for most purposes. For <italic>n</italic> = 200 sequences of length <italic>L</italic> = 100 and the “typical” Pfam model Caudal_act, it takes about 40 milliseconds to estimate <italic>μ</italic>.</p><p>It is more difficult to efficiently determine the location parameter <italic>τ</italic>, the base of the exponential tail of expected Forward scores. Few samples fall in the small probability mass of the tail. To obtain 200 high-scoring samples in a 0.1% exponential tail, we would still need to score 200,000 simulated random sequences, largely obviating any advantage of knowing <italic>λ</italic>.</p><p>After unsuccessfully exploring several alternative approaches, I adopted the following <italic>ad hoc</italic> method. A Gumbel distribution of <italic>unknown</italic> <italic>λ</italic> is fitted to <italic>n</italic> = 200 Forward scores of random sequences; the Gumbel <italic>μ</italic> and <italic>λ</italic> from this simulation are used to predict the score threshold <italic>t</italic> at which <italic>P</italic>(<italic>F</italic>&gt;<italic>t</italic>) = 0.04 (the 4% tail); this <italic>t</italic> is then taken to be <italic>τ</italic> for the location of the base of the high-scoring 4% Forward score tail. 4% was carefully chosen. Because Forward scores are not Gumbel distributed, and appear fat-tailed with respect to a maximum likelihood fitted Gumbel of unknown <italic>λ</italic>, the true tail mass <italic>P</italic>(<italic>F</italic>&gt;<italic>t</italic>) is systematically underestimated by a Gumbel fit. On the other hand, because the Forward survival curve approaches its exponential asymptote of <italic>λ</italic> = log <italic>z</italic> from above, if we did accurately estimate <italic>P</italic>(<italic>F</italic>&gt;<italic>τ</italic>) at low score thresholds and used that to locate the base of our exponential tail, that exponential tail would overestimate (be above) the tail probability mass at higher scores. The choice of 4% was optimized by trial and error as a point at which these opposing systematic errors are well balanced; the fitted exponential tail deliberately underestimates <italic>P</italic>(<italic>F</italic>&gt;<italic>t</italic>) at lower scores where the Forward distribution still appears fat-tailed, in order to become accurate in the highest-scoring tail (<italic>P</italic>(<italic>F</italic>&gt;<italic>t</italic>)&lt;0.001 or so) where the Forward distribution has converged to an exponential.</p><p>Using <italic>n</italic> = 200 Forward scores of random sequences of <italic>L</italic> = 100 suffices to determine <italic>τ</italic> with a standard deviation of 0.2 bits, and costs 330 msec for the “typical” Caudal_act model.</p></sec><sec id="s2i"><title>Finite-Length “Edge Effect” on <italic>λ</italic></title><p>For Karlin/Altschul statistics, the apparent <italic>λ</italic> for finite-length comparisons is known to increase for smaller sequences and weaker (lower relative entropy) scoring systems. Intuitively, finite length edge effect arises because the number of places that an alignment can start while still achieving a given length is less than <italic>NL</italic>, and achieving the highest scores requires the longest alignments (so the higher scoring alignments have fewer start points available), and weaker average scores per position require longer alignments to reach a given total score; thus higher-scoring alignments “see” a smaller search space than lower-scoring alignments, so the probability of higher-scoring alignments is lower – the tail of the distribution falls off faster – than the asymptotic <italic>λ</italic> predicts. Edge effect has significant impact on BLAST's statistics and substantial effort has been made to correct for it <xref ref-type="bibr" rid="pcbi.1000069-Altschul6">[20]</xref>.</p><p>In most of the results in <xref ref-type="fig" rid="pcbi-1000069-g002">Figures 2</xref>–<xref ref-type="fig" rid="pcbi-1000069-g003"/><xref ref-type="fig" rid="pcbi-1000069-g004">4</xref>, edge effect is not particularly apparent. However, these models have high relative entropy per position (about 1.8 bits per match state emission distribution, compared to about 0.7 bits per aligned residue pair for BLAST's default BLOSUM62 substitution scores). High relative entropy per position results from the standard multinomial estimation procedures used for parameterizing the core profile HMM <xref ref-type="bibr" rid="pcbi.1000069-Krogh1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Sjlander1">[47]</xref>, but has been shown to compromise the sensitivity of profile HMMs <xref ref-type="bibr" rid="pcbi.1000069-Johnson1">[27]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Karplus2">[43]</xref>. We have confirmed previous observations that even an <italic>ad hoc</italic> method to reduce the relative entropy per position (“entropy-weighting”; <xref ref-type="bibr" rid="pcbi.1000069-Karplus2">[43]</xref>) greatly improves search sensitivity in HMMER <xref ref-type="bibr" rid="pcbi.1000069-Johnson1">[27]</xref>, although, puzzlingly, the same effect was not seen by PSI-BLAST's authors <xref ref-type="bibr" rid="pcbi.1000069-Schffer1">[48]</xref>. Empirically, on a benchmark of structural homologs <xref ref-type="bibr" rid="pcbi.1000069-Madera1">[49]</xref>, an optimal target relative entropy using entropy-weighting is about 0.6 bits per match state <xref ref-type="bibr" rid="pcbi.1000069-Johnson1">[27]</xref>. When entropy-weighted HMMER models are used, the apparent <italic>λ</italic>'s for both Viterbi and Forward scores deviate slightly upwards from the conjectured <italic>λ</italic> = log <italic>z</italic>. Consistent with an edge effect interpretation <xref ref-type="bibr" rid="pcbi.1000069-Altschul6">[20]</xref>, the magnitude of this deviation is inversely proportional both to the length of the query <italic>N</italic> and to the average relative entropy per match state emission distribution; on the other hand, the effect does not appear to depend as strongly on the target length <italic>L</italic> (data not shown).</p><p>Two different approaches have been developed for correcting for edge effect. One approach is to use corrected query and target sequence lengths <italic>N</italic>′ = <italic>N</italic>−ℓ, <italic>L</italic>′ = <italic>L</italic>−ℓ, where ℓ is the expected length of an alignment <xref ref-type="bibr" rid="pcbi.1000069-Altschul4">[9]</xref>. Another approach is to apply a small correction to <italic>λ</italic>, using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e043" xlink:type="simple"/></inline-formula>, where <italic>λ</italic> is the true (asymptotic) value, and α is empirically determined but clearly related to the inverse of the relative entropy per position <xref ref-type="bibr" rid="pcbi.1000069-Altschul6">[20]</xref>.</p><p>I experimented with setting an edge-corrected target length model such that the flanking nonhomology states generate <italic>L</italic>′ = <italic>L</italic>−ℓ residues for various schemes of determining an appropriate average local alignment length ℓ, but without satisfactory results. The expected alignment length length ℓ has a complicated dependence on the model, the alignment score, and the query and target lengths. In particular, my schemes tended to break down severely in the small target sequence length regime <italic>L</italic>≃ℓ.</p><p>Applying a correction to <italic>λ</italic> proved more successful. I estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e044" xlink:type="simple"/></inline-formula>, where <italic>h</italic> is the average relative entropy per match state emission distribution, and the 1.44 factor was empirically determined from slopes of lines fitted to <italic>λ</italic> versus <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e045" xlink:type="simple"/></inline-formula> plots for models of varying <italic>h</italic>. Thus for typical Pfam models (<italic>N</italic>∼140) parameterized with standard profile HMM multinomial/Dirichlet maximum a posteriori estimation (<italic>h</italic>∼1.8) the correction is small (0.6931+0.0057), but for short and/or entropy-weighted models the edge effect correction has non-negligible effect.</p><p>This is only an empirically derived correction. It appears to suffice in practice, but there is clearly more going on here. A more satisfying and theoretically grounded accounting for edge effects in probabilistic local alignment is needed.</p></sec><sec id="s2j"><title>Accuracy of E-Value Determination for Profile HMMs</title><p>In summary, the overall procedure for estimating the expected score distributions is to assume <italic>λ</italic> = log2, determine an edge-corrected effective lambda <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e046" xlink:type="simple"/></inline-formula> for a query model of length <italic>N</italic> and relative entropy per match state emission <italic>h</italic>, and run two small simulations (<italic>L</italic> = 100, <italic>n</italic> = 200) to determine location parameters <italic>μ</italic> and <italic>τ</italic> for the Viterbi score Gumbel distribution and the Forward score exponential tail. Because I added <italic>ad hoc</italic> steps (the edge effect correction and the methods for determining <italic>μ</italic> and <italic>τ</italic>) on top of the conjectures about <italic>λ</italic>, one now wants to know, when the complete procedure is put together, how accurate are the resulting E-values for profile HMM searches?</p><p><xref ref-type="fig" rid="pcbi-1000069-g005">Figure 5</xref> shows the results of searching 9,318 Pfam 22.0 models (either parameterized by the standard approach, or using entropy-weighting to yield lower information content models), against three different databases of 10<sup>5</sup> random sequences, of lengths <italic>L</italic> = 100, 400, and 1600, collecting multihit local Viterbi and Forward scores, and plotting predicted E-value for the top 1000 scoring hits versus rank. If E-value estimation were perfect, we expect these points to disperse around a straight line of slope 1 (the E-value of the top hit should be 1, the E-value of the 10th ranked hit should be 10, and so on). As expected, the mean predicted E-values are indeed tightly dispersed around a straight line of slope 1. Each mean is derived from 9,318 trials, so we expect the outlying minimum E-value for the top-ranking score to be on the order of 1/9318, or about 1×10<sup>−4</sup>. The minimum predicted E-values for each of the six searches (Forward vs. Viterbi, three choices of length) range from 2.2×10<sup>−4</sup> down to 3.7×10<sup>−6</sup>, basically within expectation (the 3.7×10<sup>−6</sup> is significantly low, but just barely so; <italic>P</italic> = 0.03 to occur by chance in 9,318 trials). Some small systematic deviations from expectation can be seen on close examination, the most significant of which is in the Viterbi scores of entropy-weighted models for long (<italic>L</italic> = 400 and <italic>L</italic> = 1600) target sequences: this is where the apparent “edge effect” of low information content models is having its greatest impact.</p><fig id="pcbi-1000069-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000069.g005</object-id><label>Figure 5</label><caption><title>Accuracy of E-value determination.</title><p>Plots of predicted E-value versus actual rank, for multihit local Viterbi scores (A,C) and multihit local Forward scores (B,D), using models with either the standard profile HMM multinomial parameterization used in the rest of the paper (A,B) or “entropy-weighted” models of reduced information content (C,D). Each plotted point (open circles) is the mean of 9,318 profile HMM searches of <italic>n</italic> = 10<sup>5</sup> target sequences of three different target lengths: <italic>L</italic> = 100 (red), <italic>L</italic> = 400 (black), and <italic>L</italic> = 1,600 (cyan). The extreme outliers for each point are shown by squares and dotted vertical lines. (Interquartile ranges are smaller than the circles plotted for the means.) The expected result, of E-value equal to observed rank, is shown as a black line. Displayed text shows means and standard deviations for predicted E-values of the top-ranked score in each search, which should be (and is) about 1.0.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000069.g005" xlink:type="simple"/></fig><p>Though statistically significant errors in E-value accuracy remain, for practical purposes they are tolerably small. Moreover, they are almost invariably in the conservative direction. That is, we would rather slightly underestimate <italic>λ</italic> than overestimate it. If we underestimate <italic>λ</italic>, we overestimate E-values and miss some true positive homologs without compromising our false positive rate. A design goal of HMMER is to accurately estimate and control false positive rates in large-scale automated analyses.</p></sec></sec><sec id="s3"><title>Discussion</title><p>The most immediate benefits from this work are that for profile HMM searches, the statistical significance of both Viterbi and Forward scores can be calculated efficiently without expensive simulation. This enables substantial accelerations in the use of Viterbi scores, and more importantly, it opens the way to a broader use of more powerful Forward scores.</p><p>Although I have done the simulations in the specific context of HMMER, the local alignment model is not specific to HMMER. It is a generalized probabilistic local alignment model with a uniform entry/exit distribution. Because position-independent substitution matrix scores and gap costs are just a special case of position-specific profile scores, the same model can be used to parameterize standard Smith/Waterman local alignments <xref ref-type="bibr" rid="pcbi.1000069-Smith1">[44]</xref> probabilistically. From a computational standpoint, optimal (Viterbi) local alignment for profile HMMs is essentially identical to Smith/Waterman alignment, with the same <italic>O</italic>(<italic>NL</italic>) computational complexity, and the Forward algorithm is a minor modification of Viterbi (replacing max operations with sums). Existing profile HMM implementations are two orders of magnitude slower than BLAST, but this is only because they are still using full dynamic programming (so running times are comparable to other unaccelerated Smith/Waterman implementations). There is no reason why the same heuristics that BLAST uses to accelerate Smith/Waterman cannot be applied to accelerate profile HMM searches. Similarly, existing nonprobabilistic sequence alignment methods, including BLAST, can be modified (with the addition of a few transition parameters) to accomodate the probabilistic parameterization described here.</p><p>The same conjectures are also expected to hold for local alignment scores for probability models of more than just linear sequence alignment. For example, our preliminary results indicate that local alignment scores for profile stochastic-context free grammars (SCFGs; models of RNA structure and sequence) obey the same conjectures for both CYK and Inside scores (analogous to local Viterbi and Forward scores) (DL Kolbe and SRE, unpublished results), which should help in efficiently and accurately calculating E-values for profile SCFG searches for structural RNAs <xref ref-type="bibr" rid="pcbi.1000069-Eddy2">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Nawrocki1">[50]</xref>.</p><p>However, at least three important points limit any conclusions I can try to draw about how widely the conjectures might hold.</p><p>First, the same conjectures ought to hold for glocal and global alignment models. Nothing in the conjectures' rationale required the probabilistic models <italic>H</italic> and <italic>R</italic> to be configured in any particular way. However, based on previous work on glocal and global alignment scores, it is unlikely that these score distributions are going to exhibit a <italic>λ</italic> = log <italic>z</italic> simple exponential tail for biologically relevant model and sequence lengths <xref ref-type="bibr" rid="pcbi.1000069-Kann1">[45]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Webber1">[51]</xref>. Indeed, in preliminary experiments I have observed glocal score distributions converging to <italic>λ</italic> = log <italic>z</italic> Gumbels for Viterbi scores and <italic>e</italic><sup>−<italic>t</italic> log z</sup> exponential tails for Forward scores only for the smallest HMMs, the largest target sequences, and the most extreme tails <italic>E</italic>&lt;&lt;1. This may suggest that the conjectures hold only asymptotically, with glocal or global alignment score distributions converging slower than local score distributions.</p><p>Second, if any probabilistic local alignment model <italic>H</italic> should work, why would the prototype HMMER3 profile HMM architecture and parameterization be necessary to obtain these results, compared to HMMER2's local alignment scores? This again indicates that score distributions are more sensitive to details of model parameterization than the conjectures' generality would suggest. I believe the uniform local entry/exit distribution to be the important difference, again possibly because this makes score distributions reach asymptotic behaviors more quickly. However, I have not dissected the two implementations and tested specific differences one at a time, because it is not feasible to emulate HMMER2 in HMMER3's implementation (and vice versa). Moreover, perhaps inconsistent with my thinking, the other popular profile HMM software package, SAM, uses a nonprobabilistic strategy of scoring zero for local entry/exit by analogy to Smith/Waterman, which ought to produce an implicit uniform entry/exit distribution, but the SAM implementors have gone away from assuming a fixed <italic>λ</italic> (using Milosavljević's algorithmic significance test) and now use simulation-calibrated E-values instead <xref ref-type="bibr" rid="pcbi.1000069-Karplus1">[29]</xref>.</p><p>Third, it is trivial to produce an example of a probabilistic model <italic>H</italic> that gives expected score distributions deviating strongly from the conjectures: set <italic>H</italic> = <italic>R</italic>, and all log odds ratio scores become zero (and thus <italic>λ</italic> = ∞). The conjectures must break down as the relative entropy between <italic>H</italic> and <italic>R</italic> approaches zero.</p><p>These issues show the main limitation of the simulation-based approach I have taken. Proper understanding of the regimes in which the conjectures break down requires a mathematical analysis, not simulations limited to a particular problem domain. Such analysis would be desirable, and it could lead in fruitful new directions. For example, the fact that HMMER3 glocal score distributions do appear to asymptote towards the conjectures (albeit not for a practical range of tail probability mass nor query and target lengths) seems promising. A general approach for estimating statistical significance of global or glocal gapped alignment scores, under traditional (arbitrary) scoring systems, largely remains elusive, despite significant effort and progress <xref ref-type="bibr" rid="pcbi.1000069-Kann1">[45]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Webber1">[51]</xref>. Perhaps – though this is only a guess – such problems could become more amenable to mathematical analysis under the simplifying constraints imposed by a fully probabilistic scoring system. For example, the troublesome “log-linear transition” of traditional alignment scores <xref ref-type="bibr" rid="pcbi.1000069-Waterman1">[52]</xref> never occurs; the expected score of extending a full probabilistic alignment by an additional residue is always nonpositive.</p><p>Another problem that will need more attention is finite length effects. The finite length edge effect described for BLAST scores <xref ref-type="bibr" rid="pcbi.1000069-Altschul6">[20]</xref> is not the only finite length effect that can impact score distributions. Another is that there is a maximum score threshold (i.e., the score of a global, ungapped, 100% identical alignment) beyond which the probability of a higher score is just zero, so expected distributions will deviate down as they approach this maximum score threshold. In typical sequence alignments, where both the query and the target are on the order of hundreds of residues, this effect is negligible. In profile HMMs, however, where some Pfam models are quite short (as small as <italic>N</italic> = 5), a maximum score effect appears to be in play, especially for unihit mode models with low information content (entropy-weighted) parameters. Fortunately, any such errors will be in the conservative direction, compromising sensitivity instead of specificity (HMMER would overestimate E-values for such models).</p><p>This work was partly inspired by the work of Yu and Hwa, who described a “hybrid” (or “semi-probabilistic”) scoring method that gives Gumbel-distributed scores with <italic>λ</italic> = log <italic>z</italic> <xref ref-type="bibr" rid="pcbi.1000069-Yu1">[28]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Yu3">[53]</xref>. Hybrid scoring essentially amounts to taking the maximum score of the cells in the Forward dynamic programming matrix. In HMMER3, I also observe Gumbel-distributed hybrid scores with <italic>λ</italic> = log <italic>z</italic> (data not shown). The three scoring systems appear to differ in their susceptibility to finite length effects that increase in low information content models. The distribution of Forward scores seems more robust than Viterbi scores (this is seen in <xref ref-type="fig" rid="pcbi-1000069-g004">Figures 4</xref> and <xref ref-type="fig" rid="pcbi-1000069-g005">5</xref>), and in preliminary experiments, hybrid scores appear to be even more robust (data not shown). This might account for why they turned to hybrid scores rather than standard Viterbi or Forward scores to achieve what they dubbed “universal statistics” (meaning constant <italic>λ</italic>).</p><p>I have taken care to distinguish Viterbi from Forward scores, and local from glocal or global alignment modes, all of which are just choices in the same full probabilistic modeling framework. Some prior work has conflated probabilistic modeling and Forward scoring, referring to Forward scores as “probabilistic alignment scores” and arguing that probabilistic alignment scores do not follow Gumbel distributions as opposed to traditional alignment scores <xref ref-type="bibr" rid="pcbi.1000069-Yu1">[28]</xref>, but Viterbi scores are also probabilistic. Other prior work has argued that HMMER scores do not follow expected Gumbel statistics <xref ref-type="bibr" rid="pcbi.1000069-Madera1">[49]</xref>, but HMMER2's default mode is multihit glocal, not local (local alignment requires a command line option). As it happens, HMMER2 does fit a left-censored Gumbel as a best-effort approximation of the glocal score distribution, and because this is known to be inaccurate, it attempts to focus the fit to achieve highest accuracy at the critical <italic>E</italic>∼1 region where accurate significance estimation is important; this means that HMMER2 multihit glocal (default) mode E-values are overestimated for <italic>E</italic>&lt;&lt;1, underestimated for <italic>E</italic>&gt;&gt;1, and most accurate in the <italic>E</italic>∼1 region, which others have observed empirically <xref ref-type="bibr" rid="pcbi.1000069-Kann1">[45]</xref>.</p><p>Although most homology search methods are based on local alignment, our previous internal HMMER2 benchmarks and benchmarks of other methods <xref ref-type="bibr" rid="pcbi.1000069-Kann1">[45]</xref> have suggested that glocal alignment is more sensitive and specific when conserved protein domains can be defined <italic>a priori</italic> (as in protein domain databases like Pfam, SMART, and CDD <xref ref-type="bibr" rid="pcbi.1000069-Finn1">[25]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Letunic1">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-MarchlerBauer1">[54]</xref>). On the other hand, even with predefined domain boundaries, occasional cases of conserved subdomains and truncated database sequences make it unwise to rely solely on glocal searches. For these reasons, HMMER2 has defaulted to glocal mode, and Pfam search servers report an <italic>ad hoc</italic> merge of glocal and local search results. We have wanted to find a way around the need to run two searches to trade off the better statistics and robustness to unusual cases of local mode versus the better average sensitivity of glocal mode. Following results of Karplus and coworkers <xref ref-type="bibr" rid="pcbi.1000069-Karplus2">[43]</xref>, we have recently observed that much of our previously observed difference between local and glocal mode power results from local alignments being much more sensitive to the information content of the query. When we introduce parameterization methods for controlling the model's average information content per position (such as “entropy weighting” <xref ref-type="bibr" rid="pcbi.1000069-Karplus2">[43]</xref>), sensitivity benchmarks of HMMER local and glocal modes become comparable <xref ref-type="bibr" rid="pcbi.1000069-Johnson1">[27]</xref>. I am not so concerned any more that local alignment mode will be sacrificing significant search power relative to glocal mode, and I am currently planning for HMMER3 to default to local. Whether HMMER3 will implement glocal alignment mode and glocal E-value statistics remains undecided.</p><p>It is important to distinguish generative probabilistic models of local alignment from other “probabilistic” local alignment methods that apply renormalization and partition functions to interpret traditional arbitrary scores as unnormalized log-odds probabilities <xref ref-type="bibr" rid="pcbi.1000069-Yu1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1000069-Miyazawa1">[35]</xref>–<xref ref-type="bibr" rid="pcbi.1000069-Webb1">[38]</xref>. In a generative model, <italic>λ</italic> is explicitly log <italic>z</italic>, where <italic>z</italic> is the base of the log used to convert probability parameters to log odds scores. In renormalization-based approaches, the original arbitrary scores and their distribution are unchanged, so determining distribution parameters like <italic>λ</italic> is no simpler than in BLAST or Smith/Waterman – essentially, in a renormalization approach, one must still determine the unknown implicit probabilistic basis of the arbitrary scoring system, which means determining <italic>λ</italic> <xref ref-type="bibr" rid="pcbi.1000069-Altschul5">[13]</xref>.</p><p>A limitation of this work is that I have only examined scores of independent, identically distributed (i.i.d.) random sequences with a single typical amino acid composition. Real sequences often have biased residue composition, repetitive regions, and other heterogeneities that can produce spurious high-scoring aligments, requiring additional methods to compensate <xref ref-type="bibr" rid="pcbi.1000069-Karplus1">[29]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Schffer1">[48]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Yu4">[55]</xref>. It will be necessary to confirm previous observations that the same sorts of methods apply to Forward scores, not just to optimal alignment scores <xref ref-type="bibr" rid="pcbi.1000069-Karplus1">[29]</xref>. Additionally, the probabilistic inference framework admits an interesting alternative, which is to develop better explicit probabilistic models of nonhomologs (hypothesis <italic>R</italic>), not just of homologs (hypothesis <italic>H</italic>).</p><p>From a purist Bayesian perspective <xref ref-type="bibr" rid="pcbi.1000069-Jaynes1">[33]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-MacKay1">[34]</xref>,<xref ref-type="bibr" rid="pcbi.1000069-Liu1">[56]</xref>, one might question why we need E-values and classical statistical significance tests at all. Shouldn't a posterior probability be sufficient? It would be, if model <italic>H</italic> were an accurate model of the sequence space of remote homologs we want to detect. However, query sequence(s) are rarely an unbiased sample from the desired space of homologs. Our model <italic>H</italic> usually represents a narrow clade of known query sequences, not the broader space of homologs we want to detect. Presented with a remote homolog, the model may correctly assign it a low posterior probability (it doesn't look like it belongs to the same sequence space as our query sequences), but nonetheless, it may have a higher score than one expected by chance. A purist would say that this just shows that our model is inaccurately parameterized for our problem. This is certainly true, but better parameterization requires evolutionary models that can extrapolate what remote homologs will look like, and this has proven to be a difficult problem. Most current probabilistic evolutionary models neglect important inhomogeneities in the evolutionary process, like heterotachy (rate variation between branches), and have so far proven in our hands to be insufficient in schemes for increasing profile HMM sensitivity (Alex Coventry and SRE, unpublished results). E-values and classical statistical significance testing are of immediate utility, while development of more useful probabilistic evolutionary models remains a focus for the future.</p></sec><sec id="s4"><title>Methods</title><p>The HMMER3 prototype source code (together with Easel, a code library that HMMER depends on) is freely available at <ext-link ext-link-type="uri" xlink:href="http://selab.janelia.org/publications/#Eddy08" xlink:type="simple">http://selab.janelia.org/publications/#Eddy08</ext-link> under the terms of the open source GNU General Public License. This source tarball includes a 00README file with detailed command-line scripts for reproducing the results in the figures. The Pfam database is freely available at <ext-link ext-link-type="uri" xlink:href="http://pfam.janelia.org" xlink:type="simple">http://pfam.janelia.org</ext-link>. The simulation results are generated by the <italic>hmmsim</italic> program, which takes a profile HMM as input, generates and scores <italic>n</italic> random i.i.d. sequences, and outputs scores, statistics, and input files for the freely available <italic>GRACE</italic> graph plotting program (<ext-link ext-link-type="uri" xlink:href="http://plasma-gate.weizmann.ac.il/Grace/" xlink:type="simple">http://plasma-gate.weizmann.ac.il/Grace/</ext-link>). Maximum likelihood fitting of Gumbel and exponential distributions is implemented in the <italic>gumbel</italic> and <italic>exponential</italic> modules of Easel, respectively, following methods in <xref ref-type="bibr" rid="pcbi.1000069-Lawless1">[46]</xref>.</p><p>In HMMER3's implementation, the local entry/exit distribution is in fact not completely uniform, for the following reason. Imagine (as an extreme illustration) a profile HMM with a “consensus” match state <italic>M<sub>k</sub></italic> that is never reached, because the (<italic>M</italic>,<italic>D</italic>)<italic><sub>k</sub></italic><sub>−1</sub>→<italic>M<sub>k</sub></italic> transition probabilities are zero, and imagine that this “dead” match state generates a residue that is for some reason never seen in homologs. If the local alignment model imposed a uniform entry/exit distribution, allowing an entry transition straight into the dead <italic>M<sub>k</sub></italic> state, then local alignments can contain the impossible residue. To avoid this, HMMER <italic>ad hoc</italic> weights the local entry probabilities into states <italic>M<sub>k</sub></italic> by the probability that each <italic>M<sub>k</sub></italic> is used in sequences generated from the model. Because by default HMMER assigns consensus match states to alignment columns that contain ≥50% residues as opposed to gap characters, the usage of each match state is generally similar and high, so the effect of this weighting is normally small (less than two-fold difference between any pair of entry positions <italic>k</italic>).</p><p>It was necessary to implement HMMER3 dynamic programming routines as floating point calculations. In the target length model, a ratio like <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000069.e047" xlink:type="simple"/></inline-formula> approaches 1.0 for large <italic>L</italic>, and roundoff/truncation error becomes an issue. The precision of HMMER2's internal scaled integer log-odds scores (in units of 0.001 bits) proved insufficient.</p><p>All computational times mentioned in the paper are measured for a single execution thread on a 3.2 GHz Intel Xeon (Dempsey) CPU, using prototype HMMER3 code compiled with the GNU C compiler (gcc) version 3.4.5 with a -O2 optimization level, running a Red Hat Enterprise Linux AS release 4 operating system.</p></sec></body><back><ack><p>This work was initiated by many discussions, and was aided by some key contributions to HMMER's codebase. In particular, Bob Edgar (University of Californica Santa Cruz) and Bill Bruno (Los Alamos) both pointed out flaws in the HMMER2 local entry/exit distribution; Steve Johnson (Washington University) implemented entropy weighting methods and benchmarked Forward scores in HMMER as part of his Ph.D. thesis work; Alex Coventry (Howard Hughes Medical Institute Janelia Farm) first suggested that the extreme Forward tail appeared to be exponential; and Jeremy Buhler and Christopher Swope (Washington University) contributed highly optimized implementations of the profile HMM Viterbi and Forward algorithms which I adapted to the local model described here. I am especially endebted to Elena Rivas for her mathematical insights and forceful arguments.</p></ack><ref-list><title>References</title><ref id="pcbi.1000069-Durbin1"><label>1</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Mitchison</surname><given-names>GJ</given-names></name></person-group>             <year>1998</year>             <source>Biological sequence analysis: probabilistic models of proteins and nucleic acids</source>             <publisher-loc>Cambridge, UK</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>             <fpage>356</fpage>          </element-citation></ref><ref id="pcbi.1000069-Altschul1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name><name name-style="western"><surname>Schaffer</surname><given-names>AA</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><etal/></person-group>             <year>1997</year>             <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs.</article-title>             <source>Nucl Acids Res</source>             <volume>25</volume>             <fpage>3389</fpage>             <lpage>3402</lpage>          </element-citation></ref><ref id="pcbi.1000069-Krogh1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Mian</surname><given-names>IS</given-names></name><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name><name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name></person-group>             <year>1994</year>             <article-title>Hidden Markov models in computational biology: applications to protein modeling.</article-title>             <source>J Mol Biol</source>             <volume>235</volume>             <fpage>1501</fpage>             <lpage>1531</lpage>          </element-citation></ref><ref id="pcbi.1000069-Altschul2"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Boguski</surname><given-names>MS</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>Wooton</surname><given-names>JC</given-names></name></person-group>             <year>1994</year>             <article-title>Issues in searching molecular sequence databases.</article-title>             <source>Nature Genetics</source>             <volume>6</volume>             <fpage>119</fpage>             <lpage>129</lpage>          </element-citation></ref><ref id="pcbi.1000069-Mitrophanov1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mitrophanov</surname><given-names>AY</given-names></name><name name-style="western"><surname>Borodovsky</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Statistical significance in biological sequence analysis.</article-title>             <source>Brief Bioinform</source>             <volume>7</volume>             <fpage>2</fpage>             <lpage>24</lpage>          </element-citation></ref><ref id="pcbi.1000069-Altschul3"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name></person-group>             <year>1990</year>             <article-title>Basic local alignment search tool.</article-title>             <source>J Mol Biol</source>             <volume>215</volume>             <fpage>403</fpage>             <lpage>410</lpage>          </element-citation></ref><ref id="pcbi.1000069-Karlin1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name></person-group>             <year>1990</year>             <article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>87</volume>             <fpage>2264</fpage>             <lpage>2268</lpage>          </element-citation></ref><ref id="pcbi.1000069-Karlin2"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karlin</surname><given-names>S</given-names></name><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name></person-group>             <year>1993</year>             <article-title>Applications and statistics for multiple high-scoring segments in molecular sequences.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>90</volume>             <fpage>5873</fpage>             <lpage>5877</lpage>          </element-citation></ref><ref id="pcbi.1000069-Altschul4"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name></person-group>             <year>1996</year>             <article-title>Local alignment statistics.</article-title>             <source>Meth Enzymol</source>             <volume>266</volume>             <fpage>460</fpage>             <lpage>480</lpage>          </element-citation></ref><ref id="pcbi.1000069-Park1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Park</surname><given-names>J</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Barrett</surname><given-names>C</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name><name name-style="western"><surname>Haussler</surname><given-names>D</given-names></name><etal/></person-group>             <year>1998</year>             <article-title>Sequence comparisons using multiple sequences detect three times as many remote homologues as pairwise methods.</article-title>             <source>J Mol Biol</source>             <volume>284</volume>             <fpage>1201</fpage>             <lpage>1210</lpage>          </element-citation></ref><ref id="pcbi.1000069-Edgar1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name></person-group>             <year>2004</year>             <article-title>A comparison of scoring functions for protein sequence profile alignment.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>1301</fpage>             <lpage>1308</lpage>          </element-citation></ref><ref id="pcbi.1000069-Pearson1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pearson</surname><given-names>WR</given-names></name><name name-style="western"><surname>Sierk</surname><given-names>ML</given-names></name></person-group>             <year>2005</year>             <article-title>The limits of protein sequence comparison?</article-title>             <source>Curr Opin Struct Biol</source>             <volume>15</volume>             <fpage>254</fpage>             <lpage>260</lpage>          </element-citation></ref><ref id="pcbi.1000069-Altschul5"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name></person-group>             <year>1991</year>             <article-title>Amino acid substitution matrices from an information theoretic perspective.</article-title>             <source>J Mol Biol</source>             <volume>219</volume>             <fpage>555</fpage>             <lpage>565</lpage>          </element-citation></ref><ref id="pcbi.1000069-Mott1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mott</surname><given-names>R</given-names></name></person-group>             <year>1992</year>             <article-title>Maximum likelihood estimation of the statistical distribution of Smith–Waterman local sequence similarity scores.</article-title>             <source>Bull Math Biol</source>             <volume>54</volume>             <fpage>59</fpage>             <lpage>75</lpage>          </element-citation></ref><ref id="pcbi.1000069-Drasdo1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Drasdo</surname><given-names>D</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name><name name-style="western"><surname>Lassig</surname><given-names>M</given-names></name></person-group>             <year>1998</year>             <article-title>A statistical theory of sequence alignment with gaps.</article-title>             <source>Proc Int Conf Intell Syst Mol Biol</source>             <volume>6</volume>             <fpage>52</fpage>             <lpage>58</lpage>          </element-citation></ref><ref id="pcbi.1000069-Mott2"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mott</surname><given-names>R</given-names></name><name name-style="western"><surname>Tribe</surname><given-names>R</given-names></name></person-group>             <year>1999</year>             <article-title>Approximate statistics of gapped alignments.</article-title>             <source>J Comput Biol</source>             <volume>6</volume>             <fpage>91</fpage>             <lpage>112</lpage>          </element-citation></ref><ref id="pcbi.1000069-Olsen1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Olsen</surname><given-names>R</given-names></name><name name-style="western"><surname>Bundschuh</surname><given-names>R</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>             <year>1999</year>             <article-title>Rapid assessment of extremal statistics for gapped local alignment.</article-title>             <source>Proc Int Conf Intell Syst Mol Biol</source>             <volume>7</volume>             <fpage>211</fpage>             <lpage>222</lpage>          </element-citation></ref><ref id="pcbi.1000069-Mott3"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mott</surname><given-names>R</given-names></name></person-group>             <year>2000</year>             <article-title>Accurate formula for P-values of gapped local sequence and profile alignments.</article-title>             <source>J Mol Biol</source>             <volume>300</volume>             <fpage>649</fpage>             <lpage>659</lpage>          </element-citation></ref><ref id="pcbi.1000069-Siegmund1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Siegmund</surname><given-names>D</given-names></name><name name-style="western"><surname>Yakir</surname><given-names>B</given-names></name></person-group>             <year>2000</year>             <article-title>Approximate P-values for local sequence alignments.</article-title>             <source>The Annals of Statistics</source>             <volume>28</volume>             <fpage>657</fpage>             <lpage>680</lpage>          </element-citation></ref><ref id="pcbi.1000069-Altschul6"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Bundschuh</surname><given-names>R</given-names></name><name name-style="western"><surname>Olsen</surname><given-names>R</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>             <year>2001</year>             <article-title>The estimation of statistical parameters for local alignment score distributions.</article-title>             <source>Nucl Acids Res</source>             <volume>29</volume>             <fpage>351</fpage>             <lpage>361</lpage>          </element-citation></ref><ref id="pcbi.1000069-Storey1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Storey</surname><given-names>JD</given-names></name><name name-style="western"><surname>Siegmund</surname><given-names>D</given-names></name></person-group>             <year>2001</year>             <article-title>Approximate P-values for local sequence alignments: Numerical studies.</article-title>             <source>J Comput Biol</source>             <volume>8</volume>             <fpage>549</fpage>             <lpage>556</lpage>          </element-citation></ref><ref id="pcbi.1000069-Bundschuh1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bundschuh</surname><given-names>R</given-names></name></person-group>             <year>2002</year>             <article-title>Rapid significance estimation in local sequence alignment with gaps.</article-title>             <source>J Comput Biol</source>             <volume>9</volume>             <fpage>243</fpage>             <lpage>260</lpage>          </element-citation></ref><ref id="pcbi.1000069-Chia1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chia</surname><given-names>N</given-names></name><name name-style="western"><surname>Bundschuh</surname><given-names>R</given-names></name></person-group>             <year>2006</year>             <article-title>A practical approach to significance assessment in alignment with gaps.</article-title>             <source>J Comput Biol</source>             <volume>13</volume>             <fpage>429</fpage>             <lpage>441</lpage>          </element-citation></ref><ref id="pcbi.1000069-Metzler1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Metzler</surname><given-names>D</given-names></name></person-group>             <year>2006</year>             <article-title>Robust E-values for gapped local alignments.</article-title>             <source>J Comput Biol</source>             <volume>13</volume>             <fpage>882</fpage>             <lpage>896</lpage>          </element-citation></ref><ref id="pcbi.1000069-Finn1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Finn</surname><given-names>RD</given-names></name><name name-style="western"><surname>Mistry</surname><given-names>J</given-names></name><name name-style="western"><surname>Schuster-Bockler</surname><given-names>B</given-names></name><name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name><name name-style="western"><surname>Hollich</surname><given-names>V</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Pfam: clans, web tools and services.</article-title>             <source>Nucl Acids Res</source>             <volume>34</volume>             <fpage>D247</fpage>             <lpage>D251</lpage>          </element-citation></ref><ref id="pcbi.1000069-Letunic1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Letunic</surname><given-names>I</given-names></name><name name-style="western"><surname>Copley</surname><given-names>RR</given-names></name><name name-style="western"><surname>Pils</surname><given-names>B</given-names></name><name name-style="western"><surname>Pinkert</surname><given-names>S</given-names></name><name name-style="western"><surname>Schultz</surname><given-names>J</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>SMART 5: domains in the context of genomes and networks.</article-title>             <source>Nucl Acids Res</source>             <volume>34</volume>             <fpage>D257</fpage>             <lpage>D260</lpage>          </element-citation></ref><ref id="pcbi.1000069-Johnson1"><label>27</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>S</given-names></name></person-group>             <year>2006</year>             <source>Remote protein homology detection using hidden Markov models</source>             <publisher-name>PhD thesis, Washington University School of Medicine</publisher-name>             <fpage>92</fpage>          </element-citation></ref><ref id="pcbi.1000069-Yu1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y-K</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>             <year>2001</year>             <article-title>Statistical significance of probabilistic sequence alignment and related local hidden Markov models.</article-title>             <source>J Comput Biol</source>             <volume>8</volume>             <fpage>249</fpage>             <lpage>282</lpage>          </element-citation></ref><ref id="pcbi.1000069-Karplus1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Karchin</surname><given-names>R</given-names></name><name name-style="western"><surname>Shackelford</surname><given-names>G</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name></person-group>             <year>2005</year>             <article-title>Calibrating E-values for hidden Markov models using reverse-sequence null models.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <fpage>4107</fpage>             <lpage>4115</lpage>          </element-citation></ref><ref id="pcbi.1000069-Eddy1"><label>30</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>             <year>2007</year>             <article-title>HMMER - biosequence analysis using profile hidden Markov models.</article-title>             <comment>Available: <ext-link ext-link-type="uri" xlink:href="http://hmmer.janelia.org/" xlink:type="simple">http://hmmer.janelia.org/</ext-link></comment>          </element-citation></ref><ref id="pcbi.1000069-Pertsemlidis1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pertsemlidis</surname><given-names>A</given-names></name><name name-style="western"><surname>Fondon</surname><given-names>JW</given-names><suffix>III</suffix></name></person-group>             <year>2001</year>             <article-title>Having a BLAST with bioinformatics (and avoiding BLASTphemy).</article-title>             <source>Genome Biol</source>             <volume>2</volume>             <fpage>reviews2002.1</fpage>             <lpage>reviews2002.10</lpage>          </element-citation></ref><ref id="pcbi.1000069-Eddy2"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>             <year>2002</year>             <article-title>Computational genomics of noncoding RNA genes.</article-title>             <source>Cell</source>             <volume>109</volume>             <fpage>137</fpage>             <lpage>140</lpage>          </element-citation></ref><ref id="pcbi.1000069-Jaynes1"><label>33</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jaynes</surname><given-names>ET</given-names></name></person-group>             <year>2003</year>             <source>Probability theory: the logic of science</source>             <publisher-loc>Cambridge, UK</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>             <fpage>727</fpage>          </element-citation></ref><ref id="pcbi.1000069-MacKay1"><label>34</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>MacKay</surname><given-names>DJC</given-names></name></person-group>             <year>2003</year>             <source>Information theory, inference, and learning algorithms</source>             <publisher-loc>Cambridge, UK</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>             <fpage>628</fpage>          </element-citation></ref><ref id="pcbi.1000069-Miyazawa1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Miyazawa</surname><given-names>S</given-names></name></person-group>             <year>1995</year>             <article-title>A reliable sequence alignment method based on probabilities of residue correspondences.</article-title>             <source>Protein Eng</source>             <volume>8</volume>             <fpage>999</fpage>             <lpage>1009</lpage>          </element-citation></ref><ref id="pcbi.1000069-Zhang1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>MQ</given-names></name><name name-style="western"><surname>Marr</surname><given-names>TG</given-names></name></person-group>             <year>1995</year>             <article-title>Alignment of molecular sequences seen as random path analysis.</article-title>             <source>J Theor Biol</source>             <volume>174</volume>             <fpage>119</fpage>             <lpage>129</lpage>          </element-citation></ref><ref id="pcbi.1000069-Bucher1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bucher</surname><given-names>P</given-names></name><name name-style="western"><surname>Hofmann</surname><given-names>K</given-names></name></person-group>             <year>1996</year>             <article-title>A sequence similarity search algorithm based on a probabilistic interpretation of an alignment scoring system.</article-title>             <source>Proc Int Conf Intell Syst Mol Biol</source>             <volume>4</volume>             <fpage>44</fpage>             <lpage>51</lpage>          </element-citation></ref><ref id="pcbi.1000069-Webb1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Webb</surname><given-names>BJ</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>2002</year>             <article-title>BALSA: Bayesian algorithm for local sequence alignment.</article-title>             <source>Nucl Acids Res</source>             <volume>30</volume>             <fpage>1268</fpage>             <lpage>1277</lpage>          </element-citation></ref><ref id="pcbi.1000069-Gumbel1"><label>39</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gumbel</surname><given-names>EJ</given-names></name></person-group>             <year>1958</year>             <source>Statistics of extremes</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Columbia University Press</publisher-name>             <fpage>375</fpage>          </element-citation></ref><ref id="pcbi.1000069-Milosavljevi1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Milosavljević</surname><given-names>A</given-names></name><name name-style="western"><surname>Jurka</surname><given-names>J</given-names></name></person-group>             <year>1993</year>             <article-title>Discovering simple DNA sequences by the algorithmic significance method.</article-title>             <source>Comput Applic Biosci</source>             <volume>9</volume>             <fpage>407</fpage>             <lpage>411</lpage>          </element-citation></ref><ref id="pcbi.1000069-Barrett1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Barrett</surname><given-names>C</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name></person-group>             <year>1997</year>             <article-title>Scoring hidden Markov models.</article-title>             <source>Comput Applic Biosci</source>             <volume>13</volume>             <fpage>191</fpage>             <lpage>199</lpage>          </element-citation></ref><ref id="pcbi.1000069-Yu2"><label>42</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y-K</given-names></name><name name-style="western"><surname>Bundschuh</surname><given-names>R</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>             <year>2002</year>             <article-title>Statistical significance and extremal ensemble of gapped local hybrid alignment.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Lässig</surname><given-names>M</given-names></name><name name-style="western"><surname>Valleriani</surname><given-names>A</given-names></name></person-group>             <source>Biological evolution and statistical physics, volume 585 of <italic>Lecture Notes in Physics</italic></source>             <publisher-loc>Berlin</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>             <fpage>3</fpage>             <lpage>21</lpage>          </element-citation></ref><ref id="pcbi.1000069-Karplus2"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Barrett</surname><given-names>C</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name></person-group>             <year>1998</year>             <article-title>Hidden Markov models for detecting remote protein homologies.</article-title>             <source>Bioinformatics</source>             <volume>14</volume>             <fpage>846</fpage>             <lpage>856</lpage>          </element-citation></ref><ref id="pcbi.1000069-Smith1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name></person-group>             <year>1981</year>             <article-title>Identification of common molecular subsequences.</article-title>             <source>J Mol Biol</source>             <volume>147</volume>             <fpage>195</fpage>             <lpage>197</lpage>          </element-citation></ref><ref id="pcbi.1000069-Kann1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kann</surname><given-names>MG</given-names></name><name name-style="western"><surname>Sheetlin</surname><given-names>SL</given-names></name><name name-style="western"><surname>Park</surname><given-names>Y</given-names></name><name name-style="western"><surname>Bryant</surname><given-names>SH</given-names></name><name name-style="western"><surname>Spouge</surname><given-names>JL</given-names></name></person-group>             <year>2007</year>             <article-title>The identification of complete domains within protein sequences using accurate E-values for semi-global alignment.</article-title>             <source>Nucl Acids Res</source>             <volume>35</volume>             <fpage>4678</fpage>             <lpage>4685</lpage>          </element-citation></ref><ref id="pcbi.1000069-Lawless1"><label>46</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lawless</surname><given-names>JF</given-names></name></person-group>             <year>1982</year>             <source>Statistical models and methods for lifetime data</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>John Wiley &amp; Sons</publisher-name>             <fpage>580</fpage>          </element-citation></ref><ref id="pcbi.1000069-Sjlander1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sjölander</surname><given-names>K</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>K</given-names></name><name name-style="western"><surname>Brown</surname><given-names>M</given-names></name><name name-style="western"><surname>Hughey</surname><given-names>R</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><etal/></person-group>             <year>1996</year>             <article-title>Dirichlet mixtures: a method for improving detection of weak but significant protein sequence homology.</article-title>             <source>Comput Applic Biosci</source>             <volume>12</volume>             <fpage>327</fpage>             <lpage>345</lpage>          </element-citation></ref><ref id="pcbi.1000069-Schffer1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schäffer</surname><given-names>AA</given-names></name><name name-style="western"><surname>Aravind</surname><given-names>L</given-names></name><name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name><name name-style="western"><surname>Shavirin</surname><given-names>S</given-names></name><name name-style="western"><surname>Spouge</surname><given-names>JL</given-names></name><etal/></person-group>             <year>2001</year>             <article-title>Improving the accuracy of PSI-BLAST protein database searches with composition-based statistics and other refinements.</article-title>             <source>Nucl Acids Res</source>             <volume>29</volume>             <fpage>2994</fpage>             <lpage>3005</lpage>          </element-citation></ref><ref id="pcbi.1000069-Madera1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Madera</surname><given-names>M</given-names></name><name name-style="western"><surname>Gough</surname><given-names>J</given-names></name></person-group>             <year>2002</year>             <article-title>A comparison of profile hidden Markov model procedures for remote homology detection.</article-title>             <source>Nucl Acids Res</source>             <volume>30</volume>             <fpage>4321</fpage>             <lpage>4328</lpage>          </element-citation></ref><ref id="pcbi.1000069-Nawrocki1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Nawrocki</surname><given-names>EP</given-names></name><name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name></person-group>             <year>2007</year>             <article-title>Query-dependent banding (QDB) for faster RNA similarity searches.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e56</fpage>          </element-citation></ref><ref id="pcbi.1000069-Webber1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Webber</surname><given-names>C</given-names></name><name name-style="western"><surname>Barton</surname><given-names>GJ</given-names></name></person-group>             <year>2001</year>             <article-title>Estimation of P-values for global alignments of protein sequences.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>1158</fpage>             <lpage>1167</lpage>          </element-citation></ref><ref id="pcbi.1000069-Waterman1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name><name name-style="western"><surname>Gordon</surname><given-names>L</given-names></name><name name-style="western"><surname>Arratia</surname><given-names>R</given-names></name></person-group>             <year>1987</year>             <article-title>Phase transitions in sequence matches and nucleic acid structure.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>84</volume>             <fpage>1239</fpage>             <lpage>1243</lpage>          </element-citation></ref><ref id="pcbi.1000069-Yu3"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y-K</given-names></name><name name-style="western"><surname>Bundschuh</surname><given-names>R</given-names></name><name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name></person-group>             <year>2002</year>             <article-title>Hybrid alignment: high-performance with universal statistics.</article-title>             <source>Bioinformatics</source>             <volume>18</volume>             <fpage>864</fpage>             <lpage>872</lpage>          </element-citation></ref><ref id="pcbi.1000069-MarchlerBauer1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Marchler-Bauer</surname><given-names>A</given-names></name><name name-style="western"><surname>Anderson</surname><given-names>JB</given-names></name><name name-style="western"><surname>Derbyshire</surname><given-names>MK</given-names></name><name name-style="western"><surname>DeWeese-Scott</surname><given-names>C</given-names></name><name name-style="western"><surname>Gonzales</surname><given-names>NR</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>CDD: a conserved domain database for interactive domain family analysis.</article-title>             <source>Nucl Acids Res</source>             <volume>35</volume>             <fpage>D237</fpage>             <lpage>D240</lpage>          </element-citation></ref><ref id="pcbi.1000069-Yu4"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>Y-K</given-names></name><name name-style="western"><surname>Wootton</surname><given-names>JC</given-names></name><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name></person-group>             <year>2003</year>             <article-title>The compositional adjustment of amino acid substitution matrices.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>100</volume>             <fpage>15688</fpage>             <lpage>15693</lpage>          </element-citation></ref><ref id="pcbi.1000069-Liu1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name><name name-style="western"><surname>Lawrence</surname><given-names>CE</given-names></name></person-group>             <year>1999</year>             <article-title>Bayesian inference on biopolymer models.</article-title>             <source>Bioinformatics</source>             <volume>15</volume>             <fpage>38</fpage>             <lpage>52</lpage>          </element-citation></ref></ref-list></back></article>