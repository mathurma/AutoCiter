<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01921</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004135</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Reconstructible Phylogenetic Networks: Do Not Distinguish the Indistinguishable</article-title>
<alt-title alt-title-type="running-head">Phylogenetic Networks: What Can Be Reconstructed</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Pardi</surname> <given-names>Fabio</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Scornavacca</surname> <given-names>Celine</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Laboratoire d’Informatique, de Robotique et de Microélectronique de Montpellier (LIRMM, UMR 5506) CNRS, Université de Montpellier, France</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Institut des Sciences de l’Evolution de Montpellier (ISE-M, UMR 5554) CNRS, IRD, Université de Montpellier, France</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Institut de Biologie Computationnelle, Montpellier, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Holland</surname> <given-names>Barbara R</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Tasmania, Australia</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Wrote the paper: FP CS. Conceived the question: FP CS. Proved the main formal results: FP.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">fabio.pardi@lirmm.fr</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>7</day>
<month>4</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>4</issue>
<elocation-id>e1004135</elocation-id>
<history>
<date date-type="received">
<day>25</day>
<month>10</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>19</day>
<month>1</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Pardi, Scornavacca</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004135" xlink:type="simple"/>
<abstract>
<p>Phylogenetic networks represent the evolution of organisms that have undergone reticulate events, such as recombination, hybrid speciation or lateral gene transfer. An important way to interpret a phylogenetic network is in terms of the trees it displays, which represent all the possible histories of the characters carried by the organisms in the network. Interestingly, however, different networks may display exactly the same set of trees, an observation that poses a problem for network reconstruction: from the perspective of many inference methods such networks are indistinguishable. This is true for all methods that evaluate a phylogenetic network solely on the basis of how well the displayed trees fit the available data, including all methods based on input data consisting of clades, triples, quartets, or trees with any number of taxa, and also sequence-based approaches such as popular formalisations of maximum parsimony and maximum likelihood for networks. This identifiability problem is partially solved by accounting for branch lengths, although this merely reduces the frequency of the problem. Here we propose that network inference methods should only attempt to reconstruct what they can uniquely identify. To this end, we introduce a novel definition of what constitutes a uniquely reconstructible network. For any given set of indistinguishable networks, we define a canonical network that, under mild assumptions, is unique and thus representative of the entire set. Given data that underwent reticulate evolution, only the canonical form of the underlying phylogenetic network can be uniquely reconstructed. While on the methodological side this will imply a drastic reduction of the solution space in network inference, for the study of reticulate evolution this is a fundamental limitation that will require an important change of perspective when interpreting phylogenetic networks.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>We consider here an elementary question for the inference of phylogenetic networks: what networks can be reconstructed. Indeed, whereas in theory it is always possible to reconstruct a phylogenetic tree, given sufficient data for this task, the same does not hold for phylogenetic networks: most notably, the relative order of consecutive reticulate events cannot be determined by standard network inference methods. This problem has been described before, but no solutions to deal with it have been put forward. Here we propose limiting the space of reconstructible phylogenetic networks to what we call “canonical networks”. We formally prove that each network has a (usually unique) canonical form—where a number of nodes and branches are merged—representing all that can be uniquely reconstructed about the original network. Once a canonical network <inline-formula id="pcbi.1004135.e001"><alternatives><graphic id="pcbi.1004135.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e001"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is inferred, it must be kept in mind that—even with perfect and unlimited data—the true phylogenetic network is just one of the potentially many networks having <inline-formula id="pcbi.1004135.e002"><alternatives><graphic id="pcbi.1004135.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula> as canonical form. This is an important difference to what biologists are used to for phylogenetic trees, where in principle it is always possible to resolve uncertainties, given enough data.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by a PEPS BMI 2013 grant (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.cnrs.fr/mi/spip.php?article315">http://www.cnrs.fr/mi/spip.php?article315</ext-link>) from the Centre Nationale de la Recherche Scientifique. This publication is contribution no. 2015-011 of the Institut des Sciences de l’Evolution de Montpellier (ISEM, UMR 5554). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="14"/>
<table-count count="0"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p><italic>Explicit</italic> [<xref ref-type="bibr" rid="pcbi.1004135.ref001">1</xref>] or <italic>evolutionary</italic> [<xref ref-type="bibr" rid="pcbi.1004135.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref003">3</xref>] phylogenetic networks are used to represent the evolution of organisms or genes that may inherit genetic material from more than one source. This may be caused by events such as hybrid speciation (e.g. in plants and animals [<xref ref-type="bibr" rid="pcbi.1004135.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref005">5</xref>]), horizontal gene transfer (e.g. in bacteria [<xref ref-type="bibr" rid="pcbi.1004135.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref007">7</xref>]), viral reassortment [<xref ref-type="bibr" rid="pcbi.1004135.ref008">8</xref>], or recombination (e.g. in viruses [<xref ref-type="bibr" rid="pcbi.1004135.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref010">10</xref>] or in the genomes of sexually reproducing species [<xref ref-type="bibr" rid="pcbi.1004135.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1004135.ref013">13</xref>]). They are called “explicit” to distinguish them from “implicit” [<xref ref-type="bibr" rid="pcbi.1004135.ref014">14</xref>], “abstract” [<xref ref-type="bibr" rid="pcbi.1004135.ref001">1</xref>] or “data-display” [<xref ref-type="bibr" rid="pcbi.1004135.ref003">3</xref>] phylogenetic networks, which are used to display collections of alternative evolutionary hypotheses supported by conflicting signals in the data. In explicit networks, multiple-inheritance events are represented as <italic>reticulations</italic>, that is, nodes where two or more lineages converge to give rise to a new lineage, whose genetic material is a combination of that of its direct ancestors.</p>
<p>Explicit networks can be interpreted in terms of classic, tree-like evolution: if we focus on a single, indivisible and thus non-recombining inherited character (for example a single site in a DNA sequence), its history is still best described by a tree. This observation gives rise to the notion of <italic>trees displayed by a network</italic>, which are all the possible single-character histories implied by a phylogenetic network. (See, e.g., <xref ref-type="fig" rid="pcbi.1004135.g001">Fig. 1</xref>, where <italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub> and <italic>T</italic><sub>3</sub> are the trees displayed by networks <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub>. Formal definitions are in the Results section.)</p>
<fig id="pcbi.1004135.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Indistinguishable network topologies.</title>
<p>The network topologies <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> are indistinguishable to most current approaches for network reconstruction, as they display the same tree topologies <italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub> and <italic>T</italic><sub>3</sub>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g001"/>
</fig>
<p>Several works in the last few years have focused on the methodology for phylogenetic network inference, and data-display networks in particular have begun to make a real impact on the everyday practice of biologists (e.g., [<xref ref-type="bibr" rid="pcbi.1004135.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1004135.ref017">17</xref>]). There remains, however, a strong demand for automatic reconstruction of networks that not only display conflicting signals in the data, but also seek to explain these signals with explicit inferences of past reticulation events (see, e.g., [<xref ref-type="bibr" rid="pcbi.1004135.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004135.ref020">20</xref>]). This is evidenced, for example, by the abundance of manually reconstructed networks in the literature [<xref ref-type="bibr" rid="pcbi.1004135.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1004135.ref027">27</xref>]. As a result of this demand, the inference of explicit networks is now a rapidly growing field of research [<xref ref-type="bibr" rid="pcbi.1004135.ref001">1</xref>].</p>
<p>Some paradigms in the proposed methodology are beginning to emerge. Not surprisingly, the notion of trees displayed by a phylogenetic network plays a central role: the general idea is to evaluate the fit of a network <italic>N</italic> with the data <italic>indirectly</italic>—on the basis of how well the trees displayed by <italic>N</italic> explain the data. In the following, we describe how this applies to the two main approaches for explicit network reconstruction: consistency-based approaches (see [<xref ref-type="bibr" rid="pcbi.1004135.ref028">28</xref>] for a survey)—seeking a network consistent with a number of prior evolutionary inferences (typically trees or groupings of taxa)—and sequence-based approaches, such as standard formulations of maximum parsimony and maximum likelihood for networks [<xref ref-type="bibr" rid="pcbi.1004135.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1004135.ref033">33</xref>].</p>
<p>Although evaluating a network via the trees it displays is evolutionarily meaningful, it has a problematic consequence: from the perspective of these reconstruction methods, all networks displaying the same set of trees are “indistinguishable”, as the function that these methods seek to optimize will always assign the same score to all networks displaying the same set of trees, regardless of the input data. In other words, the central parameter of phylogenetic network inference, the network itself, is in some cases not identifiable.</p>
<sec id="sec002">
<title>An Identifiability Problem</title>
<p>As an example, consider again networks <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g001">Fig. 1</xref>, which display the same trees 𝓣(<italic>N</italic>) = {<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, <italic>T</italic><sub>3</sub>}. (In the following, 𝓣(<italic>N</italic>) denotes the set of trees displayed by <italic>N</italic>.) By displaying the same trees, these networks display the same clades, the same triples, the same quartets (triples and quartets are rooted subtrees with 3 leaves and unrooted subtrees with 4 leaves, respectively) and in general the same subtrees with an arbitrary number of leaves. Therefore, any method that reconstructs a network based on its consistency with collections of such data will not be able to distinguish between networks <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub>. This includes all the methods whose data consists of clusters of taxa (e.g., [<xref ref-type="bibr" rid="pcbi.1004135.ref034">34</xref>]), triples (e.g., [<xref ref-type="bibr" rid="pcbi.1004135.ref035">35</xref>]), quartets (e.g., [<xref ref-type="bibr" rid="pcbi.1004135.ref036">36</xref>]), or any trees (e.g., [<xref ref-type="bibr" rid="pcbi.1004135.ref037">37</xref>]).</p>
<p>The same holds for many, sequence-based, maximum parsimony and maximum likelihood approaches proposed in recent papers. For maximum parsimony, a practical approach [<xref ref-type="bibr" rid="pcbi.1004135.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1004135.ref031">31</xref>] is to consider that the input is partitioned in a number of alignments <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, …, <italic>A</italic><sub><italic>m</italic></sub>, each from a different non-recombining genomic region (possibly consisting of just one site each), and then take, for each of these alignments, the best parsimony score <bold>Ps</bold>(<italic>T</italic>∣<italic>A</italic><sub><italic>i</italic></sub>) among all those of the trees displayed by a network <italic>N</italic>. The parsimony score of <italic>N</italic> is then the sum of all the parsimony scores thus obtained. Formally, we have
<disp-formula id="pcbi.1004135.e003"><alternatives><graphic id="pcbi.1004135.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e003"/><mml:math id="M3" mode="display" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">Ps</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munder><mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>𝓣</mml:mi> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mi mathvariant="bold">Ps</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
It is clear that if two networks display the same set of trees (as in <xref ref-type="fig" rid="pcbi.1004135.g001">Fig. 1</xref>), then their parsimony score with respect to any input alignments will be the same—because they take the minimum value over the same set 𝓣(<italic>N</italic>)—and thus they are indistinguishable to any method based on the maximum parsimony principle above.</p>
<p>As for maximum likelihood (ML), Nakhleh and collaborators [<xref ref-type="bibr" rid="pcbi.1004135.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref038">38</xref>] have proposed an elegant framework whereby a phylogenetic network <italic>N</italic> is not only described by a network topology, but also edge lengths and inheritance probabilities associated to the reticulations of <italic>N</italic>. As a result, any tree <italic>T</italic> displayed by <italic>N</italic> has edge lengths—allowing the calculation of its likelihood <bold>Pr</bold>(<italic>A</italic>∣<italic>T</italic>) with respect to any alignment <italic>A</italic>—and an associated probability of being observed <bold>Pr</bold>(<italic>T</italic>∣<italic>N</italic>). The likelihood function with respect to a set of alignments <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, …, <italic>A</italic><sub><italic>m</italic></sub>, each from a different non-recombining genomic region, is then given by:
<disp-formula id="pcbi.1004135.e004"><alternatives><graphic id="pcbi.1004135.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e004"/><mml:math id="M4" mode="display" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">Pr</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:mi mathvariant="bold">Pr</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>𝓣</mml:mi> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mi mathvariant="bold">Pr</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="bold">Pr</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Note that an important difference with the consistency-based and parsimony methods described above is that any tree <italic>T</italic> displayed by a network has now edge lengths and an associated probability <bold>Pr</bold>(<italic>T</italic>∣<italic>N</italic>).</p>
<p>Unfortunately, this ML framework is also subject to identifiability problems. For example, it does not allow us to distinguish between networks with topologies <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g001">Fig. 1</xref>: for every assignment of edge lengths and inheritance probabilities to <italic>N</italic><sub>1</sub>, there exist corresponding assignments to <italic>N</italic><sub>2</sub> that make the resulting networks indistinguishable, that is, displaying the same trees, with the same edge lengths and the same probabilities of being observed (see the last section in the Supporting Information, <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref>). As a result, the likelihoods of these two networks will be identical, regardless of the data, and no method based on this definition of likelihood will be able to favour one of them over the other. We refer to <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref> for a more detailed discussion about networks with inheritance probabilities and likelihood-based reconstruction.</p>
<p>In general, we believe that these identifiability problems affect all network inference methods which seek consistency with unordered collections of sequence alignments or pre-inferred attributes such as clusters, triples, quartets or trees.</p>
</sec>
<sec id="sec003">
<title>The Importance of Edge Lengths</title>
<p>In this paper, as in the ML framework above, we adopt networks and trees with edge lengths as the primary objects of our study. The primary motivation for this is that this choice makes our results directly relevant to the statistical approaches for network inference, all of which need edge lengths to measure the fit of a phylogeny with the available data. In addition to ML, these approaches include distance-based and Bayesian methods [<xref ref-type="bibr" rid="pcbi.1004135.ref039">39</xref>], which are also promising for future work.</p>
<p>However, there is another motivation for our choice: accounting for edge lengths solves some of the identifiability problems outlined above, as in some cases it allows to distinguish between networks with different topologies, which would be otherwise impossible to tell apart. For example, consider the three network topologies in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref> (top), where taxon <italic>o</italic> is an outgroup used to identify the root of the phylogeny for <italic>a</italic>, <italic>b</italic> and <italic>c</italic>. These networks show three very different evolutionary histories: in <italic>N</italic><sub>1</sub> taxon <italic>b</italic> is the only one issued of a reticulation event—in other words the genome of <italic>b</italic> is recombinant—whereas in <italic>N</italic><sub>2</sub> and <italic>N</italic><sub>3</sub>, it is <italic>a</italic> and <italic>c</italic>, respectively, that are recombinant. However, <italic>N</italic><sub>1</sub>, <italic>N</italic><sub>2</sub> and <italic>N</italic><sub>3</sub> display the same tree topologies—those of <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub>—and thus would be indistinguishable to any approach that does not model edge lengths.</p>
<fig id="pcbi.1004135.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Edge lengths are informative to distinguish among different network topologies.</title>
<p>The only network topology, among <italic>N</italic><sub>1</sub>, <italic>N</italic><sub>2</sub> and <italic>N</italic><sub>3</sub> that can display simultaneously <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> with the indicated edge lengths is <italic>N</italic><sub>2</sub>: see for example the edge lengths assignment in the bottom right corner.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g002"/>
</fig>
<p>If instead edge lengths are accounted for (e.g. in a ML context) and the data supports <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> with the edge lengths in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref>, then the only network fitting perfectly the data is <italic>N</italic><sub>2</sub>, with the edge lengths in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref> (bottom right). It is easy to check that <italic>N</italic><sub>2</sub> now displays <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> with the shown edge lengths, whereas no edge length assignment to <italic>N</italic><sub>1</sub> or <italic>N</italic><sub>3</sub> can make these networks display <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub>.</p>
<p>We note that, throughout this paper, as in classical likelihood approaches, edge lengths measure evolutionary divergence, for example in terms of expected number of substitutions per site. No molecular clock is assumed, meaning that we do not expect edge lengths to be proportional to time.</p>
</sec>
<sec id="sec004">
<title>Remaining Identifiability Problems, and a Proposed Solution</title>
<p>Unfortunately, accounting for edge lengths only solves some of the identifiability problems for phylogenetic networks. Consider networks <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref>: for any set of edge lengths for <italic>N</italic><sub>1</sub>, there exist an infinity of edge length assignments for <italic>N</italic><sub>2</sub> that make these two networks display exactly the same set of trees with the same edge lengths. In the following, we say that networks such as <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> are <italic>indistinguishable</italic>.</p>
<fig id="pcbi.1004135.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Two networks with edge lengths <italic>N</italic><sub>1</sub>, <italic>N</italic><sub>2</sub> displaying the same set of trees 𝓣(<italic>N</italic><sub>1</sub>) = 𝓣(<italic>N</italic><sub>2</sub>) = {<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, <italic>T</italic><sub>3</sub>}.</title>
<p>For any choice of edge lengths <italic>λ</italic><sub>1</sub>, <italic>λ</italic><sub>2</sub>, …, <italic>λ</italic><sub>12</sub> for <italic>N</italic><sub>1</sub>, we define a family of edge length assignments for <italic>N</italic><sub>2</sub>, parameterized by <italic>x</italic>, <italic>y</italic> (with -y &lt; <italic>x</italic> &lt; min{<italic>λ</italic><sub>6</sub>, <italic>λ</italic><sub>5</sub> + <italic>λ</italic><sub>8</sub>}, 0 &lt; <italic>y</italic> &lt; <italic>λ</italic><sub>7</sub>).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g003"/>
</fig>
<p>In fact it is not difficult to construct other examples of indistinguishable networks: each time a network has a reticulation <italic>v</italic> giving birth to only one edge (i.e. with outdegree 1), then we can reduce by Δ<italic>λ</italic> the length of this edge and correspondingly increase by Δ<italic>λ</italic> the lengths of the edges ending in <italic>v</italic>, without altering the set of trees displayed by the network. Note that this operation, which we refer to as “unzipping” reticulation <italic>v</italic>, can result in <italic>v</italic> coinciding with a speciation node or a leaf when Δ<italic>λ</italic> is taken to equal the length of the edge going out of <italic>v</italic>. For example in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref>, one may fully unzip the two reticulation nodes in <italic>N</italic><sub>1</sub>, thus obtaining the network <italic>N</italic>′ of <xref ref-type="fig" rid="pcbi.1004135.g004">Fig. 4</xref>. As expected, <italic>N</italic><sub>1</sub> and <italic>N</italic>′ display the same set of trees ({<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, <italic>T</italic><sub>3</sub>}) and are thus indistinguishable. What is most interesting in this example is that, if we fully unzip the two reticulations in <italic>N</italic><sub>2</sub> (the other network in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref>, also displaying {<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, <italic>T</italic><sub>3</sub>}), then we eventually end up obtaining <italic>N</italic>′ again. As we shall see in the following, this is not a coincidence: the unzipping transformations described above lead to what we call the <italic>canonical form</italic> of a network; under mild assumptions, two networks are indistinguishable if and only if they have the same canonical form (e.g. <italic>N</italic><sub>1</sub>, <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref> have the same canonical form <italic>N</italic>′; formal definitions and statements in the Results section).</p>
<fig id="pcbi.1004135.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Canonical form of <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref>.</title>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g004"/>
</fig>
<p>Here, we propose to deal with the identifiability issues for phylogenetic networks in the following way: since no data will ever enable any of the standard inference methods described above to prefer a network over all of its indistinguishable equivalents, we propose that these methods <italic>should only attempt to reconstruct what they can uniquely identify</italic>, that is, networks in canonical form. This is a radical shift, not only for the developers of phylogenetic inference methods, who will see a drastic reduction of the solution space of their algorithms, but also for evolutionary biologists, who should abandon their hopes of seeing a network such as <italic>N</italic><sub>1</sub> or <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref> being reconstructed by these inference methods.</p>
</sec>
<sec id="sec005">
<title>Previous Work and Comparison</title>
<p>Limiting the scope of network reconstruction to topologically-constrained classes of networks has been a recurring theme and an important goal in the literature on phylogenetic networks. Examples of such classes include <italic>galled trees</italic> [<xref ref-type="bibr" rid="pcbi.1004135.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref041">41</xref>], <italic>galled networks</italic> [<xref ref-type="bibr" rid="pcbi.1004135.ref042">42</xref>], <italic>level-k networks</italic> [<xref ref-type="bibr" rid="pcbi.1004135.ref043">43</xref>], <italic>tree-child networks</italic> [<xref ref-type="bibr" rid="pcbi.1004135.ref044">44</xref>], <italic>tree-sibling networks</italic> [<xref ref-type="bibr" rid="pcbi.1004135.ref045">45</xref>], networks with <italic>visible reticulations</italic> [<xref ref-type="bibr" rid="pcbi.1004135.ref001">1</xref>]. Although the ultimate goal should be to establish what can be inferred from biological data, most of the proposed definitions are computationally-motivated: in general the rationale behind these classes is the possibility of devising an efficient algorithm to solve some formalization of the reconstruction problem. None of these definitions claims to have biological significance.</p>
<p>Our goals are more basic: starting from the observation that not all phylogenetic networks are identifiable, since many of them are mutually indistinguishable with most inference approaches, we aim to define a class of networks that is (<italic>existence</italic> goal) large enough that every phylogenetic network has an equivalent (i.e. indistinguishable) network within this class and (<italic>distinguishability</italic> goal) small enough that no two networks within this class are indistinguishable. From our standpoint, the computationally-motivated definitions above are at the same time too broad and too restrictive. Too broad, because they determine a set of networks that includes many pairs of indistinguishable networks: for example the three indistinguishable networks in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref> are all galled trees—and thus belong to every single one of the classes mentioned above (which are all generalizations of galled trees). Too restrictive, because these classes of networks do not include simple networks that it should be possible to reconstruct from real data. For example, <xref ref-type="fig" rid="pcbi.1004135.g005">Fig. 5a</xref> shows a network <italic>N</italic> with edge lengths that is not tree-sibling, nor has the visible property, and thus is not galled, nor tree-child (for definitions, see [<xref ref-type="bibr" rid="pcbi.1004135.ref001">1</xref>]), but which in practice should be reconstructible: apart from the lengths of three edges (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>), <italic>N</italic> is uniquely determined by the trees that it displays (a consequence of the formal results that we will show in the following), meaning that, given large amounts of data strongly supporting each of these (seven) trees with their correct edge lengths, any method for network inference properly accounting for edge lengths (e.g. based on ML) should be able to reconstruct <italic>N</italic>, or its canonical form <italic>N</italic>′.</p>
<fig id="pcbi.1004135.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Examples of networks that can be uniquely recovered from the data they generate, despite being excluded by many proposed definitions of reconstructible networks.</title>
<p>(<italic>a</italic>) A network <italic>N</italic>, and its canonical form <italic>N</italic>′, whose topologies are not galled trees, nor galled, tree-child, tree-sibling or regular networks, nor networks with visible reticulations. <italic>N</italic>, however, is uniquely determined by the trees it displays, with the exception of <italic>x</italic>, <italic>y</italic> and <italic>z</italic>, which can assume any value between 0 and 0.1. Because of the impossibility to determine these values, the canonical form <italic>N</italic>′ has the corresponding edges collapsed. As <italic>N</italic>′ is a network in canonical form satisfying the mild conditions of Corollary 2, <italic>N</italic>′ is uniquely determined by the trees it displays. Note that <italic>N</italic> provides the biological interpretation for <italic>N</italic>′. (<italic>b</italic>) The network topology of <italic>N</italic>′′ is such that there exists no regular network displaying the same set of (two) tree topologies as <italic>N</italic>′′. Thus, restricting the scope of phylogenetic inference to regular networks would be very limiting. In our framework, <italic>N</italic>′′ is a network in canonical form and thus uniquely determined by the trees it displays.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g005"/>
</fig>
<p>To the best of our knowledge, only three classes of networks have claims of unique identifiability: <italic>reduced</italic> networks [<xref ref-type="bibr" rid="pcbi.1004135.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref047">47</xref>], <italic>regular</italic> networks [<xref ref-type="bibr" rid="pcbi.1004135.ref048">48</xref>] and binary galled trees with no gall containing exactly 4 nodes [<xref ref-type="bibr" rid="pcbi.1004135.ref049">49</xref>]. These approaches bear some resemblances to ours, but do not include edge lengths in the definition of a network. Moreover, we argue that these classes of networks are still too narrow to be biologically relevant. We briefly describe and comment these previous works below.</p>
<p>Moret et al. [<xref ref-type="bibr" rid="pcbi.1004135.ref046">46</xref>] defined notions of reconstructible, indistinguishable and reduced networks that resemble concepts that we will introduce here. Although some of their results were flawed [<xref ref-type="bibr" rid="pcbi.1004135.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref050">50</xref>], some of the arguments in this introduction are inspired by their paper. Particularly relevant to the current paper is a reduction algorithm to transform a network into its <italic>reduced version</italic>. (However, the exact definition of the reduced version is unclear: as one of the authors later pointed out [<xref ref-type="bibr" rid="pcbi.1004135.ref047">47</xref>], “the reduction procedure of Moret et al. [<xref ref-type="bibr" rid="pcbi.1004135.ref046">46</xref>] is, in fact, inaccurate” and “in this paper we do not attempt to fix the procedure”.) The concept of reduced version is analogous to that of canonical form here, as the authors claim that networks displaying the same tree topologies have the same reduced version (up to isomorphism; Theorem 2 in [<xref ref-type="bibr" rid="pcbi.1004135.ref046">46</xref>]). This is somehow a weaker analogue of one of our results (Corollary 1); weaker, because it does not claim that, conversely, networks with the same reduced version display the same tree topologies. To have an idea of the difference between our canonical form and the reduced version of Moret and colleagues, in <xref ref-type="fig" rid="pcbi.1004135.g006">Fig. 6</xref> we compare the canonical form and the reduced version of the same network <italic>N</italic><sub>1</sub>. (<italic>N</italic><sub>1</sub> and its reduced version are taken from Fig. 15 of [<xref ref-type="bibr" rid="pcbi.1004135.ref046">46</xref>] to avoid possible issues with the reduction algorithm.) As one can see, the canonical form retains more of the complexity of the original network.</p>
<fig id="pcbi.1004135.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Comparison between the reduced version and the canonical form of a network.</title>
<p><italic>N</italic><sub>1</sub> is the network topology in Fig. 15a of [<xref ref-type="bibr" rid="pcbi.1004135.ref046">46</xref>], where edges leading to extinct taxa are shown in grey, and reticulation events are represented by horizontal lines connecting the involved edges. <italic>N</italic><sub>2</sub> is a phylogenetic network on the same set of taxa displaying the same evolutionary history, and showing edge lengths. <italic>R</italic>(<italic>N</italic><sub>1</sub>) is the reduced version of <italic>N</italic><sub>1</sub> (Fig. 15b of [<xref ref-type="bibr" rid="pcbi.1004135.ref046">46</xref>]). <inline-formula id="pcbi.1004135.e005"><alternatives><graphic id="pcbi.1004135.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e005"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the canonical form of <italic>N</italic><sub>2</sub>. Comparing <italic>R</italic>(<italic>N</italic><sub>1</sub>) and <inline-formula id="pcbi.1004135.e006"><alternatives><graphic id="pcbi.1004135.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e006"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> reveals the difference in expressive power between reduced versions and canonical forms. Collapsing the edge above <italic>c</italic> and <italic>d</italic> in <italic>R</italic>(<italic>N</italic><sub>1</sub>) yields the regular network displaying the same tree topologies as <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub>. Clearly, the reduced form <italic>R</italic>(<italic>N</italic><sub>1</sub>) (and the regular form) retain less of the complexity of the original network <italic>N</italic><sub>1</sub> than the canonical form <inline-formula id="pcbi.1004135.e007"><alternatives><graphic id="pcbi.1004135.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. For example in <italic>R</italic>(<italic>N</italic><sub>1</sub>) there remains no sign of the reticulate events ancestral to taxon <italic>e</italic>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g006"/>
</fig>
<p>Another reduction procedure on network topologies has been studied by Gambette and Huber [<xref ref-type="bibr" rid="pcbi.1004135.ref049">49</xref>], who prove that if two network topologies reduce to the same topology, then they must display the same tree topologies. Again, this is analogous to, but somehow weaker than our results, since it only provides a sufficient condition for networks to be indistinguishable (which in their context means to display the same tree topologies). This means that there can be irreducible networks that are indistinguishable (e.g. those in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref>) thus failing to achieve the distinguishability goal. Moreover, Gambette and Huber [<xref ref-type="bibr" rid="pcbi.1004135.ref049">49</xref>] show that a particular class of network topologies (binary galled trees with no gall containing exactly 4 nodes) are uniquely identified by the tree topologies they display. It is clear that this class is too small to achieve the existence goal.</p>
<p>Finally, a regular network is a network topology <italic>N</italic> in which, among other requirements, no two distinct nodes have the same set of descendant leaves (see [<xref ref-type="bibr" rid="pcbi.1004135.ref048">48</xref>] for a formal definition and characterizations). This requirement implies, among other things, that <italic>N</italic> cannot contain any reticulation <italic>v</italic> with outdegree 1 (<italic>v</italic> and its direct descendant would have the same descendant leaves), which in turn implies that regular networks are special cases of our canonical networks (the latter however also specify edge lengths). In fact regular networks satisfy a property that is analogous to the one we prove here for canonical networks: a regular network <italic>N</italic> is uniquely determined by the tree topologies that it displays [<xref ref-type="bibr" rid="pcbi.1004135.ref051">51</xref>], meaning that there can be no other regular network <italic>N</italic>′ displaying exactly the same set of tree topologies. Willson [<xref ref-type="bibr" rid="pcbi.1004135.ref051">51</xref>] shows this constructively by providing an algorithm that, given the (exponentially large) set of tree topologies displayed by a regular network <italic>R</italic>, reconstructs <italic>R</italic> itself. However, unlike for our canonical forms, for a given network there may exist no regular network displaying the same set of trees (e.g. consider the topology of <italic>N</italic>′′ in <xref ref-type="fig" rid="pcbi.1004135.g005">Fig. 5b</xref>), thus failing to meet the existence goal. Regularity is in fact a very restrictive constraint for a network. For example, none of the networks in <xref ref-type="fig" rid="pcbi.1004135.g005">Fig. 5</xref> and <xref ref-type="fig" rid="pcbi.1004135.g007">Fig. 7</xref> is regular, despite the fact that their topologies are uniquely determined by the trees with edge lengths that they display (a consequence of our results further below). Finally, going back to <xref ref-type="fig" rid="pcbi.1004135.g006">Fig. 6</xref>, collapsing the edge above taxa <italic>c</italic> and <italic>d</italic> in <italic>R</italic>(<italic>N</italic><sub>1</sub>) yields the regular network displaying the same tree topologies as <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub>. Again, this shows that the canonical form retains more of the complexity of the original network than its regular counterpart.</p>
<fig id="pcbi.1004135.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Trees displayed by a network.</title>
<p>A rooted network <inline-formula id="pcbi.1004135.e008"><alternatives><graphic id="pcbi.1004135.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e008"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and the trees it displays (<inline-formula id="pcbi.1004135.e009"><alternatives><graphic id="pcbi.1004135.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e009"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004135.e010"><alternatives><graphic id="pcbi.1004135.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e010"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>), obtained by removing a segment of length 0.5 from the outgroup lineage of <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref>. In our formal setting, a network such as <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref> can either be represented as <inline-formula id="pcbi.1004135.e011"><alternatives><graphic id="pcbi.1004135.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e011"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> (by omitting the outgroup lineage, or part of it), or by rooting it in its outgroup (not shown).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g007"/>
</fig>
</sec>
</sec>
<sec id="sec006" sec-type="results">
<title>Results</title>
<p>Our main result consists of formally proving that for every network <italic>N</italic> there exists a network <italic>N</italic>′ in canonical form, indistinguishable from <italic>N</italic>; moreover, if we restrict ourselves to networks satisfying a mild condition (the NELP property below), such canonical form <italic>N</italic>′ is unique (see Theorem 1). In other words, although in general a phylogenetic network <italic>N</italic> is not uniquely recoverable from the data it generates, there always exists a canonical version <italic>N</italic>′ of <italic>N</italic> that is indeed determined by the data. Informally, <italic>N</italic>′ is all that can be reconstructed about <italic>N</italic>.</p>
<p>In order to formally state this result, we here introduce a theoretical framework for explicit phylogenetic networks with branch lengths. A directed acyclic graph (<italic>DAG</italic>) is a simple directed graph that is free of directed cycles. A DAG is <italic>rooted</italic> if it contains precisely one node of indegree 0, called the <italic>root</italic>. All nodes of outdegree 0 in a DAG are called <italic>leaves</italic>. A <italic>weighted rooted phylogenetic network</italic> <italic>N</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>φ</italic>, Λ) on 𝓧 (in this paper also called a <italic>network</italic> for simplicity) consists of a rooted DAG (<italic>V</italic>, <italic>E</italic>) whose leaves are bijectively labeled (via <italic>φ</italic>:𝓧 → <italic>V</italic>) with the elements of 𝓧 (called <italic>taxa</italic>). Moreover, each edge <italic>e</italic> ∈ <italic>E</italic> is associated to a set of positive weights, called <italic>lengths</italic>, Λ(<italic>e</italic>) ⊂ ℝ<sub>&gt;0</sub>. Figs. <xref ref-type="fig" rid="pcbi.1004135.g003">3</xref>, <xref ref-type="fig" rid="pcbi.1004135.g004">4</xref>, <xref ref-type="fig" rid="pcbi.1004135.g005">5</xref> contain examples of networks. A <italic>reticulation</italic> of a network <italic>N</italic> is a node <italic>v</italic> ∈ <italic>V</italic> with indegree greater than 1. A <italic>weighted phylogenetic tree</italic> on 𝓧 (a <italic>tree</italic> for simplicity) is a network on 𝓧 with no reticulations and such that each edge <italic>e</italic> has a unique length (∣Λ(<italic>e</italic>)∣ = 1), which we denote by <italic>λ</italic>(<italic>e</italic>). Below, we discuss the biological justification of various aspects of the definitions above.</p>
<p>Let <italic>v</italic> be a node with indegree 1 and outdegree 1 in a tree. Node <italic>v</italic> is said to be <italic>suppressible</italic>. <italic>Suppressing</italic> <italic>v</italic> means removing the in-edge <italic>e</italic> = (<italic>u</italic>, <italic>v</italic>) and the out-edge <italic>f</italic> = (<italic>v</italic>, <italic>w</italic>) and then creating a new edge <italic>g</italic> = (<italic>u</italic>, <italic>w</italic>) with length <italic>λ</italic>(<italic>g</italic>) = <italic>λ</italic>(<italic>e</italic>) + <italic>λ</italic>(<italic>f</italic>). Let <italic>N</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>φ</italic>, Λ) be a network on 𝓧. A <italic>tree contained in</italic> <italic>N</italic> is a tree <italic>T</italic> = (<italic>V</italic>′,<italic>E</italic>′,<italic>φ</italic>′,<italic>λ</italic>) on the same taxon set 𝓧 such that: (1) the roots of <italic>T</italic> and <italic>N</italic> coincide, (2) the nodes and edges of <italic>T</italic> are also nodes and edges of <italic>N</italic>, that is <italic>V</italic>′ ⊆ <italic>V</italic> and <italic>E</italic>′ ⊆ <italic>E</italic>, (3) taxon labels are unchanged, that is <italic>φ</italic>′ = <italic>φ</italic>, and (4) the edge lengths of <italic>T</italic> are also edge lengths of <italic>N</italic>, that is, for every edge <italic>e</italic> ∈ <italic>E</italic>′, <italic>λ</italic>(<italic>e</italic>) ∈ Λ(<italic>e</italic>). A <italic>tree displayed by</italic> <italic>N</italic> is a tree <italic>T</italic>′ that can be obtained (up to isomorphism) by suppressing all suppressible nodes from a tree contained in <italic>N</italic>. The set of trees displayed by <italic>N</italic> is denoted by 𝓣(<italic>N</italic>). In <xref ref-type="fig" rid="pcbi.1004135.g007">Fig. 7</xref>, <inline-formula id="pcbi.1004135.e012"><alternatives><graphic id="pcbi.1004135.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e012"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:mo>𝓣</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the set of trees isomorphic to <inline-formula id="pcbi.1004135.e013"><alternatives><graphic id="pcbi.1004135.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e013"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004135.e014"><alternatives><graphic id="pcbi.1004135.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e014"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Two networks <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> are said to be <italic>indistinguishable</italic> if they display the same set of trees, that is 𝓣(<italic>N</italic><sub>1</sub>) = 𝓣(<italic>N</italic><sub>2</sub>). For example, <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref> are indistinguishable, as they display the same set of trees (<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub> and <italic>T</italic><sub>3</sub>, up to isomorphism).</p>
<p><bold>Definition 1</bold>. Given a network <italic>N</italic>, a <italic>funnel</italic> is a node with indegree greater than 0 and outdegree 1. A <italic>funnel-free</italic> network, or <italic>canonical</italic> network, is a network that does not contain funnels. A <italic>canonical form</italic> of a network <italic>N</italic> is a network that is funnel-free and indistinguishable from <italic>N</italic>.</p>
<p>In <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref>, <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> each contain two funnels, and thus are not funnel-free. The network <italic>N</italic>′ in <xref ref-type="fig" rid="pcbi.1004135.g004">Fig. 4</xref> is a canonical form of <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref>, as <italic>N</italic>′ is funnel-free and indistinguishable from <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub>. Similarly, <inline-formula id="pcbi.1004135.e015"><alternatives><graphic id="pcbi.1004135.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e015"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1004135.g006">Fig. 6</xref> is a canonical form of <italic>N</italic><sub>2</sub>. Note that nodes with indegree 1 and outdegree 1 are funnels. This implies that for trees the funnel-free condition coincides with the exclusion of suppressible nodes, which is a standard requirement in the definition of phylogenetic trees. It is thus appropriate to view the funnel-free condition as a natural extension of this requisite to networks.</p>
<p><bold>Definition 2</bold>. A <italic>weighted path</italic> in a network <italic>N</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>φ</italic>, Λ) is a pair (<italic>π</italic>, <italic>λ</italic>), where <italic>π</italic> is a directed path in the graph (<italic>V</italic>, <italic>E</italic>) and <italic>λ</italic> is a function that associates each edge <italic>e</italic> in <italic>π</italic> with a length <italic>λ</italic>(<italic>e</italic>) ∈ Λ(<italic>e</italic>). The <italic>length</italic> of a weighted path is the sum of the lengths assigned to its edges. A network satisfies the <italic>NELP</italic> (<italic>no equally long paths</italic>) property if no pair of distinct weighted paths having the same endpoints have the same length.</p>
<p>As we explain below, the NELP property is a mild condition to satisfy, unless edge lengths are taken to represent time. The following result states that if we restrict ourselves to networks satisfying the NELP property, then every network has exactly one canonical form. An outline of its proof can be found in the Methods section, including an algorithm showing how to reduce a network to canonical form. The detailed proof is presented in <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref>.</p>
<p><bold>Theorem 1</bold>. <italic>(i) Every network N has a canonical form. Moreover, (ii) if N has the NELP property, then there exists a unique canonical form of N among networks satisfying the NELP property (up to isomorphism)</italic>.</p>
<p>(The notion of isomorphism between networks is only used for mathematical rigor and is defined in <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref>.) The following result provides a necessary and sufficient condition for two networks satisfying the NELP property to be indistinguishable.</p>
<p><bold>Corollary 1</bold>. <italic>Let N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>be networks with the NELP property and let</italic> <inline-formula id="pcbi.1004135.e016"><alternatives><graphic id="pcbi.1004135.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e016"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004135.e017"><alternatives><graphic id="pcbi.1004135.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e017"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> <italic>be their unique canonical forms satisfying the NELP property. Then N</italic><sub>1</sub> <italic>and N</italic><sub>2</sub> <italic>are indistinguishable if and only if</italic> <inline-formula id="pcbi.1004135.e018"><alternatives><graphic id="pcbi.1004135.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e018"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> <italic>and</italic> <inline-formula id="pcbi.1004135.e019"><alternatives><graphic id="pcbi.1004135.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e019"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> <italic>are the same network (up to isomorphism)</italic>.</p>
<p>The following result states that a canonical network with the NELP property is uniquely determined by the trees it displays:</p>
<p><bold>Corollary 2</bold>. <italic>Let N be a canonical network satisfying the NELP property. Then N is the unique (up to isomorphism) canonical network satisfying the NELP property that displays (all and only) the trees in 𝓣(N)</italic>.</p>
<p>We now discuss the biological significance of a number of technical aspects of our framework.</p>
<sec id="sec007">
<title>Definition of Networks and Trees Displayed by a Network</title>
<p>All the phylogenies considered here—trees or networks—are rooted. This is because we assume that the analysis uses an outgroup (possibly consisting of multiple taxa, and with no reticulations) for rooting. For simplicity, outgroup lineages are not included in our phylogenies (an exception to this is in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref>). Note however that, because our phylogenies have edge lengths, and because omitting the outgroup is just a convention, the omitted lineages must have the same lengths for a network and all the trees it displays. For example, if we wish to omit the outgroup from <italic>N</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref> and from the trees that it displays (<italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref>), then what we obtain are <inline-formula id="pcbi.1004135.e020"><alternatives><graphic id="pcbi.1004135.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e020"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>T</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004135.e021"><alternatives><graphic id="pcbi.1004135.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e021"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1004135.g007">Fig. 7</xref>. This has a notable consequence: the trees displayed by a rooted network with edge lengths may have a root with outdegree 1 (e.g. <inline-formula id="pcbi.1004135.e022"><alternatives><graphic id="pcbi.1004135.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e022"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1004135.g007">Fig. 7</xref>). For flexibility, we also allow a network to have a root with outdegree 1.</p>
<p>Moreover, we allow multiple lengths for an edge in a network, but not in a tree. For example, in <xref ref-type="fig" rid="pcbi.1004135.g006">Fig. 6</xref>, network <inline-formula id="pcbi.1004135.e023"><alternatives><graphic id="pcbi.1004135.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> has an edge with two lengths (<italic>λ</italic><sub>7</sub> + <italic>λ</italic><sub>12</sub> + <italic>λ</italic><sub>14</sub> and <italic>λ</italic><sub>7</sub> + <italic>λ</italic><sub>11</sub> + <italic>λ</italic><sub>13</sub> + <italic>λ</italic><sub>14</sub>). The motivation behind multiple lengths lies in the observation that, whereas each edge in a phylogenetic tree describing the evolution of non-reticulating organisms trivially corresponds to a unique evolutionary path in the underlying real evolutionary history, when reticulate events have occurred this is not necessarily true: <xref ref-type="fig" rid="pcbi.1004135.g008">Fig. 8</xref> and <xref ref-type="fig" rid="pcbi.1004135.g009">Fig. 9</xref> show that some evolutionary scenarios can either be represented using multiedges (multiple edges with the same endpoints) or edges with multiple lengths. Although these two options are mathematically equivalent, graphically the second one leads to more compact representations, and this is why we choose to allow multiple lengths rather than multiedges. For our purposes we only need to consider the case where <italic>e</italic> has a finite set of lengths (Λ(<italic>e</italic>) = {<italic>λ</italic><sub>1</sub>(<italic>e</italic>), …, <italic>λ</italic><sub><italic>k</italic></sub>(<italic>e</italic>)}).</p>
<fig id="pcbi.1004135.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g008</object-id>
<label>Fig 8</label>
<caption>
<title>A non-reticulating evolutionary history (left) and a reticulating evolutionary history (right).</title>
<p>The black lineages are those leading to a sampled set of taxa 𝓧. The horizontal jagged lines represent reticulation events. Note that, whereas representing the scenario on the left with a phylogenetic tree on 𝓧 is straightforward, for the one on the right several options are possible. We show three alternative representations in <xref ref-type="fig" rid="pcbi.1004135.g009">Fig. 9</xref>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g008"/>
</fig>
<fig id="pcbi.1004135.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Alternative network representations for the evolutionary scenario in <xref ref-type="fig" rid="pcbi.1004135.g008">Fig. 8</xref> (right).</title>
<p>In our framework only <italic>N</italic><sub>2</sub> is a network.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g009"/>
</fig>
<p>Another unconventional aspect of our networks is the possibility of having nodes with in-degree and out-degree both greater than one. (See, e.g., the last common ancestor of <italic>c</italic> and <italic>d</italic> in <inline-formula id="pcbi.1004135.e024"><alternatives><graphic id="pcbi.1004135.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1004135.g006">Fig. 6</xref>.) Traditionally, the internal nodes in a phylogenetic network are constrained to belong to one of two different categories: reticulate nodes, with more than one incoming edge and just one outgoing edge, and speciation (or coalescence) nodes, with one incoming edge and multiple outgoing edges. Because reticulate and speciation events are clearly distinct, it is reasonable to constrain internal nodes to only fall in the two categories above. In our framework, this requirement is dropped, and some networks, notably those in canonical form, may have nodes that both represent reticulate and speciation events. In this case, it is important to understand that these nodes represent a potentially complex (and unrecoverable) reticulate scenario, followed by one or more speciation events. Compare, for example, network <italic>N</italic> and its canonical form <italic>N</italic>′ in <xref ref-type="fig" rid="pcbi.1004135.g005">Fig. 5</xref>, or <italic>N</italic><sub>2</sub> and <inline-formula id="pcbi.1004135.e025"><alternatives><graphic id="pcbi.1004135.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e025"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1004135.g006">Fig. 6</xref>. (In the latter, it is especially instructive to consider the reticulate history above the direct ancestor of taxon <italic>e</italic>.)</p>
</sec>
<sec id="sec008">
<title>The NELP Property</title>
<p>We use network <italic>N</italic><sub>1</sub> of <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref> to illustrate the NELP property. In <italic>N</italic><sub>1</sub> there are three distinct weighted paths having as endpoints the root of <italic>N</italic><sub>1</sub> and the direct ancestor of <italic>b</italic>. The lengths of these paths are ℓ<sub>1</sub> = <italic>λ</italic><sub>1</sub> + <italic>λ</italic><sub>6</sub>, ℓ<sub>2</sub> = <italic>λ</italic><sub>2</sub> + <italic>λ</italic><sub>3</sub> + <italic>λ</italic><sub>5</sub> + <italic>λ</italic><sub>8</sub> and ℓ<sub>3</sub> = <italic>λ</italic><sub>2</sub> + <italic>λ</italic><sub>10</sub> + <italic>λ</italic><sub>9</sub> + <italic>λ</italic><sub>8</sub>. Moreover, there is another pair of paths having the same endpoints: those of lengths ℓ<sub>4</sub> = <italic>λ</italic><sub>3</sub> + <italic>λ</italic><sub>5</sub> and ℓ<sub>5</sub> = <italic>λ</italic><sub>10</sub> + <italic>λ</italic><sub>9</sub>. Thus <italic>N</italic><sub>1</sub> has the NELP property if and only if the three numbers ℓ<sub>1</sub>, ℓ<sub>2</sub> and ℓ<sub>3</sub> are all different (note that this implies that also ℓ<sub>4</sub> and ℓ<sub>5</sub> are different). If edge lengths are taken to represent evolutionary change, rather than time, this is a very mild requirement: when edge lengths are drawn at random from a continuous distribution, the probability that two paths get exactly the same length is zero.</p>
<p>On the other hand, the NELP property does not hold for phylogenetic networks where edge lengths are taken to represent time. For these networks, canonical forms may not be unique (see <xref ref-type="fig" rid="pcbi.1004135.g010">Fig. 10</xref> for an example of this). Even in this case, we believe that inference methods should only consider phylogenetic networks in their canonical form, as this allows to reduce the solution space without any loss in “expressive power”: since every network <italic>N</italic> has (at least one) canonical form that displays exactly the same set of trees—and therefore has the same fit with the data as <italic>N</italic>—restricting the solution space to canonical forms always leaves at least one optimal network within this space. The real weakness of using canonical forms in a molecular clock context is that if a canonical form is not unique, then it cannot be considered representative of all the networks indistinguishable from it. As an example of this, consider the indistinguishable networks in <xref ref-type="fig" rid="pcbi.1004135.g010">Fig. 10</xref>: none of these is representative of all the others.</p>
<fig id="pcbi.1004135.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Different (non-isomorphic) but indistinguishable funnel-free networks.</title>
<p>All edges are assumed to have the (unique) length 1 unless otherwise displayed. These networks do not satisfy the NELP property, showing that this is a necessary condition for the uniqueness of canonical forms (Theorem 1(ii)). The ellipsis at the end represents the fact that an infinite number of such networks can be obtained by adding any number of copies of the subgraph in grey in the last network.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g010"/>
</fig>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>Our results are both negative and positive. The bad news is that any method that scores the fit between a network <italic>N</italic> and the available data—which may be sequences, distances, splits, trees (with or without edge lengths)—based on the set of trees displayed by <italic>N</italic> must face an important theoretical limitation: regardless of the amount of available data from the taxa under consideration, some parts of the network representing their evolutionary history may be impossible to recover—most notably the relative order of consecutive reticulate events (see, e.g., <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref>). The good news is that, when edge lengths are taken into account, we can set precise limits to what is recoverable: the canonical form of a network <italic>N</italic> is a simplified version of <italic>N</italic> that excludes all the unrecoverable aspects of <italic>N</italic>. In a canonical form, reticulate events are brought as forward in time as possible, causing the collapse of multiple consecutive nodes. (Compare again network <italic>N</italic><sub>2</sub> and its canonical form <inline-formula id="pcbi.1004135.e026"><alternatives><graphic id="pcbi.1004135.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e026"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1004135.g006">Fig. 6</xref>.) The importance of the canonical form <italic>N</italic>′ of a network <italic>N</italic> lies in the fact that, if we restrict our consideration to networks with the NELP property, <italic>N</italic>′ is the unique canonical network consistent with perfect and unlimited data from the taxa in <italic>N</italic>.</p>
<p>There is an interesting analogy between soft polytomies in classical phylogenetics and collapsed nodes in a canonical network. Both represent lack of knowledge about the order of evolutionary events: speciations or more generally lineage splits in the first case, and reticulate events in the second. However, there is also an important difference between them: whereas in principle polytomies can be resolved by collecting further data from the taxa in the tree (for example, by extensive sequencing of their genomes [<xref ref-type="bibr" rid="pcbi.1004135.ref052">52</xref>]), the standard network inference methods considered here cannot resolve collapsed nodes in a canonical network, <italic>irrespective of the amount of data from the taxa under consideration</italic>. This difference is mitigated by the observation that increased taxon sampling may indeed permit to resolve the collapsed nodes, when the new lineages break adjacencies between reticulate nodes. However, such lineages may not always exist or they may be difficult to sample.</p>
<p>The present work has several consequences that should be of interest both to the biologists concerned by the use of methods for phylogenetic network inference, and to the researchers interested in the development of these methods. We illustrate these consequences starting from a well-known problem of network inference methods, that of multiple optima. It has been noted before that many of the inference methods that have been recently proposed—especially those solely based on topological features—often return multiple optimal networks: Huson and Scornavacca show a striking example of this (Fig. 2 in [<xref ref-type="bibr" rid="pcbi.1004135.ref053">53</xref>]), where the problem of finding the simplest network displaying two given tree topologies admits at least 486 optimal solutions.</p>
<p>The existence of multiple optimal networks for a given data set is essentially due to two reasons: <italic>insufficient data</italic> and <italic>non-identifiability</italic>. For the example of 486 optimal solutions, this large number may be partly due to the fact that the goal was to achieve consistency with only two tree topologies. More data may enable to discriminate among the 486 returned networks. Non-identifiability, which occurs when none of the allowed data can discriminate between two or more networks, is a more serious problem than insufficient data, as it cannot be solved by simply increasing the size of the input sample. Another interesting example appears in a paper by Albrecht et al. [<xref ref-type="bibr" rid="pcbi.1004135.ref054">54</xref>], which we reproduce here in <xref ref-type="fig" rid="pcbi.1004135.g011">Fig. 11</xref>. Here, there are only three optimal networks, essentially differing for which of the three clades {<italic>A.bicornis, A.longissima, A.sharonensis</italic>}, {<italic>A.uniaristata, A.comosa</italic>} and {<italic>A.tauschii</italic>} is considered as a hybrid (in this example reticulations represent hybridizations). This pattern is entirely analogous to that of the three networks in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref> (with <italic>a</italic>, <italic>b</italic> and <italic>c</italic> replaced by the three clades above), meaning that these three networks are indistinguishable to methods not accounting for edge lengths. Therefore, in this example, the existence of multiple optimal solutions is <italic>entirely</italic> due to non-identifiability.</p>
<fig id="pcbi.1004135.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Real-world example of indistinguishable network topologies.</title>
<p>(Reproduced from [<xref ref-type="bibr" rid="pcbi.1004135.ref054">54</xref>], Fig. 4.) Three network topologies that display the two tree topologies in Fig. 3 of [<xref ref-type="bibr" rid="pcbi.1004135.ref054">54</xref>]. Note that these three networks are analogous to <italic>N</italic><sub>1</sub>, <italic>N</italic><sub>2</sub> and <italic>N</italic><sub>3</sub> in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref> of the current paper: they each contain a reticulation cycle with three outgoing edges leading to the same three clades: {<italic>A.bicornis, A.longissima, A.sharonensis</italic>}, {<italic>A.uniaristata, A.comosa</italic>} and {<italic>A.tauschii</italic>} (in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref> instead of three clades we have three taxa <italic>a</italic>, <italic>b</italic> and <italic>c</italic>).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g011"/>
</fig>
<p>All this motivates three recommendations:</p>
<list list-type="order">
<list-item>
<p>It is important to use data in a way that causes non-identifiability to be as limited as possible. For example, as we have seen, accounting for edge lengths solves some cases of non-identifiability (e.g., in <xref ref-type="fig" rid="pcbi.1004135.g002">Fig. 2</xref>) although it does not eliminate this problem altogether (e.g., in <xref ref-type="fig" rid="pcbi.1004135.g003">Fig. 3</xref>).</p>
</list-item>
<list-item>
<p>Given an inferred network <inline-formula id="pcbi.1004135.e027"><alternatives><graphic id="pcbi.1004135.e027g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e027"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, it is important to know the set of networks that are theoretically impossible to distinguish from <inline-formula id="pcbi.1004135.e028"><alternatives><graphic id="pcbi.1004135.e028g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e028"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>: no matter the amount of data, they will all receive the same support as <inline-formula id="pcbi.1004135.e029"><alternatives><graphic id="pcbi.1004135.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e029"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We may call this set the <italic>indistinguishable class</italic> of <inline-formula id="pcbi.1004135.e030"><alternatives><graphic id="pcbi.1004135.e030g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e030"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The biologist using an inference method must be aware that <inline-formula id="pcbi.1004135.e031"><alternatives><graphic id="pcbi.1004135.e031g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e031"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is not the only network supported by the data.</p>
</list-item>
<list-item>
<p>It would be highly useful to devise inference methods that instead of searching for (or directly constructing) solutions in the space of all possible networks, only considers one element per indistinguishable class. This has the potential to significantly speed up the inference.</p>
</list-item></list>
<p specific-use="continuation">Correspondingly, we recommend that edge lengths should be accounted for in the analyses (point 1) and, for each of the indistinguishable classes resulting from this choice, we identify a canonical network that, for all practical purposes, can be considered to be unique. Most important to the end users, we propose that a canonical network <inline-formula id="pcbi.1004135.e032"><alternatives><graphic id="pcbi.1004135.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e032"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is what should be given as the result of the inference, with the caveat that <inline-formula id="pcbi.1004135.e033"><alternatives><graphic id="pcbi.1004135.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e033"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a way to represent a class of networks that are all equally supported (point 2). In a canonical form <inline-formula id="pcbi.1004135.e034"><alternatives><graphic id="pcbi.1004135.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e034"/><mml:math id="M34" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, the aspects that are not common to all networks in this class are collapsed, as described above. This will help the evolutionary biologist to locate the uncertainties in the phylogeny, and possibly to choose further taxa to resolve them. Finally, we propose that inference methods only attempt to search among—or construct—phylogenetic networks in their canonical form (point 3).</p>
<p>We note that accounting for yet more characteristics of the data may reduce (or eliminate altogether) the identifiability issues for phylogenetic networks. In the case of sequence-based methods, one may take into account the natural order of sites within a sequence [<xref ref-type="bibr" rid="pcbi.1004135.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1004135.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1004135.ref056">56</xref>]. Similarly, for reconstruction methods based on collections of subtrees, one could observe and use the relative position of the different genomic regions supporting the input trees. However, these relative positions must be conserved across the genomes being analyzed, a condition which may hold for recombining organisms (e.g. individuals within a population or different viral strains), but which is not obvious when studying a group of taxa that have undergone reticulate events (e.g., hybridization) at some point in a distant past.</p>
<p>The main conclusion of the present study is the following: unless one abandons any optimization criterion that scores a network solely based on the trees it displays, the reconstruction should be carried out in a reduced space of networks: that of the canonical forms defined here. The motivation for this lies in the fact that canonical networks are guaranteed to be uniquely determined, if sufficient data are available. Once a canonical form <inline-formula id="pcbi.1004135.e035"><alternatives><graphic id="pcbi.1004135.e035g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e035"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is inferred, it must be kept in mind that even assuming that the inference is free of statistical error, the true phylogenetic network is just one of the many networks having <inline-formula id="pcbi.1004135.e036"><alternatives><graphic id="pcbi.1004135.e036g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e036"/><mml:math id="M36" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>N</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula> as canonical form. Compared to what biologists are used to for phylogenetic trees—where in principle it is always possible to resolve uncertainties—it is clear that this requires an important change of perspective.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods</title>
<p>The following three subsections describe the proofs of Theorem 1 part (i), of Theorem 1 part (ii), and of their corollaries, respectively. In the case of Theorem 1 part (ii), only the gist of the proof is provided here. The proof in full detail is deferred to <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref>.</p>
<sec id="sec011">
<title>Reduction Algorithm</title>
<p>In order to prove that any network <italic>N</italic> has a canonical form, we describe an algorithm to transform <italic>N</italic> into a canonical network indistinguishable from <italic>N</italic>. The algorithm simply consists of repeatedly applying to <italic>N</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>φ</italic>, Λ) one of the following two reduction rules, until neither can be executed (see <xref ref-type="fig" rid="pcbi.1004135.g012">Fig. 12</xref>):
<list list-type="simple">
<list-item>
<p><bold>Funnel suppression (R1)</bold>. Given a funnel <italic>v</italic> with <italic>k</italic> ≥ 1 in-edges (<italic>u</italic><sub>1</sub>, <italic>v</italic>), (<italic>u</italic><sub>2</sub>, <italic>v</italic>), …, (<italic>u</italic><sub><italic>k</italic></sub>, <italic>v</italic>) and out-edge (<italic>v</italic>, <italic>w</italic>), remove <italic>v</italic> and all these edges from <italic>N</italic> and introduce <italic>k</italic> new edges (<italic>u</italic><sub>1</sub>, <italic>w</italic>), (<italic>u</italic><sub>2</sub>, <italic>w</italic>), …, (<italic>u</italic><sub><italic>k</italic></sub>, <italic>w</italic>). For all <italic>i</italic> ∈ {1, 2, …, <italic>k</italic>} assign to (<italic>u</italic><sub><italic>i</italic></sub>, <italic>w</italic>) the lengths Λ((<italic>u</italic><sub><italic>i</italic></sub>, <italic>w</italic>)): = Λ((<italic>u</italic><sub><italic>i</italic></sub>, <italic>v</italic>)) + Λ((<italic>v</italic>, <italic>w</italic>)), where the sum of two sets of numbers <italic>A</italic> and <italic>B</italic> is defined as <italic>A</italic> + <italic>B</italic> = {<italic>a</italic> + <italic>b</italic>: <italic>a</italic> ∈ <italic>A</italic>, <italic>b</italic> ∈ <italic>B</italic>}.</p>
</list-item>
<list-item>
<p><bold>Multiedge merging (R2)</bold>. Given a collection of multi-edges (<italic>u</italic>, <italic>w</italic>) with multiplicity <italic>k</italic> and lengths <inline-formula id="pcbi.1004135.e037"><alternatives><graphic id="pcbi.1004135.e037g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e037"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>Λ</mml:mo> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>Λ</mml:mo> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>Λ</mml:mo> <mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, replace these edges with a single edge with lengths <inline-formula id="pcbi.1004135.e038"><alternatives><graphic id="pcbi.1004135.e038g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e038"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>⋃</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>Λ</mml:mo> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
</list></p>
<fig id="pcbi.1004135.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g012</object-id>
<label>Fig 12</label>
<caption>
<title>The two rules at the basis of the canonical reduction algorithm.</title>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g012"/>
</fig>
<p>An example of the reduction of a network to its canonical form is shown in <xref ref-type="fig" rid="pcbi.1004135.g013">Fig. 13</xref>. Note that, even if the algorithm may temporarily produce multi-edges, the network produced in the end obviously does not have any multi-edge (otherwise we could still apply rule R2).</p>
<fig id="pcbi.1004135.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Reduction of a network to its canonical form.</title>
<p>All edges are assumed to have the (unique) length 1 unless otherwise displayed. Gray edges are those to which the next reduction rule is applied.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g013"/>
</fig>
<p><italic>Proof of part (i) of Theorem 1</italic>. We must prove that any network <italic>N</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>φ</italic>, Λ) has a canonical form. For this, we apply the reduction algorithm described above, thus obtaining a sequence <italic>N</italic><sub>0</sub> = <italic>N</italic>, <italic>N</italic><sub>1</sub>, …, <italic>N</italic><sub><italic>m</italic></sub>, where each <italic>N</italic><sub><italic>i</italic>+1</sub> is obtained from <italic>N</italic><sub><italic>i</italic></sub> by applying either R1 or R2. Neither R1 nor R2 can be applied to <italic>N</italic><sub><italic>m</italic></sub>. We prove that <italic>N</italic><sub><italic>m</italic></sub> is a canonical form of <italic>N</italic>. Although, strictly speaking, <italic>N</italic><sub><italic>i</italic></sub> may not be a network (as it potentially contains multi-edges), the notion of trees displayed by <italic>N</italic><sub><italic>i</italic></sub>, and thus that of indistinguishability, trivially extends to these multigraphs.</p>
<p>First, note that the algorithm terminates after a finite number of iterations (<italic>m</italic>). This is true because at each iteration the size of <italic>E</italic> is reduced by at least one. Moreover, the resulting network <italic>N</italic><sub><italic>m</italic></sub> is funnel-free, since no reduction of type R1 can be applied to it.</p>
<p>What is left to prove is that <italic>N</italic><sub><italic>m</italic></sub> is indistinguishable from <italic>N</italic> = <italic>N</italic><sub>0</sub>. To this end we prove that, at each iteration, <italic>N</italic><sub><italic>i</italic></sub> and <italic>N</italic><sub><italic>i</italic>+1</sub> are indistinguishable, i.e. 𝓣(<italic>N</italic><sub><italic>i</italic></sub>) = 𝓣(<italic>N</italic><sub><italic>i</italic>+1</sub>). In other words any tree <italic>T</italic> is displayed by <italic>N</italic><sub><italic>i</italic></sub> if and only if <italic>T</italic> is displayed by <italic>N</italic><sub><italic>i</italic>+1</sub>.</p>
<p>Let <italic>T</italic> be displayed by <italic>N</italic><sub><italic>i</italic></sub>. Then <italic>T</italic> can be obtained by suppressing all suppressible nodes from a tree <italic>T</italic><sub><italic>i</italic></sub> contained in <italic>N</italic><sub><italic>i</italic></sub>. We consider three cases. (1) If none of the edges in <italic>T</italic><sub><italic>i</italic></sub> is involved in the reduction transforming <italic>N</italic><sub><italic>i</italic></sub> into <italic>N</italic><sub><italic>i</italic>+1</sub>, then clearly <italic>T</italic><sub><italic>i</italic></sub> is still contained in <italic>N</italic><sub><italic>i</italic>+1</sub> and thus <italic>T</italic> is still displayed by <italic>N</italic><sub><italic>i</italic>+1</sub>. (2) If <italic>T</italic><sub><italic>i</italic></sub> is involved in a R1 reduction, then it contains a funnel <italic>v</italic> and it contains one of the in-edges of the funnel, say (<italic>u</italic><sub><italic>j</italic></sub>, <italic>v</italic>), with length <italic>λ</italic><sub><italic>j</italic></sub> ∈ Λ<sub><italic>j</italic></sub> = Λ((<italic>u</italic><sub><italic>j</italic></sub>, <italic>v</italic>)), along with the out-edge (<italic>v</italic>, <italic>w</italic>), with length <italic>λ</italic><sub>0</sub> ∈ Λ<sub>0</sub> = Λ((<italic>v</italic>, <italic>w</italic>)). Now, let <italic>T</italic><sub><italic>i</italic>+1</sub> be the tree obtained from <italic>T</italic><sub><italic>i</italic></sub> by suppressing the suppressible node <italic>v</italic> and thus creating a new edge (<italic>u</italic><sub><italic>j</italic></sub>, <italic>w</italic>) with length <italic>λ</italic><sub><italic>j</italic></sub> + <italic>λ</italic><sub>0</sub>. Because the R1 reduction creates a new edge (<italic>u</italic><sub><italic>j</italic></sub>, <italic>w</italic>) with length set Λ<sub><italic>j</italic></sub> + Λ<sub>0</sub>, containing the value <italic>λ</italic><sub><italic>j</italic></sub> + <italic>λ</italic><sub>0</sub>, then <italic>T</italic><sub><italic>i</italic>+1</sub> is contained in <italic>N</italic><sub><italic>i</italic>+1</sub>. Moreover, it easy to see that <italic>T</italic> can still be obtained by suppressing all suppressible nodes from <italic>T</italic><sub><italic>i</italic>+1</sub>. Thus <italic>T</italic> is still displayed by <italic>N</italic><sub><italic>i</italic>+1</sub>. (3) If <italic>T</italic><sub><italic>i</italic></sub> is involved in a R2 reduction, then it contains one of the edges of a multi-edge (<italic>u</italic>, <italic>w</italic>), with a length <italic>λ</italic> belonging to one of the length sets <inline-formula id="pcbi.1004135.e039"><alternatives><graphic id="pcbi.1004135.e039g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e039"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>Λ</mml:mo> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>Λ</mml:mo> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>Λ</mml:mo> <mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> associated to the <italic>k</italic> copies of (<italic>u</italic>, <italic>w</italic>). Thus we have that <inline-formula id="pcbi.1004135.e040"><alternatives><graphic id="pcbi.1004135.e040g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e040"/><mml:math id="M40" display="inline" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mo>⋃</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>Λ</mml:mo> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, which implies that <italic>T</italic><sub><italic>i</italic></sub> is still contained in <italic>N</italic><sub><italic>i</italic>+1</sub> and thus <italic>T</italic> is still displayed by <italic>N</italic><sub><italic>i</italic>+1</sub>. This concludes the proof of 𝓣(<italic>N</italic><sub><italic>i</italic></sub>) ⊆ 𝓣(<italic>N</italic><sub><italic>i</italic>+1</sub>).</p>
<p>In order to prove that, conversely, 𝓣(<italic>N</italic><sub><italic>i</italic>+1</sub>) ⊆ 𝓣(<italic>N</italic><sub><italic>i</italic></sub>), one can proceed in a similar way as above: if <italic>T</italic> is displayed by <italic>N</italic><sub><italic>i</italic>+1</sub>, then <italic>T</italic> can be obtained by suppressing all suppressible nodes from a tree <italic>T</italic><sub><italic>i</italic>+1</sub> contained in <italic>N</italic><sub><italic>i</italic></sub>. By considering three cases analogous to the ones above regarding the involvement of <italic>T</italic><sub><italic>i</italic>+1</sub> in the reduction transforming <italic>N</italic><sub><italic>i</italic></sub> into <italic>N</italic><sub><italic>i</italic>+1</sub>, we can prove that in all these cases <italic>T</italic> is already displayed by <italic>N</italic><sub><italic>i</italic></sub>. Thus <italic>N</italic><sub><italic>i</italic></sub> and <italic>N</italic><sub><italic>i</italic>+1</sub> are indistinguishable, which concludes our proof. □</p>
<p>We note informally that the order of application of the possible reductions in the algorithm above is irrelevant to the end result. To see this, it suffices to show that if two different reductions are applicable to a network, then the result of applying them is the same irrespective of the order of application. As we do not need this remark for the other results in this paper, we do not give a formal proof of it.</p>
<p><bold>Lemma 1</bold>. Let N be a network and N′ a canonical form of N obtained by applying the reduction algorithm. If N satisfies the NELP property, then N′ satisfies the NELP property.</p>
<p>Proof: We prove that for each basic step of the reduction algorithm—transforming <italic>N</italic><sub><italic>i</italic></sub> into <italic>N</italic><sub><italic>i</italic>+1</sub> via a reduction rule R1/R2—if <italic>N</italic><sub><italic>i</italic></sub> satisfies the NELP property, then <italic>N</italic><sub><italic>i</italic>+1</sub> also satisfies it. Suppose the contrary; then, <italic>N</italic><sub><italic>i</italic>+1</sub> contains two distinct weighted paths <italic>ρ</italic><sub>1</sub>, <italic>ρ</italic><sub>2</sub> with the same endpoints <italic>u</italic> and <italic>v</italic> and same lengths. Because R1/R2 cannot create new nodes, <italic>u</italic> and <italic>v</italic> are also nodes in <italic>N</italic><sub><italic>i</italic></sub>. Moreover, it is easy to see that each weighted path <italic>ρ</italic> in <italic>N</italic><sub><italic>i</italic></sub> from <italic>u</italic> to <italic>v</italic> gives rise to exactly one weighted path <italic>f</italic>(<italic>ρ</italic>) in <italic>N</italic><sub><italic>i</italic>+1</sub> from <italic>u</italic> to <italic>v</italic>, with exactly the same length as <italic>ρ</italic>. Now take two weighted paths in <italic>N</italic><sub><italic>i</italic></sub>, one in the preimage <italic>f</italic><sup>−1</sup>(<italic>ρ</italic><sub>1</sub>) and the other in the preimage <italic>f</italic><sup>−1</sup>(<italic>ρ</italic><sub>2</sub>). These two weighted paths in <italic>N</italic><sub><italic>i</italic></sub> are distinct (as <italic>ρ</italic><sub>1</sub> ≠ <italic>ρ</italic><sub>2</sub>), have the same endpoints (<italic>u</italic> and <italic>v</italic>) and the same length. But then <italic>N</italic><sub><italic>i</italic></sub> violates the NELP property, leading to a contradiction. We thus have that if <italic>N</italic><sub><italic>i</italic></sub> satisfies the NELP property, then <italic>N</italic><sub><italic>i</italic>+1</sub> also satisfies it. By iterating the argument above for each step in the reduction algorithm, the lemma follows. □</p>
</sec>
<sec id="sec012">
<title>Uniqueness of the Canonical Form for Networks Satisfying the NELP</title>
<p>The proof of Theorem 1, part (ii), is rather technical. In this section, we introduce a number of new concepts and state the main intermediate results that are necessary to obtain this result. We leave their detailed proofs to <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref>, together with the obvious definitions of basic concepts such as that of <italic>isomorphic networks</italic>, <italic>sub-network</italic> and <italic>union</italic> of two networks.</p>
<p><bold>Definition 3</bold>. (<italic>Root-leaf path</italic>, <italic>prefix, postfix, wishbone, crack</italic>.) Let <italic>N</italic> be a network on 𝓧 and (<italic>π</italic>, <italic>λ</italic>) be a weighted path in <italic>N</italic> from the root of <italic>N</italic> to a leaf labelled by <italic>x</italic> ∈ 𝓧. Now consider the sub-network <italic>P</italic> = (<italic>V</italic>(<italic>π</italic>), <italic>E</italic>(<italic>π</italic>), <italic>φ</italic>∣<sub>{<italic>x</italic>}</sub>, <italic>λ</italic>) on {<italic>x</italic>} consisting of all the nodes and edges in <italic>π</italic> and associated labels. Any sub-network of <italic>N</italic> such as <italic>P</italic> is called a <italic>root-leaf path</italic> of <italic>N</italic>. Given a root-leaf path <italic>P</italic> and a node <italic>v</italic> belonging to it, any weighted path formed by all the ancestors [descendants] of <italic>v</italic> in <italic>P</italic> is a <italic>prefix</italic> [<italic>suffix</italic>] of <italic>P</italic>. Note that a prefix [suffix] only consists of one node when <italic>v</italic> is the root [leaf] of <italic>P</italic>. A <italic>wishbone</italic> of <italic>N</italic> is any sub-network of <italic>N</italic> formed by taking the union of two root-leaf paths that have in common only a prefix. A <italic>crack</italic> of <italic>N</italic> is any sub-network of <italic>N</italic> formed by taking the union of two root-leaf paths that have in common only a prefix and a suffix.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004135.g014">Fig. 14</xref> illustrates the definitions above. Note that any root-leaf path <italic>P</italic> is both a wishbone and a crack, as <italic>P</italic> is the result of the union of <italic>P</italic> with itself, and <italic>P</italic> has a common prefix and a common suffix with <italic>P</italic>. Moreover, any sub-network <italic>R</italic> that can be obtained from a root-leaf path by attributing two lengths to one of its edges <italic>e</italic> is a crack. Finally, note that wishbones and cracks are networks, and thus the notion of isomorphism (Definition 5 in <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref>) can be applied to them.</p>
<fig id="pcbi.1004135.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004135.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Illustration of Definition 3.</title>
<p><italic>P</italic> (edges in black) is a root-leaf path of <italic>N</italic> and thus both a wishbone and a crack of <italic>N</italic>. <italic>R</italic> and <italic>S</italic> (black) are cracks of <italic>N</italic>. <italic>Q</italic> (black) is a wishbone of <italic>N</italic>. All edges are assumed to have the (unique) length 1 unless otherwise displayed.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.g014"/>
</fig>
<p>The proof of part (ii) in Theorem 1 depends on two important results (Propositions 1 and 2 below), whose proofs can be found in <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref>. The first states that a network with the NELP property is uniquely determined by the wishbones and cracks it contains.</p>
<p><bold>Proposition 1</bold>. Two networks N<sub>1</sub> and N<sub>2</sub> with the NELP property are isomorphic if and only if they contain the same wishbones and cracks (up to isomorphism).</p>
<p>Proposition 1 is interesting on its own as it suggests an enumerative algorithm to verify whether two networks with the NELP property are isomorphic. Unfortunately this algorithm would be impractical, as the number of wishbones (or cracks) in a network is not polynomial in the size of the network. Also note that we require <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> to satisfy the NELP property because there exist non-isomorphic networks containing the same wishbones and cracks: for example the networks in the bottom line of <xref ref-type="fig" rid="pcbi.1004135.g010">Fig. 10</xref>. The second result that we need is the following:</p>
<p><bold>Proposition 2</bold>. Let N<sub>1</sub> and N<sub>2</sub> be two indistinguishable funnel-free networks, satisfying the NELP property. Then they contain the same wishbones and cracks (up to isomorphism).</p>
<p><italic>Proof of part (ii) of Theorem 1</italic>. Let <italic>N</italic> be a network with the NELP property and <italic>N</italic>′ a canonical form of <italic>N</italic> obtained by applying the reduction algorithm. By Lemma 1, <italic>N</italic>′ satisfies the NELP property. Now suppose that there exists another canonical form of <italic>N</italic>, called <italic>N</italic>′′, satisfying the NELP property. By transitivity, <italic>N</italic>′ and <italic>N</italic>′′ are indistinguishable. Because <italic>N</italic>′ and <italic>N</italic>′′ are indistinguishable, funnel-free and with the NELP property, <italic>N</italic>′ and <italic>N</italic>′′ must contain the same wishbones and cracks (because of Proposition 2). But then, because of Proposition 1, <italic>N</italic>′ and <italic>N</italic>′′ are isomorphic. □</p>
<p>We note that some of our arguments in <xref ref-type="supplementary-material" rid="pcbi.1004135.s001">S1 Text</xref> lead us to conjecture that a funnel-free network satisfying the NELP property cannot be indistinguishable from a funnel-free network violating the NELP property. This claim would allow us to simplify the statement of Theorem 1: networks with the NELP property would be guaranteed to have a unique canonical form (not just among networks with the NELP property, but among <italic>all</italic> networks). Unfortunately, to this date, we were unable to prove this conjecture. Nonetheless, note that the reduction algorithm returns, for any network with the NELP property, its <italic>unique</italic> canonical form with the NELP property (by Lemma 1).</p>
</sec>
<sec id="sec013">
<title>Corollaries</title>
<p>It remains to prove the two corollaries at the end of the Results section. The first one states that two networks <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub> satisfying the NELP property are indistinguishable if and only if their unique canonical forms with the NELP property, <inline-formula id="pcbi.1004135.e041"><alternatives><graphic id="pcbi.1004135.e041g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e041"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004135.e042"><alternatives><graphic id="pcbi.1004135.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e042"/><mml:math id="M42" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> respectively, are isomorphic. By Lemma 1, <inline-formula id="pcbi.1004135.e043"><alternatives><graphic id="pcbi.1004135.e043g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e043"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004135.e044"><alternatives><graphic id="pcbi.1004135.e044g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e044"/><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> can be obtained by applying the reduction algorithm to <italic>N</italic><sub>1</sub> and <italic>N</italic><sub>2</sub>.</p>
<p><italic>Proof of Corollary 1</italic>. The <italic>if</italic> part trivially follows from the transitivity of indistinguishability. As for the <italic>only if</italic> part, note that (again by transitivity) <inline-formula id="pcbi.1004135.e045"><alternatives><graphic id="pcbi.1004135.e045g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e045"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is indistinguishable from <italic>N</italic><sub>2</sub>. As it is also funnel-free, <inline-formula id="pcbi.1004135.e046"><alternatives><graphic id="pcbi.1004135.e046g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e046"/><mml:math id="M46" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is a canonical form of <italic>N</italic><sub>2</sub>. Because <italic>N</italic><sub>2</sub> can only have one canonical form satisfying the NELP property (by Theorem 1 (ii)), <inline-formula id="pcbi.1004135.e047"><alternatives><graphic id="pcbi.1004135.e047g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e047"/><mml:math id="M47" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004135.e048"><alternatives><graphic id="pcbi.1004135.e048g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004135.e048"/><mml:math id="M48" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> must be the same network (up to isomorphism). □</p>
<p>As for Corollary 2, we recall that it states that a canonical network <italic>N</italic> with the NELP property is uniquely determined by the trees it displays.</p>
<p><italic>Proof of Corollary 2</italic>. Let <italic>N</italic> and <italic>N</italic>′ be indistinguishable canonical networks satisfying the NELP property. Then, <italic>N</italic> and <italic>N</italic>′ are both canonical forms of <italic>N</italic> satisfying the NELP. But then, by Theorem 1(ii), <italic>N</italic> and <italic>N</italic>′ must be the same network (up to isomorphism). □</p>
</sec>
</sec>
<sec id="sec014">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004135.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004135.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supporting Information: a mathematical theory of explicit phylogenetic networks with edge lengths.</title>
<p>This document provides an introduction to the mathematical theory of explicit phylogenetic networks with edge lengths, leading in particular to the proofs of Propositions 1 and 2, which are necessary for the proof of Theorem 1, part (ii). In the last section, we consider networks with inheritance probabilities and their relevance for likelihood-based reconstruction.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We are grateful to O.Gascuel for advice on the structure of the paper.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004135.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Rupp</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name> (<year>2011</year>) <source>Phylogenetic Networks: Concepts, Algorithms and Applications</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name> (<year>2011</year>) <chapter-title>Evolutionary phylogenetic networks: models and issues</chapter-title>. In: <source>The Problem Solving Handbook in Computational Biology and Bioinformatics</source>, <publisher-name>Springer</publisher-name>. pp. <fpage>125</fpage>–<lpage>158</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Morrison</surname> <given-names>DA</given-names></name> (<year>2011</year>) <source>Introduction to Phylogenetic Networks</source>. <publisher-name>RJR Productions</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mallet</surname> <given-names>J</given-names></name> (<year>2007</year>) <article-title>Hybrid speciation</article-title>. <source>Nature</source> <volume>446</volume>: <fpage>279</fpage>–<lpage>283</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature05706" xlink:type="simple">10.1038/nature05706</ext-link></comment> <object-id pub-id-type="pmid">17361174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nolte</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Tautz</surname> <given-names>D</given-names></name> (<year>2010</year>) <article-title>Understanding the onset of hybrid speciation</article-title>. <source>Trends in Genetics</source> <volume>26</volume>: <fpage>54</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2009.12.001" xlink:type="simple">10.1016/j.tig.2009.12.001</ext-link></comment> <object-id pub-id-type="pmid">20044166</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ochman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Groisman</surname> <given-names>E</given-names></name> (<year>2000</year>) <article-title>Lateral gene transfer and the nature of bacterial innovation</article-title>. <source>Nature</source> <volume>405</volume>: <fpage>299</fpage>–<lpage>304</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35012500" xlink:type="simple">10.1038/35012500</ext-link></comment> <object-id pub-id-type="pmid">10830951</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boto</surname> <given-names>L</given-names></name> (<year>2010</year>) <article-title>Horizontal gene transfer in evolution: facts and challenges</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source> <volume>277</volume>: <fpage>819</fpage>–<lpage>827</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2009.1679" xlink:type="simple">10.1098/rspb.2009.1679</ext-link></comment> <object-id pub-id-type="pmid">19864285</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Smith</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Vijaykrishna</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bahl</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lycett</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Worobey</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Origins and evolutionary genomics of the 2009 swine-origin H1N1 influenza A epidemic</article-title>. <source>Nature</source> <volume>459</volume>: <fpage>1122</fpage>–<lpage>1125</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08182" xlink:type="simple">10.1038/nature08182</ext-link></comment> <object-id pub-id-type="pmid">19516283</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Posada</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Crandall</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>E</given-names></name> (<year>2004</year>) <article-title>The causes and consequences of HIV evolution</article-title>. <source>Nature Reviews Genetics</source> <volume>5</volume>: <fpage>52</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg1246" xlink:type="simple">10.1038/nrg1246</ext-link></comment> <object-id pub-id-type="pmid">14708016</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Simon-Loriere</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name> (<year>2011</year>) <article-title>Why do RNA viruses recombine?</article-title> <source>Nature Reviews Microbiology</source> <volume>9</volume>: <fpage>617</fpage>–<lpage>626</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrmicro2614" xlink:type="simple">10.1038/nrmicro2614</ext-link></comment> <object-id pub-id-type="pmid">21725337</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Song</surname> <given-names>YS</given-names></name>, <name name-style="western"><surname>Hein</surname> <given-names>J</given-names></name> (<year>2005</year>) <article-title>Constructing minimal ancestral recombination graphs</article-title>. <source>Journal of Computational Biology</source> <volume>12</volume>: <fpage>147</fpage>–<lpage>169</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2005.12.147" xlink:type="simple">10.1089/cmb.2005.12.147</ext-link></comment> <object-id pub-id-type="pmid">15767774</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Minichiello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name> (<year>2006</year>) <article-title>Mapping trait loci by use of inferred ancestral recombination graphs</article-title>. <source>American Journal of Human Genetics</source> <volume>79</volume>: <fpage>910</fpage>–<lpage>922</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/508901" xlink:type="simple">10.1086/508901</ext-link></comment> <object-id pub-id-type="pmid">17033967</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rasmussen</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Hubisz</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Gronau</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Siepel</surname> <given-names>A</given-names></name> (<year>2014</year>) <article-title>Genome-wide inference of ancestral recombination graphs</article-title>. <source>PLoS Genetics</source> <volume>10</volume>: <fpage>e1004342</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1004342" xlink:type="simple">10.1371/journal.pgen.1004342</ext-link></comment> <object-id pub-id-type="pmid">24831947</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bryant</surname> <given-names>D</given-names></name> (<year>2006</year>) <article-title>Application of phylogenetic networks in evolutionary studies</article-title>. <source>Molecular Biology and Evolution</source> <volume>23</volume>: <fpage>254</fpage>–<lpage>267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msj030" xlink:type="simple">10.1093/molbev/msj030</ext-link></comment> <object-id pub-id-type="pmid">16221896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bryant</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name> (<year>2004</year>) <article-title>Neighbor-net: An agglomerative method for the construction of phylogenetic networks</article-title>. <source>Molecular Biology and Evolution</source> <volume>21</volume>: <fpage>255</fpage>–<lpage>265</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msh018" xlink:type="simple">10.1093/molbev/msh018</ext-link></comment> <object-id pub-id-type="pmid">14660700</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Richter</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Rausch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dezulian</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Franz</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Dendroscope: An interactive viewer for large phylogenetic trees</article-title>. <source>BMC Bioinformatics</source> <volume>8</volume>: <fpage>460</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-8-460" xlink:type="simple">10.1186/1471-2105-8-460</ext-link></comment> <object-id pub-id-type="pmid">18034891</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hallström</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Kullberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nilsson</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Janke</surname> <given-names>A</given-names></name> (<year>2007</year>) <article-title>Phylogenomic data analyses provide evidence that Xenarthra and Afrotheria are sister groups</article-title>. <source>Molecular Biology and Evolution</source> <volume>24</volume>: <fpage>2059</fpage>–<lpage>2068</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msm136" xlink:type="simple">10.1093/molbev/msm136</ext-link></comment> <object-id pub-id-type="pmid">17630282</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="other">Lorentz Center (2012). The future of phylogenetic networks. Available: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.lorentzcenter.nl/lc/web/2012/515/description.php3?wsid = 515">http://www.lorentzcenter.nl/lc/web/2012/515/description.php3?wsid = 515</ext-link>. Accessed 20 Oct 2014.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bapteste</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>van Iersel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Janke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kelchner</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kelk</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Networks: expanding evolutionary thinking</article-title>. <source>Trends in Genetics</source> <volume>29</volume>: <fpage>439</fpage>–<lpage>441</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2013.05.007" xlink:type="simple">10.1016/j.tig.2013.05.007</ext-link></comment> <object-id pub-id-type="pmid">23764187</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="other">Morrison D (2013). What are evolutionary networks currently used for? Available: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://phylonetworks.blogspot.fr/2013/10/what-are-evolutionary-networks.html">http://phylonetworks.blogspot.fr/2013/10/what-are-evolutionary-networks.html</ext-link>. Accessed 20 Oct 2014.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Delwiche</surname> <given-names>CF</given-names></name>, <name name-style="western"><surname>Palmer</surname> <given-names>JD</given-names></name> (<year>1996</year>) <article-title>Rampant horizontal transfer and duplication of rubisco genes in eubacteria and plastids</article-title>. <source>Molecular Biology and Evolution</source> <volume>13</volume>: <fpage>873</fpage>–<lpage>882</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/oxfordjournals.molbev.a025647" xlink:type="simple">10.1093/oxfordjournals.molbev.a025647</ext-link></comment> <object-id pub-id-type="pmid">8754222</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Morgan</surname> <given-names>DR</given-names></name> (<year>2003</year>) <article-title>nrDNA external transcribed spacer (ETS) sequence data, reticulate evolution, and the systematics of Machaeranthera (Asteraceae)</article-title>. <source>Systematic Botany</source> <volume>28</volume>: <fpage>179</fpage>–<lpage>190</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Marhold</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lihová</surname> <given-names>J</given-names></name> (<year>2006</year>) <article-title>Polyploidy, hybridization and reticulate evolution: lessons from the Brassicaceae</article-title>. <source>Plant Systematics and Evolution</source> <volume>259</volume>: <fpage>143</fpage>–<lpage>174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00606-006-0417-x" xlink:type="simple">10.1007/s00606-006-0417-x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Koblmüller</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Duftner</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sefc</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Aibara</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stipacek</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Reticulate phylogeny of gastropod-shell-breeding cichlids from Lake Tanganyika—the result of repeated introgressive hybridization</article-title>. <source>BMC Evolutionary Biology</source> <volume>7</volume>: <fpage>7</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2148-7-7" xlink:type="simple">10.1186/1471-2148-7-7</ext-link></comment> <object-id pub-id-type="pmid">17254340</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Richards</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Soanes</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>PG</given-names></name>, <name name-style="western"><surname>Leonard</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Thornton</surname> <given-names>CR</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Phylogenomic analysis demonstrates a pattern of rare and ancient horizontal gene transfer between plants and fungi</article-title>. <source>The Plant Cell</source> <volume>21</volume>: <fpage>1897</fpage>–<lpage>1911</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1105/tpc.109.065805" xlink:type="simple">10.1105/tpc.109.065805</ext-link></comment> <object-id pub-id-type="pmid">19584142</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dyer</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Savolainen</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>H</given-names></name> (<year>2012</year>) <article-title>Apomixis and reticulate evolution in the Asplenium monanthes fern complex</article-title>. <source>Annals of Botany</source> <volume>110</volume>: <fpage>1515</fpage>–<lpage>1529</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/aob/mcs202" xlink:type="simple">10.1093/aob/mcs202</ext-link></comment> <object-id pub-id-type="pmid">22984165</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Thiergart</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Landan</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Schenk</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dagan</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>WF</given-names></name> (<year>2012</year>) <article-title>An evolutionary network of genes present in the eukaryote common ancestor polls genomes on eukaryotic and mitochondrial origin</article-title>. <source>Genome Biology and Evolution</source> <volume>4</volume>: <fpage>466</fpage>–<lpage>485</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/gbe/evs018" xlink:type="simple">10.1093/gbe/evs018</ext-link></comment> <object-id pub-id-type="pmid">22355196</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name> (<year>2011</year>) <article-title>A survey of combinatorial methods for phylogenetic networks</article-title>. <source>Genome Biology and Evolution</source> <volume>3</volume>: <fpage>23</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/gbe/evq077" xlink:type="simple">10.1093/gbe/evq077</ext-link></comment> <object-id pub-id-type="pmid">21081312</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Snir</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tuller</surname> <given-names>T</given-names></name> (<year>2006</year>) <article-title>Efficient parsimony-based methods for phylogenetic network reconstruction</article-title>. In: <source>Proceedings of the 5th European Conference on Computational Biology (ECCB)</source>. <comment>volume 23 of <italic>Bioinformatics</italic></comment>, pp. <fpage>e123</fpage>–<lpage>e128</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Snir</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tuller</surname> <given-names>T</given-names></name> (<year>2007</year>) <article-title>Inferring phylogenetic networks by the maximum parsimony criterion: A case study</article-title>. <source>Molecular Biology and Evolution</source> <volume>24</volume>: <fpage>324</fpage>–<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msl163" xlink:type="simple">10.1093/molbev/msl163</ext-link></comment> <object-id pub-id-type="pmid">17068107</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Snir</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tuller</surname> <given-names>T</given-names></name> (<year>2009</year>) <article-title>Parsimony score of phylogenetic networks: hardness results and a linear-time heuristic</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source> <volume>6</volume>: <fpage>495</fpage>–<lpage>505</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2008.119" xlink:type="simple">10.1109/TCBB.2008.119</ext-link></comment> <object-id pub-id-type="pmid">19644176</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Snir</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tuller</surname> <given-names>T</given-names></name> (<year>2006</year>) <article-title>Maximum likelihood of phylogenetic networks</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>2604</fpage>–<lpage>2611</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl452" xlink:type="simple">10.1093/bioinformatics/btl452</ext-link></comment> <object-id pub-id-type="pmid">16928736</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Park</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name> (<year>2012</year>) <article-title>Inference of reticulate evolutionary histories by maximum likelihood: the performance of information criteria</article-title>. <source>BMC Bioinformatics</source> <volume>13</volume>: <fpage>S12</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>van Iersel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kelk</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rupp</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Huson</surname> <given-names>D</given-names></name> (<year>2010</year>) <article-title>Phylogenetic networks do not need to be complex: Using fewer reticulations to represent conflicting clusters</article-title>. In: <source>Proceedings of the 18th Annual International Conference on Intelligent Systems for Molecular Biology (ISMB)</source>. <comment>volume 26 of <italic>Bioinformatics</italic></comment>, pp. <fpage>i124</fpage>–<lpage>i131</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>To</surname> <given-names>TH</given-names></name>, <name name-style="western"><surname>Habib</surname> <given-names>M</given-names></name> (<year>2009</year>) <article-title>Level-k phylogenetic networks are constructable from a dense triplet set in polynomial time</article-title>. In: <source>Combinatorial Pattern Matching: Proceeding of the 20th Annual Symposium Combinatorial Pattern Matching (CPM)</source>. <comment>volume 5577 of <italic>LNCS</italic></comment>, pp. <fpage>275</fpage>–<lpage>288</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Grünewald</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Forslund</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dress</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Moulton</surname> <given-names>V</given-names></name> (<year>2007</year>) <article-title>Qnet: An agglomerative method for the construction of phylogenetic networks from weighted quartets</article-title>. <source>Molecular Biology and Evolution</source> <volume>24</volume>: <fpage>532</fpage>–<lpage>538</lpage>. <object-id pub-id-type="pmid">17119010</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Baroni</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Semple</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name> (<year>2006</year>) <article-title>Hybrids in real time</article-title>. <source>Systematic Biology</source> <volume>55</volume>: <fpage>46</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10635150500431197" xlink:type="simple">10.1080/10635150500431197</ext-link></comment> <object-id pub-id-type="pmid">16507523</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Degnan</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name> (<year>2012</year>) <article-title>The probability of a gene tree topology within a phylogenetic network with applications to hybridization detection</article-title>. <source>PLoS genetics</source> <volume>8</volume>: <fpage>e1002660</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1002660" xlink:type="simple">10.1371/journal.pgen.1002660</ext-link></comment> <object-id pub-id-type="pmid">22536161</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="other">Radice R (2011) A Bayesian Approach to Phylogenetic Networks. Ph.D. thesis, University of Bath.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Gusfield</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Eddhu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Langley</surname> <given-names>C</given-names></name> (<year>2003</year>) <chapter-title>Efficient reconstruction of phylogenetic networks with constrained recombinations</chapter-title>. In: <source>Proceedings of the IEEE Computer Society Conference on Bioinformatics (CSB)</source>. <publisher-name>IEEE Computer Society</publisher-name>, p. <fpage>363</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004135.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name> (<year>2001</year>) <article-title>Perfect phylogenetic networks with recombination</article-title>. <source>Journal of Computational Biology</source> <volume>8</volume>: <fpage>69</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/106652701300099119" xlink:type="simple">10.1089/106652701300099119</ext-link></comment> <object-id pub-id-type="pmid">11339907</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Rupp</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Gambette</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>C</given-names></name> (<year>2009</year>) <article-title>Computing galled networks from real data</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>i85</fpage>–<lpage>i93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp217" xlink:type="simple">10.1093/bioinformatics/btp217</ext-link></comment> <object-id pub-id-type="pmid">19478021</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Choy</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jansson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sadakane</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sung</surname> <given-names>WK</given-names></name> (<year>2005</year>) <article-title>Computing the maximum agreement of phylogenetic networks</article-title>. <source>Theoretical Computer Science</source> <volume>335</volume>: <fpage>93</fpage>–<lpage>107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tcs.2004.12.012" xlink:type="simple">10.1016/j.tcs.2004.12.012</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cardona</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rosselló</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Valiente</surname> <given-names>G</given-names></name> (<year>2007</year>) <article-title>Comparison of tree-child phylogenetic networks</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source> <volume>6</volume>: <fpage>552</fpage>–<lpage>569</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2007.70270" xlink:type="simple">10.1109/TCBB.2007.70270</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cardona</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Llabrés</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rosselló</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Valiente</surname> <given-names>G</given-names></name> (<year>2008</year>) <article-title>A distance metric for a class of tree-sibling phylogenetic networks</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>1481</fpage>–<lpage>1488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn231" xlink:type="simple">10.1093/bioinformatics/btn231</ext-link></comment> <object-id pub-id-type="pmid">18477576</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref046">
<label>46</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Moret</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Linder</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tholse</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Phylogenetic networks: modeling, reconstructibility, and accuracy</article-title>. <source>IEEE Transactions on Computational Biology and Bioinformatics</source> <volume>1</volume>: <fpage>13</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2004.10" xlink:type="simple">10.1109/TCBB.2004.10</ext-link></comment> <object-id pub-id-type="pmid">17048405</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref047">
<label>47</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nakhleh</surname> <given-names>L</given-names></name> (<year>2010</year>) <article-title>A metric on the space of reduced phylogenetic networks</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source> <volume>7</volume>: <fpage>218</fpage>–<lpage>222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2009.2" xlink:type="simple">10.1109/TCBB.2009.2</ext-link></comment> <object-id pub-id-type="pmid">20431142</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref048">
<label>48</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Baroni</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Semple</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>MA</given-names></name> (<year>2004</year>) <article-title>A framework for representing reticulate evolution</article-title>. <source>Annals of Combinatorics</source> <volume>8</volume>: <fpage>391</fpage>–<lpage>408</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00026-004-0228-0" xlink:type="simple">10.1007/s00026-004-0228-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref049">
<label>49</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gambette</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>KT</given-names></name> (<year>2012</year>) <article-title>On encodings of phylogenetic networks of bounded level</article-title>. <source>Journal of Mathematical Biology</source> <volume>65</volume>: <fpage>157</fpage>–<lpage>180</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00285-011-0456-y" xlink:type="simple">10.1007/s00285-011-0456-y</ext-link></comment> <object-id pub-id-type="pmid">21755321</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref050">
<label>50</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cardona</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rosselló</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Valiente</surname> <given-names>G</given-names></name> (<year>2008</year>) <article-title>Tripartitions do not always discriminate phylogenetic networks</article-title>. <source>Mathematical Biosciences</source> <volume>211</volume>: <fpage>356</fpage>–<lpage>370</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.mbs.2007.11.003" xlink:type="simple">10.1016/j.mbs.2007.11.003</ext-link></comment> <object-id pub-id-type="pmid">18177903</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref051">
<label>51</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Willson</surname> <given-names>SJ</given-names></name> (<year>2011</year>) <article-title>Regular networks can be uniquely constructed from their trees</article-title>. <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source> <volume>8</volume>: <fpage>785</fpage>–<lpage>796</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2010.69" xlink:type="simple">10.1109/TCBB.2010.69</ext-link></comment> <object-id pub-id-type="pmid">20714025</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref052">
<label>52</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Delsuc</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Brinkmann</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Philippe</surname> <given-names>H</given-names></name> (<year>2005</year>) <article-title>Phylogenomics and the reconstruction of the tree of life</article-title>. <source>Nature Reviews Genetics</source> <volume>6</volume>: <fpage>361</fpage>–<lpage>375</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg1603" xlink:type="simple">10.1038/nrg1603</ext-link></comment> <object-id pub-id-type="pmid">15861208</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref053">
<label>53</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name> (<year>2012</year>) <article-title>Dendroscope 3: An interactive tool for rooted phylogenetic trees and networks</article-title>. <source>Systematic Biology</source> <volume>61</volume>: <fpage>1061</fpage>–<lpage>1067</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/sys062" xlink:type="simple">10.1093/sysbio/sys062</ext-link></comment> <object-id pub-id-type="pmid">22780991</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref054">
<label>54</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Albrecht</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Scornavacca</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cenci</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name> (<year>2012</year>) <article-title>Fast computation of minimum hybridization networks</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>191</fpage>–<lpage>197</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr618" xlink:type="simple">10.1093/bioinformatics/btr618</ext-link></comment> <object-id pub-id-type="pmid">22072387</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref055">
<label>55</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hein</surname> <given-names>J</given-names></name> (<year>1993</year>) <article-title>A heuristic method to reconstruct the history of sequences subject to recombination</article-title>. <source>Journal of Molecular Evolution</source> <volume>36</volume>: <fpage>396</fpage>–<lpage>405</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00182187" xlink:type="simple">10.1007/BF00182187</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004135.ref056">
<label>56</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Snir</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tuller</surname> <given-names>T</given-names></name> (<year>2009</year>) <article-title>The Net-HMM approach: Phylogenetic network inference by combining maximum likelihood and hidden Markov models</article-title>. <source>Journal of Bioinformatics and Computational Biology</source> <volume>7</volume>: <fpage>625</fpage>–<lpage>644</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1142/S021972000900428X" xlink:type="simple">10.1142/S021972000900428X</ext-link></comment> <object-id pub-id-type="pmid">19634195</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>