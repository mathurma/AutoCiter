<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-02123</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006387</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Electrophysiological techniques</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Brain mapping</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Clinical medicine</subject><subj-group><subject>Clinical neurophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Software tools</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Software tools</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>NFTsim: Theory and Simulation of Multiscale Neural Field Dynamics</article-title>
<alt-title alt-title-type="running-head">Simulation of Multiscale Neural Field Dynamics</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1545-6380</contrib-id>
<name name-style="western">
<surname>Sanz-Leon</surname> <given-names>Paula</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Robinson</surname> <given-names>Peter A.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Knock</surname> <given-names>Stuart A.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Drysdale</surname> <given-names>Peter M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9618-6457</contrib-id>
<name name-style="western">
<surname>Abeysuriya</surname> <given-names>Romesh G.</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Fung</surname> <given-names>Felix K.</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Rennie</surname> <given-names>Chris J.</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zhao</surname> <given-names>Xuelong</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Physics, University of Sydney, Sydney, Australia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Center for Integrative Brain Function, University of Sydney, Sydney, Australia</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Oxford Centre for Human Brain Activity, Wellcome Centre for Integrative Neuroimaging, Department of Psychiatry, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Downstate Medical Center, State University of New York, Brooklyn, New York, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Schneidman</surname> <given-names>Dina</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label> <p>Current address: School of Physics, University of Sydney, New South Wales, Australia</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">paula.sanz-leon@sydney.edu.au</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>22</day>
<month>8</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>8</issue>
<elocation-id>e1006387</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>1</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>7</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Sanz-Leon et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006387"/>
<abstract>
<p>A user ready, portable, documented software package, <italic>NFTsim</italic>, is presented to facilitate numerical simulations of a wide range of brain systems using continuum neural field modeling. <italic>NFTsim</italic> enables users to simulate key aspects of brain activity at multiple scales. At the microscopic scale, it incorporates characteristics of local interactions between cells, neurotransmitter effects, synaptodendritic delays and feedbacks. At the mesoscopic scale, it incorporates information about medium to large scale axonal ranges of fibers, which are essential to model dissipative wave transmission and to produce synchronous oscillations and associated cross-correlation patterns as observed in local field potential recordings of active tissue. At the scale of the whole brain, <italic>NFTsim</italic> allows for the inclusion of long range pathways, such as thalamocortical projections, when generating macroscopic activity fields. The multiscale nature of the neural activity produced by <italic>NFTsim</italic> has the potential to enable the modeling of resulting quantities measurable via various neuroimaging techniques. In this work, we give a comprehensive description of the design and implementation of the software. Due to its modularity and flexibility, <italic>NFTsim</italic> enables the systematic study of an unlimited number of neural systems with multiple neural populations under a unified framework and allows for direct comparison with analytic and experimental predictions. The code is written in C++ and bundled with Matlab routines for a rapid quantitative analysis and visualization of the outputs. The output of <italic>NFTsim</italic> is stored in plain text file enabling users to select from a broad range of tools for offline analysis. This software enables a wide and convenient use of powerful physiologically-based neural field approaches to brain modeling. <italic>NFTsim</italic> is distributed under the Apache 2.0 license.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Australian Research Council - Laureate Fellowship</institution>
</funding-source>
<award-id>FL1401000025</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Robinson</surname> <given-names>Peter A. A</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Centre of Excellence Integrative Brain Function Australian Research Council</institution>
</funding-source>
<award-id>CE140100007</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Robinson</surname> <given-names>Peter A. A</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by an Australian Research Council (<ext-link ext-link-type="uri" xlink:href="https://www.arc.gov.au" xlink:type="simple">www.arc.gov.au</ext-link>) Laureate Fellowship (grant number FL1401000025) and the Australian Research Council Center of Excellence for Integrative Brain Function (grant number CE140100007). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="5"/>
<page-count count="37"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-09-04</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. In addition, all configuration files used in the paper are available from the public repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/BrainDynamicsUSYD/nftsim" xlink:type="simple">https://github.com/BrainDynamicsUSYD/nftsim</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLoS Computational Biology</italic> Software paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The brain is a multiscale physical system, with structures ranging from the size of ion channels to the whole brain, and timescales running from sub-millisecond to multi-year durations. When modeling brain structure and dynamics, it is thus necessary to choose models that are appropriate to the scales of the phenomena involved. These range from microscale models of individual neurons and their substructures, through network-level models of discrete neurons, to population-level mesoscale and macroscale neural mass and neural field models that average over microstructure and apply from local brain areas up to the whole brain. Many useful results can be obtained analytically from models at various scales, either generally or when applied to specific brain systems and phenomena. However, in order to minimize approximations and make realistic predictions in complex situations, numerical simulations are usually necessary. The purpose of this paper is to present a neural field software package, <italic>NFTsim</italic>, that can simulate scales from a few tenths of a millimeter and a few milliseconds upward, thereby making contact with experiments [<xref ref-type="bibr" rid="pcbi.1006387.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>] and other classes of simulations over this range [<xref ref-type="bibr" rid="pcbi.1006387.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref008">8</xref>].</p>
<p>No one type of brain model is optimal at all scales. For example, single neuron models abound in neuroscience, and can include a large number of biophysical effects with relatively few approximations. Many such models have also been used to study networks of interconnected neurons with varying degrees of idealization, thereby revealing a huge number of insights [<xref ref-type="bibr" rid="pcbi.1006387.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref011">11</xref>]. However, several key problems arise as network size grows: (i) the computational resources required become prohibitive, meaning that simulations can often only be carried out in physiologically unrealistic scenarios, typically with idealized neurons, which may be quantitatively and/or qualitatively inappropriate for the real brain; (ii) it is increasingly difficult to measure and assign biophysical parameters to the individual neurons—e.g., individual connectivities, synaptic strengths, or morphological features, so large groups of neurons are typically assigned identical parameters, thereby partly removing the specificity of such simulations; (iii) analysis and interpretation of results, such as large collections of timeseries of individual soma voltages, becomes increasingly difficult and demanding on storage and postprocessing; (iv) emergence of collective network-level phenomena can be difficult to recognize; (v) the scales of these simulations are well suited to relate to single-neuron measurements, and microscopic pieces of brain tissue, but are distant from those of noninvasive imaging modalities such as functional magnetic resonance imaging (fMRI), electroencephalography (EEG), and magnetoencephalography (MEG) [<xref ref-type="bibr" rid="pcbi.1006387.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref014">14</xref>], which detect signals that result from the aggregate activity of large numbers of neurons; and (vi), inputs from other parts of the brain are neglected, meaning that such models tend to represent isolated pieces of neural tissue.</p>
<p>At the level of neurons and neuronal networks [<xref ref-type="bibr" rid="pcbi.1006387.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref016">16</xref>], software is abundant, including BRIAN, NEURON, GENESIS, and NeoCortical Simulator [<xref ref-type="bibr" rid="pcbi.1006387.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref022">22</xref>]. A detailed review of tools and implementation strategies for spiking neural network simulations can be found in [<xref ref-type="bibr" rid="pcbi.1006387.ref009">9</xref>].</p>
<p>At the largest scales, neural mass models average the properties of huge numbers of neurons into those of a single population, without taking account of its spatial aspects. This enables the temporal dynamics of whole neural populations to be approximated, but information on individual neurons and spatial dynamics and patterns is not tracked. This scale can be used to study whole-brain phenomena such as generalized seizures, if time delays within each mass can be neglected. This approach has been used to treat relatively coarse-grained networks of interacting cortical brain regions, each modeled as a neural mass. However, it is rare to see careful attention paid to the need for these representations to approach the continuum limit, in which the cortex is treated as a continuous sheet of neural tissue, as the size of the regions decreases [<xref ref-type="bibr" rid="pcbi.1006387.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref025">25</xref>], thereby throwing some such discretizations into question. Of course, neural structure is not truly continuous, but its granularity is at a far finer scale than that of the discretizations just mentioned.</p>
<p>Above the single-neuron scale and extending to encompass the neural-mass limit as a special case, neural field approaches retain spatial information in a continuum limit in which properties such as firing rate and soma voltage are viewed as local averages over many neurons, and can vary from point to point, and as functions of time; when correctly discretized, neural mass models are a limiting case of the more general neural fields and should not be viewed as a separate category. Neural fields approximate rate-based models of single neurons from the small scale, while retaining relative timings between neural inputs and outputs. Simultaneously, they self-consistently add spatial structure that is neglected in neural mass models. Hybrid models with features of both neural fields and spiking neurons have also been developed and used to clarify the relationship between these approaches [<xref ref-type="bibr" rid="pcbi.1006387.ref003">3</xref>], or to enable single-neuron dynamics to be influenced by average neural fields [<xref ref-type="bibr" rid="pcbi.1006387.ref026">26</xref>], but we do not discuss these classes of models further here.</p>
<p>The issues discussed in the preceding paragraphs are closely analogous to ones that arise in other branches of physics. Specifically, no single model can cover all scales at once. Rather, a hierarchy of models is needed, from the microscale to the macroscale, each relating predictions to measurements at its operational scale. This yields tractable models that can be interpreted in terms of concepts and measurements that apply at the appropriate scales for a given phenomenon. Importantly, each model needs to be related to the ones at nearby scales, especially by making complementary predictions at overlapping scales of common applicability. By analogy, molecular dynamics approaches and statistical mechanics (akin to single neuron approaches) are widely used to track molecules at the microscopic scale, but large-scale theories like thermodynamics and fluid mechanics (akin to neural mass and neural field methods) are more useful and tractable for macroscopic phenomena, and their predictions can be more easily interpreted. At intermediate scales, nonequilibrium thermodynamics and fluctuation theory meet with statistical mechanics and molecular approaches to make complementary predictions of the same phenomena; so that consistency of the various approaches in their common domain can be established. Although molecular-level and spiking-neuron approaches are more fundamental, they are not practical at large scales, and yield results that have to be reinterpreted in terms of larger-scale observables in any case. Conversely, thermodynamic and neural-field approaches fail at spatial and temporal scales that are too short to justify the relevant averaging over a system’s microscopic constituents.</p>
<p>Neural field theory (NFT) incorporates multiple scales such as neurotransmitter effects, synaptodendritic dynamics at the microscale; an average of medium to long-range corticocortical axonal ranges which are essential to model dissipative wave transmission and to produce synchronous oscillations at the mesoscopic scale; and, long-range time delays at the macroscopic scale of the whole brain. Thus, NFT both provides useful macroscopic predictions and can reach down to mesoscopic scales that now overlap with those that can be simulated with neuron-level methods. This provides a range of common applicability on scales of around 1 mm, or slightly less, where complementary predictions can be made and tested—an overlap that will increase as microscopic simulations increase in scale. Equally significantly, quantitative neural field predictions can readily be made of quantities observable by EEG, MEG, fMRI, electrocorticography (ECoG), and other imaging technologies, by adding the biophysics of these signals, measurement procedures, and postprocessing [<xref ref-type="bibr" rid="pcbi.1006387.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref030">30</xref>]. This enables predictions of a single brain model to be tested against multiple phenomena in order to better determine the relevant physiological parameters.</p>
<p>As an illustration of the versatility of NFT approaches, we note that the particular NFT on which the present <italic>NFTsim</italic> software is based has been extensively applied and quantitatively tested against experiments, including EEG, evoked response potentials (ERPs), ECoG, age-related changes to the physiology of the brain, sleep and arousal dynamics, seizures, Parkinson’s disease, and other disorders, transcranial magnetic stimulation (TMS), synaptic plasticity phenomena [<xref ref-type="bibr" rid="pcbi.1006387.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref039">39</xref>]. Indeed, one of the major strengths of this NFT is its versatility: within the same framework we can express different models to study purely cortical phenomena, the corticothalamic system, basal ganglia, sleep dynamics, or the visual cortex, among an essentially unlimited number of other applications [<xref ref-type="bibr" rid="pcbi.1006387.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref035">35</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref043">43</xref>]. This NFT has also been clearly linked to hybrid spiking-field approaches [<xref ref-type="bibr" rid="pcbi.1006387.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref026">26</xref>], and to network and connection-matrix representations of spatial structure in the brain [<xref ref-type="bibr" rid="pcbi.1006387.ref044">44</xref>], usually obtained via fMRI.</p>
<p>We stress that the NFT embodied in <italic>NFTsim</italic> is not the only possibility. Other NFTs have been developed and applied by numerous authors [<xref ref-type="bibr" rid="pcbi.1006387.ref045">45</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref053">53</xref>], each of which has been applied to one or more physical situations in these and subsequent publications. This list is not exhaustive, since the present work is not intended as a review, but more examples can be found in [<xref ref-type="bibr" rid="pcbi.1006387.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref025">25</xref>], and [<xref ref-type="bibr" rid="pcbi.1006387.ref054">54</xref>]. Notably, most of these NFTs can be expressed in the notation of the present paper, and can thus be simulated with the <italic>NFTsim</italic> software described below. Some of these previous neural field models leave out physical effects that are included in <italic>NFTsim</italic>, while others include additional features that remain to be incorporated in a future version of the code.</p>
<p>A few software packages are available to model neural masses and neural fields: [<xref ref-type="bibr" rid="pcbi.1006387.ref007">7</xref>] developed a neuroinformatics platform for large-scale brain modeling in terms of a network of linked neural masses with anatomically specified cortical geometry [<xref ref-type="bibr" rid="pcbi.1006387.ref054">54</xref>], long-range connectivity, and local short-range connectivity that approximates the continuum limit when it is Gaussian and homogeneous [<xref ref-type="bibr" rid="pcbi.1006387.ref024">24</xref>]. While the mathematical framework described in [<xref ref-type="bibr" rid="pcbi.1006387.ref054">54</xref>] allows for neural field models to be treated using realistic geometry on nonregular grids, a user-ready implementation is not currently available. Similarly, the Brain Dynamics Toolbox [<xref ref-type="bibr" rid="pcbi.1006387.ref055">55</xref>] provides tools for network-based and continuum models of brain dynamics. The most recent simulation tool for spatiotemporal neural dynamics is the Neural Field Simulator [<xref ref-type="bibr" rid="pcbi.1006387.ref008">8</xref>], which allows for study of a range of 2D neural field models on a square grid. However, this software does not allow for either the simulation of neural field models with heterogeneous parameters or with multiple populations.</p>
<p>To address the need for research-ready NFT simulation tools with direct application to the study of large-scale brain phenomena, this paper introduces and describes <italic>NFTsim</italic>, a software package that solves neural field equations expressed in differential form for simulating spatially extended systems containing arbitrary numbers of neural populations. The examples of dynamics provided in this work represent perturbations around a fixed point to follow what has been done in previous analytic work. However, <italic>NFTsim</italic> is not limited to the simulation of such dynamics and can produce a range of oscillatory [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref056">56</xref>], chaotic [<xref ref-type="bibr" rid="pcbi.1006387.ref057">57</xref>] and bursting dynamics [<xref ref-type="bibr" rid="pcbi.1006387.ref058">58</xref>].</p>
</sec>
<sec id="sec002">
<title>Neural field theory</title>
<p>Neural field theory (NFT) treats multiscale brain activity by averaging neural quantities such as firing rate, soma voltage, and incoming and outgoing activity over multiple neurons. The scales over which neural field models average must be sufficient to represent large numbers of neurons and spikes, but can still be small enough to resolve quite fine structure in the brain and its activity. <italic>NFTsim</italic> allows an arbitrary number <italic>p</italic> of spatially extended populations of neurons to be simulated. Each of these can be distinguished by its location (e.g., belonging to the cortex or a particular nucleus) and its neural type (e.g., pyramidal excitatory, interneuron). To model a particular system, we must specify the neural populations and the connections between them, including self-connections within a population. If we introduce position and time coordinates <bold>r</bold> and <italic>t</italic>, the main macroscopic variables that describe the activity of neural populations <italic>a</italic> and their interaction with other populations <italic>b</italic> are: the incoming, axonal spike-rate fields <italic>ϕ</italic><sub><italic>ab</italic></sub>(<bold>r</bold>, <italic>t</italic>) arriving at population <italic>a</italic> at (<bold>r</bold>, <italic>t</italic>) from population <italic>b</italic>, the dendritic potentials <italic>V</italic><sub><italic>ab</italic></sub>(<bold>r</bold>, <italic>t</italic>), the mean soma potential <italic>V</italic><sub><italic>a</italic></sub>(<bold>r</bold>, <italic>t</italic>), the mean firing rate <italic>Q</italic><sub><italic>a</italic></sub>(<bold>r</bold>, <italic>t</italic>), and the axonal fields <italic>ϕ</italic><sub><italic>ca</italic></sub>(<bold>r</bold>, <italic>t</italic>) propagating to other populations <italic>c</italic> from population <italic>a</italic>. <xref ref-type="fig" rid="pcbi.1006387.g001">Fig 1</xref> illustrates the interactions of these quantities: (i) synaptodendritic dynamics involving the incoming axonal fields <italic>ϕ</italic><sub><italic>ab</italic></sub>(<bold>r</bold>, <italic>t</italic>) to yield the potentials <italic>V</italic><sub><italic>ab</italic></sub>(<bold>r</bold>, <italic>t</italic>); (ii) dendritic summation and soma charging processes to yield the soma potential <italic>V</italic><sub><italic>a</italic></sub>(<bold>r</bold>, <italic>t</italic>); (iii) generation of pulses <italic>Q</italic><sub><italic>a</italic></sub>(<bold>r</bold>, <italic>t</italic>) at the axonal hillock, and (iv) axonal propagation of pulses <italic>ϕ</italic><sub><italic>ca</italic></sub>(<bold>r</bold>, <italic>t</italic>) within and between neural populations [<xref ref-type="bibr" rid="pcbi.1006387.ref001">1</xref>]. The following subsections present a review of the equations describing these physiological processes, while <xref ref-type="table" rid="pcbi.1006387.t001">Table 1</xref> summarizes the quantities and symbols used in NFT and their SI units. Note that neural field models can be expressed in integrodifferential form [<xref ref-type="bibr" rid="pcbi.1006387.ref053">53</xref>]. However, in that form, there is always a convolution that is either difficult to handle analytically or numerically [<xref ref-type="bibr" rid="pcbi.1006387.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref059">59</xref>]. For that reason, all the equations in this NFT [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>] and <italic>NFTsim</italic> are expressed and implemented in differential form, respectively.</p>
<fig id="pcbi.1006387.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schematic of the dynamical processes that occur within and between neural populations.</title>
<p>Gray circles are quantities associated with interactions between populations (i.e., <italic>a</italic> and <italic>b</italic>), while white circles are quantities associated with a population (i.e., <italic>a</italic> or <italic>b</italic>). Spike-rate fields <italic>ϕ</italic><sub><italic>ab</italic></sub> arriving at neurons of type <italic>a</italic> from ones of type <italic>b</italic> are modulated by the synaptic dynamics, and undergo dendritic dynamics to produce postsynaptic subpotentials <italic>V</italic><sub><italic>ab</italic></sub>. These contributions are linearly summed in the dendritic tree, eventually resulting in charging currents at the soma that give rise to the soma potential <italic>V</italic><sub><italic>a</italic></sub>, after allowing for capacitive effects and leakage. Action potentials generated at the axonal hillock are averaged over a population of neurons. Then, when the mean soma voltage exceeds a threshold, the mean firing rate <italic>Q</italic><sub><italic>a</italic></sub> of the population is obtained via a nonlinear response function. Finally, the pulses propagate away across the axonal tree and the dendrites of the receiving population <italic>c</italic> as the set of average spike-rate fields <italic>ϕ</italic><sub><italic>ca</italic></sub>. Note that self-connections with <italic>b</italic> = <italic>a</italic> or <italic>c</italic> = <italic>a</italic> are included.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g001" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1006387.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.t001</object-id>
<label>Table 1</label>
<caption>
<title>NFT quantities and associated SI units.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006387.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="border-right:thick;border-bottom:thick">Symbol</th>
<th align="left" style="border-bottom:thick">Description</th>
<th align="left" style="border-bottom:thick">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" style="border-right:thick">
<inline-formula id="pcbi.1006387.e001">
<alternatives>
<graphic id="pcbi.1006387.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e001" xlink:type="simple"/>
<mml:math display="inline" id="M1">
<mml:msubsup>
<mml:mi>Q</mml:mi>
<mml:mrow>
<mml:mi>a</mml:mi>
</mml:mrow>
<mml:mtext>max</mml:mtext>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">Maximum firing rate</td>
<td align="left">s<sup>−1</sup></td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>γ</italic><sub><italic>ab</italic></sub></td>
<td align="left">Damping rate</td>
<td align="left">s<sup>−1</sup></td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>v</italic><sub><italic>ab</italic></sub></td>
<td align="left">Wave velocity</td>
<td align="left">m s<sup>−1</sup></td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>r</italic><sub><italic>ab</italic></sub></td>
<td align="left">Mean axonal range</td>
<td align="left">m</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>θ</italic><sub><italic>a</italic></sub></td>
<td align="left">Mean neural firing threshold</td>
<td align="left">V</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<inline-formula id="pcbi.1006387.e002">
<alternatives>
<graphic id="pcbi.1006387.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e002" xlink:type="simple"/>
<mml:math display="inline" id="M2">
<mml:msubsup>
<mml:mi>σ</mml:mi>
<mml:mi>a</mml:mi>
<mml:mo>′</mml:mo>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">Standard deviation of the firing threshold</td>
<td align="left">V</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>α</italic><sub><italic>ab</italic></sub></td>
<td align="left">Mean dendritic response decay rate</td>
<td align="left">s<sup>−1</sup></td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>β</italic><sub><italic>ab</italic></sub></td>
<td align="left">Mean dendritic response rise rate</td>
<td align="left">s<sup>−1</sup></td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>ν</italic><sub><italic>ab</italic></sub></td>
<td align="left">Synaptic coupling strength</td>
<td align="left">V s</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>τ</italic><sub><italic>ab</italic></sub></td>
<td align="left">Long range time delay</td>
<td align="left">s</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>ϕ</italic><sub><italic>ab</italic></sub></td>
<td align="left">Axonal field</td>
<td align="left">s<sup>−1</sup></td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>Q</italic><sub><italic>a</italic></sub></td>
<td align="left">Mean firing rate</td>
<td align="left">s<sup>−1</sup></td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>V</italic><sub><italic>ab</italic></sub></td>
<td align="left">Subpotential</td>
<td align="left">V</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>V</italic><sub><italic>a</italic></sub></td>
<td align="left">Mean soma potential</td>
<td align="left">V</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>Symbols used in NFT, associated physical quantities and their SI units. Double subscripts <italic>ab</italic> mean that the target population is <italic>a</italic> and the source population is <italic>b</italic>.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<sec id="sec003">
<title>Synaptodendritic dynamics and the soma potential</title>
<p>When spikes arrive at synapses on neurons of population <italic>a</italic> from a neural population <italic>b</italic>, they initiate neurotransmitter release and consequent synaptic dynamics, like transmembrane potential changes, followed by dendritic propagation of currents that result in soma charging and consequent modifications of the soma potential. Each of these processes involves its own dynamics and time delays and results in low pass filtering and temporal smoothing of the original spike until the soma response is spread over a time interval that is typically tens of ms, exhibiting a fast rise and an approximately exponential decay [<xref ref-type="bibr" rid="pcbi.1006387.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref060">60</xref>].</p>
<p>If the overall synaptodendritic and soma responses are linear, which is the most common approximation in the literature [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref061">61</xref>], the total soma potential <italic>V</italic><sub><italic>a</italic></sub> is the sum of subpotential contributions <italic>V</italic><sub><italic>ab</italic></sub>, which are components of perturbation to the dendritic transmembrane potential, arriving at each type of dendritic synapse <italic>ab</italic>. The subscript <italic>a</italic> denotes the receiving population and <italic>b</italic> denotes the neural population from which the incoming spikes originate, distinguished by its source and the neurotransmitter type. The subpotentials <italic>V</italic><sub><italic>ab</italic></sub> at a particular location comprise contributions from both the wave fields <italic>ϕ</italic><sub><italic>ab</italic></sub> from other internal populations <italic>b</italic> and inputs <italic>ϕ</italic><sub><italic>ax</italic></sub> from external populations <italic>x</italic> [<xref ref-type="bibr" rid="pcbi.1006387.ref062">62</xref>]; the external inputs are often split into a uniform mean nonspecific excitation and a specific excitation due to structured stimuli. Thus we write the total mean cell body potential as the sum of postsynaptic subpotentials
<disp-formula id="pcbi.1006387.e003"><alternatives><graphic id="pcbi.1006387.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>b</mml:mi></mml:munder> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where the subscript <italic>b</italic> distinguishes the different combinations of afferent neural type and synaptic receptor and all the potentials are measured relative to resting [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>].</p>
<p>The overall effect of synaptodendritic dynamics and soma charging in response to an incoming weighted pulse-rate field <italic>ϕ</italic><sub><italic>ab</italic></sub> are well described by an impulse response kernel <italic>L</italic><sub><italic>ab</italic></sub>(<italic>t</italic> − <italic>t</italic>′)
<disp-formula id="pcbi.1006387.e004"><alternatives><graphic id="pcbi.1006387.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:munderover> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo></mml:math></alternatives> <label>(2)</label></disp-formula>
<disp-formula id="pcbi.1006387.e005"><alternatives><graphic id="pcbi.1006387.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>ϕ</italic><sub><italic>ab</italic></sub> is the average rate of spikes arriving at <italic>a</italic> from population <italic>b</italic>; the time delay <italic>τ</italic><sub><italic>ab</italic></sub> is nonzero when <italic>a</italic> and <italic>b</italic> are in anatomical structures that are separated by a nonzero distance [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>]. In <xref ref-type="disp-formula" rid="pcbi.1006387.e005">Eq (3)</xref>, <italic>N</italic><sub><italic>ab</italic></sub> is the mean number of connections of mean time-integrated synaptic strength <italic>s</italic><sub><italic>ab</italic></sub> to a cell of type <italic>a</italic> from cells of type <italic>b</italic>. In [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>], <italic>L</italic><sub><italic>ab</italic></sub> is a nonnegative response kernel with
<disp-formula id="pcbi.1006387.e006"><alternatives><graphic id="pcbi.1006387.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
and <italic>L</italic><sub><italic>ab</italic></sub>(<bold>r</bold>, <italic>u</italic>) = 0 for <italic>u</italic> &lt; 0 to express causality. Note that <italic>τ</italic><sub><italic>ab</italic></sub> are not the only time delays in the system. Propagation delays within a single structure, such as the cortex, are handled by accounting for axonal propagation, as described in section <italic>Propagation of axonal pulse-rate fields</italic>. In <italic>NFTsim</italic> <italic>L</italic><sub><italic>ab</italic></sub>(<bold>r</bold>, <italic>t</italic>) is defined as
<disp-formula id="pcbi.1006387.e007"><alternatives><graphic id="pcbi.1006387.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>{</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mi>t</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mi>t</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>}</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>β</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi>t</mml:mi> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mi>t</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:mi>β</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
for <italic>t</italic> ≥ 0, with <italic>L</italic><sub><italic>ab</italic></sub>(<bold>r</bold>, <italic>t</italic>) = 0 for <italic>t</italic> &lt; 0 and the <bold>r</bold>-dependence of the positive constants <italic>α</italic> and <italic>β</italic> has been omitted for compactness. These quantities parametrize the decay rate and rise rate of the soma response, respectively, and <italic>β</italic> ≥ <italic>α</italic> is assumed without loss of generality. The temporal profile of the dendritic response function is illustrated in <xref ref-type="fig" rid="pcbi.1006387.g002">Fig 2</xref>. This function peaks at <italic>t</italic> = ln(<italic>β</italic>/<italic>α</italic>)/(<italic>β</italic> − <italic>α</italic>) for <italic>α</italic> ≠ <italic>β</italic>; if <italic>α</italic> = <italic>β</italic>, the peak is at <italic>t</italic> = 1/<italic>α</italic>. In addition, there are two special cases of <xref ref-type="disp-formula" rid="pcbi.1006387.e007">Eq (5)</xref>: (i) if either <italic>α</italic> → ∞ or <italic>β</italic> → ∞, then <italic>L</italic><sub><italic>ab</italic></sub> becomes a single exponential function in which only one of the characteristic timescales dominates; and, (ii) if <italic>α</italic> = <italic>β</italic> = ∞, then the kernel reduces to the impulse <italic>L</italic><sub><italic>ab</italic></sub>(<bold>r</bold>, <italic>t</italic>) = <italic>δ</italic>(<bold>r</bold>, <italic>t</italic>).</p>
<fig id="pcbi.1006387.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Dendritic response function.</title>
<p>The response to a delta-function input, via <italic>L</italic><sub><italic>ab</italic></sub> as defined in <xref ref-type="disp-formula" rid="pcbi.1006387.e007">Eq (5)</xref>, for decay rate parameter <italic>α</italic><sub><italic>ab</italic></sub> = 45 s<sup>−1</sup> and rise rate parameter <italic>β</italic><sub><italic>ab</italic></sub> = 185 s<sup>−1</sup>. This function peaks at <italic>t</italic> = ln(<italic>β</italic>/<italic>α</italic>)/(<italic>β</italic> − <italic>α</italic>) for <italic>α</italic> ≠ <italic>β</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g002" xlink:type="simple"/>
</fig>
<p>The convolution in <xref ref-type="disp-formula" rid="pcbi.1006387.e004">Eq (2)</xref> can be re-expressed as
<disp-formula id="pcbi.1006387.e008"><alternatives><graphic id="pcbi.1006387.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where the differential operator <italic>D</italic><sub><italic>ab</italic></sub> is given by
<disp-formula id="pcbi.1006387.e009"><alternatives><graphic id="pcbi.1006387.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:msup><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>)</mml:mo> <mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
In some previous work [<xref ref-type="bibr" rid="pcbi.1006387.ref060">60</xref>] a special approximation has been used where <italic>α</italic><sub><italic>ab</italic></sub> and <italic>β</italic><sub><italic>ab</italic></sub> are independent of <italic>b</italic> and are thus treated as effective values, representing an average over different receptor time constants. Under this approximation <xref ref-type="disp-formula" rid="pcbi.1006387.e008">Eq (6)</xref> becomes
<disp-formula id="pcbi.1006387.e010"><alternatives><graphic id="pcbi.1006387.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:msub><mml:mi>V</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>b</mml:mi></mml:munder> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
All the aforementioned cases and forms of the operators (differential and integral) are implemented in <italic>NFTsim</italic>.</p>
</sec>
<sec id="sec004">
<title>Generation of pulses</title>
<p>Pulses (i.e., spikes or action potentials) are produced at the axonal hillock when the soma potential exceeds a threshold potential <italic>θ</italic><sub><italic>a</italic></sub>(<bold>r</bold>, <italic>t</italic>). When we consider the mean response of a population of neurons to a mean soma potential we must bear in mind that each neuron has slightly different morphology and environment. Hence, they respond slightly differently in the same mean environment. This has the effect of blurring the firing threshold and the resulting overall population response function is widely approximated by the nonlinear form [<xref ref-type="bibr" rid="pcbi.1006387.ref048">48</xref>]
<disp-formula id="pcbi.1006387.e011"><alternatives><graphic id="pcbi.1006387.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <italic>θ</italic><sub><italic>a</italic></sub> is the mean threshold potential of population <italic>a</italic> and <italic>S</italic><sub><italic>a</italic></sub> is a function that increases monotonically from zero at large negative <italic>V</italic><sub><italic>a</italic></sub> to a maximum firing rate <inline-formula id="pcbi.1006387.e012"><alternatives><graphic id="pcbi.1006387.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>a</mml:mi> <mml:mtext>max</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> at large positive <italic>V</italic><sub><italic>a</italic></sub>, with the steepest increase concentrated around the mean threshold <italic>θ</italic><sub><italic>a</italic></sub>. <italic>NFTsim</italic> employs by default the nonlinear sigmoid response function
<disp-formula id="pcbi.1006387.e013"><alternatives><graphic id="pcbi.1006387.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>a</mml:mi></mml:mrow> <mml:mtext>max</mml:mtext></mml:msubsup> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>a</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <inline-formula id="pcbi.1006387.e014"><alternatives><graphic id="pcbi.1006387.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow> <mml:mi>a</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mi>π</mml:mi> <mml:mo>/</mml:mo> <mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> is the population standard deviation of the soma voltage relative to the threshold. If the function in <xref ref-type="disp-formula" rid="pcbi.1006387.e013">Eq (10)</xref> is linearized to consider small perturbations around a steady state of the system [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref032">32</xref>], one finds the linear response function
<disp-formula id="pcbi.1006387.e015"><alternatives><graphic id="pcbi.1006387.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where <inline-formula id="pcbi.1006387.e016"><alternatives><graphic id="pcbi.1006387.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006387.e017"><alternatives><graphic id="pcbi.1006387.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are the relevant steady-state values and <italic>ρ</italic><sub><italic>a</italic></sub> = <italic>dQ</italic><sub><italic>a</italic></sub>/<italic>dV</italic><sub><italic>a</italic></sub>, is the slope of the sigmoid function, evaluated at <inline-formula id="pcbi.1006387.e018"><alternatives><graphic id="pcbi.1006387.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>]. This linear population response function is also implemented in <italic>NFTsim</italic> and other functional forms can be defined as well.</p>
</sec>
<sec id="sec005">
<title>Propagation of axonal pulse-rate fields</title>
<p>The propagation of the pulses <italic>Q</italic><sub><italic>b</italic></sub>(<bold>r</bold>, <italic>t</italic>) in each population <italic>b</italic> generates an outgoing mean field <italic>ϕ</italic><sub><italic>ab</italic></sub> that propagates via axons to the population <italic>a</italic> at other locations. In general, this propagation can depend on both the initial and final populations, and can incorporate arbitrary nonuniformities and a range of propagation velocities via propagator methods, for example [<xref ref-type="bibr" rid="pcbi.1006387.ref059">59</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref063">63</xref>]. However, considerable theoretical and experimental work has shown that, to a good approximation, the mean field of axonal signals in a smoothly structured neural population propagates approximately as if governed by an isotropic damped wave equation [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref064">64</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref069">69</xref>]. In <italic>NFTsim</italic> we implement the widely used equation
<disp-formula id="pcbi.1006387.e019"><alternatives><graphic id="pcbi.1006387.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">D</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
with
<disp-formula id="pcbi.1006387.e020"><alternatives><graphic id="pcbi.1006387.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">D</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>∂</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>2</mml:mn> <mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>∂</mml:mi> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mo>∇</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
where <italic>γ</italic><sub><italic>ab</italic></sub> = <italic>v</italic><sub><italic>ab</italic></sub>/<italic>r</italic><sub><italic>ab</italic></sub> is a temporal damping coefficient, <italic>r</italic><sub><italic>ab</italic></sub> is the spatial effective axonal range, <italic>v</italic><sub><italic>ab</italic></sub> is the axonal velocity [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref065">65</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref069">69</xref>], and ∇<sup>2</sup> is the Laplacian operator. Eqs <xref ref-type="disp-formula" rid="pcbi.1006387.e019">(12)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006387.e020">(13)</xref> constitute the two-dimensional generalization of the telegrapher’s equation [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref070">70</xref>]. More generally, <italic>γ</italic><sub><italic>ab</italic></sub>, <italic>r</italic><sub><italic>ab</italic></sub>, and <italic>v</italic><sub><italic>ab</italic></sub> can be functions of position. If the special case of spatially uniform activity is considered, the Laplacian operator has no effect and can be omitted from <xref ref-type="disp-formula" rid="pcbi.1006387.e020">(13)</xref>. This special case results in the harmonic operator
<disp-formula id="pcbi.1006387.e021"><alternatives><graphic id="pcbi.1006387.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">D</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>∂</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>2</mml:mn> <mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mstyle> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>∂</mml:mi> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
We stress that this is not the same as using a local neural mass model because the damping parameter <italic>γ</italic><sub><italic>ab</italic></sub> depends on spatial propagation. To obtain the neural mass limit, one also needs to set the spatial ranges <italic>r</italic><sub><italic>ab</italic></sub> = 0 so <italic>γ</italic><sub><italic>ab</italic></sub> becomes infinite and
<disp-formula id="pcbi.1006387.e022"><alternatives><graphic id="pcbi.1006387.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">D</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
This yields
<disp-formula id="pcbi.1006387.e023"><alternatives><graphic id="pcbi.1006387.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
which is termed the <italic>local interaction approximation</italic> [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref050">50</xref>].</p>
<p>The parameter <italic>r</italic><sub><italic>ab</italic></sub> in the propagators in Eqs <xref ref-type="disp-formula" rid="pcbi.1006387.e020">(13)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006387.e021">(14)</xref> encompasses divergence of axons traveling to the target population <italic>a</italic> from the source population <italic>b</italic> and the extent of dendritic arborization of the target population <italic>a</italic>, and thus <italic>r</italic><sub><italic>ab</italic></sub> ≠ <italic>r</italic><sub><italic>ba</italic></sub> in general [<xref ref-type="bibr" rid="pcbi.1006387.ref071">71</xref>].</p>
</sec>
</sec>
<sec id="sec006">
<title>Design and implementation of <italic>NFTsim</italic></title>
<p>This section presents a comprehensive description of <italic>NFTsim</italic>. The subsection <italic>General workflow</italic> gives an overview of the typical usage workflow of <italic>NFTsim</italic>. The subsection <italic>Classes and their interactions</italic> describes the main <italic>NFTsim</italic> classes, which represent the biophysical processes and quantities introduced in <italic>Neural field theory</italic>. Next, subsection <italic>Input-output</italic> illustrates with examples how to specify a model in the input configuration file to <italic>NFTsim</italic> and how to interpret the output file. In addition, subsection <italic>Numerical methods, considerations, and constraints</italic> elaborates on the numerical approaches and constraints used to correctly solve the equations of neural field models while attaining numerical accuracy and stability. <xref ref-type="table" rid="pcbi.1006387.t002">Table 2</xref> summarizes the configuration parameters relevant to these methods. Lastly, subsection <italic>Analysis and visualization</italic> presents a simple example of how to run a simulation, and analyze and visualize the results using the auxiliary Matlab module <monospace>+nf</monospace>. A list of the available functions in this module is presented in <xref ref-type="table" rid="pcbi.1006387.t003">Table 3</xref>.</p>
<table-wrap id="pcbi.1006387.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.t002</object-id>
<label>Table 2</label>
<caption>
<title>Symbols, configuration parameters and units.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006387.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="border-right:thick;border-bottom:thick">Symbol</th>
<th align="left" style="border-bottom:thick">Parameter name<break/>in configuration file</th>
<th align="left" style="border-bottom:thick">Units</th>
<th align="left" style="border-bottom:thick">Parameter exposure</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" style="border-right:thick"><italic>N</italic></td>
<td align="left">
<monospace>Nodes</monospace>
</td>
<td align="left">-</td>
<td align="left">required</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>N</italic><sub><italic>x</italic></sub></td>
<td align="left">
<monospace>Longside nodes</monospace>
</td>
<td align="left">-</td>
<td align="left">optional (<inline-formula id="pcbi.1006387.e024"><alternatives><graphic id="pcbi.1006387.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msqrt><mml:mo>(</mml:mo></mml:msqrt> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>)</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>L</italic><sub><italic>x</italic></sub></td>
<td align="left">
<monospace>Length</monospace>
</td>
<td align="left">m</td>
<td align="left">required</td>
</tr>
<tr>
<td align="left" style="border-right:thick">Δ<italic>x</italic></td>
<td align="left">-</td>
<td align="left">m</td>
<td align="left">none (<italic>L</italic><sub><italic>x</italic></sub>/<italic>N</italic><sub><italic>x</italic></sub>)</td>
</tr>
<tr>
<td align="left" style="border-right:thick">Δ<italic>y</italic></td>
<td align="left">-</td>
<td align="left">m</td>
<td align="left">none (Δ<italic>x</italic>)</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>N</italic><sub><italic>y</italic></sub></td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">none (<italic>N</italic>/<italic>N</italic><sub><italic>x</italic></sub>)</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>L</italic><sub><italic>y</italic></sub></td>
<td align="left">-</td>
<td align="left">m</td>
<td align="left">none (<italic>N</italic><sub><italic>y</italic></sub>Δ<italic>y</italic>)</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>First column: symbols used in this work to identify the parameters specified in a configuration file. Second column: parameter names used in configuration files to determine the physical size and spatial resolution of the 2D sheets for each population. The symbol - means the parameter is not specified directly in a configuration file. Third column: SI units of each parameter. Here, the symbol - means the parameter is dimensionless. Fourth column: shows whether the exposure [<xref ref-type="bibr" rid="pcbi.1006387.ref079">79</xref>] of each parameter in the configuration file is (i) required, (ii) optional (with its default value); or, (iii) not required (none). In the latter case, the parameter is derived internally in the code and we provide the equation used to calculate its value).</p>
</fn>
</table-wrap-foot>
</table-wrap>
<table-wrap id="pcbi.1006387.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.t003</object-id>
<label>Table 3</label>
<caption>
<title>Auxiliary functions available in the module <monospace>+nf</monospace>.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006387.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="border-right:thick;border-bottom:thick">Function</th>
<th align="left" style="border-bottom:thick">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" style="border-right:thick">
<monospace>extract</monospace>
</td>
<td align="left">extracts time-series from an output structure</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>get_frequencies</monospace>
</td>
<td align="left">returns the spatial frequencies</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>grid</monospace>
</td>
<td align="left">reshapes output into a 3D array of shape (<italic>L</italic><sub>out</sub>, <italic>N</italic><sub><italic>x</italic></sub>, <italic>N</italic><sub><italic>y</italic></sub>)</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>movie</monospace>
</td>
<td align="left">generates a movie from a 3D array produced by <monospace>nf.grid</monospace></td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>plot_timeseries</monospace>
</td>
<td align="left">plots vertically spaced timeseries of specific traces and nodes</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>read</monospace>
</td>
<td align="left">reads an output file and returns a structure</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>report</monospace>
</td>
<td align="left">prints information about a structure</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>run</monospace>
</td>
<td align="left">runs a simulation from a configuration file</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>spatial_spectrum</monospace>
</td>
<td align="left">computes spatiotemporal spectrum</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>spectrum</monospace>
</td>
<td align="left">computes temporal spectrum</td>
</tr>
<tr>
<td align="left" style="border-right:thick">
<monospace>wavelet_spectrogram</monospace>
</td>
<td align="left">computes wavelet spectrogram using a Morlet wavelet</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001">
<p>First column: names of the available Matlab functions. Second column: brief descriptions of what each function does. The variable <italic>L</italic><sub><italic>out</italic></sub> is the number of time points in the output file.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>The typographic conventions used in the remainder of this text are that: (i) all computer code is typeset in a typewriter font; and (ii) code snippets are framed by horizontal lines with line numbers on the left.</p>
<sec id="sec007">
<title>General workflow</title>
<p>A typical <italic>NFTsim</italic> workflow consists of three broad phases: configuration; simulation; and postprocessing. The first phase involves writing a configuration file that specifies the neural field model as well as other parameters required to run a simulation. This file is a human readable plain text file with the extension <monospace>.conf</monospace>. Once a configuration is specified the simulation can be launched by invoking the <monospace>nftsim</monospace> executable, either directly via a shell (<italic>bash</italic>) terminal</p>
<p specific-use="line">1 user@host$ nftsim -i &lt;my-model.conf&gt; -o &lt;my-model.output&gt;</p>
<p>or indirectly via the <monospace>nf.run</monospace> Matlab function. In the simulation phase, <italic>NFTsim</italic> reads the configuration file, specified after the flag <monospace>-i</monospace>, builds the objects of the specified model, runs the simulation and writes the output file, which contains the timeseries of the neural quantities requested in the configuration file. The name of the output file can be specified using the flag <monospace>-o</monospace> and must have the extension <monospace>.output</monospace>. In the absence of an output file name, <italic>NFTsim</italic> uses the input file name with the extension <monospace>.output</monospace>. For autogenerated output file names, the flag <monospace>-t</monospace> can be used to append a string to the output file name of the form <monospace>_YYYY-MM-DDTHHMMSS</monospace>, which follows the standard ISO 8601 [<xref ref-type="bibr" rid="pcbi.1006387.ref072">72</xref>] to represent date and time. In the postprocessing phase, the simulation results can be analyzed offline and visualized with the functions provided in the Matlab module <monospace>+nf</monospace>.</p>
</sec>
<sec id="sec008">
<title>Code architecture</title>
<p>Neural field models can be decomposed into a small number of objects, that represent their various parts. Each object has intrinsic properties that, in turn, can be well represented as classes, each of which is a set of elements having common attributes different from other sets, using object oriented programming. <italic>NFTsim</italic> classes have been implemented in C++ (C++11 standard) [<xref ref-type="bibr" rid="pcbi.1006387.ref073">73</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref074">74</xref>].</p>
<p>The most prominent components of neural field models are populations, synaptic connections, and propagators. Each of these components (or objects) is described by a main base class with properties specific to a group of objects. Derived classes are defined via the mechanism of class inheritance which allows for: (i) the definition of class in terms of another class; (ii) the customization of different parts of the system being modeled; and (iii) the extension of the functionalities of the library. For instance, a base class describing propagators has properties such as axonal range and axonal velocity. These properties are common to different propagators (derived classes) such as the wave propagator in <xref ref-type="disp-formula" rid="pcbi.1006387.e020">Eq (13)</xref> or the harmonic propagator in <xref ref-type="disp-formula" rid="pcbi.1006387.e021">Eq (14)</xref>, and are inherited from the base class. However, the optimal method to solve each form of propagation may vary and thus each propagator-derived class can have its own solver. Furthermore, there are auxiliary base classes that define additional properties of the main classes described above. These auxiliary classes embody processes like dendritic dynamics, soma charging, firing response, external stimuli, and anatomical time delays.</p>
<p>Thanks to this modular architecture, <italic>NFTsim</italic> allows for the specification of models with (i) an arbitrary number of neural populations, of different types and with different parameter sets; (ii) different types of connections between pairs of populations; and (iii) different types of activity propagation, with or without propagation time delays between and within neural populations.</p>
</sec>
<sec id="sec009">
<title>Classes and their interactions</title>
<p>An overview of <italic>NFTsim</italic>’s calling interactions between classes, is illustrated in <xref ref-type="fig" rid="pcbi.1006387.g003">Fig 3</xref>. In this diagram main and auxiliary base classes are positioned so that, in a simulation, their position corresponds to being initialized and stepped forward in time from top to bottom and from left to right within each row. In the first row, we see the high-level class <monospace>Solver</monospace> which coordinates how the other classes interact during a simulation. In the second row, the main base class <monospace>Propagator</monospace> computes each of the axonal pulse-rate fields <italic>ϕ</italic><sub><italic>ab</italic></sub> generated by the firing rate <italic>Q</italic><sub><italic>b</italic></sub>. In any given neural field model there are as many <monospace>Propagator</monospace> objects as there are connections. These can be any of three derived <monospace>Propagator</monospace> classes (<monospace>Wave</monospace>, <monospace>Harmonic</monospace>, <monospace>Map</monospace>) implemented to accommodate the operators defined in Eqs <xref ref-type="disp-formula" rid="pcbi.1006387.e020">(13)</xref>, <xref ref-type="disp-formula" rid="pcbi.1006387.e021">(14)</xref> or <xref ref-type="disp-formula" rid="pcbi.1006387.e022">(15)</xref>, respectively. The <monospace>Wave</monospace> class uses an explicit time stepping method based on second order central difference schemes in space and time (see <italic>Explicit difference method and boundary conditions for the 2D wave equation</italic>). The <monospace>Harmonic</monospace> class implements <xref ref-type="disp-formula" rid="pcbi.1006387.e021">Eq (14)</xref>, where for spatially homogeneous models the Laplacian term is zero and one finds a damped oscillator response. This class uses a standard fourth-order Runge-Kutta (RK4) explicit forward time stepping method with a fixed time step [<xref ref-type="bibr" rid="pcbi.1006387.ref075">75</xref>]. Lastly, the <monospace>Map</monospace> class, where the propagator is simply a direct mapping as in <xref ref-type="disp-formula" rid="pcbi.1006387.e022">Eq (15)</xref>. Below <monospace>Propagator</monospace>, there is the auxiliary class <monospace>Tau</monospace>, which handles the activity history and retrieves the appropriate delayed activity when the discrete time delay <italic>τ</italic><sub><italic>ab</italic></sub> is nonzero. This class actually stores time delayed activity between every pair of populations, for every spatial location, and makes it available to the numerical solvers. Then, to the right of <monospace>Propagator</monospace>, the <monospace>Coupling</monospace> class handles synaptic connections and their dynamics. The base <monospace>Coupling</monospace> class assumes that the synaptic strengths are constant over space and time. Thus, the output signal is a product of incoming activity and synaptic weights. Other derived <monospace>Coupling</monospace> classes implement temporally varying synaptic strengths as in [<xref ref-type="bibr" rid="pcbi.1006387.ref036">36</xref>], or modulation by pre- or postsynaptic activity, as in [<xref ref-type="bibr" rid="pcbi.1006387.ref040">40</xref>]. To the right of <monospace>Coupling</monospace>, the <monospace>Population</monospace> class describes neural population activity and its parameters define the type.</p>
<fig id="pcbi.1006387.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Simplified diagram of <italic>NFTsim</italic>’s call graph.</title>
<p>The execution of a simulation is controlled by the class <monospace>Solver</monospace>. Initial conditions are given in terms of firing rates <italic>Q</italic><sub><italic>b</italic></sub> which are then propagated to other populations via <monospace>Propagator</monospace>. Synaptic connections are handled via <monospace>Coupling</monospace>. The incoming activity to postsynaptic <monospace>Population</monospace> undergoes dendritic dynamics via <monospace>Dendrite</monospace>. The sum of individual contributions <italic>V</italic><sub><italic>ab</italic></sub> and the resulting firing response are handled by <monospace>FiringResponse</monospace>. The class <monospace>Timeseries</monospace> is used to represent external inputs <italic>Q</italic><sub><italic>x</italic></sub> from a stimulus <monospace>Population</monospace>. Lastly, the class <monospace>Outlet</monospace> stores the variables that are written to the output file.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g003" xlink:type="simple"/>
</fig>
<p>In the third and fourth rows, below <monospace>Population</monospace>, we see that each <monospace>Population</monospace> uses two subsidiary classes: an array of <monospace>Dendrite</monospace> objects (one for every population connected via a <monospace>Coupling</monospace>); and, a <monospace>FiringResponse</monospace>. The signal from a <monospace>Coupling</monospace> object is passed to a corresponding <monospace>Dendrite</monospace> object which implements the synaptodendritic effects defined in <xref ref-type="disp-formula" rid="pcbi.1006387.e008">Eq (6)</xref>. The contributions <italic>V</italic><sub><italic>ab</italic></sub> are then summed to yield the soma potential <italic>V</italic><sub><italic>a</italic></sub> of the population. Then, the population’s <monospace>FiringResponse</monospace> object implements <xref ref-type="disp-formula" rid="pcbi.1006387.e011">Eq (9)</xref> to calculate the resulting population firing rate <italic>Q</italic><sub><italic>a</italic></sub>. Different forms of the activation function are specified within the base <monospace>FiringResponse</monospace> class. Other types of activation function that involve modulation of parameters due to presynaptic or postsynaptic activity are implemented in classes derived from the <monospace>FiringResponse</monospace> class. Such is the case of <monospace>BurstingResponse</monospace> that implements modulation of firing threshold <italic>θ</italic><sub><italic>a</italic></sub> [<xref ref-type="bibr" rid="pcbi.1006387.ref058">58</xref>]. External or stimulus populations are also objects of the <monospace>Population</monospace> class. However, their activity is a predefined spatiotemporal profile of firing rate <italic>Q</italic><sub><italic>x</italic></sub>, that represents a chosen input and is contained in an object of the class <monospace>Timeseries</monospace>. In <italic>NFTsim</italic> the external inputs may include noisy and/or coherent components which may or may not be spatially localized (e.g., afferent to the visual thalamus in response to a visual stimulus). Currently, <italic>NFTsim</italic> supports a number of different external driving signals (<italic>ϕ</italic><sub><italic>ax</italic></sub>) to stimulate any population <italic>a</italic> of a system. These signals include: a constant value equivalent to applying DC voltage; sine waves; square pulse trains; and, Gaussian white noise to simulate random perturbations. These basic functions can be combined additively to generate more complex stimulation signals.</p>
<p>Lastly, to the right of <monospace>Population</monospace>, the class <monospace>Outlet</monospace>, stores the variables that are written to the output file.</p>
<p>In summary, a compact representation of the neural field equations with the label of the associated <italic>NFTsim</italic> classes is
<disp-formula id="pcbi.1006387.e025"><alternatives><graphic id="pcbi.1006387.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">D</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mtext mathvariant="monospace">Propagator</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
<disp-formula id="pcbi.1006387.e026"><alternatives><graphic id="pcbi.1006387.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mtext mathvariant="monospace">Coupling</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
<disp-formula id="pcbi.1006387.e027"><alternatives><graphic id="pcbi.1006387.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mtext mathvariant="monospace">Dendrite</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
<disp-formula id="pcbi.1006387.e028"><alternatives><graphic id="pcbi.1006387.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>Q</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>b</mml:mi></mml:munder> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext mathvariant="monospace">FiringResponse</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
where the auxiliary variable <italic>P</italic><sub><italic>ab</italic></sub> in <xref ref-type="disp-formula" rid="pcbi.1006387.e026">Eq (18)</xref> is only defined inside the <monospace>Coupling</monospace> class and assigned the presynaptic inputs weighted by the local synaptic coupling strength. <xref ref-type="fig" rid="pcbi.1006387.g004">Fig 4</xref>, which is analogous to the diagram presented in <xref ref-type="fig" rid="pcbi.1006387.g001">Fig 1</xref>, illustrates the input and output variables of each class and the direction in which they flow within a simulation.</p>
<fig id="pcbi.1006387.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g004</object-id>
<label>Fig 4</label>
<caption>
<title><italic>NFTsim</italic> classes associated with biophysical processes.</title>
<p>This diagram illustrates the relationship of the classes in the library and the biophysical transformations they represent. Input variables are on the left, while output variables are on the right. Gray boxes are classes associated with interactions between populations, while white boxes are classes associated with internal mechanisms of a population.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Input-output</title>
<p>The main routine of <italic>NFTsim</italic> takes a plain text configuration file as input, where all the model description and simulation parameters are specified, and writes the simulation result to an output file. Both the configuration file and output file are plain text files, so launching simulations and reading the results with other programming languages is also possible. Note that all the parameters in the configuration and output files are specified directly in SI units without prefixes (e.g., s, s<sup>−1</sup>, V); e.g., a value of 1 mV is written as <monospace>1e-3</monospace> (where V is implicit).</p>
<sec id="sec011">
<title>Configuration and output files</title>
<p>The following listing shows an exemplar configuration file, named <monospace>e-erps.conf</monospace>, which is included with other examples in the <monospace>configs/</monospace> directory of <italic>NFTsim</italic>. This file specifies a neural field model with a single cortical excitatory population that receives inputs from an external population which is the source of a stimulus to the cortex. In this example, parameters were taken from [<xref ref-type="bibr" rid="pcbi.1006387.ref033">33</xref>], with the exception of the axonal propagation parameters, which are tuned to emphasize wave propagation properties (i.e., by decreasing the damping rate <italic>γ</italic><sub><italic>ab</italic></sub>). We emphasize that this an illustrative example, and that while it emulates the scenario of evoked responses due to a stimulus (e.g. a flash of light) it does not represent any specific experiment.</p>
<p>The cortical population is initially in a steady state of low firing rate around 10 s<sup>−1</sup> and is driven by two pulses applied toward the center of the grid. The first pulse occurs at <italic>t</italic> ≈ 32 ms and has a positive amplitude of <inline-formula id="pcbi.1006387.e029"><alternatives><graphic id="pcbi.1006387.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> s<sup>−1</sup>. The onset of the second pulse is <italic>t</italic> ≈ 60 ms and has a negative amplitude of <inline-formula id="pcbi.1006387.e030"><alternatives><graphic id="pcbi.1006387.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> s<sup>−1</sup>.</p>
<disp-formula id="pcbi.1006387.e053"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e053" xlink:type="simple"/></disp-formula>
<p>The above file starts with a brief description of the model to be simulated. This comment is optional and can span multiple lines. In lines 4-5, global parameters for the simulation are defined: simulation duration (<monospace>Time</monospace>), time step size (<monospace>Deltat</monospace>), and the total number of nodes in the two dimensional grid (<monospace>Nodes</monospace>).</p>
<p>The aforementioned parameters are followed by the specification of a square connection matrix in lines 7-10, where the rows are the target populations and columns indicate the source populations. In this matrix, a positive integer indicates there is a connection between two populations and it also serves as an identifier of that connection. In the case presented above, there are only two nonzero connections, connection <monospace>1</monospace> to <monospace>Population 1</monospace> from itself and connection <monospace>2</monospace> to <monospace>Population 1</monospace> from <monospace>Population 2</monospace>. The couplings, dendrites and propagators are labeled by these consecutive positive integers. The two populations of this example are defined in lines 12-25. Each population in the model is specified separately, indicating its type (e.g., excitatory, inhibitory, or external), the physical size of its longest side (<monospace>Length</monospace>), its initial condition in terms of firing rate <monospace>Q</monospace>, and its type of dendritic and firing responses. The next step, in lines 27-28, is to define the type of propagation and coupling between each pair of connected populations. In line 27, the axonal propagation of the excitatory-excitatory connection follows a damped wave equation, with zero long-range time delay (<monospace>Tau</monospace>), characteristic spatial range of 0.2 m (<monospace>Range</monospace>) and a damping coefficient of 30 s<sup>-1</sup> (<monospace>gamma</monospace>). Finally, at the end of the configuration file, from line 33 onwards in this example, we specify which timeseries are written to the output file.</p>
<p>There are three global output parameters: <monospace>Node</monospace> which specifies the labels of the grid nodes whose activity will be written to the output file; <monospace>Start</monospace>, sets the time (in seconds) from which the output timeseries will be written, and cannot be larger than the total simulation duration <monospace>Time</monospace>; and, <monospace>Interval</monospace> is the sampling interval between points in the output timeseries. The <monospace>Interval</monospace> should be chosen as an integer multiple of <monospace>Deltat</monospace>, that is, the ratio <monospace>Interval</monospace>/<monospace>Deltat</monospace> should be an integer number <italic>K</italic>, because <italic>NFTsim</italic> does not perform interpolation or averaging when users request downsampled output. The timeseries written to disk is simply a subsampled version of the original, where only every <italic>K</italic>-th sample is kept. In lines 34 and 36 we see that <italic>NFTsim</italic> has to write the firing rate (<monospace>Q</monospace>) of <monospace>Population 2</monospace>, and the axonal field <monospace>phi</monospace> of <monospace>Propagator 1</monospace>, respectively. <italic>NFTsim</italic> first writes the configuration file at the top of the output file to ensure full reproducibility of the results, then it writes a line filled with the symbol <monospace>=</monospace>, and finally, it writes the requested timeseries. Below we show an excerpt of the output file <monospace>e-erps.output</monospace>.</p>
<disp-formula id="pcbi.1006387.e054"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e054" xlink:type="simple"/></disp-formula>
<p specific-use="continuation">Here, the first column is the time vector. The values are expressed in seconds. The second column is the firing rate <monospace>Q</monospace> of the second population at node 2000. The third column is the excitatory field of <monospace>Propagator 1</monospace> from <monospace>Population 1</monospace> to itself at node 2000. Line 3 provides the label of each timeseries, while line 4 shows the node index.</p>
</sec>
</sec>
<sec id="sec012">
<title>Numerical methods, considerations, and constraints</title>
<p>This section focuses on considerations and constraints regarding the numerical methods implemented in <italic>NFTsim</italic>. In <italic>Initial conditions.</italic> we give a general overview and strategies to set initial conditions for neural field simulations. Furthermore, <italic>Discretization of the spatial domain.</italic> and <italic>Courant condition.</italic> describe the way space is discretized in <italic>NFTsim</italic> and the maximum grid ratio for correctly solving the 2D damped wave equation, respectively. In <italic>Explicit difference method and boundary conditions for the 2D wave equation</italic> we explain the stepping method used to solve the wave equation on a finite grid. Lastly, in <italic>Time delays</italic>, we briefly explain how time delays are handled in <italic>NFTsim</italic>.</p>
<sec id="sec013">
<title>Initial conditions</title>
<p>Neural field equations are partial delay differential equations (PDDEs), thus at the start of a simulation activity from previous times is required for initialization. <italic>NFTsim</italic> assumes the system is initialized at a stable fixed point and then fills a history array, which stores the past activity of the system, with the values of firing rate at equilibrium. A more detailed explanation on how time delays are handled is given in a subsequent section.</p>
<p>In a steady state all the temporal derivatives can be set to zero. Furthermore, <italic>NFTsim</italic> currently also assumes that the initial activity is uniform spatially, so the spatial derivatives are also set to zero. Under these assumptions, if the initial conditions are not exaclty a stable state of the system, one can expect to see transient activity until the system settles into the closest stable attractor (either a fixed point or another manifold).</p>
<p>In NFT, the number of stable steady-state equilibria strongly depends on the number of populations and connections between them [<xref ref-type="bibr" rid="pcbi.1006387.ref076">76</xref>], thus providing a general method to find the steady-state solutions is beyond the scope of <italic>NFTsim</italic>’s functionality.</p>
<p>Nevertheless, there are four main strategies that users may adopt to set initial conditions:</p>
<list list-type="simple">
<list-item>
<label>(i)</label>
<p>Finding the steady-state solutions analytically. This method is successful for simple neural field models with a couple to a few populations such as a purely cortical model [<xref ref-type="bibr" rid="pcbi.1006387.ref032">32</xref>], and that do not include a nonlinearity in their firing response.</p>
</list-item>
<list-item>
<label>(ii)</label>
<p>Finding steady-state solutions numerically. If one uses the NFT equations which include a nonlinear firing response, then the steady-state equation is a transcendental function of either firing rate or voltage, and its roots cannot be calculated analytically. Fixed points can be identified by evaluating the steady state equation of the system between consecutive test values of one of the fields or voltages (e.g., <inline-formula id="pcbi.1006387.e033"><alternatives><graphic id="pcbi.1006387.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1006387.e034"><alternatives><graphic id="pcbi.1006387.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>a</mml:mi></mml:mrow> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and detecting the zero crossings. This is the method that has been used extensively to find the roots of the corticothalamic model for different parameter ranges [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref076">76</xref>]. A standard root finding algorithm (e.g., Newton-Raphson) can then be used to refine the roots. If the steady-state equation of the neural field model depends on more than one variable [<xref ref-type="bibr" rid="pcbi.1006387.ref056">56</xref>] then a root finding algorithm like Broyden’s method is required. Note that the strategy described here does not identify the stability of the fixed points.</p>
</list-item>
<list-item>
<label>(iii)</label>
<p>Running auxiliary simulations. This approach is best suited for scenarios in which one already has an initial estimate of the initial stable state of the system; and for nonuniform situations [<xref ref-type="bibr" rid="pcbi.1006387.ref077">77</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref078">78</xref>], in which case the auxiliary simulations are run for the uniform case and the nonuniformities in the parameters are introduced in the main simulations. Auxiliary simulations should be long enough to give the system enough time to reach a stable state. The end state of this auxiliary simulation can then be used to provide the initial conditions for other simulations.</p>
</list-item>
<list-item>
<label>(iv)</label>
<p>Using Monte Carlo methods to run numerous simulations in <italic>NFTsim</italic> with randomly sampled initial conditions in order to find the stable states. This approach is more general than the previous one and does not require any a priori knowledge of the initial conditions. This approach is best suited for neural field models with several populations and for which finding the steady states of the system following (i) or (ii) is not possible or is too cumbersome. If multiple stable steady states are found [<xref ref-type="bibr" rid="pcbi.1006387.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref076">76</xref>], users must decide which one is to be used for the main simulations. In NFT, the linearly stable fixed point that represents the lowest firing rates is usually selected as the initial condition on the basis that represents a normal brain state [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref029">29</xref>].</p>
</list-item>
</list>
</sec>
<sec id="sec014">
<title>Discretization of the spatial domain</title>
<p>Each population is modeled as a 2D rectangular sheet. In <italic>NFTsim</italic>, the physical spatial domain of each population, whatever its extent, is divided into a finite number <italic>N</italic> of uniform grid cells (or nodes), which remain invariant throughout the simulations for all times. Note that in this work grid cells refer to smallest surface area units used to discretize a continuous and spatially extended domain such as the cortex, and not to the homonymous biological cells in the enthorinal cortex.</p>
<p>In a configuration file, the parameter <monospace>Length</monospace> corresponds to the physical length of the <italic>x</italic>-axis. By default, the domains are assumed to be square with <italic>L</italic><sub><italic>x</italic></sub> = <italic>L</italic><sub><italic>y</italic></sub>. In this case, the value of the parameter <monospace>Nodes</monospace> must be a perfect square so that the spatial resolutions
<disp-formula id="pcbi.1006387.e035"><alternatives><graphic id="pcbi.1006387.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>x</mml:mi> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>L</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mfrac></mml:mstyle> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
and
<disp-formula id="pcbi.1006387.e036"><alternatives><graphic id="pcbi.1006387.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>L</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
are the same.</p>
<p>To define a rectangular domain, in addition to the parameter <monospace>Nodes</monospace> (<italic>N</italic>), in the configuration file one can specify the number of nodes along the <italic>x</italic>-axis via the parameter <monospace>Longside nodes</monospace> (<italic>N</italic><sub><italic>x</italic></sub>). In this case, the number of nodes along the <italic>x</italic> and <italic>y</italic> axes are different, but the spacing remains the same for both axes (i.e., Δ<italic>x</italic> = Δ<italic>y</italic>)
<disp-formula id="pcbi.1006387.e037"><alternatives><graphic id="pcbi.1006387.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>x</mml:mi> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>L</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:msub><mml:mi>N</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mfrac></mml:mstyle> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
The number of nodes and physical length of the <italic>y</italic>-axis can be obtained as <italic>N</italic><sub><italic>y</italic></sub> = <italic>N</italic>/<italic>N</italic><sub><italic>x</italic></sub> and <italic>L</italic><sub><italic>y</italic></sub> = <italic>N</italic><sub><italic>y</italic></sub>Δ<italic>y</italic>, respectively. <xref ref-type="table" rid="pcbi.1006387.t002">Table 2</xref> summarizes the symbols and configuration length and size parameters used in this section and in the remainder of the text.</p>
<p>As an example, we show part of a configuration file for a neural field model with two populations. The physical length of the first population <inline-formula id="pcbi.1006387.e038"><alternatives><graphic id="pcbi.1006387.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msubsup><mml:mi>L</mml:mi> <mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is larger than the length of second population <inline-formula id="pcbi.1006387.e039"><alternatives><graphic id="pcbi.1006387.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>L</mml:mi> <mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
<disp-formula id="pcbi.1006387.e055"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e055" xlink:type="simple"/></disp-formula>
<p specific-use="continuation">In the above file the two internal populations are modeled as rectangular grids with a total of 12 nodes or grid cells, and with the number of nodes of the longest side specified by <monospace>Longside nodes</monospace>. The resulting 2D grid has a size of 4× 3 nodes as shown in the schematic of <xref ref-type="fig" rid="pcbi.1006387.g005">Fig 5</xref>. For illustrative purposes, the parameter values used in this configuration file have been exaggerated so the link between the input parameters and the discretization of the space shown in the schematic is clear. However, this configuration file will not produce accurate results because the spatial resolution is too coarse.</p>
<fig id="pcbi.1006387.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Schematic of the discretized spatial domain.</title>
<p>The model has two populations: <monospace>Population 1</monospace> and <monospace>Population 2</monospace>. Geometrically, each population is represented by a grid of 12 nodes, which are labeled with integers. The grid is rectangular with dimensions 4 × 3 nodes. The number of nodes of the longest side is specified by <monospace>Longside nodes</monospace>. The physical size, <italic>L</italic><sub><italic>x</italic></sub>, of each population is different. Thus, each node in <monospace>Population 1</monospace> has a linear size of Δ<italic>x</italic><sup>1</sup>, and of Δ<italic>x</italic><sup>2</sup> in <monospace>Population 2</monospace>. Each spatial point (e.g., <bold>r</bold><sub>1</sub>, <bold>r</bold><sub>9</sub>, <bold>r</bold><sub>11</sub>) is at the center of a grid cell. The subscript denotes the node index on this grid. Also, <bold>r</bold><sub><italic>n</italic></sub> denotes the actual position in the largest population; in the smallest population <bold>r</bold><sub><italic>n</italic></sub> denotes a rescaled physical dimension. Lastly, the borders of the grid are depicted with dashed lines to denote periodic boundary conditions (PBCs), which represent structures with planar geometry and toroidal topology.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g005" xlink:type="simple"/>
</fig>
<p><xref ref-type="fig" rid="pcbi.1006387.g005">Fig 5</xref> illustrates that <italic>NFTsim</italic> populations are linked via a primary topographic one-to-one map, which implies that all the populations must have the same number of grid points <italic>N</italic>, even if they have different physical spatial dimensions. We assign the same map coordinate <bold>r</bold><sub><italic>n</italic></sub> to homologous grid cells in different populations. In this example, <bold>r</bold><sub>1</sub> is assumed to be the actual physical position in <monospace>Population 1</monospace>, but in <monospace>Population 2</monospace>, <bold>r</bold><sub>1</sub> denotes a rescaled physical dimension. Also, any physical position <bold>r</bold><sub><italic>n</italic></sub>, for <italic>n</italic> = 1, …, <italic>N</italic> is assumed to be at the center of a grid cell, which is also labeled with integers <italic>n</italic> = 1, …, <italic>N</italic>. For instance, in <monospace>Population 1</monospace>, <bold>r</bold><sub>1</sub> corresponds to position (Δ<italic>x</italic><sub>1</sub>/2, Δ<italic>y</italic><sub>1</sub>/2) = (0.1, 0.1) m; and, in <monospace>Population 2</monospace>, <bold>r</bold><sub>1</sub> corresponds to position (Δ<italic>x</italic><sub>2</sub>/2, Δ<italic>y</italic><sub>2</sub>/2) = (0.01, 0.01) m.</p>
</sec>
<sec id="sec015">
<title>Courant condition</title>
<p>The interval Δ<italic>x</italic> is used to evaluate whether the current parameters satisfy the Courant condition, a necessary condition for obtaining stable solutions when solving hyperbolic partial differential equations on a regular discrete grid. For the wave equation in 1D the dimensionless number
<disp-formula id="pcbi.1006387.e041"><alternatives><graphic id="pcbi.1006387.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>≤</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
is called the Courant number [<xref ref-type="bibr" rid="pcbi.1006387.ref080">80</xref>]; Δ<italic>t</italic> is the integration time step size and <italic>v</italic><sub><italic>ab</italic></sub> = <italic>γ</italic><sub><italic>ab</italic></sub> <italic>r</italic><sub><italic>ab</italic></sub> is the magnitude of the wave velocity. In the continuum wave equation, activity propagates at maximum speed <italic>v</italic><sub><italic>ab</italic></sub> and the method is stable when Δ<italic>x</italic>/Δ<italic>t</italic> ≥ <italic>v</italic><sub><italic>ab</italic></sub>. Unstable schemes arise when Δ<italic>x</italic>/Δ<italic>t</italic> &lt; <italic>v</italic><sub><italic>ab</italic></sub> because waves propagate more than one grid spacing in a period Δ<italic>t</italic>. However, for the 2D case one finds the stability criterion to be [<xref ref-type="bibr" rid="pcbi.1006387.ref075">75</xref>]
<disp-formula id="pcbi.1006387.e042"><alternatives><graphic id="pcbi.1006387.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(25)</label></disp-formula>
so, because Δ<italic>x</italic> = Δ<italic>y</italic> <disp-formula id="pcbi.1006387.e043"><alternatives><graphic id="pcbi.1006387.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>≤</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mfrac><mml:mn>2</mml:mn> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>x</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(26)</label></disp-formula>
<disp-formula id="pcbi.1006387.e044"><alternatives><graphic id="pcbi.1006387.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mrow><mml:mo>≤</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula>
Hence, considering all wave-type propagators, the maximum value of the Courant number <italic>p</italic><sub>max</sub> must satisfy
<disp-formula id="pcbi.1006387.e045"><alternatives><graphic id="pcbi.1006387.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mtext>max</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mtext>max</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>≤</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mfrac></mml:mstyle> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
This condition is checked internally by <italic>NFTsim</italic> and if it is not satisfied, an error message is returned. Note that, in practice, one usually imposes a stricter condition to ensure the system has a margin of stability; e.g., in [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>], the grid ratio was chosen so that <italic>p</italic><sub>max</sub> = 0.1.</p>
</sec>
<sec id="sec016">
<title>Explicit difference method and boundary conditions for the 2D wave equation</title>
<p><italic>NFTsim</italic> uses an explicit central difference method [<xref ref-type="bibr" rid="pcbi.1006387.ref081">81</xref>] to solve <xref ref-type="disp-formula" rid="pcbi.1006387.e020">Eq (13)</xref>, which represents axonal propagation of activity through the cortex or other structures with a significant spatial extent. Here, we present the explicit time stepping formula currently implemented to compute the next value of <italic>ϕ</italic><sub><italic>ab</italic></sub> from past values of <italic>ϕ</italic><sub><italic>ab</italic></sub> and <italic>Q</italic><sub><italic>b</italic></sub>. The full derivation is in the <italic>Supporting Information</italic>.</p>
<p><xref ref-type="disp-formula" rid="pcbi.1006387.e020">Eq (13)</xref> is the inhomogeneous damped wave equation, which can be simplified by making the substitutions
<disp-formula id="pcbi.1006387.e046"><alternatives><graphic id="pcbi.1006387.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>u</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula>
<disp-formula id="pcbi.1006387.e047"><alternatives><graphic id="pcbi.1006387.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>w</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula>
We then obtain the undamped wave equation
<disp-formula id="pcbi.1006387.e048"><alternatives><graphic id="pcbi.1006387.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e048" xlink:type="simple"/><mml:math display="block" id="M48"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>[</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mstyle> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>∂</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mo>∇</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>]</mml:mo> <mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
Note that this simplification only works for small values of Δ<italic>t</italic> because the exponential factors introduced in Eqs <xref ref-type="disp-formula" rid="pcbi.1006387.e046">(29)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006387.e047">(30)</xref> diverge as Δ<italic>t</italic> → ∞.</p>
<p>Then, the final time-stepping formula using an explicit central difference method for the 2D wave equation is
<disp-formula id="pcbi.1006387.e049"><alternatives><graphic id="pcbi.1006387.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>{</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>-</mml:mo> <mml:mn>4</mml:mn> <mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo/></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mn>12</mml:mn></mml:mfrac></mml:mstyle> <mml:mo>[</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>10</mml:mn> <mml:mo>-</mml:mo> <mml:mn>4</mml:mn> <mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo/></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:mo/> <mml:mo/> <mml:msup><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo> <mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula>
where the superscript <italic>n</italic> indexes time step; the first and second subscripts index space along the orthogonal <italic>x</italic> and <italic>y</italic> directions, respectively, except for the subscripts on <italic>γ</italic><sub><italic>ab</italic></sub>; and <italic>p</italic> is the Courant number. In the <xref ref-type="disp-formula" rid="pcbi.1006387.e049">Eq (32)</xref>, the positive exponential factors introduced in Eqs <xref ref-type="disp-formula" rid="pcbi.1006387.e046">(29)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006387.e047">(30)</xref> are cancelled out and the algorithm actually evaluates negative exponential factors <italic>e</italic><sup>−<italic>γ</italic><sub><italic>ab</italic></sub>Δ<italic>t</italic></sup> and <italic>e</italic><sup>−2<italic>γ</italic><sub><italic>ab</italic></sub>Δ<italic>t</italic></sup>.</p>
<p>Note that in <xref ref-type="disp-formula" rid="pcbi.1006387.e049">Eq (32)</xref>, only five spatial points are required: the central point <italic>m</italic>, <italic>l</italic>; its horizontal neighbors <italic>m</italic> + 1, <italic>l</italic> and <italic>m</italic> − 1, <italic>l</italic>; and, its vertical neighbors <italic>m</italic>, <italic>l</italic> + 1 and <italic>m</italic>, <italic>l</italic> − 1. This pattern is often referred to as a five-point stencil. There are alternative finite difference methods that use higher-order terms to approximate the derivatives and would require larger stencils (e.g., more neighboring points) [<xref ref-type="bibr" rid="pcbi.1006387.ref082">82</xref>]. It is usually better to increase the spatial resolution rather than the stencil complexity to obtain higher accuracy.</p>
<p>The finite difference scheme presented above is second-order accurate in space and time. This means that the rate at which the error between the discretized approximation and the exact continuum solution decreases to zero is <inline-formula id="pcbi.1006387.e050"><alternatives><graphic id="pcbi.1006387.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msup><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. For instance, halving Δ<italic>x</italic>, Δ<italic>y</italic>, or Δ<italic>t</italic>, subject to <xref ref-type="disp-formula" rid="pcbi.1006387.e045">Eq (28)</xref> leads to a decrease of the error by a factor of four.</p>
<p>When solving partial differential equations on a finite spatial domain, one must specify boundary conditions for the simulations. <italic>NFTsim</italic> uses periodic boundary conditions (PBCs). This type of condition avoids boundary effects stemming from the finite size of a grid and avoids the perturbing influence of an artificial boundary like a reflective wall. In PBCs, opposite boundaries are treated as if they were physically connected, that is, the top of the grid is wrapped on to the bottom and the left of the grid on to the right.</p>
<p>The class <monospace>Stencil</monospace> has two main functions: (i) retrieving the five-point stencil pattern for every node in the grid; and, (ii) correctly copying the activity close to the boundaries of the domain at every time step to implement periodicity. To achieve this, <monospace>Stencil</monospace> operates on a grid of size (<italic>N</italic><sub><italic>x</italic></sub> + 2) × (<italic>N</italic><sub><italic>y</italic></sub> + 2). The additional ghost cells are used to store copies of the top and bottom rows and left and right columns of the grid.</p>
<p><xref ref-type="fig" rid="pcbi.1006387.g006">Fig 6</xref> illustrates a 4 × 4 grid with the additional ghost cells shaded in light blue and five-point stencil pattern consisting of a central grid point <monospace>c</monospace> and its 4 neighbors labeled as <monospace>n</monospace>, <monospace>s</monospace>, <monospace>e</monospace>, <monospace>w</monospace> (i.e., north, south, east, west). The number in each grid cell represents its linear index—because the class <monospace>Stencil</monospace> accesses the elements of the two dimensional grid using a single subscript instead of two. The grid cells with prime, double-prime, and triple-prime indices are copies of the original cells with the same indices. These copies are used to implement PBCs along the vertical, horizontal, and diagonal directions, respectively. For instance, the cell 1′ is the vertical copy of cell 1; cell 1<sup>″</sup> is the horizontal copy, and cell 1<sup>‴</sup> is the diagonal copy. The diagonal copies are not used by the 5-point stencil, but would be used by a 9-point stencil [<xref ref-type="bibr" rid="pcbi.1006387.ref082">82</xref>].</p>
<fig id="pcbi.1006387.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Schematic of the grid used by the class <monospace>Stencil</monospace>.</title>
<p>This class retrieves the four nearest neighbors (labeled <monospace>n</monospace>, <monospace>s</monospace>, <monospace>e</monospace>, <monospace>w</monospace>) of a central point <monospace>c</monospace>. These five points define the pattern known as a five-point stencil. The cells in light blue are the ghost cells required to implement periodic boundary conditions. The prime, double-prime and triple prime indices represent copies of the corresponding indices in the vertical, horizontal and diagonal directions, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g006" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec017">
<title>Time delays</title>
<p>For systems with time delays, <italic>NFTsim</italic> creates one history array of size <italic>N</italic> × <italic>D</italic><sub><italic>a</italic></sub> per population, where <italic>N</italic> is the number of nodes as defined in previous sections. The delay depth <italic>D</italic><sub><italic>a</italic></sub> of a history array is expressed as a number of integration steps.</p>
<p>To determine the exact value of <italic>D</italic><sub><italic>a</italic></sub>, <italic>NFTsim</italic> checks every <monospace>Propagator</monospace> originating from <italic>a</italic>. Thus, the final delay depth for a given population <italic>a</italic> is
<disp-formula id="pcbi.1006387.e051"><alternatives><graphic id="pcbi.1006387.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mtext>max</mml:mtext> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:munder> <mml:mo>{</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>}</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>P</italic> is the number of populations in the system; and, in the case that the parameter <monospace>Tau</monospace> represents spatially nonuniform time delays, <italic>NFTsim</italic> first selects the largest time delay over space
<disp-formula id="pcbi.1006387.e052"><alternatives><graphic id="pcbi.1006387.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mtext>max</mml:mtext> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:munder> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>a</mml:mi></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>This produces history arrays with the minimum necessary delay depth for each population and thus is memory efficient.</p>
<p>Each <monospace>Propagator</monospace> stores an integer array with indices used to access the appropriate past activity of its origin population.</p>
</sec>
<sec id="sec018">
<title>Analysis and visualization</title>
<p><italic>NFTsim</italic> includes a Matlab module which provides ancillary tools to assist with running, analyzing and visualizing models. This package folder is called <monospace>+nf</monospace>. The available functions and a description of their functionality are summarized in <xref ref-type="table" rid="pcbi.1006387.t003">Table 3</xref>.</p>
<p>The code snippet below uses some basic <monospace>nf</monospace> functions as an example of how users can interact with <italic>NFTsim</italic> directly from Matlab. The model is the same as the one specified in the configuration file <monospace>e-erps.conf</monospace> presented earlier, except that the timeseries of all the nodes in the grid are written to the output file. The simulation is executed via <monospace>nf.run()</monospace>. Once the output file is available <monospace>nf.read()</monospace> loads the simulated data into a Matlab structure.</p>
<p>Spatial patterns of activity and propagation of waves of activity across space can be visualized using the function <monospace>nf.movie()</monospace></p>
<p specific-use="line">1 nf_struct = nf.run('configs/e-erps-all-nodes.conf')</p>
<p specific-use="line">2 nf.movie(nf_struct, 'Propagator.1.phi', 1)</p>
<p>Representative frames from the movie of waves propagating from stimulation sites are shown in <xref ref-type="fig" rid="pcbi.1006387.g007">Fig 7(a) to 7(f)</xref>. In each panel the mean spatial value of <italic>ϕ</italic><sub><italic>ee</italic></sub>(<italic>x</italic>, <italic>y</italic>, <italic>t</italic>) at time <italic>t</italic> has been subtracted, so red and blue reflect positive and negative deviations, respectively, from the mean. The effects of PBCs can be appreciated from <xref ref-type="fig" rid="pcbi.1006387.g007">Fig 7(c)</xref> onwards. In particular, in <xref ref-type="fig" rid="pcbi.1006387.g007">Fig 7(c)</xref> the positive wave front propagating towards the left on the inset (<italic>x</italic> → 0) reappears at the right (<italic>x</italic> ≈ <italic>L</italic><sub><italic>x</italic></sub>). In a similar way, <xref ref-type="fig" rid="pcbi.1006387.g007">Fig 7(e)</xref>, shows that the positive wavefront propagating along the <italic>y</italic>-axis results in a slight increase of the <italic>ϕ</italic><sub><italic>ee</italic></sub> close to the boundaries.</p>
<fig id="pcbi.1006387.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Neural activity of the model described in <monospace>e-erps.conf</monospace>.</title>
<p>The cortical population is driven by two square pulses. The first pulse is positive, while the second pulse is negative. For illustrative purposes, in each panel the mean spatial value of <italic>ϕ</italic><sub><italic>ee</italic></sub>(<italic>x</italic>, <italic>y</italic>, <italic>t</italic>) has been subtracted, so the color reflects deviations from the mean at that specific time. Each panel shows a surface plot of <inline-formula id="pcbi.1006387.e031"><alternatives><graphic id="pcbi.1006387.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>e</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> s<sup>−1</sup> propagating radially outwards from the stimulation sites, and an inset with a planar view of the same quantity, at different times: <bold>(a)</bold> 42 ms; <bold>(b)</bold> 52 ms; <bold>(c)</bold> 62 ms; <bold>(d)</bold> 77 ms; <bold>(e)</bold> 86 ms; <bold>(f)</bold> 104 ms.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g007" xlink:type="simple"/>
</fig>
<p>The file used in this example is included in <italic>NFTsim</italic> and is also available in the <italic>Supporting Information</italic>.</p>
<p>Furthermore, extracting and plotting the timeseries of a few nodes enable users to directly inspect the type of activity (e.g., healthy neural activity, evoked responses, or seizures). In this example, <monospace>nf.extract()</monospace> is used internally by <monospace>nf.plot_timeseries()</monospace> to select the timeseries <monospace>Propagator.1.phi</monospace>.</p>
<p specific-use="line">1 these_nodes = {[1992:2008],[2089:2105]};</p>
<p specific-use="line">2 these_traces = {'Propagator.1.phi', 'Propagator.1.phi'};</p>
<p specific-use="line">3 nf.plot_timeseries(nf_struct, these_traces, these_nodes, true)</p>
<p><xref ref-type="fig" rid="pcbi.1006387.g008">Fig 8</xref> shows the resulting plots generated with the code shown above. Each set of timeseries is centered around one of the stimulation sites. In <xref ref-type="fig" rid="pcbi.1006387.g008">Fig 8(a)</xref> the red curve is the axonal field at the site that received positive stimulation; and, in <xref ref-type="fig" rid="pcbi.1006387.g008">Fig 8(b)</xref>, the blue line is the axonal field at the site that received negative inputs. The timeseries in gray above and below the colored curves are the axonal fields from neighboring sites along the <italic>x</italic>-direction. In these plots, the distance between the stimulation sites and neighboring sites increases vertically from the center to the top and bottom edges. The vertical dashed lines are not automatically produced by <monospace>nf.plot_timseries</monospace>, but have been added to mark the onset time of the positive (red dashed) and negative (blue dashed) inputs, respectively.</p>
<fig id="pcbi.1006387.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Timeseries of neural activity of the model described in <monospace>e-erps.conf</monospace>.</title>
<p>The cortical population is driven by two temporal square pulses applied at the center of the grid as shown in <xref ref-type="fig" rid="pcbi.1006387.g007">Fig 7</xref>. Here, we illustrate the timeseries of <italic>ϕ</italic><sub><italic>ee</italic></sub> from a few nodes close to the vicinity of (gray lines) and at the stimulation sites. The vertical dashed lines mark the onset time of the positive (red dashed) and negative (blue dashed) stimulation inputs, respectively. <bold>(a)</bold> the axonal field at the site receiving the positive stimulus is highlighted in red while the time evolution of the same axonal field at neighbouring locations is shown as gray lines. <bold>(b)</bold> the axonal field at the site receiving the negative input is highlighted in blue.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g008" xlink:type="simple"/>
</fig>
<p>Another important step is the calculation of the temporal power spectrum for a range of frequencies (in Hz), which is often compared to the power spectrum of experimental data. The power spectrum may also include multiple spatial modes for a range wave numbers (in m<sup>−1</sup>) and incorporate volume conduction or hemodynamic effects [<xref ref-type="bibr" rid="pcbi.1006387.ref083">83</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref084">84</xref>] on measurement. A comparison between the linear analytic power spectrum and the numerical nonlinear power spectrum calculated with <monospace>nf.spatial_spectrum()</monospace> is given as an example in <italic>Standard tests and reproducibility</italic>.</p>
</sec>
</sec>
<sec id="sec019">
<title>Results and applications</title>
<p>In this section we first present four exemplar systems that can be simulated using <italic>NFTsim</italic> and that have been previously studied in detail. Then, section <italic>Observables and diagnostics</italic> briefly discusses the main observables that can be currently computed in <italic>NFTsim</italic> and how these have been used to predict a range of brain phenomena and compare to experimental results. In section <italic>Standard tests and reproducibility,</italic>, we discuss how <italic>NFTsim</italic> could be used as a validation tool for neural field models and neural field simulators. Lastly, section <italic>Benchmarks</italic> presents performance metrics and practical information for users regarding average run times, memory usage, and storage required for typical simulations based on a neural field model of the corticothalamic system [<xref ref-type="bibr" rid="pcbi.1006387.ref029">29</xref>].</p>
<sec id="sec020">
<title>Exemplar systems</title>
<p>The versatility of neural field theory and its concomitant implementation in <italic>NFTsim</italic> allow for the investigation of an unlimited variety of specific models and parameter sets. In this section we present a few illustrative cases, which have been thoroughly described elsewhere, along with some of their applications [<xref ref-type="bibr" rid="pcbi.1006387.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref058">58</xref>]. Their respective configuration files are included in <italic>NFTsim</italic>.</p>
<p>The most general corticothalamic model considered here includes populations with long-, mid-, and short-range connections in the cortex, the specific and reticular nuclei in the thalamus, and external inputs. We indicate how components of this model can be successively deleted to obtain a family of models suited to simpler applications in corticothalamic and cortical systems. In what follows we label specific models according to the internal populations they include. The first system, called EMIRS, includes five different populations of neurons: cortical excitatory pyramidal (<italic>e</italic>), excitatory mid-range (<italic>m</italic>) and inhibitory (<italic>i</italic>) populations; internal thalamic reticular nucleus (<italic>r</italic>), relay specific nucleus (<italic>s</italic>), whereas the simplest case is of a system with a single excitatory population (<italic>e</italic>). There is also always at least one external population that provides inputs (often labeled either <italic>x</italic> or <italic>n</italic>). <italic>NFTsim</italic> provides a number of external input types such as sinusoids (in space and time), pulses, and Gaussian white noise. For instance, these inputs could be from excitatory neurons of the auditory pathway, which transmit signals from the cochlea to the thalamus [<xref ref-type="bibr" rid="pcbi.1006387.ref085">85</xref>]; or, they could be artificial external stimulation like Transcranial Magnetic Stimulation [<xref ref-type="bibr" rid="pcbi.1006387.ref038">38</xref>].</p>
<p><xref ref-type="fig" rid="pcbi.1006387.g009">Fig 9</xref> shows schematics of the illustrative neural field models described here. The EMIRS corticothalamic model displayed in <xref ref-type="fig" rid="pcbi.1006387.g009">Fig 9(a)</xref> includes three cortical populations (<italic>e</italic>, <italic>m</italic>, and <italic>i</italic>) and two thalamic populations (<italic>r</italic> and <italic>s</italic>), with intracortical, intrathalamic, and corticothalamic connections.</p>
<fig id="pcbi.1006387.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Schematic of four representative neural field models.</title>
<p>The quantities <italic>ϕ</italic><sub><italic>ab</italic></sub> are the fields propagating to population <italic>a</italic> from population <italic>b</italic>. Dashed lines represent inhibitory connections. <bold>(a)</bold> Corticothalamic model including excitatory (<italic>e</italic>), mid-range (<italic>m</italic>), inhibitory (<italic>i</italic>), reticular (<italic>r</italic>), specific relay (<italic>s</italic>) and external non-specific (<italic>n</italic>) populations. <bold>(b)</bold> Corticothalamic model including excitatory (<italic>e</italic>), inhibitory (<italic>i</italic>), reticular (<italic>r</italic>), specific relay (<italic>s</italic>), and external (<italic>n</italic>) populations. <bold>(c)</bold> Cortical model comprising excitatory (<italic>e</italic>) and inhibitory (<italic>i</italic>) cortical populations plus an external input field from a subcortical population (<italic>s</italic>). <bold>(d)</bold> Purely excitatory (<italic>e</italic>) cortical model with input from a subcortical population (<italic>s</italic>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g009" xlink:type="simple"/>
</fig>
<p>The EIRS corticothalamic model is obtained by deleting the population <italic>m</italic> from <xref ref-type="fig" rid="pcbi.1006387.g009">Fig 9(a)</xref> to obtain <xref ref-type="fig" rid="pcbi.1006387.g009">Fig 9(b)</xref>. Physically, this deletion corresponds to describing the effects of the mid- range population, whose axonal range is of the order of a few millimeters, as part of the short-range <italic>i</italic> population [<xref ref-type="bibr" rid="pcbi.1006387.ref001">1</xref>]. In this case, the excitatory effect partly cancels inhibition to give a weaker, net effect from this compound population, which includes the effects of both short-range excitatory and inhibitory interneurons. This model has been successfully applied to investigate a wide range of phenomena [<xref ref-type="bibr" rid="pcbi.1006387.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref086">86</xref>] (see <xref ref-type="sec" rid="sec001">Introduction</xref>). The model has five distinct populations of neurons: four internal and one external.</p>
<p>In the purely cortical EI model of <xref ref-type="fig" rid="pcbi.1006387.g009">Fig 9(c)</xref>, thalamic dynamics are deleted and <italic>ϕ</italic><sub><italic>es</italic></sub> = <italic>ϕ</italic><sub><italic>is</italic></sub> is assumed to replace <italic>ϕ</italic><sub><italic>sn</italic></sub> as the external input to an isolated cortex. The basic EI model includes external inputs to two cortical populations (<italic>e</italic> and <italic>i</italic>), and both intracortical and corticocortical feedback are represented. This model is a starting point for understanding more elaborate neural fields models of the cortex (e.g., modeling distinct layers within the gray matter [<xref ref-type="bibr" rid="pcbi.1006387.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref085">85</xref>]). Delays in the propagation of signals within neurons are due to synaptodendritic, soma, and axonal dynamics. However, in this model there are no long-range delays like those from the thalamus to the cortex. An extensive description and analysis of this model are given elsewhere [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref087">87</xref>], including emergence of gamma rhythm [<xref ref-type="bibr" rid="pcbi.1006387.ref086">86</xref>] and integration of cholinergic modulation [<xref ref-type="bibr" rid="pcbi.1006387.ref088">88</xref>]. Finally, the excitatory-only E model in <xref ref-type="fig" rid="pcbi.1006387.g009">Fig 9(d)</xref> omits cortical inhibitory effects. This neural field model is the simplest system we consider that can be simulated in <italic>NFTsim</italic> and has been used as the central example throughout this work.</p>
</sec>
<sec id="sec021">
<title>Observables and diagnostics</title>
<p>Brain phenomena including the alpha rhythm [<xref ref-type="bibr" rid="pcbi.1006387.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref034">34</xref>], age-related changes to the physiology of the brain [<xref ref-type="bibr" rid="pcbi.1006387.ref027">27</xref>], evoked response potentials [<xref ref-type="bibr" rid="pcbi.1006387.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref085">85</xref>], and seizure dynamics [<xref ref-type="bibr" rid="pcbi.1006387.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref058">58</xref>], can be measured noninvasively via EEG. In these studies, the fields of activity of the excitatory cortical population <italic>ϕ</italic><sub><italic>ee</italic></sub> have been used to approximate EEG signals measured from the surface of the scalp [<xref ref-type="bibr" rid="pcbi.1006387.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref089">89</xref>] and constitute one of the main biophysical observables comparable to experimental EEG data.</p>
<p>For the reasons mentioned above, the neural activity produced by <italic>NFTsim</italic> closely resembles the electrical activity measured by EEG and ECoG up to a dimensional constant (i.e., translate units of rate (s<sup>−1</sup>) into voltages).</p>
<p>Another tool traditionally used to detect various waking and sleep stages [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref029">29</xref>] is the EEG power spectrum [<xref ref-type="bibr" rid="pcbi.1006387.ref049">49</xref>]. In calculating scalp EEG spectra (rather than intracranial ones), one must consider filtering due to volume conduction by the cerebrospinal fluid, skull, and scalp [<xref ref-type="bibr" rid="pcbi.1006387.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref089">89</xref>]. The calculation of the power spectrum including volume conduction filtering is implemented as a spatial filter in <monospace>nf.spatial_spectrum</monospace>. The smoothed EEG timeseries can be obtained by inverse Fourier transforming the filtered power spectrum. In the case of ECoG, the spatial filtering due to volume conduction should not be applied.</p>
<p>It is important to notice, though, that the neural activity of different cortical and subcortical populations can be used to predict other relevant electrical signals such as local field potentials (LFPs), and stereoencephalography (SEEG); magnetic signals such as MEG; metabolic-related signals like fMRI [<xref ref-type="bibr" rid="pcbi.1006387.ref090">90</xref>] or indirect fluorescence signals like those recorded via voltage sensitive dyes imaging (VSDI) [<xref ref-type="bibr" rid="pcbi.1006387.ref091">91</xref>]. Note that conversion of <italic>NFTsim</italic> outputs to the desired neuroimaging modality signals still requires additional modeling steps, including a description of the causal relationship and physiological couplings between the sources (i.e., the spatiotemporal fields of neural activity stemming from multiple populations) and the effective biophysical quantity measured in experiments [<xref ref-type="bibr" rid="pcbi.1006387.ref083">83</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref084">84</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref092">92</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref095">95</xref>].</p>
</sec>
<sec id="sec022">
<title>Standard tests and reproducibility</title>
<p>Standard tests are a set of benchmarks used evaluate and compare disparate numerical implementations of similar neurobiological models [<xref ref-type="bibr" rid="pcbi.1006387.ref096">96</xref>]. There are very few such tests in computational neuroscience [<xref ref-type="bibr" rid="pcbi.1006387.ref097">97</xref>] and the ones currently available are only for single-cell models. To the best of the authors’ knowledge, there are no published standard tests for mesoscopic models such as neural fields. Thus, there is a huge void regarding quality assessment of scientific software for continuum models of brain dynamics.</p>
<p><italic>NFTsim</italic> provides a reference framework for standard tests for implementations of neural field models because its methods have been verified with analytic results; and, the linear analytic closed form solutions upon which the code is based have been extensively validated with experiments, as discussed in the Introduction. For example, in <xref ref-type="fig" rid="pcbi.1006387.g010">Fig 10</xref> we reproduce the results presented in Fig. 2 from [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>]. This plot shows a comparison between the linear analytic power spectrum (dashed line) and the spectrum computed from <italic>NFTsim</italic> simulations. Both spectra agree within the range of 0.1-45 Hz with a root-mean-square error of approximately 6 × 10<sup>−20</sup>. <italic>NFTsim</italic>’s default <monospace>eirs-corticothalamic.conf</monospace> is used with the parameters from [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>], which we do not repeat here because the original configuration files are also included as part of the library package. The power spectrum is calculated using the <monospace>nf.spatial_spectrum()</monospace> function.</p>
<fig id="pcbi.1006387.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Comparison of analytic and numeric EEG power spectra in the corticothalamic system.</title>
<p>The dynamics of the EIRS model were simulated using the wake parameters from [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>] for their Figure 2. The linear analytic spectrum (black dashed solid) is compared against the spectra computed from simulations (solid line).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.g010" xlink:type="simple"/>
</fig>
<p>Furthermore, the <italic>NFTsim</italic>’s methods and implementation have also been directly validated by experimental data for nonlinear dynamics, notably neural activity corresponding to seizures [<xref ref-type="bibr" rid="pcbi.1006387.ref036">36</xref>] and sleep spindles [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>].</p>
</sec>
<sec id="sec023">
<title>Benchmarks</title>
<p><italic>NFTsim</italic> provides a tool for semi-automated benchmarking. Timing and configuration information for simulation runs are stored in a comma-separated value (csv) file that can be processed at a later stage.</p>
<p>Invoking the script</p>
<p specific-use="line">1 nf_benchmarks</p>
<p>without any arguments will run all the configuration files in the <monospace>benchmarks/</monospace> directory once. We provide ten default configuration files that run in a total of under 700 s on a desktop computer. Example results for specific hardware are given below. These files are based on the corticothalamic model and are representative of typical simulation scenarios. With <monospace>nf_benchmarks</monospace> users can also:</p>
<list list-type="simple">
<list-item>
<label>(i)</label>
<p>benchmark a specific configuration file</p>
<p specific-use="line">1 nf_benchmarks &lt;config_filename&gt;</p>
</list-item>
<list-item>
<label>(ii)</label>
<p>benchmark a specific configuration file multiple times (e.g., 8 times in this example)</p>
<p specific-use="line">1 nf_benchmarks --num-trials 8 &lt;config_filename&gt;</p>
</list-item>
<list-item>
<label>(iii)</label>
<p>benchmark a specific configuration file with output written to memory instead of disk (this only works under Linux)</p>
<p specific-use="line">1 nf_benchmarks --to-mem &lt;config_filename&gt;</p>
</list-item>
<list-item>
<label>(iv)</label>
<p>benchmark a specific configuration file using a non-default compiler</p>
<p specific-use="line">1 nf_benchmarks --clang &lt;config_filename&gt;</p>
</list-item>
</list>
<p>In <italic>NFTsim</italic> propagating fields are followed via partial differential equations, so the main contributions to the runtime <italic>T</italic> are (i) the number of grid cells <italic>N</italic>; (ii) advancing a maximum of <italic>P</italic><sup>2</sup> fields, between <italic>P</italic> populations, on the <italic>N</italic> cells; (iii) the length of the simulation in integration steps <italic>L</italic> = <italic>T</italic><sub>sim</sub>/Δ<italic>t</italic>; and, (iv) the size of the output <italic>O</italic> written to file. So,
<disp-formula id="pcbi.1006387.e032"><alternatives><graphic id="pcbi.1006387.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi> <mml:mo>∝</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>sim</mml:mtext></mml:msub> <mml:msup><mml:mi>P</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>N</mml:mi> <mml:mi>L</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>out</mml:mtext></mml:msub> <mml:mi>O</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(33)</label></disp-formula>
where the coefficients <italic>k</italic><sub>sim</sub> and <italic>k</italic><sub>out</sub> depend on the hardware architecture. The output size <italic>O</italic> depends on the product of the total number of variables (<italic>W</italic>), the number of grid cells (<italic>N</italic><sub>out</sub>) and the total output time points [<italic>L</italic><sub>out</sub> = (<italic>T</italic><sub>sim</sub> − <italic>T</italic><sub>start</sub>)/Δ<italic>t</italic><sub>out</sub>] requested in the configuration file.</p>
<p>For large <italic>O</italic>, the runtime is dominated by writing operations. This overhead is expected for two reasons: (i) a simulated data sample is written to disk every Δ<italic>t</italic><sub>out</sub>, which takes additional time; and, (ii) writing the output to a text file requires conversion of numbers to text. Despite the runtime overhead this last point entails, text files are a convenient format to store the output because they are easier to debug than binary files.</p>
<p>The required memory, <italic>M</italic>, used by a <italic>NFTsim</italic> process is dominated by the number of grid points <italic>N</italic> and the history arrays of <italic>P</italic> internal populations with delay depth <italic>D</italic><sub><italic>a</italic></sub>, which is the number of integration steps for a signal to propagate to the target population from the source population. So,
<disp-formula id="pcbi.1006387.e040"><alternatives><graphic id="pcbi.1006387.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006387.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi> <mml:mo>∝</mml:mo> <mml:mi>N</mml:mi> <mml:mi>P</mml:mi> <mml:mi>D</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula></p>
<p><xref ref-type="table" rid="pcbi.1006387.t004">Table 4</xref> summarizes the simulation parameters that determine runtime and memory usage of a <italic>NFTsim</italic> process, including those which are not directly specified in a configuration file.</p>
<table-wrap id="pcbi.1006387.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.t004</object-id>
<label>Table 4</label>
<caption>
<title><italic>NFTsim</italic> simulation and output size parameters, and runtime and memory usage symbols.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006387.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="border-right:thick;border-bottom:thick">Symbol</th>
<th align="left" style="border-bottom:thick">Description</th>
<th align="left" style="border-bottom:thick">Parameter in configuration file</th>
<th align="left" style="border-bottom:thick">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" style="border-right:thick"><italic>T</italic><sub><italic>sim</italic></sub></td>
<td align="left">Simulation length</td>
<td align="left">
<monospace>Time</monospace>
</td>
<td align="left">s</td>
</tr>
<tr>
<td align="left" style="border-right:thick">Δ<italic>t</italic></td>
<td align="left">Integration time step</td>
<td align="left">
<monospace>Deltat</monospace>
</td>
<td align="left">s</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>L</italic></td>
<td align="left">Number of time steps</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>P</italic></td>
<td align="left">Number of populations</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>D</italic></td>
<td align="left">Delay depth</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>O</italic></td>
<td align="left">Output size</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>N</italic><sub>out</sub></td>
<td align="left">Number of output nodes</td>
<td align="left">
<monospace>Node</monospace>
</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left" style="border-right:thick">Δ<italic>t</italic><sub>out</sub></td>
<td align="left">Output sampling period</td>
<td align="left">
<monospace>Interval</monospace>
</td>
<td align="left">s</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>T</italic><sub>start</sub></td>
<td align="left">Output start time</td>
<td align="left">
<monospace>Start</monospace>
</td>
<td align="left">s</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>W</italic></td>
<td align="left">Number of output variables</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>L</italic><sub>out</sub></td>
<td align="left">Number of output time points</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>M</italic></td>
<td align="left">Memory used</td>
<td align="left">-</td>
<td align="left">byte</td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>T</italic></td>
<td align="left">Runtime</td>
<td align="left">-</td>
<td align="left">s</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001">
<p>First column: symbols used in this work to identify either the parameters specified in a configuration file, or variables associated with runtime and memory usage. Second column: description of the variable or parameter. Third column: parameter names used in configuration files. The symbol - means the parameter is not specified directly in a configuration file. Fourth column: SI units. Here, the symbol - means the quantity is dimensionless.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>To assess <italic>NFTsim</italic>’s performance, we select the corticothalamic model presented in earlier sections, with the parameters taken from previously published work [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>] and thus considered a typical simulation use case.</p>
<p>The simulation length and integration time step are held constant at 16 s and Δ<italic>t</italic> = 2<sup>−14</sup> s ≈ 10<sup>−4</sup> s, respectively. So, the only varying parameter that affects the runtime and storage is <monospace>Nodes</monospace> (<italic>N</italic>). The choice of this integration time step size is such that is sufficiently small to resolve high frequency oscillations and to satisfy the Courant condition for numerical stability for a range of discretization values between 3 mm &lt; Δ<italic>x</italic> &lt; 50 mm. The Courant number ranges between 0.014 &lt; <italic>p</italic> &lt; 0.15 for a fixed velocity <italic>v</italic><sub><italic>ab</italic></sub> = 10 m s<sup>−1</sup>.</p>
<p>Two groups of simulations were run. The first group, <italic>G</italic><sub><italic>no</italic></sub>, runs the simulation and only writes a copy of the configuration file to the output file. The subscript <italic>no</italic> means <monospace>no output</monospace>. In this case the runtime represents the effective time spent executing a simulation without the time overhead due to writing operations. From <xref ref-type="disp-formula" rid="pcbi.1006387.e032">Eq (33)</xref>, the group <italic>G</italic><sub><italic>no</italic></sub> has <italic>k</italic><sub>out</sub> ≈ 0. The second group of simulations <italic>G</italic><sub><italic>wo</italic></sub> consists of identical simulations to those of <italic>G</italic><sub><italic>no</italic></sub>, except that all the model variables (firing rate, voltages, fields, coupling strengths), for all the nodes, sampled at 512 Hz, are written to a file in the hard disk.</p>
<p>Approximate runtimes and memory usage are measured using tools available on Linux systems. The computer used for the benchmarks has Red Hat Enterprise Linux (RHEL) 6.9 as operating system, GNU Compiler collection (gcc) 4.9.2 as the default compiler, a 3.50 GHz Intel i5-4690 processor and 8GB of RAM.</p>
<p><xref ref-type="table" rid="pcbi.1006387.t005">Table 5</xref> presents the benchmark results for different grid sizes and shows that the runtimes scale linearly as a function of the number of nodes with <italic>k</italic><sub>sim</sub> ≈ 0.15 s for the simulation group <italic>G</italic><sub><italic>no</italic></sub> and and <italic>k</italic><sub>sim</sub> ≈ <italic>k</italic><sub>out</sub> ≈ 0.15 s for group <italic>G</italic><sub><italic>wo</italic></sub>. From these results, we conclude that in order to produce one minute worth of data sampled at a rate typically used in clinical EEG recordings, <italic>NFTsim</italic> takes about four minutes to run the simulation and write the output to disk. Thus, <italic>NFTsim</italic>’s simulation length to real-time data length ratio (<italic>T</italic><sub>sim</sub>/<italic>T</italic><sub>real</sub>) for EEG-compatible outputs is approximately 4. To reduce this ratio users can decrease the size of the output <italic>O</italic>, by writing only a few relevant variables to disk.</p>
<table-wrap id="pcbi.1006387.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006387.t005</object-id>
<label>Table 5</label>
<caption>
<title>Benchmarks for different grid sizes using <italic>NFTsim</italic> v.0.1.5.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006387.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" style="border-right:thick;border-bottom:thick"><monospace>Nodes</monospace></th>
<th align="center" style="border-bottom:thick">Storage [GB]</th>
<th align="center" style="border-bottom:thick">Memory [MB]</th>
<th align="center" style="border-bottom:thick">Runtime <italic>G</italic><sub><italic>no</italic></sub> [s]</th>
<th align="center" style="border-bottom:thick">Runtime <italic>G</italic><sub><italic>wo</italic></sub> [s]</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" style="border-right:thick">144</td>
<td align="center">1.1</td>
<td align="center">5</td>
<td align="center">24</td>
<td align="center">44</td>
</tr>
<tr>
<td align="center" style="border-right:thick">256</td>
<td align="center">1.9</td>
<td align="center">6</td>
<td align="center">40</td>
<td align="center">79</td>
</tr>
<tr>
<td align="center" style="border-right:thick">1024</td>
<td align="center">7.3</td>
<td align="center">16</td>
<td align="center">161</td>
<td align="center">302</td>
</tr>
<tr>
<td align="center" style="border-right:thick">4096</td>
<td align="center">29</td>
<td align="center">51</td>
<td align="center">646</td>
<td align="center">1208</td>
</tr>
<tr>
<td align="center" style="border-right:thick">16384</td>
<td align="center">116</td>
<td align="center">200</td>
<td align="center">2601</td>
<td align="center">4908</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t005fn001">
<p>The value of <monospace>Nodes</monospace> is reported on the first column. The second column informs the storage size of the output file with all the model variables for each node (firing rate, voltages, fields, coupling strengths) sampled at 1/Δ<italic>t</italic><sub>out</sub> = 512 Hz for the group of simulations <italic>G</italic><sub><italic>wo</italic></sub>. The third column presents the total memory usage of the process. Reported runtimes on the fourth column and fifth columns are the time elapsed in seconds. The values on the fourth column correspond to simulations with no output (<italic>no</italic>) written to the output file. The fifth column corresponds to the running times of simulations for which all the model variables for every node of the grid are written to the output file (<italic>wo</italic>). The same corticothalamic model is used in every simulation with <italic>T</italic><sub>sim</sub> = 16 s, and Δ<italic>t</italic> = 2<sup>−14</sup> s.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>While these benchmarks offer a narrow view of <italic>NFTsim</italic>’s performance, they are a valuable practical tool for users and provide: (i) estimates of resources required to run simulations; and, (ii) a guide to make informed decisions between the execution runtimes and accuracy (i.e., decreasing the spatial resolution and/or the time step).</p>
</sec>
</sec>
<sec id="sec024">
<title>Conclusions, availability, and future directions</title>
<p>We have introduced <italic>NFTsim</italic>, a user-ready, extensible and portable suite for numerical simulations of neural activity based on neural field models expressed in differential form. <italic>NFTsim</italic> is based on the well established framework of neural field theory [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>] and has been validated with both analytic solutions and experimental data. Thus, when working with new models and simulations users can use analytic solutions as a way to validate their results.</p>
<p>Written in C++, <italic>NFTsim</italic> has been tested on a range of Linux distributions (RHEL 6.9, RHEL 7.4, OpenSUSE 13.2, OpenSUSE 42.2). Current users have reported compatibility with OS X 10.11 and mac OS 10.12 in conjunction with the CLANG compiler, provided that the C++11 standard is supported. <italic>NFTsim</italic> has not been tested under Microsoft Windows.</p>
<p>The output of <italic>NFTsim</italic> is written to a plain text file and ancillary modules written in Matlab contain functions to assist in simulation execution, quick analysis and visualization of the results. <italic>NFTsim</italic> thus provides an efficient solution to simulating various continuum spatiotemporal models including spatially uniform (homogeneous) and nonuniform (inhomogeneous) neural field models [<xref ref-type="bibr" rid="pcbi.1006387.ref077">77</xref>]; systems with heterogeneous time delays between populations [<xref ref-type="bibr" rid="pcbi.1006387.ref034">34</xref>]; and, the selected format for data storage is simple enough that enables users to choose from a broad selection of tools to perform further analysis and visualization. The development of <italic>NFTsim</italic> follows essential practices of modern open-source scientific software development [<xref ref-type="bibr" rid="pcbi.1006387.ref097">97</xref>] such as:</p>
<list list-type="order">
<list-item>
<p>The code is licensed under the Apache 2.0 license.</p>
</list-item>
<list-item>
<p>Our code sources are hosted on Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/BrainDynamicsUSYD/nftsim" xlink:type="simple">https://github.com/BrainDynamicsUSYD/nftsim</ext-link>.</p>
</list-item>
<list-item>
<p>We use pull requests to review new features and bug fixes.</p>
</list-item>
<list-item>
<p>Our users can open issues reporting bugs and/or other problems they encounter.</p>
</list-item>
<list-item>
<p>The developer documentation is produced using <ext-link ext-link-type="uri" xlink:href="http://www.stack.nl/~dimitri/doxygen/" xlink:type="simple">Doxygen</ext-link> [<xref ref-type="bibr" rid="pcbi.1006387.ref098">98</xref>].</p>
</list-item>
<list-item>
<p>A separate manual is provided for end-users.</p>
</list-item>
<list-item>
<p>Releases are tagged, so users can refer to and download continuously improved versions of the code that are considered stable and tested. For instance, for this paper, we have used v1.1.0.</p>
</list-item>
</list>
<p>Most notably, the activity from neural populations can be used to calculate biophysical signals such as LFP, ECoG, or EEG signals, the latter being the most commonly found in previous studies. Other forms of biophysical observables, such as fMRI and VSDI may also be implemented, but require additional modeling work to define how the electrical activity relates to the corresponding measurements (e.g., oxygen consumption, blood flow changes or fluorescence). Further physical effects can be implemented as a part of postprocessing modules like <monospace>+nf</monospace>.</p>
<p>Due to its flexibility and generality, <italic>NFTsim</italic> allows for a systematic study of both healthy and unhealthy brain function. For instance, in [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>] the authors used simulations of a full nonlinear EIRS model for parameter values representing typical sleep spindle oscillations. They found that the numerical nonlinear power spectrum had an additional harmonic peak that was neither present in the linear EIRS model nor it was predicted by the analytic linearized power spectrum. This study clearly demonstrated that <italic>NFTsim</italic>’s flexibility allowed for the investigation of nonlinearities, introducing them one at the time in different neural populations. This enabled the authors to determine which anatomical structures and physiological mechanisms were responsible for the dynamics observed in experiments.</p>
<p>Due to its modularity, <italic>NFTsim</italic> is extensible and can accommodate new features presented in theoretical work on neural fields. In fact, a tool like <italic>NFTsim</italic> is essential for the study of nonlinearities and connectivities configurations that do not necessarily follow the random connectivity approximation [<xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref050">50</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref099">99</xref>] or are not spatially homogeneous or constant over time. For instance, [<xref ref-type="bibr" rid="pcbi.1006387.ref058">58</xref>] explored the mechanisms of seizures by incorporating slow currents modulating the bursting behavior of the reticular nucleus in the corticothalamic (EIRS) model; while [<xref ref-type="bibr" rid="pcbi.1006387.ref038">38</xref>] incorporated a model of synaptic plasticity to the purely excitatory subsystem. These two mechanisms are already implemented in the current version of <italic>NFTsim</italic>. However, further investigation and development work is required before implementing a general mechanism of parameter modulation, which would allow for the study different types and functional forms of neural feedbacks [<xref ref-type="bibr" rid="pcbi.1006387.ref062">62</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref100">100</xref>].</p>
<p>We remind potential users that <italic>NFTsim</italic>, as any scientific software, should not be used blindly. As a minimal requirement, users should check that:</p>
<list list-type="simple">
<list-item>
<label>(i)</label>
<p>The integration time step is small enough to resolve the simulated dynamics correctly, especially if the system exhibits chaotic and bursting dynamics;</p>
</list-item>
<list-item>
<label>(ii)</label>
<p>The parameter <monospace>Interval</monospace>, which effectively subsamples the timeseries written to disk, is an integer multiple of the time step; and, is small enough so as to avoid temporal aliasing if there are signals with high-frequency content (e.g., the effective sampling frequency of the signal written to disk (1/<monospace>Interval</monospace>) is sufficient to respect Nyquist’s sampling theorem.</p>
</list-item>
<list-item>
<label>(iii)</label>
<p>The integration time step is small enough to respect the Courant conditions. If this condition is not met the code throws an error. A way to select an appropriate value of <monospace>Deltat</monospace> would by running the simulation with increased or decreased time steps to check for stability and convergence of the solutions to a limiting case.</p>
</list-item>
<list-item>
<label>(iv)</label>
<p>Setting parameters such as <monospace>Deltat, Interval</monospace> and <monospace>Nodes</monospace> as multiples or submultiples of powers of two (<italic>NFTsim</italic>’s default values), minimizes numerical errors due to the inherent limitations of representing floating point numbers on a computer. In addition, other advantages of using powers of two are (i) achieving optimal performance of FFT algorithms when applied to the output timeseries (1 second of data will have a power-of-two number of samples); and, (ii) avoiding zero-padding which is a frequent default behavior of FFT algorithms. However, users are not obliged to use <italic>NFTsim</italic>’s default values. They can select any value and simulations will be executed.</p>
</list-item>
<list-item>
<label>(v)</label>
<p>Artifacts of periodicity introduced by PBCs as illustrated in <xref ref-type="fig" rid="pcbi.1006387.g007">Fig 7</xref> are avoided. This can be achieved by setting the grid’s area larger than that of the actual physical system under consideration. In this scenario, waves propagating from the region of interest towards the right edge of the grid would die off before being reintroduced on the left edge. This approximation would be close to the solution in the absence of artificial boundaries in which the region of interest has infinite size; or to absorbing boundary conditions (ABCs).</p>
</list-item>
</list>
<p>Note that PBCs may be preferable over absorbing BCs in scenarios when one is interested in studying wave-wave interactions. However, in neural field models that approximate a small patch of cortex such as the primary visual cortex V1, in which waves of activity propagate away from a source point of stimulation [<xref ref-type="bibr" rid="pcbi.1006387.ref094">94</xref>], then absorbing BCs would likely be more appropriate.</p>
<p>In the present work we have concentrated mainly on a high-level description of the software and presented examples for which model parameters are assumed to be spatially uniform. <italic>NFTsim</italic> already accepts spatial variations in many parameters, although more development work needs to be done to provide general mechanisms of parameter variation.</p>
<p>Note that <italic>NFTsim</italic> solves differential equations. It does not solve integrodifferential equations like those of Nichols and Hutt’s Neural Field Simulator [<xref ref-type="bibr" rid="pcbi.1006387.ref008">8</xref>]. It is important to notice that not all neural field expressed in integrodifferential form can be expressed in differential form. On the other hand, neural fields expressed in differential form can be expressed in integrodiffrential form and can be solved in <italic>NFTsim</italic>.</p>
<p>As mentioned in <italic>Classes and their interactions</italic>, <italic>NFTsim</italic> currently has Gaussian white noise in its collection of external driving signals because in the literature [<xref ref-type="bibr" rid="pcbi.1006387.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref065">65</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref101">101</xref>–<xref ref-type="bibr" rid="pcbi.1006387.ref104">104</xref>] neural field models are typically either initialized or driven by a signal with a flat (white) power spectrum. These inputs correspond to the activity of other brain structures that are not explicitly modeled in the equations. In the case of the corticothalamic system, these inputs may represent background activity from the brain stem. In the case of a purely cortical model, these inputs could represent the combined activity from the thalamus and other structures. It is important to notice that external inputs with a broad white spectrum enter the NFT differential equations in exactly the same way as more coherent stimulus such as a sine wave would, as such, standard numerical methods (RK4) are employed.</p>
<p>However, there are several limitations that make this type of signal a poor choice. The first limitation is that idealized continuous noise is not physically realistic because it has an infinite bandwidth and infinite power. The second limitation is that in computer simulations, where continuous models are inevitably discretized, the bandwidth of a white noise signal depends on the size of the discretization. This dependence implies that if either the time step or the spatial step are reduced, the bandwidth increases and as a result a white noise signal has additional modes (i.e., frequency components). One can use a scaling parameter to adjust the overall power of the discretized driving signal [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006387.ref081">81</xref>]. This scaling has no effect on the resulting spectral shape that is often compared to EEG [<xref ref-type="bibr" rid="pcbi.1006387.ref006">6</xref>]. For these reasons, it is necessary to incorporate a new type of stimuli that has a white spectrum but that is differentiable in time and space; and its spectral profile does not change under changes of the discretization.</p>
<p>Future work will extend <italic>NFTsim</italic> scientific features by including (i) a new bandlimited noise generation to render the inputs even more biologically realistic; (ii) generalized mechanisms of spatiotemporal variations for different model parameters and variables; (iii) generalized mechanisms of neuromodulation; (iv) absorbing boundary conditions; and, (v) spherical topology. In addition, a number of technical enhancements will be made such as (i) implement support for output binary files; and (ii) extend and automate unit test coverage to ensure that new additions to the code do not break previous functionality.</p>
</sec>
<sec id="sec025">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006387.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Discretization of the wave equation.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006387.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006387.s002" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Configuration file used in analysis and visualization.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors thank B. Fulcher, M. Prodanovic, J. A. Roberts and R. G. Townsend for useful discussions and feedback.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006387.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Rowe</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>O’Connor</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>E</given-names></name>. <article-title>Multiscale brain modelling</article-title>. <source>Phil Trans R Soc B</source>. <year>2005</year>;<volume>360</volume>(<issue>1457</issue>):<fpage>1043</fpage>–<lpage>1050</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2005.1638" xlink:type="simple">10.1098/rstb.2005.1638</ext-link></comment> <object-id pub-id-type="pmid">16087447</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>JJ</given-names></name>. <article-title>Propagation and stability of waves of electrical activity in the cortex</article-title>. <source>Phys Rev E</source>. <year>1997</year>;<volume>56</volume>:<fpage>826</fpage>–<lpage>840</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.56.826" xlink:type="simple">10.1103/PhysRevE.56.826</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>JW</given-names></name>. <article-title>Spike, rate, field, and hybrid methods for treating neuronal dynamics and interactions</article-title>. <source>Comp Neurosci</source>. <year>2012</year>;<volume>205</volume>:<fpage>283</fpage>–<lpage>294</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roberts</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Quantitative theory of driven nonlinear brain dynamics</article-title>. <source>Neuroimage</source>. <year>2012</year>;<volume>62</volume>(<issue>3</issue>):<fpage>1947</fpage>–<lpage>1955</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2012.05.054" xlink:type="simple">10.1016/j.neuroimage.2012.05.054</ext-link></comment> <object-id pub-id-type="pmid">22652022</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roberts</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Modeling absence seizure dynamics: implications for basic mechanisms and measurement of thalamocortical and corticothalamic latencies</article-title>. <source>J Theor Biol</source>. <year>2008</year>;<volume>253</volume>(<issue>1</issue>):<fpage>189</fpage>–<lpage>201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2008.03.005" xlink:type="simple">10.1016/j.jtbi.2008.03.005</ext-link></comment> <object-id pub-id-type="pmid">18407293</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abeysuriya</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Prediction and verification of nonlinear sleep spindle harmonic oscillations</article-title>. <source>J Theor Biol</source>. <year>2014</year>;<volume>344</volume>:<fpage>70</fpage>–<lpage>77</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2013.11.013" xlink:type="simple">10.1016/j.jtbi.2013.11.013</ext-link></comment> <object-id pub-id-type="pmid">24291492</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanz-Leon</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Knock</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Woodman</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Domide</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Mersmann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>McIntosh</surname> <given-names>AR</given-names></name>, <etal>et al</etal>. <article-title>The Virtual Brain: A simulator of primate brain network dynamics</article-title>. <source>Front Neuroinform</source>. <year>2013</year>;<volume>7</volume>(<issue>10</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fninf.2013.00010" xlink:type="simple">10.3389/fninf.2013.00010</ext-link></comment> <object-id pub-id-type="pmid">23781198</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nichols</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Hutt</surname> <given-names>A</given-names></name>. <article-title>Neural Field Simulator: Two-dimensional spatio-temporal dynamics involving finite transmission speed</article-title>. <source>Front Neuroinf</source>. <year>2015</year>;<volume>9</volume>(<issue>25</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rudolph</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Carnevale</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hines</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Beeman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bower</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>Simulation of networks of spiking neurons: A review of tools and strategies</article-title>. <source>J Comput Neurosci</source>. <year>2007</year>;<volume>23</volume>(<issue>3</issue>):<fpage>349</fpage>–<lpage>398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-007-0038-6" xlink:type="simple">10.1007/s10827-007-0038-6</ext-link></comment> <object-id pub-id-type="pmid">17629781</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <article-title>The dynamic brain: from spiking neurons to neural masses and cortical fields</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e1000092</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000092" xlink:type="simple">10.1371/journal.pcbi.1000092</ext-link></comment> <object-id pub-id-type="pmid">18769680</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>JW</given-names></name>. <article-title>Firing responses of bursting neurons with delayed feedback</article-title>. <source>J Comput Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>1</issue>):<fpage>61</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-010-0302-z" xlink:type="simple">10.1007/s10827-010-0302-z</ext-link></comment> <object-id pub-id-type="pmid">21165686</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hämäläinen</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Sarvas</surname> <given-names>J</given-names></name>. <article-title>Realistic conductivity geometry model of the human head for interpretation of neuromagnetic data</article-title>. <source>IEEE Trans Biomed Eng</source>. <year>1989</year>;<volume>36</volume>(<issue>2</issue>):<fpage>165</fpage>–<lpage>171</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/10.16463" xlink:type="simple">10.1109/10.16463</ext-link></comment> <object-id pub-id-type="pmid">2917762</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hämäläinen</surname> <given-names>MS</given-names></name>. <article-title>Magnetoencephalography: A tool for functional brain imaging</article-title>. <source>Brain Topogr</source>. <year>1992</year>;<volume>5</volume>(<issue>2</issue>):<fpage>95</fpage>–<lpage>102</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF01129036" xlink:type="simple">10.1007/BF01129036</ext-link></comment> <object-id pub-id-type="pmid">1489655</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hämäläinen</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Hari</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ilmoniemi</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Knuutila</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lounasmaa</surname> <given-names>OV</given-names></name>. <article-title>Magnetoencephalography-theory, instrumentation, and applications to noninvasive studies of the working human brain</article-title>. <source>Rev Mod Phys</source>. <year>1993</year>;<volume>65</volume>(<issue>2</issue>):<fpage>413</fpage>–<lpage>497</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/RevModPhys.65.413" xlink:type="simple">10.1103/RevModPhys.65.413</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kistler</surname> <given-names>WM</given-names></name>. <chapter-title>Spiking neuron models</chapter-title>. <source>Single neurons, populations, plasticity</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge U. Press</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name>. <article-title>Simple model of spiking neurons</article-title>. <source>IEEE Trans Neural Netw</source>. <year>2003</year>;<volume>14</volume>(<issue>6</issue>):<fpage>1569</fpage>–<lpage>1572</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TNN.2003.820440" xlink:type="simple">10.1109/TNN.2003.820440</ext-link></comment> <object-id pub-id-type="pmid">18244602</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goodman</surname> <given-names>DFM</given-names></name>, <name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>. <article-title>Brian: A simulator for spiking neural networks in python</article-title>. <source>Front Neuroinform</source>. <year>2008</year>;<volume>2</volume>:<fpage>5</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/neuro.11.005.2008" xlink:type="simple">10.3389/neuro.11.005.2008</ext-link></comment> <object-id pub-id-type="pmid">19115011</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Goodman</surname> <given-names>DFM</given-names></name>. <article-title>Vectorized algorithms for spiking neural network simulation</article-title>. <source>Neural Comput</source>. <year>2011</year>;<volume>23</volume>(<issue>6</issue>):<fpage>1503</fpage>–<lpage>1535</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/NECO_a_00123" xlink:type="simple">10.1162/NECO_a_00123</ext-link></comment> <object-id pub-id-type="pmid">21395437</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hines</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Davison</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Muller</surname> <given-names>E</given-names></name>. <article-title>NEURON and Python</article-title>. <source>Front Neuroinf</source>. <year>2009</year>;<volume>3</volume>(<issue>1</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gewaltig</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>. <article-title>NEST (Neural Simulation Tool)</article-title>. <source>Scholarpedia</source>. <year>2007</year>;<volume>2</volume>(<issue>4</issue>):<fpage>1430</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4249/scholarpedia.1430" xlink:type="simple">10.4249/scholarpedia.1430</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pecevski</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Natschläger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Schuch</surname> <given-names>K</given-names></name>. <article-title>PCSIM: A Parallel Simulation Environment for Neural Circuits Fully Integrated with Python</article-title>. <source>Front Neuroinform</source>. <year>2009</year>;<volume>3</volume>:<fpage>11</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/neuro.11.011.2009" xlink:type="simple">10.3389/neuro.11.011.2009</ext-link></comment> <object-id pub-id-type="pmid">19543450</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hoang</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Tanna</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Jayet Bray</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Dascalu</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>FC</given-names> <suffix>Jr</suffix></name>. <article-title>A novel CPU/GPU simulation environment for large-scale biologically realistic neural modeling</article-title>. <source>Front Neuroinf</source>. <year>2013</year>;<volume>7</volume>:<fpage>19</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fninf.2013.00019" xlink:type="simple">10.3389/fninf.2013.00019</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zalesky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fornito</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Harding</surname> <given-names>IH</given-names></name>, <name name-style="western"><surname>Cocchi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yücel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pantelis</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bullmore</surname> <given-names>ET</given-names></name>. <article-title>Whole-brain anatomical networks: does the choice of nodes matter?</article-title> <source>Neuroimage</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>970</fpage>–<lpage>983</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2009.12.027" xlink:type="simple">10.1016/j.neuroimage.2009.12.027</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spiegler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>. <article-title>Systematic approximations of neural fields through networks of neural masses in the virtual brain</article-title>. <source>Neuroimage</source>. <year>2013</year>;<volume>83C</volume>:<fpage>704</fpage>–<lpage>725</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2013.06.018" xlink:type="simple">10.1016/j.neuroimage.2013.06.018</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>. <article-title>Dynamic models of large-scale brain activity</article-title>. <source>Nature Rev Neurosci</source>. <year>2017</year>;<volume>20</volume>(<issue>3</issue>):<fpage>340</fpage>–<lpage>352</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4497" xlink:type="simple">10.1038/nn.4497</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kerr</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Van Albada</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Neymotin</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Chadderdon</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Lytton</surname> <given-names>WW</given-names></name>. <article-title>Cortical information flow in Parkinson’s disease: A composite network/field model</article-title>. <source>Front Comput Neurosci</source>. <year>2013</year>;<volume>7</volume>:<fpage>39</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2013.00039" xlink:type="simple">10.3389/fncom.2013.00039</ext-link></comment> <object-id pub-id-type="pmid">23630492</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Albada</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Kerr</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Chiang</surname> <given-names>AKI</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Neurophysiological changes with age probed by inverse modeling of EEG spectra</article-title>. <source>Clin Neurophysiol</source>. <year>2010</year>;<volume>121</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.clinph.2009.09.021" xlink:type="simple">10.1016/j.clinph.2009.09.021</ext-link></comment> <object-id pub-id-type="pmid">19854102</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>JJ</given-names></name>. <article-title>Unified neurophysical model of EEG spectra and evoked potentials</article-title>. <source>Biol Cybern</source>. <year>2002</year>;<volume>86</volume>(<issue>6</issue>):<fpage>457</fpage>–<lpage>471</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00422-002-0310-9" xlink:type="simple">10.1007/s00422-002-0310-9</ext-link></comment> <object-id pub-id-type="pmid">12111274</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Rowe</surname> <given-names>DL</given-names></name>. <article-title>Dynamics of large-scale brain activity in normal arousal states and epileptic seizures</article-title>. <source>Phys Rev E</source>. <year>2002</year>;<volume>65</volume>:<fpage>041924</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.65.041924" xlink:type="simple">10.1103/PhysRevE.65.041924</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abeysuriya</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>JW</given-names></name>. <article-title>Experimental observation of a theoretically predicted nonlinear sleep spindle harmonic in human EEG</article-title>. <source>J Clin Neurophysiol</source>. <year>2014</year>;<volume>125</volume>(<issue>10</issue>):<fpage>2016</fpage>–<lpage>2023</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.clinph.2014.01.025" xlink:type="simple">10.1016/j.clinph.2014.01.025</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rowe</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>. <article-title>Estimation of neurophysiological parameters from the waking EEG using a biophysical model of brain dynamics</article-title>. <source>J Theor Biol</source>. <year>2004</year>;<volume>231</volume>(<issue>3</issue>):<fpage>413</fpage>–<lpage>433</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2004.07.004" xlink:type="simple">10.1016/j.jtbi.2004.07.004</ext-link></comment> <object-id pub-id-type="pmid">15501472</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Bourke</surname> <given-names>PD</given-names></name>. <article-title>Steady states and global dynamics of electrical activity in the cerebral cortex</article-title>. <source>Phys Rev E</source>. <year>1998</year>;<volume>58</volume>:<fpage>3557</fpage>–<lpage>3571</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.58.3557" xlink:type="simple">10.1103/PhysRevE.58.3557</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Rowe</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>O’Connor</surname> <given-names>SC</given-names></name>. <article-title>Estimation of multiscale neurophysiologic parameters by electroencephalographic means</article-title>. <source>Hum Brain Mapp</source>. <year>2004</year>;<volume>23</volume>(<issue>1</issue>):<fpage>53</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hbm.20032" xlink:type="simple">10.1002/hbm.20032</ext-link></comment> <object-id pub-id-type="pmid">15281141</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Whitehouse</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>. <article-title>Nonuniform corticothalamic continuum model of electroencephalographic spectra with application to split-alpha peaks</article-title>. <source>Phys Rev E</source>. <year>2003</year>;<volume>68</volume>:<fpage>021922</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.68.021922" xlink:type="simple">10.1103/PhysRevE.68.021922</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kerr</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Model-based analysis and quantification of age trends in auditory evoked potentials</article-title>. <source>Clin Neurophysiol</source>. <year>2011</year>;<volume>122</volume>:<fpage>134</fpage>–<lpage>147</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.clinph.2010.05.030" xlink:type="simple">10.1016/j.clinph.2010.05.030</ext-link></comment> <object-id pub-id-type="pmid">20594907</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roberts</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Terry</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Rodrigues</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mahant</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>A unifying explanation of primary generalized seizures through nonlinear brain modeling and bifurcation analysis</article-title>. <source>Cereb Cortex</source>. <year>2006</year>;<volume>16</volume>(<issue>9</issue>):<fpage>1296</fpage>–<lpage>1313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/bhj072" xlink:type="simple">10.1093/cercor/bhj072</ext-link></comment> <object-id pub-id-type="pmid">16280462</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fung</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Neural field theory of calcium dependent plasticity with applications to transcranial magnetic stimulation</article-title>. <source>J Theor Biol</source>. <year>2013</year>;<volume>324</volume>:<fpage>72</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2013.01.013" xlink:type="simple">10.1016/j.jtbi.2013.01.013</ext-link></comment> <object-id pub-id-type="pmid">23376643</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fung</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Neural field theory of synaptic metaplasticity with applications to theta burst stimulation</article-title>. <source>J Theor Biol</source>. <year>2014</year>;<volume>340</volume>(<issue>7</issue>):<fpage>164</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2013.09.021" xlink:type="simple">10.1016/j.jtbi.2013.09.021</ext-link></comment> <object-id pub-id-type="pmid">24060620</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abeysuriya</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Physiologically based arousal state estimation and dynamics</article-title>. <source>J Neurosci Meth</source>. <year>2015</year>;<volume>253</volume>:<fpage>55</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jneumeth.2015.06.002" xlink:type="simple">10.1016/j.jneumeth.2015.06.002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fung</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Haber</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Neural field theory of large-scale synaptic plasticity in the cerebral cortex</article-title>. <source>J Theor Biol</source>. <year>2013</year>;<volume>318</volume>:<fpage>44</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2012.09.030" xlink:type="simple">10.1016/j.jtbi.2012.09.030</ext-link></comment> <object-id pub-id-type="pmid">23036915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Neural Field Theory of Synaptic Plasticity</article-title>. <source>J Theor Biol</source>. <year>2011</year>;<volume>285</volume>:<fpage>156</fpage>–<lpage>163</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2011.06.023" xlink:type="simple">10.1016/j.jtbi.2011.06.023</ext-link></comment> <object-id pub-id-type="pmid">21767551</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Goodwin</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Brownjohn</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Shemmell</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Reynolds</surname> <given-names>JNJ</given-names></name>. <article-title>Numerical modelling of plasticity induced by transcranial magnetic stimulation</article-title>. <source>J Comp Neurosci</source>. <year>2013</year>;<volume>36</volume>(<issue>3</issue>):<fpage>499</fpage>–<lpage>514</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-013-0485-1" xlink:type="simple">10.1007/s10827-013-0485-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Loxley</surname> <given-names>PN</given-names></name>, <name name-style="western"><surname>O’Connor</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>. <article-title>Modal analysis of corticothalamic dynamics, electroencephalographic spectra, and evoked potentials</article-title>. <source>Phys Rev E</source>. <year>2001</year>;<volume>63</volume>:<fpage>041909</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.63.041909" xlink:type="simple">10.1103/PhysRevE.63.041909</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Sarkar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pandejee</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Henderson</surname> <given-names>JA</given-names></name>. <article-title>Determination of effective brain connectivity from functional connectivity with application to resting state connectivities</article-title>. <source>Phys Rev E</source>. <year>2014</year>;<volume>90</volume>(<issue>1</issue>):<fpage>012707</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.90.012707" xlink:type="simple">10.1103/PhysRevE.90.012707</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Amari</surname> <given-names>S</given-names></name>. <article-title>Homogeneous nets of neuron-like elements</article-title>. <source>Biol Cybern</source>. <year>1975</year>;<volume>17</volume>:<fpage>211</fpage>–<lpage>220</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00339367" xlink:type="simple">10.1007/BF00339367</ext-link></comment> <object-id pub-id-type="pmid">1125349</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Amari</surname> <given-names>S</given-names></name>. <article-title>Dynamics of pattern formation in lateral inhibition type neural fields</article-title>. <source>Biol Cybern</source>. <year>1977</year>;<volume>27</volume>:<fpage>77</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00337259" xlink:type="simple">10.1007/BF00337259</ext-link></comment> <object-id pub-id-type="pmid">911931</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>A mathematical theory of the functional dynamics of cortical and thalamic nervous tissue</article-title>. <source>Kybernetik</source>. <year>1973</year>;<volume>13</volume>:<fpage>55</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00288786" xlink:type="simple">10.1007/BF00288786</ext-link></comment> <object-id pub-id-type="pmid">4767470</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref048">
<label>48</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Freeman</surname> <given-names>WJ</given-names></name>. <source>Mass Action in the Nervous System</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Academic</publisher-name>; <year>1975</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref049">
<label>49</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Nunez</surname> <given-names>PL</given-names></name>. <source>Neocortical Dynamics and Human EEG Rhythms</source>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>; <year>1995</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wright</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Liley</surname> <given-names>DTJ</given-names></name>. <article-title>Dynamics of the brain at global and microscopic scales: Neural networks and the EEG</article-title>. <source>Behav Brain Sci</source>. <year>1996</year>;<volume>19</volume>:<fpage>285</fpage>–<lpage>320</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0140525X00042679" xlink:type="simple">10.1017/S0140525X00042679</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lopes da Silva</surname> <given-names>FH</given-names></name>, <name name-style="western"><surname>Hoeks</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Smits</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zetterberg</surname> <given-names>LH</given-names></name>. <article-title>Model of brain rhythmic activity. The alpha-rhythm of the thalamus</article-title>. <source>Kybernetik</source>. <year>1974</year>;<volume>15</volume>:<fpage>27</fpage>–<lpage>37</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00270757" xlink:type="simple">10.1007/BF00270757</ext-link></comment> <object-id pub-id-type="pmid">4853232</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ermentrout</surname> <given-names>B</given-names></name>. <article-title>Neural networks as spatio-temporal pattern-forming systems</article-title>. <source>Rep Prog Phys</source>. <year>1998</year>;<volume>61</volume>(<issue>4</issue>):<fpage>353</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/0034-4885/61/4/002" xlink:type="simple">10.1088/0034-4885/61/4/002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Haken</surname> <given-names>H</given-names></name>. <article-title>Field Theory of Electromagnetic Brain Activity</article-title>. <source>Phys Rev Lett</source>. <year>1996</year>;<volume>77</volume>:<fpage>960</fpage>–<lpage>963</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.77.960" xlink:type="simple">10.1103/PhysRevLett.77.960</ext-link></comment> <object-id pub-id-type="pmid">10062950</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanz-Leon</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Knock</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Spiegler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>. <article-title>Mathematical framework for large-scale brain network modeling in The Virtual Brain</article-title>. <source>Neuroimage</source>. <year>2015</year>;<volume>111</volume>:<fpage>385</fpage>–<lpage>430</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2015.01.002" xlink:type="simple">10.1016/j.neuroimage.2015.01.002</ext-link></comment> <object-id pub-id-type="pmid">25592995</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref055">
<label>55</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Heitmann</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>. <source>Handbook for the Brain Dynamics Toolbox</source>. <edition>1st ed</edition>. <publisher-loc>Brisbane</publisher-loc>: <publisher-name>QIMR Berghofer Medical Research Institute</publisher-name>; <year>2017</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Müller</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>van Albada</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Unified neural field theory of brain dynamics underlying oscillations in Parkinson’s disease and generalized epilepsies</article-title>. <source>J Theor Biol</source>. <year>2017</year>;<volume>428</volume>:<fpage>132</fpage>–<lpage>146</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2017.06.016" xlink:type="simple">10.1016/j.jtbi.2017.06.016</ext-link></comment> <object-id pub-id-type="pmid">28633970</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Critical dynamics of Hopf bifurcations in the corticothalamic system: Transitions from normal arousal states to epileptic seizures</article-title>. <source>Phys Rev E</source>. <year>2017</year>;<volume>95</volume>(<issue>4</issue>):<fpage>042410</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.95.042410" xlink:type="simple">10.1103/PhysRevE.95.042410</ext-link></comment> <object-id pub-id-type="pmid">28505725</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Generalized seizures in a neural field model with bursting dynamics</article-title>. <source>J Comput Neurosci</source>. <year>2015</year>;<volume>39</volume>(<issue>2</issue>):<fpage>197</fpage>–<lpage>216</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-015-0571-7" xlink:type="simple">10.1007/s10827-015-0571-7</ext-link></comment> <object-id pub-id-type="pmid">26282528</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bojak</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Liley</surname> <given-names>DTJ</given-names></name>. <article-title>Axonal velocity distributions in neural field equations</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>1</issue>):<fpage>e1000653</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000653" xlink:type="simple">10.1371/journal.pcbi.1000653</ext-link></comment> <object-id pub-id-type="pmid">20126532</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Rowe</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>O’Connor</surname> <given-names>SC</given-names></name>. <article-title>Estimation of multiscale neurophysiologic parameters by electroencephalographic means</article-title>. <source>Hum Brain Mapp</source>. <year>2004</year>;<volume>23</volume>:<fpage>53</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hbm.20032" xlink:type="simple">10.1002/hbm.20032</ext-link></comment> <object-id pub-id-type="pmid">15281141</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Connor</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Chiang</surname> <given-names>AKI</given-names></name>. <article-title>Wave-number spectrum of electroencephalographic signals</article-title>. <source>Phys Rev E</source>. <year>2002</year>;<volume>66</volume>(<issue>6</issue>):<fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Roy</surname> <given-names>N</given-names></name>. <article-title>Neural field theory of nonlinear wave-wave and wave-neuron processes</article-title>. <source>Phys Rev E</source>. <year>2015</year>;<volume>91</volume>(<issue>6-1</issue>):<fpage>062719</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.91.062719" xlink:type="simple">10.1103/PhysRevE.91.062719</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roberts</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Modeling distributed axonal delays in mean-field brain dynamics</article-title>. <source>Phys Rev E</source>. <year>2008</year>;<volume>78</volume>:<fpage>051901</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.78.051901" xlink:type="simple">10.1103/PhysRevE.78.051901</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nunez</surname> <given-names>PL</given-names></name>. <article-title>Wavelike properties of the alpha rhythm</article-title>. <source>IEEE Trans Biomed Eng</source>. <year>1974</year>;<volume>21</volume>:<fpage>473</fpage>–<lpage>482</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TBME.1974.324336" xlink:type="simple">10.1109/TBME.1974.324336</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Steyn-Ross</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Steyn-Ross</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Sligh</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Liley</surname> <given-names>DTJ</given-names></name>. <article-title>Theoretical electroencephalogram stationary spectrum for a white-noise-driven cortex: Evidence for a general anesthetic-induced phase transition</article-title>. <source>Phys Rev E</source>. <year>1999</year>;<volume>60</volume>:<fpage>7299</fpage>–<lpage>7311</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.60.7299" xlink:type="simple">10.1103/PhysRevE.60.7299</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref066">
<label>66</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kandel</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Schwartz</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Jessell</surname> <given-names>TM</given-names></name>. <source>Principles of Neural Science</source>. <edition>4th ed</edition>. <publisher-loc>New York</publisher-loc>: <publisher-name>McGraw-Hill</publisher-name>; <year>2000</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rubino</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Robbins</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Hatsopoulos</surname> <given-names>NG</given-names></name>. <article-title>Propagating waves mediate information transfer in the motor cortex</article-title>. <source>Nat Neurosci</source>. <year>2006</year>;<volume>9</volume>:<fpage>1549</fpage>–<lpage>1557</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1802" xlink:type="simple">10.1038/nn1802</ext-link></comment> <object-id pub-id-type="pmid">17115042</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Takagaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>JY</given-names></name>. <article-title>Compression and reflection of visually evoked cortical waves</article-title>. <source>Neuron</source>. <year>2007</year>;<volume>55</volume>:<fpage>119</fpage>–<lpage>129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2007.06.016" xlink:type="simple">10.1016/j.neuron.2007.06.016</ext-link></comment> <object-id pub-id-type="pmid">17610821</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schiff</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>JY</given-names></name>. <article-title>Dynamical evolution of spatiotemporal patterns in mammalian middle cortex</article-title>. <source>Phys Rev Lett</source>. <year>2007</year>;<volume>98</volume>:<fpage>178102</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.98.178102" xlink:type="simple">10.1103/PhysRevLett.98.178102</ext-link></comment> <object-id pub-id-type="pmid">17501537</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Beurle</surname> <given-names>RL</given-names></name>. <article-title>Properties of a Mass of Cells Capable of Regenerating Pulses</article-title>. <source>Phil Trans R Soc B</source>. <year>1956</year>;<volume>240</volume>:<fpage>55</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.1956.0012" xlink:type="simple">10.1098/rstb.1956.0012</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Propagator theory of brain dynamics</article-title>. <source>Phys Rev E</source>. <year>2005</year>;<volume>72</volume>:<fpage>011904-1</fpage>–<lpage>011904-13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.72.011904" xlink:type="simple">10.1103/PhysRevE.72.011904</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref072">
<label>72</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>International Organization for Standardization</collab>. <source>ISO International Standard 8601—Date and time format</source>. <edition>2nd ed</edition>. <publisher-loc>Geneva</publisher-loc>: <publisher-name>ISO</publisher-name>;<year>2004</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.iso.org/iso-8601-date-and-time-format.html" xlink:type="simple">https://www.iso.org/iso-8601-date-and-time-format.html</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref073">
<label>73</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>International Organization for Standardization</collab>. <source>International Standard ISO/IEC 14882:2011—Information Technology—Programming Languages—C++</source>. <edition>3rd ed</edition>. <publisher-loc>Geneva</publisher-loc>: <publisher-name>ISO/IEC</publisher-name>; <year>2011</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://webstore.iec.ch/publication/21240" xlink:type="simple">https://webstore.iec.ch/publication/21240</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref074">
<label>74</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Meyers</surname> <given-names>S</given-names></name>. <source>Overview of the new C++ (C++11/14)</source>. <edition>1st ed</edition>. <publisher-loc>Walnut Creek</publisher-loc>: <publisher-name>Aritm</publisher-name> <year>2015</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref075">
<label>75</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Press</surname> <given-names>WH</given-names></name>, <name name-style="western"><surname>Teukolsky</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Vetterling</surname> <given-names>WT</given-names></name>, <name name-style="western"><surname>Flannery</surname> <given-names>BP</given-names></name>. <source>Numerical Recipes in C: The Art of Scientific Computing</source>. <edition>2nd ed</edition>. <publisher-loc>New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>1992</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanz-Leon</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Multistability in the corticothalamic system</article-title>. <source>J Theor Biol</source>. <year>2017</year>; <volume>432</volume>:<fpage>141</fpage>–<lpage>156</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2017.07.015" xlink:type="simple">10.1016/j.jtbi.2017.07.015</ext-link></comment> <object-id pub-id-type="pmid">28830686</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Connor</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Spatially uniform and nonuniform analyses of electroencephalographic dynamics, with application to the topography of the alpha rhythm</article-title>. <source>Phys Rev E</source>. <year>2004</year>;<volume>70</volume>:<fpage>110</fpage>–<lpage>119</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Connor</surname> <given-names>SC</given-names></name> and <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Unifying and interpreting the spectral wavenumber content of EEGs, ECoGs, and ERPs</article-title>. <source>J Theor Biol</source>. <year>2004</year>;<volume>231</volume>:<fpage>386</fpage>–<lpage>412</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>List</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ebert</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Albrecht</surname> <given-names>F</given-names></name>. <article-title>Ten Simple Rules for Developing Usable Software in Computational Biology</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005265" xlink:type="simple">10.1371/journal.pcbi.1005265</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Courant</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Friedrichs</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lewy</surname> <given-names>H</given-names></name>. <article-title>On the Partial Difference Equations of Mathematical Physics</article-title>. <source>IBM J Res Dev</source>. <year>1967</year>;<volume>11</volume>(<issue>2</issue>):<fpage>215</fpage>–<lpage>234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1147/rd.112.0215" xlink:type="simple">10.1147/rd.112.0215</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref081">
<label>81</label>
<mixed-citation publication-type="other" xlink:type="simple">Rennie C. Modeling the large-scale electrical activity of the brain. Ph.D. Thesis. The University of Sydney. 2001. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.brain-dynamics.net/~chris_rennie/thesis/thesis.pdf" xlink:type="simple">http://www.brain-dynamics.net/~chris_rennie/thesis/thesis.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref082">
<label>82</label>
<mixed-citation publication-type="other" xlink:type="simple">Hamilton B, Bilbao S. On finite difference schemes for the 3D wave equation using non-cartesian grids. In: Proceedings of Stockholm Musical Acoustics Conference/Sound and Music Computing Conference; 2013. pp.592–599.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref083">
<label>83</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Drysdale</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Aquino</surname> <given-names>KM</given-names></name>. <article-title>Spatiotemporal BOLD dynamics from a poroelastic hemodynamic model</article-title>. <source>J Theor Biol</source>. <year>2010</year>;<volume>265</volume>:<fpage>524</fpage>–<lpage>534</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2010.05.026" xlink:type="simple">10.1016/j.jtbi.2010.05.026</ext-link></comment> <object-id pub-id-type="pmid">20665966</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref084">
<label>84</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aquino</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Schira</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Drysdale</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>. <article-title>Hemodynamic traveling waves in human visual cortex</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e1002435</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002435" xlink:type="simple">10.1371/journal.pcbi.1002435</ext-link></comment> <object-id pub-id-type="pmid">22457612</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref085">
<label>85</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kerr</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Physiology-based modeling of cortical auditory evoked potentials</article-title>. <source>Biol Cybern</source>. <year>2008</year>;<volume>98</volume>(<issue>2</issue>):<fpage>171</fpage>–<lpage>184</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00422-007-0201-1" xlink:type="simple">10.1007/s00422-007-0201-1</ext-link></comment> <object-id pub-id-type="pmid">18057953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref086">
<label>86</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Mechanisms of cortical electrical activity and emergence of gamma rhythm</article-title>. <source>J Theor Biol</source>. <year>2000</year>;<volume>205</volume>:<fpage>17</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jtbi.2000.2040" xlink:type="simple">10.1006/jtbi.2000.2040</ext-link></comment> <object-id pub-id-type="pmid">10860697</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref087">
<label>87</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>JJ</given-names></name>. <article-title>Effects of local feedback on dispersion of electrical waves in the cerebral cortex</article-title>. <source>Phys Rev E</source>. <year>1999</year>;<volume>59</volume>:<fpage>3320</fpage>–<lpage>3329</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.59.3320" xlink:type="simple">10.1103/PhysRevE.59.3320</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref088">
<label>88</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Clearwater</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Rennie</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Mean field model of acetylcholine mediated dynamics in the thalamocortical system</article-title>. <source>J Theor Biol</source>. <year>2008</year>;<volume>255</volume>:<fpage>287</fpage>–<lpage>298</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2008.08.010" xlink:type="simple">10.1016/j.jtbi.2008.08.010</ext-link></comment> <object-id pub-id-type="pmid">18775441</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref089">
<label>89</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Srinivasan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Nunez</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Silberstein</surname> <given-names>RB</given-names></name>. <article-title>Spatial Filtering and Neocortical Dynamics: Estimates of EEG coherence</article-title>. <source>IEEE Trans Biomed Eng</source>. <year>1998</year>;<volume>45</volume>(<issue>7</issue>):<fpage>814</fpage>–<lpage>826</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/10.686789" xlink:type="simple">10.1109/10.686789</ext-link></comment> <object-id pub-id-type="pmid">9644890</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref090">
<label>90</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ogawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>TM</given-names></name>. <article-title>Magnetic resonance imaging of blood vessels at high fields: in vivo and in vitro measurements and image simulation</article-title>. <source>Magn Reson Med</source>. <year>1990</year>;<volume>16</volume>(<issue>1</issue>):<fpage>9</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/mrm.1910160103" xlink:type="simple">10.1002/mrm.1910160103</ext-link></comment> <object-id pub-id-type="pmid">2255240</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref091">
<label>91</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grinvald</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hildesheim</surname> <given-names>R</given-names></name>. <article-title>VSDI: A new era in functional imaging of cortical dynamics</article-title>. <source>Nat Rev Neurosci</source>. <year>2004</year>;<volume>5</volume>(<issue>11</issue>):<fpage>874</fpage>–<lpage>875</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn1536" xlink:type="simple">10.1038/nrn1536</ext-link></comment> <object-id pub-id-type="pmid">15496865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref092">
<label>92</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chemla</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chavane</surname> <given-names>F</given-names></name>. <article-title>A biophysical cortical column model to study the multi-component origin of the VSDI signal</article-title>. <source>NeuroImage</source>. <year>2010</year>;<volume>53</volume>(<issue>2</issue>):<fpage>420</fpage>–<lpage>438</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2010.06.026" xlink:type="simple">10.1016/j.neuroimage.2010.06.026</ext-link></comment> <object-id pub-id-type="pmid">20600993</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref093">
<label>93</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Erhardt</surname> <given-names>EB</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Yonghua</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eichele</surname> <given-names>T</given-names></name>. <article-title>StimTB, a simulation toolbox for fMRI data under a model of spatiotemporal separability</article-title>. <source>NeuroImage</source>. <year>2010</year>;<volume>59</volume>(<issue>4</issue>):<fpage>4160</fpage>–<lpage>4167</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2011.11.088" xlink:type="simple">10.1016/j.neuroimage.2011.11.088</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref094">
<label>94</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rankin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chavane</surname> <given-names>F</given-names></name>. <article-title>Neural field model to reconcile structure with function in primary visual cortex</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005821" xlink:type="simple">10.1371/journal.pcbi.1005821</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref095">
<label>95</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Mechelli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Price</surname> <given-names>CJ</given-names></name>. <article-title>Nonlinear responses in fMRI: The Balloon model, Volterra kernels, and other hemodynamics</article-title>. <source>NeuroImage</source>. <year>2000</year>;<volume>12</volume>(<issue>4</issue>):<fpage>466</fpage>–<lpage>477</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/nimg.2000.0630" xlink:type="simple">10.1006/nimg.2000.0630</ext-link></comment> <object-id pub-id-type="pmid">10988040</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref096">
<label>96</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bhalla</surname> <given-names>US</given-names></name>, <name name-style="western"><surname>Bilitch</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Bower</surname> <given-names>JM</given-names></name>. <article-title>Rallpacks: A set of benchmarks for neuronal simulators</article-title>. In: <source>Computation and Neural Systems</source>; <year>1993</year>. pp. <fpage>133</fpage>–<lpage>140</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/978-1-4615-3254-5_21" xlink:type="simple">10.1007/978-1-4615-3254-5_21</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref097">
<label>97</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gewaltig</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Cannon</surname> <given-names>R</given-names></name>. <article-title>Current practice in software development for computational neuroscience and how to improve it</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>1</issue>):<fpage>e1003376</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003376" xlink:type="simple">10.1371/journal.pcbi.1003376</ext-link></comment> <object-id pub-id-type="pmid">24465191</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref098">
<label>98</label>
<mixed-citation publication-type="other" xlink:type="simple">van Heesch, Dimitri. Doxygen Qt-interest Archive. 1997. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.stack.nl/~dimitri/doxygen/" xlink:type="simple">http://www.stack.nl/~dimitri/doxygen/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref099">
<label>99</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Braitenberg</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Schüz</surname> <given-names>A</given-names></name>. In:. <source>Springer, Berlin, Heidelberg Cortex: Statistics and Geometry of Neuronal Connectivity</source>. <publisher-loc>Berlin</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006387.ref100">
<label>100</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roy</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sanz-Leon</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>. <article-title>Spectral signatures of local neural feedback in the corticothalamic system</article-title>. <source>Phys Rev E</source>. <year>2017</year> <month>Oct</month> <day>26</day>:Forthcoming. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.96.052310" xlink:type="simple">10.1103/PhysRevE.96.052310</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref101">
<label>101</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kilpatrick</surname> <given-names>ZP</given-names></name>, <name name-style="western"><surname>Ermentrout</surname> <given-names>B</given-names></name>. <article-title>Wandering bumps in stochastic neural fields</article-title>. <source>SIAM J Appl Dyn Syst</source>. <year>2013</year>;<volume>12</volume>:<fpage>61</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/120877106" xlink:type="simple">10.1137/120877106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref102">
<label>102</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Faugeras</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Inglis</surname> <given-names>J</given-names></name>. <article-title>Stochastic neural field equations: a rigorous footing</article-title>. <source>J Math Biol</source>. <year>2015</year>;<volume>71</volume>:<fpage>259</fpage>–<lpage>300</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00285-014-0807-6" xlink:type="simple">10.1007/s00285-014-0807-6</ext-link></comment> <object-id pub-id-type="pmid">25069787</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref103">
<label>103</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thul</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Coombes</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Laing</surname> <given-names>CR</given-names></name>. <article-title>Neural Field Models with Threshold Noise</article-title> <source>J Math Neurosci</source>. <year>2016</year>;<volume>6</volume>(<issue>1</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13408-016-0035-z" xlink:type="simple">10.1186/s13408-016-0035-z</ext-link></comment> <object-id pub-id-type="pmid">26936267</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006387.ref104">
<label>104</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bressloff</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Webber</surname> <given-names>MA</given-names></name>. <article-title>Front propagation in stochastic neural fields</article-title>. <source>SIAM J Appl Dyn Syst</source>. <year>2012</year>;<volume>11</volume>(<issue>2</issue>):<fpage>708</fpage>–<lpage>740</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/110851031" xlink:type="simple">10.1137/110851031</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>