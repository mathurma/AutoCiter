<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004473</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00706</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Rich RNA Structure Landscapes Revealed by Mutate-and-Map Analysis</article-title>
<alt-title alt-title-type="running-head">Rich RNA Structure Landscapes Probed by Systematic Mutagenesis</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Cordero</surname>
<given-names>Pablo</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Das</surname>
<given-names>Rhiju</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Biomedical Informatics Program, Stanford University, Stanford, California, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Biochemistry Department, Stanford University, Stanford, California, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Physics Department, Stanford University, Stanford, California, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Chen</surname>
<given-names>Shi-Jie</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Missouri, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: PC RD. Performed the experiments: PC. Analyzed the data: PC. Contributed reagents/materials/analysis tools: PC. Wrote the paper: RD PC.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">rhiju@stanford.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>13</day>
<month>11</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>11</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>11</issue>
<elocation-id>e1004473</elocation-id>
<history>
<date date-type="received">
<day>2</day>
<month>5</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>20</day>
<month>7</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Cordero, Das</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004473" xlink:type="simple"/>
<abstract>
<p>Landscapes exhibiting multiple secondary structures arise in natural RNA molecules that modulate gene expression, protein synthesis, and viral. We report herein that high-throughput chemical experiments can isolate an RNA’s multiple alternative secondary structures as they are stabilized by systematic mutagenesis (mutate-and-map, M<sup>2</sup>) and that a computational algorithm, REEFFIT, enables unbiased reconstruction of these states’ structures and populations. In an <italic>in silico</italic> benchmark on non-coding RNAs with complex landscapes, M<sup>2</sup>-REEFFIT recovers 95% of RNA helices present with at least 25% population while maintaining a low false discovery rate (10%) and conservative error estimates. In experimental benchmarks, M<sup>2</sup>-REEFFIT recovers the structure landscapes of a 35-nt MedLoop hairpin, a 110-nt 16S rRNA four-way junction with an excited state, a 25-nt bistable hairpin, and a 112-nt three-state adenine riboswitch with its expression platform, molecules whose characterization previously required expert mutational analysis and specialized NMR or chemical mapping experiments. With this validation, M<sup>2</sup>-REEFFIT enabled tests of whether artificial RNA sequences might exhibit complex landscapes in the absence of explicit design. An artificial flavin mononucleotide riboswitch and a randomly generated RNA sequence are found to interconvert between three or more states, including structures for which there was no design, but that could be stabilized through mutations. These results highlight the likely pervasiveness of rich landscapes with multiple secondary structures in both natural and artificial RNAs and demonstrate an automated chemical/computational route for their empirical characterization.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>RNA is a versatile macromolecule that underlies core natural processes throughout living systems and new strategies to re-engineer these systems. In several cases, this versatility is due to the ability of an RNA molecule to adopt multiple conformations: the full description of the molecule involves a ‘landscape’ of alternative structures that are present at equilibrium and whose interconversions are critical for function. However, there is little work on empirically probing these landscapes due to size, resolution, and infrastructure constraints of available experimental methods. We show herein that RNA landscapes can be characterized rapidly through the mutate-and-map (M<sup>2</sup>) methodology when coupled with a novel blind-source separation method, REEFFIT. We present extensive computational and experimental benchmarks supporting the use of M<sup>2</sup>-REEFFIT to detect alternative RNA secondary structures accurately without ‘over-predicting’ them. We then experimentally address a basic question in RNA biophysics—do landscapes involving multiple secondary structures require explicit selection or can they arise in artificial RNA sequences without selection? For both an artificial flavin mononucleotide riboswitch and a randomly generated sequence, M<sup>2</sup>-REEFFIT and further mutation tests find evidence for alternative, unexpected states, suggesting that rich landscapes are common and will become better appreciated with use of the developed technology.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by the Stanford Bio-X Interdisciplinary Initiative Program, Stanford Media-X, a CONACyT graduate student fellowship (to PC), a Burroughs-Wellcome Foundation Career Award (to RD), the Keck Medical Research Foundation, and National Institutes of Health Grant R01 R01GM100953. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="24"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>M2 capillary electrophoresis data for the Bistable, add riboswitch, M-stable, and Tebowned RNAs have been deposited in the RMDB (<ext-link ext-link-type="uri" xlink:href="http://rmdb.stanford.edu" xlink:type="simple">http://rmdb.stanford.edu</ext-link>; RMDB IDs BSTHPN_1M7_0000.rdat, ADDSCHW_1M7_0000, ADDSCHW_1M7_0001, MSTBL_1M7_0000, TBWND_1M7_0000, and TBWND_1M7_0001). M2-seq data for the MedLoop are part of the EteRNA cloud lab, rounds 72 (RMDB ID ETERNA_R72_0000, project name "MedLoop"). RDAT files for the simulated datasets can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://purl.stanford.edu/zr287dq2666" xlink:type="simple">http://purl.stanford.edu/zr287dq2666</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>RNAs are deeply involved in gene expression, gene regulation, and structural scaffolding and are forming the basis of novel approaches to control these processes [<xref rid="pcbi.1004473.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1004473.ref003" ref-type="bibr">3</xref>]. Several of RNA’s natural and engineered roles rely on its ability to fold into and interconvert between multiple functional structures. Ribozymes, riboswitches, and protein-complexed RNAs transition between several states to detect and respond to small molecules and other macromolecules; to proceed through numerous steps of RNA splicing reactions; to initiate, catalyze, and proof-read protein translation; to activate logical circuits in cells; and to package, release, and replicate RNA viruses [<xref rid="pcbi.1004473.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1004473.ref009" ref-type="bibr">9</xref>]. The number of structures and equilibrium fractions that constitute these ‘dynamic structure landscapes’ are linked to the biological function of the RNA (<xref rid="pcbi.1004473.g001" ref-type="fig">Fig 1a</xref>). Rationally dissecting and re-engineering these landscapes depends on knowledge of the alternative states of an RNA’s structural ensemble [<xref rid="pcbi.1004473.ref010" ref-type="bibr">10</xref>,<xref rid="pcbi.1004473.ref011" ref-type="bibr">11</xref>].</p>
<fig id="pcbi.1004473.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004473.g001</object-id>
<label>Fig 1</label>
<caption>
<p>(a) RNA molecules can have diverse structural landscapes that are linked to their biological functions. Some structural landscapes, such as those for stable ribosome domains, can have a single, stable structure that is critical for function. Others may have been selected to have an equilibrium of two or three structures, such as riboswitches, that enables them to fine tune their response to small molecules or macromolecular partners. There may be other RNAs with a heterogeneous landscape, such as random RNA sequences, that may require this heterogeneity for function. (b) Chemical mapping (footprinting) experiments for probing RNA structure can be conceptualized as linear combinations of the underlying structures in the RNA’s structural ensemble. The chemical mapping profiles of an ensemble of two structures, represented here as one-dimensional heat maps, are scaled by their respective Boltzmann weights, <italic>W<sub>1</sub></italic> and <italic>W<sub>2</sub></italic>, and added together with experimental noise to form the observed chemical mapping pro?le of an RNA. (c) Mutate-and-map (M<sup>2</sup>) experiments are measurements of perturbed versions of an underlying structural landscape. A novel method, REEFFIT uses a blind source separation framework to automatically reconstruct this landscape by joint estimation of hidden reactivity profiles and fractions for a set of structures.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.g001" position="float" xlink:type="simple"/>
</fig>
<p>Empirical portraits of such landscapes are missing for the vast majority of natural and engineered RNAs and it is unclear whether a rich multi-state landscape is a property specially selected by evolution or an intrinsic feature of RNA that can arise without explicit design or selection. Watson-Crick RNA secondary structure landscapes have been computationally predicted using dynamic programming techniques for decades [<xref rid="pcbi.1004473.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1004473.ref013" ref-type="bibr">13</xref>] and many RNAs are predicted to form multiple structures at equilibrium, with ‘non-native’ helices reaching populations of 25% or greater [<xref rid="pcbi.1004473.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1004473.ref014" ref-type="bibr">14</xref>]. In some cases, the alternative structures—and not the dominant structure—harbor motifs that are recognized by protein or small molecule partners [<xref rid="pcbi.1004473.ref015" ref-type="bibr">15</xref>–<xref rid="pcbi.1004473.ref017" ref-type="bibr">17</xref>]. However, difficulties in treating non-canonical interactions render these predictions inaccurate. Indeed, some studies have suggested that conformational switches are special hallmarks of biological function rather than an intrinsic feature of generic RNA sequences [<xref rid="pcbi.1004473.ref018" ref-type="bibr">18</xref>–<xref rid="pcbi.1004473.ref021" ref-type="bibr">21</xref>].</p> 
<p>Unfortunately, the few experimental techniques that can validate or refute multi-state models are costly and difficult. For example, single molecule methods have been successful at revealing rarely populated RNA states but have not provided enough information to infer their structures [<xref rid="pcbi.1004473.ref022" ref-type="bibr">22</xref>]. Powerful insights have come from advances in nuclear magnetic resonance (NMR) spectroscopy [<xref rid="pcbi.1004473.ref023" ref-type="bibr">23</xref>] but require focused technical expertise, expensive infrastructure, and RNA targets with limited structural heterogeneity. In contrast, RNA chemical mapping, or footprinting, is a simple class of techniques that can achieve single-nucleotide resolution structural data for any RNA [<xref rid="pcbi.1004473.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1004473.ref025" ref-type="bibr">25</xref>]. For RNAs with multiple states, however, these chemical mapping data give ensemble averages over all states, leading to a dramatic loss of information compared to what would be needed to resolve the RNA’s dynamic structure landscape and to make testable predictions (<xref rid="pcbi.1004473.g001" ref-type="fig">Fig 1b</xref>, see also refs. [<xref rid="pcbi.1004473.ref020" ref-type="bibr">20</xref>,<xref rid="pcbi.1004473.ref026" ref-type="bibr">26</xref>]).</p>
<p>While developing experiments that couple systematic mutagenesis with chemical mapping (mutate-and-map, or M<sup>2</sup>), we observed that single mutations can produce dramatic changes in chemical mapping data throughout an RNA sequence, with several mutations often giving the same alternative pattern [<xref rid="pcbi.1004473.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1004473.ref028" ref-type="bibr">28</xref>]. We hypothesized that these perturbed patterns correspond to the reweighting of the structural ensemble of the RNA so that alternative component states dominate the chemical mapping data (<xref rid="pcbi.1004473.g001" ref-type="fig">Fig 1c</xref>). We have recently shown that such alternative structures can be inferred after expert inspection of M<sup>2</sup> measurements and extensive compensatory rescue studies in an <italic>E</italic>. <italic>coli</italic> 16S ribosomal RNA domain [<xref rid="pcbi.1004473.ref029" ref-type="bibr">29</xref>]. Reasoning that such landscape dissection might be fully automated through the use of blind source separation algorithms, we have now developed an analysis framework called the RNA Ensemble Extraction From Footprinting Insights Technique (REEFFIT; see <xref rid="pcbi.1004473.g001" ref-type="fig">Fig 1c</xref>).</p>
<p>Here, we sought to use M<sup>2</sup>-REEFFIT to determine whether complex landscapes could arise in artificial RNAs without explicit natural selection or design. Prior techniques for detecting alternative structures, including covariation-based methods [<xref rid="pcbi.1004473.ref019" ref-type="bibr">19</xref>] and the recent RING-MaP method [<xref rid="pcbi.1004473.ref020" ref-type="bibr">20</xref>], have not been benchmarked in cases with well-characterized landscapes and may be biased towards or against alternative structures. Therefore, we developed three tests for M<sup>2</sup>-REEFFIT landscape dissection. First, a benchmark on simulated M<sup>2</sup> data for 20 natural non-coding RNA sequences provided ‘gold standard’ reference results allowing unambiguous assessment of accuracy. Second, we applied M<sup>2</sup>-REEFFIT to four experimental test cases involving biological and artificial RNAs that had been previously characterized in detail by NMR or chemical mapping. For these cases, M<sup>2</sup>-REEFFIT recovered the landscapes defined through prior expert analysis. Third, we developed a validation approach based on stabilizing and experimentally testing predicted structures by multiple mutations. With these benchmarks and methodological developments, we used M<sup>2</sup>-REEFFIT to demonstrate that an imperfectly designed riboswitch and a randomly generated RNA sequence each form at least three structures, including states that could not be predicted from computational modeling alone.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Dissecting landscapes <italic>de novo</italic> with M<sup>2</sup>-REEFFIT</title>
<p>To leverage the signals of stabilized alternative structures present in M<sup>2</sup> measurements, we developed a new analysis framework, REEFFIT, to simultaneously infer multiple structures and their population fractions across the mutant RNAs (see <xref rid="sec008" ref-type="sec">Methods</xref>). We first applied M<sup>2</sup>-REEFFIT to infer structure landscapes for an <italic>in silico</italic> benchmark of 20 sequences drawn from the Rfam database of non-coding RNA molecules. We simulated M<sup>2</sup> data by randomly choosing up to 200 suboptimal structures in the ensembles of the wild type sequence and of all variants that mutate a single nucleotide to its complement, as are typically probed in M<sup>2</sup> experiments. We then simulated these structures’ respective SHAPE reactivity profiles using known reactivity distributions. To mimic inaccuracies in available energetic models, we re-weighted the ensemble randomly by introducing Gaussian noise (mean of 0 kcal/mol and standard deviation of 1 kcal/mol) to the predicted free energies. The resulting landscapes ranged from single dominant structures (e.g. cases RF00027 and RF00301) to more complex scenarios with two or three states (e.g. cases RF01300 and RF00051) to multi-state RNAs with more than three states present at non-negligible fractions (e.g. cases RF01274 and RF01125; Fig A in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> gives five examples examined in detail in the Supporting Results, Fig B in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> gives results for the entire benchmark, and the figures in <xref rid="pcbi.1004473.s002" ref-type="supplementary-material">S2 Text</xref> contains detailed Figs for all benchmark cases).</p>
<p>Over the entire 20-RNA benchmark, REEFFIT was able to consistently detect the presence of dominant and alternative helices (Supporting Results and Figs A-D in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). We set a criterion for helix detection that the fitted population should be larger than the population error estimated from bootstrapping, i.e. the signal-to-noise ratio should be greater than one. With this criterion, REEFFIT achieved 94.6% sensitivity over helices present with at least 3 base pairs and at least 25% population, corresponding to a false negative rate (FNR) of 5.4%. The false discovery rate (FDR) was low as well, at 9.7% (see <xref rid="pcbi.1004473.t001" ref-type="table">Table 1</xref> and Table A in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>; full precision-recall curves given in Fig B in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). Without data, the error rates were substantially worse, by three-fold and two-fold, respectively (FNR of 18.0% and FDR of 23.3%). Values for base-pair-level error rates were similar to helix-level error rates (Table B in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). Error rates for wild type sequences alone (i.e., excluding single-nucleotide mutants) were higher but also showed a strong improvement in REEFFIT ensembles compared to ensembles modeled with no data (FNR of 15.2%, FDR of 15.2% for REEFFIT; FNR of 24.5% and FDR of 25.4% without data, see Table C in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). Use of only wild type data and no mutants, as would be carried out in conventional chemical mapping measurements, gave high error rates similar to landscapes modeled without data (FNR of 22.7% and FDR of 25%, see Table D in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> and an example in Supporting Results and Fig D in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>), confirming the necessity of M<sup>2</sup> data for accurate landscape dissection. Further systematic checks and use of ViennaRNA [<xref rid="pcbi.1004473.ref030" ref-type="bibr">30</xref>] initial models and benchmark evaluation using helix-wise RMSD are given in the Supporting Results in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> and Tables E, F, and G in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>.</p>
<table-wrap id="pcbi.1004473.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004473.t001</object-id>
<label>Table 1</label> <caption><title>Performance results for M<sup>2</sup>-REEFFIT landscape dissection on a 20 RNA benchmark from the RFAM database.</title></caption>
<alternatives>
<graphic id="pcbi.1004473.t001g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.t001" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"/>
<th align="left" rowspan="1" colspan="1"/>
<th colspan="2" align="left" rowspan="1">No data<xref rid="t001fn001" ref-type="table-fn"><sup>a</sup></xref></th>
<th colspan="2" align="left" rowspan="1">M<sup>2</sup>-REEFFIT<xref rid="t001fn001" ref-type="table-fn"><sup>a</sup></xref></th>
</tr>
<tr>
<th align="left" rowspan="1" colspan="1">Rfam ID</th>
<th align="left" rowspan="1" colspan="1">No. Helices<xref rid="t001fn001" ref-type="table-fn"><sup>a</sup></xref></th>
<th align="left" rowspan="1" colspan="1">TP</th>
<th align="left" rowspan="1" colspan="1">FP</th>
<th align="left" rowspan="1" colspan="1">TP</th>
<th align="left" rowspan="1" colspan="1">FP</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">RF00031 SECIS</td>
<td align="left" rowspan="1" colspan="1">3.02</td>
<td align="left" rowspan="1" colspan="1">2.48</td>
<td align="char" char="." rowspan="1" colspan="1">1.47</td>
<td align="char" char="." rowspan="1" colspan="1">2.88</td>
<td align="char" char="." rowspan="1" colspan="1">0.09</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00051 mir-17</td>
<td align="left" rowspan="1" colspan="1">5.35</td>
<td align="left" rowspan="1" colspan="1">4.98</td>
<td align="char" char="." rowspan="1" colspan="1">0.18</td>
<td align="char" char="." rowspan="1" colspan="1">5.31</td>
<td align="char" char="." rowspan="1" colspan="1">0.42</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00014 DsrA</td>
<td align="left" rowspan="1" colspan="1">4.44</td>
<td align="left" rowspan="1" colspan="1">3.88</td>
<td align="char" char="." rowspan="1" colspan="1">0.56</td>
<td align="char" char="." rowspan="1" colspan="1">4.32</td>
<td align="char" char="." rowspan="1" colspan="1">0.93</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF01092 GP_knot2</td>
<td align="left" rowspan="1" colspan="1">3.40</td>
<td align="left" rowspan="1" colspan="1">2.60</td>
<td align="char" char="." rowspan="1" colspan="1">1.47</td>
<td align="char" char="." rowspan="1" colspan="1">3.26</td>
<td align="char" char="." rowspan="1" colspan="1">0.56</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00066 U7</td>
<td align="left" rowspan="1" colspan="1">3.31</td>
<td align="left" rowspan="1" colspan="1">1.77</td>
<td align="char" char="." rowspan="1" colspan="1">2.31</td>
<td align="char" char="." rowspan="1" colspan="1">2.71</td>
<td align="char" char="." rowspan="1" colspan="1">1.26</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF01300 snoU49</td>
<td align="left" rowspan="1" colspan="1">3.56</td>
<td align="left" rowspan="1" colspan="1">2.88</td>
<td align="char" char="." rowspan="1" colspan="1">1.46</td>
<td align="char" char="." rowspan="1" colspan="1">3.49</td>
<td align="char" char="." rowspan="1" colspan="1">0.76</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF01139 sR2</td>
<td align="left" rowspan="1" colspan="1">2.61</td>
<td align="left" rowspan="1" colspan="1">2.29</td>
<td align="char" char="." rowspan="1" colspan="1">2.34</td>
<td align="char" char="." rowspan="1" colspan="1">2.50</td>
<td align="char" char="." rowspan="1" colspan="1">1.34</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF01274 sR45</td>
<td align="left" rowspan="1" colspan="1">2.34</td>
<td align="left" rowspan="1" colspan="1">1.96</td>
<td align="char" char="." rowspan="1" colspan="1">1.02</td>
<td align="char" char="." rowspan="1" colspan="1">2.13</td>
<td align="char" char="." rowspan="1" colspan="1">0.82</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF01297 sR40</td>
<td align="left" rowspan="1" colspan="1">3.42</td>
<td align="left" rowspan="1" colspan="1">2.26</td>
<td align="char" char="." rowspan="1" colspan="1">2.95</td>
<td align="char" char="." rowspan="1" colspan="1">3.29</td>
<td align="char" char="." rowspan="1" colspan="1">2.21</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00555 L13_leader</td>
<td align="left" rowspan="1" colspan="1">2.96</td>
<td align="left" rowspan="1" colspan="1">2.91</td>
<td align="char" char="." rowspan="1" colspan="1">0.51</td>
<td align="char" char="." rowspan="1" colspan="1">2.93</td>
<td align="char" char="." rowspan="1" colspan="1">0.28</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00775 mir-432</td>
<td align="left" rowspan="1" colspan="1">4.98</td>
<td align="left" rowspan="1" colspan="1">4.35</td>
<td align="char" char="." rowspan="1" colspan="1">1.35</td>
<td align="char" char="." rowspan="1" colspan="1">4.78</td>
<td align="char" char="." rowspan="1" colspan="1">1.78</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00173 Hairpin</td>
<td align="left" rowspan="1" colspan="1">2.64</td>
<td align="left" rowspan="1" colspan="1">2.28</td>
<td align="char" char="." rowspan="1" colspan="1">0.96</td>
<td align="char" char="." rowspan="1" colspan="1">2.47</td>
<td align="char" char="." rowspan="1" colspan="1">0.79</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00108 SNORD116</td>
<td align="left" rowspan="1" colspan="1">2.03</td>
<td align="left" rowspan="1" colspan="1">1.32</td>
<td align="char" char="." rowspan="1" colspan="1">1.95</td>
<td align="char" char="." rowspan="1" colspan="1">1.86</td>
<td align="char" char="." rowspan="1" colspan="1">1.51</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00570 SNORD64</td>
<td align="left" rowspan="1" colspan="1">3.69</td>
<td align="left" rowspan="1" colspan="1">2.80</td>
<td align="char" char="." rowspan="1" colspan="1">0.66</td>
<td align="char" char="." rowspan="1" colspan="1">3.39</td>
<td align="char" char="." rowspan="1" colspan="1">0.59</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF01301 snoR4a</td>
<td align="left" rowspan="1" colspan="1">2.67</td>
<td align="left" rowspan="1" colspan="1">2.20</td>
<td align="char" char="." rowspan="1" colspan="1">2.35</td>
<td align="char" char="." rowspan="1" colspan="1">2.56</td>
<td align="char" char="." rowspan="1" colspan="1">1.28</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF01125 sR4</td>
<td align="left" rowspan="1" colspan="1">2.63</td>
<td align="left" rowspan="1" colspan="1">2.05</td>
<td align="char" char="." rowspan="1" colspan="1">0.36</td>
<td align="char" char="." rowspan="1" colspan="1">2.47</td>
<td align="char" char="." rowspan="1" colspan="1">0.20</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00436 UnaL2</td>
<td align="left" rowspan="1" colspan="1">1.79</td>
<td align="left" rowspan="1" colspan="1">1.79</td>
<td align="char" char="." rowspan="1" colspan="1">0.21</td>
<td align="char" char="." rowspan="1" colspan="1">1.79</td>
<td align="char" char="." rowspan="1" colspan="1">0.18</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF01151 snoU82P</td>
<td align="left" rowspan="1" colspan="1">1.90</td>
<td align="left" rowspan="1" colspan="1">1.24</td>
<td align="char" char="." rowspan="1" colspan="1">1.30</td>
<td align="char" char="." rowspan="1" colspan="1">1.76</td>
<td align="char" char="." rowspan="1" colspan="1">1.06</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00027 let-7</td>
<td align="left" rowspan="1" colspan="1">3.45</td>
<td align="left" rowspan="1" colspan="1">3.27</td>
<td align="char" char="." rowspan="1" colspan="1">1.69</td>
<td align="char" char="." rowspan="1" colspan="1">3.30</td>
<td align="char" char="." rowspan="1" colspan="1">1.88</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RF00042 CopA</td>
<td align="left" rowspan="1" colspan="1">6.22</td>
<td align="left" rowspan="1" colspan="1">5.93</td>
<td align="char" char="." rowspan="1" colspan="1">0.32</td>
<td align="char" char="." rowspan="1" colspan="1">6.19</td>
<td align="char" char="." rowspan="1" colspan="1">0.30</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FDR</td>
<td align="left" rowspan="1" colspan="1">23.3%</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="char" char="." rowspan="1" colspan="1">9.7%</td>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">FNR</td>
<td align="left" rowspan="1" colspan="1">18%</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="char" char="." rowspan="1" colspan="1">5.4%</td>
<td align="left" rowspan="1" colspan="1"/>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p><sup>a</sup>Values are averaged across all variants probed (wild type RNA and single mutants).</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec004">
<title>Experimental tests on RNAs previously characterized by M<sup>2</sup> and expert analysis</title>
<p>Success in the above <italic>in silico</italic> benchmark suggested that REEFFIT would accurately recover prior analyses of experimental M<sup>2</sup> data sets, such as the MedLoop RNA (<xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2a–2d</xref>). This RNA was previously designed to exhibit a single, stable 10 base pair helix with a 15 nucleotide loop (MLP-A, <xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2d</xref>) [<xref rid="pcbi.1004473.ref027" ref-type="bibr">27</xref>]. A few mutations were observed to give a clearly distinct chemical mapping pattern and predicted computationally to fold into an alternative structure (MLP-B in <xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2a</xref>; see e.g. G4C in M<sup>2</sup> data) but not expected to be strongly populated in the wild type sequence. Automated REEFFIT modeling of the MedLoop M<sup>2</sup> data recovered both the dominant structure MLP-A and the alternative state MLP-B, and bootstrapped uncertainties gave bounds on the frequency of MLP-B in the wild-type sequence (4±4%, see mutant-wise state fractions in Fig Fa-Fc in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). Thus, REEFFIT was able to explain rearrangements of mutants into an alternative state, but at the same time did not over-predict its presence in the wild-type sequence (<xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2c</xref>).</p>
<fig id="pcbi.1004473.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004473.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Landscape dissection of four diverse RNA systems from experimental mutate-and-map (M<sup>2</sup>) data.</title>
<p>(a) M<sup>2</sup> measurements for the MedLoop artificial sequence (given to REEFFIT as input); (b) REEFFIT bootstrapped fits; (c) base pair probability matrices of the structures in the wild type landscape (upper triangle: base pair probability values using no data, lower triangle: REEFFIT calculated base pair probabilities); and (d) structure medioids found <italic>de novo</italic> by REEFFIT. M<sup>2</sup>-REEFFIT analysis are also presented for (e-h) a four-way junction domain of the 16S rRNA, (i-l) an artificial bistable hairpin.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.g002" position="float" xlink:type="simple"/>
</fig>
<p>As a more difficult test, we applied the algorithm to the 126–235 region of the <italic>E</italic>. <italic>coli</italic> 16S ribosomal RNA. In protein-bound ribosome crystals, this domain forms a four-way junction with helices P1a-c, P2a-b, P2*, P3, and P4a-b, but its solution state has been controversial [<xref rid="pcbi.1004473.ref029" ref-type="bibr">29</xref>] (<xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2e–2h</xref>). Conventional SHAPE-guided analysis suggested loss of P2a and P4, and formation of alternative helices alt-P1d and alt-P4 [<xref rid="pcbi.1004473.ref031" ref-type="bibr">31</xref>] (<xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2h</xref>, green structure). However, M<sup>2</sup> and compensatory rescue experiments gave no evidence for the SHAPE-based model but instead recovered the dominant solution structure to be the holo-ribosome conformation, except for a register shift in P4a (called shift-P4a); the crystallographic P4 register was also detected as a 20±10% ‘excited state’ [<xref rid="pcbi.1004473.ref029" ref-type="bibr">29</xref>]. In agreement with this detailed analysis, automated REEFFIT analysis of the 126–235 RNA M<sup>2</sup> data also returned helices P1a-c, P2*, P2b, and P3 with high population fractions (&gt;80%, <xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2g</xref>). Importantly, REEFFIT recovered an admixture of P4 (21±16%) and shift-P4 (60±23%) in a 3:1 ratio, in agreement with prior analysis (<xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2g</xref>, magnification); RNAstructure calculations or use of wild type SHAPE data alone assigned negligible probability or highly uncertain population fractions to these helices, respectively (<xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2g</xref>). The population of alternative helices alt-P1d and alt-P4 were found to have low populations and high errors (see Supporting Results in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). Further, a refined REEFFIT analysis including data for compensatory rescue double mutants recovered, with conservative error estimates, prior expert analysis (see Supporting Results and Fig E in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>), illustrating the automation of modeling of even a complex RNA structure landscape.</p>
</sec>
<sec id="sec005">
<title>Experimental tests on RNAs with NMR-characterized landscapes</title>
<p>Encouraged by REEFFIT’s performance in previous test cases for chemical mapping, we sought tests involving fully independent experimental characterization by NMR. We first investigated a bistable RNA sequence whose landscape was dissected by Höbartner and colleagues by decomposing its NH…N <sup>1</sup>H NMR spectrum into a weighted sum of two states forming different hairpins (here called BST-A and BST-B) [<xref rid="pcbi.1004473.ref032" ref-type="bibr">32</xref>]. As expected, M<sup>2</sup> measurements gave clear evidence for two distinct chemical mapping profiles, reflecting the bistable nature of this RNA (<xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2i–2l</xref>). One profile, consistent with BST-A appeared in variants with mutations in the 5´ end of the sequence, such as U4A. Another profile, consistent with BST-B, was revealed by mutations in the 3´ end such as C23G, which would destabilize the BST-A hairpin (<xref rid="pcbi.1004473.g002" ref-type="fig">Fig 2i</xref>). Both structures were recovered by REEFFIT analysis, with population weights of 73 ± 11% and 26 ± 9%, for BST-A and BST-B respectively, in agreement with the previously reported fractions measured by NMR (70 ± 5% and 30 ± 5%, respectively) and correcting the erroneous weights predicted with no data (99% and &lt;1%, respectively).</p>
<p>We then challenged M<sup>2</sup>-REEFFIT with a more complex test case: a <italic>Vibrio vulnificus</italic> adenosine deaminase (<italic>add</italic>) mRNA riboswitch (<xref rid="pcbi.1004473.g003" ref-type="fig">Fig 3a–3d</xref>) that, in response to the ligand adenine, exposes start site segments (Shine-Dalgarno sequence and/or AUG start codon) to promote mRNA translation. In a detailed NMR study, spectra in ligand-free conditions fit well to a model with two states, apoA (~30%, with helices P1, P2, P3, P4, and P5) and apoB (~70%, with P1B, P2B, P3, an extended P4 called P4B, and P5). Addition of adenine ligand resulted in spectra dominated by a state holo with P1, P2, P3, and P5 and perturbed chemical shifts consistent with adenine binding to the aptamer [<xref rid="pcbi.1004473.ref017" ref-type="bibr">17</xref>]. While three states gave the simplest model for the prior data, more complex multi-state models were consistent as well and would be generally predicted from RNA secondary structure calculations [<xref rid="pcbi.1004473.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1004473.ref013" ref-type="bibr">13</xref>]. We focused on whether M<sup>2</sup>-REEFFIT could recover the base pairs of P1, P2, P1B, P2B, P3, P4, P4B, and P5, which were unambiguously determined through NOE spectroscopy and model construct comparisons. Even in the absence of adenine, our M<sup>2</sup> measurements of the RNA suggested the presence of at least two distinct structures that protect or expose the mRNA start site (AUG at nts 120–122) and, in an anticorrelated manner, expose or protect segments in the aptamer region (e.g., nts 53–60 and 66–72), respectively (M<sup>2</sup> data in <xref rid="pcbi.1004473.g003" ref-type="fig">Fig 3a</xref>). In addition to observing these different states upon mutation, addition of 5 mM adenine induced clear changes in the M<sup>2</sup> data, including protections in the aptamer and consistent exposure of the AUG start codon in most mutants (M<sup>2</sup> data in <xref rid="pcbi.1004473.g003" ref-type="fig">Fig 3a</xref>, bottom;). While consistent with this region’s unpaired status without and with ligand in prior NMR studies, our studies indicate
a more dramatic switch in this region for more complete add riboswitch constructs and will be reported elsewhere.</p>
<fig id="pcbi.1004473.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004473.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Landscape dissection of a segment of the <italic>V. Vulnificus add</italic> adenine riboswitch in 0 and 5 mM adenine.</title>
<p>(a) M<sup>2</sup> measurements in 0 and 5 mM adenine; (b) REEFFIT bootstrapped fits; (c) base pair probability matrices of the structures in the wild type landscape (upper triangles: base pair probability values using no data, lower triangles: REEFFIT calculated base pair probabilities); (d) structure mediods of the structural ensemble found by REEFFIT. In (a-b), The Shine-Dalgarno (SD) ribosome-binding sequence was observed to be SHAPE-reactive even in the absence of adenine; while consistent with this region's unpaired status without and with ligand in prior NMR studies, our studies indicate a more dramatic switch in this region for more complete <italic>add</italic> riboswitch constructs and will be reported elsewhere. See Supporting Tables H-I in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> for RNA sequences and fit summaries.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.g003" position="float" xlink:type="simple"/>
</fig>
<p>REEFFIT analysis gave excellent fits to these <italic>add</italic> riboswitch M<sup>2</sup> data (<xref rid="pcbi.1004473.g003" ref-type="fig">Fig 3b</xref>), automatically detecting the presence of P1 (14±10%), P2 (37±15%), P3 (86±18%), P4 without extension (69±10%), the extension P4B at lower population (36±6%), and P5 (94±18%) in the absence of adenine, in agreement with the apoA and apoB model from NMR (<xref rid="pcbi.1004473.g003" ref-type="fig">Fig 3c–3d</xref>); and recovering a holo state with P1, P2, P3, P4, and P5 dominating in 5 mM adenine (see Supporting Methods in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> for treatment of ligand-bound structures). In ligand-free conditions, the REEFFIT analysis also gave several alternative helices in the P1/P2 region, including P1B and P2B (20±7%), consistent with the NMR-detected features in the apoB structure. The M<sup>2</sup> data were critical in making these detections; RNAstructure calculations and use of wild type SHAPE data alone assigned negligible (&lt;5%) probability to P1, P1B, P2B, and the possibility of P4B shortening to P4 (<xref rid="pcbi.1004473.g003" ref-type="fig">Fig 3c–3d</xref>). Coarse clustering of REEFFIT structures returned four states in which the NMR-modeled apoA was recovered as the cluster medioid of one state, ADD-A, and apoB was recovered as a medioid in another, ADD-B, albeit with an additional helix, P4B (<xref rid="pcbi.1004473.g003" ref-type="fig">Fig 3c</xref>). Structures with alternative helices to P1, P2, P1B, and P2B in the 5´ region clustered into states ADD-C and ADD-D. The population fractions of these helices, as well as a set of P6 and P7 helices not detected in NMR experiments, were low; these features were appropriately flagged as uncertain from bootstrapping analysis (e.g., 21±15% for the most populated helix of this kind, P6). Overall, the M<sup>2</sup>-REEFFIT results successfully recovered NMR-detected helices for this adenine riboswitch sequence, including heterogeneous structure in the 5´ region, dynamics in the P4 region, and rearrangements on adenine addition.</p>
</sec>
<sec id="sec006">
<title>Assessing if artificial sequences exhibit complex RNA landscapes</title>
<p>After validation of M<sup>2</sup>-REEFFIT on diverse computational and experimental test cases, we used the method to estimate whether complex landscapes might arise in artificial RNA sequences without explicit design or selection. First, we analyzed the folding landscape of an imperfect RNA switch, ‘Tebowned’, that was designed to convert between two states upon flavin mononucleotide (FMN) binding (Figs <xref rid="pcbi.1004473.g004" ref-type="fig">4</xref> and <xref rid="pcbi.1004473.g005" ref-type="fig">5</xref>) in early rounds of a riboswitch design puzzle in the Eterna massive open laboratory [<xref rid="pcbi.1004473.ref033" ref-type="bibr">33</xref>]. While the chemical mapping pattern of this RNA changed upon binding FMN, the measurements for the unbound state did not match the desired unbound structure, particularly near nucleotide A30 (red arrows in <xref rid="pcbi.1004473.g004" ref-type="fig">Fig 4a</xref>); this region should have been paired but instead was measured to be reactive. <italic>A priori</italic>, we could not distinguish whether this discrepancy was due to an incorrect balance of the two target bound and unbound structures or if there were other unexpected structures involved. To elucidate the discrepancy, we acquired M<sup>2</sup> data for the Tebowned RNA. We first used REEFFIT to fit the M<sup>2</sup> data using only the two desired structures, but this fit did not capture several features, such as the exposure at A30 (Fig G in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). In contrast, a global ensemble fit adequately captured these features (<xref rid="pcbi.1004473.g004" ref-type="fig">Fig 4a–4b</xref>, and Fig Gb in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). REEFFIT automatically clustered the modeled ensemble into three states: TBWN-A (56 ±16%) and TBWN-B (27 ± 12%), matching the desired switch structures, and a third structure TBWN-C present at 17 ± 11% fraction (red arrows in <xref rid="pcbi.1004473.g004" ref-type="fig">Fig 4a</xref> and Fig Ha-Hc in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). The unexpected state TBWN-C exhibits an apical loop around nucleotide A30, explaining the observed discrepancies in this region for the wild type RNA, and harbors a purine-rich symmetric loop that may be significantly stabilized compared to the energy assumed in current nearest-neighbor models [<xref rid="pcbi.1004473.ref034" ref-type="bibr">34</xref>]. Other helices were discovered to be populated at non-negligible fractions in the analysis, but were deemed uncertain (signal-to-noise ratios less than 1) from bootstrapping analysis.</p>
<fig id="pcbi.1004473.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004473.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Landscape dissection of a designed FMN riboswitch with a structural discrepancy, the Tebowned RNA.</title>
<p>(a) M<sup>2</sup> data, (b) REEFFIT fit, and (c) inference of the Tebowned structural landscape, which is predicted by REEFFIT to fold into (d) three prevalent structures TBWN-A, TBWN-B, and TBWN-C. Presence of TBWN-C is marked with red arrows in (a) and (c).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.g004" position="float" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004473.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004473.g005</object-id>
<label>Fig 5</label>
<caption>
<p>Comparison between reactivities predicted by REEFFIT and mutants designed to stabilize the (a) TBWN-A, (b) TBWN-B, (c) TBWN-C structures are given below each state (arrows in the structures mark mutations); each plot shows the measured reactivates for each pair of mutants (orange and green) and predicted REEFFIT reactivates for the corresponding state (blue with error bars). (d) Determining FMN dissociation constants for stabilizing mutants of the TBWN-A, TBWN-B, and TBWN-C structures of the Tebowned FMN switch using the LIFFT HiTRACE toolkit (showing data for residue 15, see Supporting Fig I in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>) are shown below the mutants.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.g005" position="float" xlink:type="simple"/>
</fig>
<p>The REEFFIT-inferred populations of TBWN-B and TBWN-C were low (&lt;30%). Therefore, to further test the presence of at least three states, we sought to compare their modeled REEFFIT reactivity profiles to actually measured reactivities for these states. To achieve this comparison, we designed mutants that specifically stabilized helices in each of the TBWN-A, TBWN-B, and TBWN-C structures (<xref rid="pcbi.1004473.g005" ref-type="fig">Fig 5a–5c</xref>). For each state, the reactivities of these state-isolating mutants agreed with each other within experimental error and were approximated well by REEFFIT’s predicted profile, providing independent confirmation of the modeled ensemble, including the unanticipated third state TBWN-C. Additional evidence for the accuracy of REEFFIT’s predictions was revealed by each of the stabilizing mutants’ FMN binding affinities: the TBWN-B and TBWN-A/TBWN-C mutants enhanced and worsened ligand binding, respectively, as expected (<xref rid="pcbi.1004473.g005" ref-type="fig">Fig 5d</xref>, and Supporting Results and Fig I in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). We emphasize that the TBWN-C state would have been difficult to propose and then validate without automated REEFFIT analysis, given its negligible predicted population in secondary structure prediction calculations without M<sup>2</sup> data (<xref rid="pcbi.1004473.g004" ref-type="fig">Fig 4c</xref>).</p>
<p>As a second test case with a previously unknown structural ensemble, we tested whether randomly generated or scrambled RNA sequences tend to fold into multiple disparate structures at equilibrium—a long-standing hypothesis fundamental to understanding RNA evolution, put forth by several <italic>in silico</italic> studies [<xref rid="pcbi.1004473.ref035" ref-type="bibr">35</xref>,<xref rid="pcbi.1004473.ref036" ref-type="bibr">36</xref>] and an experimental study that could not deconvolve the structures [<xref rid="pcbi.1004473.ref037" ref-type="bibr">37</xref>]. We carried out M<sup>2</sup>-REEFFIT for a randomly generated sequence, called here the M-stable RNA (<xref rid="pcbi.1004473.g006" ref-type="fig">Fig 6</xref>). Based on simulations, the structural ensemble of the construct was expected to consist mainly of a simple hairpin (P1 in MST-A in <xref rid="pcbi.1004473.g006" ref-type="fig">Fig 6d</xref>, see top triangle of the <xref rid="pcbi.1004473.g006" ref-type="fig">Fig 6c</xref>) but with at least two other structures becoming more stable than MST-A upon single mutations. The experimental M<sup>2</sup> measurements were complex, with different mutants giving disparate protection patterns even in segments that appeared highly reactive (and seemingly unstructured) in the wild type RNA. As a first check on the number of states, REEFFIT fits assuming only 2 or 3 states missed many features observed in the data, including extended segments of changed chemical reactivity in several mutants (Fig J in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). However, the REEFFIT global ensemble fit successfully modeled the M-stable data and suggested an ensemble with many more weakly populated helices than RNAstructure’s estimate (compare bottom and top halves of <xref rid="pcbi.1004473.g006" ref-type="fig">Fig 6c</xref>). For visualization, we clustered these heterogeneous component structures into three states, MST-A, MST-B, and MST-C (see <xref rid="pcbi.1004473.g006" ref-type="fig">Fig 6d–6f</xref> and Fig Hd-Hf in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref>). Analogous to the case of the Tebowned switch, we tested the REEFFIT prediction of these alternative states by designing mutations to stabilize the medioid structures of each cluster (<xref rid="pcbi.1004473.g006" ref-type="fig">Fig 6d–6f</xref>). These mutants gave reactivities in agreement with predictions for MST-A and MST-C, supporting the inference of those structures. For MST-B, the state-stabilizing mutants gave reactivity profiles that did not exactly match each other, suggesting residual heterogeneity of structure; the profiles were nevertheless closer to the REEFFIT-predicted MST-B profile than wild type reactivities. These results corroborate the M<sup>2</sup>-REEFFIT model that the M-stable random RNA has a complex landscape with at least three structures, and likely significantly more heterogeneity, detectable upon unbiased nucleotide mutation.</p>
<fig id="pcbi.1004473.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004473.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Landscape dissection of a random RNA sequence, the M-stable RNA.</title>
<p>(a) M<italic>2</italic> data, (b) REEFFIT fit, and (c) inference of the M-stable structural landscape, showing one helix, P1, present at almost 50% as well as numerous other helices (P2, P3, and P4) present at non-negligible fractions. (d-f) State medioids for (d) MST-A, (e) MST-B, and (f) MST-C, and comparison between reactivities predicted by REEFFIT and mutants designed to stabilize each state medioids.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.g006" position="float" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>The structure landscapes of natural and newly designed RNA molecules underlie their biological behaviors, but these landscapes’ complexities are largely uncharacterized [<xref rid="pcbi.1004473.ref011" ref-type="bibr">11</xref>]. Current experimental techniques used to probe these ensembles at nucleotide resolution require significant infrastructure investment and expert intuition. We have presented M<sup>2</sup>-REEFFIT, an unbiased strategy based on readily acquired chemical mapping measurements that detects dominant and alternative states of RNA structure landscapes in the ensemble perturbations induced by single-nucleotide mutations, with conservative estimates based on bootstrapping.</p>
<p>Due to the challenges inherent in estimating a full ensemble of secondary structures rather than a single best-fit model, we have invested significant effort into benchmarking M<sup>2</sup>-REEFFIT and its uncertainty estimates. We confirmed the accuracy of REEFFIT and its uncertainty estimates in M<sup>2</sup> simulation data with known ‘ground truth’ landscapes and in experimental data of RNAs whose landscapes were previously studied by chemical mapping or NMR experiments. We then applied REEFFIT to investigate if artificial sequences could present complex landscapes of alternative structures without specific design in two model systems whose ensemble behaviors were refractory to prior tools. We first traced a structural discrepancy in an artificial flavin-mononucleotide-binding switch to a significant population of an unexpected state. We then tested <italic>in silico</italic> predictions for the complex structural landscape of random sequences by obtaining the first experimentally derived landscape model of a randomly generated sequence, the M-stable RNA. For all cases, we tested REEFFIT’s predictions through independent experiments, including comparison to independent experimental methods and effects of stabilizing mutations and ligand binding.</p>
<p>Beyond the inference of structural landscapes of single sequences, the high-throughput nature of M<sup>2</sup>-REEFFIT makes inference of the landscapes of multiple sequences related through their presumed or engineered function possible. For example, when dissecting structural features of sequences selected for binding efficiencies to molecular partners through <italic>in vitro</italic> selection or when analyzing the role of conserved structural motifs in diverse RNA sequences, a full portrait of their landscapes may reveal the interplay of several states that is critical for function. As an example, one of our experimental test cases, the Tebowned FMN switch, illustrates that information relevant for function can be extracted from knowing the full landscape of the RNA. In this case, we have a ‘functional’ readout of a structural motif (the FMN binding motif) that is present at different fractions in different mutants of the M<sup>2</sup> experiment. A full view of the ensemble yields an extra state, TBWN-C, whose interplay with the state that contains the binding motif, TBWN-B, is necessary for understanding FMN binding of the riboswitch and its variants.</p>
<p>Currently, uncertainties in the reactivities and energies of RNA motifs lead to RMSD errors in M<sup>2</sup>-REEFFIT state population fractions on the order of 10–15%, rendering the detection of states with lower population fractions difficult; these uncertainties may become poorer for longer RNA domains. Nevertheless, we expect that rapidly growing databases of rigorously standardized reactivity data [<xref rid="pcbi.1004473.ref038" ref-type="bibr">38</xref>,<xref rid="pcbi.1004473.ref039" ref-type="bibr">39</xref>] and of energetic parameters [<xref rid="pcbi.1004473.ref040" ref-type="bibr">40</xref>] for diverse RNA motifs will reduce these uncertainties. Furthermore, M<sup>2</sup> experiments performed with other chemical probes, such as dimethyl sulfate, should provide powerful cross-validation data sets for testing inferred landscapes. Through the presented and related chemical mapping technologies, we therefore expect to have more routine visualization of the rich structural landscapes that appear to be pervasive in both functional RNAs and the generic sequences from which they evolve.</p>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec009">
<title>M<sup>2</sup> measurements</title>
<p>The MedLoop RNA mutate-and-map data were obtained as part of the experimental pipeline of the Eterna massively parallel open laboratory [<xref rid="pcbi.1004473.ref027" ref-type="bibr">27</xref>],[<xref rid="pcbi.1004473.ref041" ref-type="bibr">41</xref>]. The MedLoop RNA and its mutants were generated through <italic>in vitro</italic> transcription of a pool of DNA constructs purchased from CustomArray. The RNA was probed with 1-methyl-7-nitroisatoic anhydride (1M7) in a folding buffer (see Table I in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> for detailed folding conditions) using the MAP-seq protocol and sequenced. in a MiSeq sequencer. The resulting reads and were analyzed with the MAP-seeker software [<xref rid="pcbi.1004473.ref041" ref-type="bibr">41</xref>]. The Bistable hairpin, Tebowned switch, and M-stable RNAs as well as their respective  complementary single-nucleotide mutants were constructed using PCR assembly, <italic>in vitro</italic> transcription, and probed with 1M7 as described previously [<xref rid="pcbi.1004473.ref042" ref-type="bibr">42</xref>]. Briefly, an assembly consisting of at most 60-nucleotide primers was designed to synthesize an <italic>in vitro</italic> transcription sample by PCR. DNA was purified with AMPure XP beads (Agencourt, Beckman Coulter) and <italic>in vitro</italic> transcribed for 3 hours. The resulting RNA was purified with AMPure XP beads, heated for 3 minutes at 90°C, cooled at room temperature for 15 minutes, and folded in folding buffer at room temperature for 1 hour (see Table I in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> for detailed folding conditions for each RNA). Because we sought to probe the ensemble of the RNA with minimal interference from the 3´ unpaired sequence that we use as the primer binding site, we folded the RNA in the presence of the fluorescent primer attached to the oligo(dT) beads (Ambion) that we regularly use for purification. Folding in this condition sequesters any additional single stranded regions that may interfere with our sequence of interest. The RNA was then subjected to 1M7 mapping (5 mM final concentration), purified with the oligo(dT) beads, and reverse transcribed for 30 minutes at 42°C. Unmodified RNA controls were also included in the experiment. RNA was then degraded using alkaline hydrolysis and cDNA was purified, eluted in Hi-Di Formamide spiked with a fragment analysis ladder (ROX 350 standard, Applied Biosystems), and electrophoresed in an ABI 3150 capillary electrophoresis sequencer. The add adenine riboswitch M<sup>2</sup> data was obtained similarly but folded under different conditions, in the NMR buffer of the previous study (50 mM KCl and 25 mM K<sub>3</sub>PO<sub>4</sub>, 10 mM MgCl<sub>2</sub>, pH 6.5) with or without 5 mM adenine for bound and unbound conditions, [<xref rid="pcbi.1004473.ref017" ref-type="bibr">17</xref>] For NMR folding conditions, we adjusted the 1M7 incubation time to 15 minutes instead of 3 minutes to account for the low pH. For the Tebowned FMN titrations, dimethyl sulfate (DMS) was used in lieu of 1M7 since it yields a readily seen signal change across FMN concentrations [<xref rid="pcbi.1004473.ref033" ref-type="bibr">33</xref>].</p>
<p>Electrophoretic traces were aligned, baseline subtracted, and normalized with the HiTRACE MATLAB toolkit [<xref rid="pcbi.1004473.ref043" ref-type="bibr">43</xref>]. 1M7 modification traces were quantified, background subtracted, and corrected for attenuation using 10X dilutions, the unmodified controls, and the pentaloop hairpins added at the ends of the constructs as reference [<xref rid="pcbi.1004473.ref044" ref-type="bibr">44</xref>]. For the Tebowned RNA, no pentaloop hairpins were added and we relied instead on the HiTRACE background subtraction routine overmod _and_background_correct_logL using unmodified controls. The lifft function from the LIFFT package [<xref rid="pcbi.1004473.ref045" ref-type="bibr">45</xref>] in HiTRACE was used to calculate the FMN binding dissociation constants for REEFFIT comparisons. Mutants with low signal were flagged as low quality and were not taken into account for the analysis.</p>
</sec>
<sec id="sec010">
<title>The RNA Ensemble Extraction From Footprinting Insights Technique (REEFFIT)</title>
<p>For a given mutate-and-map data set, REEFFIT infers the expected reactivity profile of each structure, the combination of structure population fractions (also denoted here as structure weights), and sequence-position-wise noise levels that best fit the data (see Figs <xref rid="pcbi.1004473.g001" ref-type="fig">1b</xref> and <xref rid="pcbi.1004473.g001" ref-type="fig">1c</xref>) using prior information on known chemical reactivity distributions, a weak prior based on an approximate secondary structure energetic model, and a well-defined likelihood function. To achieve this fit, we expanded Gaussian factor analysis, a standard blind-source separation technique, to include position-specific, non-negative, non-Gaussian priors for the expected reactivities and factor weights that depend on both structure and sequence position. Local perturbations due to mutations, including the release of base pairing partners induced by the single nucleotide changes, were also included in the statistical model (see section below “Handling local perturbations”). The model including these variables and parameters was fitted by REEFFIT using a maximum <italic>a posteriori</italic> (MAP) approximation. (A Bayesian simulation inference method sampling over the posterior distribution gave indistinguishable results at significantly greater computational expense and is not presented in detail here.). In this section, we present the basic idea behind the model. Then, in the following sections we introduce the priors used for each variable and parameter in the model. Finally, we incorporate these priors and present inferential steps used to fit the model to the data.</p>
<p>In a broad sense, for <italic>m</italic> chemical mapping measurements of <italic>n</italic>-nucleotide sequences, REEFFIT models the data, denoted here as <italic>D</italic><sup><italic>obs</italic></sup> ∈ ℜ<sup><italic>m</italic>×<italic>n</italic></sup>, with a set of <italic>r</italic> secondary structures. The data are modeled as linear combinations of the structures’ reactivity profiles, denoted here as a matrix <italic>D</italic> ∈ ℜ<sup><italic>r</italic>×<italic>n</italic></sup>, with a weight matrix <italic>W</italic> ∈ ℜ<sup><italic>m</italic>×<italic>r</italic></sup> plus Gaussian noise (see <xref rid="pcbi.1004473.g001" ref-type="fig">Fig 1b</xref>). Then, for each measurement <italic>j</italic> we have:
<disp-formula id="pcbi.1004473.e001">
<alternatives>
<graphic id="pcbi.1004473.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e001" xlink:type="simple"/>
<mml:math display="block" id="M1" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mo>∈</mml:mo><mml:mo> </mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>The rows of the weight matrix <italic>W</italic> correspond to the population fractions of the structures in each measurement. Therefore, the corresponding weights for each measurement define a probability distribution and are non-negative and add up to one:
<disp-formula id="pcbi.1004473.e002">
<alternatives>
<graphic id="pcbi.1004473.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e002" xlink:type="simple"/>
<mml:math display="block" id="M2" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mo>∈</mml:mo><mml:mo> </mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mtext>  </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
</sec>
<sec id="sec011">
<title>Setting a prior on the “hidden” structure reactivities</title>
<p>In REEFFIT, <italic>D</italic> is a set of hidden variables since the isolated reactivity profiles of each structure are not typically available. We can impose a prior on each of these hidden profiles depending on their corresponding modeled secondary structure. Because a nucleotide’s chemical reactivity is reduced upon base pairing, a reasonable prior would force <italic>D</italic><sub><italic>si</italic></sub> to be small if <italic>i</italic> is paired in structure <italic>s</italic> and higher if it is unpaired. The needed priors are derived empirically from distributions of the reactivities of paired and unpaired nucleotides in the RNA Mapping Database (RMDB) of RNAs with known crystallographic structure [<xref rid="pcbi.1004473.ref039" ref-type="bibr">39</xref>,<xref rid="pcbi.1004473.ref046" ref-type="bibr">46</xref>]. Let <italic>RMDB</italic><sub><italic>U</italic></sub> and <italic>RMDB</italic><sub><italic>P</italic></sub> be the empirical RMDB unpaired and paired reactivity distributions respectively and <italic>d</italic> be some reactivity, we can then define a prior likelihood for <italic>D</italic><sub><italic>si</italic></sub> as:
<disp-formula id="pcbi.1004473.e003">
<alternatives>
<graphic id="pcbi.1004473.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e003" xlink:type="simple"/>
<mml:math display="block" id="M3" overflow="scroll">
<mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> if </mml:mtext><mml:mi>i</mml:mi><mml:mtext> is unpaired in</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> if </mml:mtext><mml:mi>i</mml:mi><mml:mtext> is paired in</mml:mtext><mml:mo> </mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>Here, we equate reactivities to values given by SHAPE modifiers; to handle other modifiers, e.g. dimethyl sulfate, <italic>RMDB</italic><sub><italic>U</italic></sub> and <italic>RMDB</italic><sub><italic>P</italic></sub> can be replaced with the respective estimated distributions using unpaired and paired data of that modifier.</p>
<p>To simplify statistical inference, we approximated the RMDB reactivity distributions for paired and unpaired residues with exponential distributions, which has been found to be suitable for distributions of reactivities in unpaired regions [<xref rid="pcbi.1004473.ref047" ref-type="bibr">47</xref>]. We denote these approximations as:
<disp-formula id="pcbi.1004473.e004">
<alternatives>
<graphic id="pcbi.1004473.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e004" xlink:type="simple"/>
<mml:math display="block" id="M4" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>D</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mo>*</mml:mo><mml:mi>P</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>D</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mo>*</mml:mo><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p>Fitting these models to reactivity distributions for paired and unpaired residues in the RMDB gave scaling parameters of <italic>λ</italic><sub><italic>P</italic></sub> = 0.5 and <italic>λ</italic><sub><italic>U</italic></sub> = 0.2. We denote <italic>RMDB</italic>*<sub><italic>si</italic></sub> as the resulting approximation for <italic>RMDB</italic><sub><italic>si</italic></sub> for structure <italic>s</italic> in position <italic>i</italic>, and <italic>λ</italic><sub><italic>si</italic></sub> as the corresponding scaling parameter, that is:
<disp-formula id="pcbi.1004473.e005">
<alternatives>
<graphic id="pcbi.1004473.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e005" xlink:type="simple"/>
<mml:math display="block" id="M5" overflow="scroll">
<mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mtext> if </mml:mtext><mml:mi>i</mml:mi><mml:mtext> is paired in s</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mtext> if </mml:mtext><mml:mi>i</mml:mi><mml:mtext> is unpaired in s</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
</sec>
<sec id="sec012">
<title>Handling local perturbations</title>
<p>Systematic experimental perturbations used to alter the RNA's structural ensemble may induce local changes that cannot be captured by the linear combination of the weights <italic>W</italic> and the hidden reactivities <italic>D</italic>. This is the case in M<sup>2</sup> experiments, where mutations induce local perturbations in the underlying reactivities of each structure. To model these perturbations, we add a set of random variables that take the values of the change in reactivity of <italic>D</italic> at perturbed positions in order to account for the data. That is, we add a Δ<italic>C</italic><sub><italic>sji</italic></sub> variable for all sequence positions <italic>i</italic> that are in a set of perturbed sites for structure <italic>s</italic> in mutant <italic>j</italic>, <italic>perturbed</italic>(<italic>s</italic>,<italic>j</italic>). These perturbed sites are defined as positions lying at most one nucleotide away from the site of a mutation in mutant <italic>j</italic> or from a base pair that would be disrupted due to a mutation in structure <italic>s</italic> in mutant <italic>j</italic>. To simplify notation, we define <italic>C</italic> as containing the values of these perturbation variables at the relevant positions and mutants:
<disp-formula id="pcbi.1004473.e006">
<alternatives>
<graphic id="pcbi.1004473.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e006" xlink:type="simple"/>
<mml:math display="block" id="M6" overflow="scroll">
<mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext> if </mml:mtext><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo>∈</mml:mo><mml:mspace width="1pt"/><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mtext> otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula></p>
<p>We set the prior distributions of Δ<italic>C</italic><sub><italic>sji</italic></sub> to a Gaussian approximation of differences in reactivities in M<sup>2</sup> experiments available in the RMDB:
<disp-formula id="pcbi.1004473.e007">
<alternatives>
<graphic id="pcbi.1004473.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e007" xlink:type="simple"/>
<mml:math display="block" id="M7" overflow="scroll">
<mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
<p>Fitting a normal distribution to the RMDB reactivity differences gave <italic>λ</italic><sub><italic>perturbed</italic></sub> = 2.</p>
</sec>
<sec id="sec013">
<title>Setting a prior for a regularized fit of the structure weights</title>
<p>Since REEFFIT potentially fits hundreds or even thousands of structures (see section below, “Building the structural ensemble and reducing model complexity”), we set a sparsity prior on the weight matrix <italic>W</italic>. Standard Laplacian (<italic>l</italic><sub><italic>1</italic></sub>) sparsity cannot be imposed because the per-measurement weights are probability distributions and are constrained to sum to unity for each variant. We therefore imposed a “smooth sparsity” regularizer <italic>λ</italic><sub><italic>R</italic></sub> using a Gaussian distribution (<italic>l</italic><sub><italic>2</italic></sub>), where weights found to be unimportant for the model are reduced to low, but typically non-zero, values.</p>
<disp-formula id="pcbi.1004473.e008">
<alternatives>
<graphic id="pcbi.1004473.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e008" xlink:type="simple"/>
<mml:math display="block" id="M8" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
<p>To further avoid over-fitting weights, we encode a penalty that disallows dramatic deviations of computationally-predicted ΔΔ<italic>G</italic> values for each structure <italic>s</italic> between the wild type sequence and each mutant to values calculated from the RNAstructure package. For mutant <italic>j</italic>, let Δ<italic>G</italic><sub><italic>js</italic></sub> be the energy for structure <italic>s</italic> calculated by the efn2 program in the RNAstructure package [<xref rid="pcbi.1004473.ref048" ref-type="bibr">48</xref>], <italic>k</italic><sub><italic>B</italic></sub> the Boltzmann constant, and <italic>T</italic> the temperature at which the experiments were performed. We denote the RNAstructure weights at <italic>(j</italic>,<italic>s)</italic> as:
<disp-formula id="pcbi.1004473.e009">
<alternatives>
<graphic id="pcbi.1004473.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e009" xlink:type="simple"/>
<mml:math display="block" id="M9" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula></p>
<p>We then impose a Gaussian prior on wild type weights that drives their wild-type/mutant weight differences to be close to the RNAstructure values through a parameter <italic>λ</italic><sub>Δ</sub>. Let wild type weights for each structure <italic>s</italic> are denoted as <italic>W</italic><sup>WT</sup><sub><italic>s</italic></sub> then:
<disp-formula id="pcbi.1004473.e010">
<alternatives>
<graphic id="pcbi.1004473.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e010" xlink:type="simple"/>
<mml:math display="block" id="M10" overflow="scroll">
<mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mo>Δ</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula></p>
<p>Values for <italic>λ</italic><sub>Δ</sub> and <italic>λ</italic><sub><italic>R</italic></sub> were obtained using a cross-validation strategy (see section below, <italic>“</italic>Building the structural ensemble and reducing model complexity”). These priors do not impose the probability distribution constraints of <xref rid="pcbi.1004473.e002" ref-type="disp-formula">eq (2)</xref> on the measurement weights; instead, the probability distribution constraints are enforced during the optimization of the posterior function (see below).</p>
</sec>
<sec id="sec014">
<title>The REEFFIT statistical model</title>
<p>After defining the variables for modeling the data and their respective priors, we can write the complete REEFFIT model. Let <italic>j = 1</italic>,<italic>…</italic>,<italic>m</italic>, index over measurements. Then we write the model as:
<disp-formula id="pcbi.1004473.e011">
<alternatives>
<graphic id="pcbi.1004473.e011g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e011" xlink:type="simple"/>
<mml:math display="block" id="M11" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mo>∈</mml:mo><mml:mo> </mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>D</mml:mi><mml:mi>B</mml:mi><mml:msub><mml:mo>*</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>;</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mo>Δ</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mo>∈</mml:mo><mml:mo> </mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mtext>s  </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula></p>
<p>Here, the hidden variables <italic>D</italic> and their perturbations Δ<italic>C</italic><sub><italic>sji</italic></sub> are encoded in <italic>C</italic>, while the parameters to estimate are <italic>W</italic> and the variances Ψ<sub><italic>i</italic></sub>. It is important to note that here, as in similar factor analysis models, all noise covariance matrices are assumed to be diagonal; that is, the measurements are independent of each other [<xref rid="pcbi.1004473.ref049" ref-type="bibr">49</xref>,<xref rid="pcbi.1004473.ref050" ref-type="bibr">50</xref>]. This assumption holds in the case of multiple chemical mapping measurements, since each measurement is carried out in different capillaries in capillary electrophoresis [<xref rid="pcbi.1004473.ref051" ref-type="bibr">51</xref>] or is based on Poisson distributed counts derived from separate single molecules in deep sequencing [<xref rid="pcbi.1004473.ref041" ref-type="bibr">41</xref>,<xref rid="pcbi.1004473.ref052" ref-type="bibr">52</xref>].</p>
<p>We used a hard expectation maximization (EM) algorithm to obtain MAP estimates for the values of the hidden variables and the model parameters. In hard EM optimization, the values for the hidden variables obtained in the E-step are maximum <italic>a posteriori</italic> estimates rather than expectations used in soft EM [<xref rid="pcbi.1004473.ref050" ref-type="bibr">50</xref>]. In standard factor analysis a soft EM is typically used: the E-step can be obtained in closed form by calculating the sufficient statistics for the likelihood function, which happen to be the first two moments of the posterior distribution of <italic>D</italic>: E[<italic>D</italic>|<italic>D</italic><sup>obs</sup>] and E[<italic>DD</italic><sup><italic>T</italic></sup>|<italic>D</italic><sup>obs</sup>] [<xref rid="pcbi.1004473.ref049" ref-type="bibr">49</xref>,<xref rid="pcbi.1004473.ref050" ref-type="bibr">50</xref>,<xref rid="pcbi.1004473.ref053" ref-type="bibr">53</xref>]. However, the non-Gaussian form of our priors for each <italic>D</italic><sub><italic>si</italic></sub>, precludes a closed form for these statistics and we instead used a hard EM strategy. This strategy yielded results that were comparable with a much more computationally expensive soft EM procedure that used Markov Chain Monte Carlo (MCMC) to approximate E[<italic>D</italic>|<italic>D</italic><sup>obs</sup>] and E[<italic>DD</italic><sup><italic>T</italic></sup>|<italic>D</italic><sup>obs</sup>] in the E-step. For the M-step, we incorporated probability distribution constraints on <italic>W</italic> by casting the posterior maximization as a quadratic problem and solving it numerically.</p>
</sec>
<sec id="sec015">
<title>Maximum <italic>a posteriori</italic> estimation of the REEFFIT model</title>
<p>Given the REEFFIT factor analysis model <xref rid="pcbi.1004473.e011" ref-type="disp-formula">(11)</xref> we want to calculate MAP estimates for <italic>W</italic> and each Ψ<sub><italic>i</italic></sub> given the hidden variables <italic>D</italic>. The posterior function can be written as:
<disp-formula id="pcbi.1004473.e012">
<alternatives>
<graphic id="pcbi.1004473.e012g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e012" xlink:type="simple"/>
<mml:math display="block" id="M12" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mo>Ψ</mml:mo><mml:mtext>,</mml:mtext><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo><mml:mtext>Likelihood</mml:mtext><mml:mo>×</mml:mo><mml:mtext>Prior of </mml:mtext><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mtext>Prior of </mml:mtext><mml:mi>C</mml:mi><mml:mo>×</mml:mo><mml:mtext>Prior of </mml:mtext><mml:mi>W</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mtext>positions</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mtext>measurements</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mtext> </mml:mtext><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mtext> </mml:mtext><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mtext> </mml:mtext><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mo>Δ</mml:mo></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mtext> </mml:mtext><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mo>Δ</mml:mo></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula></p>
<p>Corresponding to a log-posterior (obviating the normalizing factor):
<disp-formula id="pcbi.1004473.e013">
<alternatives>
<graphic id="pcbi.1004473.e013g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e013" xlink:type="simple"/>
<mml:math display="block" id="M13" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>log</mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mo>Ψ</mml:mo><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mtext>positions</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mtext>measurements</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mo>Δ</mml:mo></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mo>Δ</mml:mo></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mtext>WT</mml:mtext></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula></p>
<p>For the E-step, we estimate optimal hidden variable values for <italic>D</italic> and <italic>C</italic>. For each position <italic>i</italic>, finding the hidden variable for each structure <italic>s</italic>, <italic>D</italic><sub><italic>si</italic></sub> that maximizes log <italic>p</italic> by differentiating and setting to zero, gives the following linear equations:
<disp-formula id="pcbi.1004473.e014">
<alternatives>
<graphic id="pcbi.1004473.e014g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e014" xlink:type="simple"/>
<mml:math display="block" id="M14" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mtext>measurements</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mtext>measurements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula></p>
<p>For measurement <italic>j</italic>, if position <italic>i</italic> lies in <italic>perturbed(s</italic>,<italic>j)</italic>, solving for <italic>C</italic><sub><italic>sji</italic></sub> in the same manner gives the equation:
<disp-formula id="pcbi.1004473.e015">
<alternatives>
<graphic id="pcbi.1004473.e015g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e015" xlink:type="simple"/>
<mml:math display="block" id="M15" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:msub><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mtext>measurements</mml:mtext></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>For each position <italic>i</italic>, compiling the Eqs (<xref rid="pcbi.1004473.e014" ref-type="disp-formula">14</xref>) and (<xref rid="pcbi.1004473.e015" ref-type="disp-formula">15</xref>) for all structures and measurements results in a linear system. Solving these <italic>n</italic> systems (one per sequence position), we obtain optimal values for <italic>D</italic>, <italic>C</italic>, which we name <italic>D</italic>*, <italic>C</italic>*.</p>
<p>For the M-step, we calculate <italic>W</italic> by maximizing log <italic>p</italic> in each measurement enforcing the probability distribution constraints in <xref rid="pcbi.1004473.e002" ref-type="disp-formula">Eq (2)</xref>. We can cast this maximization as a set of quadratic programs. Let <inline-formula id="pcbi.1004473.e016"><alternatives><graphic id="pcbi.1004473.e016g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e016" xlink:type="simple"/><mml:math display="inline" id="M16" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> be the data and <italic>W</italic><sub><italic>j</italic></sub> be the set of weights for measurement <italic>j</italic>, then, to estimate the optimal weights for <italic>j</italic>, we solve:
<disp-formula id="pcbi.1004473.e017">
<alternatives>
<graphic id="pcbi.1004473.e017g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e017" xlink:type="simple"/>
<mml:math display="block" id="M17" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mtext> log</mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>Ψ</mml:mo><mml:mtext>,</mml:mtext><mml:msup><mml:mi>D</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi>D</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>subject to </mml:mtext><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext> and </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
<p>We solve the resulting quadratic programs using the CVXOPT python library [<xref rid="pcbi.1004473.ref054" ref-type="bibr">54</xref>] and denote the resulting weight matrix estimate as <italic>W</italic>*. Re-estimation of the variances Ψ<sub><italic>i</italic></sub> in the M-step is also given by optimizing log <italic>p</italic>, but over Ψ<sub><italic>i</italic></sub>:
<disp-formula id="pcbi.1004473.e018">
<alternatives>
<graphic id="pcbi.1004473.e018g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004473.e018" xlink:type="simple"/>
<mml:math display="block" id="M18" overflow="scroll">
<mml:mrow><mml:msubsup><mml:mo>Ψ</mml:mo><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mtext>measurements</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>structures</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula></p>
<p>The E and M step optimization procedures are then repeated until the maximum difference of the induced base-pair probability matrices of the previous and current iteration is less than 1%. In our benchmarks, we have observed that usually 10 to 20 EM iterations are required for convergence. We note that our log posterior function is not convex and therefore our EM procedure does not necessarily converge to a global optimum and is sensitive to initial conditions. Nevertheless, testing different initial conditions with RNAstructure and ViennaRNA gave important improvements and similar results in our <italic>in silico</italic> benchmark (see Supporting Results in <xref rid="pcbi.1004473.s001" ref-type="supplementary-material">S1 Text</xref> above).</p>
<p>To initialize the variables Ψ<sub><italic>i</italic></sub>, we choose the empirical variance of position <italic>i</italic> across all chemical mapping measurements, consistent with the variance calculation performed when using M<sup>2</sup> z-scores as pseudo-energy bonuses for secondary structure prediction [<xref rid="pcbi.1004473.ref028" ref-type="bibr">28</xref>]. For initial estimates of <italic>W</italic>, we use RNAstructure to calculate the energies of each structure in each mutant as in <xref rid="pcbi.1004473.e009" ref-type="disp-formula">Eq (9)</xref>.</p>
<p>To calculate uncertainties for <italic>W</italic> that are robust to outliers and high-reactivity values, we re-fit the model in bootstrapped datasets by sampling columns (i.e. sequence-positions) with replacement of <italic>D</italic><sup><italic>obs</italic></sup> per bootstrap iteration. The final estimate of <italic>W</italic> is then the average weight matrix of all of the replicates; in all fits shown we report uncertainties as bootstrap standard deviations. Throughout this work, we used 100 bootstrap iterations. In the absence of bootstrapping, REEFFIT can also provide error estimates based on the Fisher information matrix approach, but those values are generally underestimates of the uncertainties.</p>
</sec>
<sec id="sec016">
<title>Building the structural ensemble and reducing model complexity</title>
<p>In most realistic scenarios for <italic>de novo</italic> RNA landscape modeling, it is not known <italic>a priori</italic> what set of structures would best model the data. To select an initial set of structures, we obtain a set of suboptimal structures for each sequence in the multi-dimensional chemical mapping experiment: for M<sup>2</sup> experiments, the suboptimal structures of all variants involved have to be taken into account. We obtain at most 200 suboptimal structures of each mutant’s structural ensemble using the AllSub program, with default parameters (5% maximum energy difference from the MFE structure) from the RNAstructure program suite (version 5.5) [<xref rid="pcbi.1004473.ref048" ref-type="bibr">48</xref>].</p>
<p>The fits presented herein use all of the structures sampled in this manner. To reduce model complexity, we collapsed position-wise hidden reactivity variables that corresponded to different structures but formed part of the same structural motif. For example, if for position <italic>i</italic> we have 100 hidden reactivity variables that either correspond to a particular helix or an interior loop in the same part of the sequence, then we collapse the hidden variables into two variables, a helix and an interior loop variable, rather than 100 hidden reactivity variables. This variable collapse encodes the assumption that identical structural motifs will exhibit similar chemical reactivities independent of the structural context.</p>
<p>Specifically, let <italic>sm</italic> be a structural motif (the structural motifs that we take into account are: helices, bulges, <italic>x</italic>-way junctions, interior loops, dangles, single-stranded regions between helices, and hairpin loops) and let <italic>motif(i</italic>, <italic>sm)</italic> be the structures that have the <italic>sm</italic> motif at position <italic>i</italic>. Then, we constrain the values for all variables in the set {<italic>D</italic><sub><italic>si</italic></sub>|∀<italic>s</italic> ∈ <italic>motif</italic>(<italic>i</italic>,<italic>sm</italic>)}to be the same, collapsing the |<italic>motif</italic>(<italic>i</italic>,<italic>sm</italic>)| variables into only one variable. Because the number of structures sampled typically exceeds the number of measurements (in most cases analyzed here we obtained ensembles of over 200 structures), this model simplification is essential to prevent over-fitting. In cases where the same sub-motif may have different reactivities in different structures (e.g. upon ligand-binding), this information can be used to expand the number of fit parameters for that motif, as we carried out for the <italic>add</italic> or Tebowned riboswitches (see below).</p>
<p>To select the regularization parameters <italic>λ</italic><sub>Δ</sub> and <italic>λ</italic><sub><italic>R</italic></sub> we used a cross-validation approach. Since chemical mapping data are structured (i.e. we cannot assume that reactivities in all positions come from the same population given the structural context of each nucleotide), we have to adapt the cross-validation technique accordingly. We employed a strategy frequently used in structured data contexts such as spline smoothing, where the <italic>i</italic>-th subsample in a <italic>k</italic>-fold cross-validation is the sequence {<italic>i</italic>,<italic>i</italic>+<italic>k</italic>,<italic>i</italic>+2<italic>k</italic>,…}[<xref rid="pcbi.1004473.ref055" ref-type="bibr">55</xref>]. This strategy samples the structured data uniformly across the nucleotide sequence, maintaining the assumptions necessary for cross-validation. In each fold of the cross validation, we obtain structure weights using the data from the training samples. With these weight estimates, we then obtain best predictions of the positions in the test sets with these weights. The cross-validation error is then the mean square error of the predicted and the observed test data [<xref rid="pcbi.1004473.ref056" ref-type="bibr">56</xref>]. We calculated an optimal value for <italic>λ</italic><sub>Δ</sub> and <italic>λ</italic><sub><italic>R</italic></sub> using our <italic>in silico</italic>, <italic>ab initio</italic> benchmark of 20 Rfam members, minimizing the 10-fold cross-validation error across all the benchmark. The optimal values, <italic>λ</italic><sub>Δ</sub> = 5 and <italic>λ</italic><sub><italic>R</italic></sub> = 0.26 were then used for all fits presented herein.</p>
</sec>
</sec>
<sec id="sec17">
<title>Data set and software availability</title>
<p>The REEFFIT programs and their source code are available at <ext-link ext-link-type="uri" xlink:href="http://rmdb.stanford.edu/tools/docs/reeffit/" xlink:type="simple">http://rmdb.stanford.edu/tools/docs/reeffit/</ext-link>, along with software documentation and tutorials. M<sup>2</sup> capillary electrophoresis data for the Bistable, <italic>add</italic> riboswitch, M-stable, and Tebowned RNAs have been deposited in the RMDB (RMDB IDs BSTHPN_1M7_0000.rdat, ADDSCHW_1M7_0000, ADDSCHW_1M7_0001, MSTBL_1M7_0000, TBWND_1M7_0000, and TBWND_1M7_0001). M<sup>2</sup>-seq data for the MedLoop are part of the EteRNA cloud lab, rounds 72 (RMDB ID ETERNA_R72_0000, project name “MedLoop”). RDAT files for the simulated datasets can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://purl.stanford.edu/zr287dq2666" xlink:type="simple">http://purl.stanford.edu/zr287dq2666</ext-link></p>
</sec>
<sec id="sec018">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004473.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004473.s001" mimetype="application/pdf" position="float" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supporting Results, Methods, Figures, and Tables.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004473.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004473.s002" mimetype="application/pdf" position="float" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>A Supporting Report with detailed figures on the <italic>in silico</italic> benchmark results.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank W. Kladwang, J. Lee, A. Treuille, and B. Seo for implementing mutate-and-map measurements on the Eterna platform; E. Ashley for computational resources; F. C. Chou for careful comment and critique; N. Bisaria, B. Alford, T. Mann, members of the Das lab, and the Eterna player community for comments and useful discussion.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004473.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nudler</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mironov</surname> <given-names>AS</given-names></name>. <article-title>The riboswitch control of bacterial metabolism</article-title>. <source>Trends Biochem Sci</source>. <year>2004</year>;<volume>29</volume>: <fpage>11</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tibs.2003.11.004" xlink:type="simple">10.1016/j.tibs.2003.11.004</ext-link></comment> <object-id pub-id-type="pmid">14729327</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mattick</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Amaral</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dinger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mercer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mehler</surname> <given-names>M</given-names></name>. <article-title>RNA regulation of epigenetic processes</article-title>. <source>Bioessays</source>. <year>2009</year>;<volume>31</volume>: <fpage>51</fpage>–<lpage>59</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/bies.080099" xlink:type="simple">10.1002/bies.080099</ext-link></comment> <object-id pub-id-type="pmid">19154003</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chang</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Smolke</surname> <given-names>C</given-names></name>. <article-title>Synthetic RNA switches as a tool for temporal and spatial control over gene expression</article-title>. <source>Curr Opin Biotechnol</source>. <year>2012</year>;<volume>23</volume>: <fpage>679</fpage>–<lpage>688</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.copbio.2012.01.005" xlink:type="simple">10.1016/j.copbio.2012.01.005</ext-link></comment> <object-id pub-id-type="pmid">22305712</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clever</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sassetti</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Parslow</surname> <given-names>T</given-names></name>. <article-title>RNA secondary structure and binding sites for gag gene products in the 5’packaging signal of human immunodeficiency virus type 1</article-title>. <source>J Virol</source>. <year>1995</year>;<volume>69</volume>: <fpage>2101</fpage>–<lpage>2109</lpage>. <object-id pub-id-type="pmid">7884856</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berkowitz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fisher</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Goff</surname> <given-names>S</given-names></name>. <article-title>RNA packaging</article-title>. <source>Morphog Matur retroviruses</source>. <year>1996</year>; <fpage>177</fpage>–<lpage>218</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004473.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mackereth</surname> <given-names>Cameron D.</given-names></name>, <etal>et al</etal>. <article-title>Multi-domain conformational selection underlies pre-mRNA splicing regulation by U2AF</article-title>. <source>Nature</source> <volume>475</volume>.<issue>7356</issue> (<year>2011</year>): <fpage>408</fpage>–<lpage>411</lpage>. <object-id pub-id-type="pmid">21753750</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cech</surname> <given-names>T</given-names></name>. <article-title>The ribosome is a ribozyme</article-title>. <source>Science</source>. <year>2000</year>;<volume>289</volume>: <fpage>878</fpage>–<lpage>879</lpage>. <object-id pub-id-type="pmid">10960319</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Winkler</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>Nahvi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Breaker</surname> <given-names>RR</given-names></name>. <article-title>Control of gene expression by a natural metabolite-responsive ribozyme</article-title>. <source>Nature</source>. <year>2004</year>;<volume>428</volume>: <fpage>281</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature02362" xlink:type="simple">10.1038/nature02362</ext-link></comment> <object-id pub-id-type="pmid">15029187</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mandal</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Barrick</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Weinberg</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Emilsson</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Ruzzo</surname> <given-names>WL</given-names></name>, <etal>et al</etal>. <article-title>A glycine-dependent riboswitch that uses cooperative binding to control gene expression</article-title>. <source>Science</source>. <year>2004</year>;<volume>306</volume>: <fpage>275</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1100829" xlink:type="simple">10.1126/science.1100829</ext-link></comment> <object-id pub-id-type="pmid">15472076</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lucks</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Qi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Whitaker</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>A</given-names></name>. <article-title>Toward scalable parts families for predictable design of biological circuits</article-title>. <source>Curr Opin Microbiol</source>. <year>2008</year>;<volume>11</volume>: <fpage>567</fpage>–<lpage>573</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.mib.2008.10.002" xlink:type="simple">10.1016/j.mib.2008.10.002</ext-link></comment> <object-id pub-id-type="pmid">18983935</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salmon</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Al-Hashimi</surname> <given-names>HMH</given-names></name>. <article-title>Advances in the determination of nucleic acid conformational ensembles</article-title>. <source>Annu Rev Phys Chem. Annual Reviews</source>. <year>2013</year>;<volume>0</volume>: <fpage>293</fpage>–<lpage>316</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev-physchem-040412-110059" xlink:type="simple">10.1146/annurev-physchem-040412-110059</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCaskill</surname> <given-names>JS</given-names></name>. <article-title>The equilibrium partition function and base pair binding probabilities for RNA secondary structure</article-title>. <source>Biopolymers</source>. <year>1990</year>;<volume>29</volume>: <fpage>1105</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/bip.360290621" xlink:type="simple">10.1002/bip.360290621</ext-link></comment> <object-id pub-id-type="pmid">1695107</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>CY</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name>. <article-title>RNA secondary structure prediction by centroids in a Boltzmann weighted ensemble</article-title>. <source>RNA</source>. <year>2005</year>;<volume>11</volume>: <fpage>1157</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1261/rna.2500605" xlink:type="simple">10.1261/rna.2500605</ext-link></comment> <object-id pub-id-type="pmid">16043502</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zuker</surname> <given-names>M</given-names></name>. <article-title>On finding all suboptimal foldings of an RNA molecule</article-title>. <source>Science</source>. <year>1989</year>;<volume>244</volume>: <fpage>48</fpage>–<lpage>52</lpage>. <object-id pub-id-type="pmid">2468181</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Westerhout</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Ooms</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vink</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Berkhout</surname> <given-names>B</given-names></name>. <article-title>HIV-1 can escape from RNA interference by evolving an alternative structure in its RNA genome</article-title>. <source>Nucleic Acids Res</source>. <year>2005</year>;<volume>33</volume>: <fpage>796</fpage>–<lpage>804</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gki220" xlink:type="simple">10.1093/nar/gki220</ext-link></comment> <object-id pub-id-type="pmid">15687388</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Villordo</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Alvarez</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Gamarnik</surname> <given-names>A V</given-names></name>. <article-title>A balance between circular and linear forms of the dengue virus genome is crucial for viral replication</article-title>. <source>RNA</source>. <year>2010</year>;<volume>16</volume>: <fpage>2325</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1261/rna.2120410" xlink:type="simple">10.1261/rna.2120410</ext-link></comment> <object-id pub-id-type="pmid">20980673</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reining</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nozinovic</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schlepckow</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Buhr</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Fürtig</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Schwalbe</surname> <given-names>H</given-names></name>. <article-title>Three-state mechanism couples ligand and temperature sensing in riboswitches</article-title>. <source>Nature</source>. <year>2013</year>;<volume>499</volume>: <fpage>355</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12378" xlink:type="simple">10.1038/nature12378</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pollard</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Salama</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Lambert</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lambot</surname> <given-names>M-A</given-names></name>, <name name-style="western"><surname>Coppens</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pedersen</surname> <given-names>JS</given-names></name>, <etal>et al</etal>. <article-title>An RNA gene expressed during cortical development evolved rapidly in humans</article-title>. <source>Nature</source>. <year>2006</year>;<volume>443</volume>: <fpage>167</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature05113" xlink:type="simple">10.1038/nature05113</ext-link></comment> <object-id pub-id-type="pmid">16915236</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ritz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Laederach</surname> <given-names>A</given-names></name>. <article-title>Evolutionary evidence for alternative structure in RNA sequence co-variation</article-title>. <source>PLoS Comput Biol. Public Library of Science</source>. <year>2013</year>;<volume>9</volume>: <fpage>e1003152</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003152" xlink:type="simple">10.1371/journal.pcbi.1003152</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Homan</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Favorov</surname> <given-names>O V</given-names></name>, <name name-style="western"><surname>Lavender</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Kursun</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Ge</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Busan</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Single-molecule correlated chemical probing of RNA</article-title>. <source>Proc Natl Acad Sci</source>. <year>2014</year>;<volume>111</volume>: <fpage>13858</fpage>–<lpage>13863</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1407306111" xlink:type="simple">10.1073/pnas.1407306111</ext-link></comment> <object-id pub-id-type="pmid">25205807</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Qu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>QQC</given-names></name>, <name name-style="western"><surname>Flynn</surname> <given-names>RRA</given-names></name>, <name name-style="western"><surname>Manor</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Ouyang</surname> <given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>Landscape and variation of RNA secondary structure across the human transcriptome</article-title>. <source>Nature</source>. <year>2014</year>;<volume>505</volume>: <fpage>706</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12946" xlink:type="simple">10.1038/nature12946</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Russell</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zhuang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Babcock</surname> <given-names>HP</given-names></name>, <name name-style="western"><surname>Millett</surname> <given-names>IS</given-names></name>, <name name-style="western"><surname>Doniach</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chu</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Exploring the folding landscape of a structured RNA</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2002</year>;<volume>99</volume>: <fpage>155</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.221593598" xlink:type="simple">10.1073/pnas.221593598</ext-link></comment> <object-id pub-id-type="pmid">11756689</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Al-Hashimi</surname> <given-names>H</given-names></name>. <article-title>NMR studies of nucleic acid dynamics</article-title>. <source>J Magn Reson</source>. <year>2013</year>;<volume>237</volume>: <fpage>191</fpage>–<lpage>204</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmr.2013.08.014" xlink:type="simple">10.1016/j.jmr.2013.08.014</ext-link></comment> <object-id pub-id-type="pmid">24149218</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mortimer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kidwell</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Doudna</surname> <given-names>J</given-names></name>. <article-title>Insights into RNA structure and function from genome-wide studies</article-title>. <source>Nat Rev Genet</source>. <year>2014</year>;<volume>15</volume>: <fpage>469</fpage>–<lpage>479</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg3681" xlink:type="simple">10.1038/nrg3681</ext-link></comment> <object-id pub-id-type="pmid">24821474</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kwok</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>. <article-title>In vivo genome-wide profiling of RNA secondary structure reveals novel regulatory features</article-title>. <source>Nature</source>. <year>2014</year>;<volume>505</volume>: <fpage>696</fpage>–<lpage>700</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12756" xlink:type="simple">10.1038/nature12756</ext-link></comment> <object-id pub-id-type="pmid">24270811</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Washietl</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hofacker</surname> <given-names>IL</given-names></name>, <name name-style="western"><surname>Stadler</surname> <given-names>PF</given-names></name>, <name name-style="western"><surname>Kellis</surname> <given-names>M</given-names></name>. <article-title>RNA folding with soft constraints: reconciliation of probing data and thermodynamic secondary structure prediction</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>; <fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks009" xlink:type="simple">10.1093/nar/gks009</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Cordero</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>. <article-title>A mutate-and-map strategy accurately infers the base pairs of a 35-nucleotide model RNA</article-title>. <source>RNA</source>. <year>2011</year>;<volume>17</volume>: <fpage>522</fpage>–<lpage>534</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1261/rna.2516311" xlink:type="simple">10.1261/rna.2516311</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>VanLang</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Cordero</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>. <article-title>A two-dimensional mutate-and-map strategy for non-coding RNA structure</article-title>. <source>Nat Chem</source>. <year>2011</year>;<volume>3</volume>: <fpage>954</fpage>–<lpage>962</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nchem.1176" xlink:type="simple">10.1038/nchem.1176</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tian</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cordero</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>. <article-title>High-throughput mutate-map-rescue evaluates SHAPE-directed RNA structure and uncovers excited states</article-title>. <source>RNA</source>. <year>2014</year>;<volume>20</volume>: <fpage>1815</fpage>–<lpage>1826</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1261/rna.044321.114" xlink:type="simple">10.1261/rna.044321.114</ext-link></comment> <object-id pub-id-type="pmid">25183835</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lorenz</surname> <given-names>R</given-names></name>. <article-title>ViennaRNA Package 2.0</article-title>. <source>Algorithms Mol Biol</source>. <year>2011</year>;<volume>6</volume>: <fpage>26</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1748-7188-6-26" xlink:type="simple">10.1186/1748-7188-6-26</ext-link></comment> <object-id pub-id-type="pmid">22115189</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deigan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Weeks</surname> <given-names>KM</given-names></name>. <article-title>Accurate SHAPE-directed RNA structure determination</article-title>. <source>Proc Natl Acad Sci</source> <year>2009</year>;<volume>106</volume>: <fpage>97</fpage>–<lpage>102</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0806929106" xlink:type="simple">10.1073/pnas.0806929106</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Höbartner</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Micura</surname> <given-names>R</given-names></name>. <article-title>Bistable secondary structures of small RNAs and their structural probing by comparative imino proton NMR spectroscopy</article-title>. <source>J Mol Biol</source>. <year>2003</year>;<volume>325</volume>: <fpage>421</fpage>–<lpage>431</lpage>. <object-id pub-id-type="pmid">12498793</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>M</given-names></name>. <article-title>RNA design rules from a massive open laboratory</article-title>. <source>Proc Natl Acad Sci</source>. <year>2014</year>;<volume>111</volume>: <fpage>2122</fpage>–<lpage>2127</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1313039111" xlink:type="simple">10.1073/pnas.1313039111</ext-link></comment> <object-id pub-id-type="pmid">24469816</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McDowell</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>D</given-names></name>. <article-title>A periodic table of tandem mismatches in RNA</article-title>. <source>Biochemistry</source>. <year>1995</year>;<volume>34</volume>: <fpage>3204</fpage>–<lpage>3211</lpage>. <object-id pub-id-type="pmid">7533535</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rivas</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>. <article-title>Secondary structure alone is generally not statistically significant for the detection of noncoding RNAs</article-title>. <source>Bioinformatics</source>. <year>2000</year>;<volume>16</volume>: <fpage>583</fpage>–<lpage>605</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/16.7.583" xlink:type="simple">10.1093/bioinformatics/16.7.583</ext-link></comment> <object-id pub-id-type="pmid">11038329</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ancel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Fontana</surname> <given-names>W</given-names></name>. <article-title>Plasticity, evolvability, and modularity in RNA</article-title>. <source>J Exp Zool</source>. <year>2000</year>;<volume>288</volume>: <fpage>242</fpage>–<lpage>283</lpage>. <object-id pub-id-type="pmid">11069142</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schultes</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Spasic</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mohanty</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Bartel</surname> <given-names>DP</given-names></name>. <article-title>Compact and ordered collapse of randomly generated RNA sequences</article-title>. <source>Nat Struct Mol Biol</source>. <year>2005</year>;<volume>12</volume>: <fpage>1130</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nsmb1014" xlink:type="simple">10.1038/nsmb1014</ext-link></comment> <object-id pub-id-type="pmid">16273104</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rocca-Serra</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bellaousov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Birmingham</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cordero</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Sharing and archiving nucleic acid structure mapping data</article-title>. <source>RNA</source>. <year>2011</year>;<volume>17</volume>: <fpage>1204</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1261/rna.2753211" xlink:type="simple">10.1261/rna.2753211</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cordero</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lucks</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>. <article-title>An RNA Mapping Database for curating RNA structure mapping experiments</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>3006</fpage>–<lpage>3008</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts554" xlink:type="simple">10.1093/bioinformatics/bts554</ext-link></comment> <object-id pub-id-type="pmid">22976082</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turner</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>DH</given-names></name>. <article-title>NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>. <source>Nucleic Acids Res</source>. <year>2010</year>;<volume>38</volume>: <fpage>D280</fpage>–<lpage>2</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkp892" xlink:type="simple">10.1093/nar/gkp892</ext-link></comment> <object-id pub-id-type="pmid">19880381</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref041"><label>41</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Seetin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Bida</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>. <chapter-title>Massively parallel RNA chemical mapping with a reduced bias MAP-seq protocol</chapter-title>. <source>Methods in Mol Biol, RNA Folding</source>. <publisher-name>Humana Press</publisher-name>; <year>2014</year>. pp. <fpage>95</fpage>–<lpage>117</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004473.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cordero</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>VanLang</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>. <article-title>The mutate-and-map protocol for inferring base pairs in structured RNA</article-title>. <source>Methods Mol Biol, RNA Folding. Humana Press</source>; <year>2014</year>;<volume>1086</volume>: <fpage>53</fpage>–<lpage>77</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-62703-667-2_4" xlink:type="simple">10.1007/978-1-62703-667-2_4</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yoon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hum</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>HiTRACE: high-throughput robust analysis for capillary electrophoresis</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>: <fpage>1798</fpage>–<lpage>1805</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr277" xlink:type="simple">10.1093/bioinformatics/btr277</ext-link></comment> <object-id pub-id-type="pmid">21561922</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Mann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Becka</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tian</surname> <given-names>S</given-names></name>. <article-title>Standardization of RNA chemical mapping experiments</article-title>. <source>Biochemistry</source>. <year>2014</year>;<volume>53</volume>: <fpage>3063</fpage>–<lpage>3065</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/bi5003426" xlink:type="simple">10.1021/bi5003426</ext-link></comment> <object-id pub-id-type="pmid">24766159</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Chou</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>. <article-title>Automated RNA structure prediction uncovers a kink-turn linker in double glycine riboswitches</article-title>. <source>J Am Chem Soc</source>. <year>2012</year>;<volume>134</volume>: <fpage>1404</fpage>–<lpage>1407</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja2093508" xlink:type="simple">10.1021/ja2093508</ext-link></comment> <object-id pub-id-type="pmid">22192063</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cordero</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kladwang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>VanLang</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>. <article-title>Quantitative dimethyl sulfate mapping for automated RNA secondary structure inference</article-title>. <source>Biochemistry</source>. <year>2012</year>;<volume>51</volume>: <fpage>7037</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/bi3008802" xlink:type="simple">10.1021/bi3008802</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004473.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sükösd</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Swenson</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Kjems</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Heitsch</surname> <given-names>CE</given-names></name>. <article-title>Evaluating the accuracy of SHAPE-directed RNA secondary structure predictions</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>2807</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks1283" xlink:type="simple">10.1093/nar/gks1283</ext-link></comment> <object-id pub-id-type="pmid">23325843</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reuter</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mathews</surname> <given-names>D</given-names></name>. <article-title>RNAstructure: software for RNA secondary structure prediction and analysis</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>: <fpage>129</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-11-129" xlink:type="simple">10.1186/1471-2105-11-129</ext-link></comment> <object-id pub-id-type="pmid">20230624</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>The EM algorithm for mixtures of factor analyzers</article-title>. <source>Tech Rep CRG-TR-96-1</source>. <year>1996</year>;<fpage>60</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004473.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rubin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Thayer</surname> <given-names>D</given-names></name>. <article-title>EM algorithms for ML factor analysis</article-title>. <source>Psychometrika</source>. <year>1982</year>;<volume>47</volume>: <fpage>69</fpage>–<lpage>76</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004473.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cordero</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yoon</surname> <given-names>S</given-names></name>. <article-title>HiTRACE-Web: an online tool for robust analysis of high-throughput capillary electrophoresis</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>W492</fpage>–<lpage>W498</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt501" xlink:type="simple">10.1093/nar/gkt501</ext-link></comment> <object-id pub-id-type="pmid">23761448</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref052"><label>52</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Lucks</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Mortimer</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Aviran</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schroth</surname> <given-names>GP</given-names></name>, <etal>et al</etal>. <chapter-title>Multiplexed RNA structure characterization with selective 2’-hydroxyl acylation analyzed by primer extension sequencing (SHAPE-Seq)</chapter-title>. <name name-style="western"><surname>Hage</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Meeus</surname> <given-names>M</given-names></name>, editors. <source>Proc Natl Acad Sci</source>. <year>2011</year>;<volume>108</volume>: <fpage>11063</fpage>–<lpage>11068</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1106501108" xlink:type="simple">10.1073/pnas.1106501108</ext-link></comment> <object-id pub-id-type="pmid">21642531</object-id></mixed-citation></ref>
<ref id="pcbi.1004473.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Belouchrani</surname> <given-names>A</given-names></name>. <article-title>A blind source separation technique using second-order statistics</article-title>. <source>Signal Processing</source>. <year>1997</year>;<volume>45</volume>: <fpage>434</fpage>–<lpage>444</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004473.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dahl</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Vandenberghe</surname> <given-names>L</given-names></name>. <article-title>Cvxopt: A python package for convex optimization</article-title>. <source>Proc eur conf op res</source>. <year>2006</year>;</mixed-citation></ref>
<ref id="pcbi.1004473.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kohn</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ansley</surname> <given-names>C</given-names></name>. <article-title>A fast algorithm for signal extraction, influence and cross-validation in state space models</article-title>. <source>Biometrika</source>. <year>1989</year>;<volume>76</volume>: <fpage>65</fpage>–<lpage>79</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004473.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wold</surname> <given-names>S</given-names></name>. <article-title>Cross-validatory estimation of the number of components in factor and principal components models</article-title>. <source>Technometrics</source>. <year>1978</year>;<volume>20</volume>: <fpage>397</fpage>–<lpage>405</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>