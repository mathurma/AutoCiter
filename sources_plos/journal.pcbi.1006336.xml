<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-02057</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006336</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Stem cells</subject><subj-group><subject>Cell potency</subject><subj-group><subject>Pluripotency</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>DNA-binding proteins</subject><subj-group><subject>Transcription factors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>Gene regulation</subject><subj-group><subject>Transcription factors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Regulatory proteins</subject><subj-group><subject>Transcription factors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Epigenetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Phenotypes</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Rare-event sampling of epigenetic landscapes and phenotype transitions</article-title>
<alt-title alt-title-type="running-head">Rare-event sampling of epigenetic landscapes and phenotype transitions</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Tse</surname> <given-names>Margaret J.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Chu</surname> <given-names>Brian K.</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gallivan</surname> <given-names>Cameron P.</given-names></name>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9186-284X</contrib-id>
<name name-style="western">
<surname>Read</surname> <given-names>Elizabeth L.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Chemical Engineering &amp; Materials Science, University of California, Irvine, Irvine, California, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Molecular Biology &amp; Biochemistry, University of California, Irvine, Irvine, California, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ioshikhes</surname> <given-names>Ilya</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Ottawa University, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">elread@uci.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>3</day>
<month>8</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>8</issue>
<elocation-id>e1006336</elocation-id>
<history>
<date date-type="received">
<day>9</day>
<month>12</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>29</day>
<month>6</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Tse et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006336"/>
<abstract>
<p>Stochastic simulation has been a powerful tool for studying the dynamics of gene regulatory networks, particularly in terms of understanding how cell-phenotype stability and fate-transitions are impacted by noisy gene expression. However, gene networks often have dynamics characterized by multiple attractors. Stochastic simulation is often inefficient for such systems, because most of the simulation time is spent waiting for rare, barrier-crossing events to occur. We present a rare-event simulation-based method for computing epigenetic landscapes and phenotype-transitions in metastable gene networks. Our computational pipeline was inspired by studies of metastability and barrier-crossing in protein folding, and provides an automated means of computing and visualizing essential stationary and dynamic information that is generally inaccessible to conventional simulation. Applied to a network model of pluripotency in Embryonic Stem Cells, our simulations revealed rare phenotypes and approximately Markovian transitions among phenotype-states, occurring with a broad range of timescales. The relative probabilities of phenotypes and the transition paths linking pluripotency and differentiation are sensitive to global kinetic parameters governing transcription factor-DNA binding kinetics. Our approach significantly expands the capability of stochastic simulation to investigate gene regulatory network dynamics, which may help guide rational cell reprogramming strategies. Our approach is also generalizable to other types of molecular networks and stochastic dynamics frameworks.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Cell phenotypes are controlled by complex interactions between genes, proteins, and other molecules within a cell, along with signals from the cell’s environment. Gene regulatory networks (GRNs) describe these interactions mathematically. In principle, a GRN model can produce a map of possible cell phenotypes and phenotype-transitions, potentially informing experimental strategies for controlling cell phenotypes. Such a map could have a profound impact on many medical fields, ranging from stem cell therapies to wound healing. However, analytical solution of GRN models is virtually impossible, except for the smallest networks. Instead, time course trajectories of GRN dynamics can be simulated using specialized algorithms. However, these methods suffer from the difficulty of studying rare events, such as the spontaneous transitions between cell phenotypes that can occur in Embryonic Stem Cells or cancer cells. In this paper, we present a method to expand current stochastic simulation algorithms for the sampling of rare phenotypes and phenotype-transitions. The output of the computational pipeline is a simplified network of a few stable phenotypes, linked by potential transitions with quantified probabilities. This simplified network gives an intuitive representation of cell phenotype-transition dynamics, which could be useful for understanding how molecular processes impact cellular responses and aid interpretation of experimental data.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>1715455</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9186-284X</contrib-id>
<name name-style="western">
<surname>Read</surname> <given-names>Elizabeth L.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>The research was supported in part by the National Science Foundation [<ext-link ext-link-type="uri" xlink:href="https://www.nsf.gov" xlink:type="simple">https://www.nsf.gov</ext-link> DMS 1715455 to ELR]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-08-15</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All software and data used to generate the figures and tables in this paper, including the supporting information, is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/Read-Lab-UCI/Rare-Event-Sampling-Gene-Networks" xlink:type="simple">https://github.com/Read-Lab-UCI/Rare-Event-Sampling-Gene-Networks</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLoS Computational Biology</italic> Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>In multicellular organisms, differentiation of pluripotent stem cells into tissue-specific cells was traditionally considered to be an irreversible process. The discovery of cell reprogramming revealed that the identity of a cell is not irreversibly stable, but rather plastic and amenable to control by perturbation of gene regulatory interactions—for example, through over-expression of key transcription factors [<xref ref-type="bibr" rid="pcbi.1006336.ref001">1</xref>]. Cellular plasticity has also been observed in other contexts, where cells appear to spontaneously transition among phenotypically distinct states. For example, in embryonic stem cells, expression levels of key transcription factors show dynamic heterogeneity, which is thought to enable diversification of the population prior to lineage commitment [<xref ref-type="bibr" rid="pcbi.1006336.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref006">6</xref>]. This heterogeneity may result at least in part from stochastic state-transitions between functionally distinct, metastable subpopulations [<xref ref-type="bibr" rid="pcbi.1006336.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref009">9</xref>]. Stochastic state-transitions have also been proposed to play a role in cancer, by enabling cancer stem cells to arise <italic>de novo</italic> from non-stem subpopulations [<xref ref-type="bibr" rid="pcbi.1006336.ref010">10</xref>], or by enabling cells to reversibly transition to a drug-tolerant phenotype [<xref ref-type="bibr" rid="pcbi.1006336.ref011">11</xref>]. In microbial systems, stochastic phenotype switching has been identified as a survival mechanism for populations subjected to fluctuating environments [<xref ref-type="bibr" rid="pcbi.1006336.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref013">13</xref>].</p>
<p>Mathematical modeling has provided a basis for understanding how gene regulatory mechanisms and network interactions control cellular identity, stability, and phenotype-transitions. These approaches yield a quantitative means of reinterpreting the long-standing conceptual framework known as Waddington’s epigenetic landscape [<xref ref-type="bibr" rid="pcbi.1006336.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref017">17</xref>]. In a mathematical framework, the “valleys” in the landscape that stabilize cell identities within distinct lineages correspond to attractor basins of a high-dimensional nonlinear dynamical system [<xref ref-type="bibr" rid="pcbi.1006336.ref018">18</xref>]. The nonlinearity results from positive feedback in transcriptional regulation and epigenetic barriers to chromatin remodeling, for example. These feedback mechanisms give rise to multiple, stable (or metastable) phenotype-states accessible to a given genome. Given the “bursty” nature of gene expression and ever-present molecular fluctuations in the cell [<xref ref-type="bibr" rid="pcbi.1006336.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref020">20</xref>], an active area of research is in modeling the effects of so-called intrinsic noise on gene regulatory network (GRN) dynamics. These mathematical models support the idea that intrinsic noise can drive stochastic phenotype-transitions [<xref ref-type="bibr" rid="pcbi.1006336.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref025">25</xref>], which, though likely to be exceedingly rare in general cellular contexts, may explain the heterogeneity observed in embryonic stem cells where epigenetic barriers appear to be lowered [<xref ref-type="bibr" rid="pcbi.1006336.ref026">26</xref>].</p>
<p>Mathematical models of GRN dynamics that treat stochastic molecular processes are often formulated as probabilistic Master Equations, in which the system evolves probabilistically over a discrete state-space of molecular species and configurations according to a defined set of biochemical reaction rules. Another common framework is that of a coupled system of ODEs describing the expression levels of genes in the network, with the inclusion of additive noise terms. The Master Equation framework is well-suited to studying how “local” stochastic molecular events (e.g., transcription factors interacting with DNA or chromatin state-transitions near promoters) impact “global” dynamics of phenotype stability and state-switching [<xref ref-type="bibr" rid="pcbi.1006336.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>]. These molecular fluctuations affecting promoter activity have been shown to significantly impact the structure of epigenetic landscapes, motivating the use of Master Equation-based approaches. That is, the number and stability of phenotype-states accessible to a given GRN varies depending on the kinetic parameters governing these fluctuations [<xref ref-type="bibr" rid="pcbi.1006336.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref029">29</xref>]. Furthermore, ODE or “mean-field” models that average over these fluctuations can show qualitatively different landscape features [<xref ref-type="bibr" rid="pcbi.1006336.ref030">30</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref032">32</xref>].</p>
<p>Master Equation approaches face the well-known challenge of the “Curse-of-Dimensionality”, as solving them requires enumeration of a state-space that grows exponentially with the number of molecular species in the network. For this reason, discrete stochastic models of GRNs are often studied by stochastic Monte Carlo simulation, via the Gillespie algorithm [<xref ref-type="bibr" rid="pcbi.1006336.ref033">33</xref>]. However, stochastic simulation can also be problematic: in systems with metastability, such as GRNs, stochastic simulation becomes highly inefficient. Transitions between metastable states are rare events (i.e., rare relative to the timescale of fluctuations within a metastable attractor basin), and thus difficult or impossible to observe. Often, these rare events are precisely the events of interest, such as in GRNs where infrequent state-transitions represent critical cell-fate transitions.</p>
<p>Rare-event sampling algorithms are designed to overcome these challenges, by redirecting computational resources towards events of interest, while maintaining statistical accuracy to global system dynamics [<xref ref-type="bibr" rid="pcbi.1006336.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref035">35</xref>]. In this work, we present a rare-event simulation-based method for computing and analyzing epigenetic landscapes of stochastic GRN models. We combine rare-event methods with coarse-graining and analysis by Transition Path Theory—adopted from the field of Molecular Dynamics of protein folding [<xref ref-type="bibr" rid="pcbi.1006336.ref036">36</xref>]–and show that this unified framework provides an automated approach to map epigenetic landscapes and transition dynamics in complex GRNs. The method quantifies the number of metastable phenotype-states accessible to a GRN, calculates the rates of transitioning among phenotypes, and computes the likely paths by which transitions among phenotypes occur. We apply the method to a model of pluripotency in mouse Embryonic Stem Cells. Our results reveal rare sub-populations and transitions in the network, demonstrate how global landscape structure depends on kinetic parameters, and reveal irreversibility in paths of differentiation and reprogramming. Our approach is not limited to gene regulatory networks; it is generalizable to other stochastic dynamics frameworks and is thus a potentially powerful tool for computing global dynamic landscapes in areas such as signal-transduction, population dynamics, and evolutionary dynamics.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>A graphical overview of the computational pipeline presented in this paper can be found in <xref ref-type="fig" rid="pcbi.1006336.g001">Fig 1</xref>.</p>
<fig id="pcbi.1006336.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006336.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Computational pipeline for rare-event sampling of epigenetic landscapes and phenotype transitions.</title>
<p>The input to the computational pipeline is a reaction network model of gene regulatory network dynamics. Stochastic simulations are performed using SSA [<xref ref-type="bibr" rid="pcbi.1006336.ref033">33</xref>] and Weighted Ensemble rare-event sampling [<xref ref-type="bibr" rid="pcbi.1006336.ref045">45</xref>]. The WE method can be run in two modes: <italic>Rate Mode</italic> computes the rate of transitioning between two user-defined regions of interest with high accuracy. <italic>Transition-Matrix Mode</italic> computes the pairwise transition probabilities among <italic>N</italic><sub>bins</sub> adaptively defined sampling bins that span the system state-space. Further visualization and analysis of the transition-matrix can be performed, including automatic designation of metastable phenotypes via the coarse-graining framework [<xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>] and identification of likely transition paths [<xref ref-type="bibr" rid="pcbi.1006336.ref036">36</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Gene regulatory network models</title>
<p>We demonstrate the rare-event sampling method for two representative GRN models. A small, two-gene network serves as a model system to validate the simulations. We then apply the method to a more complex model of pluripotency in mouse Embryonic Stem Cells (mESCs).</p>
<sec id="sec004">
<title>Exclusive mutual inhibition, self-activation model</title>
<p>The Exclusive Mutual Inhibition, Self-Activation (ExMISA) model is a two-gene network representing an archetypal motif at cell-fate branch points [<xref ref-type="bibr" rid="pcbi.1006336.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref038">38</xref>]. Each gene, denoted generically as <italic>A</italic> or <italic>B</italic>, encodes a transcription factor that activates its own transcription and represses transcription of the other gene. We adopt previous conventions [<xref ref-type="bibr" rid="pcbi.1006336.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref039">39</xref>] for stochastic GRN dynamic models. The full list of biochemical reactions and parameters can be found in the Supplement, <xref ref-type="supplementary-material" rid="pcbi.1006336.s001">S1 File</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006336.s004">S1 Table</xref>. The model encompasses stochastic birth/death processes for transcription factor production and degradation, and stochastic binding and unbinding of transcription factors to DNA regulatory/promoter regions; the binding-states of these regions governs the production rate. Each transcription factor is assumed to bind to DNA as a homodimer, giving cooperative regulation (explicit dimerization reactions are neglected, such that the transcription-factor-binding reaction is modeled as tri-molecular). In the “exclusive” network variant, transcription factors compete for binding sites on DNA (only one transcription factor dimer can be bound to a gene’s promoter at a time). The discrete state-vector, which completely describes the state of the system, is given by <bold>x</bold> = [<italic>A</italic><sub><italic>ij</italic></sub>, <italic>B</italic><sub><italic>ij</italic></sub>, <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>]. <italic>A</italic><sub><italic>ij</italic></sub> and <italic>B</italic><sub><italic>ij</italic></sub> represent the three possible promoter binding-states for each gene (i.e., <italic>A</italic>/<italic>B</italic><sub>00</sub>, <italic>A</italic>/<italic>B</italic><sub>10</sub>, <italic>A</italic>/<italic>B</italic><sub>01</sub> denote unbound, activator-bound, or repressor-bound states). The copy-numbers of expressed protein transcription factors are denoted by <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub> for products of gene <italic>A</italic> and <italic>B</italic>, respectively, and may in principle take any nonnegative integer value. All processes related to transcription, translation, and assembly are subsumed into a single protein birth reaction. For genes in state <italic>A</italic>/<italic>B</italic><sub><italic>ij</italic></sub>, this production occurs with rate constant <italic>g</italic><sub><italic>ij</italic></sub>. The production rate is high when the promoter is bound by the activator (its own product). Otherwise, if unbound or repressor-bound, a low “basal” rate of expression is assumed, i.e. <italic>g</italic><sub>00</sub> = <italic>g</italic><sub>01</sub> &lt; <italic>g</italic><sub>10</sub>. Degradation of protein products occurs with rate <italic>k</italic>, and stochastic binding/unbinding of transcription factors to DNA occur with <italic>h</italic> and <italic>f</italic>, respectively. The model is symmetric, with equivalent parameters for the two genes.</p>
<p>We studied a parameter set (<xref ref-type="supplementary-material" rid="pcbi.1006336.s004">S1 Table</xref>) in the regime of slow DNA-binding kinetics, in contrast to the so-called “adiabatic” regime where binding/unbinding of regulators to promoters occurs quickly relative to protein production and degradation. We adopt this regime here for two reasons. First, it has recently been suggested that the slow- or moderate-binding regime is likely to be more accurate in eukaryotic systems, where complex, slow-timescale changes in chromatin structure accompany binding events [<xref ref-type="bibr" rid="pcbi.1006336.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref040">40</xref>]. Second, the number of metastable states in GRNs appears to generally increase in the slow-binding regime, due to distinct combinations of relatively stable promoter configurations [<xref ref-type="bibr" rid="pcbi.1006336.ref041">41</xref>]. Therefore, this regime presents a test-case to develop enhanced sampling techniques that can efficiently traverse multiple system barriers and reconstruct complex, multi-modal dynamics.</p>
</sec>
<sec id="sec005">
<title>Pluripotency network model</title>
<p>The pluripotency network model of mESCs was developed by Zhang and Wolynes [<xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>] on the basis of experimental literature and previous models. The 8-gene network shares the same stochastic reaction framework as the ExMISA model. The genes (NANOG, OCT4, SOX2, GCNF, KLF4, PBX1, GATA6, and CDX2) suppress and activate each other through homo- and heterodimers of their encoded transcription factors (OCT4 and SOX2 form a heterodimer; all other regulatory interactions occur via homodimers). Binding of transcription factors to promoters is not exclusive. The model has five kinetic parameters: <italic>g</italic><sub>on</sub>, <italic>g</italic><sub>off</sub>, <italic>h</italic>, <italic>f</italic>, and <italic>k</italic>, corresponding to the rate of gene expression in the activated state, the rate of gene expression in the un-activated state, binding of transcription factors to DNA, unbinding of transcription factors from DNA, and transcription factor degradation (or exit from the nucleus). Genes are expressed at the basal rate <italic>g</italic><sub>off</sub> except when bound by at least one activator and no repressor, in which case they are expressed with rate <italic>g</italic><sub>on</sub>. The exception to this logic rule is NANOG, which must be bound by the the KLF4 and PBX1 transcription factor homodimers and the heterodimer OCT4-SOX2 to be activated. Overall, these interactions lead to a total of 396 biochemical reactions, with a total of 88 “species” (counting 80 distinct gene promoter configurations and 8 protein species). The complete logic rules and list of reaction rate parameters can be found in the Supplement (<xref ref-type="supplementary-material" rid="pcbi.1006336.s001">S1 File</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006336.s005">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006336.s006">S3</xref> Tables).</p>
</sec>
</sec>
<sec id="sec006">
<title>Theoretical background: The chemical master equation and stochastic transition-matrix</title>
<p>The mathematical framework of the network models is the discrete Chemical Master Equation (CME) [<xref ref-type="bibr" rid="pcbi.1006336.ref033">33</xref>], which gives the time-evolution of the probability to observe the system in a given state. In vector-matrix form, the CME can be written
<disp-formula id="pcbi.1006336.e001"><alternatives><graphic id="pcbi.1006336.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi mathvariant="bold">p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">K</mml:mi> <mml:mi mathvariant="bold">p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold>p</bold>(<bold>x</bold>, <italic>t</italic>) is the probability over the system state-space (<bold>x</bold>) at time <italic>t</italic>, and <bold>K</bold> is the reaction rate-matrix containing stochastic reaction propensities (diagonal elements <italic>k</italic><sub><italic>jj</italic></sub> = −∑<sub><italic>i</italic></sub> <italic>k</italic><sub><italic>ij</italic></sub>, i.e., columns sum to 0). <xref ref-type="disp-formula" rid="pcbi.1006336.e001">Eq 1</xref> assumes a well-mixed system of reacting species, and assumes that the technically infinite state-space described by <bold>x</bold> (containing molecular species numbers/configurations) may be limited to some finite number of “reachable” states, (i.e., with non-negligible probability) for an enumeration of <italic>N</italic> states of the system, <inline-formula id="pcbi.1006336.e002"><alternatives><graphic id="pcbi.1006336.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>×</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The steady-state probability <italic>π</italic>(<bold>x</bold>) ≡ <bold>p</bold>(<bold>x</bold>, <italic>t</italic> → ∞) over <italic>N</italic> states satisfies
<disp-formula id="pcbi.1006336.e003"><alternatives><graphic id="pcbi.1006336.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi> <mml:mo>π</mml:mo> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
Thus, <italic>π</italic>(<bold>x</bold>) can be obtained from <bold>K</bold> as the normalized right-eigenvector corresponding to the zero-eigenvalue.</p>
<p>It is sometimes desirable to work with the time-dependent stochastic transition-matrix <bold>T</bold>(<italic>τ</italic>) rather than the time-independent stochastic rate matrix <bold>K</bold> [<xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>]. For example, <bold>T</bold>(<italic>τ</italic>) may be more amenable to estimation by sampling (as we demonstrate in this work for the pluripotency network, for which <bold>K</bold> is impractical to enumerate). For a CME with rate matrix <bold>K</bold>, <bold>T</bold>(<italic>τ</italic>) is given by
<disp-formula id="pcbi.1006336.e004"><alternatives><graphic id="pcbi.1006336.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mrow><mml:mi mathvariant="bold">T</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:msup><mml:mi mathvariant="bold">K</mml:mi> <mml:mtext>T</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where exp denotes the matrix exponential. <inline-formula id="pcbi.1006336.e005"><alternatives><graphic id="pcbi.1006336.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi mathvariant="bold">T</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>x</mml:mi> <mml:mo>≤</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>×</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> then gives the conditional probability for the system to transition between each pair of states within a lagtime <italic>τ</italic>. That is, the elements <italic>T</italic><sub><italic>ij</italic></sub> give the probability that the system, if found in state <italic>i</italic>, will then be found in state <italic>j</italic> at a time <italic>τ</italic> later, and rows sum to 1. Using <bold>T</bold>(<italic>τ</italic>), the evolution of probability over discrete intervals of the lagtime <italic>τ</italic> is given by the Chapman-Kolmogorov equation:
<disp-formula id="pcbi.1006336.e006"><alternatives><graphic id="pcbi.1006336.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:msup><mml:mi mathvariant="bold">p</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>k</mml:mi> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi mathvariant="bold">p</mml:mi> <mml:mtext>T</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi mathvariant="bold">T</mml:mi> <mml:mi>k</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
Eigenvectors corresponding to dominant eigenvalues of the stochastic transition-matrix are associated with slow system processes. By Perron-Frobenius, for an irreducible stochastic matrix <bold>T</bold>(<italic>τ</italic>) with eigenvalues λ<sub><italic>i</italic></sub>, there exists λ<sub>1</sub> = 1, and all other eigenvalues satisfy |λ<sub><italic>i</italic></sub>| &lt; 1. Analogous to <xref ref-type="disp-formula" rid="pcbi.1006336.e003">Eq (2)</xref> for <bold>K</bold>, the steady-state probability can be obtained directly from <bold>T</bold>(<italic>τ</italic>) according to <italic>π</italic><sup><italic>T</italic></sup>(<bold>x</bold>) = <italic>π</italic><sup><italic>T</italic></sup>(<bold>x</bold>)<bold>T</bold>(<italic>τ</italic>), i.e., as the normalized left-eigenvector corresponding to λ<sub>1</sub>. Eigenvalues λ<sub><italic>i</italic></sub> are related to global system timescales <italic>t</italic><sub><italic>i</italic></sub> by
<disp-formula id="pcbi.1006336.e007"><alternatives><graphic id="pcbi.1006336.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mi>τ</mml:mi> <mml:mrow><mml:mtext>ln</mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
(with <italic>t</italic><sub>1</sub> giving the infinite-time, stationary result) [<xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>]. Additionally, the Mean First Passage Time for transitions from an individual state <italic>i</italic> to a region <italic>Y</italic> (MFPT<sub><italic>i</italic>,<italic>Y</italic></sub>, where <italic>Y</italic> may be an individual state or a set of states) can be computed using the matrix elements <italic>T</italic><sub><italic>i</italic>,<italic>j</italic></sub> by [<xref ref-type="bibr" rid="pcbi.1006336.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref044">44</xref>]:
<disp-formula id="pcbi.1006336.e008"><alternatives><graphic id="pcbi.1006336.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:msub><mml:mtext>MFPT</mml:mtext> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="right"><mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∉</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mtext>MFPT</mml:mtext> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="right"><mml:mrow><mml:mi>i</mml:mi> <mml:mo>∉</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
MFPT<sub><italic>i</italic>,<italic>Y</italic></sub> is defined as the expected time for the system to reach <italic>Y</italic> for the first time, having started in state <italic>i</italic>. The MFPTs may be computed by solving the linear system in <xref ref-type="disp-formula" rid="pcbi.1006336.e008">Eq 6</xref>. <xref ref-type="disp-formula" rid="pcbi.1006336.e008">Eq 6</xref> computes the MFPT as a dimensionless quantity, the expected number of “steps” (of duration <italic>τ</italic>) required for the transition; multiplication by <italic>τ</italic> gives the MFPT in units of time. The MFPT starting from a region <italic>X</italic> (i.e., a set of states, rather than an individual state) and ending in a region <italic>Y</italic> is given by the stationary-probability-weighted sum:
<disp-formula id="pcbi.1006336.e009"><alternatives><graphic id="pcbi.1006336.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:msub><mml:mtext>MFPT</mml:mtext> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>X</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:msub><mml:mo>π</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mtext>MFPT</mml:mtext> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>X</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mo>π</mml:mo> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula></p>
</sec>
<sec id="sec007">
<title>Weighted ensemble stochastic simulation</title>
<p>Stochastic reaction kinetics can be simulated by the Stochastic Simulation Algorithm (SSA) [<xref ref-type="bibr" rid="pcbi.1006336.ref033">33</xref>], which produces numerically exact realizations of the CME (<xref ref-type="disp-formula" rid="pcbi.1006336.e001">Eq 1</xref>). Simulation circumvents the need for enumerating the exceedingly large system state-spaces typical of gene network models, but suffers from inefficiency due to rare events. The Weighted Ensemble (WE) rare-event sampling algorithm [<xref ref-type="bibr" rid="pcbi.1006336.ref045">45</xref>] redistributes computational resources from high-probability regions of state-space to low-probability regions, which tend to be under-sampled in conventional simulation. The method thereby reduces computational effort in sampling rare transitions and improves accuracy of estimating probability density in, e.g., barrier-regions or tails of distributions. The method can be applied to any stochastic dynamics framework; in recent years, it has been widely applied to atom-scale Molecular Dynamics. Details of the methodology are discussed in a recent review [<xref ref-type="bibr" rid="pcbi.1006336.ref035">35</xref>] and references therein. Both WE and a related method, Forward Flux Sampling, have been applied previously to the study of 2-gene networks [<xref ref-type="bibr" rid="pcbi.1006336.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref047">47</xref>].</p>
<p>Briefly, the algorithm works as follows: state-space is divided up into bins that span transitions of interest. The number of bins, <italic>N</italic><sub>bins</sub>, is typically <inline-formula id="pcbi.1006336.e010"><alternatives><graphic id="pcbi.1006336.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>100</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and a variety of binning procedures can be used (we use an adaptive procedure described below). Initially, a single simulation trajectory, or “replica”, is assigned a weight of 1 and allowed to freely move within and between bins for a user-defined lagtime <italic>τ</italic><sub>WE</sub>. After each iteration of <italic>τ</italic><sub>WE</sub>, a splitting and culling procedure divides and/or combines replicas and their associated weights in such a way as to reach and maintain an equal target number of weighted replicas, <italic>M</italic><sub>targ</sub>, in each bin. Over the course of the simulation, the combined weights of the replicas in a bin (averaged over successive iterations) will evolve toward the probability of the system to reside in that bin. By maintaining the same number of replicas in each bin (<italic>M</italic><sub>targ</sub>), with weights proportional to probability, the algorithm devotes comparable computational time to low- and high-probability regions. Effectively, the algorithm computes long-time processes on the basis of many short-time simulated trajectories.</p>
<sec id="sec008">
<title>Adaptive binning procedure</title>
<p>As with other enhanced sampling methods, the WE algorithm requires dividing of state-space into defined sampling regions or “bins”. For high-dimensional systems, discretization poses a challenge because, for an <italic>N</italic>-dimensional, evenly spaced grid, the number of required sampling bins increases exponentially with the number of degrees of freedom. To address this challenge, a variety of Voronoi-polyhedra-based procedures have been developed [<xref ref-type="bibr" rid="pcbi.1006336.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref050">50</xref>]. These methods balance the need to focus simulation toward regions with non-negligible probability, while still enabling capture of rare transitions of interest. In addition to efficiently discretizing high-dimensional spaces, the methods have the benefit of requiring little to no <italic>a priori</italic> knowledge of system dynamics (e.g., of the locations of regions of interest, or of appropriate progress coordinates for transitions). We utilize an adaptive binning procedure from ref. [<xref ref-type="bibr" rid="pcbi.1006336.ref050">50</xref>]. Each bin (of user-defined number <italic>N</italic><sub>bins</sub>) is a Voronoi polyhedron with a generating node; the bin is defined as the region of state-space encompassing all points closer to the generating node than to nodes of any other region. After each lagtime <italic>τ</italic><sub>WE</sub>, new Voronoi regions are generated by successively selecting <italic>N</italic><sub>bins</sub> node-positions from the current replica positions in a way that maximizes the Euclidean distance between them. By this procedure, over the course of the simulation, bins spread to encompass all areas of state-space reached by any simulated trajectory. After sufficient iterations, the bin positions stop spreading to new areas but continue to fluctuate. The procedure is shown by representative simulations in <xref ref-type="supplementary-material" rid="pcbi.1006336.s011">S1 Fig</xref>.</p>
</sec>
<sec id="sec009">
<title>Computation of transition rates</title>
<p>One important output of WE sampling is the quantitative rate of transitions between regions of interest, which may be difficult or impossible to estimate from conventional simulation. WE sampling may be run in different modes, depending on whether the sought-after information concerns a specific transition of interest, or a more global picture of system dynamics, i.e., encompassing approximate rates of transitions among many system states. We term the two modes “rate” mode and “global transition-matrix” mode. The former can deliver a more accurate estimate for a particular state-transition, while the latter can yield a more comprehensive, but approximate, measure of global system dynamics.</p>
<p>In rate mode, the user specifies two regions of interest, <italic>X</italic> and <italic>Y</italic>, The flux of probability into/out of regions of interest can be estimated by recording the amount of weight transferred at the end of each simulation iteration. The mean first passage time of transitions from <italic>X</italic> to <italic>Y</italic> (MFPT<sub><italic>X</italic>,<italic>Y</italic></sub>) is given in general by the inverse of probability flux from <italic>X</italic> to <italic>Y</italic>. In practice, we apply a “labeling” scheme [<xref ref-type="bibr" rid="pcbi.1006336.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref052">52</xref>], where each replica is labeled as belonging to either set <inline-formula id="pcbi.1006336.e011"><alternatives><graphic id="pcbi.1006336.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1006336.e012"><alternatives><graphic id="pcbi.1006336.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>Y</mml:mi></mml:msub></mml:math></alternatives></inline-formula> according to its history, i.e., whether it most recently visited region <italic>X</italic> or <italic>Y</italic>, respectively. The summed weight of all replicas in <inline-formula id="pcbi.1006336.e013"><alternatives><graphic id="pcbi.1006336.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is given by <inline-formula id="pcbi.1006336.e014"><alternatives><graphic id="pcbi.1006336.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mi>P</mml:mi> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006336.e015"><alternatives><graphic id="pcbi.1006336.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>Y</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> satisfies probability conservation. Then,
<disp-formula id="pcbi.1006336.e016"><alternatives><graphic id="pcbi.1006336.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:msub><mml:mtext>MFPT</mml:mtext> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>Y</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mover><mml:mi>P</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:mrow> <mml:mtext>SS</mml:mtext></mml:msubsup> <mml:mrow><mml:msup><mml:mover><mml:mo>Φ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>SS</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where <inline-formula id="pcbi.1006336.e017"><alternatives><graphic id="pcbi.1006336.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msup><mml:mover><mml:mo>Φ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>SS</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the average probability flux from <inline-formula id="pcbi.1006336.e018"><alternatives><graphic id="pcbi.1006336.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula> into <italic>Y</italic> at steady-state, which is measured by the weight of <inline-formula id="pcbi.1006336.e019"><alternatives><graphic id="pcbi.1006336.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msub><mml:mi mathvariant="script">S</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula>-labeled replicas entering <italic>Y</italic> during the simulation after convergence to steady-state. The labeling scheme enables accurate estimates, including for non-Markovian transitions. For Markovian transitions well-described by a single rate-constant, <italic>k</italic><sub><italic>X</italic>,<italic>Y</italic></sub> = 1/MFPT<sub><italic>X</italic>,<italic>Y</italic></sub>.</p>
</sec>
<sec id="sec010">
<title>Computation of network transition-matrix</title>
<p>Running WE in transition-matrix mode enables visualization and analysis of global system dynamics on the basis of a single simulation, and requires no designation of regions of interest. In this mode, the previously-converged Voronoi bins are fixed, and simulations are used to estimate a coarse-grained stochastic transition-matrix <inline-formula id="pcbi.1006336.e020"><alternatives><graphic id="pcbi.1006336.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of size <italic>N</italic><sub>bins</sub> × <italic>N</italic><sub>bins</sub>. The coarse-grained <inline-formula id="pcbi.1006336.e021"><alternatives><graphic id="pcbi.1006336.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> approximates the true dynamics over the full state-space, as given by <bold>T</bold>(<italic>τ</italic>). Thus, the procedure enables estimation of the global transition-matrix (and subsequent analysis) in systems where enumeration of states is not feasible. To estimate <inline-formula id="pcbi.1006336.e022"><alternatives><graphic id="pcbi.1006336.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the weight transferred between bins is recorded at each iteration, and the elements of the transition-matrix are estimated according to [<xref ref-type="bibr" rid="pcbi.1006336.ref051">51</xref>]:
<disp-formula id="pcbi.1006336.e023"><alternatives><graphic id="pcbi.1006336.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
where 〈<italic>w</italic><sub><italic>i</italic>,<italic>j</italic></sub>〉<sub>2</sub> is the average weight transferred from bin <italic>i</italic> to bin <italic>j</italic> over the iteration time <italic>τ</italic><sub><italic>WE</italic></sub> (counting only after at least 2 transitions, and averaging over multiple iterations) and 〈<italic>w</italic><sub><italic>i</italic></sub>〉 is the average population (summed weight) in bin <italic>i</italic>. By construction, this is a row-stochastic transition-matrix with state-space “resolution” determined by <italic>N</italic><sub>bins</sub> (each state in the full state-space sampled by the simulation is assigned to its nearest neighboring Voronoi node). The lagtime <italic>τ</italic> of the transition-matrix corresponds to the sampled WE-time <italic>τ</italic><sub>WE</sub>. However, use of <inline-formula id="pcbi.1006336.e024"><alternatives><graphic id="pcbi.1006336.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to compute system dynamics imposes a Markovian approximation, by which equilibration of replicas within bins is assumed to be rapid on the timescale of <italic>τ</italic>, and hops between states (i.e. bins) are memoryless. As such, while this mode of simulation has the advantage of acquiring a holistic view of global system dynamics, it has the disadvantage of introducing a Markovian approximation.</p>
</sec>
</sec>
<sec id="sec011">
<title>Coarse-graining procedure to classify phenotype-states</title>
<p>While the sampled <italic>N</italic><sub>bins</sub> × <italic>N</italic><sub>bins</sub> transition-matrix provides a global approximation of the epigenetic landscape and state-transitions, we apply a method to further coarse-grain dynamics, known as the Markov State Model framework [<xref ref-type="bibr" rid="pcbi.1006336.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>]. This automated procedure produces a highly simplified representation of global dynamics in terms of a few (generally &lt; 10) clustered sets and the transitions among them. Such highly-reduced models can be beneficial in terms of human intuition of system dynamics, comparison to experiments, and—in this application—automated designation of dynamic phenotype-states. The method utilizes the concept of metastability, i.e., system states that experience relatively fast transitions among them are clustered together into the same coarse-grained set. Collectively, the coarse sets experience relatively rare inter-cluster transitions and frequent intra-cluster transitions. We employ the metastability concept as a definition of cell phenotype, reasoning that a phenotype should be a relatively stable attribute of a cell, and stochastic inter-phenotype transitions should be relatively rare. In practice, we employ the Markov State Model framework to further reduce the sampled row-stochastic transition-matrix <inline-formula id="pcbi.1006336.e025"><alternatives><graphic id="pcbi.1006336.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> from size <italic>N</italic><sub>bins</sub> × <italic>N</italic><sub>bins</sub> down to <italic>C</italic> × <italic>C</italic>, where <italic>C</italic> is the number of coarse-grained clusters chosen by the user. As the Markov State Model (MSM) is itself a stochastic transition-matrix on a coarse-grained space, it implies a more severe Markovian approximation. It provides a way to describe global system dynamics in a highly simplified way while maintaining high accuracy to the slowest system dynamics as sampled by <inline-formula id="pcbi.1006336.e026"><alternatives><graphic id="pcbi.1006336.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In previous work, we demonstrated the application of this coarse-graining approach to automatically designate phenotypes in small gene networks [<xref ref-type="bibr" rid="pcbi.1006336.ref029">29</xref>]; here, we extend the applicability of the coarse-graining to large, complex networks by combining it with rare-event sampling.</p>
<p>The coarse-graining procedure is a spectral clustering method based on the Perron Cluster Cluster Analysis (PCCA+) algorithm [<xref ref-type="bibr" rid="pcbi.1006336.ref053">53</xref>], which optimizes the (nearly)-block-diagonal structure of <inline-formula id="pcbi.1006336.e027"><alternatives><graphic id="pcbi.1006336.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for systems with metastability. The signature of such metastability is a separation-of-timescales for intra- and inter-basin dynamics, which may be seen as gaps in the eigenvalue spectrum [<xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>]. As noted above, <bold>T</bold>(<italic>τ</italic>) (or its sampled counterpart, <inline-formula id="pcbi.1006336.e028"><alternatives><graphic id="pcbi.1006336.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) has λ<sub>1</sub> = 1, corresponding to the infinite time-limit. If a set of <italic>m</italic> dominant eigenvalues exists, such that for decreasing eigenvalues λ<sub><italic>i</italic></sub> ⪅ 1, <italic>i</italic> ∈ {2,…, <italic>m</italic>}, and a gap is present, λ<sub><italic>j</italic></sub> ≪ λ<sub><italic>m</italic></sub> for <italic>j</italic> &gt; <italic>m</italic>, this indicates the presence of <italic>m</italic> slow-timescale processes in the system, and further indicates that <inline-formula id="pcbi.1006336.e029"><alternatives><graphic id="pcbi.1006336.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> may be re-ordered to give <italic>m</italic> nearly-uncoupled blocks. In practice, the algorithm attempts to find a coarse-graining onto <italic>C</italic> clusters, where <italic>C</italic> may be user-defined, or may be determined algorithmically, e.g., according to the spectral gap [<xref ref-type="bibr" rid="pcbi.1006336.ref053">53</xref>]. Here, we choose <italic>C</italic> clusters, where the last significant gap in the spectrum is seen between λ<sub><italic>C</italic></sub> and λ<sub><italic>C</italic>+1</sub>. For the GRNs studied here, this corresponds to choosing <italic>C</italic> such that λ<sub><italic>C</italic></sub>/λ<sub><italic>C</italic>+1</sub> &gt; 10.</p>
<sec id="sec012">
<title>Transition path analysis</title>
<p>The coarse-grained model of system dynamics given by the MSM enables estimation of the ensemble of dominant transition paths among phenotypes, along with their relative probabilities. We adopt methods from Transition Path Theory according to Noe, <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006336.ref036">36</xref>] (details therein). Briefly, <inline-formula id="pcbi.1006336.e030"><alternatives><graphic id="pcbi.1006336.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can be used to compute the effective flux of trajectories, along any edge in the coarse-grained network, contributing to transitions between states <italic>X</italic> and <italic>Y</italic> (where these designated states correspond to one or more coarse-grained phenotype-states produced by the MSM). A pathway decomposition algorithm on the matrix of effective fluxes for <italic>X</italic> → <italic>Y</italic> transitions then yields a set of dominant pathways and the relative contribution of each to the overall flux. Each state in the MSM is analogous to a cell phenotype, and transition path analysis is used to identify parallel phenotype transition paths and the relative rates of transitioning between phenotypes.</p>
</sec>
</sec>
<sec id="sec013">
<title>Visualization of epigenetic landscapes</title>
<p>Both the sampled transition-matrix <inline-formula id="pcbi.1006336.e031"><alternatives><graphic id="pcbi.1006336.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the coarse-grained MSM encode stationary and dynamic information about global dynamics—that is, they quantify the epigenetic landscape. For visualization, we use Gephi graph visualization software [<xref ref-type="bibr" rid="pcbi.1006336.ref054">54</xref>] using the Force Atlas algorithm. Every circle (or node) in the graph corresponds to a sampling bin or to a coarse-grained phenotype, and the area of a circle is proportional to its relative steady state probability according to ln(<italic>γP</italic><sub><italic>SS</italic></sub>), where <italic>P</italic><sub><italic>SS</italic></sub> is the steady state probability of the node and <italic>γ</italic> is a constant chosen to improve visibility of low probability regions of the landscape. Lines between circles (edges) correspond to transitions between sampling regions or coarse-grained phenotype. Their thickness and coloring correspond to their relative transition probability and source state, respectively.</p>
</sec>
<sec id="sec014">
<title>Validation: Numerical solution of the chemical master equation</title>
<p>To validate the simulation method, we compare the simulated dynamics to the numerical solution to the CME. We choose the parameters of the ExMISA model in such a way as to restrict the effective state-space, so that a numerical solution of the CME is tractable. Building the reaction rate matrix <inline-formula id="pcbi.1006336.e032"><alternatives><graphic id="pcbi.1006336.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>×</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> requires enumeration of <italic>N</italic> system states. In general, if a system of <italic>S</italic> molecular species has a maximum copy number per species of <italic>n</italic><sub><italic>max</italic></sub>, then <inline-formula id="pcbi.1006336.e033"><alternatives><graphic id="pcbi.1006336.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>≈</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. In the ExMISA model, the state-vector is given by <bold>x</bold> = [<italic>A</italic><sub><italic>ij</italic></sub>, <italic>B</italic><sub><italic>ij</italic></sub>, <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub>]. For enumeration, we neglect states with protein copy-numbers larger than a cutoff value which exceeds <italic>g</italic><sub>10</sub>/<italic>k</italic> (corresponding to the average number of transcription factors maintained in the system from a gene while in its active state). For example, with model parameters <italic>g</italic><sub>10</sub> = 18 and <italic>k</italic> = 1, we truncate at <italic>n</italic><sub><italic>a</italic>,<italic>max</italic></sub> = <italic>n</italic><sub><italic>b</italic>,<italic>max</italic></sub> = 41 and assume that probability flux between states with <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub> ≤ 41 and states with <italic>n</italic><sub><italic>a</italic></sub>, <italic>n</italic><sub><italic>b</italic></sub> &gt; 41 is assumed to be 0 (i.e., the boundaries of the state-space are reflective). Including the gene-binding states, this gives <italic>N</italic> = 3 × 3 × 42 × 42 = 15876 states. This size is tractable for complete solution of the CME using matrix methods in MATLAB [<xref ref-type="bibr" rid="pcbi.1006336.ref055">55</xref>]. This truncation of the state-space introduces a small approximation error (see <xref ref-type="supplementary-material" rid="pcbi.1006336.s012">S2 Fig</xref>).</p>
<p>The pluripotency network has 8 genes with copy numbers of <inline-formula id="pcbi.1006336.e034"><alternatives><graphic id="pcbi.1006336.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (determined by the parameters <italic>g</italic><sub><italic>on</italic></sub>/<italic>k</italic> = 3900). The number of distinct binding-promoter states for each gene are 16, 32, 8, 8, 2, 8, 4, and 2 for GATA6, NANOG, CDX2, OCT4, SOX2, KLF4, GCNF, PBX1, respectively (see <xref ref-type="supplementary-material" rid="pcbi.1006336.s005">S2 Table</xref>). Together these combinations enumerate a state-space of <italic>N</italic> &gt; 10<sup>30</sup> ≈ 1000<sup>8</sup> × 16 × 32 × 8 × 8 × 2 × 8 × 4 × 2. This size precludes solution of the CME, and we instead estimate the dynamics by WE sampling. Where possible, we validate the WE-sampling results by “conventional”, i.e., by direct simulation using SSA.</p>
<sec id="sec015">
<title>Validation of coarse-grained models</title>
<p>To check the validity of the coarse-grained MSM as a representation of the global dynamics, we use the Chapman-Kolmogorov test to compare the relaxation curves of the coarse-grained system to those found through direct SSA following <xref ref-type="disp-formula" rid="pcbi.1006336.e006">Eq 4</xref> [<xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>]. If the coarse-graining is appropriate, the relaxation curves of the MSM probabilities will match the relaxation profile of long conventional (direct SSA) simulations initiated within each coarse-grained phenotype. Transition paths through the coarse-grained phenotype network are validated, where possible, against conventional SSA simulation.</p>
</sec>
</sec>
<sec id="sec016">
<title>Implementation and software</title>
<p>Stochastic Gillespie (SSA) simulations were carried out using BioNetGen [<xref ref-type="bibr" rid="pcbi.1006336.ref056">56</xref>]. WE sampling was implemented with in-house software code written in MATLAB. Simulations were run on the high performance computing cluster (HPC) at the University of California, Irvine, and parallelization of BioNetGen SSA simulations was performed using the Sun Grid Engine scheduler. The coarse-graining procedure and transition path analysis was implemented in python scripts, adapted from MSMBuilder [<xref ref-type="bibr" rid="pcbi.1006336.ref057">57</xref>] and Pyemma [<xref ref-type="bibr" rid="pcbi.1006336.ref043">43</xref>], respectively. Transition-matrix and MSM visualization was carried out using Gephi software and the Force Atlas layout [<xref ref-type="bibr" rid="pcbi.1006336.ref054">54</xref>]. All simulation parameters can be found in the supplement <xref ref-type="supplementary-material" rid="pcbi.1006336.s007">S4 Table</xref>. Pseudo-code for the adaptive binning procedure can be found in <xref ref-type="supplementary-material" rid="pcbi.1006336.s002">S2 File</xref> and software can be found in <ext-link ext-link-type="uri" xlink:href="https://github.com/Read-Lab-UCI/Rare-Event-Sampling-Gene-Networks" xlink:type="simple">https://github.com/Read-Lab-UCI/Rare-Event-Sampling-Gene-Networks</ext-link>.</p>
</sec>
</sec>
<sec id="sec017" sec-type="results">
<title>Results</title>
<sec id="sec018">
<title>Rare states and transitions in gene regulatory networks are accessible by rare-event sampling</title>
<p>We first apply the computational pipeline to a small two-gene model (the exclusive Mutual Inhibition, Self-Activation model, ExMISA, see <xref ref-type="sec" rid="sec002">Methods</xref>), exhibiting an archetypal motif for cell fate-decisions [<xref ref-type="bibr" rid="pcbi.1006336.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref038">38</xref>]. The model is tractable for computation of full, discrete stochastic dynamics to within a small approximation error using matrix methods. Thus, the model provides a numerical benchmark for assessing the accuracy of the simulation method, before extension to larger systems where solution of the Chemical Master Equation (CME) is intractable. For the chosen parameters, the ExMISA model shows four peaks in the steady-state probability distribution (projected onto protein copy numbers, <italic>n</italic><sub><italic>a</italic></sub> and <italic>n</italic><sub><italic>b</italic></sub>). Peaks in probability correspond to basins in the so-called quasipotential landscape, defined by <italic>U</italic> = −ln(<italic>π</italic>(<bold>x</bold>)) (<xref ref-type="fig" rid="pcbi.1006336.g002">Fig 2</xref>). The four peaks/basins corresponds to four possible combinations of binarized <italic>A</italic>/<italic>B</italic> gene expression: hi/hi, hi/lo, lo/hi, and lo/lo. These four phenotype-states arise due to the combination of balanced repression and self-activation in the network, and the slow kinetic parameters (Supplementary <xref ref-type="supplementary-material" rid="pcbi.1006336.s004">S1 Table</xref>) for transcription factor binding and unbinding to promoters that effect changes in individual gene-activity states between low and high expression rates [<xref ref-type="bibr" rid="pcbi.1006336.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref058">58</xref>].</p>
<fig id="pcbi.1006336.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006336.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Simulation results show good agreement with a theoretical benchmark for the 2-gene ExMISA (mutual inhibition, self-activation) cell-decision circuit.</title>
<p>The Chemical Master Equation for the 2-gene model, ExMISA, was solved numerically (see <xref ref-type="sec" rid="sec002">Methods</xref>) (top) and compared to simulation results from the computational pipeline presented in this paper (bottom). Shown for each are the Quasipotential Landscape (A), Eigenvalue Spectrum (B), and Markov State Model (C). (A) Quasipotential landscapes of the ExMISA network projected onto the two protein coordinates. Deep blue regions denote low potential (high probability) and yellow denote high potential (low probability). The four visible basins in both correspond to combinations of lo/hi expression for the two genes <italic>A</italic> and <italic>B</italic>. (For both rows, quasipotential surfaces estimated over discrete states/bins are smoothed for visualization). WE sampling captured both the basin structure and low probability edge and barrier regions. (B) Eigenvalue spectra and corresponding computed global transition timescales. Gaps in the eigenvalue spectrum indicate separation of timescales, i.e., the presence of metastability. C) Four-phenotype coarse-grained models automatically generated from the clustering algorithm (see <xref ref-type="sec" rid="sec002">Methods</xref>). Each colored circle represents a cell phenotype, sized proportionally to its probability. Edges are inter-phenotype transitions (colored by source-state, with width proportional to probability). The full CME and simulation pipeline identify similar metastable phenotype networks (see <xref ref-type="supplementary-material" rid="pcbi.1006336.s021">S11 Fig</xref> for details).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.g002" xlink:type="simple"/>
</fig>
<p>The WE-based simulation method enabled estimation of global dynamics of the ExMISA model. By redistributing computational resources from relatively high-probability to low-probability regions (see <xref ref-type="sec" rid="sec002">Methods</xref>), the WE method enabled uniform sampling of the quasipotential landscape, i.e., mapping basins (high-probability regions) along with high barriers (low probability regions) (<xref ref-type="fig" rid="pcbi.1006336.g002">Fig 2a</xref>). The simulation estimated individual steady-state bin-probabilities as low as 1.3 × 10<sup>−6</sup> and showed good global agreement with the numerical CME benchmark (see <xref ref-type="fig" rid="pcbi.1006336.g002">Fig 2</xref> and Supplement, <xref ref-type="supplementary-material" rid="pcbi.1006336.s013">S3 Fig</xref>).</p>
<p>In addition to sampling global dynamics, the WE method can be used to estimate rate constants for individual, rare transitions of interest. The Mean First Passage Time of the global network switch from the center of one polarized phenotype-state to another, i.e., MFPT<sub><italic>X</italic>→<italic>Y</italic></sub> from protein a/b expression level hi/lo to lo/hi was estimated from WE to be 1.82 × 10<sup>5</sup> (units of <italic>k</italic><sup>−1</sup>) (see <xref ref-type="supplementary-material" rid="pcbi.1006336.s009">S6 Table</xref>), in agreement with the CME result.</p>
</sec>
<sec id="sec019">
<title>Phenotype transitions can be approximated by Markovian jumps, enabling construction of coarse-grained models</title>
<p>A network transition-matrix <inline-formula id="pcbi.1006336.e035"><alternatives><graphic id="pcbi.1006336.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> over sampled bins (<italic>N</italic><sub>bins</sub> = 300) was constructed from WE sampling for ExMISA and used for subsequent analysis of global system dynamics. By comparison, a full network transition-matrix <bold>T</bold>(<italic>τ</italic>) over the enumerated system state-space was constructed from the CME (<italic>N</italic> = 15876, see <xref ref-type="sec" rid="sec002">Methods</xref>). The full, computed (<bold>T</bold>(<italic>τ</italic>)) and simulated (<inline-formula id="pcbi.1006336.e036"><alternatives><graphic id="pcbi.1006336.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) transition-matrices showed qualitatively similar eigenvalue spectra with four dominant eigenvalues, indicating the presence of metastability (separation-of-timescales between intra-basin and inter-basin transitions) (<xref ref-type="fig" rid="pcbi.1006336.g002">Fig 2b</xref>). The slow system-timescales predicted by the full CME model corresponding to eigenvalues λ<sub>2</sub>, λ<sub>3</sub>, λ<sub>4</sub> were <italic>t</italic><sub>2</sub>, <italic>t</italic><sub>3</sub>, <italic>t</italic><sub>4</sub> = 6.8 × 10<sup>4</sup>, 4.2 × 10<sup>4</sup>, 1.0 × 10<sup>4</sup> respectively, in units of <italic>k</italic><sup>−1</sup> where <italic>k</italic> is the protein degradation rate (the Perron eigenvalue λ<sub>1</sub> = 1 is associated with the infinite-time (stationary) distribution). The corresponding values given by the WE-simulated <inline-formula id="pcbi.1006336.e037"><alternatives><graphic id="pcbi.1006336.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> were 6.1 × 10<sup>4</sup>, 3.5 × 10<sup>4</sup>, 9.4 × 10<sup>3</sup>, respectively. These numbers demonstrate how the sampled <inline-formula id="pcbi.1006336.e038"><alternatives><graphic id="pcbi.1006336.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> enables global approximation of slow system timescales to &lt; 20% relative error. Error in these values (relative to the slowest timescales implied by the true eigenvalues) depends on both “spectral” (lagtime) and discretization error, i.e., improvements can be achieved only with a larger number of bins (finer discretization) and/or longer lagtime [<xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>] (see <xref ref-type="supplementary-material" rid="pcbi.1006336.s014">S4 Fig</xref>). In contrast, WE sampling in “rate mode” (see <xref ref-type="sec" rid="sec002">Methods</xref>) enabled highly accurate estimation of MFPT<sub><italic>X</italic>→<italic>Y</italic></sub> to within 2% error (<xref ref-type="supplementary-material" rid="pcbi.1006336.s009">S6 Table</xref>).</p>
<p>According to the Markov State Model framework, the presence of timescale separation indicates that a simplified model, retaining a few coarse-grained metastable states with Markovian transitions among them, can reasonably approximate the full system dynamics. Using this approach, we label the metastable sets as <italic>phenotypes</italic> accessible to the network, reasoning that a useful classification of cell phenotypes should be one that gives relatively stable, rather than transient, cell types. We apply the Markov State Model coarse-graining procedure to both the full <bold>T</bold>(<italic>τ</italic>) and simulated <inline-formula id="pcbi.1006336.e039"><alternatives><graphic id="pcbi.1006336.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, yielding similar results. The coarse sets (or metastable phenotype-states) in the reduced models for both cases are generated automatically, and map directly onto the four basins seen in the quasipotential landscape (i.e., the gene <italic>A</italic>/<italic>B</italic> expression hi/hi, hi/lo, lo/hi, and lo/lo cell phenotypes). The reduced models are visualized by network graphs, in which node sizes are proportional to steady-state probability, and the thicknesses and lengths of edges are proportional to the transition probability between them (on lagtime <italic>τ</italic>) (<xref ref-type="fig" rid="pcbi.1006336.g002">Fig 2c</xref>). Some discrepancies can be seen visually in the network graphs. These discrepancies likely result in part from the slightly different mappings of the full state-space onto the four clusters (see <xref ref-type="supplementary-material" rid="pcbi.1006336.s021">S11 Fig</xref> for details), which could in turn result from the distance-metric-based binning, which is relatively insensitive to changes in promoter configuration. Numerical values for the reduced models can be found in <xref ref-type="supplementary-material" rid="pcbi.1006336.s008">S5 Table</xref>. The network graph can be considered to be an alternative representation of the global epigenetic landscape, which contains both stationary and dynamic information. (In contrast, the epigenetic landscape plotted as a quasipotential function does not explicitly contain dynamic information, due to non-gradient dynamics [<xref ref-type="bibr" rid="pcbi.1006336.ref016">16</xref>]).</p>
<p>Validation of the coarse-grained model can be carried out according to the Chapman-Kolmogorov test [<xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>], which tests how well the relaxation dynamics initialized in the metastable phenotypes approximate the dynamics that are predicted either by the full model (CME) or simulated trajectories. According to this test, relaxation dynamics out of metastable phenotypes from WE sampling was predicted with relative error values between 0.02 and 0.12 for all phenotypes (<xref ref-type="supplementary-material" rid="pcbi.1006336.s015">S5 Fig</xref>). Together, these results indicate (i) that a Markovian model of phenotype transitions is a good approximation of the full system dynamics for the ExMISA model, and (ii) that the WE-simulation based computational pipeline predicts a quantitatively similar coarse-grained phenotype-network to the full CME model.</p>
</sec>
<sec id="sec020">
<title>The method maps the epigenetic landscape and identifies dominant phenotypes in a pluripotency network model</title>
<p>We apply the computational pipeline to a pluripotent fate-decision network from mouse Embryonic Stem Cells (mESCs) introduced by Zhang <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>] (<xref ref-type="fig" rid="pcbi.1006336.g003">Fig 3A</xref>). The network comprises eight interacting genes: NANOG, GATA6, CDX2, SOX2, OCT4, GCNF, and PBX1. Three of these genes, NANOG, SOX2, and OCT4 have been suggested to maintain pluripotency [<xref ref-type="bibr" rid="pcbi.1006336.ref059">59</xref>], and NANOG inhibits the expression of differentiation markers [<xref ref-type="bibr" rid="pcbi.1006336.ref060">60</xref>]. The GATA6 and CDX2 genes have been used in experiments as markers of differentiation, with the GATA6 transcription factor being a marker of the primitive endoderm cell lineage, and the CDX2 transcription factor being a marker of the trophectoderm lineage [<xref ref-type="bibr" rid="pcbi.1006336.ref061">61</xref>].</p>
<fig id="pcbi.1006336.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006336.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Pluripotency network model and simulation results (Parameter Set I).</title>
<p>A)Wiring diagram for the eight-gene pluripotency network model, adapted from [<xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>]. Arrowheads represent positive interactions, while flat lines denote repression. B) Simulation results: state-transition graph of sampled network states. Circles represent aggregate gene-expression states sampled during the Weighted Ensemble simulation. Circle areas are proportional to the steady-state probability <italic>π</italic><sub><italic>i</italic></sub> in each state according to ln(<italic>γπ</italic><sub><italic>i</italic></sub>) with scaling factor <italic>γ</italic> = 3.4. States are colored according to the gene expression levels of three of the genes; red, green, and blue correspond to high NANOG, GATA6, and CDX2 expression respectively, while black corresponds to low or no gene expression. Edges connecting the states indicate possible state-transitions, colored according to the originating state. The graph is produced using Gephi [<xref ref-type="bibr" rid="pcbi.1006336.ref054">54</xref>] using a force-directed layout algorithm (Force Atlas), therefore short inter-state distances reflect higher probability of transitioning. C) Full protein compositions of two representative states, with either high CDX2 expression (blue) or high NANOG expression (red). States in (C) correspond to yellow circles in (B).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.g003" xlink:type="simple"/>
</fig>
<p>Using the WE-based computational pipeline, we estimate <inline-formula id="pcbi.1006336.e040"><alternatives><graphic id="pcbi.1006336.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with a resolution of <italic>N</italic><sub>bins</sub> = 250. To visualize the global landscape as a graph network at this resolution, we plot the converged <inline-formula id="pcbi.1006336.e041"><alternatives><graphic id="pcbi.1006336.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> using a force-directed automated graph layout [<xref ref-type="bibr" rid="pcbi.1006336.ref054">54</xref>] (<xref ref-type="fig" rid="pcbi.1006336.g003">Fig 3B</xref>). The barbell shape of the network reflects the broad antagonism between pluripotency and differentiation genes, which is a general feature of the overall network topology. At the same time, each “pole” comprises multiple distinct patterns of gene expression (seen in the graph as different colors with full compositions in <xref ref-type="fig" rid="pcbi.1006336.g003">Fig 3C</xref>), hinting at the existence of multiple phenotypes associated with both pluripotency and lineage-specification. Moreover, the network representation reveals numerous links between pluripotent and differentiated states, pointing to both direct and indirect transitions, through a network of relatively transient intermediate states.</p>
<p>To further analyze the global dynamics of the pluripotency network, we apply the Markov State Model coarse-graining framework. The simulated <inline-formula id="pcbi.1006336.e042"><alternatives><graphic id="pcbi.1006336.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> shows gaps in the eigenvalue spectrum after four and after six eigenvalues (<xref ref-type="fig" rid="pcbi.1006336.g004">Fig 4a</xref>). The corresponding approximate timescales are given by <italic>t</italic><sub>2</sub>, <italic>t</italic><sub>3</sub>, <italic>t</italic><sub>4</sub>, <italic>t</italic><sub>5</sub>, <italic>t</italic><sub>6</sub> = 1.1 × 10<sup>5</sup>, 95, 51, 12, 12 (<italic>k</italic><sup>−1</sup>), respectively. These values, though only approximate, indicate the presence of a single long timescale process (<italic>t</italic><sub>2</sub>) corresponding to transfer between differentiated and pluripotent states, while transitions within those basins (<italic>t</italic><sub>3</sub>, etc.) occur at least four orders of magnitude more quickly. Applying the coarse-graining algorithm to achieve six clusters results in a reduced model (<xref ref-type="fig" rid="pcbi.1006336.g004">Fig 4b</xref>), with the clusters representing metastable phenotypes. The phenotypes can largely be distinguished in the subspace of NANOG, GATA6, and CDX2 expression levels; the differentiated phenotypes show expression of either GATA6 (primitive endoderm, PE), CDX2 (trophectoderm, TE), or both (denoted an intermediate cell type, IM). Phenotypes associated with pluripotency do not express high levels of GATA6 or CDX2, and may express high levels of NANOG (stem cell, SC). The coarse-grained model reveals two separate pluripotent phenotypes that are low in NANOG expression: one which expresses other pluripotent factors OCT4, SOX2, and KLF4 (“Low NANOG 1” LN1), and one which has low expression of all factors (“Low NANOG 2” LN2) (<xref ref-type="fig" rid="pcbi.1006336.g004">Fig 4c</xref>). Overall, these phenotypes broadly match experimentally-determined categories, coincide with steady-states of the stochastic model computed previously by a CME-approximation method [<xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>], and coincide with phenotype-states identified in related pluripotency GRN models [<xref ref-type="bibr" rid="pcbi.1006336.ref062">62</xref>]. The steady-state probabilities associated with the phenotypes are highly nonuniform, with 95% of the population divided nearly evenly between the IM and LN1 phenotypes, which are associated with differentiation and pluripotency, respectively. The LN2 state is rarest, comprising only 8 × 10<sup>−4</sup>% of the population, and was not identified previously [<xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>]. Together, these results indicate that the clustering method identifies both common and exceedingly rare phenotypes in the <italic>in silico</italic> cell population modeled by simulation trajectories. Furthermore, the automated method identifies both expected phenotypes and one novel (albeit low probability) phenotype.</p>
<fig id="pcbi.1006336.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006336.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Simulation results for the pluripotency network (Parameter Set I).</title>
<p><bold>The Computational Pipeline Uncovers Six Metastable Phenotypes and Irreversible Phenotype Transitions</bold>. A) Computed eigenvalue spectrum and global timescales indicating the presence of metastability in the network. The gap in the eigenvalue spectrum after the sixth eigenvalue suggests that a partitioning can be found into six metastable phenotypes. B) The coarse-grained network showing six algorithmically-identified phenotypes designated as Low NANOG 1 (LN1), Low NANOG 2 (LN2), Stem Cell (SC), Primitive Endoderm (PE), Trophectoderm (TE), and the Intermediate Cell (IM) state. C) The averaged gene expression levels (copy numbers) of each transcription factor for each phenotype and their respective steady-state probabilities. D) The four most probable transition pathways from the SC state to the TE state (differentiation) and from the TE state to the SC state (dedifferentiation). E) The highest probability transition paths projected onto three protein coordinates, NANOG, GATA6, and CDX2. Differentiation from SC to TE is visibly irreversible, i.e., the system returns by a separate route.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec021">
<title>The method reveals multiple, irreversible pathways for phenotype transitions in the pluripotency network</title>
<p>Previously, Markov State Models constructed on the basis of Molecular Dynamics simulations were used to analyze the ensemble of distinct pathways of protein-folding [<xref ref-type="bibr" rid="pcbi.1006336.ref036">36</xref>]. Here, we utilize the coarse-grained model of phenotype transitions in the pluripotency GRN in a similar manner, to analyze pathways of cell differentiation and dedifferentiation. Using Transition Path Theory, the method identifies the pathways that carry the greatest fraction of net probability flux, among sequences associated with successful SC→TE transitions (and reverse) (<xref ref-type="fig" rid="pcbi.1006336.g004">Fig 4d and 4e</xref>). Transition paths between the stem cell (SC) and PE phenotypes can be found in <xref ref-type="supplementary-material" rid="pcbi.1006336.s016">S6 Fig</xref>. For Parameter Set I, the method identifies three pathways encompassing &gt; 98% of the probability flux for both forward and reverse transitions. While the SC→ TE transition is most likely to occur directly through the LN1 state (i.e., NANOG expression will shut off, followed by turning on CDX2), the reverse transition shows a different route through the IM and PE states (i.e., GATA6 expression turns on, then CDX2 turns off, then GATA6 turns off, and finally NANOG turns on).</p>
<p>Dynamic analysis of the coarse-grained model, including analysis of transition paths, relies on the Markovian approximation for inter-phenotype transitions. In the pluripotency network, stochastic transitions between pluripotency (SC, LN1, LN2) and differentiation (TE, IM, PE) basins are infrequent relative to transitions within those basins, justifying the Markovian assumption, since the system equilibrates within those basins much more rapidly than inter-basin transitions occur. However, the Markovian assumption may be less accurate for describing intra-basin transitions between phenotypes, which occur much more frequently. Despite the coarse-grained model encompassing transitions on highly disparate timescales, the qualitative results of transition path analysis were validated by collected conventional simulation trajectories (not subject to any Markovian assumption), which identified the same dominant transition paths (<xref ref-type="supplementary-material" rid="pcbi.1006336.s017">S7 Fig</xref>). Overall, these results indicate that a stochastic excursion of a cell from the SC to TE phenotypes and back maps a cycle in gene-expression space, echoing previous studies indicating nonequilibrium dynamics in GRNs [<xref ref-type="bibr" rid="pcbi.1006336.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref023">23</xref>]. The results further indicate that the Markov State Model, while a highly coarse-grained approximation, can provide an accurate estimation of inter-phenotype transition dynamics.</p>
</sec>
<sec id="sec022">
<title>Cell phenotype landscape and transition dynamics are sensitive to kinetic parameters</title>
<p>We applied the computational pipeline to the pluripotency network using two different rate parameters sets (see <xref ref-type="supplementary-material" rid="pcbi.1006336.s001">S1 File</xref>), which differ in rates of transcription factor binding and unbinding to DNA. In line with previous studies [<xref ref-type="bibr" rid="pcbi.1006336.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref029">29</xref>], we found that increasing the so-called adiabaticity (i.e., increasing <italic>h</italic> and <italic>f</italic>, or the rates of TF-binding relative to protein production and degradation, Parameter Set II) led generally to rarer inter-phenotype transitions (see <xref ref-type="table" rid="pcbi.1006336.t001">Table 1</xref>). For example, in Parameter Set I, the Mean First Passage Time (MFPT) for transitions from SC → TE was calculated to be 1.36 × 10<sup>5</sup> in units of <italic>k</italic><sup>−1</sup>, as compared to 8.13 × 10<sup>8</sup> for Parameter Set II. The MFPTs of the reverse transition TE → SC for each set were 2.70 × 10<sup>5</sup> and 5.82 × 10<sup>9</sup>, respectively (see <xref ref-type="table" rid="pcbi.1006336.t001">Table 1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006336.s010">S7 Table</xref>). These differences in magnitude broadly reflect that moving toward the adiabatic regime leads to increased epigenetic barriers between phenotypes.</p>
<table-wrap id="pcbi.1006336.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006336.t001</object-id>
<label>Table 1</label>
<caption>
<title>Computed mean first passage times (MFPTs) of phenotype transitions in the pluripotency network.</title>
<p>MFPTs are shown for transitions between the pluripotency (high NANOG) state (SC) and low NANOG expression states (LN(1)) (left columns) and for transitioning between the pluripotency state (SC) and the trophectoderm state (TE) (right columns), in units of the inverse transcription factor decay rate, <italic>k</italic><sup>−1</sup>. Transitions for Parameter Set I were computed using the WE method in rate mode while transitions for Parameter Set II were estimated from the sampled transition matrix. The definitions of SC and LN(1) are analogous to the high NANOG production (N<sup><italic>hi</italic></sup>) and low NANOG production (<italic>N</italic><sup><italic>lo</italic></sup>) transitions measured in experiments [<xref ref-type="bibr" rid="pcbi.1006336.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref009">9</xref>]. Increasing the adiabaticity (i.e., the rates of DNA-(un)binding, <italic>h</italic>, <italic>f</italic>), leads to rarer inter-phenotype transitions. The simulations also show that, within the same gene network for a given parameter set, inter-phenotype transition times span four orders of magnitude.</p>
</caption>
<alternatives>
<graphic id="pcbi.1006336.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="border-bottom:thick;border-right:thick"><italic>Transition</italic></th>
<th align="left" style="border-bottom:thick">SC → LN(1)</th>
<th align="left" style="border-bottom:thick">LN(1) → SC</th>
<th align="left" style="border-bottom:thick">SC → TE</th>
<th align="left" style="border-bottom:thick">TE → SC</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" style="border-right:thick"><italic>Parameter Set I</italic>(<italic>f</italic> = 10)</td>
<td align="left">1.71 × 10<sup>1</sup></td>
<td align="left">1.94 × 10<sup>2</sup></td>
<td align="left">1.36 × 10<sup>5</sup></td>
<td align="left">2.70 × 10<sup>5</sup></td>
</tr>
<tr>
<td align="left" style="border-right:thick"><italic>Parameter Set II</italic>(<italic>f</italic> = 50)</td>
<td align="left">7.71 × 10<sup>4</sup></td>
<td align="left">1.28 × 10<sup>4</sup></td>
<td align="left">8.13 × 10<sup>8</sup></td>
<td align="left">5.82 × 10<sup>9</sup></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In addition to generally slowing transitions, the increased adiabaticity of Parameter Set II gives rise to an epigenetic landscape structure that is distinct from that of Parameter Set I, with altered steady-state phenotype probabilities (<xref ref-type="fig" rid="pcbi.1006336.g005">Fig 5a</xref>). The eigenvalue spectrum shows qualitatively distinct features as well, with a gap after five values (<xref ref-type="fig" rid="pcbi.1006336.g006">Fig 6a</xref>). As such, the Markov State Model framework identifies five dominant phenotypes in the network, which correspond broadly to those of Parameter Set I, except that only a single Low-NANOG (LN) phenotype is identified (<xref ref-type="fig" rid="pcbi.1006336.g006">Fig 6b</xref>). Most of the steady-state probability is contained in the IM state (<xref ref-type="fig" rid="pcbi.1006336.g006">Fig 6c</xref>). In addition to altering the transition rates and relative phenotype probabilities, the kinetic parameters altered the dynamics of differentiation and dedifferentiation. The two likeliest pathways of forward (and reverse) SC → TE transitions follow the same route through LN and IM phenotypes (<xref ref-type="fig" rid="pcbi.1006336.g006">Fig 6d and 6e</xref>). Alternative differentiation pathways of forward (and reverse) SC → PE transitions can be found in <xref ref-type="supplementary-material" rid="pcbi.1006336.s019">S9 Fig</xref>. These results indicate that, while the same GRN model with different kinetic parameters may give rise to qualitatively similar phenotypes, they differ in quantitative stationary and dynamic features, including relative steady-state probabilities, transition times, and likeliest transition pathways.</p>
<fig id="pcbi.1006336.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006336.g005</object-id>
<label>Fig 5</label>
<caption>
<title>The rare-event sampling pipeline makes rare states and transitions accessible to simulation.</title>
<p>A) The global state-transition graph computed with the computational pipeline for the Pluripotency Network with rare transitions (Parameter Set II). The states are colored according to the coarse-grained (algorithmically-identified) phenotypes. In this parameter regime (<italic>f</italic> = 50) the differentiated (TE, PE, IM) and pluripotent phenotypes are cleanly separated, reflecting exceedingly rare transitions between the two phenotypes (O(10<sup>9</sup>), see <xref ref-type="table" rid="pcbi.1006336.t001">Table 1</xref>). (B) States visited in conventional SSA simulation (using the same initialization, definitions, and placement as in (A)). In the conventional simulation, a transition out of the IM phenotype was never observed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.g005" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006336.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006336.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Simulation results for the pluripotency network (Parameter Set II).</title>
<p><bold>Changing DNA-Binding Kinetics Alters the Epigenetic Landscape</bold>. A) Computed eigenvalue spectrum and global timescales. B) The coarse-grained Markov State Model showing five phenotypes corresponding to the LN1, SC, PPE, TE, and IM phenotypes of Parameter Set I. The majority of the steady state probability is in the IM phenotype (0.98). C) The gene expression levels for each phenotype and their respective steady-state probabilities. D) The four most probable differentiation pathways between SC and TE phenotypes. E)The dominant pathways of (de)differentiation projected onto the GATA6, CDX2, and NANOG coordinates. The change in DNA-binding kinetics shows different transition dynamics from Parameter Set I. Here, the forward and reverse paths are the same.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec023">
<title>Efficiency of rare-event sampling compared to conventional SSA</title>
<p>Rare phenotype transitions can be difficult to observe with conventional SSA simulation. We compared simulated landscapes (based on estimated <inline-formula id="pcbi.1006336.e043"><alternatives><graphic id="pcbi.1006336.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) from the computational pipeline for the Pluripotency network (Parameter Set II) to those obtained from an equivalent (large) number of SSA simulation steps (<xref ref-type="fig" rid="pcbi.1006336.g005">Fig 5a and 5b</xref>). This comparison revealed that the WE-based method uncovers multiple phenotypes and associated transitions that are effectively invisible to conventional simulation due to the rarity of exiting metastable basins.</p>
<p>Quantitative estimates of efficiency gains for WE have been based on comparing the number of simulation steps required to estimate a desired quantity (such as a rate constant) using WE versus conventional simulation [<xref ref-type="bibr" rid="pcbi.1006336.ref047">47</xref>]. Treating <inline-formula id="pcbi.1006336.e044"><alternatives><graphic id="pcbi.1006336.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> as the desired output (as it contains holistic dynamic information for the system), we estimate the efficiency gain of our pipeline by computing:
<disp-formula id="pcbi.1006336.e045"><alternatives><graphic id="pcbi.1006336.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mrow><mml:mi>E</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>Sim</mml:mtext><mml:mo>.</mml:mo><mml:mspace width="4pt"/><mml:mtext>steps</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>to</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>estimate</mml:mtext> <mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mtext>Conv</mml:mtext> <mml:mo>.</mml:mo></mml:mrow> <mml:mrow><mml:mtext>Sim</mml:mtext><mml:mo>.</mml:mo><mml:mspace width="4pt"/><mml:mtext>steps</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>to</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>estimate</mml:mtext> <mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mtext>WE</mml:mtext></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>The denominator of <xref ref-type="disp-formula" rid="pcbi.1006336.e045">Eq 10</xref> is given by <italic>N</italic><sub>bins</sub> × <italic>N</italic><sub>iterations</sub> × <italic>τ</italic> × <italic>M</italic><sub>targ</sub>, thus accounting for all individual replica-steps in the total WE simulation time. The numerator is computed by asking how many steps of a conventional simulated trajectory are required to estimate <inline-formula id="pcbi.1006336.e046"><alternatives><graphic id="pcbi.1006336.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. It is generally prohibitive to collect enough conventional simulation steps to estimate <inline-formula id="pcbi.1006336.e047"><alternatives><graphic id="pcbi.1006336.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to a similar resolution as WE. However, given a <inline-formula id="pcbi.1006336.e048"><alternatives><graphic id="pcbi.1006336.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> estimated from WE, it is in principle possible to estimate how many steps would be necessary to achieve the same <inline-formula id="pcbi.1006336.e049"><alternatives><graphic id="pcbi.1006336.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> by conventional simulation. We used an approximate, conservative estimate given by:
<disp-formula id="pcbi.1006336.e050"><alternatives><graphic id="pcbi.1006336.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mrow><mml:mo>[</mml:mo> <mml:mtext>Sim</mml:mtext><mml:mo>.</mml:mo><mml:mspace width="4pt"/><mml:mtext>steps</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>to</mml:mtext> <mml:mspace width="4pt"/><mml:mtext>estimate</mml:mtext><mml:mspace width="4pt"/><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mtext>Conv</mml:mtext> <mml:mo>.</mml:mo> <mml:mo>]</mml:mo> <mml:mo>⪆</mml:mo> <mml:mi>τ</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mo>(</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mn>5</mml:mn> <mml:mo>%</mml:mo> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
where <italic>P</italic><sub>5%,<italic>i</italic></sub> denotes the 5th percentile over nonzero elements of row <italic>i</italic>. Justification of <xref ref-type="disp-formula" rid="pcbi.1006336.e050">Eq 11</xref> is given in the Supplement, <xref ref-type="supplementary-material" rid="pcbi.1006336.s003">S3 File</xref>. Briefly, <xref ref-type="disp-formula" rid="pcbi.1006336.e050">Eq 11</xref> reflects the fact that the required simulation time should be dominated by the rare transitions (i.e., the smaller elements of <inline-formula id="pcbi.1006336.e051"><alternatives><graphic id="pcbi.1006336.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>), while attempting to avoid over-dependence on individual estimates of small <italic>T</italic><sub><italic>ij</italic></sub>, which generally have unknown error. The error versus simulation time in WE- and Conv.-estimated <inline-formula id="pcbi.1006336.e052"><alternatives><graphic id="pcbi.1006336.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are plotted in <xref ref-type="supplementary-material" rid="pcbi.1006336.s022">S12 Fig</xref>.</p>
<p>According to <xref ref-type="disp-formula" rid="pcbi.1006336.e050">Eq 11</xref>, we estimate that our pipeline provided efficiency gains of 2 for ExMISA (<xref ref-type="fig" rid="pcbi.1006336.g002">Fig 2</xref>), 900 for Pluripotency Parameter Set I (<xref ref-type="fig" rid="pcbi.1006336.g003">Fig 3</xref>), and 1 × 10<sup>6</sup> for Parameter Set II (<xref ref-type="fig" rid="pcbi.1006336.g006">Fig 6</xref>). These numbers show that the pipeline can afford a significant speedup over conventional simulation in providing global dynamic information. The numbers further show that the efficiency gain is most pronounced for the Pluripotency network with exceedingly rare inter-phenotype transitions.</p>
</sec>
</sec>
<sec id="sec024" sec-type="conclusions">
<title>Discussion</title>
<p>In this work, we present a method for efficient, automated computation of epigenetic landscapes, metastable phenotypes, and phenotype-transition dynamics of stochastic GRN models. Our computational pipeline was inspired by studies of metastability and barrier-crossing in Molecular Dynamics, and our application of the pipeline to cell-scale networks addresses a number of current challenges for stochastic GRN dynamics. First, it overcomes the curse-of-dimensionality of complex models, by leveraging available rule-based modeling tools for stochastic biochemical networks [<xref ref-type="bibr" rid="pcbi.1006336.ref056">56</xref>]. Second, it overcomes the challenge of efficiently simulating stochastic systems with rare events, by using enhanced Weighted Ensemble rare-event sampling [<xref ref-type="bibr" rid="pcbi.1006336.ref045">45</xref>]. Third, it addresses the challenge of extracting and interpreting essential dynamics of complex systems on the basis of simulated trajectories, by using the Markov State Model framework [<xref ref-type="bibr" rid="pcbi.1006336.ref036">36</xref>] to automatically generate a compact, approximate representation of global system dynamics. Combining these tools into a unified pipeline provides an automated means of computing and visualizing essential stationary and dynamic properties of stochastic GRNs, including the number and identities (i.e. state-space mapping) of metastable phenotypes, their steady-state probabilities, and most-likely pathways of inter-phenotype transitions and their transition rates. By advancing the capability to compute and interpret hypothesized or experimentally-derived stochastic GRN models, the method can yield insight into how “local” stochastic, molecular processes involved in epigenetic regulation affect “global” dynamics such as phenotypic stability and fate-transitions in cells. Moreover, it can help close the gap between dynamic, molecular-detailed models of gene regulation and cell-population level experimental data, to inform rational cell reprogramming strategies.</p>
<sec id="sec025">
<title>Insights from the pluripotency network simulations</title>
<p>We used the pluripotency network as a model system to develop and demonstrate the simulation approach, but the results also yielded biological insights. For example, the simulations revealed a hierarchical structure of the epigenetic landscape. The network—exhibiting 5-6 metastable phenotypes—occupies a limited subspace from the vast possible gene combinations (e.g., 2<sup>8</sup> = 256 possible distinct on/off combinations of gene expression states). The dominant feature of the global landscape is a high barrier/slow timescale between pluripotent and differentiated phenotypes. Within each of these categories, further sub-states were identified. The model revealed multi-timescale dynamics of phenotype transitions; the pluripotency network showed relatively rapid transitions between phenotype-states that differed in the expression-level (high vs. low) of a single gene, e.g. the high NANOG to low NANOG transition, whereas phenotype transitions involving a change in expression level of seven genes, e.g. the SC macrostate to the TE macrostate, occurred five orders of magnitude more slowly on average.</p>
<p>While the accessible phenotypes appear broadly similar across parameter sets, the relative stability and transition dynamics among phenotypes were sensitive to kinetic parameters governing transcription factor binding/unbinding. A global change in these parameters (affecting all individual transcription factor-DNA interactions equally) changed the shape of the landscape, altering the relative steady-state probabilities of different phenotypes and the likely transition pathways linking them. The DNA binding parameters capture the local epigenetic mechanisms that enable/disable transcription factors from accessing regulatory elements. A global rate change nevertheless has a varying influence on different genes because the number of regulators differs, as does the molecular logic by which activators and repressors exert combinatorial control on different genes. These results echo findings that global modification of chromatin regulators often have lineage-specific effects [<xref ref-type="bibr" rid="pcbi.1006336.ref063">63</xref>]. These results highlight both the need for, and the challenge of, informing cell reprogramming strategies with quantitative network models, as they suggest that the dynamic response of cellular networks to perturbations is governed by the detailed kinetics of molecular regulatory mechanisms, which are generally difficult to parameterize.</p>
</sec>
<sec id="sec026">
<title>Dynamic definition of cell phenotype</title>
<p>The Markov State Model framework implicitly imposes a dynamic definition of cell phenotypes; the number of phenotypes was determined using spectral gap-analysis, and the coarse-graining algorithm automatically identified metastable aggregates (i.e., grouped sampled network states into larger clusters). This is different from the classifications of phenotypes that are generally used in analyzing experimental data, where gene expression or marker levels are often used to categorize cells. However, experiments have also revealed the potential need for a dynamic definition of cell phenotype, based not only on single-timepoint measurements of gene expression or phenotype-markers, but also on information from past or future timepoints [<xref ref-type="bibr" rid="pcbi.1006336.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref008">8</xref>]. For example, Filipczyk <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006336.ref008">8</xref>] identified distinct subpopulations within a compartment of NANOG-negative cells in mESCS, which differed in their propensity to re-express NANOG. At the same time, fluctuations between low- and high-NANOG expressing cells were not necessarily associated with any functional state change. The Markov State Model approach, based on kinetic/dynamic coarse-graining, thus provides a quantitative approach for classifying phenotype-states that is both completely generalizable rather than <italic>ad hoc</italic> (it requires no <italic>a priori</italic> knowledge or designation of markers/genes) and is in line with these recent experiments revealing the need for a dynamic definition of phenotype.</p>
</sec>
<sec id="sec027">
<title>Timescales of stochastic phenotype transitions</title>
<p>Markovian transitions (i.e., memoryless “hops”) among cell phenotypes have been observed experimentally: examples include transitions among phenotypes in cancer cells, as measured by flow cytometry [<xref ref-type="bibr" rid="pcbi.1006336.ref010">10</xref>], and among pluripotency-states in mESCs, as measured by time-lapse microscopy of fluctuating gene expression [<xref ref-type="bibr" rid="pcbi.1006336.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref009">9</xref>]. The compact nature of these data-inferred networks—showing hops among a limited set of broad phenotypes—suggests that the computed MSM framework advanced in this study provides an appropriate level of resolution at which to analyze GRN dynamics and may serve as a useful tool for comparing models to experimental data.</p>
<p>Experimental studies have quantified the timescales of Markovian transitions between NANOG-high and NANOG-low states in mESCs [<xref ref-type="bibr" rid="pcbi.1006336.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref009">9</xref>]. From Hormoz <italic>et al</italic>., the probability of transitioning from NANOG-high to NANOG-low in mESCs is 0.02 per cell cycle, while that of the reverse transition is 0.08. These values represent a relatively rapid transition rate, since NANOG expression is known to be particularly dynamic [<xref ref-type="bibr" rid="pcbi.1006336.ref060">60</xref>]. Similarly, plasticity has been observed in cancer cells where quantitative estimates of stochastic cell transitions between a stem cell cancer cell phenotype to a basal cancer cell phenotype were observed to be roughly on the order of 0.01 to 0.1 per cell cycle [<xref ref-type="bibr" rid="pcbi.1006336.ref010">10</xref>]. We can translate our model results to approximate biological timescales: the degradation rate, which sets the timeunit for model results (i.e., <italic>k</italic> is taken to be 1) was experimentally determined to be on the order of a few hours (in the E14 mouse embryonic stem cell line, the half-lives of NANOG, OCT4, and SOX2 are approximately 4.7, &gt; 6, and 1.6 hours, respectively [<xref ref-type="bibr" rid="pcbi.1006336.ref064">64</xref>]). Assuming that degradation is unimolecular, <italic>k</italic> = ln(2)/<italic>t</italic><sub>[<italic>NANOG</italic>]1/2</sub>, and the half-life of NANOG, <italic>t</italic><sub>[<italic>NANOG</italic>]1/2</sub> = 5 hours, the degradation rate is <italic>k</italic> = 0.1. Using a mESC cell cycle time of 12 hours [<xref ref-type="bibr" rid="pcbi.1006336.ref065">65</xref>], the simulations for Parameter Set I then predict NANOG-high to NANOG-low transitions occurring with a rate of 0.03 per cell cycle, and of 3 × 10<sup>−3</sup> for the reverse. For Parameter Set II, the computed rates were 8 × 10<sup>−6</sup> and 5 × 10<sup>−5</sup>, respectively. Comparison of these computed and experimental rates of NANOG transitions indicates that Parameter Set I (<italic>f</italic> = 10) is more in line with experimental observations, while Parameter Set II (<italic>f</italic> = 50) gives transition rates that are three orders of magnitude too slow. These results are in agreement with previous findings from theoretical studies that GRNs in pluripotency networks operate in a so-called “weakly-adiabatic” regime [<xref ref-type="bibr" rid="pcbi.1006336.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>], in which the timescale of DNA-binding by transcription factors is on the order of transcription factor production and degradation.</p>
</sec>
<sec id="sec028">
<title>Comparison to other models and computational approaches</title>
<p>A number of theoretical studies have elucidated dynamics of stochastic molecular-detailed GRN models (i.e., models that include molecular fluctuations and regulatory mechanisms, in contrast to Boolean models [<xref ref-type="bibr" rid="pcbi.1006336.ref066">66</xref>]). These studies have largely focused on small 1- or 2-gene motifs[[<xref ref-type="bibr" rid="pcbi.1006336.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref039">39</xref>]]. In the limit of slow DNA-binding/unbinding, it was shown that the stationary distribution of the stochastic model can be solved exactly [<xref ref-type="bibr" rid="pcbi.1006336.ref041">41</xref>]. Recent years have seen extension of stochastic methods to studies of more complex, experimentally derived GRN models encompassing <inline-formula id="pcbi.1006336.e053"><alternatives><graphic id="pcbi.1006336.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>10</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> genes. For example, determination of global dynamic properties of such networks has been achieved by combining information from long stochastic simulations of discrete models [<xref ref-type="bibr" rid="pcbi.1006336.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref062">62</xref>], or of continuum SDE models, in combination with path integral approaches [<xref ref-type="bibr" rid="pcbi.1006336.ref058">58</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref067">67</xref>]. The pluripotency network studied herein was developed by Zhang and Wolynes [<xref ref-type="bibr" rid="pcbi.1006336.ref028">28</xref>]; in their work, the authors developed a continuum approximation to the Chemical Master Equation that enabled quantitative construction of the epigenetic landscape. Here, we present an alternative approach that is unique in two major aspects: (1) the use of stochastic simulations (i.e., SSA [<xref ref-type="bibr" rid="pcbi.1006336.ref033">33</xref>]), which is enabled by use of the WE rare-event sampling algorithm, and (2) the automated Markov State Model framework for designating phenotypes and constructing a coarse-grained view of the epigenetic landscape. While we utilize a different framework (that of coarse-grained, discrete stochastic models) from Zhang and Wolynes to approximate and interpret dynamics, our results are broadly consistent with theirs. For example, the dominant identified phenotypes we found are the same as in their work (the only exception being the exceedingly rare LN2 phenotype identified by the coarse-graining algorithm for Parameter Set I).</p>
</sec>
<sec id="sec029">
<title>Current challenges and future directions</title>
<p>Our approach is uniquely suited to extracting global dynamics information for stochastic systems with metastability, using simulations. An advantage of this approach is that both the WE and coarse-graining algorithms are“dynamics-agnostic” [<xref ref-type="bibr" rid="pcbi.1006336.ref047">47</xref>], meaning that they can be applied to any type of stochastic dynamics framework. In the context of computational biology, our pipeline could be extended to other types of stochastic biochemical systems, such as systems with hybrid discrete-continuum dynamics [<xref ref-type="bibr" rid="pcbi.1006336.ref068">68</xref>], systems with spatial heterogeneity [<xref ref-type="bibr" rid="pcbi.1006336.ref069">69</xref>], or multi-level models [<xref ref-type="bibr" rid="pcbi.1006336.ref070">70</xref>]. In addition to this flexibility, simulation-based methods have the advantage of being able to leverage existing, widely-used open-source packages, which in turn facilitate model specification and model sharing. For example, BioNetGen [<xref ref-type="bibr" rid="pcbi.1006336.ref056">56</xref>] can interpret models specified in the Systems Biology Markup Language [<xref ref-type="bibr" rid="pcbi.1006336.ref071">71</xref>].</p>
<p>Several challenges and potential weaknesses with the pipeline exist, both with regard to sampling rare events, and in determining an appropriate coarse-grained model. Potential challenges with the WE algorithm itself have been described elsewhere [<xref ref-type="bibr" rid="pcbi.1006336.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref069">69</xref>], and include the difficulty of determining a binning that captures slow degrees of freedom and the existence of time-correlations between sampled iterations of the simulation, which can impede unbiased sampling. The Voronoi-based binning procedure we employ here is related to a number of similar approaches [<xref ref-type="bibr" rid="pcbi.1006336.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006336.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1006336.ref050">50</xref>], and has the advantage of effectively tiling a high-dimensional space without the need for <italic>a priori</italic> knowledge. However, in practice, according to others and our own studies, the method is effective up to about 10 degrees of freedom. Therefore, in larger gene networks (as in other complex systems) an ongoing challenge will be to identify optimal binning methods to effectively partition slow degrees of freedom and thus enable efficient enhanced sampling. New adaptive partitioning methods could also have the effect of improving the accuracy of coarse-grained Markov models, as finer partitioning of transition regions has been found to reduce errors in the Markovian approximation [<xref ref-type="bibr" rid="pcbi.1006336.ref042">42</xref>]. Additional improvements to efficiency, which could aid in scaling the method to larger networks, could be achieved in the future by using alternatives to the direct SSA algorithm (see e.g., [<xref ref-type="bibr" rid="pcbi.1006336.ref072">72</xref>]) or improved parallelization techniques.</p>
</sec>
</sec>
<sec id="sec030">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006336.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Description of network models, kinetic parameters, and weighted ensemble parameters.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s002" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Pseudo-code for the computational pipeline.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s003" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>Details of efficiency gain estimate.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s004" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>ExMISA network parameters.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s005" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Pluripotency network.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s006" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Pluripotency network parameters.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s007" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Weighted ensemble simulation parameters.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s008" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Transition matrices of metastable phenotype clusters (MSMs).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s009" xlink:type="simple">
<label>S6 Table</label>
<caption>
<title>Computed mean first passage times in the ExMISA network—Comparison of different methods.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s010" xlink:type="simple">
<label>S7 Table</label>
<caption>
<title>Computed mean first passage times of inter-phenotype transitions in the pluripotency network (Parameter Set I).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s011" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Movement of Voronoi Centers during weighted ensemble sampling.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s012" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Error in computed steady-state probability as a function of <italic>N</italic>, the number of protein states retained in the state-space truncation.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s013" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Convergence of the flux of the transition between the polarized phenotype-states in the ExMISA network.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s014" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Convergence of the slowest implied timescale <italic>t</italic><sub>2</sub> with increasing number of sampling regions (bins) and increasing lagtime <italic>τ</italic>.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s015" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>The Chapman-Kolmogorov test on the four Markov State Model phenotypes of the sampled ExMISA network.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s016" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Pathway decomposition for the SC → PE transition for <italic>f</italic> = 10.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s017" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s017" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Validation of the SC → TE transition pathway calculated through weighted ensemble simulation.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s018" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s018" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Reproducibility of the weighted ensemble sampling of the pluripotency network.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s019" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s019" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Pathway decomposition for the SC → PE transition for <italic>f</italic> = 50.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s020" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s020" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Convergence of the flux of the TE → SC transition in the pluripotency network with <italic>f</italic> = 10.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s021" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s021" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Difference in Coarse-Grained clustering for the 2-gene ExMISA cell decision network studied through the numerical benchmark (top) and the WE sampling pipeline (bottom).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006336.s022" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006336.s022" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Plotted errors in sampled <inline-formula id="pcbi.1006336.e054"><alternatives><graphic id="pcbi.1006336.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006336.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">T</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for ExMISA.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank the administrators of the University of California, Irvine High-Performance Computing Cluster and we thank Jun Allard for helpful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006336.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Takahashi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tanabe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ohnuki</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Narita</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ichisaka</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tomoda</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Induction of Pluripotent Stem Cells from Adult Human Fibroblasts by Defined Factors</article-title>. <source>Cell</source>. <year>2007</year>;<volume>131</volume>(<issue>5</issue>):<fpage>861</fpage>–<lpage>872</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2007.11.019" xlink:type="simple">10.1016/j.cell.2007.11.019</ext-link></comment> <object-id pub-id-type="pmid">18035408</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abranches</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Guedes</surname> <given-names>AMV</given-names></name>, <name name-style="western"><surname>Moravec</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maamar</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Raj</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Stochastic NANOG fluctuations allow mouse embryonic stem cells to explore pluripotency</article-title>. <source>Development</source>. <year>2014</year>;<volume>141</volume>(<issue>14</issue>):<fpage>2770</fpage>–<lpage>2779</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.108910" xlink:type="simple">10.1242/dev.108910</ext-link></comment> <object-id pub-id-type="pmid">25005472</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dietrich</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Hiiragi</surname> <given-names>T</given-names></name>. <article-title>Stochastic patterning in the mouse pre-implantation embryo</article-title>. <source>Development</source>. <year>2007</year>;<volume>134</volume>(<issue>23</issue>):<fpage>4219</fpage>–<lpage>4231</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.003798" xlink:type="simple">10.1242/dev.003798</ext-link></comment> <object-id pub-id-type="pmid">17978007</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kalmar</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lim</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hayward</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Muñoz-Descalzo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nichols</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Garcia-Ojalvo</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Regulated Fluctuations in Nanog Expression Mediate Cell Fate Decisions in Embryonic Stem Cells</article-title>. <source>PLoS Biology</source>. <year>2009</year>;<volume>7</volume>(<issue>7</issue>):<fpage>e1000149</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.1000149" xlink:type="simple">10.1371/journal.pbio.1000149</ext-link></comment> <object-id pub-id-type="pmid">19582141</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Singh</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Hamazaki</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hankowski</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Terada</surname> <given-names>N</given-names></name>. <article-title>A heterogeneous expression pattern for Nanog in embryonic stem cells</article-title>. <source>Stem Cells (Dayton, Ohio)</source>. <year>2007</year>;<volume>25</volume>(<issue>10</issue>):<fpage>2534</fpage>–<lpage>2542</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1634/stemcells.2007-0126" xlink:type="simple">10.1634/stemcells.2007-0126</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ohnishi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Tsumura</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Xenopoulos</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kurimoto</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Cell-to-cell expression variability followed by signal reinforcement progressively segregates early mouse lineages</article-title>. <source>Nature cell biology</source>. <year>2014</year>;<volume>16</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>37</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncb2881" xlink:type="simple">10.1038/ncb2881</ext-link></comment> <object-id pub-id-type="pmid">24292013</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Singer</surname> <given-names>ZS</given-names></name>, <name name-style="western"><surname>Yong</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tischler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hackett</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Altinok</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Surani</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Dynamic Heterogeneity and DNA Methylation in Embryonic Stem Cells</article-title>. <source>Molecular Cell</source>. <year>2014</year>;<volume>55</volume>(<issue>2</issue>):<fpage>319</fpage>–<lpage>331</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.molcel.2014.06.029" xlink:type="simple">10.1016/j.molcel.2014.06.029</ext-link></comment> <object-id pub-id-type="pmid">25038413</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Filipczyk</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marr</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hastreiter</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Feigelman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schwarzfischer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hoppe</surname> <given-names>PS</given-names></name>, <etal>et al</etal>. <article-title>Network plasticity of pluripotency transcription factors in embryonic stem cells</article-title>. <source>Nature Cell Biology</source>. <year>2015</year>;<volume>17</volume>(<issue>10</issue>):<fpage>1235</fpage>–<lpage>1246</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncb3237" xlink:type="simple">10.1038/ncb3237</ext-link></comment> <object-id pub-id-type="pmid">26389663</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hormoz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>ZS</given-names></name>, <name name-style="western"><surname>Linton</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Antebi</surname> <given-names>YE</given-names></name>, <name name-style="western"><surname>Shraiman</surname> <given-names>BI</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>. <article-title>Inferring Cell-State Transition Dynamics from Lineage Trees and Endpoint Single-Cell Measurements</article-title>. <source>Cell Systems</source>. <year>2016</year>;<volume>3</volume>(<issue>5</issue>):<fpage>419</fpage>–<lpage>433.e8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cels.2016.10.015" xlink:type="simple">10.1016/j.cels.2016.10.015</ext-link></comment> <object-id pub-id-type="pmid">27883889</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gupta</surname> <given-names>PB</given-names></name>, <name name-style="western"><surname>Fillmore</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Shapira</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Tao</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kuperwasser</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Stochastic State Transitions Give Rise to Phenotypic Equilibrium in Populations of Cancer Cells</article-title>. <source>Cell</source>. <year>2011</year>;<volume>146</volume>(<issue>4</issue>):<fpage>633</fpage>–<lpage>644</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2011.07.026" xlink:type="simple">10.1016/j.cell.2011.07.026</ext-link></comment> <object-id pub-id-type="pmid">21854987</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sharma</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>DY</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Quinlan</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Maheswaran</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>A Chromatin-Mediated Reversible Drug-Tolerant State in Cancer Cell Subpopulations</article-title>. <source>Cell</source>. <year>2010</year>;<volume>141</volume>(<issue>1</issue>):<fpage>69</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2010.02.027" xlink:type="simple">10.1016/j.cell.2010.02.027</ext-link></comment> <object-id pub-id-type="pmid">20371346</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Acar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mettetal</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name>. <article-title>Stochastic switching as a survival strategy in fluctuating environments</article-title>. <source>Nature Genetics</source>. <year>2008</year>;<volume>40</volume>(<issue>4</issue>):<fpage>471</fpage>–<lpage>475</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.110" xlink:type="simple">10.1038/ng.110</ext-link></comment> <object-id pub-id-type="pmid">18362885</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balaban</surname> <given-names>NQ</given-names></name>, <name name-style="western"><surname>Merrin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chait</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kowalik</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Leibler</surname> <given-names>S</given-names></name>. <article-title>Bacterial Persistence as a Phenotypic Switch</article-title>. <source>Science</source>. <year>2004</year>;<volume>305</volume>(<issue>5690</issue>):<fpage>1622</fpage>–<lpage>1625</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1099390" xlink:type="simple">10.1126/science.1099390</ext-link></comment> <object-id pub-id-type="pmid">15308767</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref014">
<label>14</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Waddington</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kacser</surname> <given-names>H</given-names></name>. <source>The Strategy of the Genes</source>. <publisher-name>Routledge</publisher-name>; <year>1957</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006336.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bhattacharya</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Andersen</surname> <given-names>ME</given-names></name>. <article-title>A deterministic map of Waddington’s epigenetic landscape for cell fate specification</article-title>. <source>BMC Systems Biology</source>. <year>2011</year>;<volume>5</volume>:<fpage>85</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-5-85" xlink:type="simple">10.1186/1752-0509-5-85</ext-link></comment> <object-id pub-id-type="pmid">21619617</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>E</given-names></name>. <article-title>Quantifying the Waddington landscape and biological paths for development and differentiation</article-title>. <source>Proceedings Of The National Academy Of Sciences Of The United States Of America</source>. <year>2011</year>;<volume>108</volume>(<issue>21536909</issue>):<fpage>8257</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1017017108" xlink:type="simple">10.1073/pnas.1017017108</ext-link></comment> <object-id pub-id-type="pmid">21536909</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huang</surname> <given-names>S</given-names></name>. <article-title>The molecular and mathematical basis of Waddington’s epigenetic landscape: a framework for post-Darwinian biology?</article-title> <source>BioEssays: News and Reviews in Molecular, Cellular and Developmental Biology</source>. <year>2012</year>;<volume>34</volume>(<issue>2</issue>):<fpage>149</fpage>–<lpage>157</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/bies.201100031" xlink:type="simple">10.1002/bies.201100031</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Eichler</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bar-Yam</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ingber</surname> <given-names>DE</given-names></name>. <article-title>Cell fates as high-dimensional attractor states of a complex gene regulatory network</article-title>. <source>Physical Review Letters</source>. <year>2005</year>;<volume>94</volume>(<issue>12</issue>):<fpage>128701</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.94.128701" xlink:type="simple">10.1103/PhysRevLett.94.128701</ext-link></comment> <object-id pub-id-type="pmid">15903968</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Siggia</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>. <article-title>Stochastic Gene Expression in a Single Cell</article-title>. <source>Science</source>. <year>2002</year>;<volume>297</volume>(<issue>5584</issue>):<fpage>1183</fpage>–<lpage>1186</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1070919" xlink:type="simple">10.1126/science.1070919</ext-link></comment> <object-id pub-id-type="pmid">12183631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kærn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Elston</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Blake</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>JJ</given-names></name>. <article-title>Stochasticity in gene expression: from theories to phenotypes</article-title>. <source>Nature Reviews Genetics</source>. <year>2005</year>;<volume>6</volume>(<issue>6</issue>):<fpage>451</fpage>–<lpage>464</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg1615" xlink:type="simple">10.1038/nrg1615</ext-link></comment> <object-id pub-id-type="pmid">15883588</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aurell</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sneppen</surname> <given-names>K</given-names></name>. <article-title>Epigenetics as a First Exit Problem</article-title>. <source>Physical Review Letters</source>. <year>2002</year>;<volume>88</volume>(<issue>4</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.88.048101" xlink:type="simple">10.1103/PhysRevLett.88.048101</ext-link></comment> <object-id pub-id-type="pmid">11801174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sasai</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wolynes</surname> <given-names>PG</given-names></name>. <article-title>Stochastic gene expression as a many-body problem</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2003</year>;<volume>100</volume>(<issue>5</issue>):<fpage>2374</fpage>–<lpage>2379</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.2627987100" xlink:type="simple">10.1073/pnas.2627987100</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>. <article-title>A new mechanism of stem cell differentiation through slow binding/unbinding of regulators to genes</article-title>. <source>Sci Rep</source>. <year>2012</year>;<volume>2</volume>:<fpage>550</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep00550" xlink:type="simple">10.1038/srep00550</ext-link></comment> <object-id pub-id-type="pmid">22870379</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tse</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Chu</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Roy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Read</surname> <given-names>EL</given-names></name>. <article-title>DNA-Binding Kinetics Determines the Mechanism of Noise-Induced Switching in Gene Networks</article-title>. <source>Biophysical Journal</source>. <year>2015</year>;<volume>109</volume>(<issue>8</issue>):<fpage>1746</fpage>–<lpage>1757</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bpj.2015.08.035" xlink:type="simple">10.1016/j.bpj.2015.08.035</ext-link></comment> <object-id pub-id-type="pmid">26488666</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ge</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Qian</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>XS</given-names></name>. <article-title>Stochastic Phenotype Transition of a Single Cell in an Intermediate Region of Gene State Switching</article-title>. <source>Physical Review Letters</source>. <year>2015</year>;<volume>114</volume>(<issue>7</issue>):<fpage>078101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.114.078101" xlink:type="simple">10.1103/PhysRevLett.114.078101</ext-link></comment> <object-id pub-id-type="pmid">25763973</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Hemberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Barahona</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ingber</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>S</given-names></name>. <article-title>Transcriptome-wide noise controls lineage choice in mammalian progenitor cells</article-title>. <source>Nature</source>. <year>2008</year>;<volume>453</volume>(<issue>7194</issue>):<fpage>544</fpage>–<lpage>547</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature06965" xlink:type="simple">10.1038/nature06965</ext-link></comment> <object-id pub-id-type="pmid">18497826</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sasai</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kawabata</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Makishi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Itoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Terada</surname> <given-names>TP</given-names></name>. <article-title>Time Scales in Epigenetic Dynamics and Phenotypic Heterogeneity of Embryonic Stem Cells</article-title>. <source>PLOS Computational Biology</source>. <year>2013</year>;<volume>9</volume>(<issue>12</issue>):<fpage>e1003380</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003380" xlink:type="simple">10.1371/journal.pcbi.1003380</ext-link></comment> <object-id pub-id-type="pmid">24348228</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wolynes</surname> <given-names>PG</given-names></name>. <article-title>Stem cell differentiation as a many-body problem</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>28</issue>):<fpage>10185</fpage>–<lpage>10190</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1408561111" xlink:type="simple">10.1073/pnas.1408561111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chu</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Tse</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Sato</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Read</surname> <given-names>EL</given-names></name>. <article-title>Markov State Models of gene regulatory networks</article-title>. <source>BMC Systems Biology</source>. <year>2017</year>;<volume>11</volume>:<fpage>14</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12918-017-0394-4" xlink:type="simple">10.1186/s12918-017-0394-4</ext-link></comment> <object-id pub-id-type="pmid">28166778</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lipshtat</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Loinger</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Balaban</surname> <given-names>NQ</given-names></name>, <name name-style="western"><surname>Biham</surname> <given-names>O</given-names></name>. <article-title>Genetic Toggle Switch without Cooperative Binding</article-title>. <source>Physical Review Letters</source>. <year>2006</year>;<volume>96</volume>(<issue>18</issue>):<fpage>188101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.96.188101" xlink:type="simple">10.1103/PhysRevLett.96.188101</ext-link></comment> <object-id pub-id-type="pmid">16712399</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schultz</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Walczak</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Onuchic</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Wolynes</surname> <given-names>PG</given-names></name>. <article-title>Extinction and resurrection in gene networks</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2008</year>;<volume>105</volume>(<issue>49</issue>):<fpage>19165</fpage>–<lpage>19170</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0810366105" xlink:type="simple">10.1073/pnas.0810366105</ext-link></comment> <object-id pub-id-type="pmid">19033463</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ma</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hou</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>H</given-names></name>. <article-title>Small-Number Effects: A Third Stable State in a Genetic Bistable Toggle Switch</article-title>. <source>Physical Review Letters</source>. <year>2012</year>;<volume>109</volume>(<issue>24</issue>):<fpage>248107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.109.248107" xlink:type="simple">10.1103/PhysRevLett.109.248107</ext-link></comment> <object-id pub-id-type="pmid">23368390</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>. <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>The Journal of Physical Chemistry</source>. <year>1977</year>;<volume>81</volume>(<issue>25</issue>):<fpage>2340</fpage>–<lpage>2361</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/j100540a008" xlink:type="simple">10.1021/j100540a008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Valeriani</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>ten Wolde</surname> <given-names>P</given-names></name>. <article-title>Forward flux sampling for rare event simulations</article-title>. <source>Journal Of Physics-Condensed Matter</source>. <year>2009</year>;<volume>21</volume>(<issue>000271268400004</issue>):<fpage>463102</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/0953-8984/21/46/463102" xlink:type="simple">10.1088/0953-8984/21/46/463102</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zuckerman</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Chong</surname> <given-names>LT</given-names></name>. <article-title>Weighted Ensemble Simulation: Review of Methodology, Applications, and Software</article-title>. <source>Annual Review of Biophysics</source>. <year>2017</year>;<volume>46</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-biophys-070816-033834" xlink:type="simple">10.1146/annurev-biophys-070816-033834</ext-link></comment> <object-id pub-id-type="pmid">28301772</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Noé</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schütte</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vanden-Eijnden</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Weikl</surname> <given-names>TR</given-names></name>. <article-title>Constructing the equilibrium ensemble of folding pathways from short off-equilibrium simulations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>45</issue>):<fpage>19011</fpage>–<lpage>19016</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0905466106" xlink:type="simple">10.1073/pnas.0905466106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huang</surname> <given-names>S</given-names></name>. <article-title>Reprogramming cell fates: reconciling rarity with robustness</article-title>. <source>BioEssays: News and Reviews in Molecular, Cellular and Developmental Biology</source>. <year>2009</year>;<volume>31</volume>(<issue>5</issue>):<fpage>546</fpage>–<lpage>560</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/bies.200800189" xlink:type="simple">10.1002/bies.200800189</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Graf</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Enver</surname> <given-names>T</given-names></name>. <article-title>Forcing cells to change lineages</article-title>. <source>Nature</source>. <year>2009</year>;<volume>462</volume>(<issue>7273</issue>):<fpage>587</fpage>–<lpage>594</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature08533" xlink:type="simple">10.1038/nature08533</ext-link></comment> <object-id pub-id-type="pmid">19956253</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kepler</surname> <given-names>TB</given-names></name>, <name name-style="western"><surname>Elston</surname> <given-names>TC</given-names></name>. <article-title>Stochasticity in Transcriptional Regulation: Origins, Consequences, and Mathematical Representations</article-title>. <source>Biophysical Journal</source>. <year>2001</year>;<volume>81</volume>(<issue>6</issue>):<fpage>3116</fpage>–<lpage>3136</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0006-3495(01)75949-8" xlink:type="simple">10.1016/S0006-3495(01)75949-8</ext-link></comment> <object-id pub-id-type="pmid">11720979</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lin</surname> <given-names>YT</given-names></name>, <name name-style="western"><surname>Buchler</surname> <given-names>NE</given-names></name>. <article-title>Efficient analysis of stochastic gene dynamics in the non-adiabatic regime using piecewise deterministic Markov processes</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2018</year>;<volume>15</volume>(<issue>138</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2017.0804" xlink:type="simple">10.1098/rsif.2017.0804</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref041">
<label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Al-Radhawi MA, Del Vecchio D, Sontag ED. Multi-modality in gene regulatory networks with slow gene binding. arXiv preprint arXiv:170502330. 2017;.</mixed-citation>
</ref>
<ref id="pcbi.1006336.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Prinz</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sarich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Senne</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Held</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Markov models of molecular kinetics: Generation and validation</article-title>. <source>The Journal of Chemical Physics</source>. <year>2011</year>;<volume>134</volume>(<issue>17</issue>):<fpage>174105</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.3565032" xlink:type="simple">10.1063/1.3565032</ext-link></comment> <object-id pub-id-type="pmid">21548671</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scherer</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Trendelkamp-Schroer</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pérez-Hernández</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hoffmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Plattner</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>PyEMMA 2: A Software Package for Estimation, Validation, and Analysis of Markov Models</article-title>. <source>Journal of Chemical Theory and Computation</source>. <year>2015</year>;<volume>11</volume>(<issue>11</issue>):<fpage>5525</fpage>–<lpage>5542</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acs.jctc.5b00743" xlink:type="simple">10.1021/acs.jctc.5b00743</ext-link></comment> <object-id pub-id-type="pmid">26574340</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref044">
<label>44</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hoel</surname> <given-names>PG</given-names></name>, <name name-style="western"><surname>Port</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Stone</surname> <given-names>CJ</given-names></name>. <source>Introduction to Stochastic Processes</source>. <publisher-name>Waveland Press</publisher-name>; <year>1986</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006336.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huber</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>S</given-names></name>. <article-title>Weighted-ensemble Brownian dynamics simulations for protein association reactions</article-title>. <source>Biophysical Journal</source>. <year>1996</year>;<volume>70</volume>(<issue>8770190</issue>):<fpage>97</fpage>–<lpage>110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0006-3495(96)79552-8" xlink:type="simple">10.1016/S0006-3495(96)79552-8</ext-link></comment> <object-id pub-id-type="pmid">8770190</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allen</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Warren</surname> <given-names>PB</given-names></name>, <name name-style="western"><surname>ten Wolde</surname> <given-names>PR</given-names></name>. <article-title>Sampling Rare Switching Events in Biochemical Networks</article-title>. <source>Physical Review Letters</source>. <year>2005</year>;<volume>94</volume>(<issue>1</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.94.018104" xlink:type="simple">10.1103/PhysRevLett.94.018104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Donovan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sedgewick</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Faeder</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zuckerman</surname> <given-names>D</given-names></name>. <article-title>Efficient stochastic simulation of chemical kinetics networks using a weighted ensemble of trajectories</article-title>. <source>The Journal of chemical physics</source>. <year>2013</year>;<volume>139</volume>(<issue>24070313</issue>):<fpage>115105</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.4821167" xlink:type="simple">10.1063/1.4821167</ext-link></comment> <object-id pub-id-type="pmid">24070313</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dickson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Warmflash</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dinner</surname> <given-names>AR</given-names></name>. <article-title>Nonequilibrium umbrella sampling in spaces of many order parameters</article-title>. <source>The Journal of Chemical Physics</source>. <year>2009</year>;<volume>130</volume>(<issue>7</issue>):<fpage>074104</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.3070677" xlink:type="simple">10.1063/1.3070677</ext-link></comment> <object-id pub-id-type="pmid">19239281</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dickson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Brooks</surname> <given-names>CL</given-names></name>. <article-title>WExplore: Hierarchical Exploration of High-Dimensional Spaces Using the Weighted Ensemble Algorithm</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2014</year>;<volume>118</volume>(<issue>13</issue>):<fpage>3532</fpage>–<lpage>3542</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/jp411479c" xlink:type="simple">10.1021/jp411479c</ext-link></comment> <object-id pub-id-type="pmid">24490961</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jasnow</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zuckerman</surname> <given-names>D</given-names></name>. <article-title>The “weighted ensemble” path sampling method is statistically exact for a broad class of stochastic processes and binning procedures</article-title>. <source>The Journal of chemical physics</source>. <year>2010</year>;<volume>132</volume>(<issue>20136305</issue>):<fpage>054107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.3306345" xlink:type="simple">10.1063/1.3306345</ext-link></comment> <object-id pub-id-type="pmid">20136305</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suárez</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lettieri</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zwier</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Stringer</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Subramanian</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Chong</surname> <given-names>LT</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous Computation of Dynamical and Equilibrium Information Using a Weighted Ensemble of Trajectories</article-title>. <source>Journal of Chemical Theory and Computation</source>. <year>2014</year>;<volume>10</volume>(<issue>7</issue>):<fpage>2658</fpage>–<lpage>2667</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ct401065r" xlink:type="simple">10.1021/ct401065r</ext-link></comment> <object-id pub-id-type="pmid">25246856</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dickson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Warmflash</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dinner</surname> <given-names>AR</given-names></name>. <article-title>Separating forward and backward pathways in nonequilibrium umbrella sampling</article-title>. <source>The Journal of Chemical Physics</source>. <year>2009</year>;<volume>131</volume>(<issue>15</issue>):<fpage>154104</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.3244561" xlink:type="simple">10.1063/1.3244561</ext-link></comment> <object-id pub-id-type="pmid">20568844</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Röblitz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Weber</surname> <given-names>M</given-names></name>. <article-title>Fuzzy spectral clustering by PCCA+: application to Markov state models and data classification</article-title>. <source>Advances in Data Analysis and Classification</source>. <year>2013</year>;<volume>7</volume>(<issue>2</issue>):<fpage>147</fpage>–<lpage>179</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11634-013-0134-6" xlink:type="simple">10.1007/s11634-013-0134-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref054">
<label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Bastian M, Heymann S, Jacomy M. Gephi: An Open Source Software for Exploring and Manipulating Networks; 2009. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.aaai.org/ocs/index.php/ICWSM/09/paper/view/154" xlink:type="simple">http://www.aaai.org/ocs/index.php/ICWSM/09/paper/view/154</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006336.ref055">
<label>55</label>
<mixed-citation publication-type="other" xlink:type="simple">MATLAB and Parallel Computing Toolbox Release 2012b;.</mixed-citation>
</ref>
<ref id="pcbi.1006336.ref056">
<label>56</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Faeder</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Blinov</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Hlavacek</surname> <given-names>WS</given-names></name>. <chapter-title>Rule-Based Modeling of Biochemical Systems with BioNetGen</chapter-title>. In: <source>Systems Biology. Methods in Molecular Biology</source>. <publisher-name>Humana Press</publisher-name>; <year>2009</year>. p. <fpage>113</fpage>–<lpage>167</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://link.springer.com/protocol/10.1007/978-1-59745-525-1_5" xlink:type="simple">https://link.springer.com/protocol/10.1007/978-1-59745-525-1_5</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006336.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harrigan</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Sultan</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Hernández</surname> <given-names>CX</given-names></name>, <name name-style="western"><surname>Husic</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Eastman</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Schwantes</surname> <given-names>CR</given-names></name>, <etal>et al</etal>. <article-title>MSMBuilder: Statistical Models for Biomolecular Dynamics</article-title>. <source>Biophysical Journal</source>. <year>2017</year>;<volume>112</volume>(<issue>1</issue>):<fpage>10</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bpj.2016.10.042" xlink:type="simple">10.1016/j.bpj.2016.10.042</ext-link></comment> <object-id pub-id-type="pmid">28076801</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Tian</surname> <given-names>XJ</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>J</given-names></name>. <article-title>Epigenetic state network approach for describing cell phenotypic transitions</article-title>. <source>Interface Focus</source>. <year>2014</year>;<volume>4</volume>(<issue>3</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsfs.2013.0068" xlink:type="simple">10.1098/rsfs.2013.0068</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chambers</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Silva</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Colby</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nichols</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nijmeijer</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Robertson</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Nanog safeguards pluripotency and mediates germline development</article-title>. <source>Nature</source>. <year>2007</year>;<volume>450</volume>(<issue>7173</issue>):<fpage>1230</fpage>–<lpage>1234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature06403" xlink:type="simple">10.1038/nature06403</ext-link></comment> <object-id pub-id-type="pmid">18097409</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Silva</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nichols</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Theunissen</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>van Oosten</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Barrandon</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Nanog Is the Gateway to the Pluripotent Ground State</article-title>. <source>Cell</source>. <year>2009</year>;<volume>138</volume>(<issue>4</issue>):<fpage>722</fpage>–<lpage>737</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2009.07.039" xlink:type="simple">10.1016/j.cell.2009.07.039</ext-link></comment> <object-id pub-id-type="pmid">19703398</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hay</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Sutherland</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Burdon</surname> <given-names>T</given-names></name>. <article-title>Oct-4 Knockdown Induces Similar Patterns of Endoderm and Trophoblast Differentiation Markers in Human and Mouse Embryonic Stem Cells</article-title>. <source>STEM CELLS</source>. <year>2004</year>;<volume>22</volume>(<issue>2</issue>):<fpage>225</fpage>–<lpage>235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1634/stemcells.22-2-225" xlink:type="simple">10.1634/stemcells.22-2-225</ext-link></comment> <object-id pub-id-type="pmid">14990861</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>. <article-title>Quantifying Waddington landscapes and paths of non-adiabatic cell fate decisions for differentiation, reprogramming and transdifferentiation</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2013</year>;<volume>10</volume>(<issue>89</issue>):<fpage>20130787</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2013.0787" xlink:type="simple">10.1098/rsif.2013.0787</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Constantinides</surname> <given-names>PG</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Gevers</surname> <given-names>W</given-names></name>. <article-title>Functional striated muscle cells from non-myoblast precursors following 5-azacytidine treatment</article-title>. <source>Nature</source>. <year>1977</year>;<volume>267</volume>(<issue>5609</issue>):<fpage>364</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/267364a0" xlink:type="simple">10.1038/267364a0</ext-link></comment> <object-id pub-id-type="pmid">68440</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abranches</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bekman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Henrique</surname> <given-names>D</given-names></name>. <article-title>Generation and Characterization of a Novel Mouse Embryonic Stem Cell Line with a Dynamic Reporter of Nanog Expression</article-title>. <source>PLOS ONE</source>. <year>2013</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e59928</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0059928" xlink:type="simple">10.1371/journal.pone.0059928</ext-link></comment> <object-id pub-id-type="pmid">23527287</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wakayama</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Perry</surname> <given-names>ACF</given-names></name>, <name name-style="western"><surname>Yanagimachi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mombaerts</surname> <given-names>P</given-names></name>. <article-title>Mice cloned from embryonic stem cells</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>1999</year>;<volume>96</volume>(<issue>26</issue>):<fpage>14984</fpage>–<lpage>14989</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.96.26.14984" xlink:type="simple">10.1073/pnas.96.26.14984</ext-link></comment> <object-id pub-id-type="pmid">10611324</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shoemaker</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>W</given-names></name>. <article-title>Systematic Search for Recipes to Generate Induced Pluripotent Stem Cells</article-title>. <source>PLoS Computational Biology</source>. <year>2011</year>;<volume>7</volume>(<issue>12</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002300" xlink:type="simple">10.1371/journal.pcbi.1002300</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>. <article-title>Quantifying the Landscape for Development and Cancer from a Core Cancer Stem Cell Circuit</article-title>. <source>Cancer Research</source>. <year>2015</year>;<volume>75</volume>(<issue>13</issue>):<fpage>2607</fpage>–<lpage>2618</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1158/0008-5472.CAN-15-0079" xlink:type="simple">10.1158/0008-5472.CAN-15-0079</ext-link></comment> <object-id pub-id-type="pmid">25972342</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hepp</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Khammash</surname> <given-names>M</given-names></name>. <article-title>Adaptive hybrid simulations for multiscale stochastic reaction networks</article-title>. <source>The Journal of Chemical Physics</source>. <year>2015</year>;<volume>142</volume>(<issue>3</issue>):<fpage>034118</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.4905196" xlink:type="simple">10.1063/1.4905196</ext-link></comment> <object-id pub-id-type="pmid">25612700</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Donovan</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Tapia</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Sullivan</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Faeder</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Dittrich</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Unbiased Rare Event Sampling in Spatial Stochastic Systems Biology Models Using a Weighted Ensemble of Trajectories</article-title>. <source>PLoS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>2</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004611" xlink:type="simple">10.1371/journal.pcbi.1004611</ext-link></comment> <object-id pub-id-type="pmid">26845334</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maus</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rybacki</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Uhrmacher</surname> <given-names>AM</given-names></name>. <article-title>Rule-based multi-level modeling of cell biological systems</article-title>. <source>BMC Systems Biology</source>. <year>2011</year>;<volume>5</volume>:<fpage>166</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-5-166" xlink:type="simple">10.1186/1752-0509-5-166</ext-link></comment> <object-id pub-id-type="pmid">22005019</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harris</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Hogg</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Tapia</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Sekar</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Korsunsky</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>BioNetGen 2.2: advances in rule-based modeling</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>21</issue>):<fpage>3366</fpage>–<lpage>3368</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw469" xlink:type="simple">10.1093/bioinformatics/btw469</ext-link></comment> <object-id pub-id-type="pmid">27402907</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006336.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Petzold</surname> <given-names>LR</given-names></name>. <article-title>Improved leap-size selection for accelerated stochastic simulation</article-title>. <source>The Journal of Chemical Physics</source>. <year>2003</year>;<volume>119</volume>(<issue>16</issue>):<fpage>8229</fpage>–<lpage>8234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.1613254" xlink:type="simple">10.1063/1.1613254</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>