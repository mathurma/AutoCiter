<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">08-PLCB-RA-0945R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000392</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Comparative Sequence Analysis</subject><subject>Computer Science</subject><subject>Genetics and Genomics/Bioinformatics</subject><subject>Mathematics</subject></subj-group></article-categories><title-group><article-title>Fast Statistical Alignment</article-title><alt-title alt-title-type="running-head">Fast Statistical Alignment</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bradley</surname><given-names>Robert K.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Roberts</surname><given-names>Adam</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Smoot</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Juvekar</surname><given-names>Sudeep</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Do</surname><given-names>Jaeyoung</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Dewey</surname><given-names>Colin</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref><xref ref-type="aff" rid="aff6"><sup>6</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Holmes</surname><given-names>Ian</given-names></name><xref ref-type="aff" rid="aff7"><sup>7</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Pachter</surname><given-names>Lior</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Mathematics, University of California Berkeley, Berkeley, California, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Molecular &amp; Cellular Biology, University of California Berkeley, Berkeley, California, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Electrical Engineering &amp; Computer Science, University of California Berkeley, Berkeley, California, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Department of Bioengineering, University of California San Diego, San Diego, California, United States of America</addr-line>       </aff><aff id="aff5"><label>5</label><addr-line>Department of Computer Sciences, University of Wisconsin, Madison, Wisconsin, United States of America</addr-line>       </aff><aff id="aff6"><label>6</label><addr-line>Department of Biostatistics &amp; Medical Informatics, University of Wisconsin, Madison, Wisconsin, United States of America</addr-line>       </aff><aff id="aff7"><label>7</label><addr-line>Department of Bioengineering, University of California Berkeley, Berkeley, California, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Siepel</surname><given-names>Adam</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Cornell University, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">rbradley@berkeley.edu</email></corresp>
<fn fn-type="con"><p>Wrote the paper: RKB CD LP. Led the development of FSA, wrote most of the code base, and developed the query-specific learning method: RKB. Redesigned the sequence annealing algorithm, constituted the core development team, and managed the project: RKB CD LP. Developed the GUI: AR. Developed a preliminary version of the GUI: MS. Developed the iterative refinement technique: SJ. Developed the parellelization and database modes: JD CD. Provided advice on the dart library, including its algorithms, programming and software components: IH. Created the FSA webserver: LP.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>5</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>29</day><month>5</month><year>2009</year></pub-date><volume>5</volume><issue>5</issue><elocation-id>e1000392</elocation-id><history>
<date date-type="received"><day>22</day><month>10</month><year>2008</year></date>
<date date-type="accepted"><day>20</day><month>4</month><year>2009</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2009</copyright-year><copyright-holder>Bradley et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>We describe a new program for the alignment of multiple biological sequences that is both statistically motivated and fast enough for problem sizes that arise in practice. Our <bold>F</bold>ast <bold>S</bold>tatistical <bold>A</bold>lignment program is based on pair hidden Markov models which approximate an insertion/deletion process on a tree and uses a sequence annealing algorithm to combine the posterior probabilities estimated from these models into a multiple alignment. FSA uses its explicit statistical model to produce multiple alignments which are accompanied by estimates of the alignment accuracy and uncertainty for every column and character of the alignment—previously available only with alignment programs which use computationally-expensive Markov Chain Monte Carlo approaches—yet can align thousands of long sequences. Moreover, FSA utilizes an unsupervised query-specific learning procedure for parameter estimation which leads to improved accuracy on benchmark reference alignments in comparison to existing programs. The centroid alignment approach taken by FSA, in combination with its learning procedure, drastically reduces the amount of false-positive alignment on biological data in comparison to that given by other methods. The FSA program and a companion visualization tool for exploring uncertainty in alignments can be used via a web interface at <ext-link ext-link-type="uri" xlink:href="http://orangutan.math.berkeley.edu/fsa/" xlink:type="simple">http://orangutan.math.berkeley.edu/fsa/</ext-link>, and the source code is available at <ext-link ext-link-type="uri" xlink:href="http://fsa.sourceforge.net/" xlink:type="simple">http://fsa.sourceforge.net/</ext-link>.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Biological sequence alignment is one of the fundamental problems in comparative genomics, yet it remains unsolved. Over sixty sequence alignment programs are listed on Wikipedia, and many new programs are published every year. However, many popular programs suffer from pathologies such as aligning unrelated sequences and producing discordant alignments in protein (amino acid) and codon (nucleotide) space, casting doubt on the accuracy of the inferred alignments. Inaccurate alignments can introduce large and unknown systematic biases into downstream analyses such as phylogenetic tree reconstruction and substitution rate estimation. We describe a new program for multiple sequence alignment which can align protein, RNA and DNA sequence and improves on the accuracy of existing approaches on benchmarks of protein and RNA structural alignments and simulated mammalian and fly genomic alignments. Our approach, which seeks to find the alignment which is closest to the truth under our statistical model, leaves unrelated sequences largely unaligned and produces concordant alignments in protein and codon space. It is fast enough for difficult problems such as aligning orthologous genomic regions or aligning hundreds or thousands of proteins. It furthermore has a companion GUI for visualizing the estimated alignment reliability.</p>
</abstract><funding-group><funding-statement>Ian Holmes was partially supported by NIH/NHGRI grant 1R01GM076705. Lior Pachter was partially supported by NSF CAREER award CCF 03-47992. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="15"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The field of biological sequence alignment is very active, with numerous new alignment programs developed every year in response to increasing demand driven by rapidly-dropping sequencing costs. The list of approximately 60 sequence alignment programs on the wikipedia compilation provides a lower bound on the number of available tools and illustrates the confusing choice facing biologists who seek to select the “best” program for their studies. Nevertheless, the ClustalW program <xref ref-type="bibr" rid="pcbi.1000392-Thompson1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Larkin1">[2]</xref>, published in 1994, remains the most widely-used multiple sequence alignment program. Indeed, in a recent review of multiple sequence alignment <xref ref-type="bibr" rid="pcbi.1000392-Edgar1">[3]</xref>, the authors remark that “to the best of our knowledge, no significant improvements have been made to the [ClustalW] algorithm since 1994 and several modern methods achieve better performance in accuracy, speed, or both.” Therefore, it is natural to ask, “Why do alignment programs continue to be developed, and why are new tools not more widely adopted by biologists?”.</p>
<p>A key issue in understanding the popularity of ClustalW is to recognize that it is difficult to benchmark alignment programs. Alignments represent homology relationships among the nucleotides, or amino acids, of the genomes of extant species, and it is impossible to infer the evolutionary history of genomes with absolute certainty. Comparisons of alignment programs therefore rely on databases of structural alignments for proteins and RNA or on gene loci or simulated data for DNA. Each type of benchmark is vulnerable to manipulation and furthermore may not represent the problem setups which are most relevant to biologists. The result is that biologists are confronted with many programs and publications, but it is frequently unclear which approach will give the best results for the everyday problems which they seek to address.</p>
<p>Adding to the difficulty of selecting software tools is the blur between programs and ideas. Developers of alignment programs make choices about the objective functions to optimize, the statistical models to use, and the parameters for these models, but the relative impact of individual choices is rarely tested <xref ref-type="bibr" rid="pcbi.1000392-Lunter1">[4]</xref>. Discordance among programs is frequently noted <xref ref-type="bibr" rid="pcbi.1000392-Wong1">[5]</xref>, but the different architectures of individual programs, and in some cases the lack of open software, makes it difficult to explore novel combinations of existing ideas for improving alignments.</p>
<p>In lieu of these issues, biologists have favored the conservative approach of using the tried and trusted ClustalW program, although they frequently use it in conjunction with software which allows for manual editing of alignments <xref ref-type="bibr" rid="pcbi.1000392-Clamp1">[6]</xref>. The rationale behind alignment-editing software is that trained experts should be able to correct alignments by visual inspection and that effort is better expended on manually correcting alignments than searching for software that is unlikely to find the “correct” alignment anyway. Although manual editing approaches may be cumbersome, they have been used for large alignments (e.g., <xref ref-type="bibr" rid="pcbi.1000392-Worobey1">[7]</xref>).</p>
<p>We therefore approached the alignment problem with the following goals in mind:</p>
<list list-type="order"><list-item>
<p>An approach which seeks to maximize the expected alignment accuracy. Our approach seeks to find the alignment with minimal expected distance to the true alignment of the input sequences, where the true alignment is treated as a random variable, with the probability of each true alignment determined under a statistical model. Explicitly incorporating a statistically-motivated objective function, this “expected accuracy” approach to alignment allows us to visualize alignments according to estimates of different quality measures, including their expected accuracy, sensitivity, specificity, consistency and certainty. We therefore offer biologists a way to compare alignments that allows them to quantitatively judge differences in alignment quality when they are performing manual edits.</p>
</list-item><list-item>
<p>A method which is robust to variation in evolutionary parameters. We sought a method which is robust to phenomena such as sequences of differing evolutionary distances and base composition. While “phylogenetic alignment” methods seek to accomplish this by explicitly modeling alignments on trees <xref ref-type="bibr" rid="pcbi.1000392-Holmes1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1000392-Novk1">[11]</xref>, a computationally-costly procedure, we use only pairwise comparisons of sequences and allow the pairwise model to vary for each pair considered.</p>
</list-item><list-item>
<p>Robust results when faced with the wide range of alignment problems encountered today. We sought to create a single program which is capable of achieving high accuracies on protein, RNA and DNA sequences without additional input from, e.g., database homology searches. We additionally sought to make our approach fast enough for large-scale problems such as aligning many sequences or orthologous regions of genomes. (When aligning genomic-size sequences, we assume that the sequences are collinear; we do not attempt to solve the problem of resolving duplications or inversions.)</p>
</list-item><list-item>
<p>Creation of a modular code base so that future improvements in one aspect of alignment could easily be incorporated into our approach. In particular, we aimed to create a collaborative infrastructure so that “bioinformaticians with expertise in developing software for comparing genomic DNA sequences [can] pool their ideas and energy to produce a compact tool set that serves a number of needs of biomedical researchers” <xref ref-type="bibr" rid="pcbi.1000392-Miller1">[12]</xref>.</p>
</list-item></list>
<p>The “distance-based” approach to sequence alignment, proposed in <xref ref-type="bibr" rid="pcbi.1000392-Schwartz1">[13]</xref> and implemented in the protein alignment program AMAP <xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref>, offers a useful framework for these goals. Much as distance-based phylogenetic reconstruction methods like Neighbor-Joining build a phylogeny using only pairwise divergence estimates, a distance-based approach to alignment builds a multiple alignment using only pairwise estimations of homology. This is made possible by the sequence annealing technique <xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref> for constructing multiple alignments from pairwise comparisons.</p>
<p>We have implemented our approach in FSA, a new alignment program described below. We give an overview of the structure of FSA and explain the details of its components below. <xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref> contains detailed instructions for using the FSA program and webserver as well as FSA's companion programs for comparing alignments and working with whole-genome alignments.</p>
</sec><sec id="s2">
<title>Methods</title>
<sec id="s2a">
<title>Overview</title>
<p><xref ref-type="fig" rid="pcbi-1000392-g001">Figure 1</xref> shows an overview of the components of the FSA alignment algorithm, described in detail below.</p>
<fig id="pcbi-1000392-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.g001</object-id><label>Figure 1</label><caption>
<title>Overview of the components constituting the FSA alignment program.</title>
<p>The algorithms that are used in each component are highlighted in the accompanying boxes. The bold arrows show the simplest mode of use for FSA, where posterior probabilities are calculated directly using default parameters for all pairs of sequences and the optional steps of anchor finding and iterative refinement are omitted.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.g001" xlink:type="simple"/></fig>
<p>The <bold>input</bold> to FSA is a set of protein, RNA or DNA sequences. These sequences are assumed to be homologous, although FSA is robust to non-homologous sequence. The <bold>output</bold> of FSA is a global alignment of the input sequences which is a (local) optima of the expected accuracy under FSA's statistical model.</p>
<p>FSA first performs pairwise comparisons of the input sequences to determine the posterior probabilities that individual characters are aligned (note, however, that it does not yet actually align any sequences). While the number of possible pairwise comparisons is quadratic in the number of sequences being aligned, giving unfavorable runtimes for datasets of many sequences, FSA overcomes this problem by reducing the number of pairs of sequences that are compared. This is accomplished using a randomized approach inspired by the Erdös-Rényi theory of random graphs, thereby drastically reducing the computational cost of multiple alignment.</p>
<p>After obtaining pairwise estimates of homology at the single-character level, FSA uses the sequence annealing technique <xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref> to construct a multiple alignment. This approach to alignment seeks to maximize the expected accuracy of the alignment using a steepest-ascent (greedy) algorithm.</p>
<p>The architecture of FSA reflects the inherent modularity of the distance-based approach to alignment. FSA's inference engine uses the flexible HMMoC code-generation tool <xref ref-type="bibr" rid="pcbi.1000392-Lunter2">[15]</xref> and has been parallelized with a separate module, alignments of long sequences are anchored with candidate matches found by the MUMmer suffix trie matching tool <xref ref-type="bibr" rid="pcbi.1000392-Kurtz1">[16]</xref> or the exonerate homology-search program <xref ref-type="bibr" rid="pcbi.1000392-Slater1">[17]</xref>, and FSA's sequence annealing algorithm improves on the original algorithm and implementation in AMAP <xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref>. The stand-alone visualization tool uses statistical information produced by FSA, but otherwise is completely independent.</p>
<p>Each of these components can be improved independently of the others, allowing for rapid future improvements in distance-based alignment. For example, FSA's entire statistical model could easily be altered to incorporate position-specific features or completely replaced with a discriminative or hybrid generative-discriminative model.</p>
</sec><sec id="s2b">
<title>Core components</title>
<p>The components described here correspond roughly to the simplest mode of operation for FSA, outlined in bold in <xref ref-type="fig" rid="pcbi-1000392-g001">Figure 1</xref>.</p>
<sec id="s2b1">
<title>Input and output</title>
<p>FSA accepts FASTA-format input files and produces alignments in multi-FASTA or Stockholm format. The server also outputs PHYLIP and ClustalW formatted files.</p>
</sec><sec id="s2b2">
<title>Estimating posterior probabilities of alignment</title>
<p>Distance-based alignment, relying on pairwise estimations of homology, operates on the posterior probability distributions that characters in two sequences are aligned. FSA uses the standard three or five-state pair hidden Markov model (Pair HMM) shown in <xref ref-type="fig" rid="pcbi-1000392-g002">Figure 2</xref> to infer these posterior probabilities of alignment, as well as posterior probabilities that characters are unaligned or gapped. The structure of the Pair HMM and its parameters can be controlled through the command-line options (see <xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref> for details).</p>
<fig id="pcbi-1000392-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.g002</object-id><label>Figure 2</label><caption>
<title>The default Pair HMM used by FSA.</title>
<p>By default FSA uses a Pair HMM with two sets of Insert (I) and Delete (D) states to generate a two-component geometric mixture distribution. FSA can optionally use a three-state HMM, which has only one set of Insert and Delete states. M is a Match state emitting aligned characters.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.g002" xlink:type="simple"/></fig>
<p>The standard Forward-Backward algorithm on a Pair HMM has time complexity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e001" xlink:type="simple"/></inline-formula> for two sequences of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e002" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2b3">
<title>Merging probabilities</title>
<p>After calculating the posterior probabilities of alignment for characters in all sequence pairs, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e003" xlink:type="simple"/></inline-formula> that individual characters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e004" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e005" xlink:type="simple"/></inline-formula> are aligned and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e006" xlink:type="simple"/></inline-formula> that a character <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e007" xlink:type="simple"/></inline-formula> is gapped to sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e008" xlink:type="simple"/></inline-formula>, FSA sorts these probabilities according to a weighting function which gives a hill-climbing procedure which is a steepest-ascent algorithm in the weighting function (<xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref>, “The mathematics of distance-based alignment”).</p>
</sec><sec id="s2b4">
<title>Sequence annealing</title>
<p>After estimating these posterior probabilities and sorting them, FSA creates a multiple alignment with the sequence annealing technique <xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref>. Sequence annealing attempts to find the alignment with the minimum expected distance to the truth (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e009" xlink:type="simple"/></inline-formula>), computed for two sequences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e010" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e011" xlink:type="simple"/></inline-formula> as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e012" xlink:type="simple"/></disp-formula></p>
<p>The distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e013" xlink:type="simple"/></inline-formula> between two alignments is defined as the number of positions for which they make different homology statements, where the homology statement for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e014" xlink:type="simple"/></inline-formula> is either of the form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e015" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e016" xlink:type="simple"/></inline-formula> is homologous to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e017" xlink:type="simple"/></inline-formula>) or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e018" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e019" xlink:type="simple"/></inline-formula> is not homologous to any position in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e020" xlink:type="simple"/></inline-formula>) <xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref>. As a simple count of differing statements of homology (and non-homology), this distance has an intuitive biological interpretation. When one of the alignments is the true alignment, this distance can be thought of as the “evolutionary correctness” of the other, where the correctness of the alignment for each sequence position is equally weighted.</p>
<p>The alignment with the minimum expected distance to the truth is equivalent to the alignment with the maximum expected accuracy,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e021" xlink:type="simple"/></disp-formula>where we define the accuracy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e022" xlink:type="simple"/></inline-formula> of an alignment <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e023" xlink:type="simple"/></inline-formula> with respect to a reference, “true” alignment <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e024" xlink:type="simple"/></inline-formula> as the <italic>fraction</italic> of positions for which they make identical homology statements. In contrast with traditional measures of sensitivity and specificity, accuracy takes into account all positions, rather than just those that are predicted to have a homolog. (Note that it linearly penalizes incorrectly-placed gaps.)</p>
<p>The posterior probabilities over alignments <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e025" xlink:type="simple"/></inline-formula> used in the optimization are given by FSA's statistical model (a Pair HMM). FSA extends this definition of an optimal pairwise alignment to an optimal multiple alignment by taking sum-of-pairs over all sequences.</p>
<p>Using this expected accuracy as an objective function for a greedy maximization, sequence annealing begins with the null alignment (all sequences unaligned) and merges single columns (aligns characters) according to the corresponding expected increase in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e026" xlink:type="simple"/></inline-formula>, the similarity to the truth under FSA's statistical model. Whereas progressive alignment methods take large steps in alignment space by aligning entire sequences at each step, the distance-based approach takes the smallest-possible steps of aligning single characters.</p>
<p>“The mathematics of distance-based alignment” in <xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref> gives an in-depth discussion of the objective function and how it arises naturally from FSA's representation of an alignment as a partially ordered set (POSET) or directed acyclic graph (DAG).</p>
</sec><sec id="s2b5">
<title>Inferring indel events</title>
<p>In FSA's definition of an alignment, an alignment consists solely of a specification of homology. This definition differs from the standard definition of a multiple alignment, which implies an evolutionary history of substitution and indel events. For example, FSA (internally) considers the two alignments shown in <xref ref-type="fig" rid="pcbi-1000392-g003">Figure 3</xref> to be equivalent.</p>
<fig id="pcbi-1000392-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.g003</object-id><label>Figure 3</label><caption>
<title>Two alignments (left and right) which make the same homology statements and therefore are both represented by the same POSET (center).</title>
<p>“The mathematics of distance-based alignment” in <xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref> discusses this view of alignments as POSETs. The alignment on the right minimizes the number of gap-open events and as such is appropriate for analyses such as inferring parsimonious indel frequencies across a clade. Alignments are displayed with TeXshade <xref ref-type="bibr" rid="pcbi.1000392-Beitz1">[63]</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.g003" xlink:type="simple"/></fig>
<p>This is problematic for comparative genomics analyses which use an alignment to infer evolutionary parameters such as indel frequencies across a clade. In order to output a single global alignment from which such evolutionary parameters can be inferred, we choose a topological ordering of the alignment POSET which corresponds to a maximum-parsimony interpretation of indel events. FSA outputs the global alignment with the minimum number of “gap openings” across the individual sequences (the right-hand alignment in <xref ref-type="fig" rid="pcbi-1000392-g003">Figure 3</xref>). As proved in <xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref>, FSA can accomplish this in time linear in the number of sequences and sequence length.</p>
</sec></sec><sec id="s2c">
<title>Optional components</title>
<sec id="s2c1">
<title>Selection of a subset of pairs for alignment speedup</title>
<p>FSA can efficiently align hundreds or even thousands of sequences. By default it performs exhaustive distance-based alignment, which requires an all-pairs comparison of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e027" xlink:type="simple"/></inline-formula> sequences, costing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e028" xlink:type="simple"/></inline-formula>. However, this prohibitive computational cost can be sharply reduced by only performing pairwise comparisons on a subset of all possible <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e029" xlink:type="simple"/></inline-formula> sequence pairs.</p>
<p>In order to ensure a complete alignment, where no sequence is left unaligned, each sequence must be connected to every other sequence by a series of pairwise comparisons. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e030" xlink:type="simple"/></inline-formula> input sequences, a minimum of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e031" xlink:type="simple"/></inline-formula> pairwise comparisons are necessary to give a complete alignment; this corresponds to building a spanning tree on the sequences. While this is sufficient to give a complete alignment on the input sequences, the results will depend heavily on which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e032" xlink:type="simple"/></inline-formula> pairwise comparisons are used to construct the alignment and many choices may give poor alignments. Developing a good theory of which pairs to use to construct the best alignment with the fewest comparisons—how to select a randomized subset of pairs for comparison which falls between the extremes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e033" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e034" xlink:type="simple"/></inline-formula> pairs—remains an open problem.</p>
<p>We therefore chose to use a completely-randomized approach inspired by results from the theory of Erdös-Rényi random graphs. By the Erdös-Rényi theory, a random graph will almost surely be connected if the edge-creation probability satisfies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e035" xlink:type="simple"/></inline-formula>, which is very low for large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e036" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e037" xlink:type="simple"/></inline-formula> is a small positive number). Guided by this result, FSA performs fast alignments by first constructing a spanning tree on the input sequences and then performing each possible pairwise comparison with some probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e038" xlink:type="simple"/></inline-formula> proportional to the connectedness threshold. The savings are dramatic—for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e039" xlink:type="simple"/></inline-formula> sequences, the Erdös-Rényi threshold probability is 0.007, corresponding to an algorithm which is over 100 times as fast as an all-pairs comparison—and we have observed little loss of accuracy from considering only a subset of pairs.</p>
<p>This speedup reduces the time complexity of both inference and sequence annealing. The cost of inference is reduced to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e040" xlink:type="simple"/></inline-formula> and the “worst average case” runtime of sequence annealing to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e041" xlink:type="simple"/></inline-formula>, where we align <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e042" xlink:type="simple"/></inline-formula> sequences of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e043" xlink:type="simple"/></inline-formula> by making <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e044" xlink:type="simple"/></inline-formula> pairwise comparisons (<xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref>, “The mathematics of distance-based alignment”).</p>
</sec><sec id="s2c2">
<title>Finding anchors</title>
<p>FSA can align megabase-long sequences using an “anchor annealing” strategy. Analogously to other genome alignment programs such as MAVID <xref ref-type="bibr" rid="pcbi.1000392-Bray1">[18]</xref>, MLAGAN <xref ref-type="bibr" rid="pcbi.1000392-Brudno1">[19]</xref>, CHAOS/DIALIGN <xref ref-type="bibr" rid="pcbi.1000392-Brudno2">[20]</xref> and Pecan <xref ref-type="bibr" rid="pcbi.1000392-Paten1">[21]</xref>, FSA uses long matches to anchor regions of the alignment and performs inference with dynamic programming in between anchors. FSA's basic anchoring mode uses the fast suffix trie matching program MUMmer <xref ref-type="bibr" rid="pcbi.1000392-Kurtz1">[16]</xref> to find candidate anchors and can find anchors in either nucleotide or protein space (by translating the sequence in all frames). FSA requires that anchors be maximal unique matches in both sequences (“MUMs”). The restriction to unique matches helps to prevent false-positive anchors due to, e.g., repetitive sequence; for example, a microsatellite can appear as a candidate anchor only if it appears exactly once, with identical copy number, in each sequence.</p>
<p>FSA utilizes its distance-based approach to find a consistent set of anchors across all sequences simultaneously, thereby making maximal use of additional constraints from other sequences. This “anchor annealing” strategy is conceptually similar to the procedures used in programs for aligning long sequences such as CHAOS/DIALIGN, MAVID, Pecan and TBA, which return partially-ordered sets of anchors, thereby permitting constraints to be projected across multiple sequences.</p>
<p>As with sequence annealing, this “anchor annealing” can be accomplished efficiently with a greedy algorithm based on the Pearce-Kelly algorithm. FSA uses the same code for both sequence and anchor annealing, although the objective function is different: Anchor “scores” correspond to <italic>p</italic>-values under a null model rather than probabilities of homology, and so there are no “gap” probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e045" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e046" xlink:type="simple"/></inline-formula> which contribute to the anchor-annealing analog of the expected accuracy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e047" xlink:type="simple"/></inline-formula>.</p>
<p>Rather than aligning entire anchors across the multiple alignment in order to find a consistent set of anchors, FSA finds a set of anchor centroids which are consistent across all sequences and then prunes the resulting anchors at a pairwise level. The result is a set of anchors between pairs of sequences whose centroids are consistent across all sequences and which are non-overlapping between pairs of sequences. This heuristic approach permits FSA to quickly find consistent anchors across many sequences.</p>
<p>After finding a consistent set of anchors across the multiple alignment, FSA assumes that these anchors are correctly aligned with probability ∼1 and then aligns the regions between anchors using dynamic programming. When anchored alignment is performed, the posterior probabilities that individual characters are aligned, which FSA uses to inform construction of the multiple alignment, are conditioned on the set of anchors chosen. Therefore, if all anchors correspond to true homology then these probabilities will be correctly estimated despite the anchoring heuristic; however, if incorrect anchors are chosen, then individual probabilities of alignment can be similarly incorrect.</p>
<p>While FSA's restriction of candidate anchors from MUMmer to MUMs produces a very specific set of anchors, the restriction can be too stringent to obtain sensitive alignments of diverged or very long sequences, for which there are few unique exact matches. To address this potential problem, FSA can use the fast homology-search program exonerate <xref ref-type="bibr" rid="pcbi.1000392-Slater1">[17]</xref> to find inexact matches to use as anchors as well. Furthermore, when performing whole-genome alignment, homologous genomic regions are typically first identified with a program such as Mercator <xref ref-type="bibr" rid="pcbi.1000392-Dewey1">[22]</xref> and then each region is aligned with a nucleotide-level alignment program. FSA can use the seed matches, frequently coding genes, which define the homologous genomic regions to inform its anchor annealing.</p>
<p>Because FSA uses the fast tool MUMmer to find anchors, it can rapidly align closely-related sequences, such as mitochondrial DNA, for which anchors span most of the alignment, making costly dynamic programming largely unnecessary.</p>
</sec><sec id="s2c3">
<title>The Pair HMM and parameter estimation</title>
<p>The distinct functional constraints acting on biological sequences give rise to very different patterns of molecular evolution, each implying distinct parameterizations of an appropriate model for alignment. For example, if substitutions or indels are more frequent in one lineage than in the others, then using a single model for all sequences (which does not reflect these differing constraints) can give misleading results. Nonetheless, sequence alignment algorithms traditionally use a single model for all sequences.</p>
<p>In order to overcome these difficulties, FSA uses “query-specific learning,” wherein a different model is learned for each pairwise comparison (the “query”). This is done in a completely unsupervised framework: FSA uses an unsupervised Expectation Maximization (EM) algorithm to estimate transition (gap) and emission (substitution) probabilities of the Pair HMM on the fly.</p>
<p>Despite its unsupervised nature, FSA's query-specific learning needs remarkably little sequence data to effectively learn parameters. Standard alignment algorithms estimate parameters from thousands or tens of thousands of pairs of <italic>aligned</italic> sequences; in contrast, we empirically observe good results with as little input data as two <italic>unaligned</italic> DNA or RNA sequences of length 60 nucleotides or four <italic>unaligned</italic> protein sequences of length 266 amino acids. These figures correspond to observing each of the independent parameters of a substitution matrix four times.</p>
<p>While FSA learns distinct transition parameters for every pair of query sequences regardless of the sequence composition, it uses different learning strategies for nucleotide and amino acid emission matrices. Because a pair emission matrix over aligned nucleotides has only (4<sup>2</sup>−1) = 15 free parameters, FSA can learn a different emission distribution for every pairwise comparison of all but the shortest RNAs or DNAs (this allows FSA to learn a different model for each pair of unanchored subsequences when performing anchored aligment). In contrast, emission matrices over aligned amino acids have (20<sup>2</sup>−1) = 3,999 free parameters, thereby preventing FSA from learning independent models for each pair of proteins. FSA therefore learns a single emission matrix using an all-pairs comparison for protein sequences.</p>
<p>Because FSA uses unsupervised learning on very sparse data, overfitting is a serious concern. FSA attempts to prevent overfitting by (1) using a weak Dirichlet regularizer (prior) when estimating both transition and emission probabilities, and (2) terminating parameter learning before the EM algorithm converges. By default the Dirichlet emission priors are scaled such that total number of pseudocounts for aligned characters is equal to the number of free parameters in a symmetric pair emission matrix. As is the case for other machine-learning algorithms, it can be shown that termination before convergence of query-specific learning is equivalent to a form of regularization (likelihood penalty).</p>
<p>If there is insufficient sequence data for effective learning, then FSA does not estimate parameters and instead uses default parameters to construct an alignment. The default parameters values, as well as seeds used for the learning algorithm, are discussed in <xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref>.</p>
</sec><sec id="s2c4">
<title>Parallelization mode</title>
<p>While FSA can align hundreds or thousands of sequences on a single computer, it can handle truly large-scale problems by running in a parallelized mode on a computer cluster. FSA's distance-based approach to alignment gives the multiple alignment a natural independence structure: each pairwise alignment is independent of all other pairs, allowing dramatic runtime reduction by distributing the individual pairwise computations to different processors.</p>
<p>Two factors were considered for the parallelization of FSA : (1) communication overhead between nodes, and (2) workload distribution over the different processors. For example, distributing jobs in very small batches may reduce processor idle time but lead to high overhead; in contrast, using large batches may increase idle time but minimize overhead. FSA's parallelization mode uses the “Fixed-Size Chunking” strategy described in <xref ref-type="bibr" rid="pcbi.1000392-Kruskal1">[23]</xref>, whereby each of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e048" xlink:type="simple"/></inline-formula> processors runs on chunks of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e049" xlink:type="simple"/></inline-formula> pairwise comparisons.</p>
<p>While the pairwise comparisons can be naturally parallelized, sequence annealing does not have the same obvious independencies. Therefore, even when running in parallelized mode, FSA performs sequence annealing on a single node. The parallelization of the annealing step is a future aim for this project. A schematic of the current parallelization strategy is given in <xref ref-type="fig" rid="pcbi-1000392-g004">Figure 4</xref>.</p>
<fig id="pcbi-1000392-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.g004</object-id><label>Figure 4</label><caption>
<title>Schematic overview of FSA's parallelization strategy on a computer cluster.</title>
<p>For large input sizes, a disk-based database may be used to store some of the primary data structures and reduce memory usage.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.g004" xlink:type="simple"/></fig></sec><sec id="s2c5">
<title>Iterative refinement</title>
<p>As a greedy algorithm, sequence annealing is only guaranteed to find a local optima of the expected accuracy. FSA therefore uses an iterative refinement strategy after sequence annealing terminates to locally improve the alignment. For each round of iterative refinement, FSA looks at every character's position in the multiple alignment and sees whether the objective function can be improved by moving it to another position (without violating the consistency constraints of the multiple alignment). FSA assembles a list of such candidate character shifts, orders the list by the expected change in the objective function, and then performs the shifts. Iterative refinement terminates when there are no candidate shifts which improve the objective function.</p>
</sec><sec id="s2c6">
<title>Visualization</title>
<p>FSA's included GUI permits the user to visually assess alignment quality under FSA's statistical model according to estimates of different measures, including expected accuracy, sensitivity, specificity, consistency and certainty. This permits biologists and bioinformaticians to incorporate reliability measures into downstream analyses, such as evolutionary rate measurements and phylogenetic reconstruction. Incorporating such information can produce distinctly different results. For example, over-aligned non-conserved sequence can cause a systematic bias towards long branch lengths; this can be ameliorated by incorporating the expected accuracy statistics produced by FSA into reconstruction algorithms. <xref ref-type="fig" rid="pcbi-1000392-g005">Figure 5</xref> shows a sample protein alignment colored by the expected alignment accuracy under FSA's statistical model as well as the true accuracy (based on a reference structural alignment).</p>
<fig id="pcbi-1000392-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.g005</object-id><label>Figure 5</label><caption>
<title>The Java GUI allows users to visualize the estimated alignment accuracy under FSA's statistical model.</title>
<p>FSA's alignment is colored according the expected accuracy under FSA's statistical model (top) as well as according to the “true” accuracy (bottom) given from a comparison between FSA's alignment and the reference structural alignment. It is clear from inspection that accuracies estimated under FSA's statistical model correspond closely to the true accuracies. Sequences are from alignment BBS12030 in the RV12 dataset of BAliBASE 3 <xref ref-type="bibr" rid="pcbi.1000392-Thompson2">[24]</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.g005" xlink:type="simple"/></fig>
<p>FSA's GUI can color alignments according to five different measures of alignment quality, which are approximated under its statistical model. Characters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e050" xlink:type="simple"/></inline-formula> in a multiple alignment can be colored according to:</p>
<list list-type="bullet"><list-item>
<p>Accuracy: The expected accuracy with which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e051" xlink:type="simple"/></inline-formula> is aligned to other characters or gaps.</p>
</list-item><list-item>
<p>Sensitivity: The expected sensitivity with which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e052" xlink:type="simple"/></inline-formula> is aligned to other characters.</p>
</list-item><list-item>
<p>Specificity: The expected specificity with which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e053" xlink:type="simple"/></inline-formula> is aligned to other characters.</p>
</list-item><list-item>
<p>Certainty: The certainty with which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e054" xlink:type="simple"/></inline-formula> is aligned correctly (whether there is a good alternate choice).</p>
</list-item><list-item>
<p>Consistency: The consistency of the many pairwise comparisons used to construct the multiple alignment and the implied optimality of the alignment of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000392.e055" xlink:type="simple"/></inline-formula> to other characters or gaps in the multiple alignment.</p>
</list-item></list>
<p>See <xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref> for detailed descriptions of how these measures are defined and calculated using FSA's statistical model.</p>
<p>The GUI also provides a visual and statistical guide when manually editing alignments.</p>
</sec></sec></sec><sec id="s3">
<title>Results</title>
<p>We benchmarked FSA against databases of multiple alignments compiled from reference structural alignments, including protein databases (BAliBASE 3 <xref ref-type="bibr" rid="pcbi.1000392-Thompson2">[24]</xref> and SABmark 1.65 <xref ref-type="bibr" rid="pcbi.1000392-VanWalle1">[25]</xref>), small RNA databases (BRAliBase 2.1 <xref ref-type="bibr" rid="pcbi.1000392-Wilm1">[26]</xref>), large RNA databases (Consan mix80 <xref ref-type="bibr" rid="pcbi.1000392-Dowell1">[27]</xref>), and both mammalian <xref ref-type="bibr" rid="pcbi.1000392-Blanchette1">[28]</xref> and fly <xref ref-type="bibr" rid="pcbi.1000392-Cartwright1">[29]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Varadarajan1">[30]</xref> simulated DNA alignments.</p>
<p>Alignment programs are commonly used to detect homology among input sequences. We conducted a series of false-positive experiments to test whether commonly-used alignment programs can reliably identify homologous and non-homologous sequence. Surprisingly, we found that for most alignment programs, aligned sequences are not necessarily homologous, indicating that biologists should use caution when interpreting the multiple alignments produced by many commonly-used tools.</p>
<p>We additionally performed a simple test of the consistency of common programs when aligning coding sequence: We aligned 1,502 genes orthologous across seven species of yeast in both nucleotide and protein space and compared the resulting alignments. Many programs gave surprisingly discordant results, indicating that at least one of these two alignments produced by commonly-used programs is incorrect.</p>
<sec id="s3a">
<title>Protein sequence</title>
<p><xref ref-type="table" rid="pcbi-1000392-t001">Table 1</xref> shows benchmarks of FSA and other alignment programs, including AMAP <xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref>, ClustalW <xref ref-type="bibr" rid="pcbi.1000392-Thompson1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Larkin1">[2]</xref>, DIALIGN <xref ref-type="bibr" rid="pcbi.1000392-Morgenstern1">[31]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Subramanian1">[32]</xref>, MAFFT <xref ref-type="bibr" rid="pcbi.1000392-Katoh1">[33]</xref>, MUMMALS <xref ref-type="bibr" rid="pcbi.1000392-Pei1">[34]</xref>, MUSCLE <xref ref-type="bibr" rid="pcbi.1000392-Edgar2">[35]</xref>, Probalign <xref ref-type="bibr" rid="pcbi.1000392-Roshan1">[36]</xref>, ProbCons <xref ref-type="bibr" rid="pcbi.1000392-Do1">[37]</xref>, T-Coffee <xref ref-type="bibr" rid="pcbi.1000392-Notredame1">[38]</xref>, and SeqAn::T-Coffee <xref ref-type="bibr" rid="pcbi.1000392-Rausch1">[39]</xref>, against the BAliBASE 3 <xref ref-type="bibr" rid="pcbi.1000392-Thompson2">[24]</xref> and SABmark 1.65 databases <xref ref-type="bibr" rid="pcbi.1000392-VanWalle1">[25]</xref>. FSA in maximum-sensitivity mode had accuracy similar to those of the better-performing programs on BAliBASE 3 and had accuracy superior to that of any other program on SABmark 1.65 when run in default mode. FSA had higher positive predictive values than any other tested program on all datasets. Remarkably, FSA was the only tested program which achieved a mis-alignment rate &lt;50% on the standard SABmark 1.65 datasets; all other programs produced more incorrect than correct homology statements.</p>
<table-wrap id="pcbi-1000392-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t001</object-id><label>Table 1</label><caption>
<title>Benchmarks against protein structural databases.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Program</td>
<td align="left" colspan="1" rowspan="1">BAliBASE 3</td>
<td align="left" colspan="1" rowspan="1">BAliBASE 3+fp</td>
<td align="left" colspan="1" rowspan="1">SABmark 1.65</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">AMAP</td>
<td align="left" colspan="1" rowspan="1">0.70/0.62/0.83</td>
<td align="left" colspan="1" rowspan="1">0.73/0.61/0.80</td>
<td align="left" colspan="1" rowspan="1">0.57/0.43/0.46</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ClustalW</td>
<td align="left" colspan="1" rowspan="1">0.66/0.63/0.62</td>
<td align="left" colspan="1" rowspan="1">0.59/0.63/0.53</td>
<td align="left" colspan="1" rowspan="1">0.38/0.44/0.30</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">DIALIGN</td>
<td align="left" colspan="1" rowspan="1">0.68/0.63/0.68</td>
<td align="left" colspan="1" rowspan="1">0.68/0.62/0.63</td>
<td align="left" colspan="1" rowspan="1">0.48/0.41/0.34</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA</td>
<td align="left" colspan="1" rowspan="1">0.71/0.62/0.85</td>
<td align="left" colspan="1" rowspan="1"><bold>0.75</bold>/0.62/0.84</td>
<td align="left" colspan="1" rowspan="1"><bold>0.59</bold>/0.38/0.52</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA (–maxsn)</td>
<td align="left" colspan="1" rowspan="1">0.73/0.68/0.76</td>
<td align="left" colspan="1" rowspan="1">0.74/0.68/0.72</td>
<td align="left" colspan="1" rowspan="1">0.52/0.45/0.39</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MAFFT</td>
<td align="left" colspan="1" rowspan="1">0.74/0.71/0.71</td>
<td align="left" colspan="1" rowspan="1">0.68/0.71/0.61</td>
<td align="left" colspan="1" rowspan="1">0.44/0.49/0.35</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MUMMALS</td>
<td align="left" colspan="1" rowspan="1">0.74/0.70/0.73</td>
<td align="left" colspan="1" rowspan="1">0.69/0.70/0.64</td>
<td align="left" colspan="1" rowspan="1">0.49/0.52/0.38</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MUSCLE</td>
<td align="left" colspan="1" rowspan="1">0.70/0.67/0.66</td>
<td align="left" colspan="1" rowspan="1">0.63/0.66/0.57</td>
<td align="left" colspan="1" rowspan="1">0.40/0.46/0.32</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Probalign</td>
<td align="left" colspan="1" rowspan="1"><bold>0.76</bold>/0.72/0.73</td>
<td align="left" colspan="1" rowspan="1">0.71/0.71/0.65</td>
<td align="left" colspan="1" rowspan="1">0.49/0.50/0.37</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ProbCons</td>
<td align="left" colspan="1" rowspan="1">0.74/0.70/0.72</td>
<td align="left" colspan="1" rowspan="1">0.69/0.70/0.64</td>
<td align="left" colspan="1" rowspan="1">0.47/0.50/0.37</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">T-Coffee</td>
<td align="left" colspan="1" rowspan="1">0.72/0.67/0.71</td>
<td align="left" colspan="1" rowspan="1">0.67/0.67/0.63</td>
<td align="left" colspan="1" rowspan="1">0.45/0.46/0.35</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SeqAn::T-Coffee</td>
<td align="left" colspan="1" rowspan="1">0.73/0.69/0.70</td>
<td align="left" colspan="1" rowspan="1">0.67/0.69/0.61</td>
<td align="left" colspan="1" rowspan="1">0.43/0.47/0.34</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>Comparisons of the accuracies (Acc), sensitivities (Sn) and positive predictive values (PPV) of FSA and other alignment methods on the BAliBASE 3 <xref ref-type="bibr" rid="pcbi.1000392-Thompson2">[24]</xref> and SABmark 1.65 <xref ref-type="bibr" rid="pcbi.1000392-VanWalle1">[25]</xref> databases. Probalign has the highest accuracy on the commonly-used BAliBASE 3 dataset and FSA in default mode has superior accuracy on the BAliBASE 3+fp and SABmark 1.65 datasets (note that only FSA and AMAP explicitly attempt to maximize the expected accuracy). FSA has higher positive predictive values than any other program on all datasets and can additionally achieve high sensitivity when run in maximum-sensitivity mode. The BAliBASE 3+fp dataset, which mirrors BAliBASE 3 but includes a single non-homologous sequence in each alignment, was designed to test the robustness of alignment programs to incomplete homology. Traditional alignment programs, designed to maximize sensitivity, suffer greatly-increased mis-alignment when even a single non-homologous sequence is introduced; in contrast, FSA is robust to the non-homologous sequence and has an unchanged positive predictive value. Remarkably, FSA was the only tested program with a mis-alignment rate of &lt;50% on the SABmark 1.65 dataset; the majority of the homology statements made by other programs were incorrect. Because the SABmark 1.65 dataset contains many sequences of only partial or even no homology, a method such as FSA which is robust to non-homologous sequence performs better under our accuracy criterion than a program such as MUMMALS despite the fact that MUMMALS has significantly-higher sensitivity on this dataset. The BAliBASE 3 dataset consisted of full-length sequences in all reference sets RV11, RV12, RV20, RV30, RV40 and RV50; we created the BAliBASE 3+fp dataset from the same reference sets by adding a single false-positive, a random sequence, to each alignment. The SABmark 1.65 dataset consisted of the Twilight Zone and Superfamilies datasets.</p></fn></table-wrap-foot></table-wrap>
<p>In order to test the robustness of alignment programs to incomplete homology, we modified the BAliBASE 3 database such that every alignment included a single false-positive, an unrelated (random) sequence. This is a realistic setup for biologists who might want to decide whether a sequence is orthologous to a particular protein family. With the exception of FSA, the tested alignment programs suffered a false-positive rate increased by over 25% on this BAliBASE 3+fp dataset, indicating that they aligned the random sequence with the homologous set. In contrast, FSA left the random sequence unaligned and had an essentially-unchanged false-positive rate.</p>
</sec><sec id="s3b">
<title>RNA sequence</title>
<p><xref ref-type="table" rid="pcbi-1000392-t002">Table 2</xref> shows benchmarks of FSA and the other tested alignment programs against the BRAliBase 2.1 <xref ref-type="bibr" rid="pcbi.1000392-Wilm1">[26]</xref> and Consan mix80 <xref ref-type="bibr" rid="pcbi.1000392-Dowell1">[27]</xref> databases. FSA outperformed all other programs on both datasets.</p>
<table-wrap id="pcbi-1000392-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t002</object-id><label>Table 2</label><caption>
<title>Benchmarks against RNA structural databases.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Program</td>
<td align="left" colspan="1" rowspan="1">BRAliBase 2.1</td>
<td align="left" colspan="1" rowspan="1">Consan mix80</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">ClustalW</td>
<td align="left" colspan="1" rowspan="1">0.85/0.86/0.86</td>
<td align="left" colspan="1" rowspan="1">0.65/0.65/0.68</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">DIALIGN</td>
<td align="left" colspan="1" rowspan="1">0.82/0.83/0.85</td>
<td align="left" colspan="1" rowspan="1">0.76/0.75/0.82</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA</td>
<td align="left" colspan="1" rowspan="1">0.90/0.91/0.94</td>
<td align="left" colspan="1" rowspan="1">0.77/0.74/0.92</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA (–maxsn)</td>
<td align="left" colspan="1" rowspan="1"><bold>0.91</bold>/0.92/0.92</td>
<td align="left" colspan="1" rowspan="1"><bold>0.78</bold>/0.78/0.86</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MAFFT</td>
<td align="left" colspan="1" rowspan="1">0.90/0.91/0.91</td>
<td align="left" colspan="1" rowspan="1">0.77/0.78/0.77</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MUSCLE</td>
<td align="left" colspan="1" rowspan="1">0.90/0.91/0.90</td>
<td align="left" colspan="1" rowspan="1">0.74/0.76/0.74</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ProbConsRNA</td>
<td align="left" colspan="1" rowspan="1">0.91/0.92/0.92</td>
<td align="left" colspan="1" rowspan="1">(failed to align)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">T-Coffee</td>
<td align="left" colspan="1" rowspan="1">0.81/0.82/0.84</td>
<td align="left" colspan="1" rowspan="1">0.38/0.33/0.40</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SeqAn::T-Coffee</td>
<td align="left" colspan="1" rowspan="1">0.89/0.90/0.90</td>
<td align="left" colspan="1" rowspan="1">(failed to align)</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>Comparisons of the accuracies (Acc), sensitivities (Sn) and positive predictive values (PPV) of FSA and other alignment methods on the BRAliBase 2.1 dataset of small RNAs <xref ref-type="bibr" rid="pcbi.1000392-Wilm1">[26]</xref> and the Consan mix80 dataset of Small and Large Subunit ribosomal RNAs <xref ref-type="bibr" rid="pcbi.1000392-Dowell1">[27]</xref>. The BRAliBase 2.1 dataset consisted of all alignments with 15 sequences (the largest alignments). The mix80 dataset provided difficult alignment problems: The four alignments each contain from 107 to 254 sequences of approximately 1–4 kilobases in length, with average percentage identity less than &lt;50%. Two program, ProbConsRNA and SeqAn::T-Coffee, were incapable of aligning these large datasets. When run in –fast mode, FSA considers only a subset (∼20% in this case) of all sequence pairs. Note that because the mix80 dataset consists of long sequences, FSA automatically uses anchoring for speed. FSA does not use anchoring on the short sequences of BRAliBase 2.1.</p></fn></table-wrap-foot></table-wrap>
<p>BRAliBase 2.1 was assembled from the RFAM <xref ref-type="bibr" rid="pcbi.1000392-GriffithsJones1">[40]</xref> RNA database and consists of small RNAs (average length of ∼150 nt). FSA gave improved performance even on this high-identity dataset where most programs did relatively well.</p>
<p>The Consan mix80 dataset of alignments of Small and Large Subunit ribosomal RNAs, assembled from the European Ribosomal RNA database <xref ref-type="bibr" rid="pcbi.1000392-Wuyts1">[41]</xref>, was created for training RNA structural alignment programs and provides a test of alignment programs on difficult, large-scale alignments. The four alignments contain from 107 to 254 sequences, each 1–4 kilobases in length, with average percentage identity less than &lt;50%. Two tested alignment programs, ProbConsRNA <xref ref-type="bibr" rid="pcbi.1000392-Do2">[42]</xref> and SeqAn::T-Coffee, were unable to align these large datasets. This dataset demonstrates that FSA's alignment speedup options, including performing inference only on a subset of all possible pairs (–fast) and anchoring alignments instead of using the full dynamic programming matrix (–anchored), are effective heuristics for large datasets.</p>
</sec><sec id="s3c">
<title>DNA sequence</title>
<p><xref ref-type="table" rid="pcbi-1000392-t003">Table 3</xref> shows benchmarks of FSA and other genomic alignment programs, including CHAOS/DIALIGN <xref ref-type="bibr" rid="pcbi.1000392-Brudno2">[20]</xref>, DIALIGN-TX <xref ref-type="bibr" rid="pcbi.1000392-Morgenstern1">[31]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Subramanian1">[32]</xref>, MAVID <xref ref-type="bibr" rid="pcbi.1000392-Bray1">[18]</xref>, MLAGAN <xref ref-type="bibr" rid="pcbi.1000392-Brudno1">[19]</xref>, Pecan <xref ref-type="bibr" rid="pcbi.1000392-Paten1">[21]</xref> and TBA <xref ref-type="bibr" rid="pcbi.1000392-Blanchette1">[28]</xref>, on simulated alignments of both mammalian and <italic>Drosophila</italic> DNA sequences. FSA produced higher-accuracy alignments than the other programs on the two <italic>Drosophila</italic> datasets and only Pecan gave better alignments of the mammalian sequences.</p>
<table-wrap id="pcbi-1000392-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t003</object-id><label>Table 3</label><caption>
<title>Benchmarks against simulated mammalian and fly genomic DNA.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Program</td>
<td align="left" colspan="1" rowspan="1">Blanchette et al.</td>
<td align="left" colspan="1" rowspan="1">DAWG</td>
<td align="left" colspan="1" rowspan="1">simgenome</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">CHAOS/DIALIGN</td>
<td align="left" colspan="1" rowspan="1">0.58/0.44/0.74</td>
<td align="left" colspan="1" rowspan="1">0.72/0.46/0.43</td>
<td align="left" colspan="1" rowspan="1">0.62/0.67/0.59</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">DIALIGN-TX</td>
<td align="left" colspan="1" rowspan="1">0.73/0.68/0.77</td>
<td align="left" colspan="1" rowspan="1">0.72/0.51/0.44</td>
<td align="left" colspan="1" rowspan="1">0.64/0.68/0.61</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA (–exonerate)</td>
<td align="left" colspan="1" rowspan="1">0.86/0.82/0.93</td>
<td align="left" colspan="1" rowspan="1"><bold>0.81</bold>/0.38/0.74</td>
<td align="left" colspan="1" rowspan="1"><bold>0.79</bold>/0.78/0.84</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA (–exonerate –maxsn)</td>
<td align="left" colspan="1" rowspan="1">0.87/0.85/0.90</td>
<td align="left" colspan="1" rowspan="1">0.75/0.41/0.50</td>
<td align="left" colspan="1" rowspan="1">0.76/0.79/0.77</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MAVID</td>
<td align="left" colspan="1" rowspan="1">0.57/0.45/0.68</td>
<td align="left" colspan="1" rowspan="1">0.66/0.36/0.32</td>
<td align="left" colspan="1" rowspan="1">0.72/0.77/0.72</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MLAGAN</td>
<td align="left" colspan="1" rowspan="1">0.70/0.63/0.80</td>
<td align="left" colspan="1" rowspan="1">0.45/0.39/0.19</td>
<td align="left" colspan="1" rowspan="1">0.71/0.71/0.73</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pecan</td>
<td align="left" colspan="1" rowspan="1"><bold>0.92</bold>/0.91/0.92</td>
<td align="left" colspan="1" rowspan="1">0.77/0.48/0.53</td>
<td align="left" colspan="1" rowspan="1">0.78/0.81/0.78</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">TBA</td>
<td align="left" colspan="1" rowspan="1">0.83/0.81/0.87</td>
<td align="left" colspan="1" rowspan="1">0.80/0.32/0.75</td>
<td align="left" colspan="1" rowspan="1">0.74/0.79/0.72</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt103"><label/><p>Comparisons of the accuracies (Acc), sensitivities (Sn) and positive predictive values (PPV) of FSA and other alignment methods on simulated alignments of mammalian and <italic>Drosophila</italic> DNA. The simulated alignments of nonfunctional DNA sequences (“Blanchette et al.”) from nine mammals (human, chimp, baboon, mouse, rat, cat, dog, cow, and pig) were produced by <xref ref-type="bibr" rid="pcbi.1000392-Blanchette1">[28]</xref>. Simulated alignments of nonfunctional (“DAWG ”) and functional as well as nonfunctional (“simgenome ”) DNA sequences from the twelve species of <italic>Drosophila</italic> described in <xref ref-type="bibr" rid="pcbi.1000392-Clark1">[43]</xref> were produced with the DAWG <xref ref-type="bibr" rid="pcbi.1000392-Cartwright1">[29]</xref> and simgenome <xref ref-type="bibr" rid="pcbi.1000392-Varadarajan1">[30]</xref> programs as described in <xref ref-type="bibr" rid="pcbi.1000392-Varadarajan1">[30]</xref> (both were parametrized based on Pecan alignments of <italic>Drosophila</italic> whole-genome alignments). Three of the simgenome alignments contained sequences of length zero and were removed from this analysis. FSA was run with the –exonerate option to use both anchors from the exonerate program as well as MUMs from MUMmer. FSA had the highest accuracy on the two simulated <italic>Drosophila</italic> datasets and only Pecan had higher accuracy on the mammalian dataset. Pecan consistently produced the most-sensitive aligments.</p></fn></table-wrap-foot></table-wrap>
<p>The simulated alignments of nonfunctional DNA sequences from nine mammals (human, chimp, baboon, mouse, rat, cat, dog, cow, and pig) were created by Blanchette et al. <xref ref-type="bibr" rid="pcbi.1000392-Blanchette1">[28]</xref>. The simulated alignments of DNA from the twelve species of <italic>Drosophila</italic> described in <xref ref-type="bibr" rid="pcbi.1000392-Clark1">[43]</xref> were created with two simulation programs, DAWG <xref ref-type="bibr" rid="pcbi.1000392-Cartwright1">[29]</xref> and simgenome <xref ref-type="bibr" rid="pcbi.1000392-Varadarajan1">[30]</xref>. As described in <xref ref-type="bibr" rid="pcbi.1000392-Varadarajan1">[30]</xref>, the simulated <italic>Drosophila</italic> genomic alignments were created by parameterizing the DAWG and simgenome programs using whole-genome alignments produced by Pecan for <xref ref-type="bibr" rid="pcbi.1000392-Clark1">[43]</xref>. Although two authors (RKB and IH) of this manuscript contributed to the simgenome program, simgenome was developed prior to FSA and did not influence or contribute to the methodology described here for FSA.</p>
<p>FSA's strong performance on all three datasets of simulated long DNA sequences indicate that it is a useful and accurate tool for genomic alignment.</p>
</sec><sec id="s3d">
<title>Unrelated sequence</title>
<p>In order to further test the appropriateness of using popular alignment programs to detect homology between sequences, we conducted a large-scale random-sequence experiment. We generated datasets of random sequences to simulate unrelated protein, short DNA, and genomic (long) DNA sequences. The results, shown in <xref ref-type="table" rid="pcbi-1000392-t004">Table 4</xref> and <xref ref-type="table" rid="pcbi-1000392-t005">Table 5</xref>, clearly demonstrate that while for most alignment programs, aligned sequences are not necessarily homologous, FSA leaves random sequences largely unaligned.</p>
<table-wrap id="pcbi-1000392-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t004</object-id><label>Table 4</label><caption>
<title>Benchmarks against simulated unrelated protein and DNA sequences.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t004" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Program</td>
<td align="left" colspan="1" rowspan="1">Protein</td>
<td align="left" colspan="1" rowspan="1">DNA</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">AMAP</td>
<td align="left" colspan="1" rowspan="1">14%</td>
<td align="left" colspan="1" rowspan="1">n/a</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ClustalW</td>
<td align="left" colspan="1" rowspan="1">97%</td>
<td align="left" colspan="1" rowspan="1">95%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">DIALIGN</td>
<td align="left" colspan="1" rowspan="1">24%</td>
<td align="left" colspan="1" rowspan="1">17%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA</td>
<td align="left" colspan="1" rowspan="1"><bold>4</bold>%</td>
<td align="left" colspan="1" rowspan="1"><bold>5</bold>%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA (–maxsn)</td>
<td align="left" colspan="1" rowspan="1">21%</td>
<td align="left" colspan="1" rowspan="1">17%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MAFFT</td>
<td align="left" colspan="1" rowspan="1">83%</td>
<td align="left" colspan="1" rowspan="1">93%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MUMMALS</td>
<td align="left" colspan="1" rowspan="1">63%</td>
<td align="left" colspan="1" rowspan="1">n/a</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MUSCLE</td>
<td align="left" colspan="1" rowspan="1">89%</td>
<td align="left" colspan="1" rowspan="1">80%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Probalign</td>
<td align="left" colspan="1" rowspan="1">44%</td>
<td align="left" colspan="1" rowspan="1">n/a</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ProbCons</td>
<td align="left" colspan="1" rowspan="1">51%</td>
<td align="left" colspan="1" rowspan="1">77%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">T-Coffee</td>
<td align="left" colspan="1" rowspan="1">63%</td>
<td align="left" colspan="1" rowspan="1">75%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SeqAn::T-Coffee</td>
<td align="left" colspan="1" rowspan="1">74%</td>
<td align="left" colspan="1" rowspan="1">78%</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt104"><label/><p>Large-scale random sequence tests indicate that for most alignment programs, aligned sequences are not necessarily homologous (table shows the fraction of random sequence aligned, calculated by taking a sum-of-pairs over pairwise alignments). Even when run in maximum-sensitivity mode (–maxsn), FSA aligned only a small fraction of the random sequence. We generated 50 datasets, each with 10 random sequences, and ran all programs with default parameters. Protein sequences were 300 aa in length and DNA sequences were 1,000 nt in length. Results reported for ProbCons on DNA sequences were obtained with ProbConsRNA.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000392-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t005</object-id><label>Table 5</label><caption>
<title>Benchmarks against simulated unrelated genomic DNA.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t005-5" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t005" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Program</td>
<td align="left" colspan="1" rowspan="1">Genomic DNA</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">CHAOS/DIALIGN</td>
<td align="left" colspan="1" rowspan="1">10%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ClustalW</td>
<td align="left" colspan="1" rowspan="1">96%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">DIALIGN-TX</td>
<td align="left" colspan="1" rowspan="1">20%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA (–exonerate)</td>
<td align="left" colspan="1" rowspan="1">1%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA (–exonerate –maxsn)</td>
<td align="left" colspan="1" rowspan="1">4%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MAVID</td>
<td align="left" colspan="1" rowspan="1">17%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MLAGAN</td>
<td align="left" colspan="1" rowspan="1">30%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Pecan</td>
<td align="left" colspan="1" rowspan="1">1%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">TBA</td>
<td align="left" colspan="1" rowspan="1"><bold>0%</bold></td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt105"><label/><p>Large-scale random sequence tests for genomic alignment programs. As in <xref ref-type="table" rid="pcbi-1000392-t004">Table 4</xref>, table entries are the fraction of random sequence aligned, calculated by taking a sum-of-pairs over pairwise alignments. FSA aligns a small fraction of random genomic sequence in both its default and maximium-sensitivity (–maxsn) modes. TBA did not align a single base in these tests and was thus the best performer. As the three best-performing programs in this test, TBA, Pecan and FSA –exonerate, all use inexact sequence matches as anchors, the relative performance of these three programs can be explained by the stringency of the anchoring thresholds used: TBA uses the highest threshold by default, Pecan the next-highest and FSA the lowest. All three of these programs show good base-level specificity on the simulated alignments of <xref ref-type="table" rid="pcbi-1000392-t003">Table 3</xref>, for which TBA has the highest specificity on one dataset and FSA on two. The random sequence tests consisted of 50 datasets, each with 10 random DNA sequences (uniform base distribution) of length 50 kb. All programs were run with default parameters. For genomic aligners that required a phylogenetic tree, we used the guide tree computed by ClustalW (rooted via the midpoint algorithm of the PHYLIP <xref ref-type="bibr" rid="pcbi.1000392-Felsenstein1">[64]</xref> retree program).</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3e">
<title>Concordance between amino acid and nucleotide alignments</title>
<p>Biologists commonly align coding regions in both amino acid and nucleotide space, but there have been few studies of the effectiveness of alignment programs across the two regimes. We tested the consistency of alignment programs on coding sequence by aligning all 1,502 genes in <italic>Saccharomyces cerevisiae</italic> identified as having orthologs in the six related yeast species <italic>S. paradoxus</italic>, <italic>S. mikatae</italic>, <italic>S. kudriavzevii</italic>, <italic>S. bayanus</italic>, <italic>S. castellii</italic>, and <italic>S. kluyveri</italic> (<xref ref-type="bibr" rid="pcbi.1000392-Kellis1">[44]</xref>; this dataset was also analyzed in <xref ref-type="bibr" rid="pcbi.1000392-Wong1">[5]</xref>). As shown in <xref ref-type="table" rid="pcbi-1000392-t006">Table 6</xref>, alignments produced by FSA had higher concordance (0.943) than those produced by any other program. If a program produces alignments with low concordance between amino acid and nucleotide alignments, then at least one of the alignments must be incorrect (and quite possibly both are).</p>
<table-wrap id="pcbi-1000392-t006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t006</object-id><label>Table 6</label><caption>
<title>Comparisons of alignments obtained in codon and amino acid space.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t006-6" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t006" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Program</td>
<td align="left" colspan="1" rowspan="1">Alignment similarity (average)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">ClustalW</td>
<td align="left" colspan="1" rowspan="1">0.914</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">DIALIGN</td>
<td align="left" colspan="1" rowspan="1">0.912</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA</td>
<td align="left" colspan="1" rowspan="1"><bold>0.943</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA (–noanchored)</td>
<td align="left" colspan="1" rowspan="1"><bold>0.952</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MAFFT</td>
<td align="left" colspan="1" rowspan="1">0.932</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MUSCLE</td>
<td align="left" colspan="1" rowspan="1">0.915</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ProbCons</td>
<td align="left" colspan="1" rowspan="1">0.902</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">T-Coffee</td>
<td align="left" colspan="1" rowspan="1">0.897</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SeqAn::T-Coffee</td>
<td align="left" colspan="1" rowspan="1">0.905</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt106"><label/><p>We assessed the concordance between alignments obtained in nucleotide and amino acid space by aligning all 1,502 genes in <italic>Saccharomyces cerevisiae</italic> which have orthologs in the six related yeast species <italic>S. paradoxus</italic>, <italic>S. mikatae</italic>, <italic>S. kudriavzevii</italic>, <italic>S. bayanus</italic>, <italic>S. castellii</italic>, and <italic>S. kluyveri</italic> (this dataset was analyzed in <xref ref-type="bibr" rid="pcbi.1000392-Wong1">[5]</xref>). Alignments produced by FSA, in both anchored and unanchored (–noanchored) modes, had the highest concordance. Alignment similarity between alignments computed in nucleotide and amino acid space was assessed by converting the amino acid alignment to the implied nucleotide alignment and computing the alignment similarity (the proportion of identical homology statements made by the alignments; see <xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref>, “The mathematics of distance-based alignment” for details) between them. Alignments for ProbCons on nucleotide sequences were obtained with ProbConsRNA.</p></fn></table-wrap-foot></table-wrap>
<p>This simple test additionally indicates the effectiveness and robustness of FSA's query-specific learning. While very different learning procedures are used for amino acid and nucleotide sequence, the concordant alignments inferred by FSA indicate that our results are robust with respect to the details of the learning procedure.</p>
</sec><sec id="s3f">
<title>Ablation analysis of FSA's components</title>
<p>We conducted an ablation analysis of FSA's components to test the effectiveness of each component and ensure that they all contributed to the accuracy of the program. As indicated by the results in <xref ref-type="table" rid="pcbi-1000392-t007">Tables 7</xref>–<xref ref-type="table" rid="pcbi-1000392-t008"/><xref ref-type="table" rid="pcbi-1000392-t009"/><xref ref-type="table" rid="pcbi-1000392-t010">10</xref>, each optional component of FSA contributes to its accuracy.</p>
<table-wrap id="pcbi-1000392-t007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t007</object-id><label>Table 7</label><caption>
<title>Ablation analysis of FSA on protein structural databases.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t007-7" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t007" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">FSA options</td>
<td align="left" colspan="1" rowspan="1">BAliBASE 3</td>
<td align="left" colspan="1" rowspan="1">BAliBASE 3+fp</td>
<td align="left" colspan="1" rowspan="1">SABmark 1.65</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">(default)</td>
<td align="left" colspan="1" rowspan="1">0.71/0.62/0.85</td>
<td align="left" colspan="1" rowspan="1"><bold>0.75</bold>/0.62/0.84</td>
<td align="left" colspan="1" rowspan="1"><bold>0.59</bold>/0.38/0.52</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–fast</td>
<td align="left" colspan="1" rowspan="1">0.70/0.61/0.85</td>
<td align="left" colspan="1" rowspan="1">0.74/0.62/0.84</td>
<td align="left" colspan="1" rowspan="1">0.59/0.37/0.52</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–nolearn</td>
<td align="left" colspan="1" rowspan="1">0.72/0.65/0.81</td>
<td align="left" colspan="1" rowspan="1">0.75/0.65/0.79</td>
<td align="left" colspan="1" rowspan="1">0.56/0.44/0.44</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–refinement 0</td>
<td align="left" colspan="1" rowspan="1">0.70/0.61/0.85</td>
<td align="left" colspan="1" rowspan="1">0.74/0.61/0.84</td>
<td align="left" colspan="1" rowspan="1">0.59/0.37/0.52</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–noindel2</td>
<td align="left" colspan="1" rowspan="1">0.70/0.61/0.85</td>
<td align="left" colspan="1" rowspan="1">0.74/0.60/0.84</td>
<td align="left" colspan="1" rowspan="1">0.59/0.38/0.52</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–maxsn</td>
<td align="left" colspan="1" rowspan="1"><bold>0.73</bold>/0.68/0.76</td>
<td align="left" colspan="1" rowspan="1">0.74/0.68/0.72</td>
<td align="left" colspan="1" rowspan="1">0.52/0.45/0.39</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–fast –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.73/0.67/0.76</td>
<td align="left" colspan="1" rowspan="1">0.73/0.67/0.71</td>
<td align="left" colspan="1" rowspan="1">0.52/0.44/0.39</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–nolearn –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.73/0.68/0.74</td>
<td align="left" colspan="1" rowspan="1">0.70/0.68/0.67</td>
<td align="left" colspan="1" rowspan="1">0.49/0.47/0.37</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–refinement 0 –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.72/0.66/0.78</td>
<td align="left" colspan="1" rowspan="1">0.73/0.66/0.73</td>
<td align="left" colspan="1" rowspan="1">0.53/0.43/0.39</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–noindel2 –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.73/0.68/0.76</td>
<td align="left" colspan="1" rowspan="1">0.72/0.68/0.70</td>
<td align="left" colspan="1" rowspan="1">0.51/0.45/0.39</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt107"><label/><p>Ablation analysis of FSA on the protein benchmarks of <xref ref-type="table" rid="pcbi-1000392-t001">Table 1</xref> : Comparisons of the accuracies (Acc), sensitivities (Sn) and positive predictive values (PPV) of FSA with different components enabled or disabled. From top to bottom, FSA was run in default mode, –fast mode, with learning disabled, with iterative refinement disabled, and with 1 set (rather than 2 sets) of indel states; these options were then repeated for maximum-sensitivity mode (–maxsn). As made evident by the results (PPV) on the BAliBASE 3+fp and SABmark 1.65 datasets, query-specific learning helps FSA to distinguish homologous and non-homologous sequences. The above figures understate the utility of iterative refinement: while it generally has little effect on these small protein alignments, it occasionally dramatically reduces the number of small gaps and thereby improves the alignment accuracy.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000392-t008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t008</object-id><label>Table 8</label><caption>
<title>Ablation analysis of FSA on RNA structural databases.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t008-8" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t008" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">FSA options</td>
<td align="left" colspan="1" rowspan="1">BRAliBase 2.1</td>
<td align="left" colspan="1" rowspan="1">FSA options</td>
<td align="left" colspan="1" rowspan="1">Consan mix80</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">(default)</td>
<td align="left" colspan="1" rowspan="1">0.90/0.91/0.94</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–fast</td>
<td align="left" colspan="1" rowspan="1">0.90/0.91/0.94</td>
<td align="left" colspan="1" rowspan="1">–fast</td>
<td align="left" colspan="1" rowspan="1">0.77/0.74/0.92</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–nolearn</td>
<td align="left" colspan="1" rowspan="1">0.91/0.92/0.93</td>
<td align="left" colspan="1" rowspan="1">–nolearn –fast</td>
<td align="left" colspan="1" rowspan="1">0.77/0.74/0.93</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–refinement 0</td>
<td align="left" colspan="1" rowspan="1">0.90/0.91/0.93</td>
<td align="left" colspan="1" rowspan="1">–refinement 0 –fast</td>
<td align="left" colspan="1" rowspan="1">0.73/0.69/0.94</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–noindel2</td>
<td align="left" colspan="1" rowspan="1">0.91/0.92/0.93</td>
<td align="left" colspan="1" rowspan="1">–noindel2 –fast</td>
<td align="left" colspan="1" rowspan="1">0.73/0.69/0.91</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">–noanchored –fast</td>
<td align="left" colspan="1" rowspan="1">0.77/0.74/0.93</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–maxsn</td>
<td align="left" colspan="1" rowspan="1"><bold>0.91</bold>/0.92/0.92</td>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–fast –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.91/0.92/0.92</td>
<td align="left" colspan="1" rowspan="1">–fast –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.78/0.78/0.86</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–nolearn –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.91/0.92/0.92</td>
<td align="left" colspan="1" rowspan="1">–nolearn –fast –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.78/0.78/0.85</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–refinement 0 –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.90/0.91/0.93</td>
<td align="left" colspan="1" rowspan="1">–refinement 0 –fast –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.74/0.70/0.92</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–noindel2 –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.91/0.92/0.92</td>
<td align="left" colspan="1" rowspan="1">–noindel2 –fast –maxsn</td>
<td align="left" colspan="1" rowspan="1">0.74/0.73/0.84</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">–noanchored –fast –maxsn</td>
<td align="left" colspan="1" rowspan="1"><bold>0.79</bold>/0.79/0.85</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt108"><label/><p>Ablation analysis of FSA on the RNA benchmarks of <xref ref-type="table" rid="pcbi-1000392-t002">Table 2</xref> : Comparisons of the accuracies (Acc), sensitivities (Sn) and positive predictive values (PPV) of FSA with different components enabled or disabled. From top to bottom, FSA was run in default mode, –fast mode, with learning disabled, with iterative refinement disabled, with 1 set (rather than 2 sets) of indel states, and with anchored disabled; these options were then repeated for maximum-sensitivity mode (–maxsn). Iterative refinement is important for the large alignments of the mix80 dataset.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000392-t009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t009</object-id><label>Table 9</label><caption>
<title>Ablation analysis of FSA on simulated mammalian genomic DNA.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t009-9" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t009" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">FSA options</td>
<td align="left" colspan="1" rowspan="1">Blanchette et al.</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">(Acc/Sn/PPV)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">(default)</td>
<td align="left" colspan="1" rowspan="1">0.53/0.32/0.93</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–exonerate</td>
<td align="left" colspan="1" rowspan="1">0.83/0.77/0.94</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–exonerate –minscore 50</td>
<td align="left" colspan="1" rowspan="1"><bold>0.83</bold>/0.78/0.94</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–exonerate –refinement 0</td>
<td align="left" colspan="1" rowspan="1">0.82/0.76/0.93</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–exonerate –noindel2</td>
<td align="left" colspan="1" rowspan="1">0.78/0.72/0.94</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt109"><label/><p>Ablation analysis of FSA on the simulated mammalian DNA of <xref ref-type="table" rid="pcbi-1000392-t003">Table 3</xref> : Comparisons of the accuracies (Acc), sensitivities (Sn) and positive predictive values (PPV) of FSA with different components enabled or disabled. We tested the effectiveness of components related to anchor annealing for aligning long sequences, including using anchors from MUMmer and exonerate and changing the minimum acceptable score for an exonerate anchor (the default is –minscore 100). These results clearly show that while using only MUMs for anchoring (the default mode) gives a high positive predictive value, inexact matches must be used to obtain high sensitivity on very long or distant nonfunctional sequences lacking the local constraints which give rise to MUMs across species in functional (e.g., coding) sequence.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000392-t010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t010</object-id><label>Table 10</label><caption>
<title>Ablation analysis of FSA on simulated unrelated protein and DNA sequences.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t010-10" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t010" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">FSA options</td>
<td align="left" colspan="1" rowspan="1">Protein</td>
<td align="left" colspan="1" rowspan="1">DNA</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">(default)</td>
<td align="left" colspan="1" rowspan="1">4%</td>
<td align="left" colspan="1" rowspan="1">5%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–fast</td>
<td align="left" colspan="1" rowspan="1">4%</td>
<td align="left" colspan="1" rowspan="1">5%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–nolearn</td>
<td align="left" colspan="1" rowspan="1">13%</td>
<td align="left" colspan="1" rowspan="1">8%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–refinement 0</td>
<td align="left" colspan="1" rowspan="1"><bold>3</bold>%</td>
<td align="left" colspan="1" rowspan="1"><bold>5</bold>%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–noindel2</td>
<td align="left" colspan="1" rowspan="1">5%</td>
<td align="left" colspan="1" rowspan="1">10%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–maxsn</td>
<td align="left" colspan="1" rowspan="1">21%</td>
<td align="left" colspan="1" rowspan="1">17%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–fast –maxsn</td>
<td align="left" colspan="1" rowspan="1">22%</td>
<td align="left" colspan="1" rowspan="1">17%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–nolearn –maxsn</td>
<td align="left" colspan="1" rowspan="1">30%</td>
<td align="left" colspan="1" rowspan="1">16%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–refinement 0 –maxsn</td>
<td align="left" colspan="1" rowspan="1">19%</td>
<td align="left" colspan="1" rowspan="1">15%</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">–noindel2 –maxsn</td>
<td align="left" colspan="1" rowspan="1">27%</td>
<td align="left" colspan="1" rowspan="1">21%</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt110"><label/><p>Ablation analysis of FSA on the unrelated sequence benchmarks of <xref ref-type="table" rid="pcbi-1000392-t004">Table 4</xref> : Comparisons of the accuracies (Acc), sensitivities (Sn) and positive predictive values (PPV) of FSA with different components enabled or disabled. From top to bottom, FSA was run in default mode, –fast mode, with learning disabled, with iterative refinement disabled, and with 1 set (rather than 2 sets) of indel states; these options were then repeated for maximum-sensitivity mode (–maxsn). Query-specific learning helps to make FSA robust to non-homologous sequence.</p></fn></table-wrap-foot></table-wrap>
<p>The importance of each component depends strongly upon the alignment problem. The –fast heuristic for reducing the number of sequence pairs used to construct an alignment results in little loss of accuracy, at least on the benchmarks used in this paper (<xref ref-type="table" rid="pcbi-1000392-t007">Tables 7</xref> and <xref ref-type="table" rid="pcbi-1000392-t008">8</xref>). As indicated by the small and long RNA benchmarks (<xref ref-type="table" rid="pcbi-1000392-t008">Table 8</xref>), iterative refinement is important for aligning many sequences and less so for small alignment problems. The anchor annealing procedure appears to be an effective heuristic for aligning long sequences. Anchoring with unique matches (MUMs) causes only a negligible loss of accuracy on the long RNA dataset (<xref ref-type="table" rid="pcbi-1000392-t008">Table 8</xref>). However, results on simulated long DNA sequences (<xref ref-type="table" rid="pcbi-1000392-t009">Table 9</xref>) demonstrate that inexact matches, such as those returned by exonerate, must be used during anchor annealing to obtain high sensitivity on very long or distant nonfunctional DNA sequences. Nonfunctional DNA lacks the local constraints which preserve exact matches across distant species in functional (e.g., coding) sequence. Query-specific learning is important for maintaining FSA's robustness to non-homologous sequence. While FSA aligned only 4% of random protein sequences in default mode, when run without learning it aligned 13% (<xref ref-type="table" rid="pcbi-1000392-t010">Table 10</xref>), similar to the 14% aligned by AMAP (<xref ref-type="table" rid="pcbi-1000392-t004">Table 4</xref>).</p>
</sec><sec id="s3g">
<title>Runtimes and parallelization</title>
<p>Biologists commonly perform alignments of hundreds or thousands of 16S ribosomal DNA sequences in order to elucidate evolutionary relationships and build phylogenetic trees. We performed alignments of prokaryotic 16S sequences to compare the speed of commonly-used programs (<xref ref-type="table" rid="pcbi-1000392-t011">Table 11</xref>). MAFFT was the fastest method by an order of magnitude; MUSCLE and FSA were the next-fastest methods. Many alignment programs were unable to align these large datasets.</p>
<table-wrap id="pcbi-1000392-t011" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t011</object-id><label>Table 11</label><caption>
<title>Timing comparison of FSA and other methods on 16S sequences.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t011-11" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t011" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Program</td>
<td align="left" colspan="1" rowspan="1">100</td>
<td align="left" colspan="1" rowspan="1">200</td>
<td align="left" colspan="1" rowspan="1">300</td>
<td align="left" colspan="1" rowspan="1">400</td>
<td align="left" colspan="1" rowspan="1">500 seqs</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">ClustalW</td>
<td align="left" colspan="1" rowspan="1">1,194 s</td>
<td align="left" colspan="1" rowspan="1">4,147 s</td>
<td align="left" colspan="1" rowspan="1">9,110 s</td>
<td align="left" colspan="1" rowspan="1">16,187 s</td>
<td align="left" colspan="1" rowspan="1">27,755 s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">DIALIGN</td>
<td align="left" colspan="1" rowspan="1">4,346 s</td>
<td align="left" colspan="1" rowspan="1">19,449 s</td>
<td align="left" colspan="1" rowspan="1">49,388 s</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA –fast</td>
<td align="left" colspan="1" rowspan="1">1,513 s</td>
<td align="left" colspan="1" rowspan="1">3754 s</td>
<td align="left" colspan="1" rowspan="1">5,641 s</td>
<td align="left" colspan="1" rowspan="1">9,767 s</td>
<td align="left" colspan="1" rowspan="1">15,683 s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA –fast –noindel2 –refinement 0</td>
<td align="left" colspan="1" rowspan="1">638 s</td>
<td align="left" colspan="1" rowspan="1">1,495 s</td>
<td align="left" colspan="1" rowspan="1">2,467 s</td>
<td align="left" colspan="1" rowspan="1">3,604 s</td>
<td align="left" colspan="1" rowspan="1">5,154 s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MAFFT</td>
<td align="left" colspan="1" rowspan="1"><bold>31 s</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>105 s</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>243 s</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>442 s</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>54 s</bold></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">MUSCLE</td>
<td align="left" colspan="1" rowspan="1">351 s</td>
<td align="left" colspan="1" rowspan="1">1,235 s</td>
<td align="left" colspan="1" rowspan="1">1,516 s</td>
<td align="left" colspan="1" rowspan="1">4,384 s</td>
<td align="left" colspan="1" rowspan="1">7,552 s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">ProbConsRNA</td>
<td align="left" colspan="1" rowspan="1">16,319 s</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">T-Coffee</td>
<td align="left" colspan="1" rowspan="1">1,362 s</td>
<td align="left" colspan="1" rowspan="1">3,666 s</td>
<td align="left" colspan="1" rowspan="1">7,880 s</td>
<td align="left" colspan="1" rowspan="1">15,254 s</td>
<td align="left" colspan="1" rowspan="1">22,085 s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">SeqAn::T-Coffee</td>
<td align="left" colspan="1" rowspan="1">3,024 s</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
<td align="left" colspan="1" rowspan="1">(fail)</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt111"><label/><p>Comparison of runtimes of FSA and other alignment methods when aligning 16S ribosomal sequences. MAFFT was faster than any other method by an order of magnitude; the next-fastest programs were MUSCLE and FSA. FSA can be made substantially faster by using a 3-state, rather than the default 5-state, HMM (with little loss of accuracy; see <xref ref-type="table" rid="pcbi-1000392-t008">Table 8</xref>) and disabling iterative refinement. MAFFT was run with the –auto option, which presumably triggered a faster alignment mode on the 500 sequence dataset than was used for the datasets with fewer sequences. The designation “(fail)” means that a programs failed to align a dataset (generally due to out-of-memory errors). Timing results are from computers with 2.40 GHz CPUs and 2 GB of RAM. 16S sequences were obtained as a random slice of prokMSA from Greengenes <xref ref-type="bibr" rid="pcbi.1000392-DeSantis1">[65]</xref> and had an average length of 1,450 nt.</p></fn></table-wrap-foot></table-wrap>
<p>The results in <xref ref-type="table" rid="pcbi-1000392-t012">Table 12</xref> and <xref ref-type="table" rid="pcbi-1000392-t013">Table 13</xref> demonstrate the effectiveness of FSA's parallelization mode. Parallelizing the pairwise comparisons dramatically reduces runtime: When running in –fast mode on a small cluster with 10 processors, FSA can align 500 16S sequences in 20% of the time required without parallelization.</p>
<table-wrap id="pcbi-1000392-t012" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t012</object-id><label>Table 12</label><caption>
<title>Timing comparison of FSA in regular and parallelized modes.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t012-12" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t012" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">FSA options</td>
<td align="left" colspan="1" rowspan="1">100</td>
<td align="left" colspan="1" rowspan="1">200</td>
<td align="left" colspan="1" rowspan="1">300</td>
<td align="left" colspan="1" rowspan="1">500</td>
<td align="left" colspan="1" rowspan="1">1,000 seqs</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">FSA</td>
<td align="left" colspan="1" rowspan="1">6,407 s</td>
<td align="left" colspan="1" rowspan="1">27,534 s</td>
<td align="left" colspan="1" rowspan="1">—</td>
<td align="left" colspan="1" rowspan="1">—</td>
<td align="left" colspan="1" rowspan="1">—</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA –parallelize 10</td>
<td align="left" colspan="1" rowspan="1">819 s</td>
<td align="left" colspan="1" rowspan="1">5,713 s</td>
<td align="left" colspan="1" rowspan="1">22,113 s</td>
<td align="left" colspan="1" rowspan="1">—</td>
<td align="left" colspan="1" rowspan="1">—</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA –fast</td>
<td align="left" colspan="1" rowspan="1">1,650 s</td>
<td align="left" colspan="1" rowspan="1">3,781 s</td>
<td align="left" colspan="1" rowspan="1">6,207 s</td>
<td align="left" colspan="1" rowspan="1">12,249 s</td>
<td align="left" colspan="1" rowspan="1">—</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">FSA –fast –parallelize 10</td>
<td align="left" colspan="1" rowspan="1">201 s</td>
<td align="left" colspan="1" rowspan="1">513 s</td>
<td align="left" colspan="1" rowspan="1">924 s</td>
<td align="left" colspan="1" rowspan="1">2,511 s</td>
<td align="left" colspan="1" rowspan="1">15,179 s</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt112"><label/><p>Runtimes for FSA in regular, –fast and –parallelize modes when aligning the 16S sequences of <xref ref-type="table" rid="pcbi-1000392-t011">Table 11</xref> sequences in unanchored mode (–noanchored) with a 3-state HMM (–noindel2) and refinement disabled (–refinement 0). When running in –fast mode on a cluster with 10 processors (3.00 and 3.20 GHz; 8 GB of RAM), FSA can align 500 16S sequences in 20% of the time required without parallelization. The parallelized FSA was run on a cluster managed by the Condor batch queueing system <xref ref-type="bibr" rid="pcbi.1000392-1">[66]</xref>; nodes were connected by a 100 Mbps Ethernet network. Note that these runtimes are much slower than users can expect from default FSA usage, which uses anchoring for speed (<xref ref-type="table" rid="pcbi-1000392-t011">Table 11</xref>); we used unanchored mode to make clear the benefits of parallelization.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000392-t013" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000392.t013</object-id><label>Table 13</label><caption>
<title>Timing comparison of FSA in parallelized mode with different numbers of processors.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000392-t013-13" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.t013" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">1</td>
<td align="left" colspan="1" rowspan="1">5</td>
<td align="left" colspan="1" rowspan="1">10</td>
<td align="left" colspan="1" rowspan="1">15</td>
<td align="left" colspan="1" rowspan="1">20 processors</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">100 seqs</td>
<td align="left" colspan="1" rowspan="1">1,650 s</td>
<td align="left" colspan="1" rowspan="1">365 s</td>
<td align="left" colspan="1" rowspan="1">214 s</td>
<td align="left" colspan="1" rowspan="1">135 s</td>
<td align="left" colspan="1" rowspan="1">105 s</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">200 seqs</td>
<td align="left" colspan="1" rowspan="1">3,781 s</td>
<td align="left" colspan="1" rowspan="1">889 s</td>
<td align="left" colspan="1" rowspan="1">506 s</td>
<td align="left" colspan="1" rowspan="1">385 s</td>
<td align="left" colspan="1" rowspan="1">355 s</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt113"><label/><p>Runtimes for FSA in –fast –parallelize P mode as a function of the number of processors P in the computer cluster with a 3-state HMM (–noindel2) and refinement disabled (–refinement 0). Sequences and cluster specifications are same as for <xref ref-type="table" rid="pcbi-1000392-t012">Table 12</xref>.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s4">
<title>Discussion</title>
<p>In the Introduction we highlighted four design criteria which we emphasized in the development of FSA. The first goal was to find alignments with high expected accuracy, where an accurate alignment has minimal distance to the truth. This objective function is markedly different from both the maximum-likelihood approaches used by programs such as ClustalW and MUSCLE and the maximum expected sensitivity approaches used by programs such as ProbCons and Pecan. Note that while the objective function used in ProbCons is called “maximum expected accuracy” in the paper <xref ref-type="bibr" rid="pcbi.1000392-Do1">[37]</xref>, it is actually a maximum expected sensitivity objective function, where there is no penalty for over-aligning sequence (c.f., the results shown in <xref ref-type="table" rid="pcbi-1000392-t004">Table 4</xref>). Their objective function can be recovered as a special case of our approach by ignoring the gap probabilities in FSA's objective function (<xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref>, “The mathematics of distance-based alignment”). FSA's explicit search for the most accurate, rather than most likely or most sensitive, alignment is what allows FSA to so dramatically outperform most other programs on tests on unrelated sequence (<xref ref-type="table" rid="pcbi-1000392-t004">Table 4</xref>).</p>
<p>We believe that this accuracy criterion, which gives equal weight to the correctness of all sequence positions, is a natural measure of alignment quality. Downstream analyses, such as phylogenetic reconstruction and evolutionary constraint analysis, are increasingly using indels in addition to homologous characters for more accurate estimation (e.g., <xref ref-type="bibr" rid="pcbi.1000392-Ogurtsov1">[45]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Rivas1">[46]</xref>). Thus, it is important that alignments be as “evolutionarily correct” as possible <xref ref-type="bibr" rid="pcbi.1000392-Loytynoja1">[47]</xref>, which is the purpose of the accuracy criterion.</p>
<p>FSA's strong performance under the accuracy criterion is due to techniques such as its iterative refinement as well as its explicit attempt to maximize the expected accuracy; programs which explicitly seek to maximize an objective function of the posterior probabilities of character alignment, such as ProbCons or Probalign, could instead seek to maximize the expected accuracy described here and, as a likely result, increase their robustness to non-homologous sequence. However, while we believe that the expected accuracy is a biologically-sensible objective function, it may not be appropriate if the user desires the most sensitive alignment. While FSA can produce the most-sensitive RNA alignments, other programs can produce more sensitive alignments of proteins and genomic sequence, albeit generally at the cost of a tendency to align non-homologous sequence (<xref ref-type="table" rid="pcbi-1000392-t004">Table 4</xref>).</p>
<p>The second goal was to create alignments which are robust to evolutionary distances and different functional constraints on patterns of molecular evolution. FSA's unsupervised query-specific learning for parameter selection frees the user from unknown systematic biases implicitly introduced by using an alignment program whose parameters were trained on a dataset whose statistics may not reflect those of the sequences to be aligned. For example, it is traditionally challenging to align sequences with unusual base composition, but FSA can easily handle such alignments by automatically learning appropriate parameters. As indicated by our ablation analysis, query-specific learning further increases FSA's robustness to non-homologous sequences beyond that offered by the minimum-distance objective function alone.</p>
<p>We believe that FSA's unsupervised query-specific learning is the first time a multiple alignment program has been capable of dynamically learning a complete parameterization, wherein parameters can vary for each pair of sequences to be compared, on the fly. This learning method is related to the “pre-training” option in ProbCons, which permits users to learn different models for families of homologous sequences, but does not permit parameterizations to vary between sequence pairs. We also note that the MORPH program for pairwise alignment of sequences with <italic>cis</italic>-regulatory modules learns model transition parameters from data <xref ref-type="bibr" rid="pcbi.1000392-Sinha1">[48]</xref>. While supervised training on curated data can give superior performance on test sets which are statistically-similar to the training data, the practical alignment problems encountered everyday by biologists do not fit into this rigid problem setup. Query-specific learning consistently gives reasonable performance.</p>
<p>The third and fourth goals, to develop a single, modular program which can address all typical alignment problems encountered by biologists, are naturally achieved within FSA's architecture. While almost all alignment programs are designed to either align many short sequences or a few long sequences, we have demonstrated that it is feasible to create a single program which can address both situations. This is made practical by FSA's modular nature, where the statistical model for pairwise comparisons, the anchoring scheme for finding homology between long sequences, and the sequence annealing procedure are entirely separate and can be individually modified and improved. For example, the parallelization of FSA was designed and developed with minimal changes to the rest of FSA's code base. Similarly, while FSA's basic anchoring relies only on exact matches from MUMmer, the anchoring scheme was easily extended to incorporate inexact matches from exonerate <xref ref-type="bibr" rid="pcbi.1000392-Slater1">[17]</xref> and alignment constraints from Mercator <xref ref-type="bibr" rid="pcbi.1000392-Dewey1">[22]</xref>. In fact, this flexibility permits FSA to incorporate almost any sources of potential homology information, from predicted transcription factor binding sites to entire gene models. One natural extension of FSA's approach is to models of RNA alignment which take structure into account. The program Stemloc-AMA <xref ref-type="bibr" rid="pcbi.1000392-Bradley2">[49]</xref> uses a model of the pairwise evolution of RNA secondary structure in conjunction with the sequence annealing algorithm to create accurate multiple alignments of structured RNAs. By using Stemloc-AMA's probabilistic model rather than a Pair HMM and taking advantage of techniques such as query-specific learning, FSA could sum over possible pairwise structural alignments in order to get better estimates of posterior probabilities of character alignment.</p>
<p>FSA is a statistical alignment program insofar as it uses an explicit statistical model of alignments and a probabilistic objective function for optimization, but as discussed in “Theoretical justification of distance-based alignment” (<xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref>), it also is a distance-based approximation to the “phylogenetic alignment” models of alignments on trees <xref ref-type="bibr" rid="pcbi.1000392-Holmes1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1000392-Novk1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000392-Hein1">[50]</xref>–<xref ref-type="bibr" rid="pcbi.1000392-Lunter3">[52]</xref>. While traditional phylogenetic alignment algorithms are currently too computationally-expensive to use on datasets of more than a few sequences, FSA's distance-based method allows biologists to use the sophisticated tools of statistical alignment algorithms on practical problems. Furthermore, while we have not addressed the phylogenetic aspects of FSA in detail in this paper, our methods can be adapted to incorporate a complete phylogenetic model (<xref ref-type="supplementary-material" rid="pcbi.1000392.s001">Text S1</xref>, “The mathematics of distance-based alignment”). However, we believe that FSA's current approach, which is agnostic to phylogeny, offers many practical advantages for common genomics analyses. For example, because FSA uses a sum-of-pairs objective function, there is no guide tree to potentially bias downstream phylogenetic reconstructions based on the alignment. Similarly, while most genomic alignment programs require a species tree to perform the alignment, our phylogeny-free approach will be avoid potential biases introduced by using a single species tree to align regions which may have undergone recombination.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000392.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000392.s001" xlink:type="simple"><label>Text S1</label><caption>
<p>Supplementary Information</p>
<p>(0.23 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>FSA borrows heavily from previous work, both in its code base and its intellectual foundations.</p>
<p><bold>Ideas.</bold> The distance-based approach to multiple alignment was proposed in <xref ref-type="bibr" rid="pcbi.1000392-Schwartz1">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref>. This included the idea of modifying the accuracy criterion suggested <xref ref-type="bibr" rid="pcbi.1000392-Durbin1">[53]</xref> and <xref ref-type="bibr" rid="pcbi.1000392-Holmes2">[54]</xref> to include gaps and the demonstration that the resulting modified expected accuracy could be used to control the expected sensitivity and specificity. Furthermore, <xref ref-type="bibr" rid="pcbi.1000392-Schwartz1">[13]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref> introduced the sequence annealing approach to building multiple alignments, via the description of alignments using partially ordered sets <xref ref-type="bibr" rid="pcbi.1000392-Morgenstern1">[31]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Morgenstern2">[55]</xref>,<xref ref-type="bibr" rid="pcbi.1000392-Lee1">[56]</xref>. The graph-based approach to alignment was formalized by <xref ref-type="bibr" rid="pcbi.1000392-Abdeddam1">[57]</xref> and these results were used in the DIALIGN program <xref ref-type="bibr" rid="pcbi.1000392-Abdeddam2">[58]</xref>.</p>
<p>The query-specific learning method for re-estimating alignment parameters on the fly was inspired by <xref ref-type="bibr" rid="pcbi.1000392-Lunter2">[15]</xref> and conversations with Joseph Bradley about query-specific structure learning of graphical models.</p>
<p>The iterative refinement technique is based on ideas in <xref ref-type="bibr" rid="pcbi.1000392-Hirosawa1">[59]</xref>.</p>
<p>The FSA algorithm was parallelized using a modification of the approach in MW <xref ref-type="bibr" rid="pcbi.1000392-Goux1">[60]</xref>.</p>
<p>The coloring in the GUI according to posterior probabilities of alignment is inspired by the AU viewer of BAli-Phy <xref ref-type="bibr" rid="pcbi.1000392-Suchard1">[9]</xref>.</p>
<p><bold>Software.</bold> The sequence annealing implementation in FSA is based on Ariel Schwartz's AMAP program <xref ref-type="bibr" rid="pcbi.1000392-Schwartz2">[14]</xref>, which implements the Pearce-Kelly algorithm <xref ref-type="bibr" rid="pcbi.1000392-Pearce1">[61]</xref>.</p>
<p>FSA's query-specific learning uses code created with Gerton Lunter's HMMoC compiler for HMMs <xref ref-type="bibr" rid="pcbi.1000392-Lunter2">[15]</xref>. The “aligner” example distributed with HMMoC, which implements a learning procedure for gap parameters, was an inspiration for FSA's learning strategies. FSA's banding code is taken directly from the “aligner” example.</p>
<p>FSA's sequence and alignment representation code was inspired by similar code in the dart library <xref ref-type="bibr" rid="pcbi.1000392-Holmes3">[62]</xref>. Several Perl packages distributed with FSA are derived from packages of the same name in dart.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000392-Thompson1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thompson</surname><given-names>JD</given-names></name>
<name name-style="western"><surname>Higgins</surname><given-names>DG</given-names></name>
<name name-style="western"><surname>Gibson</surname><given-names>TJ</given-names></name>
</person-group>             <year>1994</year>             <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position specific gap penalties and weight matrix choice.</article-title>             <source>Nucleic Acids Research</source>             <volume>22</volume>             <fpage>4673</fpage>             <lpage>4680</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Larkin1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Larkin</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Blackshields</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Chenna</surname><given-names>R</given-names></name>
<name name-style="western"><surname>McGettigan</surname><given-names>P</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Clustal Wand Clustal X version 2.0.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>2947</fpage>             <lpage>2948</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Edgar1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Edgar</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name>
</person-group>             <year>2006</year>             <article-title>Multiple sequence alignment.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>16</volume>             <fpage>368</fpage>             <lpage>373</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Lunter1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Rocco</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Mimouni</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Heger</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Caldeira</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Uncertainty in homology inferences: assessing and improving genomic sequence alignment.</article-title>             <source>Genome Research</source>          </element-citation></ref>
<ref id="pcbi.1000392-Wong1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wong</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Suchard</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Huelsenbeck</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>Alignment uncertainty and genomic analysis.</article-title>             <source>Science</source>             <volume>319</volume>             <fpage>473</fpage>             <lpage>476</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Clamp1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Clamp</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Cuff</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Searle</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Barton</surname><given-names>G</given-names></name>
</person-group>             <year>2004</year>             <article-title>The Jalview Java alignment editor.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>426</fpage>             <lpage>427</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Worobey1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Worobey</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Gemmel</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Teuwen</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Haselkorn</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Kunstman</surname><given-names>K</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Direct evidence of extensive diversity of HIV-1 in Kinshasa by 1960.</article-title>             <source>Nature</source>             <volume>455</volume>             <fpage>661</fpage>             <lpage>664</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Holmes1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
</person-group>             <year>2003</year>             <article-title>Using guide trees to construct multiple-sequence evolutionary HMMs.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <supplement>Suppl. 1</supplement><fpage>i147</fpage>             <lpage>157</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Suchard1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Redelings</surname><given-names>BD</given-names></name>
</person-group>             <year>2006</year>             <article-title>BAli-Phy: simultaneous Bayesian inference of alignment and phylogeny.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>2047</fpage>             <lpage>2048</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Bradley1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bradley</surname><given-names>RK</given-names></name>
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
</person-group>             <year>2007</year>             <article-title>Transducers: an emerging probabilistic framework for modeling indels on trees.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>3258</fpage>             <lpage>3262</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Novk1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Novák</surname><given-names>Ádám</given-names></name>
<name name-style="western"><surname>Miklós</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Lyngsø</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <article-title>StatAlign: An extendable software package for joint Bayesian estimation of alignments and evolutionary trees.</article-title>             <source>Preprint</source>          </element-citation></ref>
<ref id="pcbi.1000392-Miller1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Miller</surname><given-names>W</given-names></name>
</person-group>             <year>2001</year>             <article-title>Comparison of genomic DNA sequences: solved and unsolved problems.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>391</fpage>             <lpage>397</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Schwartz1"><label>13</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schwartz</surname><given-names>AS</given-names></name>
</person-group>             <year>2007</year>             <article-title>Posterior Decoding Methods for Optimization and Accuracy Control of Multiple Alignments.</article-title>             <comment>Ph.D. thesis, EECS Department, University of California, Berkeley. URL <ext-link ext-link-type="uri" xlink:href="http://www.eecs.berkeley.edu/Pubs/TechRpts/2007/EECS-2007-39.html" xlink:type="simple">http://www.eecs.berkeley.edu/Pubs/TechRpts/2007/EECS-2007-39.html</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000392-Schwartz2"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schwartz</surname><given-names>AS</given-names></name>
<name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>
</person-group>             <year>2007</year>             <article-title>Multiple alignment by sequence annealing.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>e24-9</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Lunter2"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name>
</person-group>             <year>2007</year>             <article-title>HMMoC–a compiler for hidden Markov models.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>2485</fpage>             <lpage>2487</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Kurtz1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kurtz</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Phillippy</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Delcher</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Smoot</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Shumway</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Versatile and open software for comparing large genomes.</article-title>             <source>Genome Biol</source>             <volume>5</volume>             <fpage>R12</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Slater1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Slater</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Birney</surname><given-names>E</given-names></name>
</person-group>             <year>2005</year>             <article-title>Automated generation of heuristics for biological sequence comparison.</article-title>             <source>BMC Bioinformatics</source>             <volume>6</volume>             <fpage>31</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Bray1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bray</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>
</person-group>             <year>2004</year>             <article-title>MAVID: Constrained ancestral alignment of multiple sequences.</article-title>             <source>Genome Research</source>             <volume>14</volume>             <fpage>693</fpage>             <lpage>699</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Brudno1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Do</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Cooper</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Kim</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Davydov</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2003</year>             <article-title>LAGAN and Multi-LAGAN: efficient tools for large-scale multiple alignment of genomic DNA.</article-title>             <source>Genome Res</source>             <volume>13</volume>             <fpage>721</fpage>             <lpage>731</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Brudno2"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Steinkamp</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Morgenstern</surname><given-names>B</given-names></name>
</person-group>             <year>2004</year>             <article-title>The CHAOS/DIALIGN WWW server for multiple alignment of genomic sequences.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>W41</fpage>             <lpage>44</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Paten1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Paten</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Herrero</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Beal</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Fitzgerald</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Birney</surname><given-names>E</given-names></name>
</person-group>             <year>2008</year>             <article-title>Enredo and Pecan: Genome-wide mammalian consistency-based multiple alignment with paralogs.</article-title>             <source>Genome Res</source>             <volume>18</volume>             <fpage>1814</fpage>             <lpage>1828</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Dewey1"><label>22</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dewey</surname><given-names>CN</given-names></name>
</person-group>             <year>2006</year>             <article-title>Whole-Genome Alignments and Polytopes for Comparative Genomics.</article-title>             <comment>Ph.D. thesis, EECS Department, University of California, Berkeley. URL <ext-link ext-link-type="uri" xlink:href="http://www.eecs.berkeley.edu/Pubs/TechRpts/2006/EECS-2006-104.html" xlink:type="simple">http://www.eecs.berkeley.edu/Pubs/TechRpts/2006/EECS-2006-104.html</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000392-Kruskal1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kruskal</surname><given-names>CP</given-names></name>
<name name-style="western"><surname>Weiss</surname><given-names>A</given-names></name>
</person-group>             <year>1985</year>             <article-title>Allocating independent subtasks on parallel processors.</article-title>             <source>IEEE Trans Software Eng</source>             <volume>11</volume>             <fpage>1001</fpage>             <lpage>1016</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Thompson2"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thompson</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Koehl</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Ripp</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Poch</surname><given-names>O</given-names></name>
</person-group>             <year>2005</year>             <article-title>BAliBASE 3.0: latest developments of the multiple sequence alignment benchmark.</article-title>             <source>Proteins</source>             <volume>61</volume>             <fpage>127</fpage>             <lpage>136</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-VanWalle1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>VanWalle</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Lasters</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Wyns</surname><given-names>L</given-names></name>
</person-group>             <year>2005</year>             <article-title>Sabmark—a benchmark for sequence alignment that covers the entire known fold space.</article-title>             <source>Bioinformatics (Oxford, England)</source>             <volume>21</volume>             <fpage>1267</fpage>             <lpage>1268</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Wilm1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wilm</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Mainz</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Steger</surname><given-names>G</given-names></name>
</person-group>             <year>2006</year>             <article-title>An enhanced RNA alignment benchmark for sequence alignment programs.</article-title>             <source>Algorithms for molecular biology</source>             <volume>1</volume>             <fpage>19</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Dowell1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dowell</surname><given-names>RD</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
</person-group>             <year>2006</year>             <article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>400</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Blanchette1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Blanchette</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Kent</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Riemer</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Elnitski</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Smit</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Aligning multiple genomic sequences with the threaded blockset aligner.</article-title>             <source>Genome Res</source>             <volume>14</volume>             <fpage>708</fpage>             <lpage>715</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Cartwright1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cartwright</surname><given-names>RA</given-names></name>
</person-group>             <year>2005</year>             <article-title>DNA assembly with gaps (Dawg): simulating sequence evolution.</article-title>             <source>Bioinformatics</source>             <volume>21</volume>             <supplement>Suppl 3</supplement><fpage>iii31-8</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Varadarajan1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Varadarajan</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Bradley</surname><given-names>RK</given-names></name>
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
</person-group>             <year>2008</year>             <article-title>Tools for simulating evolution of aligned genomic regions with integrated parameter estimation.</article-title>             <source>Genome Biology</source>             <volume>9</volume>          </element-citation></ref>
<ref id="pcbi.1000392-Morgenstern1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Morgenstern</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Dress</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Werner</surname><given-names>T</given-names></name>
</person-group>             <year>1996</year>             <article-title>Multiple DNA and protein sequence alignment based on segmentto-segment comparison.</article-title>             <source>Proceedings of the National Academy of Sciences of the USA</source>             <volume>93</volume>             <fpage>12098</fpage>             <lpage>12103</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Subramanian1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Subramanian</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Kaufmann</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Morgenstern</surname><given-names>B</given-names></name>
</person-group>             <year>2008</year>             <article-title>DIALIGN-TX: greedy and progressive approaches for segment-based multiple sequence alignment.</article-title>             <source>Algorithms Mol Biol</source>             <volume>3</volume>             <fpage>6</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Katoh1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Katoh</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Toh</surname><given-names>H</given-names></name>
</person-group>             <year>2008</year>             <article-title>Recent developments in the MAFFT multiple sequence alignment program.</article-title>             <source>Brief Bioinformatics</source>             <volume>9</volume>             <fpage>286</fpage>             <lpage>298</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Pei1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pei</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Grishin</surname><given-names>N</given-names></name>
</person-group>             <year>2006</year>             <article-title>MUMMALS: multiple sequence alignment improved by using hidden Markov models with local structural information.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>4364</fpage>             <lpage>4374</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Edgar2"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name>
</person-group>             <year>2004</year>             <article-title>Muscle: a multiple sequence alignment method with reduced time and space complexity.</article-title>             <source>BMC bioinformatics</source>             <volume>5</volume>             <fpage>113</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Roshan1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Roshan</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Livesay</surname><given-names>D</given-names></name>
</person-group>             <year>2006</year>             <article-title>Probalign: multiple sequence alignment using partition function posterior probabilities.</article-title>             <source>Bioinformatics</source>             <volume>22</volume>             <fpage>2715</fpage>             <lpage>2721</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Do1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Do</surname><given-names>CB</given-names></name>
<name name-style="western"><surname>Mahabhashyam</surname><given-names>MSP</given-names></name>
<name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name>
</person-group>             <year>2005</year>             <article-title>ProbCons: Probabilistic consistency-based multiple sequence alignment.</article-title>             <source>Genome Res</source>             <volume>15</volume>             <fpage>330</fpage>             <lpage>340</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Notredame1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Notredame</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Higgins</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Heringa</surname><given-names>J</given-names></name>
</person-group>             <year>2000</year>             <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment.</article-title>             <source>J Mol Biol</source>             <volume>302</volume>             <fpage>205</fpage>             <lpage>217</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Rausch1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rausch</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Emde</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Weese</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Döring</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Notredame</surname><given-names>C</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Segment-based multiple sequence alignment.</article-title>             <source>Bioinformatics</source>             <volume>24</volume>             <fpage>i187</fpage>             <lpage>192</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-GriffithsJones1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Griffiths-Jones</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Moxon</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Marshall</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Khanna</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Rfam: annotating non-coding RNAs in complete genomes.</article-title>             <source>Nucleic Acids Research</source>             <volume>33</volume>             <fpage>D121-4</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Wuyts1"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wuyts</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Perrière</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Van De Peer</surname><given-names>Y</given-names></name>
</person-group>             <year>2004</year>             <article-title>The European ribosomal RNA database.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>D101</fpage>             <lpage>103</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Do2"><label>42</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Do</surname><given-names>CB</given-names></name>
<name name-style="western"><surname>Mahabhashyam</surname><given-names>MSP</given-names></name>
<name name-style="western"><surname>Brudno</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name>
</person-group>             <article-title>ProbConsRNA.</article-title>             <comment>URL <ext-link ext-link-type="uri" xlink:href="http://probcons.stanford.edu/download.html" xlink:type="simple">http://probcons.stanford.edu/download.html</ext-link>. Unpublished</comment>          </element-citation></ref>
<ref id="pcbi.1000392-Clark1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Clark</surname><given-names>AG</given-names></name>
<name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>DR</given-names></name>
<name name-style="western"><surname>Bergman</surname><given-names>CM</given-names></name>
<name name-style="western"><surname>Oliver</surname><given-names>B</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Evolution of genes and genomes on the Drosophila phylogeny.</article-title>             <source>Nature</source>             <volume>450</volume>             <fpage>203</fpage>             <lpage>218</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Kellis1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kellis</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Patterson</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Endrizzi</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Birren</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name>
</person-group>             <year>2003</year>             <article-title>Sequencing and comparison of yeast species to identify genes and regulatory elements.</article-title>             <source>Nature</source>             <volume>423</volume>             <fpage>241</fpage>             <lpage>254</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Ogurtsov1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ogurtsov</surname><given-names>AY</given-names></name>
<name name-style="western"><surname>Sunyaev</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Kondrashov</surname><given-names>AS</given-names></name>
</person-group>             <year>2004</year>             <article-title>Indel-based evolutionary distance and mouse-human divergence.</article-title>             <source>Genome Research</source>             <volume>14</volume>             <fpage>1610</fpage>             <lpage>1616</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Rivas1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rivas</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>
</person-group>             <year>2008</year>             <article-title>Probabilistic phylogenetic inference with insertions and deletions.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000172</fpage>             <comment>doi:10.1371/journal.pcbi.1000172</comment>          </element-citation></ref>
<ref id="pcbi.1000392-Loytynoja1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Loytynoja</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name>
</person-group>             <year>2008</year>             <article-title>Phylogeny-aware gap placement prevents errors in sequence alignment and evolutionary analysis.</article-title>             <source>Science</source>             <volume>320</volume>             <fpage>1632</fpage>             <lpage>1635</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Sinha1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name>
<name name-style="western"><surname>He</surname><given-names>X</given-names></name>
</person-group>             <year>2007</year>             <article-title>MORPH: probabilistic alignment combined with hidden Markov models of cisregulatory modules.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e216</fpage>             <comment>doi:10.1371/journal.pcbi.0030216</comment>          </element-citation></ref>
<ref id="pcbi.1000392-Bradley2"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bradley</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
</person-group>             <year>2008</year>             <article-title>Specific alignment of structured RNA: stochastic grammars and sequence annealing.</article-title>             <source>Bioinformatics</source>             <volume>24</volume>             <fpage>2677</fpage>             <lpage>2683</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Hein1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Wiuf</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Knudsen</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Moller</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Wibling</surname><given-names>G</given-names></name>
</person-group>             <year>2000</year>             <article-title>Statistical alignment: computational properties, homology testing and goodness-of-fit.</article-title>             <source>Journal of Molecular Biology</source>             <volume>302</volume>             <fpage>265</fpage>             <lpage>279</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Hein2"><label>51</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2001</year>             <article-title>An algorithm for statistical alignment of sequences related by a binary tree.</article-title>             <person-group person-group-type="editor">
<name name-style="western"><surname>Altman</surname><given-names>RB</given-names></name>
<name name-style="western"><surname>Dunker</surname><given-names>AK</given-names></name>
<name name-style="western"><surname>Hunter</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Lauderdale</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Klein</surname><given-names>TE</given-names></name>
</person-group>             <source>Pacific Symposium on Biocomputing</source>             <publisher-loc>Singapore</publisher-loc>             <publisher-name>World Scientific</publisher-name>             <fpage>179</fpage>             <lpage>190</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Lunter3"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lunter</surname><given-names>GA</given-names></name>
<name name-style="western"><surname>Miklós</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Song</surname><given-names>YS</given-names></name>
<name name-style="western"><surname>Hein</surname><given-names>J</given-names></name>
</person-group>             <year>2003</year>             <article-title>An efficient algorithm for statistical multiple alignment on arbitrary phylogenetic trees.</article-title>             <source>Journal of Computational Biology</source>             <volume>10</volume>             <fpage>869</fpage>             <lpage>889</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Durbin1"><label>53</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Mitchison</surname><given-names>G</given-names></name>
</person-group>             <year>1998</year>             <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>             <publisher-loc>Cambridge, UK</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000392-Holmes2"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>
</person-group>             <year>1998</year>             <article-title>Dynamic programming alignment accuracy.</article-title>             <source>Journal of Computational Biology</source>             <volume>5</volume>             <fpage>493</fpage>             <lpage>504</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Morgenstern2"><label>55</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Morgenstern</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Stoye</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Dress</surname><given-names>A</given-names></name>
</person-group>             <year>1999</year>             <article-title>Consistent equivalence relations: a set-theoretical framework for multiple sequence alignment.</article-title>             <comment>Technical report, University of Bielefeld, FSPM</comment>          </element-citation></ref>
<ref id="pcbi.1000392-Lee1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lee</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Grasso</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Sharlow</surname><given-names>M</given-names></name>
</person-group>             <year>2002</year>             <article-title>Multiple sequence alignment using partial order graphs.</article-title>             <source>Bioinformatics</source>             <volume>18</volume>             <fpage>452</fpage>             <lpage>464</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Abdeddam1"><label>57</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Abdeddaïm</surname><given-names>S</given-names></name>
</person-group>             <year>1997</year>             <article-title>On incremental computation of transitive closure and greedy alignment.</article-title>             <source>CPM</source>             <fpage>167</fpage>             <lpage>179</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Abdeddam2"><label>58</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Abdeddaïm</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Morgenstern</surname><given-names>B</given-names></name>
</person-group>             <year>2001</year>             <article-title>Speeding up the dialign multiple alignment program by using the ‘greedy alignment of biological sequences library’ (gabios-lib).</article-title>             <source>JOBIM '00: Selected papers from the First International Conference on Computational Biology, Biology, Informatics, and Mathematics</source>             <publisher-loc>London, UK</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>             <fpage>1</fpage>             <lpage>11</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Hirosawa1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hirosawa</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Totoki</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Hoshida</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ishikawa</surname><given-names>M</given-names></name>
</person-group>             <year>1995</year>             <article-title>Comprehensive study on iterative algorithms of multiple sequence alignment.</article-title>             <source>Comput Appl Biosci</source>             <volume>11</volume>             <fpage>13</fpage>             <lpage>18</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Goux1"><label>60</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Goux</surname><given-names>JP</given-names></name>
<name name-style="western"><surname>Kulkarni</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Yoder</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Linderoth</surname><given-names>J</given-names></name>
</person-group>             <year>2000</year>             <article-title>An enabling framework for master-worker applications on the computational grid.</article-title>             <source>HPDC '00: Proceedings of the 9th IEEE International Symposium on High Performance Distributed Computing</source>             <publisher-loc>Washington, DC, USA</publisher-loc>             <publisher-name>IEEE Computer Society</publisher-name>             <fpage>43</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Pearce1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pearce</surname><given-names>DJ</given-names></name>
<name name-style="western"><surname>Kelly</surname><given-names>PHJ</given-names></name>
</person-group>             <year>2007</year>             <article-title>A dynamic topological sort algorithm for directed acyclic graphs.</article-title>             <source>ACM Journal of Experimental Algorithmics</source>             <volume>11</volume>             <fpage>1.7</fpage>          </element-citation></ref>
<ref id="pcbi.1000392-Holmes3"><label>62</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name>
</person-group>             <year>1998</year>             <article-title>Studies in probabilistic sequence alignment and evolution.</article-title>             <comment>Ph.D. thesis, Department of Genetics, University of Cambridge; The Wellcome Trust Sanger Institute. Available from <ext-link ext-link-type="uri" xlink:href="http://biowiki.org/PaperArchive" xlink:type="simple">http://biowiki.org/PaperArchive</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000392-Beitz1"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Beitz</surname><given-names>E</given-names></name>
</person-group>             <year>2000</year>             <article-title>TEXshade: shading and labeling of multiple sequence alignments using LATEX2 epsilon.</article-title>             <source>Bioinformatics</source>             <volume>16</volume>             <fpage>135</fpage>             <lpage>139</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-Felsenstein1"><label>64</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>
</person-group>             <year>2005</year>             <source>PHYLIP (Phylogeny Inference Package) version 3.6. Distributed by the author</source>             <comment>Department of Genome Sciences, University of Washington, Seattle</comment>          </element-citation></ref>
<ref id="pcbi.1000392-DeSantis1"><label>65</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>DeSantis</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Hugenholtz</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Larsen</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Rojas</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Brodie</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB.</article-title>             <source>Appl Environ Microbiol</source>             <volume>72</volume>             <fpage>5069</fpage>             <lpage>5072</lpage>          </element-citation></ref>
<ref id="pcbi.1000392-1"><label>66</label><element-citation publication-type="other" xlink:type="simple">             <article-title>Condor.</article-title>             <comment>URL <ext-link ext-link-type="uri" xlink:href="http://www.cs.wisc.edu/condor/" xlink:type="simple">http://www.cs.wisc.edu/condor/</ext-link></comment>          </element-citation></ref>
</ref-list>

</back>
</article>