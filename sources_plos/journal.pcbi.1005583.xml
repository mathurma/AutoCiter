<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01674</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005583</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data visualization</subject><subj-group><subject>Infographics</subject><subj-group><subject>Graphs</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical functions</subject><subj-group><subject>Transfer functions</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Limbs (anatomy)</subject><subj-group><subject>Legs</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Musculoskeletal system</subject><subj-group><subject>Limbs (anatomy)</subject><subj-group><subject>Legs</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>Nonlinear dynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>Nonlinear dynamics</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Linking structure and activity in nonlinear spiking networks</article-title>
<alt-title alt-title-type="running-head">Linking structure and activity in nonlinear spiking networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9627-9576</contrib-id>
<name name-style="western">
<surname>Ocker</surname> <given-names>Gabriel Koch</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Josić</surname> <given-names>Krešimir</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Shea-Brown</surname> <given-names>Eric</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2196-1498</contrib-id>
<name name-style="western">
<surname>Buice</surname> <given-names>Michael A.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Allen Institute for Brain Science, Seattle, Washington, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Mathematics and Department of Biology and Biochemistry, University of Houston, Houston, Texas, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of BioSciences, Rice University, Houston, Texas, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Applied Mathematics, University of Washington, Seattle, Washington, United States of America</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Department of Physiology and Biophysics, and UW Institute of Neuroengineering, University of Washington, Seattle, Washington, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ayers</surname> <given-names>Joseph</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Northeastern University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">michaelbu@alleninstitute.org</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>6</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>6</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>6</issue>
<elocation-id>e1005583</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>10</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>16</day>
<month>5</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Ocker et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005583"/>
<abstract>
<p>Recent experimental advances are producing an avalanche of data on both neural connectivity and neural activity. To take full advantage of these two emerging datasets we need a framework that links them, revealing how collective neural activity arises from the structure of neural connectivity and intrinsic neural dynamics. This problem of structure-driven activity has drawn major interest in computational neuroscience. Existing methods for relating activity and architecture in spiking networks rely on linearizing activity around a central operating point and thus fail to capture the nonlinear responses of individual neurons that are the hallmark of neural information processing. Here, we overcome this limitation and present a new relationship between connectivity and activity in networks of nonlinear spiking neurons by developing a diagrammatic fluctuation expansion based on statistical field theory. We explicitly show how recurrent network structure produces pairwise and higher-order correlated activity, and how nonlinearities impact the networks’ spiking activity. Our findings open new avenues to investigating how single-neuron nonlinearities—including those of different cell types—combine with connectivity to shape population activity and function.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Neuronal networks, like many biological systems, exhibit variable activity. This activity is shaped by both the underlying biology of the component neurons and the structure of their interactions. How can we combine knowledge of these two things—that is, models of individual neurons and of their interactions—to predict the statistics of single- and multi-neuron activity? Current approaches rely on linearizing neural activity around a stationary state. In the face of neural nonlinearities, however, these linear methods can fail to predict spiking statistics and even fail to correctly predict whether activity is stable or pathological. Here, we show how to calculate any spike train cumulant in a broad class of models, while systematically accounting for nonlinear effects. We then study a fundamental effect of nonlinear input-rate transfer–coupling between different orders of spiking statistic–and how this depends on single-neuron and network properties.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DMS-1514743</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Shea-Brown</surname> <given-names>Eric</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DMS-1056125</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Shea-Brown</surname> <given-names>Eric</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DMS-1517629</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Josić</surname> <given-names>Krešimir</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>R01GM104974</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Josić</surname> <given-names>Krešimir</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000893</institution-id>
<institution>Simons Foundation</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Shea-Brown</surname> <given-names>Eric</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution>Simons Foundation (US)</institution>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Josić</surname> <given-names>Krešimir</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award007">
<funding-source>
<institution>National Science Foundation (US)</institution>
</funding-source>
<award-id>CCF-1231216</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2196-1498</contrib-id>
<name name-style="western">
<surname>Buice</surname> <given-names>Michael A</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>We acknowledge the support of the NSF (<ext-link ext-link-type="uri" xlink:href="https://www.nsf.gov" xlink:type="simple">https://www.nsf.gov</ext-link>) through grants DMS-1514743 and DMS-1056125 (ESB), DMS-1517629 (KJ), and NSF/NIGMS-R01GM104974 (KJ), as well as the Simons Fellowships in Mathematics (<ext-link ext-link-type="uri" xlink:href="https://www.simonsfoundation.org/" xlink:type="simple">https://www.simonsfoundation.org/</ext-link>; ESB and KJ). This material is based upon work partially supported by the Center for Brains, Minds, and Machines (CBMM), funded by NSF STC award CCF-1231216 (MAB). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="20"/>
<table-count count="1"/>
<page-count count="47"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-07-10</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The authors confirm that all necessary source code can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/gocker/PoissonGLMCumulants" xlink:type="simple">https://github.com/gocker/PoissonGLMCumulants</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>A fundamental goal in computational neuroscience is to understand how network connectivity and intrinsic neuronal dynamics relate to collective neural activity, and in turn drive neural computation. Experimental advances are vastly expanding both the scale and the resolution with which we can measure both neural connectivity and neural activity. Simultaneously, a wealth of new data suggests a possible partitioning of neurons into cell types with both distinct dynamical properties and distinct patterns of connectivity. What is needed is a way to link these three types of data; how is it that patterns of connectivity are translated into patterns of activity through neuronal dynamics?</p>
<p>Any model of neural activity should also capture the often-strong variability in spike trains across time or experimental trials. This variablity in spiking is often coordinated (correlated) across cells, which has a variety of implications. First, correlations play an essential role in plasticity of network structure [<xref ref-type="bibr" rid="pcbi.1005583.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref004">4</xref>]. Theories that describe spiking correlations allow for a self-consistent description of the coevolution of recurrent network structure and activity [<xref ref-type="bibr" rid="pcbi.1005583.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref006">6</xref>]. Second, correlations between synaptic inputs control their effect on postsynaptic neurons: inputs that arrive simultaneously can produce stronger responses than those arriving separately. This has been referred to as “synergy” or “synchronous gain” in early work [<xref ref-type="bibr" rid="pcbi.1005583.ref007">7</xref>], and the magnitude of this synergy has been measured in the LGN by Usrey, Reppas &amp; Reid [<xref ref-type="bibr" rid="pcbi.1005583.ref008">8</xref>] and cortex by Bruno &amp; Sakmann [<xref ref-type="bibr" rid="pcbi.1005583.ref009">9</xref>] (but see [<xref ref-type="bibr" rid="pcbi.1005583.ref010">10</xref>]). Indeed, the level of correlation in an upstream population has been shown to act as a gain knob for firing rates downstream [<xref ref-type="bibr" rid="pcbi.1005583.ref011">11</xref>]. Finally, correlated fluctuations in activity can impact the fidelity with which populations can encode information [<xref ref-type="bibr" rid="pcbi.1005583.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref013">13</xref>]. Importantly, the coding impact depends on a subtle interplay of how signals impact firing rates in a neural population and of how noise correlations occur across the population [<xref ref-type="bibr" rid="pcbi.1005583.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref018">18</xref>]. An accurate description of how network connectivity determines the individual and joint activity of neural populations is thus important for the understanding of neural activity, plasticity and coding.</p>
<p>Many studies of collective activity in spiking systems can be traced to the early work of Hawkes on self- or mutually-exciting point processes [<xref ref-type="bibr" rid="pcbi.1005583.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref020">20</xref>]. The Hawkes model is also closely related to the linear response theory that can be used to describe correlations in integrate-and-fire networks [<xref ref-type="bibr" rid="pcbi.1005583.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref022">22</xref>]. Here, each neuron and synapse is linearized around a central operating point and modes of collective activity are computed around that point [<xref ref-type="bibr" rid="pcbi.1005583.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref025">25</xref>]. Including a nonlinear transfer of inputs to rates in the Hawkes model gives a generalized linear model, which has been applied with considerable success to multi-neuron spike train data [<xref ref-type="bibr" rid="pcbi.1005583.ref026">26</xref>].</p>
<p>Analyses based on computing modes of collecting activity based on linearized dynamics have led to significant insights, but they also impose a limitation. While shifts of the operating point can modulate the linearized dynamics of biophysical models [<xref ref-type="bibr" rid="pcbi.1005583.ref027">27</xref>], this approach cannot capture the impact of nonlinear neural dynamics at the operating point.</p>
<p>Here, we present a systematic method for computing correlations of any order for <italic>nonlinear</italic> networks of excitatory and inhibitory neurons. Nonlinear input-rate transfer couples higher-order spike train statistics to lower-order ones in a manner that depends on the order of the nonlinearity. In its simplest form, this coupling shows how pairwise–correlated inputs modulate output firing rates. This generalizes the effects of pairwise correlations on neural gain in single-neurons [<xref ref-type="bibr" rid="pcbi.1005583.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref011">11</xref>] and feedforward circuits [<xref ref-type="bibr" rid="pcbi.1005583.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref031">31</xref>] to networks with high levels of recurrence and feedback.</p>
<p>We begin with simple models and progress to nonlinearly interacting networks of spiking neurons. Our method is diagrammatic, in the sense that the interplay of network connectivity and neural dynamics in determining network statistics is expressed and understood via a systematic series of graphical terms. Such graphs are commonly referred to as “Feynman diagrams” after Richard Feynman, who invented them. We use this diagrammatic expansion to make and explain three main scientific points. First, we show how neural dynamics lead to spike correlations modulating firing rates in a recurrent, nonlinear network. Second, we illustrate an additional role of the prominent “heavy-tailed” feature of neural connectivity where some neurons have many more connections than others, and some connections are much stronger than others. We show how this feature interacts with nonlinearities to control network activity. And third, we show how different single-neuron nonlinearities affect the dependence of firing rates on correlations.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Diagrammatic expansion for spike train statistics</title>
<p>We will show that any coupled point process model, even one with nonlinearities or negative interactions, has an associated expansion for all spike train cumulants organized by the strength of coupling of higher statistical moments with lower ones (e.g., the influence of the two-point correlation on the mean). The full model we aim to describe is one where each neuron generates a spike train which is conditionally renewal with intensity:
<disp-formula id="pcbi.1005583.e001"><alternatives><graphic id="pcbi.1005583.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
Here <bold>g</bold><sub><italic>ij</italic></sub>(<italic>t</italic>) is a matrix of interaction filters, λ<sub><italic>i</italic></sub>(<italic>t</italic>) is the baseline point process drive to neuron <italic>i</italic> and * denotes convolution: <inline-formula id="pcbi.1005583.e002"><alternatives><graphic id="pcbi.1005583.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (with the integral starting at the initial time for the realization). <italic>ϕ</italic><sub><italic>i</italic></sub> is the transfer function of neuron <italic>i</italic>. Neuron <italic>j</italic>’s spike train is <inline-formula id="pcbi.1005583.e003"><alternatives><graphic id="pcbi.1005583.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mspace width="1pt"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, a sum over Dirac deltas at each of the <italic>k</italic> spike times. We will take the spike trains to be conditionally Poisson given the input, so that in each time window (<italic>t</italic>, <italic>t</italic> + <italic>dt</italic>), the probability of neuron <italic>i</italic> generating <italic>m</italic> spikes is (<italic>r</italic><sub><italic>i</italic></sub>(<italic>t</italic>)<italic>dt</italic>)<sup><italic>m</italic></sup>/<italic>m</italic>! exp (−<italic>r</italic><sub><italic>i</italic></sub>(<italic>t</italic>)<italic>dt</italic>). This corresponds to a point process generalized linear model (GLM), or nonlinear multivariate Hawkes process [<xref ref-type="bibr" rid="pcbi.1005583.ref032">32</xref>]. In contrast to biophysical or integrate-and-fire models in which spike trains are generated deterministically given the membrane potential (which might, however, depend on noisy input), this model with escape noise generates spike trains stochastically with a rate that depends on the “free” membrane potential (i.e., with action potentials removed) [<xref ref-type="bibr" rid="pcbi.1005583.ref033">33</xref>].</p>
<p>Current methods for the analysis of single-neuron and joint spiking statistics rely on linear response techniques: using a self-consistent mean field theory to compute mean firing rates and then linearizing the spiking around those rates to determine the stability and correlations. We begin with a simple example highlighting the need to account for nonlinear effects. We take an excitatory-inhibitory network of <italic>N</italic><sub><italic>E</italic></sub> = 200 excitatory (<italic>E</italic>) neurons and <italic>N</italic><sub><italic>I</italic></sub> = 40 inhibitory (<italic>I</italic>) neurons, all with threshold-quadratic transfer functions <inline-formula id="pcbi.1005583.e004"><alternatives><graphic id="pcbi.1005583.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>α</mml:mi> <mml:msubsup><mml:mrow><mml:mo>⌊</mml:mo> <mml:mi>x</mml:mi> <mml:mo>⌋</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. In this example we took network connectivity to be totally random (Erdös-Rényi), with connection probabilities <italic>p</italic><sub><italic>EE</italic></sub> = 0.2 and <italic>p</italic><sub><italic>EI</italic></sub> = <italic>p</italic><sub><italic>IE</italic></sub> = <italic>p</italic><sub><italic>II</italic></sub> = 0.5. For simplicity, we took the magnitude of all connections of a given type (<italic>E</italic> − <italic>E</italic>, etc.) was taken to be the same. Furthermore, the time course of all network interactions is governed by the same filter <inline-formula id="pcbi.1005583.e005"><alternatives><graphic id="pcbi.1005583.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>t</mml:mi> <mml:msup><mml:mi>τ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (with <italic>τ</italic> = 10 ms), so that <bold>g</bold><sub><italic>ij</italic></sub>(<italic>t</italic>) = <bold>W</bold><sub><italic>ij</italic></sub><italic>g</italic>(<italic>t</italic>). <bold>W</bold> is a matrix of synaptic weights with units of mV, so that the input to <italic>ϕ</italic> can be interpreted as the free membrane potential. We set the strength of interactions such that the net inhibitory input weight on to a neuron was, on average, twice that of the net excitatory input weight so that for sufficiently strong interactions, the network was in an inhibitory-stabilized regime [<xref ref-type="bibr" rid="pcbi.1005583.ref034">34</xref>].</p>
<p>We examined the magnitude and stability of firing rates as we increased the strength of synaptic coupling. We used mean field theory to predict the firing rates, and predicted their linear stability by the standard measure of the spectral radius of the stability matrix <inline-formula id="pcbi.1005583.e006"><alternatives><graphic id="pcbi.1005583.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mi mathvariant="bold">Ψ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi mathvariant="bold">g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. (<inline-formula id="pcbi.1005583.e007"><alternatives><graphic id="pcbi.1005583.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> denotes the first derivative of neuron <italic>i</italic>’s transfer function with respect to its input.) As the strength of interactions increases, the mean field prediction for the firing rates loses accuracy (<xref ref-type="fig" rid="pcbi.1005583.g001">Fig 1A</xref>). This occurs well before the mean field theory crosses the stability boundary |<bold>Ψ</bold>| = 1 (<xref ref-type="fig" rid="pcbi.1005583.g001">Fig 1B</xref>). Examining simulations as the weights are increased reveals an even more fundamental failure of the theory: before the synaptic weights are strong enough for the mean field theory to be unstable, the simulations reveal divergent firing rates (<xref ref-type="fig" rid="pcbi.1005583.g001">Fig 1C</xref>; the raster stops when the instantaneous rates diverge).</p>
<fig id="pcbi.1005583.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Dynamics approaching the firing-rate instability in threshold-quadratic networks.</title>
<p>A) Average firing rate of the excitatory neurons as synaptic weights are scaled. While the ordinate axis shows the excitatory-excitatory synaptic weight, all other weights are scaled with it. Solid lines: prediction of mean field theory. Dots: result of simulation. Inset: threshold-quadratic transfer function. B) Spectral radius of the stability matrix of mean field theory as synaptic weights are scaled. Stars indicate the weight values for the simulations below. C) Example realizations of activity for three different interaction strengths. As synapses become stronger, correlated activity becomes apparent. When synapses are strong enough the activity becomes unstable, even though the mean field theory is stable. All plotted firing rates in A) are averaged over the time period before the rates diverged (if they did). Left: (<italic>W</italic><sub><italic>EE</italic></sub>, <italic>W</italic><sub><italic>EI</italic></sub>, <italic>W</italic><sub><italic>IE</italic></sub>, <italic>W</italic><sub><italic>II</italic></sub>) = (.025, -.1, .01, -.1) mV. C). Middle: (<italic>W</italic><sub><italic>EE</italic></sub>, <italic>W</italic><sub><italic>EI</italic></sub>, <italic>W</italic><sub><italic>IE</italic></sub>, <italic>W</italic><sub><italic>II</italic></sub>) = (1, −4, .4, −4) mV. Right: (<italic>W</italic><sub><italic>EE</italic></sub>, <italic>W</italic><sub><italic>EI</italic></sub>, <italic>W</italic><sub><italic>IE</italic></sub>, <italic>W</italic><sub><italic>II</italic></sub>) = (1.5, −6, .6, −6) mV.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g001" xlink:type="simple"/>
</fig>
<p>Rather than restricting theoretical analysis to regimes of extremely low coupling strength or linear models, we here develop a framework for activity cumulants that can apply to models with nonlinear input-spike transfer. This will allow us to properly predict both the spiking cumulants and the location of the rate instability in the nonlinear network above. Thus, we develop a framework for activity cumulants that can apply to models with nonlinear input-spike transfer for strongly coupled networks. The mean field and linear response predictions for spiking cumulants correspond to the lowest order terms of this expansion and are good whenever that lowest-order truncation is valid.</p>
<p>We will build this framework systematically: We begin with statistics of the drive λ<sub><italic>i</italic></sub>(<italic>t</italic>), then consider a filtered point process, <italic>g</italic> * λ(<italic>t</italic>). In these simple models we will introduce the method and terminology that we will use to understand the more complicated models. We continue by considering the linearly self-exciting Hawkes process, taking a single neuron so <bold>g</bold> = <italic>g</italic> and <italic>ϕ</italic>(<italic>x</italic>) = <italic>x</italic>, before proceeding to arbitrary nonlinearities <italic>ϕ</italic>. Finally, we introduce an arbitrary network structure <bold>g</bold>. This model is intimately related to the popular GLMs for spiking activity, where the nonlinearity <italic>ϕ</italic> is commonly taken to be exponential, refractory dynamics can be embedded in the diagonal elements of <bold>g</bold>, and λ corresponds to the filtered stimulus [<xref ref-type="bibr" rid="pcbi.1005583.ref026">26</xref>]. A use of GLMs it to fit them to recorded spike trains and then ask about the structure of the inferred functional connectivity <bold>g</bold>. In contrast, we interpret <bold>g</bold> as reflecting the structural connectivity and synaptic and membrane dynamics of a specified model network and aim to compute statistics of its neurons’ spike trains. The derivation given here will be heuristic. A more rigorous derivation of the expansion is given in Methods: Path integral representation.</p>
</sec>
<sec id="sec004">
<title>Introduction to the general framework: Poisson process</title>
<p>An inhomogeneous Poisson process generates counts within a window <italic>dt</italic> independently with a Poisson distribution at rate λ(<italic>t</italic>). A spike train produced by this process is
<disp-formula id="pcbi.1005583.e008"><alternatives><graphic id="pcbi.1005583.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>t</italic><sub><italic>k</italic></sub> is the <italic>k</italic>th spike time, and <italic>N</italic>(<italic>t</italic>) is the spike count. The mean and autocovariance for this process are given by the familiar formulas:
<disp-formula id="pcbi.1005583.e009"><alternatives><graphic id="pcbi.1005583.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
<disp-formula id="pcbi.1005583.e010"><alternatives><graphic id="pcbi.1005583.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where angular brackets denote the expectation across realizations and the subscript <italic>c</italic> denotes a cumulant, not the moment (i.e., we have subtracted all terms which factor into products of lower moments) [<xref ref-type="bibr" rid="pcbi.1005583.ref035">35</xref>]. The delta function arises because the process is independent at each time step, so that there is no correlation between events from one time <italic>t</italic> and any other time <italic>t</italic>′. In fact, because the events are generated independently at each time point, all of the cumulants of this process can be written as
<disp-formula id="pcbi.1005583.e011"><alternatives><graphic id="pcbi.1005583.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where integrating out one of the delta functions puts the second cumulant in the above form. We can interpret this equation as describing a source of events appearing at rate λ(<italic>t</italic>) at time <italic>t</italic> that propagate to times <italic>t</italic><sub><italic>i</italic></sub>. In this case, because the events are generated independently at each <italic>t</italic>, the events only propagate to the same time <italic>t</italic>. For a general point process, cumulants measured at the collection of times {<italic>t</italic><sub><italic>i</italic></sub>} could be affected by events occurring at any past time, so that we would have to account for how events propagate across time.</p>
<p>The expansion for cumulants we will develop has a natural construction in terms of graphs (Feynman diagrams), wherein components of the graph represent factors in each term. A set of defined rules dictate how terms in the expansion are formed from those graphs. While this graphical representation is not necessary to understand the inhomogeneous Poisson process, we describe it in detail in this simple case to develop intuition and introduce terminology. We use cumulants in this construction because they provide the fundamental building blocks of moments; any <italic>n</italic>-th order moment can be constructed from up to <italic>n</italic>-th order cumulants). This also simplifies the developed expansion.</p>
<p>To begin, the <italic>n</italic>th cumulant has <italic>n</italic> arguments {<italic>t</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1, …, <italic>n</italic>}, one for each factor of <inline-formula id="pcbi.1005583.e012"><alternatives><graphic id="pcbi.1005583.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005583.e011">Eq 5</xref>. We represent each of these by an open white vertex in the graph labeled with the time point, <italic>t</italic><sub><italic>i</italic></sub>, and we represent the source term λ(<italic>t</italic>) with a gray vertex. The white vertices are called “external” vertices whereas the gray vertex is called “internal.”</p>
<p>The internal gray vertex represents the intensity of the underlying stochastic process generating events with rate λ(<italic>t</italic>). The white external vertices represent the spike trains whose statistics we measure at times {<italic>t</italic><sub><italic>i</italic></sub>}. For each delta function, <italic>δ</italic>(<italic>t</italic> − <italic>t</italic><sub><italic>i</italic></sub>), in <xref ref-type="disp-formula" rid="pcbi.1005583.e011">Eq 5</xref>, we place an edge drawn as a dotted line from the gray vertex to the white vertex, i.e., from the event-generating process to the spike train’s measurement times (<xref ref-type="fig" rid="pcbi.1005583.g002">Fig 2</xref>). More generally, events generated by the source propagate through the graph to affect the external vertices.</p>
<fig id="pcbi.1005583.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Feynman diagrams for the first three cumulants of the inhomogeneous Poisson process.</title>
<p>Each dotted edge corresponds to a delta-function connecting the time indices of its two nodes. White nodes denote the measurement times, while gray nodes denote the times at which spikes are generated. The cumulants are constructed by convolving the term corresponding to the gray node with the product of all outgoing edges’ terms (<xref ref-type="disp-formula" rid="pcbi.1005583.e011">Eq 5</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g002" xlink:type="simple"/>
</fig>
<p>In order to construct the term associated with each diagram, we multiply the factors corresponding to edges (delta functions linking <italic>t</italic> and <italic>t</italic><sub><italic>i</italic></sub>) or the internal vertex (λ(<italic>t</italic>)), and then integrate over the time <italic>t</italic> associated with the internal vertex. This links the generation of events by λ(<italic>t</italic>) to their joint measurement at times {<italic>t</italic><sub><italic>i</italic></sub>} through the propagator (here <italic>δ</italic>(<italic>t</italic> − <italic>t</italic><sub><italic>i</italic></sub>)). For the diagrams shown in <xref ref-type="fig" rid="pcbi.1005583.g002">Fig 2</xref>, these rules reproduce the cumulant terms in <xref ref-type="disp-formula" rid="pcbi.1005583.e011">Eq 5</xref>. Note that these graphs are directed, since we only consider causal systems where measured cumulants are only influenced by past events.</p>
<p>In general, a given moment will be the sum of terms associated with many different graphs. For example the second moment is given by
<disp-formula id="pcbi.1005583.e013"><alternatives><graphic id="pcbi.1005583.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mspace width="1pt"/><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
Each term on the right-hand side will have a corresponding graph. Moreover, the graph for the second term will include two disconnected components, one for each factor of the mean rate, which appears as in <xref ref-type="fig" rid="pcbi.1005583.g002">Fig 2</xref>. The graphs for the cumulant will always be described by connected graphs.</p>
</sec>
<sec id="sec005">
<title>Filtered Poisson process</title>
<p>We proceed to a simple model of synaptic input: a presynaptic Poisson spike train, with count <italic>N</italic>(<italic>t</italic>) and intensity λ(<italic>t</italic>), drives postsynaptic potentials with shape <italic>g</italic>(<italic>t</italic>):
<disp-formula id="pcbi.1005583.e014"><alternatives><graphic id="pcbi.1005583.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:mi>ν</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
where * denotes convolution: <inline-formula id="pcbi.1005583.e015"><alternatives><graphic id="pcbi.1005583.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (with the integral starting at the initial time for the realization). We assume <italic>g</italic> is normalized, <inline-formula id="pcbi.1005583.e016"><alternatives><graphic id="pcbi.1005583.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, so that <italic>ϵ</italic> gives the magnitude of the filtering.</p>
<p>The cumulants of the postsynaptic potential <italic>ν</italic>(<italic>t</italic>) can be calculated directly. In general, they are given by:
<disp-formula id="pcbi.1005583.e017"><alternatives><graphic id="pcbi.1005583.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mi>ν</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where the input spikes are generated at times <italic>t</italic>, arrive at times given by the delta functions and influence the cumulant measured at {<italic>t</italic><sub><italic>i</italic></sub>} through <italic>g</italic>. <xref ref-type="disp-formula" rid="pcbi.1005583.e017">Eq 8</xref> is the same as that for the inhomogeneous Poisson process but with factors of <italic>g</italic>*. This provides a simple interpretation of <xref ref-type="disp-formula" rid="pcbi.1005583.e017">Eq 8</xref>: cumulants of the filtered Poisson process are given by taking the cumulants of the underlying Poisson process and examining how they can be filtered through the system at hand.</p>
<p>Similarly to the case for the Poisson process, we can represent the cumulants graphically. We again represent each measurement time on the left-hand side of <xref ref-type="disp-formula" rid="pcbi.1005583.e017">Eq 8</xref> by an external vertex (<xref ref-type="fig" rid="pcbi.1005583.g003">Fig 3a</xref>). The convolution of <italic>δ</italic> and <italic>g</italic> in <xref ref-type="disp-formula" rid="pcbi.1005583.e017">Eq 8</xref> corresponds to an internal time point which we integrate over (denoted by primes). We also represent these internal time points with white vertices that carry a factor of <italic>ϵ</italic>, the magnitude of the filter. We represent the source term λ(<italic>t</italic>) with a gray vertex. All vertices that are not “external” are again called internal. Every internal vertex also carries its own time index, <italic>t</italic>′.</p>
<fig id="pcbi.1005583.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Feynman diagrams for the first three cumulants of the filtered inhomogeneous Poisson process.</title>
<p>A) Cumulant corresponding to the graph. B) Diagrammatic expressions using the filter and the underlying Poisson process. Each dotted edge corresponds to a delta-function connecting the time indices of its two nodes. Each wavy edge corresponds to the filter <italic>g</italic> connecting the time indices of its two nodes. C) Diagrammatic expressions using the propagator. In all graphs, external white nodes (leaves of the graph) denote measurement times. Gray nodes denote the times at which spikes are generated in the input spike train. Internal white nodes (with time indices <italic>t</italic>′) denote the times at which input spikes arrive at the postsynaptic neuron. The cumulants are constructed by convolving the term corresponding to the gray node with the product of all outgoing edges’ terms (<xref ref-type="disp-formula" rid="pcbi.1005583.e017">Eq 8</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g003" xlink:type="simple"/>
</fig>
<p>The internal gray vertex again represents the intensity of the underlying stochastic process, λ(<italic>t</italic>). The white external vertices represent the processes whose statistics we measure at times {<italic>t</italic><sub><italic>i</italic></sub>}. For each delta function, <italic>δ</italic>(<italic>t</italic>′ − <italic>t</italic>), in <xref ref-type="disp-formula" rid="pcbi.1005583.e017">Eq 8</xref>, we place an edge drawn as a dotted line from the gray vertex to the white vertex, i.e., from the event-generating process to the arrival time of the event <italic>t</italic>′. In this example an event “arrives” as soon as it is generated. A wavy edge corresponds to the filter, <italic>g</italic>, and represents the effect of a spike arriving at time <italic>t</italic>′ on the output process measured at time <italic>t</italic><sub><italic>i</italic></sub> (<xref ref-type="fig" rid="pcbi.1005583.g003">Fig 3b</xref>). Events generated by the source thus propagate through the graph to affect the observed, external vertices.</p>
<p>In order to construct the expression associated with each diagram, we again multiply the factors corresponding to each edge in the diagram (e.g., <italic>δ</italic>(<italic>t</italic>′ − <italic>t</italic>) or <italic>g</italic>(<italic>t</italic><sub><italic>i</italic></sub> − <italic>t</italic>′)) or internal vertex (<italic>ϵ</italic> or λ(<italic>t</italic>)) and then integrate over the times associated with the internal vertices. Note that integration over the internal times <italic>t</italic>′, <italic>t</italic>′′, etc. results in the convolutions <italic>ϵ</italic>(<italic>g</italic> * <italic>δ</italic>)(<italic>t</italic><sub><italic>i</italic></sub> − <italic>t</italic>). Integration over the time <italic>t</italic> associated with the source term corresponds to the outermost integral in <xref ref-type="disp-formula" rid="pcbi.1005583.e017">Eq 8</xref> This links the generation of events by λ(<italic>t</italic>) to their joint measurement at times {<italic>t</italic><sub><italic>i</italic></sub>} through their arrival times (via <italic>δ</italic>(<italic>t</italic> − <italic>t</italic>′)) and temporal filtering (<italic>g</italic>(<italic>t</italic><sub><italic>i</italic></sub> − <italic>t</italic>′)). For the diagrams shown in <xref ref-type="fig" rid="pcbi.1005583.g003">Fig 3</xref>, these rules reproduce the cumulant terms in <xref ref-type="disp-formula" rid="pcbi.1005583.e017">Eq 8</xref>. Note that the graphs are directed, as for the expansion we describe the “propagator” term will be causal.</p>
<p>We can simplify the cumulants of this process (and the corresponding diagrammatic representations) by considering the propagator of <italic>ν</italic>(<italic>t</italic>) (also known as the linear response or impulse response). The propagator measures the change in 〈<italic>ν</italic>(<italic>t</italic>)〉 in response to the addition of one input spike in <italic>N</italic>(<italic>t</italic>). We can compute it by taking a functional derivative with respect to the input intensity λ(<italic>t</italic>):
<disp-formula id="pcbi.1005583.e018"><alternatives><graphic id="pcbi.1005583.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="1pt"/><mml:mo stretchy="false">⟨</mml:mo><mml:mi>ν</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>ϵ</mml:mi> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⟩</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>δ</mml:mi> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>δ</mml:mi> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
<p>Since the dynamics are linear, this is also equivalent to the change of the expected rate with the addition of one spike to the input, i.e., taking λ(<italic>t</italic>) ← λ(<italic>t</italic>) + <italic>δ</italic>(<italic>t</italic>′ − <italic>t</italic>) and 〈<italic>ν</italic>(<italic>t</italic>)〉<sub><italic>c</italic></sub> ← 〈<italic>ν</italic>(<italic>t</italic>)〉<sub><italic>c</italic></sub> + Δ * <italic>δ</italic>(<italic>t</italic>) (or equivalently the Green’s function of the expected rate). This allows us to rewrite the cumulants in terms of the input rate and the propagator:
<disp-formula id="pcbi.1005583.e019"><alternatives><graphic id="pcbi.1005583.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mi>ν</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
which can be represented graphically by introducing a solid, directed edge for Δ(<italic>t</italic>, <italic>t</italic>′) (<xref ref-type="fig" rid="pcbi.1005583.g003">Fig 3c</xref>). The propagator will be a central feature of the expansion for cumulants in more complicated models involving connections among neurons.</p>
</sec>
<sec id="sec006">
<title>Impact of self-excitation on activity statistics of any order: Linearly self-exciting process</title>
<p>In order to generalize the graphical representation of Poisson cumulants, we begin with a linearly self-exciting process as considered by Hawkes [<xref ref-type="bibr" rid="pcbi.1005583.ref019">19</xref>]. Let the rate be a linear function of the instantaneous event rate (that is to say the firing rate conditioned on a particular realization of the event history)
<disp-formula id="pcbi.1005583.e020"><alternatives><graphic id="pcbi.1005583.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mrow><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
We assume that <italic>g</italic>(<italic>τ</italic>) and λ(<italic>t</italic>) are such that <italic>r</italic>(<italic>t</italic>) &gt; 0, and <inline-formula id="pcbi.1005583.e021"><alternatives><graphic id="pcbi.1005583.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>τ</mml:mi> <mml:mspace width="0.277778em"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. If <italic>ϵ</italic> &lt; 1, then an event will generate less than one event on average, and the rate will not diverge. The history dependence of the firing rate will now enter into our calculations. We can compute the expected rate using the self-consistency equation:
<disp-formula id="pcbi.1005583.e022"><alternatives><graphic id="pcbi.1005583.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mspace width="1pt"/><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⟩</mml:mo><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>We provide an alternate derivation of this result that will prove useful below: We construct a perturbative expansion of the mean firing rate and show how this expansion can be re-summed to yield the full rate of the self-exciting process. This procedure can also be applied to obtain cumulants of arbitrary order for this process.</p>
<p>We will begin with a recursive formulation of the self-exciting process. In contrast to the filtered Poisson process of the previous section, here the process with count <italic>N</italic> generates events, which then influence its own rate, <italic>dN</italic>/<italic>dt</italic>. Each event can thus generate others in turn. In the case of a linear filter, <italic>g</italic>, the following approach is equivalent to the Poisson cluster expansion [<xref ref-type="bibr" rid="pcbi.1005583.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref038">38</xref>] and similar to the construction of previous linear response theories for spike train covariances [<xref ref-type="bibr" rid="pcbi.1005583.ref022">22</xref>]. Define the <italic>n</italic>th order self-exciting process, <italic>N</italic><sub><italic>n</italic></sub>(<italic>t</italic>), to be the inhomogeneous Poisson process given by:
<disp-formula id="pcbi.1005583.e023"><alternatives><graphic id="pcbi.1005583.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
where <italic>N</italic><sub>0</sub>(<italic>t</italic>) and <italic>M</italic><sub><italic>n</italic></sub>(<italic>t</italic>) are inhomogeneous Poisson processes with rates λ(<italic>t</italic>) and <italic>ν</italic><sub><italic>n</italic></sub>(<italic>t</italic>), respectively, where
<disp-formula id="pcbi.1005583.e024"><alternatives><graphic id="pcbi.1005583.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
so <inline-formula id="pcbi.1005583.e025"><alternatives><graphic id="pcbi.1005583.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. <italic>M</italic><sub><italic>n</italic></sub>(<italic>t</italic>) is a process with <italic>intensity</italic> that depends on a stochastic realization of <italic>N</italic><sub><italic>n</italic></sub>(<italic>t</italic>), making <italic>M</italic><sub>0</sub>(<italic>t</italic>) a “doubly stochastic” process. We can generate these processes recursively: To generate <italic>N</italic><sub><italic>n</italic></sub>(<italic>t</italic>), we use a realization of <italic>N</italic><sub><italic>n</italic>−1</sub>(<italic>t</italic>) to compute the rate <italic>ν</italic><sub><italic>n</italic>−1</sub> and generate a realization of <italic>M</italic><sub><italic>n</italic>−1</sub>(<italic>t</italic>). These are added to events generated from the original inhomogeneous Poisson process with rate λ(<italic>t</italic>) to produce <italic>N</italic><sub><italic>n</italic></sub>(<italic>t</italic>). We can use this recursive procedure to develop an expansion for the cumulants of the process at a given order in <italic>ϵ</italic> (thus a given order in the self-convolution of <italic>g</italic>).</p>
<p>Let us compute the value of <inline-formula id="pcbi.1005583.e026"><alternatives><graphic id="pcbi.1005583.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mo>〈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:math></alternatives></inline-formula> in powers of <italic>ϵ</italic> using our recursive approach. The zeroth order solution, <inline-formula id="pcbi.1005583.e027"><alternatives><graphic id="pcbi.1005583.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mo>〈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:math></alternatives></inline-formula>, is the rate of the inhomogeneous Poisson process λ(<italic>t</italic>). At order <italic>n</italic>, we compute <inline-formula id="pcbi.1005583.e028"><alternatives><graphic id="pcbi.1005583.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mo>〈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:math></alternatives></inline-formula> using the (<italic>n</italic> − 1)st order solution in the right-hand side of <xref ref-type="disp-formula" rid="pcbi.1005583.e023">Eq 13</xref>. At first order, using the Poisson solution for <inline-formula id="pcbi.1005583.e029"><alternatives><graphic id="pcbi.1005583.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mo>〈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> we get
<disp-formula id="pcbi.1005583.e030"><alternatives><graphic id="pcbi.1005583.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>=</mml:mo> <mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>+</mml:mo> <mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
<disp-formula id="pcbi.1005583.e031"><alternatives><graphic id="pcbi.1005583.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mspace width="1pt"/><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⟩</mml:mo><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula>
<disp-formula id="pcbi.1005583.e032"><alternatives><graphic id="pcbi.1005583.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
<disp-formula id="pcbi.1005583.e033"><alternatives><graphic id="pcbi.1005583.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
At second order we similarly arrive at
<disp-formula id="pcbi.1005583.e034"><alternatives><graphic id="pcbi.1005583.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>=</mml:mo> <mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>+</mml:mo> <mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
<disp-formula id="pcbi.1005583.e035"><alternatives><graphic id="pcbi.1005583.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mspace width="1pt"/><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⟩</mml:mo><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
<disp-formula id="pcbi.1005583.e036"><alternatives><graphic id="pcbi.1005583.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
At higher orders we would obtain further terms with additional convolutions with <italic>g</italic>.</p>
<p>It will be useful to write these expansions in another way, which will allow their form to generalize to nonlinear processes: we will construct the cumulants from the baseline rate and the propagator. We can always replace
<disp-formula id="pcbi.1005583.e037"><alternatives><graphic id="pcbi.1005583.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
resulting in
<disp-formula id="pcbi.1005583.e038"><alternatives><graphic id="pcbi.1005583.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(23)</label></disp-formula></p>
<p><xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4a</xref> shows the graphical representation of this expansion. As before, the order of the moment is given by the number of external vertices and each external vertex carries a measurement time <italic>t</italic><sub><italic>i</italic></sub>. We have three types of internal vertices: two open white vertices that carry factors of <italic>ϵ</italic> (one type has one wavy incoming and one wavy outgoing line; the other has one incoming dotted line and one wavy outgoing line) and one gray vertex (that has one outgoing dotted line). As before, each gray internal vertex corresponds to the source term, and thus represents the factor λ(<italic>t</italic>). The white internal vertices and their edges represent how the events generated by the source are propagated through the filter <italic>g</italic>. Each white vertex corresponds to a possible past event time, <italic>t</italic>′. To construct the cumulant corresponding to a diagram, we integrate over all these possible internal times, weighting each by their influence on the current spiking rate. These weights are given by the filters, <italic>g</italic>, represented by the wavy edges. The graphical representation of <inline-formula id="pcbi.1005583.e039"><alternatives><graphic id="pcbi.1005583.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mo>〈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:math></alternatives></inline-formula> (using the delta function as in <xref ref-type="disp-formula" rid="pcbi.1005583.e038">Eq 23</xref>) is shown in <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4a</xref>.</p>
<fig id="pcbi.1005583.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Diagrammatic expansion for the mean firing rate and linear response of the self-exciting process.</title>
<p>A) First-order approximation of the firing rate. B) Diagrams corresponding to the re-summing of the expansion of the mean field rate (<xref ref-type="disp-formula" rid="pcbi.1005583.e043">Eq 25</xref>), which is represented by the black dot. C) Diagrams corresponding to the re-summing calculation of the propagator (<xref ref-type="disp-formula" rid="pcbi.1005583.e050">Eq 28</xref>), which is represented by the solid edge. In all diagrams, time indices associated with internal vertices have been suppressed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g004" xlink:type="simple"/>
</fig>
<p>We can compute the firing rate of the self-exciting process <inline-formula id="pcbi.1005583.e040"><alternatives><graphic id="pcbi.1005583.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> as the limit of the <italic>n</italic>th order self-exciting processes, continuing the process outlined for <xref ref-type="disp-formula" rid="pcbi.1005583.e023">Eq 13</xref>:
<disp-formula id="pcbi.1005583.e041"><alternatives><graphic id="pcbi.1005583.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:mspace width="1pt"/><mml:msup><mml:mi>ϵ</mml:mi> <mml:mi>n</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>*</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula>
where <italic>g</italic><sup>(<italic>n</italic>)</sup> is the <italic>n</italic>-fold convolution of <italic>g</italic> with itself and <italic>g</italic><sup>(0)</sup>(<italic>t</italic>) = <italic>δ</italic>(<italic>t</italic>). Indeed, we can see that this expression for <inline-formula id="pcbi.1005583.e042"><alternatives><graphic id="pcbi.1005583.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> yields the same recursive self-consistency condition as above:
<disp-formula id="pcbi.1005583.e043"><alternatives><graphic id="pcbi.1005583.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi> <mml:mn>0</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>*</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:mspace width="1pt"/><mml:msup><mml:mi>ϵ</mml:mi> <mml:mi>n</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>*</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:mspace width="1pt"/><mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>*</mml:mo> <mml:mo>λ</mml:mo><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula></p>
<p>We can also represent this recursive relation graphically as in <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4b</xref>, using a black vertex to denote the mean-field rate <inline-formula id="pcbi.1005583.e044"><alternatives><graphic id="pcbi.1005583.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The infinite sum defined by <xref ref-type="disp-formula" rid="pcbi.1005583.e023">Eq 13</xref> has a specific graphical representation: the leftmost vertex and wavy line in the right-hand side of <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4b</xref> (top) can be detached and factored, with the remaining series of diagrams corresponding exactly to those of the mean. This series of subgraphs on the right-hand side sums to <inline-formula id="pcbi.1005583.e045"><alternatives><graphic id="pcbi.1005583.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mo>〈</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:math></alternatives></inline-formula>, leading to the recursion relation in <xref ref-type="disp-formula" rid="pcbi.1005583.e043">Eq 25</xref> (<xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4b</xref>). This graphical representation is equivalent to the recursion relation.</p>
<p>The propagator, Δ(<italic>t</italic>, <italic>t</italic>′), measures the fluctuation in the expected rate (around the mean-field value) in response to the addition of one spike at time <italic>t</italic>′ to the drive λ(<italic>t</italic>). Setting λ(<italic>t</italic>) ← λ(<italic>t</italic>) + <italic>δ</italic>(<italic>t</italic> − <italic>t</italic>′) and <inline-formula id="pcbi.1005583.e046"><alternatives><graphic id="pcbi.1005583.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>←</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005583.e022">Eq 12</xref> gives:
<disp-formula id="pcbi.1005583.e047"><alternatives><graphic id="pcbi.1005583.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
where for convolutions involving Δ(<italic>t</italic>, <italic>t</italic>′), we use the notation (<italic>f</italic> * Δ)(<italic>t</italic>, <italic>t</italic>′) = ∫ <italic>dt</italic>′′ <italic>f</italic>(<italic>t</italic> − <italic>t</italic>′′)Δ(<italic>t</italic>′′, <italic>t</italic>′) and (Δ * <italic>f</italic>)(<italic>t</italic>, <italic>t</italic>′) = ∫ <italic>dt</italic>′′ Δ(<italic>t</italic>, <italic>t</italic>′′)<italic>f</italic>(<italic>t</italic>′′ − <italic>t</italic>′)</p>
<p>As with the expected rate <inline-formula id="pcbi.1005583.e048"><alternatives><graphic id="pcbi.1005583.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we can examine the propagators of the <italic>n</italic>-th order self-exciting processes. For the first-order process <italic>N</italic><sub>1</sub>(<italic>t</italic>),
<disp-formula id="pcbi.1005583.e049"><alternatives><graphic id="pcbi.1005583.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula>
The first term is the propagator of the inhomogeneous Poisson process. The second term of Δ<sub>1</sub> is the propagator of the filtered Poisson process, <xref ref-type="disp-formula" rid="pcbi.1005583.e018">Eq 9</xref>. This equation can be represented by the same type of graphs as for the expected rate (<xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4c</xref> top), but stand for functions between two time points: the initial time <italic>t</italic>′ of the perturbation, and the later time <italic>t</italic>, at which we are computing the rate of the process. We don’t represent these initial and final points as vertices, because the propagator is a function that connects two vertices. However, we still integrate over the times corresponding to the internal vertices since the propagator accounts for the total effect of a perturbation of the source on the observed activity.</p>
<p>In general, the propagator for the <italic>n</italic>th-order self-exciting process can be computed by taking a functional derivate of the rate with respect to the input rate λ:
<disp-formula id="pcbi.1005583.e050"><alternatives><graphic id="pcbi.1005583.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="1pt"/><mml:mo stretchy="false">(</mml:mo><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mfrac><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>δ</mml:mi> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="1pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mspace width="1pt"/><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mspace width="1pt"/><mml:msup><mml:mi>ϵ</mml:mi> <mml:mi>k</mml:mi></mml:msup> <mml:msup><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
This recursion relation can be expressed graphically just as for the mean rate (<xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4c</xref>, top). Factoring out <italic>ϵg</italic>* corresponds to popping off an edge and vertex from the series (<xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4c</xref>, middle). Taking the limit <italic>n</italic> → ∞ in <xref ref-type="disp-formula" rid="pcbi.1005583.e050">Eq 28</xref> yields the self-consistency condition for the full propagator Δ(<italic>t</italic>, <italic>t</italic>′) given by <xref ref-type="disp-formula" rid="pcbi.1005583.e047">Eq 26</xref>, and indicated by the solid black line in <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4c</xref> (bottom).</p>
<p>These diagrammatic expansions may seem cumbersome for so simple a model. Even for the self-exciting Hawkes process, however, they allow the fast calculation of any order of spike train cumulant. Let us begin with the second cumulant of the instantaneous firing rate. Again we will construct an expansion in <italic>ϵ</italic>, i.e., powers of <italic>g</italic>. To zeroth order, this is the inhomogeneous Poisson solution. To first order in <italic>ϵ</italic> we have
<disp-formula id="pcbi.1005583.e051"><alternatives><graphic id="pcbi.1005583.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mi>s</mml:mi><mml:mspace width="1pt"/><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:mi>ϵ</mml:mi><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mi>s</mml:mi><mml:mspace width="1pt"/><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mi>s</mml:mi><mml:mspace width="1pt"/><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:mi>s</mml:mi><mml:mspace width="1pt"/><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(29)</label></disp-formula>
The first term on the second line is the second cumulant of the inhomogenous Poisson process. The other terms arise from the dependency of the processes <italic>M</italic><sub>0</sub>(<italic>t</italic>) and <italic>N</italic><sub>0</sub>(<italic>t</italic>). The expectation over <italic>M</italic><sub>0</sub>(<italic>t</italic>) must be performed first, followed by that over <italic>N</italic><sub>0</sub>(<italic>t</italic>), because the process <italic>M</italic><sub>0</sub>(<italic>t</italic>) is conditionally dependent on the realization of <italic>N</italic><sub>0</sub>(<italic>t</italic>), having intensity <inline-formula id="pcbi.1005583.e052"><alternatives><graphic id="pcbi.1005583.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1005583.e023">Eq 13</xref>). This decomposition relies on the linearity of the expectation operator.</p>
<p>We can construct diagrams for each of these terms using the same rules as before, with the addition of two new internal vertices (<xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5a</xref>). These new vertices are distinguished by their edges. The first has two outgoing dotted lines representing the zeroth-order propagator <italic>δ</italic>(<italic>t</italic> − <italic>t</italic>′), as in the second cumulant of the inhomogeneous Poisson process. It represents events that are generated by the drive λ(<italic>t</italic>) and propagate jointly to the two measurement time points. The second new vertex has the same two outgoing lines and one incoming wavy line for the filter <italic>g</italic>(<italic>t</italic>, <italic>t</italic>′)–it represents the fourth term on the right-hand side of <xref ref-type="disp-formula" rid="pcbi.1005583.e051">Eq 29</xref>. This vertex carries a factor of <italic>ϵ</italic> and represents the filtering of past events that then propagate to the two measurement time points.</p>
<fig id="pcbi.1005583.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Diagrammatic expansion for the second cumulant for the self-exciting process.</title>
<p>A) First-order approximation of the second cumulant. B) Re-summing to obtain the full second cumulant. Compare the expansions within the square brackets adjacent to external vertices to the expansion of the propagator, <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4c</xref>, and compare the expansion of the source term to that of the mean field rate, <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4b</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g005" xlink:type="simple"/>
</fig>
<p>Continuing the computation of the second cumulant to any order in <italic>ϵ</italic> will result in higher order terms of the linear response and expected rate being added to the corresponding legs of the graph. At a given order <italic>n</italic>, one leg of each diagram will be associated with a particular term in the expansion, to order <italic>n</italic>, of the expected rate or the linear response. The second cumulant of <italic>dN</italic><sub>2</sub>/<italic>dt</italic> would thus add diagrams with two filter edges to the diagrams of <xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5a</xref>, either both on the same leg of the graph or distributed among the graph’s three legs.</p>
<p>As with the filtered Poisson process, we can simplify this sum of four diagrams for the second cumulant of the first-order self-exciting process. Examining subgraphs of each term on the right-hand side of <xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5A</xref> reveals a connection to the linear response and mean rate of the first-order self-exciting processes. On each leg emanating from the internal branching vertex, the four terms sum to the product of two copies of the linear responses of the first-order self-exciting process <italic>N</italic><sub>1</sub>(<italic>t</italic>) (compare subgraphs on the top branch of the diagrams in <xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5a</xref> with <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4a</xref>). Similarly, the sum of the legs coming into the branching vertex is the firing rate of <italic>N</italic><sub>1</sub>(<italic>t</italic>) (compare to <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4b</xref>). So, we will group the terms on the legs of the graph into contributions to the linear response and the mean (<xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5b</xref> middle).</p>
<p>When we add the diagrams of up to order <italic>n</italic> together, we can separately re-sum each of these expansions because of the distributivity of the expectation. So, we can replace the entire series <italic>to all orders in ϵ</italic> with simpler diagrams using the full representations for the linear response and expected rate (<xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5b</xref>). This can be proved inductively, or by rigorously deriving the Feynman rules from the cumulant generating functional (Methods: Path integral representation). This yields the following result for the second cumulant, which corresponds to the final graph at the bottom far right of <xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5b</xref>:
<disp-formula id="pcbi.1005583.e053"><alternatives><graphic id="pcbi.1005583.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(30)</label></disp-formula>
This is the complete analytic result for the second cumulant of the self-exciting process for fluctuations around the mean field solution <inline-formula id="pcbi.1005583.e054"><alternatives><graphic id="pcbi.1005583.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005583.ref019">19</xref>]. It can be represented by the single term on the right-hand side of <xref ref-type="disp-formula" rid="pcbi.1005583.e053">Eq 30</xref> and the corresponding single diagram (<xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5b</xref>, right). Compare this with the filtered Poisson process, which has a diagram of the same topology but with different constituent factors (<xref ref-type="fig" rid="pcbi.1005583.g003">Fig 3C</xref>, middle row). The Feynman diagrams capture the form of the re-summed perturbative expansions for the cumulants, while the definitions of the vertices and edges capture the model-specific rate, <inline-formula id="pcbi.1005583.e055"><alternatives><graphic id="pcbi.1005583.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and propagator, Δ(<italic>t</italic>, <italic>t</italic>′).</p>
<p>One might think that the higher cumulants are generated as simply by replacing each leg of the filtered inhomogeneous Poisson process with the correct propagator, along with the rate <inline-formula id="pcbi.1005583.e056"><alternatives><graphic id="pcbi.1005583.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This would mean that the general cumulant term would be given by:
<disp-formula id="pcbi.1005583.e057"><alternatives><graphic id="pcbi.1005583.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.277778em"/><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
This is incorrect, as many important terms arising from the self-interaction would be lost.</p>
<p>The reason this naive generalization fails is that it neglects the higher-order responses to perturbations in the event rate. For example, the second cumulant responds to perturbations in the rate; this quadratic response impacts the third cumulant. We can see this in the third cumulant of the first-order self-exciting process:
<disp-formula id="pcbi.1005583.e058"><alternatives><graphic id="pcbi.1005583.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>↔</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>↔</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>↔</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>↔</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula>
The first term is the third cumulant of the inhomogeneous Poisson process. The second and third are generalizations of the terms found in the second cumulant (we have used (<italic>t</italic> ↔ <italic>t</italic>′ ↔ <italic>t</italic>′′) to denote “all other permutations of <italic>t</italic>, <italic>t</italic>′, <italic>t</italic>′′”). These terms are part of the naive expression in <xref ref-type="disp-formula" rid="pcbi.1005583.e057">Eq 31</xref>. The last term is the novel one that arises due to the “quadratic response.” It appears when we compute
<disp-formula id="pcbi.1005583.e059"><alternatives><graphic id="pcbi.1005583.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives> <label>(33)</label></disp-formula>
We have to take into account that the process <inline-formula id="pcbi.1005583.e060"><alternatives><graphic id="pcbi.1005583.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is correlated with the rate of the process <inline-formula id="pcbi.1005583.e061"><alternatives><graphic id="pcbi.1005583.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (since one is a linear function of the other!). This produces a “cascade” effect that results in the quadratic response. For the first-order process, only one step in the cascade is allowed. By introducing branching internal vertices similar to those in <xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5</xref>, we can express these somewhat unwieldy terms with diagrams. These are shown in <xref ref-type="fig" rid="pcbi.1005583.g006">Fig 6</xref>. The cascade of one source spike producing three spikes in the first-order process is represented by the second diagram of <xref ref-type="fig" rid="pcbi.1005583.g006">Fig 6a</xref> and the cascade of one source spike producing two spikes, one of which then produces another two spikes in the first-order process, is represented by the last diagram of <xref ref-type="fig" rid="pcbi.1005583.g006">Fig 6a</xref>.</p>
<fig id="pcbi.1005583.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Diagrams corresponding to third order cumulants.</title>
<p>A) Diagrams corresponding to the third cumulant of the first-order self-exciting process. B) Diagrams corresponding to the third cumulant of the self-exciting process, after resumming the perturbative expansion. Nodes and edges correspond to the same terms as in <xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g006" xlink:type="simple"/>
</fig>
<p>As before, continuing to higher orders in the recursively self-exciting process would add diagrams with additional filter edges along the legs of the graphs in <xref ref-type="fig" rid="pcbi.1005583.g006">Fig 6a</xref>, corresponding to additional steps in the potential cascades of induced spikes. For example, the third cumulant of the second-order process, <inline-formula id="pcbi.1005583.e062"><alternatives><graphic id="pcbi.1005583.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, would add diagrams with two filter edges to those of <xref ref-type="fig" rid="pcbi.1005583.g006">Fig 6a</xref>, with those two filter edges appearing either sequentially on the same leg of the graph or distributed among the legs of the graph. We can then use the same ideas that allowed us to re-sum the graphs representing the second cumulant. As before, we identify the expansions of the mean-field rate, <inline-formula id="pcbi.1005583.e063"><alternatives><graphic id="pcbi.1005583.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and the linear response, Δ, along individual legs of the graph and use the multilinearity of cumulants to resum those expansions to give the diagrams at the bottom of <xref ref-type="fig" rid="pcbi.1005583.g006">Fig 6</xref>.</p>
<p>Considering the re-summed graphs, we have the following result for the third cumulant:
<disp-formula id="pcbi.1005583.e064"><alternatives><graphic id="pcbi.1005583.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>↔</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>↔</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mo>′</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula></p>
<p>The types of diagram developed for up to the third cumulant encompass all the features that occur in the diagrammatic computations of cumulants of linearly self-exciting processes. The general rules for diagrammatically computing cumulants of this process are given in <xref ref-type="fig" rid="pcbi.1005583.g007">Fig 7</xref>. They are derived in general in Methods: Path integral representation. The graphs generated with this algorithm correspond to the re-summed diagrams we computed above.</p>
<fig id="pcbi.1005583.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Feynman rules for the self exciting process.</title>
<p>These rules provide an algorithm for computing the expansion of the cumulants around the mean field solution <inline-formula id="pcbi.1005583.e065"><alternatives><graphic id="pcbi.1005583.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The dots between the legs of the first two vertices indicate that there are such vertices with any number of outgoing legs greater than or equal to two.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g007" xlink:type="simple"/>
</fig>
<p>For the <italic>n</italic>th cumulant, <inline-formula id="pcbi.1005583.e066"><alternatives><graphic id="pcbi.1005583.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, begin with <italic>n</italic> white external vertices labelled <italic>t</italic><sub><italic>i</italic></sub> for each <italic>i</italic>. Construct all fully connected, directed graphs with the vertex and edge elements shown in <xref ref-type="fig" rid="pcbi.1005583.g007">Fig 7</xref>. For each such fully connected directed graph constructed with the component vertices and edges, the associated mathematical term is constructed by taking the product of each associated factor, then integrating over the time points of internal vertices. The <italic>n</italic>th cumulant is the sum of these terms. This produces cumulants of up to third order, as recently shown by Jovanović, Hertz &amp; Rotter [<xref ref-type="bibr" rid="pcbi.1005583.ref038">38</xref>], as well as cumulants of any order. As we show next, this procedure can also be generalized to calculate cumulants in the presence of a nonlinearity, including both thresholds enforcing positive activity (as commonly disregarded in studies of the Hawkes process) and any nonlinear input-rate transfer function.</p>
</sec>
<sec id="sec007">
<title>Nonlinearities impose bidirectional coupling between different orders of activity: Nonlinearly self-exciting process</title>
<p>Now we include a nonlinearity in the firing rate, so that the process produces events <italic>dN</italic>/<italic>dt</italic> with a rate given by
<disp-formula id="pcbi.1005583.e067"><alternatives><graphic id="pcbi.1005583.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mrow><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(35)</label></disp-formula>
We begin by considering the mean-field solution <inline-formula id="pcbi.1005583.e068"><alternatives><graphic id="pcbi.1005583.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, which, if it exists, is self-consistently given by <inline-formula id="pcbi.1005583.e069"><alternatives><graphic id="pcbi.1005583.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Thus, as always the mean-field solution is given by neglecting second and higher-order cumulants of the spiking process. Next, we consider the propagator, which as above is the linear response of the rate around the mean field, given by expanding <xref ref-type="disp-formula" rid="pcbi.1005583.e067">Eq 35</xref> around the mean-field solution <inline-formula id="pcbi.1005583.e070"><alternatives><graphic id="pcbi.1005583.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and examining the gain with respect to a perturbation of the rate. This propagator obeys:
<disp-formula id="pcbi.1005583.e071"><alternatives><graphic id="pcbi.1005583.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e071" xlink:type="simple"/><mml:math display="block" id="M71"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(36)</label></disp-formula>
where <italic>ϕ</italic><sup>(1)</sup> is the first derivative of <italic>ϕ</italic> with respect to the input, evaluated at <inline-formula id="pcbi.1005583.e072"><alternatives><graphic id="pcbi.1005583.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We will first develop a recursive formulation of the mean-field rate and propagator, which will be required for calculating cumulants of the full process. For an arbitrary nonlinearity <italic>ϕ</italic>, we would begin by Taylor expanding around 0. For simplicity, we here consider a quadratic <italic>ϕ</italic> so that:
<disp-formula id="pcbi.1005583.e073"><alternatives><graphic id="pcbi.1005583.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e073" xlink:type="simple"/><mml:math display="block" id="M73"><mml:mrow><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(37)</label></disp-formula>
We now develop the point process <italic>dN</italic>/<italic>dt</italic> recursively at each order of the nonlinearity:
<disp-formula id="pcbi.1005583.e074"><alternatives><graphic id="pcbi.1005583.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e074" xlink:type="simple"/><mml:math display="block" id="M74"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(38)</label></disp-formula>
where <italic>M</italic><sub><italic>m</italic>,<italic>n</italic></sub> is an inhomogeneous Poisson process with rate <inline-formula id="pcbi.1005583.e075"><alternatives><graphic id="pcbi.1005583.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <italic>P</italic><sub><italic>m</italic>,<italic>n</italic></sub> is an inhomogeneous Poisson process with rate <inline-formula id="pcbi.1005583.e076"><alternatives><graphic id="pcbi.1005583.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <italic>N</italic><sub>0,0</sub>(<italic>t</italic>) is an inhomogeneous Poisson process with rate λ(<italic>t</italic>). To generate a set of events in <italic>N</italic> at order <italic>m</italic> in the linear term of <italic>ϕ</italic> and order <italic>n</italic> in the quadratic term of <italic>ϕ</italic>, we take events at each previous order, (<italic>m</italic> − 1, <italic>n</italic>) and (<italic>m</italic>, <italic>n</italic> − 1) and use those to develop <italic>M</italic><sub><italic>m</italic>−1,<italic>n</italic></sub>(<italic>t</italic>) and <italic>P</italic><sub><italic>m</italic>,<italic>n</italic>−1</sub>(<italic>t</italic>). These, together with <italic>N</italic><sub>0,0</sub>(<italic>t</italic>), give <inline-formula id="pcbi.1005583.e077"><alternatives><graphic id="pcbi.1005583.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In contrast to the linear self-exciting process, the quadratic process here is recursively defined on a lattice.</p>
<p>Similar to the case of the linearly self-exciting process, we can use this recursive definition to develop an expansion for the mean-field rate and propagator in powers of <italic>ϵ</italic><sub>1</sub> and <italic>ϵ</italic><sub>2</sub>. When we calculate higher-order cumulants, we will identify the expansions of the mean-field firing rate and propagator which will allow us to use them to simplify the resulting diagrams. The mean-field rate to finite order in <italic>m</italic>, <italic>n</italic> is once again given by neglecting second and higher-order cumulants of <italic>N</italic><sub><italic>n</italic>,<italic>m</italic></sub>, which allows us to take an expectation inside the quadratic term of <xref ref-type="disp-formula" rid="pcbi.1005583.e074">Eq 38</xref>. Taking the expectation of both sides of this equation in the mean field approach then yields:
<disp-formula id="pcbi.1005583.e078"><alternatives><graphic id="pcbi.1005583.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e078" xlink:type="simple"/><mml:math display="block" id="M78"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(39)</label></disp-formula>
For example,
<disp-formula id="pcbi.1005583.e079"><alternatives><graphic id="pcbi.1005583.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(40)</label></disp-formula>
where
<disp-formula id="pcbi.1005583.e080"><alternatives><graphic id="pcbi.1005583.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e080" xlink:type="simple"/><mml:math display="block" id="M80"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(41)</label></disp-formula>
<disp-formula id="pcbi.1005583.e081"><alternatives><graphic id="pcbi.1005583.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e081" xlink:type="simple"/><mml:math display="block" id="M81"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(42)</label></disp-formula></p>
<p>Similarly, the propagator (for the dynamics of the recursive process, linearized around zero) is, to finite order in <italic>m</italic>, <italic>n</italic>:
<disp-formula id="pcbi.1005583.e082"><alternatives><graphic id="pcbi.1005583.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e082" xlink:type="simple"/><mml:math display="block" id="M82"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(43)</label></disp-formula></p>
<p>To zeroth order in <italic>ϵ</italic><sub>2</sub>, this yields an expansion of the mean-field rate <inline-formula id="pcbi.1005583.e083"><alternatives><graphic id="pcbi.1005583.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which takes the same form as the expansion of the rate of the linearly self-exciting process (<xref ref-type="disp-formula" rid="pcbi.1005583.e023">Eq 13</xref>) and admits the same graphical representation (<xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4b</xref>). Similarly, a perturbative expansion of the linear response about the mean-field rate to zeroth order in <italic>ϵ</italic><sub>2</sub> takes the same form as for the linearly self-exciting process (<xref ref-type="disp-formula" rid="pcbi.1005583.e050">Eq 28</xref>) and admits the same graphical representation (<xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4c</xref>).</p>
<p>To account for the nonlinear terms arising at first order and greater in <italic>ϵ</italic><sub>2</sub>, we will need to add another type of internal vertex in diagrammatic descriptions of the cumulants. These vertices, carrying factors of <italic>ϵ</italic><sub>2</sub>, will have two incoming edges and any number of outgoing edges. Each incoming edge carries the operator <italic>g</italic>* and the number of incoming edges corresponds to the order in the Taylor expansion of the nonlinearity. (It also corresponds to the order of cumulant influencing that vertex’s activity. The number of outgoing edges corresponds to the order of cumulant being influenced, locally in that subgraph.) The factor of <inline-formula id="pcbi.1005583.e084"><alternatives><graphic id="pcbi.1005583.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that appears in other vertices is modified to be consistent with the mean firing rate under the quadratic nonlinearity, and will thus obey <xref ref-type="disp-formula" rid="pcbi.1005583.e067">Eq 35</xref> above.</p>
<p>The mean-field rate and propagator, to first order and greater in <italic>ϵ</italic><sub>2</sub>, can be represented diagrammatically using the new vertex (e.g., <xref ref-type="fig" rid="pcbi.1005583.g008">Fig 8a and 8b</xref>). Notice that these directed graphs are treelike, but with their leaves in the past. Repeating these calculations to the next order in <italic>ϵ</italic><sub>2</sub> can be accomplished by taking the basic structure of <xref ref-type="fig" rid="pcbi.1005583.g008">Fig 8</xref> and, along each leg entering the new vertex for <italic>ϵ</italic><sub>2</sub>, inserting the previous-order graphs (Figs <xref ref-type="fig" rid="pcbi.1005583.g004">4a</xref> and <xref ref-type="fig" rid="pcbi.1005583.g008">8a</xref>). Including higher-order terms in <italic>ϵ</italic><sub>1</sub> would require inserting those graphs along the <italic>ϵ</italic>-carrying vertices of <xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4a</xref>.</p>
<fig id="pcbi.1005583.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Expansion of the mean firing rate and propagator for the nonlinearly self-exciting process.</title>
<p>A) One of the first nonlinear terms of the expansion of the mean-field firing rate, to first order in the quadratic term of the nonlinearity and zeroth order in the linear term. The two diagrams shown correspond to the two terms in <xref ref-type="disp-formula" rid="pcbi.1005583.e081">Eq 42</xref>. B) First nonlinear terms of the expansion of the propagator around the mean-field firing rate.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g008" xlink:type="simple"/>
</fig>
<p>In addition to expanding the mean field rate and propagator, we can use <xref ref-type="disp-formula" rid="pcbi.1005583.e074">Eq 38</xref> to calculate cumulants of <inline-formula id="pcbi.1005583.e085"><alternatives><graphic id="pcbi.1005583.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> to finite order in <italic>ϵ</italic><sub>1</sub> and <italic>ϵ</italic><sub>2</sub>. The first nonlinear correction to the firing rate appears at first order in <italic>ϵ</italic><sub>2</sub>:
<disp-formula id="pcbi.1005583.e086"><alternatives><graphic id="pcbi.1005583.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e086" xlink:type="simple"/><mml:math display="block" id="M86"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives> <label>(44)</label></disp-formula>
which can be represented diagrammatically using the new vertex (<xref ref-type="fig" rid="pcbi.1005583.g009">Fig 9a</xref>). Notice that in contrast to the corresponding graph for the mean field expansion (<xref ref-type="fig" rid="pcbi.1005583.g008">Fig 8a</xref>), this diagram has a “loop” (a cycle were it an undirected graph). This reflects the dependence of the rate on the second cumulant of the baseline process <italic>N</italic><sub>0,0</sub>. This dependence of the firing rate on higher-order spiking cumulants is a fundamental feature of nonlinearities.</p>
<fig id="pcbi.1005583.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Corrections to the mean-field firing rate and propagator of the nonlinearly self-exciting process, to quadratic order in the nonlinearity <italic>ϕ</italic>.</title>
<p>A) The correction to mean field theory for the firing rate to first order in the quadratic term of <italic>ϕ</italic>. B) The full one-loop correction to the mean-field rate. C) The full one-loop correction to the propagator.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g009" xlink:type="simple"/>
</fig>
<p>Proceeding beyond the first order in both <italic>ϵ</italic><sub>1</sub> and <italic>ϵ</italic><sub>2</sub>, we see that the expansion of each term of the nonlinearity depends on the other:
<disp-formula id="pcbi.1005583.e087"><alternatives><graphic id="pcbi.1005583.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives> <label>(45)</label></disp-formula>
so that at each order in <italic>ϵ</italic><sub>2</sub> we must insert the solution at the previous order in <italic>ϵ</italic><sub>2</sub> and the same order in <italic>ϵ</italic><sub>1</sub> (and vice versa). This recursive mixing of expansions between the linear and nonlinear terms of <italic>ϕ</italic> seems intractable. However, this joint expansion can be re-summed; for a more formal derivation, see Methods: Path integral representation. For the linear model, this re-summing left us with simple expressions for the firing rate and propagator. For the nonlinear model, re-summing leaves us with a new expansion organized by the number of loops appearing the Feynman diagrams, so it is called a loop expansion. The Feynman rules for the re-summed diagrams of the nonlinearly self-exciting process are given in <xref ref-type="fig" rid="pcbi.1005583.g010">Fig 10</xref>. For a quadratic nonlinearity, these rules allow us to write the one-loop contribution to the firing rate (<xref ref-type="fig" rid="pcbi.1005583.g009">Fig 9b</xref>):
<disp-formula id="pcbi.1005583.e088"><alternatives><graphic id="pcbi.1005583.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e088" xlink:type="simple"/><mml:math display="block" id="M88"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:msup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(46)</label></disp-formula>
where <italic>ϕ</italic><sup>(2)</sup> is evaluated at <inline-formula id="pcbi.1005583.e089"><alternatives><graphic id="pcbi.1005583.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. These Feynman rules also allow us write down the one-loop correction to the propagator (<xref ref-type="fig" rid="pcbi.1005583.g009">Fig 9c</xref>):
<disp-formula id="pcbi.1005583.e090"><alternatives><graphic id="pcbi.1005583.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e090" xlink:type="simple"/><mml:math display="block" id="M90"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>Δ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:msup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mo>Δ</mml:mo><mml:mo stretchy="false">)</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(47)</label></disp-formula></p>
<fig id="pcbi.1005583.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Feynman rules for the nonlinearly self exciting process.</title>
<p>These rules provide an algorithm for computing the expansion of the cumulants around the mean field solution <inline-formula id="pcbi.1005583.e091"><alternatives><graphic id="pcbi.1005583.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The dots between the outgoing legs of the first vertex indicate that there any number of outgoing legs greater than or equal to two. The number <italic>b</italic> of incoming edges of the second vertex correspond to its factor containing the <italic>b</italic>th derivative of <italic>ϕ</italic>, evaluated at the mean field input. The <italic>a</italic> dots between the outgoing edges of the second vertex indicate that it can have any number of outgoing edges such that <italic>a</italic> + <italic>b</italic> ≥ 3.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g010" xlink:type="simple"/>
</fig>
<p>The appearance of a loop in the Feynman diagram for the mean rate of the quadratically self-exciting process is a general feature of nonlinearities. It represents the influence of higher-order spike train cumulants on lower order ones. In order to measure that dependency, we can count the number of loops in the graphs. To do this, we add a bookkeeping variable, <italic>h</italic>. We count the number of loops by multiplying factors of <italic>h</italic> and 1/<italic>h</italic>. Each internal vertex adds a factor of 1/<italic>h</italic> and each outgoing edge a factor of <italic>h</italic>. In this way, every vertex with more than one outgoing edge will contribute a factor of <italic>h</italic> for every edge beyond the first. <italic>h</italic> thus effectively counts the order of fluctuations contributed by the vertex. For example, the mean for the linear self-exciting process has a graph with a single internal vertex and a single internal edge, so it is zeroth order in <italic>h</italic> (<xref ref-type="fig" rid="pcbi.1005583.g004">Fig 4b</xref>). The two-point function, however, having two edges and one internal vertex (<xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5b</xref>), is first order in <italic>h</italic>. Similarly, the tree-level diagrams will always contribute a total of <italic>h</italic><sup><italic>n</italic>−1</sup>, where <italic>n</italic> is the order of the cumulant.</p>
<p>In terms of powers of <italic>h</italic>, a graph for a <italic>n</italic>th order cumulant with one loop will be equivalent to a graph for a <italic>n</italic> + 1st order cumulant with one less loop. Consider cutting one of the lines that form the loop in <xref ref-type="fig" rid="pcbi.1005583.g009">Fig 9b</xref> at the internal vertex and leaving it hanging. Now the graph for the one-loop correction to the mean rate appears to be a graph for a second cumulant–it has two endpoints. The power counting in terms of <italic>h</italic>, however, has not changed. The one-loop correction to the mean is of the same order in <italic>h</italic> as the tree-level second cumulant. In general, we will have that the order <italic>h</italic><sup><italic>m</italic></sup> will be given by
<disp-formula id="pcbi.1005583.e092"><alternatives><graphic id="pcbi.1005583.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e092" xlink:type="simple"/><mml:math display="block" id="M92"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives> <label>(48)</label></disp-formula>
where <italic>n</italic> is the number of external vertices and <italic>l</italic> is the number of internal loops. The number of loops thus tracks the successive contributions of the higher order fluctuations. This expansion is called the “loop” expansion and is equivalent to a small-fluctuation expansion. If one can control the size of the fluctuations, one can truncate the loop expansion as an approximation for the statistics of the system. One way of doing this with networks is to insure that the interactions are <inline-formula id="pcbi.1005583.e093"><alternatives><graphic id="pcbi.1005583.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> so that <italic>h</italic> ∝ 1/<italic>N</italic> and the expansion becomes a system size expansion.</p>
<p>The Taylor expansion of an arbitrary nonlinearity <italic>ϕ</italic> could have infinitely many terms. This would lead, in the recursive formulation, to infinitely many processes {<italic>M</italic>, <italic>P</italic>, …}. Even after re-summing the recursive formulation, this would leave an infinite number of diagrams corresponding to any given cumulant. There are two ways to approach this. The first is to insist on a perturbative expansion in the nonlinear terms, e.g., only consider terms up to a fixed order in the Taylor expansion of the nonlinearity <italic>ϕ</italic>.</p>
<p>The second approach to controlling the order of the loop expansion is to consider a regime in which mean field theory is stable as this will also control the fluctuations, limiting the magnitude of the loop contributions [<xref ref-type="bibr" rid="pcbi.1005583.ref039">39</xref>]. We expect that the bookkeeping variable <italic>h</italic> could be related to the largest eigenvalue of the tree-level propagator, λ<sub>1</sub>, so that <italic>m</italic>-loop corrections would scale as <inline-formula id="pcbi.1005583.e094"><alternatives><graphic id="pcbi.1005583.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:msubsup><mml:mo>λ</mml:mo> <mml:mn>1</mml:mn> <mml:mi>m</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. The expansion then breaks down in the regime of a bifurcation or “critical point.” In this case, the spectrum of the linear response diverges, causing all loop diagrams to similarly diverge. This is a fluctuation-dominated regime in which mean field theory, along with the fluctuation expansion around it, fails. In that case, renormalization arguments can allow discussion of the scaling behavior of correlations [<xref ref-type="bibr" rid="pcbi.1005583.ref040">40</xref>].</p>
</sec>
<sec id="sec008">
<title>Interaction between single-neuron nonlinearities and network structure</title>
<p>No new concepts are required in moving from a nonlinear self-exciting process to a network of interacting units. Each external and internal vertex must now be associated with a unique neuron index <italic>i</italic> and the integrations over time for the internal vertices must now be accompanied by summations over the indices of the internal vertices. In addition, the filter <italic>g</italic>(<italic>τ</italic>) must be expanded to include coupling across units. In general, this is given by <bold>g</bold><sub><italic>ij</italic></sub>(<italic>τ</italic>) for the coupling from neuron <italic>j</italic> to neuron <italic>i</italic>. We will consider the general model of a network of units that generate conditionally Poisson-distributed events, given an input variable. The conditional rate for unit <italic>i</italic> is given by
<disp-formula id="pcbi.1005583.e095"><alternatives><graphic id="pcbi.1005583.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e095" xlink:type="simple"/><mml:math display="block" id="M95"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(49)</label></disp-formula>
Similarly, the propagator now obeys
<disp-formula id="pcbi.1005583.e096"><alternatives><graphic id="pcbi.1005583.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e096" xlink:type="simple"/><mml:math display="block" id="M96"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(50)</label></disp-formula>
These dynamics are qualitatively the same as those of the nonlinearly self-exciting process (<xref ref-type="disp-formula" rid="pcbi.1005583.e067">Eq 35</xref> but replace the neuron’s own rate with the sum over its presynaptic inputs). Introducing these sums over neuron indices yields the complete set of rules for generating Feynman diagrams for the cumulants of this model (<xref ref-type="fig" rid="pcbi.1005583.g011">Fig 11</xref>).</p>
<fig id="pcbi.1005583.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Feynman rules for networks of stochastically spiking neurons with nonlinear input-rate transfer <italic>ϕ</italic>.</title>
<p>These rules provide an algorithm for computing the expansion of the cumulants around the mean field solution <inline-formula id="pcbi.1005583.e097"><alternatives><graphic id="pcbi.1005583.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The dots between the outgoing legs of the first vertex indicate that there are any number of outgoing legs greater than or equal to two. The number <italic>b</italic> of incoming edges of the second vertex correspond to its factor containing the <italic>b</italic>th derivative of <italic>ϕ</italic>, evaluated at the mean field input. The <italic>a</italic> dots between the outgoing edges of the second vertex indicate that it can have any number of outgoing edges such that <italic>a</italic> + <italic>b</italic> ≥ 3.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g011" xlink:type="simple"/>
</fig>
<sec id="sec009">
<title>Mid-course summary: Diagrammatic expansion reveals interplay of network structure and neural nonlinearities in driving neural activity</title>
<p>To summarize, we now have in hand a set of tools—a fluctuation expansion—to compute spike train cumulants of arbitrary order in networks of linear-nonlinear-Poisson neurons. This expansion provides a systematic way to account for the synergistic dependence of lower-order activity on higher-order activity through the spiking nonlinearity and naturally incorporates the full microstructure of the neuronal network. The order of the nonlinearity (for non-polynomials, the order of its Taylor expansion) determines the single-neuron transfer gain (<xref ref-type="fig" rid="pcbi.1005583.g012">Fig 12</xref> left). It <italic>also</italic> determines how activity propagates through the network (<xref ref-type="fig" rid="pcbi.1005583.g012">Fig 12</xref>).</p>
<fig id="pcbi.1005583.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Fluctuation expansion links single-neuron nonlinearities and network structure to determine network activity.</title>
<p>The linear response for linear neurons depends on the network structure both explicitly and implicitly, through the mean-field rates. The first nonlinear correction brings in additional explicit and implicit dependencies on the connectivity.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g012" xlink:type="simple"/>
</fig>
<p>We next provide an example of using this fluctuation expansion to compute a cumulant of spiking activity: the first nonlinear correction to the second cumulant. We will compute these using the Feynman rules (<xref ref-type="fig" rid="pcbi.1005583.g011">Fig 11</xref>) to construct the corresponding diagrams, from which we will write the corresponding equation.</p>
<p>We begin by placing external vertices corresponding to the measurement times, each with one propagator edge coming into it. For the two-point cumulant there are two external vertices (<xref ref-type="fig" rid="pcbi.1005583.g013">Fig 13a</xref>). The propagators coming into those external vertices can, according to the Feynman rules, arise from either a source vertex or from an internal vertex with incoming filter edges (<xref ref-type="fig" rid="pcbi.1005583.g011">Fig 11</xref>). If both propagators arise from a source vertex, we arrive at the tree-level diagram of <xref ref-type="fig" rid="pcbi.1005583.g005">Fig 5b</xref>, which provides the linear prediction for the two-point cumulant. To obtain the first nonlinear correction, we will begin by adding an internal vertex. There are two ways we can do this: with one internal vertex providing the propagators for both external vertices or with the internal vertex providing the propagator of just one external vertex (<xref ref-type="fig" rid="pcbi.1005583.g013">Fig 13b</xref>, top and bottom respectively).</p>
<fig id="pcbi.1005583.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Construction of Feynman diagrams for the first nonlinear correction to the two-point cumulant (graphs containing one loop).</title>
<p>In each panel, we add a new layer of vertices to the diagrams, until we arrive at a source vertex. When there are multiple potential ways to add vertices, we add diagrams to account for each of those constructions. A) External vertices corresponding to the two measurement times, with incoming propagator (Δ) edges. B) Diagrams with one internal vertex added. <italic>t</italic><sub>1</sub> ↔ <italic>t</italic><sub>2</sub> corresponds to switching the two external vertices in the bottom diagram; the top diagram is symmetric with respect to that switch. C) Diagrams with two layers of vertices. The top diagram finishes that of B, top. The second two arise from the second diagram of B, and each also have copies with <italic>t</italic><sub>1</sub> ↔ <italic>t</italic><sub>2</sub>. D) Last diagrams containing one loop. The final diagrams corresponding to the one-loop correction to the second cumulant are the top two of C) and that of D).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g013" xlink:type="simple"/>
</fig>
<p>We next proceed to add another layer of vertices. The internal vertices added in each diagram of <xref ref-type="fig" rid="pcbi.1005583.g013">Fig 13b</xref> have incoming propagator edges. Those edges could emanate from other internal vertices or from source verticies. We will start by finishing the diagrams where they emanate from source vertices; placing these yields the top two, final diagrams of <xref ref-type="fig" rid="pcbi.1005583.g013">Fig 13c</xref>. We then continue constructing the diagram with an internal vertex providing the two propagators (<xref ref-type="fig" rid="pcbi.1005583.g013">Fig 13c</xref>, bottom). Note that if we added an internal vertex to the propagator hitting the <italic>t</italic><sub>2</sub> external vertex, it would require at least two incoming filter edges (in order to obey <italic>a</italic> + <italic>b</italic> ≥ 3 per the rules of <xref ref-type="fig" rid="pcbi.1005583.g011">Fig 11</xref>), which would give rise to a second loop in the graph.</p>
<p>This last diagram has a hanging filter edge, which must arise from an internal vertex with one incoming propagator edge. We finish the diagram with that internal vertex and the source vertex providing its propagator (<xref ref-type="fig" rid="pcbi.1005583.g013">Fig 13d</xref>). We could not add additional internal vertices along that path, since they would either violate <italic>n</italic> + <italic>m</italic> ≥ 3 or give rise to more than one loop in the diagram (and thus belong at a higher order in the loop expansion).</p>
<p>Following the rules of <xref ref-type="fig" rid="pcbi.1005583.g011">Fig 11</xref> while restricting ourselves to graphs with a certain number of loops (here one) thus allowed us to construct the diagrams corresponding to the first nonlinear correction to the two-point cumulant. We next write the equation corresponding to these diagrams. For each of the complete diagrams, we begin at the external vertices and, proceeding from left to right in the graph, multiply the factors corresponding to each edge and vertex together. We finish by summing over indices for all internal vertices and integrating over all internal time points. The contributions from each diagram are then added together. This yields:
<disp-formula id="pcbi.1005583.e098"><alternatives><graphic id="pcbi.1005583.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e098" xlink:type="simple"/><mml:math display="block" id="M98"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>‴</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:mo>⋅</mml:mo><mml:mspace width="1pt"/><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>‴</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>‴</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>‴</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mspace width="1pt"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd columnalign="center"><mml:mo>+</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mspace width="1pt"/><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>t</mml:mi><mml:mo>‴</mml:mo></mml:msup><mml:mspace width="1pt"/><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1pt"/><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mspace width="1pt"/><mml:mo>*</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>‴</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>‴</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>‴</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(51)</label></disp-formula></p>
</sec>
</sec>
<sec id="sec010">
<title>Demonstrating the interplay between single-neuron transfer, connectivity structure and network dynamics</title>
<p>Our methods predict how spike time statistics of all orders emerge from the interplay of single-neuron input-output properties and the structure of network connectivity. Here we demonstrate how these methods can be used to predict key phenomena in recurrent spiking networks: the fluctuations and stability of population activity. First, we isolate the contributions of nonlinearities in single-neuron dynamics to network activity and coding as a whole. We do so by computing “one-loop” correction terms; these correspond to the first structures in our diagrammatic expansion that arise from nonlinear neural transfer. The one-loop corrections provide for the dependence of <italic>n</italic>th order spiking cumulants on <italic>n</italic> + 1st order cumulants. Predictions that would be made by linearizing neural dynamics, as in classic approaches for predicting pairwise correlations [<xref ref-type="bibr" rid="pcbi.1005583.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref041">41</xref>] and recent ones for higher-order correlations [<xref ref-type="bibr" rid="pcbi.1005583.ref038">38</xref>], are described as “tree-level.” We show how these one-loop corrections, which give new, explicit links between network structure and dynamics (<xref ref-type="fig" rid="pcbi.1005583.g012">Fig 12</xref>), predict spiking statistics and stability in recurrent networks.</p>
</sec>
<sec id="sec011">
<title>1. Recurrent spike-train correlations drive firing statistics and stability in nonlinear networks</title>
<p>In our analysis of the impact of nonlinear neural transfer on network dynamics, a principal finding was that spike correlations could affect firing rates, as described by the one-loop correction to the mean-field firing rates. In this section we illustrate the importance of this effect in a class of networks under intensive study in neuroscience: randomly connected networks of excitatory and inhibitory cells. We began with a network for which we expect classical theoretical tools to work well, taking the neurons to have threshold-linear transfer functions <italic>ϕ</italic>(<italic>x</italic>) = <italic>α</italic>⌊<italic>x</italic>⌋. Here, as long as the neurons do not receive input fluctuations that push their rates below this threshold, the tree-level’ theory that takes transfer to be entirely linear should work well. We then move on to consider nonlinear effects.</p>
<p>As in our original motivational example, we took network connectivity to be totally random (Erdös-Rényi), with <italic>p</italic><sub><italic>EE</italic></sub> = 0.2 and <italic>p</italic><sub><italic>EI</italic></sub> = <italic>p</italic><sub><italic>IE</italic></sub> = <italic>p</italic><sub><italic>II</italic></sub> = 0.5. The magnitude of all connections of a given type (<italic>E</italic> − <italic>E</italic>, etc.) was taken to be the same and the time course of all network interactions was governed by the same filter <inline-formula id="pcbi.1005583.e099"><alternatives><graphic id="pcbi.1005583.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mrow><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>t</mml:mi> <mml:msup><mml:mi>τ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (with <italic>τ</italic> = 10 ms), so that <bold>g</bold><sub><italic>ij</italic></sub>(<italic>t</italic>) = <bold>W</bold><sub><italic>ij</italic></sub> <italic>g</italic>(<italic>t</italic>). (The matrix <bold>W</bold> contains synaptic weights.) The net inhibitory input weight on to a neuron was, on average, twice that of the net excitatory input weight.</p>
<p>We examined the spiking dynamics as the strength of synaptic weights proportionally increased (<xref ref-type="fig" rid="pcbi.1005583.g014">Fig 14a</xref>) and studied network activity with using both theory and direct simulation. Due to the high relative strength of inhibitory synapses in the network, firing rates decreased with synaptic weight (<xref ref-type="fig" rid="pcbi.1005583.g014">Fig 14d</xref>). The magnitude of spike train covariances (reflected by the integrated autocovariance of the summed excitatory population spike train) increased (<xref ref-type="fig" rid="pcbi.1005583.g014">Fig 14e</xref>). These changes were also visible in raster plots of the network’s activity (<xref ref-type="fig" rid="pcbi.1005583.g014">Fig 14b and 14c</xref>).</p>
<fig id="pcbi.1005583.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Dynamics approaching the firing-rate instability in threshold-linear networks.</title>
<p>A) Threshold-linear input-rate transfer function. B,C) Raster plots of 1 second realizations of activity for weak and strong synaptic weights. Neurons 0–199 are excitatory and 200–240 are inhibitory. B) (<italic>W</italic><sub><italic>EE</italic></sub>, <italic>W</italic><sub><italic>EI</italic></sub>, <italic>W</italic><sub><italic>IE</italic></sub>, <italic>W</italic><sub><italic>II</italic></sub>) = (.025, −.1, .01, −.1) mV. C) (<italic>W</italic><sub><italic>EE</italic></sub>, <italic>W</italic><sub><italic>EI</italic></sub>, <italic>W</italic><sub><italic>IE</italic></sub>, <italic>W</italic><sub><italic>II</italic></sub>) = (.2, −.8, .08, −0.8) mV. D-F) Average firing rate of the excitatory neurons (D), integral of the auto-covariance function of the summed population spike train (E), and spectral radius of the stability matrix of mean field theory (F) vs. excitatory-excitatory synaptic weight. While excitatory-excitatory weight is plotted on the horizontal axis, all other synaptic weights increase proportionally with it. Black lines: tree-level theory: mean-field firing rates and covariance computed by linearizing dynamics around it, for each value of synaptic weights. Dots: simulation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g014" xlink:type="simple"/>
</fig>
<p>At a critical value of the synaptic weights, the mean field theory for the firing rates loses stability (<xref ref-type="fig" rid="pcbi.1005583.g014">Fig 14f</xref>). The location of this critical point is predicted by the linear stability of the dynamics around the mean-field rate; the spectrum of the propagator <bold>Δ</bold>(<italic>ω</italic>) = (<bold>I</bold> − <italic>ϕ</italic><sup>(1)</sup> <bold>g</bold>(<italic>ω</italic>))<sup>−1</sup> diverges when the spectral radius of <italic>ϕ</italic><sup>(1)</sup> <bold>g</bold> is ≥1. (This is also the point where the spectral radius of the inverse propagator crosses zero.) Until that critical point, however, the tree-level predictions for both firing rates and spike train covariances (i.e., mean field theory and linear response theory) provided accurate predictions (<xref ref-type="fig" rid="pcbi.1005583.g014">Fig 14d and 14e</xref>).</p>
<p>We next give a simple example of how nonlinearities in neural transfer cause this standard tree-level theory (mean-field formulas for rates and linear response theory for covariances) to fail–and how tractable one-loop corrections from our theory give a much-improved description of network dynamics. We take the same network as above, but replace neurons’ threshold-linear transfer functions with a rectified power law <italic>ϕ</italic>(<italic>x</italic>) = <italic>α</italic>⌊<italic>x</italic>⌋<sup><italic>p</italic></sup> (<xref ref-type="fig" rid="pcbi.1005583.g015">Fig 15a</xref>). This has been suggested as a good description of neural transfer near threshold [<xref ref-type="bibr" rid="pcbi.1005583.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref046">46</xref>]. For simplicity, we take the power law to be quadratic (<italic>p</italic> = 2). As we increased synaptic weights, the tree-level theory qualitatively failed to predict the magnitude of spike train covariances and firing rates (<xref ref-type="fig" rid="pcbi.1005583.g015">Fig 15d and 15e</xref> black curve vs. dots). This occurred well before the mean-field firing rates lost stability (<xref ref-type="fig" rid="pcbi.1005583.g015">Fig 15f</xref>, black).</p>
<fig id="pcbi.1005583.g015" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g015</object-id>
<label>Fig 15</label>
<caption>
<title>Correlation-driven instability in nonlinear networks.</title>
<p>A) Threshold-quadratic input-rate transfer function. B,C) Raster plots of 6 second realizations of activity for weak and strong synaptic weights. Neurons 0–199 are excitatory and 200–240 are inhibitory. B) (<italic>W</italic><sub><italic>EE</italic></sub>, <italic>W</italic><sub><italic>EI</italic></sub>, <italic>W</italic><sub><italic>IE</italic></sub>, <italic>W</italic><sub><italic>II</italic></sub>) = (.025, −.1, .01, −.1) mV. C) (<italic>W</italic><sub><italic>EE</italic></sub>, <italic>W</italic><sub><italic>EI</italic></sub>, <italic>W</italic><sub><italic>IE</italic></sub>, <italic>W</italic><sub><italic>II</italic></sub>) = (1.5, −6, .6, −6) mV. D-F) Average firing rate of the excitatory neurons (D), integral of the auto-covariance function of the summed population spike train (E), and spectral radius of the stability matrix of mean field theory (F) vs. excitatory-excitatory synaptic weight. While excitatory-excitatory weight is plotted on the horizontal axis, all other synaptic weights increase proportionally with it. Black line: tree-level theory. Red line: one-loop correction accounting for impact of the next order (pairwise correlations’ influence on mean and triplet correlations’ influence on pairwise). Dots: simulation. All dots after the one-loop spectral radius crosses 1 represent results averaged over the time period before the activity diverges.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g015" xlink:type="simple"/>
</fig>
<p>Higher-order terms of the loop expansion described above (Nonlinearities impose bidirectional coupling between different orders of activity) provide corrections to mean field theory for both firing rates and spike train correlations. These corrections represent coupling of higher-order spike train cumulants to lower order cumulants. In the presence of an input-rate nonlinearity, for example, synchronous (correlated) presynaptic spike trains will more effectively drive postsynaptic activity [<xref ref-type="bibr" rid="pcbi.1005583.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref047">47</xref>]. This effect is described by the one-loop correction to the firing rates (<xref ref-type="fig" rid="pcbi.1005583.g009">Fig 9</xref>).</p>
<p>The one-loop correction for the mean field rate of neuron <italic>i</italic> in a network is given by the same diagram as the one-loop correction for the nonlinearly self-exciting process, <xref ref-type="fig" rid="pcbi.1005583.g009">Fig 9</xref>, but interpreted using the network Feynman rules (<xref ref-type="fig" rid="pcbi.1005583.g011">Fig 11</xref>). This yields:
<disp-formula id="pcbi.1005583.e100"><alternatives><graphic id="pcbi.1005583.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e100" xlink:type="simple"/><mml:math display="block" id="M100"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo> <mml:mi>l</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(52)</label></disp-formula>
where <italic>t</italic><sub>0</sub> is the initial time. This correction was, on average, positive (<xref ref-type="fig" rid="pcbi.1005583.g015">Fig 15d</xref> for excitatory neurons; also true for inhibitory neurons). Similarly to firing rates, the loop expansion provides corrections to higher-order spike train cumulants. The one-loop correction to the spike train covariances (<xref ref-type="disp-formula" rid="pcbi.1005583.e098">Eq 51</xref>, derived in <xref ref-type="fig" rid="pcbi.1005583.g013">Fig 13</xref>) accounts for the impact of triplet correlations (third joint spike train cumulants) on pairwise correlations and provided an improved prediction of the variance of the population spike train as synaptic weights increased (<xref ref-type="fig" rid="pcbi.1005583.g015">Fig 15e</xref>).</p>
<p>Since the one-loop correction to the firing rates could be large, we also asked whether it could impact the stability of the firing rates–that is, whether pairwise correlations could, through their influence on firing rates through the nonlinear transfer function, induce an instability. This is a question of when the eigenvalues of the propagator diverge—or equivalently, when the eigenvalues of the inverse propagator cross zero. The one-loop correction to the inverse propagator is given by the “proper vertex” obtained by amputating the outside propagator edges of the one-loop correction to the propagator; or equivalently, calculated from the Legendre transform of the cumulant-generating functional [<xref ref-type="bibr" rid="pcbi.1005583.ref039">39</xref>]. We can heuristically derive the one-loop stability correction as follows.</p>
<p>The full propagator, Δ, obeys the expansion
<disp-formula id="pcbi.1005583.e101"><alternatives><graphic id="pcbi.1005583.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e101" xlink:type="simple"/><mml:math display="block" id="M101"><mml:mrow><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mo>…</mml:mo></mml:mrow></mml:math></alternatives> <label>(53)</label></disp-formula>
where <inline-formula id="pcbi.1005583.e102"><alternatives><graphic id="pcbi.1005583.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the tree-level propagator, Δ<sub>1</sub> is the one-loop correction, two-loop corrections are collected in <bold>Δ</bold><sub>2</sub>, and so on (<xref ref-type="fig" rid="pcbi.1005583.g016">Fig 16a</xref>). Notice from the diagram (<xref ref-type="fig" rid="pcbi.1005583.g016">Fig 16a</xref>, second diagram on the right-hand side) that the one-loop correction to the propagator begins and ends with the tree-level propagator, <inline-formula id="pcbi.1005583.e103"><alternatives><graphic id="pcbi.1005583.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We will label the bubble in the middle of the diagram <bold>Γ</bold><sub>1</sub>. The first two-loop correction is a chain of loops (<xref ref-type="fig" rid="pcbi.1005583.g016">Fig 16a</xref>), and so can also be factored as <inline-formula id="pcbi.1005583.e104"><alternatives><graphic id="pcbi.1005583.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mrow><mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. We can represent this factorization diagrammatically by pulling out the tree-level propagator and the loop <bold>Γ</bold><sub>1</sub> (<xref ref-type="fig" rid="pcbi.1005583.g016">Fig 16b</xref>). Just as at two-loop order we were able to factor out a factor <inline-formula id="pcbi.1005583.e105"><alternatives><graphic id="pcbi.1005583.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mrow><mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and obtain the expansion of the propagator to one loop, continuing to higher-orders in the loop expansion of the full propagator would all the rest of the full propagator with factors of <inline-formula id="pcbi.1005583.e106"><alternatives><graphic id="pcbi.1005583.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> in front. The remaining terms would have factors starting with the two-loop correction, and so forth.</p>
<fig id="pcbi.1005583.g016" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g016</object-id>
<label>Fig 16</label>
<caption>
<title>Calculation of the one-loop stability correction.</title>
<p>A) Loop expansion of the full propagator. B) Factorization of the loop and resumming of the full propagator after that factorization.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g016" xlink:type="simple"/>
</fig>
<p>Pulling out all terms of <xref ref-type="disp-formula" rid="pcbi.1005583.e101">Eq 53</xref> that begin with <inline-formula id="pcbi.1005583.e107"><alternatives><graphic id="pcbi.1005583.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:mrow><mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and summing them allows us to write (<xref ref-type="fig" rid="pcbi.1005583.g016">Fig 16b</xref>):
<disp-formula id="pcbi.1005583.e108"><alternatives><graphic id="pcbi.1005583.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e108" xlink:type="simple"/><mml:math display="block" id="M108"><mml:mrow><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>+</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mspace width="0.277778em"/><mml:mtext>loops</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(54)</label></disp-formula>
We now truncate at one loop and operate on both sides with the inverse of the tree-level propagator:
<disp-formula id="pcbi.1005583.e109"><alternatives><graphic id="pcbi.1005583.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e109" xlink:type="simple"/><mml:math display="block" id="M109"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>0</mml:mn></mml:msub> <mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>≈</mml:mo> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>0</mml:mn></mml:msub> <mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>0</mml:mn></mml:msub> <mml:mover accent="true"><mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo mathvariant="bold">Δ</mml:mo></mml:mrow></mml:math></alternatives> <label>(55)</label></disp-formula>
<disp-formula id="pcbi.1005583.e110"><alternatives><graphic id="pcbi.1005583.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e110" xlink:type="simple"/><mml:math display="block" id="M110"><mml:mrow><mml:mo>=</mml:mo> <mml:mi mathvariant="bold">I</mml:mi> <mml:mi>δ</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo mathvariant="bold">Δ</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(56)</label></disp-formula>
revealing that −<bold>Γ</bold><sub>1</sub> is the one-loop correction to the inverse propagator. From the Feynman rules (<xref ref-type="fig" rid="pcbi.1005583.g011">Fig 11</xref>), that factor is:
<disp-formula id="pcbi.1005583.e111"><alternatives><graphic id="pcbi.1005583.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e111" xlink:type="simple"/><mml:math display="block" id="M111"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Γ</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mspace width="1pt"/><mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo> <mml:mi>l</mml:mi></mml:munder> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(57)</label></disp-formula>
where <inline-formula id="pcbi.1005583.e112"><alternatives><graphic id="pcbi.1005583.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> denotes the second derivative of the transfer function of neuron <italic>j</italic>, evaluated at its mean-field input (and similar for <inline-formula id="pcbi.1005583.e113"><alternatives><graphic id="pcbi.1005583.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>). The eigenvalues of this provide a correction to the stability analysis based on the tree-level propagator. This predicts that the firing rates should lose stability significantly before the bifurcation of the mean field theory (<xref ref-type="fig" rid="pcbi.1005583.g015">Fig 15f</xref>, red vs. black). Indeed, we saw in extended simulations that the spiking network could exhibit divergent activity even with synaptic weights that mean field theory predicted should be stable (<xref ref-type="fig" rid="pcbi.1005583.g001">Fig 1c</xref>). In summary, mean field theory can mis-predict the bifurcation of the rate of spiking models since it fails to capture the impact of correlations on firing rates through nonlinear transfer functions.</p>
</sec>
<sec id="sec012">
<title>2. Impact of connectivity structure on correlation-driven instabilities in nonlinear networks</title>
<p>Recent work has shown that cortical networks are more structured than simple Erdős-Rényi networks (e.g., [<xref ref-type="bibr" rid="pcbi.1005583.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref053">53</xref>]). One feature of cortical networks is a broad spread of neurons’ in- and out-degree distributions (i.e., the distributions of the number of synaptic inputs that each neuron receives or sends); another is broadly spread synaptic weights. These network properties, in turn, can have a strong impact on population activity [<xref ref-type="bibr" rid="pcbi.1005583.ref054">54</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref058">58</xref>]. Here, we illustrate the link between network structure and activity in the presence of nonlinear neural transfer. To generate structured networks, we began with the type of excitatory-inhibitory networks discussed in the previous section, but took the excitatory-excitatory coupling to have both heavy-tailed degree and weight distributions. Specifically, we took it to have truncated, correlated power law in- and out-degree distributions (Methods: non-Erdős-Rényi network model). We then took to the synaptic weights to be log-normally distributed [<xref ref-type="bibr" rid="pcbi.1005583.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref059">59</xref>]. For simplicity, we took the location and scale parameters of the weight distribution to be the same.</p>
<p>We then examined the network dynamics as the location and scale of the excitatory-excitatory synaptic weights increased. For each mean weight, we sampled the excitatory-excitatory weights from a lognormal distribution with that mean and variance. The excitatory-inhibitory, inhibitory-excitatory and inhibitory-inhibitory weights remained delta-distributed. Each such network specified a weight matrix <bold>W</bold>, which allowed the methods described previously for computing tree-level and one-loop rates, covariances and stability to be straightforwardly applied. For strong and broadly distributed synaptic weights (<xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17b</xref>), the network exhibited a similar correlation-induced instability as observed in the Erdős-Rényi network (<xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17c</xref>) even though mean field theory predicted that the firing rates should be stable (<xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17f</xref>, black vs. red curves). As synaptic weights increased from zero, the mean field theory for firing rates provided a misprediction (<xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17d</xref>, black line vs. dots) and the linear response prediction for the variance of the population spike train also broke down (<xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17e</xref>, black line vs. dots). The one-loop corrections, accounting for the impact of pairwise correlations on mean rates and of triplet correlations on pairwise correlations, yielded improved predictions (<xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17d and 17e</xref> red lines) and a much more accurate prediction for when firing rates would lose stability (<xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17c and 17f</xref>). These effects were similar to those seen in Erdős-Rényi networks (<xref ref-type="fig" rid="pcbi.1005583.g015">Fig 15</xref>), but the transition of the firing rates occurred sooner, both for the mean field (because of the effect of the weight and degree distributions on the eigenvalues of the weight matrix) and one-loop theories (because of the impact of the correlations on the firing rates).</p>
<fig id="pcbi.1005583.g017" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g017</object-id>
<label>Fig 17</label>
<caption>
<title>Correlation-driven instability in a non-Erdős-Rényi network with broadly distributed excitatory-excitatory weights.</title>
<p>A) Threshold-quadratic input-rate transfer function. B) Histogram of excitatory-excitatory synaptic weights with location parameter of 1.42 (mean of.29 mV), corresponding to the simulation in panel C. C) Raster plots of 6 second realizations of activity. Neurons 0–199 are excitatory and 200–240 are inhibitory. (<italic>W</italic><sub><italic>EE</italic></sub>, <italic>W</italic><sub><italic>EI</italic></sub>, <italic>W</italic><sub><italic>IE</italic></sub>, <italic>W</italic><sub><italic>II</italic></sub>) = (1.125, −4.5, .45, −4.5) mV. D-F) Average firing rate of the excitatory neurons (D), integral of the auto-covariance function of the summed population spike train (E), and spectral radius of the stability matrix of mean field theory (F) vs. excitatory-excitatory synaptic weight. While the mean excitatory-excitatory weight is plotted on the horizontal axis, all other synaptic weights increase proportionally with it. Black line: tree-level theory. Red line: one-loop correction. Dots: simulation. If a simulation exhibits divergent activity, the spike train statistics are averaged over the transient time before that divergence for visualization.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g017" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>3. Exponential single-neuron nonlinearities</title>
<p>In the previous section, we investigated how a non-Erdős-Rènyi network structure could amplify the one-loop corrections by increasing spike train correlations. We now examine a different single-neuron nonlinearity: <italic>ϕ</italic>(<italic>x</italic>) = <italic>αe</italic><sup><italic>x</italic></sup>, which is the canonical link function commonly used to fit GLM point process models to spiking data [<xref ref-type="bibr" rid="pcbi.1005583.ref026">26</xref>].</p>
<p>As before, we take the mean synaptic weight onto each neuron in the network to be 0. First, we take excitatory and inhibitory neurons to have the same baseline drive, λ<sub><italic>E</italic></sub> = λ<sub><italic>I</italic></sub> = −1.5. As we scale synaptic weights, we see that the one-loop correction is small compared to the tree-level theory for the firing rates, population variances and stability analysis (<xref ref-type="fig" rid="pcbi.1005583.g018">Fig 18a–18c</xref>, red vs. black lines). It nevertheless provides an improved correction for the variance of the excitatory population spike train (<xref ref-type="fig" rid="pcbi.1005583.g018">Fig 18b</xref>, between 1.5 and 2 mV synaptic weights). The bifurcation of the one-loop theory is close to the bifurcation of the mean field theory, and before that point the mean field theory and one-loop corrections both lose accuracy (<xref ref-type="fig" rid="pcbi.1005583.g018">Fig 18a and 18b</xref>). This makes sense: when the mean field theory fails, the only reason that the one-loop correction to the rates would be accurate is if all third- and higher-order spike train cumulants were small. Those higher-order correlations are not small near the instability.</p>
<fig id="pcbi.1005583.g018" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g018</object-id>
<label>Fig 18</label>
<caption>
<title>Stability of a network with exponential transfer functions.</title>
<p>A) Mean firing rate of the excitatory neurons. B) Integral of the auto-covariance function of the summed population spike train. C) Spectral radius of the stability matrix of mean field theory, all (A-C) vs. excitatory-excitatory synaptic weight. While the mean excitatory-excitatory weight is plotted on the horizontal axis, all other synaptic weights increase proportionally with it. Black line: tree-level theory. Red line: one-loop correction. Dots: simulation. If a simulation exhibits divergent activity, the spike train statistics are averaged over the transient time before that divergence for visualization.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g018" xlink:type="simple"/>
</fig>
<p>Next, we broke the symmetry between excitatory and inhibitory neurons in the network by giving inhibitory neurons a lower baseline drive (λ<sub><italic>I</italic></sub> = −2.). This shifted the bifurcation of the mean field theory and the one-loop correction to much higher synaptic weights (<xref ref-type="fig" rid="pcbi.1005583.g019">Fig 19c</xref>). For intermediate synaptic weights, we saw that the one-loop correction provided a better match to simulations than the tree-level theory (<xref ref-type="fig" rid="pcbi.1005583.g019">Fig 19a and 19b</xref>, between 1 and 1.5 mV synaptic weights). For stronger synapses, however, the simulations diverged strongly from the tree-level and one-loop predictions (<xref ref-type="fig" rid="pcbi.1005583.g019">Fig 19a and 19b</xref>, around 1.5 mV synaptic weights). In principle, we could continue to calculate additional loop corrections in an attempt to control this phenomenon. The exponential has arbitrary-order derivatives, however, preventing a perturbative expansion of the nonlinear terms—suggesting a renormalization approach [<xref ref-type="bibr" rid="pcbi.1005583.ref039">39</xref>], which is beyond the scope of this article. In sum, with an exponential transfer function, we saw that for intermediate synaptic weights, the one-loop correction improved on the tree-level theory. For strong enough synaptic weights, however, both failed to predict the simulations. How soon before the mean-field bifurcation this failure occurred depended on the specific model.</p>
<fig id="pcbi.1005583.g019" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g019</object-id>
<label>Fig 19</label>
<caption>
<title>Failure of one-loop corrections with exponential transfer functions.</title>
<p>A) Mean firing rate of the excitatory neurons. B) Integral of the auto-covariance function of the summed population spike train. C) Spectral radius of the stability matrix of mean field theory, all (A-C) vs. excitatory-excitatory synaptic weight. While the mean excitatory-excitatory weight is plotted on the horizontal axis, all other synaptic weights increase proportionally with it. Black line: tree-level theory. Red line: one-loop correction. Dots: simulation. If a simulation exhibits divergent activity, the spike train statistics are averaged over the transient time before that divergence for visualization.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g019" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>Joint spiking activity between groups of neurons can control population coding and controls the evolution of network structure through plasticity. Theories for predicting the joint statistics of activity in model networks have been locally linear so far. We present a systematic and diagrammatic fluctuation expansion (or, in reference to those diagrams, loop expansion) for spike-train cumulants, which relies on a stochastic field theory for networks of stochastically spiking neurons. It allows the computation of arbitrary order joint cumulant functions of spiking activity and dynamical response functions, which provide a window into the linear stability of the activity, as well as nonlinear corrections to all of those quantities.</p>
<p>Using this expansion, we investigated how nonlinear transfer can affect firing rates and fluctuations in population activity, imposing a dependence of rates on higher-order spiking cumulants. This coupling could significantly limit how strong synaptic interactions could become before firing rates lost stability.</p>
<sec id="sec015">
<title>Relationship to other theoretical methods</title>
<p>Dynamical mean field theory is a classic tool for analyzing the rate models with Gaussian-distributed synaptic weights, which reveals a transition to chaotic rate fluctuations with strong connectivity [<xref ref-type="bibr" rid="pcbi.1005583.ref060">60</xref>]. This proceeds, briefly, by taking the limit of large networks and replacing interactions through the quenched heterogeneity of the synaptic weights by an effective Gaussian process mimicking their statistics. Recent extensions have incorporated a number of simple biological constraints, including non-zero firing rates [<xref ref-type="bibr" rid="pcbi.1005583.ref061">61</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref063">63</xref>] and certain forms of cell type-specific connectivity [<xref ref-type="bibr" rid="pcbi.1005583.ref061">61</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref064">64</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref066">66</xref>]. In this framework, spiking is usually only described in the limit of slow synapses as additive noise in the rates, which can shift the transition to chaotic rate fluctuations to higher coupling strengths and smooth the dynamics near the transition [<xref ref-type="bibr" rid="pcbi.1005583.ref061">61</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref067">67</xref>].</p>
<p>An alternative approach is to start from the bottom up: to posit an inherently stochastic dynamics of single neurons and specify a finite-size network model, and from these derive a set of equations for statistics of the activity [<xref ref-type="bibr" rid="pcbi.1005583.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref069">69</xref>]. This approach provides a rigorous derivation of a finite-size rate model as the mean field theory of the underlying stochastic activity, as well as the opportunity to calculate higher-order activity statistics for the activity of a particular network [<xref ref-type="bibr" rid="pcbi.1005583.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref070">70</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref072">72</xref>]. This is the approach taken here with the popular and biologically motivated class of linear-nonlinear-Poisson models. A similar approach underlies linear response theory for computing spike train covariances [<xref ref-type="bibr" rid="pcbi.1005583.ref073">73</xref>], which corresponds to the tree level of the loop expansion presented here. For integrate-and-fire neuron models receiving Poisson inputs, Fokker-Planck theory for the membrane potential distributions can be used to calculate the linear response function of an isolated neuron [<xref ref-type="bibr" rid="pcbi.1005583.ref074">74</xref>], which together with the synaptic filter and weight matrix determines the propagator <bold>Δ</bold>.</p>
</sec>
<sec id="sec016">
<title>Convergence and truncation of the loop expansion</title>
<p>The loop expansion is organized by the dependence of lower-order activity cumulants to higher-order ones. The first-order (tree level) description of the <italic>n</italic>th activity cumulant does not depend on higher-order cumulants. One-loop corrections correspond to dependence of the order <italic>n</italic> cumulants on the tree-level <italic>n</italic> + 1-order cumulants, two-loop corrections correspond to dependence of the order <italic>n</italic> cumulant on the tree-level <italic>n</italic> + 1 and <italic>n</italic> + 2 order cumulants and so on. This coupling arises from the nonlinearity of the single-neuron transfer function <italic>ϕ</italic> (Results: Nonlinearities impose bidirectional coupling between different orders of activity: nonlinearly self-exciting process; Methods: Path integral representation). When the transfer function is linear at the mean-field rates, the tree-level theory provides an accurate description of activity (<xref ref-type="fig" rid="pcbi.1005583.g014">Fig 14</xref>). This corresponds to the second- and higher-order derivatives of the transfer function <italic>ϕ</italic> with respect to the total input, evaluated at the mean-field rates, being zero. When <italic>ϕ</italic> has non-zero second- or higher derivatives at the mean-field rates, higher orders of the loop expansion can be important. The magnitude of <italic>n</italic>-loop corrections depends on two things: the magnitude of the <italic>n</italic> + 1-order tree-level activity cumulants and the magnitude of the <italic>n</italic> + 1st derivative of <italic>ϕ</italic> at the mean-field rates (i.e., the strength of the coupling to that cumulant).</p>
<p>Recent work has shown that the the magnitude of spike train correlations depend on the motif structure of the network (<xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17</xref>; [<xref ref-type="bibr" rid="pcbi.1005583.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref075">75</xref>]), as well as on the correlation structure of the inputs it receives. For a particular model network of interest, the accuracy of a truncated loop expansion can be evaluated empirically by comparing against simulations. Computing higher-order loop corrections can quickly become unwieldy. The ratio of the <italic>n</italic>-loop correction to a particular spike train cumulant to the <italic>n</italic> + 1 loop correction can provide an estimate (but not a guarantee) of whether truncating at <italic>n</italic> loops is sufficient. If the loop contributions scale with a small parameter such as the inverse system size, this provides a natural justification for truncation. This can occur if the tree-level cumulants scale with 1/<italic>N</italic>, which happens if synaptic weights scale as 1/<italic>N</italic> [<xref ref-type="bibr" rid="pcbi.1005583.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref071">71</xref>], or (in the thermodynamic limit) if connections are strong but sparse [<xref ref-type="bibr" rid="pcbi.1005583.ref076">76</xref>], or if strong, dense, balanced excitation and inhibition actively cancel correlations [<xref ref-type="bibr" rid="pcbi.1005583.ref077">77</xref>]. Finally, if the system lies close to a bifurcation of the mean field theory so that the eigenvalues of the propagator diverge, then the mean field theory and this expansion around it can also fail. In that case, renormalization arguments can allow the discussion of the scaling behavior of correlations [<xref ref-type="bibr" rid="pcbi.1005583.ref040">40</xref>].</p>
</sec>
<sec id="sec017">
<title>Dynamics and stability in spiking networks</title>
<sec id="sec018">
<title>Fluctuations in large spiking networks</title>
<p>Networks of excitatory and inhibitory neurons with instantaneous synapses have been shown, depending on their connectivity strengths and external drive, to exhibit a variety of dynamics, including the “classical” asynchronous state, oscillatory population activity and strong, uncorrelated rate fluctuations [<xref ref-type="bibr" rid="pcbi.1005583.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref078">78</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref079">79</xref>]. The classical asynchronous state and oscillatory regimes exist in the presence of Poisson-like single-neuron activity, either due to external white noise or to internally generated high-dimensional chaotic fluctuations [<xref ref-type="bibr" rid="pcbi.1005583.ref077">77</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref080">80</xref>]. Transitions between these modes correspond to bifurcations in which a given state loses stability. The present results allow one to compute these transition points with greater accuracy, by explicitly computing correlations of arbitrary order and, crucially, how these correlations “feed back” to impact firing rates and the stability of states with different rates.</p>
</sec>
<sec id="sec019">
<title>Inhibitory-stabilized and supralinear-stabilized networks</title>
<p>Beyond the overall stability of network states, an important general question is how firing rates depend on inputs in recurrent neural networks. “Inhibitory-stabilized” networks can have surprising dependencies on inputs, with rates trending in opposite directions from what one would at first expect [<xref ref-type="bibr" rid="pcbi.1005583.ref034">34</xref>]. Supra-linear input-rate transfer in inhibitory-stabilized networks can explain a variety of physiological observations [<xref ref-type="bibr" rid="pcbi.1005583.ref081">81</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref083">83</xref>]. Our results are therefore useful in predicting how correlations emerge and couple to firing rates in these networks. The impact of cell type-specific dynamics on dynamics and coding remains to be fully elucidated [<xref ref-type="bibr" rid="pcbi.1005583.ref084">84</xref>].</p>
</sec>
<sec id="sec020">
<title>A new potential impact of correlations on population coding</title>
<p>Many studies have examined the impact of “noise correlations” on population coding, examining the vector of neural responses. If all responses are conditionally independent given the stimulus, the distribution of responses to a particular stimulus is spherical. The discriminability of the responses to two stimuli corresponds to the area of overlap of those multi-neuron response distributions. To tree level in the loop expansion of the population responses, correlations stretch that response distribution. These correlations can either improve or lower coding performance, depending on how they relate to the stimulus-evoked responses [<xref ref-type="bibr" rid="pcbi.1005583.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005583.ref085">85</xref>]. In the presence of a nonlinear transfer function, a further potential impact of correlations is to change neurons’ mean activities (<xref ref-type="fig" rid="pcbi.1005583.g015">Fig 15</xref>. This corresponds to a translation of the multi-neuron response distributions (<xref ref-type="fig" rid="pcbi.1005583.g020">Fig 20</xref>, bottom), which could, in principle, either increase or decrease their discriminability (<xref ref-type="fig" rid="pcbi.1005583.g020">Fig 20</xref>, bottom).</p>
<fig id="pcbi.1005583.g020" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.g020</object-id>
<label>Fig 20</label>
<caption>
<title>Potential impacts of correlations on coding in a presence of a nonlinearity.</title>
<p>A) The independent Poisson assumption for neurons gives rise to uncorrelated distributions of population activity. B) Correlations could increase or decrease the overlap of those distributions by stretching them, decreasing or increasing the decoding performance (top and bottom, respectively). C) The impact of correlations on the mean responses can shift those distributions, potentially counteracting the impact of stretching the distributions (as shown), or exaggerating it.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.g020" xlink:type="simple"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec021" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec022">
<title>Non-Erdős-Rényi network model</title>
<p>For <xref ref-type="fig" rid="pcbi.1005583.g017">Fig 17</xref>, we generated the excitatory-excitatory connectivity with a truncated power-law degree distribution. The marginal distributions of the number of excitatory-excitatory synaptic inputs (in-degree) or outputs (out-degree) obeyed:
<disp-formula id="pcbi.1005583.e114"><alternatives><graphic id="pcbi.1005583.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e114" xlink:type="simple"/><mml:math display="block" id="M114"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msup><mml:mi>d</mml:mi> <mml:msub><mml:mi>γ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>d</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msup><mml:mi>d</mml:mi> <mml:msub><mml:mi>γ</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>d</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mspace width="4.pt"/><mml:mtext>else</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives> <label>(58)</label></disp-formula>
where <italic>d</italic> is the in- or out-degree. Parameter values are contained in <xref ref-type="table" rid="pcbi.1005583.t001">Table 1</xref>; <italic>C</italic><sub>1</sub> and <italic>C</italic><sub>2</sub> are normalization constants to make the degree distribution continuous at the cutoff <italic>L</italic><sub>1</sub>. The in- and out-degree distributions were then coupled by a Gaussian copula with correlation coefficient <italic>ρ</italic> to generate in- and out-degree lists. These lists generated likelihoods for each possible connection proportional to the in-degree of the postsynaptic neuron and the out-degree of the presynaptic neuron. We then sampled the excitatory-excitatory connectivity according to those likelihoods.</p>
<table-wrap id="pcbi.1005583.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005583.t001</object-id>
<label>Table 1</label>
<caption>
<title>Model parameters (unless otherwise specified in text).</title>
</caption>
<alternatives>
<graphic id="pcbi.1005583.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005583.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="center">Description</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>ϕ</italic>(<italic>x</italic>)</td>
<td align="center">Single-neuron transfer function</td>
<td align="right"><italic>α</italic>⌊<italic>x</italic>⌋<sup><italic>p</italic></sup></td>
</tr>
<tr>
<td align="left"><italic>α</italic></td>
<td align="center">Gain of single neuron transfer</td>
<td align="right">.1 ms<sup>−1</sup>mV<sup>−<italic>p</italic></sup></td>
</tr>
<tr>
<td align="left">λ(<italic>t</italic>)</td>
<td align="center">Baseline drive</td>
<td align="right">.1 mV</td>
</tr>
<tr>
<td align="left"><italic>N</italic><sub><italic>E</italic></sub></td>
<td align="center">Number of excitatory neurons</td>
<td align="right">200</td>
</tr>
<tr>
<td align="left"><italic>N</italic><sub><italic>I</italic></sub></td>
<td align="center">Number of inhibitory neurons</td>
<td align="right">40</td>
</tr>
<tr>
<td align="left"><italic>p</italic><sub><italic>EE</italic></sub></td>
<td align="center">Excitatory-excitatory connection probability</td>
<td align="right">0.2</td>
</tr>
<tr>
<td align="left"><italic>p</italic><sub><italic>EI</italic></sub></td>
<td align="center">Inhibitory-excitatory connection probability</td>
<td align="right">0.5</td>
</tr>
<tr>
<td align="left"><italic>p</italic><sub><italic>IE</italic></sub></td>
<td align="center">Excitatory-excitatory connection probability</td>
<td align="right">0.5</td>
</tr>
<tr>
<td align="left"><italic>p</italic><sub><italic>II</italic></sub></td>
<td align="center">Excitatory-excitatory connection probability</td>
<td align="right">0.5</td>
</tr>
<tr>
<td align="left"><italic>τ</italic></td>
<td align="center">Time constant for postsynaptic potentials</td>
<td align="right">10 ms</td>
</tr>
<tr>
<td align="left"><italic>g</italic>(<italic>t</italic>)</td>
<td align="center">Shape of postsynaptic potentatials</td>
<td align="right">(<italic>t</italic>/<italic>τ</italic><sup>2</sup>) exp (−<italic>t</italic>/<italic>τ</italic>)</td>
</tr>
<tr>
<td align="left"><italic>L</italic><sub>1</sub></td>
<td align="center">Left cutoff for power-law degree distribution</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left"><italic>L</italic><sub>2</sub></td>
<td align="center">Right cutoff for power-law degree distribution</td>
<td align="right"><italic>N</italic><sub><italic>E</italic></sub></td>
</tr>
<tr>
<td align="left"><italic>γ</italic><sub>1</sub></td>
<td align="center">Rising exponent for power-law degree distribution</td>
<td align="right">.8</td>
</tr>
<tr>
<td align="left"><italic>γ</italic><sub>2</sub></td>
<td align="center">Falling exponent for power-law degree distribution</td>
<td align="right">-1.5</td>
</tr>
<tr>
<td align="left"><italic>ρ</italic></td>
<td align="center">Correlation of Gaussian copula for degree distributions</td>
<td align="right">.8</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec023">
<title>Path integral representation</title>
<p>Here we outline the derivation of a path integral formalism for a network of processes with nonlinear input-rate transfer, following methods developed in nonequilibrium statistical mechanics [<xref ref-type="bibr" rid="pcbi.1005583.ref086">86</xref>–<xref ref-type="bibr" rid="pcbi.1005583.ref091">91</xref>]. We will begin by developing the formalism for a simple model, where a spike train is generated stochastically with intensity given by some input <italic>ν</italic>(<italic>t</italic>). We will specify the cumulant generating functional of the spike train given <italic>ν</italic>(<italic>t</italic>) below.</p>
<p>The general strategy is to introduce an auxiliary variable, called the “response variable,” whose dynamics will determine how information from a given configuration (e.g. the spike counts <italic>n</italic>(<italic>t</italic>)) at one time will effect future configurations of the dynamics. Introducing the response variable allows us to write the probability density functional for the process in an exponential form. The integrand of that exponential is called the “action” for the model, which can then be split into a “free” action (the piece bilinear in the configuration and response variables) and an “interacting” one (the remainder). Cumulants of the process can then be computed, in brief, by taking expectations of the configuration and response variables and the interacting action against the probability distribution given by the free action.</p>
<p>Let <italic>n</italic>(<italic>t</italic>) be the number of spike events recorded since some fiducial time <italic>t</italic><sub>0</sub>. In a time bin <italic>dt</italic>, Δ<italic>n</italic> events are generated with some distribution <italic>p</italic>(Δ<italic>n</italic>) and added to <italic>n</italic>(<italic>t</italic>). Let the events generated in any two time bins be conditionally independent given some inhomogeneous rate <italic>ν</italic>(<italic>t</italic>), so that <italic>p</italic>(Δ<italic>n</italic>) = <italic>p</italic>(Δ<italic>n</italic>|<italic>ν</italic>). So, assuming that initially <italic>n</italic>(<italic>t</italic><sub>0</sub>) = 0, the probability density functional of the vector of events over <italic>M</italic> time bins is:
<disp-formula id="pcbi.1005583.e115"><alternatives><graphic id="pcbi.1005583.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e115" xlink:type="simple"/><mml:math display="block" id="M115"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>:</mml:mo> <mml:mi>s</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:mfrac> <mml:mspace width="0.277778em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:mfrac> <mml:mspace width="0.277778em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(59)</label></disp-formula>
where <inline-formula id="pcbi.1005583.e116"><alternatives><graphic id="pcbi.1005583.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the Laplace transform of <italic>p</italic>(Δ<italic>n</italic><sub><italic>i</italic></sub>|<italic>ν</italic><sub><italic>i</italic></sub>) and <inline-formula id="pcbi.1005583.e117"><alternatives><graphic id="pcbi.1005583.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the cumulant generating functional for the auxiliary variable. In the third step we have written the distribution of <italic>p</italic>(Δ<italic>n</italic><sub><italic>i</italic></sub>) as the inverse Laplace transform of the Laplace transform. The Laplace transform variable <inline-formula id="pcbi.1005583.e118"><alternatives><graphic id="pcbi.1005583.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is our auxiliary response variable. In the fourth step we identified the Laplace transform of the probability density functional as the moment-generating functional, so that <inline-formula id="pcbi.1005583.e119"><alternatives><graphic id="pcbi.1005583.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the cumulant generating functional of the spike count. Note that these are complex integrals. The contour for the integration over <inline-formula id="pcbi.1005583.e120"><alternatives><graphic id="pcbi.1005583.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is parallel to the imaginary axis.</p>
<p>Taking the continuum limit <italic>M</italic> → ∞, <italic>dt</italic> → 0 then yields the probability density functional of the spike train process <inline-formula id="pcbi.1005583.e121"><alternatives><graphic id="pcbi.1005583.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1005583.e122"><alternatives><graphic id="pcbi.1005583.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e122" xlink:type="simple"/><mml:math display="block" id="M122"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.166667em"/><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(60)</label></disp-formula>
where <inline-formula id="pcbi.1005583.e123"><alternatives><graphic id="pcbi.1005583.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mrow><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005583.e124"><alternatives><graphic id="pcbi.1005583.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> and we suppress the conditional dependence of <inline-formula id="pcbi.1005583.e125"><alternatives><graphic id="pcbi.1005583.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> on <italic>ν</italic>(<italic>t</italic>). In the continuum limit the integral is a functional or path integral over realizations of <inline-formula id="pcbi.1005583.e126"><alternatives><graphic id="pcbi.1005583.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We will call the negative exponent of the integrand in <xref ref-type="disp-formula" rid="pcbi.1005583.e122">Eq 60</xref> the action:
<disp-formula id="pcbi.1005583.e127"><alternatives><graphic id="pcbi.1005583.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e127" xlink:type="simple"/><mml:math display="block" id="M127"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(61)</label></disp-formula>
We have slightly abused notation here in that a factor of 1/<italic>dt</italic> has been absorbed into <inline-formula id="pcbi.1005583.e128"><alternatives><graphic id="pcbi.1005583.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We will justify this below.</p>
<p>We have not yet specified the conditional distribution of the events given the input <italic>ν</italic>(<italic>t</italic>), leaving <inline-formula id="pcbi.1005583.e129"><alternatives><graphic id="pcbi.1005583.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> unspecified. Here, we will take the events to be conditionally Poisson [<xref ref-type="bibr" rid="pcbi.1005583.ref092">92</xref>], so that
<disp-formula id="pcbi.1005583.e130"><alternatives><graphic id="pcbi.1005583.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e130" xlink:type="simple"/><mml:math display="block" id="M130"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>ν</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(62)</label></disp-formula>
(In the continuum limit, the rate <italic>ν</italic>(<italic>t</italic>) allowed us to absorb the factor of 1/<italic>dt</italic> into <italic>W</italic>. A finite size time bin would produce <italic>ν</italic>(<italic>t</italic>)<italic>dt</italic> events in bin <italic>dt</italic>.)</p>
<p>This representation of the probability density functional yields the joint moment-generating functional (MGF) of <inline-formula id="pcbi.1005583.e131"><alternatives><graphic id="pcbi.1005583.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005583.e132"><alternatives><graphic id="pcbi.1005583.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1005583.e133"><alternatives><graphic id="pcbi.1005583.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e133" xlink:type="simple"/><mml:math display="block" id="M133"><mml:mrow><mml:mi>Z</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>J</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>J</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(63)</label></disp-formula>
and the moment-generating functional of <inline-formula id="pcbi.1005583.e134"><alternatives><graphic id="pcbi.1005583.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e134" xlink:type="simple"/><mml:math display="inline" id="M134"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1005583.e135"><alternatives><graphic id="pcbi.1005583.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e135" xlink:type="simple"/><mml:math display="block" id="M135"><mml:mrow><mml:mi>Z</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(64)</label></disp-formula></p>
<p>The above strictly applies only to the inhomogeneous Poisson process. This formalism is adapted to the self-exciting process by introducing conditional dependence of the rate <italic>ν</italic>(<italic>t</italic>) on the <italic>previous</italic> spiking history. In the discrete case, before taking the limit <italic>M</italic> → ∞, we say that the rate <italic>ν</italic><sub><italic>i</italic></sub> = <italic>ϕ</italic>[<italic>n</italic><sub><italic>i</italic>−</sub>], where <italic>ϕ</italic> is some positive function and <italic>n</italic><sub><italic>i</italic>−</sub> indicates all spiking activity up to but not including bin <italic>i</italic>. This requirement is equivalent to an Ito interpretation for the measure on the stochastic process <inline-formula id="pcbi.1005583.e136"><alternatives><graphic id="pcbi.1005583.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Because of this assumption, the previous derivation holds and we can write
<disp-formula id="pcbi.1005583.e137"><alternatives><graphic id="pcbi.1005583.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e137" xlink:type="simple"/><mml:math display="block" id="M137"><mml:mrow><mml:mi>W</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(65)</label></disp-formula>
where <inline-formula id="pcbi.1005583.e138"><alternatives><graphic id="pcbi.1005583.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mo>:</mml:mo> <mml:mspace width="1pt"/><mml:mi>s</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. In the continuum limit, there is an ambiguity introduced by the appearance of the time variable <italic>t</italic> in both <inline-formula id="pcbi.1005583.e139"><alternatives><graphic id="pcbi.1005583.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e139" xlink:type="simple"/><mml:math display="inline" id="M139"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005583.e140"><alternatives><graphic id="pcbi.1005583.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e140" xlink:type="simple"/><mml:math display="inline" id="M140"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This is resolved in the definition of the measure for the functional integral and affects the definition of the linear response (below). Again, this is a manifestation of the Ito assumption for our process.</p>
<p>The specific model used in this paper assumes a particular form for the argument of <italic>ϕ</italic>. We assume that the input is given by
<disp-formula id="pcbi.1005583.e141"><alternatives><graphic id="pcbi.1005583.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e141" xlink:type="simple"/><mml:math display="block" id="M141"><mml:mrow><mml:mi>ν</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(66)</label></disp-formula>
where <italic>g</italic>(<italic>t</italic>) is a filter that defines the dynamics of the process in question and λ(<italic>t</italic>) is an inhomogeneous rate function. The result is that the action for nonlinearly self-exciting process is given by
<disp-formula id="pcbi.1005583.e142"><alternatives><graphic id="pcbi.1005583.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e142" xlink:type="simple"/><mml:math display="block" id="M142"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mi>ϕ</mml:mi> <mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(67)</label></disp-formula></p>
<p>The only extension required to move from the above action to the network model is to introduce indices labelling the neurons and couplings specific for each neuron pair. Nothing of substance is altered in the above derivation and we are left with
<disp-formula id="pcbi.1005583.e143"><alternatives><graphic id="pcbi.1005583.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e143" xlink:type="simple"/><mml:math display="block" id="M143"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.277778em"/><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn><mml:mo>)</mml:mo> <mml:mspace width="1pt"/><mml:mi>ϕ</mml:mi> <mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(68)</label></disp-formula></p>
<sec id="sec024">
<title>Mean field expansion and derivation of Feynman rules</title>
<p>We could use the above action in order to derive Feynman rules for these processes. The expansions so described would be equivalent to our initial expansions before re-summing (the sets of diagrams that use dashed lines). These would describe an expansion about <inline-formula id="pcbi.1005583.e144"><alternatives><graphic id="pcbi.1005583.e144g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e144" xlink:type="simple"/><mml:math display="inline" id="M144"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. We can arrive at this expansion by separating the action into two pieces, called the “free” action and the “interacting” action: <inline-formula id="pcbi.1005583.e145"><alternatives><graphic id="pcbi.1005583.e145g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e145" xlink:type="simple"/><mml:math display="inline" id="M145"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The free action, <inline-formula id="pcbi.1005583.e146"><alternatives><graphic id="pcbi.1005583.e146g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e146" xlink:type="simple"/><mml:math display="inline" id="M146"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is defined by the bilinear component of <inline-formula id="pcbi.1005583.e147"><alternatives><graphic id="pcbi.1005583.e147g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e147" xlink:type="simple"/><mml:math display="inline" id="M147"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in an expansion around 0, i.e.,
<disp-formula id="pcbi.1005583.e148"><alternatives><graphic id="pcbi.1005583.e148g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e148" xlink:type="simple"/><mml:math display="block" id="M148"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(69)</label></disp-formula>
for some operator <italic>K</italic><sub><italic>ij</italic></sub>(<italic>t</italic>, <italic>t</italic>′). Define
<disp-formula id="pcbi.1005583.e149"><alternatives><graphic id="pcbi.1005583.e149g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e149" xlink:type="simple"/><mml:math display="block" id="M149"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(70)</label></disp-formula>
Taking the expectation with respect to the probability density given by the free action yields
<disp-formula id="pcbi.1005583.e150"><alternatives><graphic id="pcbi.1005583.e150g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e150" xlink:type="simple"/><mml:math display="block" id="M150"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(71)</label></disp-formula>
so that <italic>K</italic> is the operator inverse of Δ under the free action. That expectation can be computed via the moment-generating functional for the free action (which we denote <inline-formula id="pcbi.1005583.e151"><alternatives><graphic id="pcbi.1005583.e151g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e151" xlink:type="simple"/><mml:math display="inline" id="M151"><mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mi>J</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>), and then completing the square in order to compute the integral. This leaves
<disp-formula id="pcbi.1005583.e152"><alternatives><graphic id="pcbi.1005583.e152g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e152" xlink:type="simple"/><mml:math display="block" id="M152"><mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>J</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="1pt"/><mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>J</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(72)</label></disp-formula>
which implies that <inline-formula id="pcbi.1005583.e153"><alternatives><graphic id="pcbi.1005583.e153g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e153" xlink:type="simple"/><mml:math display="inline" id="M153"><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We have used the fact that <inline-formula id="pcbi.1005583.e154"><alternatives><graphic id="pcbi.1005583.e154g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e154" xlink:type="simple"/><mml:math display="inline" id="M154"><mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>J</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mi>J</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Computing moments requires functional integrals of the form
<disp-formula id="pcbi.1005583.e155"><alternatives><graphic id="pcbi.1005583.e155g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e155" xlink:type="simple"/><mml:math display="block" id="M155"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:munder><mml:mo>∏</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:mspace width="0.277778em"/><mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/><mml:munder><mml:mo>∏</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mspace width="1pt"/><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>S</mml:mi> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(73)</label></disp-formula>
We Taylor expand each neuron’s nonlinearity <italic>ϕ</italic> (around its λ<sub><italic>i</italic></sub>(<italic>t</italic>)) and expand the exponential arising from the cumulant generating functional of the spike counts (that in <inline-formula id="pcbi.1005583.e156"><alternatives><graphic id="pcbi.1005583.e156g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e156" xlink:type="simple"/><mml:math display="inline" id="M156"><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>) around zero. We then collect the terms with one power of <inline-formula id="pcbi.1005583.e157"><alternatives><graphic id="pcbi.1005583.e157g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e157" xlink:type="simple"/><mml:math display="inline" id="M157"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and of <inline-formula id="pcbi.1005583.e158"><alternatives><graphic id="pcbi.1005583.e158g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e158" xlink:type="simple"/><mml:math display="inline" id="M158"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the free action. This leaves the interacting action <inline-formula id="pcbi.1005583.e159"><alternatives><graphic id="pcbi.1005583.e159g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e159" xlink:type="simple"/><mml:math display="inline" id="M159"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> as:
<disp-formula id="pcbi.1005583.e160"><alternatives><graphic id="pcbi.1005583.e160g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e160" xlink:type="simple"/><mml:math display="block" id="M160"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:munder><mml:mo>∫</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>\</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi>∞</mml:mi></mml:munderover><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>g</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>q</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(74)</label></disp-formula>
Note that at each term in this expansion, each of the <italic>p</italic> factors of <inline-formula id="pcbi.1005583.e161"><alternatives><graphic id="pcbi.1005583.e161g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e161" xlink:type="simple"/><mml:math display="inline" id="M161"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and the <italic>q</italic> factors of <inline-formula id="pcbi.1005583.e162"><alternatives><graphic id="pcbi.1005583.e162g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e162" xlink:type="simple"/><mml:math display="inline" id="M162"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="bold">g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> carries its own time variable, all of which are integrated over; we have suppressed these time variables and their integrals. Now the action can be written as:
<disp-formula id="pcbi.1005583.e163"><alternatives><graphic id="pcbi.1005583.e163g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e163" xlink:type="simple"/><mml:math display="block" id="M163"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>\</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi>∞</mml:mi></mml:munderover><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>g</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>q</mml:mi></mml:msup></mml:mrow></mml:math></alternatives> <label>(75)</label></disp-formula>
where we have suppressed the sums over neuron indices and all time integrals. We have defined the “vertex factor” <inline-formula id="pcbi.1005583.e164"><alternatives><graphic id="pcbi.1005583.e164g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e164" xlink:type="simple"/><mml:math display="inline" id="M164"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>q</mml:mi></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>q</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:mi>q</mml:mi> <mml:mo>!</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (the index <italic>p</italic> recalls which power of <inline-formula id="pcbi.1005583.e165"><alternatives><graphic id="pcbi.1005583.e165g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e165" xlink:type="simple"/><mml:math display="inline" id="M165"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> it arrived with). Note that we have defined vertex factors with a minus sign relative to <inline-formula id="pcbi.1005583.e166"><alternatives><graphic id="pcbi.1005583.e166g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e166" xlink:type="simple"/><mml:math display="inline" id="M166"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Introducing the shorthand <inline-formula id="pcbi.1005583.e167"><alternatives><graphic id="pcbi.1005583.e167g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e167" xlink:type="simple"/><mml:math display="inline" id="M167"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="bold">g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and then again suppressing neuron indices, we write the moment in <xref ref-type="disp-formula" rid="pcbi.1005583.e155">Eq 73</xref> as:
<disp-formula id="pcbi.1005583.e168"><alternatives><graphic id="pcbi.1005583.e168g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e168" xlink:type="simple"/><mml:math display="block" id="M168"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msup> <mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>q</mml:mi></mml:msup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mspace width="0.277778em"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mspace width="0.277778em"/><mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msup> <mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>q</mml:mi></mml:msup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="script">D</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mspace width="0.277778em"/><mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msup> <mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>q</mml:mi></mml:msup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>K</mml:mi> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>!</mml:mo></mml:mrow></mml:mfrac> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>*</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(76)</label></disp-formula>
<disp-formula id="pcbi.1005583.e169"><alternatives><graphic id="pcbi.1005583.e169g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e169" xlink:type="simple"/><mml:math display="block" id="M169"><mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="script">D</mml:mi><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi mathvariant="script">D</mml:mi><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>q</mml:mi></mml:msup><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>\</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi>∞</mml:mi></mml:munderover><mml:mtext> </mml:mtext><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>l</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>p</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>*</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>q</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msup><mml:mtext> </mml:mtext><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>K</mml:mi><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(77)</label></disp-formula>
<disp-formula id="pcbi.1005583.e170"><alternatives><graphic id="pcbi.1005583.e170g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e170" xlink:type="simple"/><mml:math display="block" id="M170"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>q</mml:mi></mml:msup><mml:mtext> </mml:mtext><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>\</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mi>∞</mml:mi></mml:munderover><mml:mtext> </mml:mtext><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>l</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>p</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>p</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>*</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>q</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msup></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives> <label>(78)</label></disp-formula>
where we denote the expectation with respect to the free action <inline-formula id="pcbi.1005583.e171"><alternatives><graphic id="pcbi.1005583.e171g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e171" xlink:type="simple"/><mml:math display="inline" id="M171"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> by 〈〉<sub>0</sub>. Expectations with respect to the free action are determined by its generating functional, <xref ref-type="disp-formula" rid="pcbi.1005583.e152">Eq 72</xref>. Due to Wick’s theorem, any moment will decompose into products of expectation values <inline-formula id="pcbi.1005583.e172"><alternatives><graphic id="pcbi.1005583.e172g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e172" xlink:type="simple"/><mml:math display="inline" id="M172"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, according to all possible ways of partitioning the operators into <inline-formula id="pcbi.1005583.e173"><alternatives><graphic id="pcbi.1005583.e173g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e173" xlink:type="simple"/><mml:math display="inline" id="M173"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> pairs, i.e.,
<disp-formula id="pcbi.1005583.e174"><alternatives><graphic id="pcbi.1005583.e174g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e174" xlink:type="simple"/><mml:math display="block" id="M174"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>q</mml:mi></mml:msup></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mtext>pair</mml:mtext><mml:mo>−</mml:mo><mml:mtext>wise</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>partitions</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mtext> </mml:mtext><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mtext>pairs</mml:mtext></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:msub><mml:mo>Δ</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(79)</label></disp-formula>
where the indices <italic>i</italic>, <italic>j</italic>, <italic>t</italic>, <italic>t</italic>′ are determined by the partitioning. For the terms in the expansion (<xref ref-type="disp-formula" rid="pcbi.1005583.e170">Eq 78</xref>), each term will be decomposed into a sum over ways in which factors of <inline-formula id="pcbi.1005583.e175"><alternatives><graphic id="pcbi.1005583.e175g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e175" xlink:type="simple"/><mml:math display="inline" id="M175"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> can be paired with factors of <inline-formula id="pcbi.1005583.e176"><alternatives><graphic id="pcbi.1005583.e176g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e176" xlink:type="simple"/><mml:math display="inline" id="M176"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005583.ref093">93</xref>].</p>
<p>We can represent each term in this sum diagrammatically by associating each of the <italic>p</italic> factors of <inline-formula id="pcbi.1005583.e177"><alternatives><graphic id="pcbi.1005583.e177g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e177" xlink:type="simple"/><mml:math display="inline" id="M177"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <italic>q</italic> factors of <inline-formula id="pcbi.1005583.e178"><alternatives><graphic id="pcbi.1005583.e178g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e178" xlink:type="simple"/><mml:math display="inline" id="M178"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> from the moment with external vertices with a single outgoing or exiting line, respectively. Each vertex factor <italic>V</italic><sub><italic>pq</italic></sub> gets a vertex with <italic>p</italic> lines exiting to the left (towards the future) and <italic>q</italic> wavy lines entering from the right (from the past). The partitions of pairing <inline-formula id="pcbi.1005583.e179"><alternatives><graphic id="pcbi.1005583.e179g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e179" xlink:type="simple"/><mml:math display="inline" id="M179"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005583.e180"><alternatives><graphic id="pcbi.1005583.e180g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e180" xlink:type="simple"/><mml:math display="inline" id="M180"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are determined by connecting outgoing lines to incoming lines. The terms in the expansion with <italic>l</italic> powers of a vertex factor will also appear <italic>l</italic>! times in the partitioning. As such, the sum over partitions will result in the cancellation of the factor of <italic>l</italic>! for vertex factor <italic>V</italic><sub><italic>pq</italic></sub>. All such terms from a vertex factor <italic>V</italic><sub><italic>pq</italic></sub> with <italic>p</italic> outgoing lines will generate <italic>p</italic>! copies of the same term, which will cancel the factor of <italic>p</italic>!, justifying our definition. Each vertex factor also carries a sum over neuron indices <italic>i</italic> and an integral over internal time variable, which must be performed to compute the moment; these are the sums and integrals we suppressed in <xref ref-type="disp-formula" rid="pcbi.1005583.e163">Eq 75</xref>.</p>
<p>Thus, in order to compute the terms in the expansion for a moment 1) each factor of <inline-formula id="pcbi.1005583.e181"><alternatives><graphic id="pcbi.1005583.e181g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e181" xlink:type="simple"/><mml:math display="inline" id="M181"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1005583.e182"><alternatives><graphic id="pcbi.1005583.e182g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e182" xlink:type="simple"/><mml:math display="inline" id="M182"><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> gets an external vertex, 2) every graph is formed using the vertices associated with the vertex factors <italic>V</italic><sub><italic>nm</italic></sub> by constructing the available partitions with all possible vertices, 3) for each vertex, contribute a factor of <italic>V</italic><sub><italic>nm</italic></sub>, 4) for each line contribute a factor of Δ<sub><italic>ij</italic></sub>, 5) contribute an operation <italic>g</italic>* for each wavy line (operating on the term associated with the attached incoming line) and finally 6) all integrals and sums are performed. Note that some of these terms will produce disconnected graphs. These correspond to factorizable terms in the moment.</p>
<p>The rules derived using the action above will produce the initial expansions that we demonstrated about the <italic>n</italic> = 0 configuration. The re-summed rules that we present in the Results arise from first performing a slight change of variables in the integrand. Instead of considering the fluctuations about <italic>n</italic>(<italic>t</italic>) = 0, we shift the configuration and response variables by their mean field solutions. Defining <inline-formula id="pcbi.1005583.e183"><alternatives><graphic id="pcbi.1005583.e183g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e183" xlink:type="simple"/><mml:math display="inline" id="M183"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005583.e184"><alternatives><graphic id="pcbi.1005583.e184g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e184" xlink:type="simple"/><mml:math display="inline" id="M184"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, these are determined by
<disp-formula id="pcbi.1005583.e185"><alternatives><graphic id="pcbi.1005583.e185g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e185" xlink:type="simple"/><mml:math display="block" id="M185"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="center"><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>ϕ</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(80)</label></disp-formula>
We shift by these solutions by defining
<disp-formula id="pcbi.1005583.e186"><alternatives><graphic id="pcbi.1005583.e186g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e186" xlink:type="simple"/><mml:math display="block" id="M186"><mml:mrow><mml:mi>δ</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(81)</label></disp-formula>
This leaves us with the action
<disp-formula id="pcbi.1005583.e187"><alternatives><graphic id="pcbi.1005583.e187g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e187" xlink:type="simple"/><mml:math display="block" id="M187"><mml:mrow><mml:mi>S</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:munder><mml:mo>∫</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>ϕ</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>g</mml:mi></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(82)</label></disp-formula></p>
<p>Now we can develop the rules for the expansion we provide in the text using the same procedure outlined above. The only difference is that Δ<sub><italic>ij</italic></sub>(<italic>t</italic>, <italic>t</italic>′) will be replaced by the linear response around mean field theory and the vertex factors will be determined by an expansion around the mean field solution. The rules otherwise remain the same. The rules so derived are shown in <xref ref-type="fig" rid="pcbi.1005583.g011">Fig 11</xref>. An expansion around the true mean <inline-formula id="pcbi.1005583.e188"><alternatives><graphic id="pcbi.1005583.e188g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005583.e188" xlink:type="simple"/><mml:math display="inline" id="M188"><mml:mo>⟨</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:math></alternatives></inline-formula> would lead to the “effective action,” the expansion of which gives rise to the proper vertex factors defining the different orders of stability correction.</p>
<p>Counting powers of the vertex factors allows one to compute a “weak coupling” expansion. Alternatively, the fluctuation expansion is determined by the topology of graphs and is equivalent to a steepest descent evaluation of the path integral. This allows us to truncate according to the number of loops in the associated graphs and is the approach we use in this paper. The approach here is a standard device in field theory and can be found many texts, for one example see [<xref ref-type="bibr" rid="pcbi.1005583.ref039">39</xref>].</p>
</sec>
</sec>
</sec>
</body>
<back>
<ack>
<p>We thank Brent Doiron and Robert Rosenbaum for their helpful comments on the manuscript. The authors wish to thank the Allen Institute founders, Paul G. Allen and Jody Allen, for their vision, encouragement and support.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005583.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>Storing covariance with nonlinearly interacting neurons</article-title>. <source>Journal of Mathematical Biology</source>. <year>1977</year>;<volume>4</volume>(<issue>4</issue>):<fpage>303</fpage>–<lpage>321</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00275079" xlink:type="simple">10.1007/BF00275079</ext-link></comment> <object-id pub-id-type="pmid">925522</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bienenstock</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Cooper</surname> <given-names>LN</given-names></name>, <name name-style="western"><surname>Munro</surname> <given-names>PW</given-names></name>. <article-title>Theory for the development of neuron selectivity: orientation specificity and binocular interaction in visual cortex</article-title>. <source>The Journal of Neuroscience</source>. <year>1982</year>;<volume>2</volume>(<issue>1</issue>):<fpage>32</fpage>–<lpage>48</lpage>. <object-id pub-id-type="pmid">7054394</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kempter</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>van Hemmen</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>H</given-names></name>. <article-title>A neuronal learning rule for sub-millisecond temporal coding</article-title>. <source>Nature</source>. <year>1996</year>;<volume>383</volume>(<issue>6595</issue>):<fpage>76</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/383076a0" xlink:type="simple">10.1038/383076a0</ext-link></comment> <object-id pub-id-type="pmid">8779718</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pfister</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Triplets of Spikes in a Model of Spike Timing-Dependent Plasticity</article-title>. <source>The Journal of Neuroscience</source>. <year>2006</year>;<volume>26</volume>(<issue>38</issue>):<fpage>9673</fpage>–<lpage>9682</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1425-06.2006" xlink:type="simple">10.1523/JNEUROSCI.1425-06.2006</ext-link></comment> <object-id pub-id-type="pmid">16988038</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ocker</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Litwin-Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>. <article-title>Self-Organization of Microcircuits in Networks of Spiking Neurons with Plastic Synapses</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>8</issue>):<fpage>e1004458</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004458" xlink:type="simple">10.1371/journal.pcbi.1004458</ext-link></comment> <object-id pub-id-type="pmid">26291697</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tannenbaum</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Burak</surname> <given-names>Y</given-names></name>. <article-title>Shaping Neural Circuits by High Order Synaptic Interactions</article-title>. <source>PLOS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>8</issue>):<fpage>e1005056</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1005056" xlink:type="simple">10.1371/journal.pcbi.1005056</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abeles</surname> <given-names>M</given-names></name>. <article-title>Role of the cortical neuron: integrator or coincidence detector?</article-title> <source>Israel Journal of Medical Sciences</source>. <year>1982</year>;<volume>18</volume>(<issue>1</issue>):<fpage>83</fpage>–<lpage>92</lpage>. <object-id pub-id-type="pmid">6279540</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Usrey</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Reppas</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>. <article-title>Paired-spike interactions and synaptic efficacy of retinal inputs to the thalamus</article-title>. <source>Nature</source>. <year>1998</year>;<volume>395</volume>(<issue>6700</issue>):<fpage>384</fpage>–<lpage>387</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/26487" xlink:type="simple">10.1038/26487</ext-link></comment> <object-id pub-id-type="pmid">9759728</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bruno</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. <article-title>Cortex is driven by weak but synchronously active thalamocortical synapses</article-title>. <source>Science (New York, NY)</source>. <year>2006</year>;<volume>312</volume>(<issue>5780</issue>):<fpage>1622</fpage>–<lpage>1627</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1124593" xlink:type="simple">10.1126/science.1124593</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Histed</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Maunsell</surname> <given-names>JHR</given-names></name>. <article-title>Cortical neural populations can guide behavior by integrating inputs linearly, independent of synchrony</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>1</issue>):<fpage>E178</fpage>–<lpage>E187</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1318750111" xlink:type="simple">10.1073/pnas.1318750111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Salinas</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>Impact of correlated synaptic input on output firing rate and variability in simple neuronal models</article-title>. <source>The Journal of Neuroscience: The Official Journal of the Society for Neuroscience</source>. <year>2000</year>;<volume>20</volume>(<issue>16</issue>):<fpage>6193</fpage>–<lpage>6209</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>. <article-title>Neural correlations, population coding and computation</article-title>. <source>Nat Rev Neurosci</source>. <year>2006</year>;<volume>7</volume>(<issue>5</issue>):<fpage>358</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn1888" xlink:type="simple">10.1038/nrn1888</ext-link></comment> <object-id pub-id-type="pmid">16760916</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Panzeri</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Macke</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Gross</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kayser</surname> <given-names>C</given-names></name>. <article-title>Neural population coding: combining insights from microscopic and mass signals</article-title>. <source>Trends in Cognitive Sciences</source>. <year>2015</year>;<volume>19</volume>(<issue>3</issue>):<fpage>162</fpage>–<lpage>172</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2015.01.002" xlink:type="simple">10.1016/j.tics.2015.01.002</ext-link></comment> <object-id pub-id-type="pmid">25670005</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Seriès</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>. <article-title>Tuning curve sharpening for orientation selectivity: coding efficiency and the impact of correlations</article-title>. <source>Nature Neuroscience</source>. <year>2004</year>;<volume>7</volume>(<issue>10</issue>):<fpage>1129</fpage>–<lpage>1135</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1321" xlink:type="simple">10.1038/nn1321</ext-link></comment> <object-id pub-id-type="pmid">15452579</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>de la Rocha</surname> <given-names>J</given-names></name>. <article-title>Stimulus-dependent correlations and population codes</article-title>. <source>Neural Comp</source>. <year>2009</year>;<volume>21</volume>:<fpage>2774</fpage>–<lpage>2804</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moreno-Bote</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Beck</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kanitscheider</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Pitkow</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>. <article-title>Information-limiting correlations</article-title>. <source>Nature Neuroscience</source>. <year>2014</year>;<volume>17</volume>(<issue>10</issue>):<fpage>1410</fpage>–<lpage>1417</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3807" xlink:type="simple">10.1038/nn.3807</ext-link></comment> <object-id pub-id-type="pmid">25195105</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zylberberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cafaro</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Rieke</surname> <given-names>F</given-names></name>. <article-title>Direction-Selective Circuits Shape Noise to Ensure a Precise Population Code</article-title>. <source>Neuron</source>. <year>2016</year>;<volume>89</volume>(<issue>2</issue>):<fpage>369</fpage>–<lpage>383</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2015.11.019" xlink:type="simple">10.1016/j.neuron.2015.11.019</ext-link></comment> <object-id pub-id-type="pmid">26796691</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Franke</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Fiscella</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sevelev</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roska</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hierlemann</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Azeredo da Silveira</surname> <given-names>R</given-names></name>. <article-title>Structures of Neural Correlation and How They Favor Coding</article-title>. <source>Neuron</source>. <year>2016</year>;<volume>89</volume>(<issue>2</issue>):<fpage>409</fpage>–<lpage>422</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2015.12.037" xlink:type="simple">10.1016/j.neuron.2015.12.037</ext-link></comment> <object-id pub-id-type="pmid">26796692</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hawkes</surname> <given-names>AG</given-names></name>. <article-title>Spectra of some self-exciting and mutually exciting point processes</article-title>. <source>Biometrika</source>. <year>1971</year>;<volume>58</volume>(<issue>1</issue>):<fpage>83</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/58.1.83" xlink:type="simple">10.1093/biomet/58.1.83</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brillinger</surname> <given-names>D</given-names></name>. <article-title>Estimation of the second-order intensities of a bivariate stationary point process</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1976</year>;<volume>38</volume>(<issue>1</issue>):<fpage>60</fpage>–<lpage>66</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Longtin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Maler</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bastian</surname> <given-names>J</given-names></name>. <article-title>Oscillatory activity in electrosensory neurons increases with the spatial correlation of the stochastic input stimulus</article-title>. <source>Phys Rev Let</source>. <year>2004</year>;<volume>93</volume>(<issue>4</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.93.048101" xlink:type="simple">10.1103/PhysRevLett.93.048101</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trousdale</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>. <article-title>Impact of Network Structure and Cellular Response on Spike Time Correlations</article-title>. <source>PLoS Computational Biology</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e1002408</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002408" xlink:type="simple">10.1371/journal.pcbi.1002408</ext-link></comment> <object-id pub-id-type="pmid">22457608</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ginzburg</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Theory of correlations in stochastic neural networks</article-title>. <source>Physical Review E</source>. <year>1994</year>;<volume>50</volume>(<issue>4</issue>):<fpage>3171</fpage>–<lpage>3191</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.50.3171" xlink:type="simple">10.1103/PhysRevE.50.3171</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Dynamics of Sparsely Connected Networks of Excitatory and Inhibitory Spiking Neurons</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2000</year>;<volume>8</volume>(<issue>3</issue>):<fpage>183</fpage>–<lpage>208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1008925309027" xlink:type="simple">10.1023/A:1008925309027</ext-link></comment> <object-id pub-id-type="pmid">10809012</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mattia</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Del Giudice</surname> <given-names>P</given-names></name>. <article-title>Population dynamics of interacting spiking neurons</article-title>. <source>Physical Review E</source>. <year>2002</year>;<volume>66</volume>(<issue>5</issue>):<fpage>051917</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.66.051917" xlink:type="simple">10.1103/PhysRevE.66.051917</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref026">
<label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>E</given-names></name>. <chapter-title>Analysis of neural data</chapter-title>. <edition>1st ed</edition>. <source>Springer series in statistics</source>. <publisher-name>Springer-Verlag</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Litwin-Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rosenbaum</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ocker</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>. <article-title>The mechanics of state-dependent neural correlations</article-title>. <source>Nature Neuroscience</source>. <year>2016</year>;<volume>19</volume>(<issue>3</issue>):<fpage>383</fpage>–<lpage>393</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.4242" xlink:type="simple">10.1038/nn.4242</ext-link></comment> <object-id pub-id-type="pmid">26906505</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Abeles</surname> <given-names>M</given-names></name>. <source>Corticonics: Neural circuits of the cerebral cortex</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>1991</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gewaltig</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>. <article-title>Stable propagation of synchronous spiking in cortical neural networks</article-title>. <source>Nature</source>. <year>1999</year>;<volume>402</volume>(<issue>6761</issue>):<fpage>529</fpage>–<lpage>533</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/990101" xlink:type="simple">10.1038/990101</ext-link></comment> <object-id pub-id-type="pmid">10591212</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reyes</surname> <given-names>AD</given-names></name>. <article-title>Synchrony-dependent propagation of firing rate in iteratively constructed networks in vitro</article-title>. <source>Nature Neuroscience</source>. <year>2003</year>;<volume>6</volume>(<issue>6</issue>):<fpage>593</fpage>–<lpage>599</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1056" xlink:type="simple">10.1038/nn1056</ext-link></comment> <object-id pub-id-type="pmid">12730700</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>. <article-title>Spiking activity propagation in neuronal networks: reconciling different perspectives on neural coding</article-title>. <source>Nat Rev Neurosci</source>. <year>2010</year>;<volume>11</volume>:<fpage>615</fpage>–<lpage>627</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn2886" xlink:type="simple">10.1038/nrn2886</ext-link></comment> <object-id pub-id-type="pmid">20725095</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brémaud</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Massoulié</surname> <given-names>L</given-names></name>. <article-title>Stability of nonlinear Hawkes processes</article-title>. <source>The Annals of Probability</source>. <year>1996</year>;<volume>24</volume>(<issue>3</issue>):<fpage>1563</fpage>–<lpage>1588</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aop/1065725193" xlink:type="simple">10.1214/aop/1065725193</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref033">
<label>33</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kistler</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <source>Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsodyks</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Skaggs</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Paradoxical Effects of External Modulation of Inhibitory Interneurons</article-title>. <source>The Journal of Neuroscience</source>. <year>1997</year>;<volume>17</volume>(<issue>11</issue>):<fpage>4382</fpage>–<lpage>4388</lpage>. <object-id pub-id-type="pmid">9151754</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref035">
<label>35</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Risken</surname> <given-names>H</given-names></name>. <source>The Fokker-Planck equation: methods of solution and applications</source>. <edition>3rd ed</edition>. <name name-style="western"><surname>Haken</surname> <given-names>H</given-names></name>, editor. <publisher-name>Springer-Verlag</publisher-name>; <year>1996</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hawkes</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Oakes</surname> <given-names>D</given-names></name>. <article-title>A cluster process representation of a self-exciting process</article-title>. <source>Journal of Applied Probability</source>. <year>1974</year>;<volume>11</volume>:<fpage>493</fpage>–<lpage>503</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/S0021900200096273" xlink:type="simple">10.1017/S0021900200096273</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Saichev</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Sornette</surname> <given-names>D</given-names></name>. <article-title>Generating functions and stability study of multivariate self-excited epidemic processes</article-title>. <source>The European Physical Journal B</source>. <year>2011</year>;<volume>83</volume>(<issue>2</issue>):<fpage>271</fpage>–<lpage>282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1140/epjb/e2011-20298-3" xlink:type="simple">10.1140/epjb/e2011-20298-3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jovanović</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hertz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Cumulants of Hawkes point processes</article-title>. <source>Physical Review E</source>. <year>2015</year>;<volume>91</volume>(<issue>4</issue>):<fpage>042802</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.91.042802" xlink:type="simple">10.1103/PhysRevE.91.042802</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref039">
<label>39</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Zinn-Justin</surname> <given-names>J</given-names></name>. <source>Quantum Field Theory and Critical Phenomena</source>. <publisher-name>Clarendon Press</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>Field-theoretic approach to fluctuation effects in neural networks</article-title>. <source>Physical Review E</source>. <year>2007</year>;<volume>75</volume>(<issue>5</issue>):<fpage>051919</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.75.051919" xlink:type="simple">10.1103/PhysRevE.75.051919</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pernice</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Staude</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Cardanobile</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>How structure determines correlations in neuronal networks</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>(<issue>5</issue>):<fpage>e1002059</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002059" xlink:type="simple">10.1371/journal.pcbi.1002059</ext-link></comment> <object-id pub-id-type="pmid">21625580</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Heeger</surname> <given-names>DJ</given-names></name>. <article-title>Normalization of cell responses in cat striate cortex</article-title>. <source>Visual Neuroscience</source>. <year>1992</year>;<volume>9</volume>(<issue>2</issue>):<fpage>181</fpage>–<lpage>197</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1017/S0952523800009640" xlink:type="simple">10.1017/S0952523800009640</ext-link></comment> <object-id pub-id-type="pmid">1504027</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Troyer</surname> <given-names>TW</given-names></name>. <article-title>Neural noise can explaine expansive, power-law nonlinearities in neural response functions</article-title>. <source>J Neurophysiol</source>. <year>2002</year>;<volume>87</volume>(<issue>2</issue>):<fpage>653</fpage>–<lpage>659</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00425.2001" xlink:type="simple">10.1152/jn.00425.2001</ext-link></comment> <object-id pub-id-type="pmid">11826034</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Priebe</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Mechler</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Carandini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ferster</surname> <given-names>D</given-names></name>. <article-title>The contribution of spike threshold to the dichotomy of cortical simple and complex cells</article-title>. <source>Nature Neuroscience</source>. <year>2004</year>;<volume>7</volume>(<issue>10</issue>):<fpage>1113</fpage>–<lpage>1122</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1310" xlink:type="simple">10.1038/nn1310</ext-link></comment> <object-id pub-id-type="pmid">15338009</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Priebe</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Ferster</surname> <given-names>D</given-names></name>. <article-title>Direction Selectivity of Excitation and Inhibition in Simple Cells of the Cat Primary Visual Cortex</article-title>. <source>Neuron</source>. <year>2005</year>;<volume>45</volume>(<issue>1</issue>):<fpage>133</fpage>–<lpage>145</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2004.12.024" xlink:type="simple">10.1016/j.neuron.2004.12.024</ext-link></comment> <object-id pub-id-type="pmid">15629708</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Priebe</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Ferster</surname> <given-names>D</given-names></name>. <article-title>Mechanisms underlying cross-orientation suppression in cat visual cortex</article-title>. <source>Nature Neuroscience</source>. <year>2006</year>;<volume>9</volume>(<issue>4</issue>):<fpage>552</fpage>–<lpage>561</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1660" xlink:type="simple">10.1038/nn1660</ext-link></comment> <object-id pub-id-type="pmid">16520737</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>. <chapter-title>Divergence and reconvergence: multielectrode analysis of feedforward connections in the visual system</chapter-title>. In: <source>Progress in Brain Research</source>. vol. <volume>130</volume>. <publisher-name>Elsevier</publisher-name>; <year>2001</year>. p. <fpage>141</fpage>–<lpage>154</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Song</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sjöström</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Reigl</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chklovskii</surname> <given-names>DB</given-names></name>. <article-title>Highly nonrandom features of synaptic connectivity in local cortical circuits</article-title>. <source>PLoS Biol</source>. <year>2005</year>;<volume>3</volume>(<issue>3</issue>):<fpage>e68</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0030068" xlink:type="simple">10.1371/journal.pbio.0030068</ext-link></comment> <object-id pub-id-type="pmid">15737062</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Perin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>. <article-title>A synaptic organizing principle for cortical neuronal groups</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>13</issue>):<fpage>5419</fpage>–<lpage>5424</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1016051108" xlink:type="simple">10.1073/pnas.1016051108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>WCA</given-names></name>, <name name-style="western"><surname>Bonin</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Reed</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Graham</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Hood</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Glattfelder</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Anatomy and function of an excitatory network in the visual cortex</article-title>. <source>Nature</source>. <year>2016</year>;<volume>532</volume>(<issue>7599</issue>):<fpage>370</fpage>–<lpage>374</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature17192" xlink:type="simple">10.1038/nature17192</ext-link></comment> <object-id pub-id-type="pmid">27018655</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yoshimura</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Dantzker</surname> <given-names>JLM</given-names></name>, <name name-style="western"><surname>Callaway</surname> <given-names>EM</given-names></name>. <article-title>Excitatory cortical neurons form fine-scale functional networks</article-title>. <source>Nature</source>. <year>2005</year>;<volume>433</volume>(<issue>7028</issue>):<fpage>868</fpage>–<lpage>873</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature03252" xlink:type="simple">10.1038/nature03252</ext-link></comment> <object-id pub-id-type="pmid">15729343</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yoshimura</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Callaway</surname> <given-names>EM</given-names></name>. <article-title>Fine-scale specificity of cortical networks depends on inhibitory cell type and connectivity</article-title>. <source>Nature Neuroscience</source>. <year>2005</year>;<volume>8</volume>(<issue>11</issue>):<fpage>1552</fpage>–<lpage>1559</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1565" xlink:type="simple">10.1038/nn1565</ext-link></comment> <object-id pub-id-type="pmid">16222228</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morgenstern</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Bourg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Petreanu</surname> <given-names>L</given-names></name>. <article-title>Multilaminar networks of cortical neurons integrate common inputs from sensory thalamus</article-title>. <source>Nature Neuroscience</source>. <year>2016</year>;<volume>19</volume>(<issue>8</issue>):<fpage>1034</fpage>–<lpage>1040</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.4339" xlink:type="simple">10.1038/nn.4339</ext-link></comment> <object-id pub-id-type="pmid">27376765</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Iyer</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Menon</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Buice</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mihalas</surname> <given-names>S</given-names></name>. <article-title>The Influence of Synaptic Weight Distribution on Neuronal Population Dynamics</article-title>. <source>PLOS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>10</issue>):<fpage>e1003248</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003248" xlink:type="simple">10.1371/journal.pcbi.1003248</ext-link></comment> <object-id pub-id-type="pmid">24204219</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Trousdale</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>. <article-title>Motif statistics and spike correlations in neuronal networks</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>. <year>2013</year>;<volume>2013</volume>(<issue>03</issue>):<fpage>P03012</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1742-5468/2013/03/P03012" xlink:type="simple">10.1088/1742-5468/2013/03/P03012</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Trousdale</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>. <article-title>Local paths to global coherence: Cutting networks down to size</article-title>. <source>Physical Review E</source>. <year>2014</year>;<volume>89</volume>(<issue>3</issue>):<fpage>032802</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.89.032802" xlink:type="simple">10.1103/PhysRevE.89.032802</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roxin</surname> <given-names>A</given-names></name>. <article-title>The role of degree distribution in shaping the dynamics in networks of sparsely connected spiking neurons</article-title>. <source>Frontiers in Computational Neuroscience</source>. <year>2011</year>;<volume>5</volume>:<fpage>8</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2011.00008" xlink:type="simple">10.3389/fncom.2011.00008</ext-link></comment> <object-id pub-id-type="pmid">21556129</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Beverlin</surname> <given-names>BI</given-names></name>, <name name-style="western"><surname>Netoff</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Nykamp</surname> <given-names>DQ</given-names></name>. <article-title>Synchronization from second order network connectivity statistics</article-title>. <source>Frontiers in Computational Neuroscience</source>. <year>2011</year>;<volume>5</volume>:<fpage>28</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2011.00028" xlink:type="simple">10.3389/fncom.2011.00028</ext-link></comment> <object-id pub-id-type="pmid">21779239</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cossell</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Iacaruso</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Muir</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Houlton</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sader</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Functional organization of excitatory synaptic strength in primary visual cortex</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7539</issue>):<fpage>399</fpage>–<lpage>403</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature14182" xlink:type="simple">10.1038/nature14182</ext-link></comment> <object-id pub-id-type="pmid">25652823</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Crisanti</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sommers</surname> <given-names>HJ</given-names></name>. <article-title>Chaos in Random Neural Networks</article-title>. <source>Physical Review Letters</source>. <year>1988</year>;<volume>61</volume>(<issue>3</issue>):<fpage>259</fpage>–<lpage>262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.61.259" xlink:type="simple">10.1103/PhysRevLett.61.259</ext-link></comment> <object-id pub-id-type="pmid">10039285</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kadmon</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Transition to Chaos in Random Neuronal Networks</article-title>. <source>Physical Review X</source>. <year>2015</year>;<volume>5</volume>(<issue>4</issue>):<fpage>041030</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevX.5.041030" xlink:type="simple">10.1103/PhysRevX.5.041030</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harish</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Hansel</surname> <given-names>D</given-names></name>. <article-title>Asynchronous Rate Chaos in Spiking Neuronal Circuits</article-title>. <source>PLOS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>7</issue>):<fpage>e1004266</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004266" xlink:type="simple">10.1371/journal.pcbi.1004266</ext-link></comment> <object-id pub-id-type="pmid">26230679</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref063">
<label>63</label>
<mixed-citation publication-type="other" xlink:type="simple">Mastrogiuseppe F, Ostojic S. Intrinsically-generated fluctuating activity in excitatory-inhibitory networks. arXiv:160504221 [q-bio]. 2016;.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stern</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>. <article-title>Dynamics of random neural networks with bistable units</article-title>. <source>Physical Review E</source>. <year>2014</year>;<volume>90</volume>(<issue>6</issue>):<fpage>062710</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.90.062710" xlink:type="simple">10.1103/PhysRevE.90.062710</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aljadeff</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sharpee</surname> <given-names>T</given-names></name>. <article-title>Transition to Chaos in Random Networks with Cell-Type-Specific Connectivity</article-title>. <source>Physical Review Letters</source>. <year>2015</year>;<volume>114</volume>(<issue>8</issue>):<fpage>088101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.114.088101" xlink:type="simple">10.1103/PhysRevLett.114.088101</ext-link></comment> <object-id pub-id-type="pmid">25768781</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aljadeff</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Renfrew</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vegué</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sharpee</surname> <given-names>TO</given-names></name>. <article-title>Low-dimensional dynamics of structured random networks</article-title>. <source>Physical Review E</source>. <year>2016</year>;<volume>93</volume>(<issue>2</issue>):<fpage>022302</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.93.022302" xlink:type="simple">10.1103/PhysRevE.93.022302</ext-link></comment> <object-id pub-id-type="pmid">26986347</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref067">
<label>67</label>
<mixed-citation publication-type="other" xlink:type="simple">Goedeke S, Schuecker J, Helias M. Noise dynamically suppresses chaos in random neural networks. arXiv:160301880 [nlin, q-bio]. 2016;.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>CC</given-names></name>. <article-title>Beyond mean field theory: statistical field theory for neural networks</article-title>. <source>Journal of Statistical Mechanics (Online)</source>. <year>2013</year>;<volume>2013</volume>:<fpage>P03003</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1742-5468/2013/03/P03003" xlink:type="simple">10.1088/1742-5468/2013/03/P03003</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bressloff</surname> <given-names>PC</given-names></name>. <article-title>Path-Integral Methods for Analyzing the Effects of Fluctuations in Stochastic Hybrid Neural Networks</article-title>. <source>The Journal of Mathematical Neuroscience</source>. <year>2015</year>;<volume>5</volume>(<issue>1</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13408-014-0016-z" xlink:type="simple">10.1186/s13408-014-0016-z</ext-link></comment> <object-id pub-id-type="pmid">25852979</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ohira</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>Master-equation approach to stochastic neurodynamics</article-title>. <source>Physical Review E</source>. <year>1993</year>;<volume>48</volume>(<issue>3</issue>):<fpage>2259</fpage>–<lpage>2266</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.48.2259" xlink:type="simple">10.1103/PhysRevE.48.2259</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bressloff</surname> <given-names>P</given-names></name>. <article-title>Stochastic Neural Field Theory and the System-Size Expansion</article-title>. <source>SIAM Journal on Applied Mathematics</source>. <year>2009</year>;<volume>70</volume>(<issue>5</issue>):<fpage>1488</fpage>–<lpage>1521</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/090756971" xlink:type="simple">10.1137/090756971</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>Systematic fluctuation expansion for neural network activity equations</article-title>. <source>Neural Comp</source>. <year>2010</year>;<volume>22</volume>(<issue>377–426</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>de la Rocha</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>A</given-names></name>. <article-title>Correlation between neural spike trains increases with firing rate</article-title>. <source>Nature</source>. <year>2007</year>;<volume>448</volume>(<issue>7155</issue>):<fpage>802</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06028" xlink:type="simple">10.1038/nature06028</ext-link></comment> <object-id pub-id-type="pmid">17700699</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fourcaud</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Dynamics of the Firing Probability of Noisy Integrate-and-Fire Neurons</article-title>. <source>Neural Computation</source>. <year>2002</year>;<volume>14</volume>(<issue>9</issue>):<fpage>2057</fpage>–<lpage>2110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976602320264015" xlink:type="simple">10.1162/089976602320264015</ext-link></comment> <object-id pub-id-type="pmid">12184844</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jovanović</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Interplay between Graph Topology and Correlations of Third Order in Spiking Neuronal Networks</article-title>. <source>PLOS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>6</issue>):<fpage>e1004963</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004963" xlink:type="simple">10.1371/journal.pcbi.1004963</ext-link></comment> <object-id pub-id-type="pmid">27271768</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Vreeswijk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Chaotic balanced state in a model of cortical circuits</article-title>. <source>Neural Computation</source>. <year>1998</year>;<volume>10</volume>(<issue>6</issue>):<fpage>1321</fpage>–<lpage>1371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976698300017214" xlink:type="simple">10.1162/089976698300017214</ext-link></comment> <object-id pub-id-type="pmid">9698348</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Renart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rocha</surname> <given-names>Jdl</given-names></name>, <name name-style="western"><surname>Bartho</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hollender</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Parga</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The Asynchronous State in Cortical Circuits</article-title>. <source>Science</source>. <year>2010</year>;<volume>327</volume>(<issue>5965</issue>):<fpage>587</fpage>–<lpage>590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1179850" xlink:type="simple">10.1126/science.1179850</ext-link></comment> <object-id pub-id-type="pmid">20110507</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ledoux</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Dynamics of networks of excitatory and inhibitory neurons in response to time-dependent inputs</article-title>. <source>Frontiers in Computational Neuroscience</source>. <year>2011</year>;<volume>5</volume>:<fpage>25</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2011.00025" xlink:type="simple">10.3389/fncom.2011.00025</ext-link></comment> <object-id pub-id-type="pmid">21647353</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ostojic</surname> <given-names>S</given-names></name>. <article-title>Two types of asynchronous activity in networks of excitatory and inhibitory spiking neurons</article-title>. <source>Nature Neuroscience</source>. <year>2014</year>;<volume>17</volume>(<issue>4</issue>):<fpage>594</fpage>–<lpage>600</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3658" xlink:type="simple">10.1038/nn.3658</ext-link></comment> <object-id pub-id-type="pmid">24561997</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Vreeswijk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title>. <source>Science (New York, NY)</source>. <year>1996</year>;<volume>274</volume>(<issue>5293</issue>):<fpage>1724</fpage>–<lpage>1726</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.274.5293.1724" xlink:type="simple">10.1126/science.274.5293.1724</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref081">
<label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ahmadian</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>. <article-title>Analysis of the Stabilized Supralinear Network</article-title>. <source>Neural Computation</source>. <year>2013</year>;<volume>25</volume>(<issue>8</issue>):<fpage>1994</fpage>–<lpage>2037</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00472" xlink:type="simple">10.1162/NECO_a_00472</ext-link></comment> <object-id pub-id-type="pmid">23663149</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref082">
<label>82</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ozeki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Finn</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Schaffer</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Ferster</surname> <given-names>D</given-names></name>. <article-title>Inhibitory Stabilization of the Cortical Network Underlies Visual Surround Suppression</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>62</volume>(<issue>4</issue>):<fpage>578</fpage>–<lpage>592</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2009.03.028" xlink:type="simple">10.1016/j.neuron.2009.03.028</ext-link></comment> <object-id pub-id-type="pmid">19477158</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref083">
<label>83</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Van Hooser</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>. <article-title>The stabilized supralinear network: a unifying circuit motif underlying multi-input integration in sensory cortex</article-title>. <source>Neuron</source>. <year>2015</year>;<volume>85</volume>(<issue>2</issue>):<fpage>402</fpage>–<lpage>417</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2014.12.026" xlink:type="simple">10.1016/j.neuron.2014.12.026</ext-link></comment> <object-id pub-id-type="pmid">25611511</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref084">
<label>84</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Litwin-Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rosenbaum</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>. <article-title>Inhibitory stabilization and visual coding in cortical circuits with multiple interneuron subtypes</article-title>. <source>Journal of Neurophysiology</source>. <year>2016</year>;<volume>115</volume>(<issue>3</issue>):<fpage>1399</fpage>–<lpage>1409</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00732.2015" xlink:type="simple">10.1152/jn.00732.2015</ext-link></comment> <object-id pub-id-type="pmid">26740531</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref085">
<label>85</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zylberberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>. <article-title>The Sign Rule and Beyond: Boundary Effects, Flexibility, and Noise Correlations in Neural Population Codes</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>2</issue>):<fpage>e1003469</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003469" xlink:type="simple">10.1371/journal.pcbi.1003469</ext-link></comment> <object-id pub-id-type="pmid">24586128</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref086">
<label>86</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Martin</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Siggia</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Rose</surname> <given-names>HA</given-names></name>. <article-title>Statistical Dynamics of Classical Systems</article-title>. <source>Physical Review A</source>. <year>1973</year>;<volume>8</volume>(<issue>1</issue>):<fpage>423</fpage>–<lpage>437</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevA.8.423" xlink:type="simple">10.1103/PhysRevA.8.423</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref087">
<label>87</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doi</surname> <given-names>M</given-names></name>. <article-title>Second quantization representation for classical many-particle system</article-title>. <source>Journal of Physics A: Mathematical and General</source>. <year>1976</year>;<volume>9</volume>(<issue>9</issue>):<fpage>1465</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0305-4470/9/9/008" xlink:type="simple">10.1088/0305-4470/9/9/008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref088">
<label>88</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doi</surname> <given-names>M</given-names></name>. <article-title>Stochastic theory of diffusion-controlled reaction</article-title>. <source>Journal of Physics A: Mathematical and General</source>. <year>1976</year>;<volume>9</volume>(<issue>9</issue>):<fpage>1479</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0305-4470/9/9/009" xlink:type="simple">10.1088/0305-4470/9/9/009</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref089">
<label>89</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Peliti</surname> <given-names>L</given-names></name>. <article-title>Path integral approach to birth-death processes on a lattice</article-title>. <source>Journal de Physique</source>. <year>1985</year>;<volume>46</volume>(<issue>9</issue>):<fpage>1469</fpage>–<lpage>1483</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1051/jphys:019850046090146900" xlink:type="simple">10.1051/jphys:019850046090146900</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005583.ref090">
<label>90</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Täuber</surname> <given-names>UC</given-names></name>. <chapter-title>Field-Theory Approaches to Nonequilibrium Dynamics</chapter-title>. In: <name name-style="western"><surname>Henkel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pleimling</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sanctuary</surname> <given-names>R</given-names></name>, editors. <source>Ageing and the Glass Transition. No. 716 in Lecture Notes in Physics</source>. <publisher-name>Springer Berlin Heidelberg</publisher-name>; <year>2007</year>. p. <fpage>295</fpage>–<lpage>348</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/chapter/10.1007/3-540-69684-9_7" xlink:type="simple">http://link.springer.com/chapter/10.1007/3-540-69684-9_7</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref091">
<label>91</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Cardy</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Falkovich</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gawedzki</surname> <given-names>K</given-names></name>. <source>Non-equilibrium Statistical Mechanics and Turbulence</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2008</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref092">
<label>92</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lefèvre</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Biroli</surname> <given-names>G</given-names></name>. <article-title>Dynamics of interacting particle systems: stochastic process and field theory</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>. <year>2007</year>;<volume>2007</volume>(<issue>07</issue>):<fpage>P07024</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005583.ref093">
<label>93</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chow</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>. <article-title>Path Integral Methods for Stochastic Differential Equations</article-title>. <source>The Journal of Mathematical Neuroscience (JMN)</source>. <year>2015</year>;<volume>5</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13408-015-0018-5" xlink:type="simple">10.1186/s13408-015-0018-5</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>