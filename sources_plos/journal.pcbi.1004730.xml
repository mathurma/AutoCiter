<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00827</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004730</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Kinematics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Motion</subject><subj-group><subject>Velocity</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Mammals</subject><subj-group><subject>Primates</subject><subj-group><subject>Monkeys</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Agriculture</subject><subj-group><subject>Animal management</subject><subj-group><subject>Animal performance</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Sociology</subject><subj-group><subject>Education</subject><subj-group><subject>Training (education)</subject><subj-group><subject>Adaptive training</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Robust Brain-Machine Interface Design Using Optimal Feedback Control Modeling and Adaptive Point Process Filtering</article-title>
<alt-title alt-title-type="running-head">Robust Closed-Loop Brain-Machine Interface Design</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Shanechi</surname> <given-names>Maryam M.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Orsborn</surname> <given-names>Amy L.</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Carmena</surname> <given-names>Jose M.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Electrical Engineering, Viterbi School of Engineering, University of Southern California, Los Angeles, California, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Electrical Engineering and Computer Sciences, University of California, Berkeley, Berkeley, California, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>University of California, Berkeley—University of California, San Francisco Graduate Group in Bioengineering, San Francisco, California, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Helen Willis Neuroscience Institute, University of California, Berkeley, Berkeley, California, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Sporns</surname> <given-names>Olaf</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Indiana University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: MMS ALO. Performed the experiments: MMS ALO. Analyzed the data: MMS. Contributed reagents/materials/analysis tools: MMS. Wrote the paper: MMS ALO JMC. Developed the new brain-machine interface: MMS.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">shanechi@usc.edu</email> (MMS); <email xlink:type="simple">carmena@eecs.berkeley.edu</email> (JMC)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>1</day>
<month>4</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>4</issue>
<elocation-id>e1004730</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>5</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>4</day>
<month>1</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Shanechi et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004730"/>
<abstract>
<p>Much progress has been made in brain-machine interfaces (BMI) using decoders such as Kalman filters and finding their parameters with closed-loop decoder adaptation (CLDA). However, current decoders do not model the spikes directly, and hence may limit the processing time-scale of BMI control and adaptation. Moreover, while specialized CLDA techniques for intention estimation and assisted training exist, a unified and systematic CLDA framework that generalizes across different setups is lacking. Here we develop a novel closed-loop BMI training architecture that allows for processing, control, and adaptation using spike events, enables robust control and extends to various tasks. Moreover, we develop a unified control-theoretic CLDA framework within which intention estimation, assisted training, and adaptation are performed. The architecture incorporates an infinite-horizon optimal feedback-control (OFC) model of the brain’s behavior in closed-loop BMI control, and a point process model of spikes. The OFC model infers the user’s motor intention during CLDA—a process termed intention estimation. OFC is also used to design an autonomous and dynamic assisted training technique. The point process model allows for neural processing, control and decoder adaptation with every spike event and at a faster time-scale than current decoders; it also enables dynamic spike-event-based parameter adaptation unlike current CLDA methods that use batch-based adaptation on much slower adaptation time-scales. We conducted closed-loop experiments in a non-human primate over tens of days to dissociate the effects of these novel CLDA components. The OFC intention estimation improved BMI performance compared with current intention estimation techniques. OFC assisted training allowed the subject to consistently achieve proficient control. Spike-event-based adaptation resulted in faster and more consistent performance convergence compared with batch-based methods, and was robust to parameter initialization. Finally, the architecture extended control to tasks beyond those used for CLDA training. These results have significant implications towards the development of clinically-viable neuroprosthetics.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Brain-machine interfaces (BMI) decode subjects’ intended movements from neural activity. Despite significant advances, performance, robustness, and extendibility remain key challenges. Current BMIs use decoders such as Kalman filters whose parameters are estimated in closed-loop BMI operation. However, current decoders do not model the spikes directly and hence may limit the time-scale of neural processing, control, and parameter estimation. Here we develop a novel BMI training architecture for spike-event-based control and parameter estimation, and show that it enables robust control and extends to various tasks. Moreover, we propose a control-theoretic framework for closed-loop decoder training. The BMI incorporates an optimal feedback-control (OFC) model of brain’s control behavior to infer its motor intention. The BMI uses a point process to model the spikes; this enables the subject to control the movement and the decoder to estimate the parameters using spike events. Using closed-loop experiments in a non-human primate, we show that the OFC model improves performance compared with current intention estimation techniques; that spike-event-based adaptation enables faster performance convergence compared with current batch-based methods, and is robust to parameter initialization; and that the architecture extends to various tasks. This architecture has significant implications for future clinically-viable BMIs.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by: National Science Foundation grant EFRI-M3C 1137267 (JMC) <ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov/" xlink:type="simple">http://www.nsf.gov/</ext-link>; Defense Advanced Research Projects Agency contract N66001-10-C-2008 (JMC) <ext-link ext-link-type="uri" xlink:href="http://www.darpa.mil/default.aspx" xlink:type="simple">http://www.darpa.mil/default.aspx</ext-link>; and National Science Foundation CAREER Award CCF-1453868 (MMS) <ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov/" xlink:type="simple">http://www.nsf.gov/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant files are available at <ext-link ext-link-type="uri" xlink:href="http://ee.usc.edu/nseip/bmi-videos.htm" xlink:type="simple">http://ee.usc.edu/nseip/bmi-videos.htm</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Brain-machine interfaces (BMI) have the potential to enable motor function in individuals with neurological injury or disease [<xref ref-type="bibr" rid="pcbi.1004730.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref005">5</xref>]. BMI research has demonstrated that human and non-human primates can use their neural activity to directly control computer cursors or robotic arms (e.g., [<xref ref-type="bibr" rid="pcbi.1004730.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref028">28</xref>]). BMIs record the neural activity from motor cortical areas, use a mathematical transform termed the “decoder” to convert this activity into control commands for an external device, and provide visual feedback of the generated movement to the subject (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1A</xref>). Various decoders such as linear regression, population vector, and Kalman filters (KF) have been used in real-time BMIs [<xref ref-type="bibr" rid="pcbi.1004730.ref029">29</xref>]. Once a decoding model is selected, its parameters need to be estimated for each subject. These parameters are often found in open loop in a training session by solving for the parameter values that best describe the neural activity in response to executed or imagined movement. However, the relationship between neural activity and movements can be different for movements of a natural arm versus a BMI cursor, and the decoder needs to be adjusted to better handle the latter relationship[<xref ref-type="bibr" rid="pcbi.1004730.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref030">30</xref>]. Hence methods that fit the decoder parameters in closed-loop BMI operation [<xref ref-type="bibr" rid="pcbi.1004730.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref031">31</xref>], referred to as closed-loop decoder adaptation (CLDA), can improve BMI performance [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>].</p>
<fig id="pcbi.1004730.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004730.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Adaptive OFC-PPF BMI architecture.</title>
<p>(A) Monkey performing the self-paced delayed center-out movement task in brain control. The subject’s arms were confined within a primate chair in brain control. (B) Timeline of the center-out task (see Experimental Procedures for details). (C) Adaptive OFC-PPF converts the spiking activity into a discrete time-series of 0’s and 1’s by binning the spikes in small intervals containing at most one spike; this binary time-series is modeled as a point process. We thus perform the decoding and parameter adaptation with every binary spike event. (D) Adaptive OFC-PPF architecture. The architecture models the brain in closed-loop BMI control as an infinite-horizon optimal feedback-controller to infer its intended velocity during adaptation. The inputs to the infinite-horizon optimal feedback-controller model are the visual feedback of the decoded cursor kinematics (that the monkey observes) and the instructed target position (i.e., task goal). The inferred intended velocity is input to a point process filter for each neuron, which estimates the neuron’s parameters with every 0 and 1 spike event. These estimated parameters are used in the kinematic PPF decoder that decodes the kinematics with every 0 and 1 spike event. Initially, the architecture can provide assisted training to the subject by decoding the kinematics using a target-directed PPF decoder (see <xref ref-type="sec" rid="sec002">Methods</xref>). After assisted training is complete, a random-walk PPF is used to decode the kinematics. Once performance converges, adaptation stops and the trained random-walk PPF is used by the monkey to perform various BMI tasks, such as the center-out or the target-jump tasks.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.g001" xlink:type="simple"/>
</fig>
<p>Recent works have used KF decoders and combined them with a specific form of CLDA to achieve proficient BMI control [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>]. Typical decoders such as the KF take as input the spike counts in bins, typically of 50–100 ms width, and assume a Gaussian distribution on these counts. Hence using a KF decoder, users can control the BMI once per bin (i.e., once every 50–100 ms). The CLDA process, in turn, consists of three steps: (1) a method to initialize the decoder, (2) a method to estimate the user’s velocity intention during CLDA, which is referred to as intention estimation, and (3) an algorithm to fit the decoder parameters based on the estimated intentions and the recorded neural activity. To perform CLDA, decoder parameters are first initialized based on arm reaching movements [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>], visual feedback of cursor movements (referred to as visual feedback seed; see <xref ref-type="sec" rid="sec002">Methods</xref>) [<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>], or even arbitrarily [<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>]. The initialized decoder is then used by the subject to make brain-controlled movements towards visual targets on the computer screen (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1A and 1B</xref>). To perform intention estimation, current methods referred to as CursorGoal find the intended velocity at each time by rotating the cursor’s decoded velocity vector towards the target while keeping its magnitude (i.e., speed) unchanged, and by equating it to zero when at the target [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>]. Decoder parameters are then refit by collecting batches of neural activity on the time-scale of minutes and inferring the subject’s intended velocity in these batches. In each batch, a new set of parameters are fit using maximum-likelihood techniques[<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref031">31</xref>]. Parameter estimates from previous batches are then either replaced with these new estimates [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>] or are smoothly changed either continuously [<xref ref-type="bibr" rid="pcbi.1004730.ref031">31</xref>], or intermittently (e.g., once every 90 sec) using a technique termed SmoothBatch [<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>], which converges to a good solution even when not initialized based on arm movements.</p>
<p>Here we develop a novel closed-loop BMI training architecture termed adaptive optimal feedback-controlled (OFC) point process filter (PPF) (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1C and 1D</xref>) to achieve two main goals; (1) to build a closed-loop BMI architecture that enables the subject to control the BMI at the time-scale of the spike events—defined as the presence or absence of a spike at a given time—, and that allows the decoder parameters to be adapted dynamically at this time-scale and with every spike event (see <xref ref-type="supplementary-material" rid="pcbi.1004730.s001">S1 Text</xref> for a summary of time-scales involved in CLDA-based BMIs); (2) to provide a unified and general control-theoretic CLDA framework within which intention estimation, assisted training, and adaptation can be performed, in contrast to current approaches.</p>
<p>First, while CLDA-based decoders such as the KF have yielded good performance, these decoders constrain the time-scale at which the spikes can be processed and hence the time-scale at which the subject can control the BMI based on the bin-width used for spike count calculation (typically once every 50–100ms [<xref ref-type="bibr" rid="pcbi.1004730.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref032">32</xref>]; see also <xref ref-type="supplementary-material" rid="pcbi.1004730.s001">S1 Text</xref>). Moreover, current batch-based CLDA techniques typically update the decoder parameters at slow adaptation time-scales. However, time-scales of control and adaptation may play an important role in ultimate BMI performance. Therefore designing decoders that are not limited to a particular time-scale because of modeling assumptions (<xref ref-type="supplementary-material" rid="pcbi.1004730.s001">S1 Text</xref>) would provide a powerful tool to investigate the effect of the time-scales of control and adaptation. Here we develop a novel CLDA-based PPF that exhibits this property and use it to test the possibility that faster spike-event-based adaptation time-scales will improve BMI adaptation. The PPF can run at any time-scale by modeling the spikes as a series of random 0 and 1 events occurring in time [<xref ref-type="bibr" rid="pcbi.1004730.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref035">35</xref>]. Hence it can incorporate any time-scale down to the time-scale of the spikes (5ms here).</p>
<p>Second, to perform CLDA, previous approaches have successfully used various ad-hoc methods for assisted training and intention estimation. However, a unified and systematic framework that can be used to perform all these manipulations does not exist. For example, some studies do not incorporate assisted training during CLDA [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>] since the initial decoder is good enough to keep the subject engaged in the task. Instead, these studies rotate the decoded velocity vector to estimate intention. In other studies, assisted training has been used to help subjects reach targets with a poor initial decoder and to estimate intention (e.g., [<xref ref-type="bibr" rid="pcbi.1004730.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref036">36</xref>]). These studies perform assisted training by either adding to the decoded velocity vector an assistive vector that directs straight towards the target, or subtracting from the decoded velocity vector a vector perpendicular to the straight line to the target, thus attenuating the deviation. These methods often continuously or manually change the ratio of the assistive vector to the decoded vector in the sum to adjust how much assistance is provided to the subject. Some studies have used a combination of these methods (e.g.,[<xref ref-type="bibr" rid="pcbi.1004730.ref036">36</xref>]). These ad-hoc approaches can make convergence trainer-dependent and significantly reduce robustness. Highly variable levels of assistance can also complicate the interpretation of performance during adaptation. Finally, the existing CursorGoal method of velocity intention estimation is based on an assumption of straight reaches towards the target [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>] and does not infer a speed intention; instead it sets the intended speed equal to the decoded speed, which may not be accurate during CLDA as decoder parameters are still being estimated. Here we propose a general unified control-theoretic framework within which full intention estimation (e.g., both direction and speed of velocity intention), assisted training, and adaptation can be performed across diverse BMI setups (see also <xref ref-type="sec" rid="sec024">Discussion</xref>).</p>
<p>Motivated by the above, we develop the novel closed-loop adaptive OFC-PPF (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1C and 1D</xref>) using two main components: a point process model of the spikes and an infinite-horizon optimal feedback control model of the brain’s control behavior in the BMI paradigm. In our previous open-loop work [<xref ref-type="bibr" rid="pcbi.1004730.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref039">39</xref>], we solved the problem of joint decoding of target and trajectory for the special case of straight target-directed movements and when decoder parameters were assumed to be known and found in open loop. Here we construct the first closed-loop PPF BMI training architecture, which fits the decoder parameters robustly and in closed loop, results in a decoder that can control various tasks and is not specific to straight target-directed movements, and allows for spike-event-based BMI control and adaptation.</p>
<p>To achieve our first goal, adaptive OFC-PPF models the spikes as a discrete time-series of 0’s and 1’s by binning them in small intervals containing at most one spike. This process creates a time-series of spike events; the spike events indicate the presence or absence of a spike in each small interval and hence take values 1 or 0. This enables subjects to control the BMI with every 0 or 1 spike event (every 5ms here; <xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1C</xref>); moreover, it allows the BMI to dynamically update the decoder parameters with every spike event in contrast to batch-based maximum-likelihood methods that do so on a much larger time-scale (e.g., minutes). We use the architecture to investigate whether faster spike-event-based time-scales of adaptation improve decoder convergence.</p>
<p>To achieve our second goal, adaptive OFC-PPF models the brain in closed-loop BMI control as an infinite-horizon optimal feedback-controller to infer velocity intention (both direction and speed) during adaptation; this is in contrast to the existing method of intention estimation (i.e., CursorGoal), which is based on the assumption of straight reaches towards a target and does not infer speed intention [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>]. The OFC method uses the target and error information to estimate the monkey’s intended velocity command in reaching the target; this estimated intended velocity is consequently used to train the decoder. In sum, the OFC model not only provides a general framework for intention estimation, but also allows for speed intention estimation that is not possible in CursorGoal. The OFC model is also used to devise a new assisted training paradigm, which is automated and dynamic and enables the computation of a chance level assisted performance. Thus the infinite-horizon OFC model results in a unified framework for these manipulations. This CLDA framework may also generalize to various BMI setups by simply quantifying the corresponding prosthetic’s dynamics and task goals within the OFC model. Finally, the proposed architecture is designed to be fully modular. We use the architecture to investigate the effect of OFC intention estimation and assisted training on BMI adaptation and performance.</p>
<p>We evaluated the architecture in closed-loop BMI experiments in a rhesus monkey over 89 days. We ran multiple different experiments to dissociate the effect of the novel CLDA architecture components (i.e., the effect of spike-event-based adaptation, OFC intention estimation, and OFC assisted training). We find that spike-event-based adaptation results in faster performance convergence compared to batch-based methods. Moreover, this parameter convergence is independent of initialization. Our data also shows that using the OFC intention estimation in place of the existing methods of intention estimation [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>] results in a PPF decoder with higher performance, suggesting that the former better approximates the user’s strategy. Moreover, the new OFC-based assisted training technique results in consistent parameter convergence across sessions and allows for a systematic way to change the level of assistance. We also find that the architecture extends control to tasks beyond those used for CLDA training, in particular a target-jump task and a target-to-target task. Taken together, these data show that adaptive OFC-PPF provides a unified framework for CLDA, and results in robust spike-event-based BMI adaptation and control that extends to various tasks.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec003">
<title>Ethics Statement</title>
<p>All procedures were conducted in compliance with the National Institutes of Health Guide for the Care and Use of Laboratory Animals and were approved by the University of California, Berkeley Institutional Animal Care and Use Committee.</p>
</sec>
<sec id="sec004">
<title>Adaptive OFC-PPF BMI Architecture</title>
<p>Here we derive the adaptive OFC-PPF BMI architecture (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1D</xref>). The architecture consists of two main components, a point process model of the spikes and an optimal feedback control model of the brain behavior in BMI control. In what follows, we first develop these two components and then show how to combine them to build the architecture, which consists of a point process decoder for the kinematics and decoders for each neuron’s parameters. For readers who are mainly interested in final expressions, the kinematics decoder is given in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e031">14</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1004730.e034">17</xref>) and the parameter decoder for each neuron is given in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e021">9</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1004730.e024">12</xref>).</p>
<sec id="sec005">
<title>Infinite-horizon OFC model of the brain’s control behavior in BMI</title>
<p>A BMI system can be modeled as an optimal feedback-control system [<xref ref-type="bibr" rid="pcbi.1004730.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref039">39</xref>]. Similar to natural sensorimotor control [<xref ref-type="bibr" rid="pcbi.1004730.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref042">42</xref>], when controlling a BMI, the brain (controller) selects the next neural command based on the feedback (e.g., visual) of the current state of the prosthetic device (e.g., cursor) and the task goal. For example, when moving a cursor on the computer screen towards a visual target (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1A and 1B</xref>), the goal is to reach the target and stop there. We thus model the brain in closed-loop BMI control as an optimal feedback-controller and use this model to predict the brain’s control commands during CLDA. This model can be constructed by defining an approximate forward dynamics model, quantifying the task goals as cost functions, and modeling the visual feedback. The BMI architecture uses this OFC model of the brain’s control behavior to infer the subject’s intended kinematics and to adaptively update the decoder parameter estimates.</p>
<p>We denote the sequence of kinematic states by <bold>x</bold><sub>0</sub>, ⋯ ,<bold>x</bold><sub><italic>t</italic></sub> and assume that they evolve according to the linear dynamical model
<disp-formula id="pcbi.1004730.e001"><alternatives><graphic id="pcbi.1004730.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:msub><mml:mi mathvariant="bold">u</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">w</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
This is the forward dynamics model with parameters <bold>A</bold> and <bold>B</bold> that we need to select appropriately, e.g., by fitting them based on the subject’s manual movements. Here <bold>u</bold><sub><italic>t</italic></sub> is the brain’s control command at time <italic>t</italic> and <bold>w</bold><sub><italic>t</italic></sub> is a zero-mean white Gaussian state noise with covariance matrix <bold>W</bold>, which represents the uncertainty in the forward model (in prior BMI work with Kalman filters for example, the prior model did not include the <bold>Bu</bold><sub><italic>t</italic>−1</sub> term). We denote the decoded kinematics at time <italic>t</italic>, which is displayed to the subject, by <bold>x</bold><sub><italic>t</italic>|<italic>t</italic></sub>. We assume that the subject perfectly observes <bold>x</bold><sub><italic>t</italic>|<italic>t</italic></sub>, i.e., that the visual feedback is noiseless and instantaneous. We also implicitly assume that the brain has obtained an internal forward model of the dynamics of movement in response to control commands <bold>u</bold><sub><italic>t</italic></sub> in the task. Evidence for formation of such internal models has been presented in prior studies using motor control tasks [<xref ref-type="bibr" rid="pcbi.1004730.ref042">42</xref>] and more recently using BMI tasks [<xref ref-type="bibr" rid="pcbi.1004730.ref043">43</xref>].</p>
<p>To predict the brain’s intended control command and consequently the intended kinematics, we formulate a cost function that quantifies the goal of the task and then minimize its expected value over choices of <bold>u</bold><sub><italic>t</italic></sub>. Target-directed movement trajectories during proficient control are dependent on the desired movement duration. Hence in our work on combined decoding of target and trajectory in target-directed movements and when decoder parameters were known [<xref ref-type="bibr" rid="pcbi.1004730.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref039">39</xref>], we formed a finite-horizon cost function; we then decoded the trajectory by jointly estimating the movement kinematics and its horizon (i.e., duration) from neural activity. In a CLDA technique, however, parameter estimates are poor initially and hence the decoder cannot estimate the intended kinematics accurately. Consequently, we cannot estimate the intended horizon from neural activity. Moreover, targets may not be reached during the initial trials because of poor control. Hence to develop a model of the brain’s control behavior that can be used as an intention estimator during CLDA, instead of constructing a finite-horizon cost function and decoding the horizon, we form an infinite-horizon cost function. This choice is also motivated by recent motor control studies that have suggested infinite-horizon models [<xref ref-type="bibr" rid="pcbi.1004730.ref044">44</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref046">46</xref>] as a possible alternative to the finite-horizon ones [<xref ref-type="bibr" rid="pcbi.1004730.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref041">41</xref>].</p>
<p>In our experiments, we take the state to be <bold>x</bold><sub><italic>t</italic></sub> = [<bold>d</bold><sub><italic>t</italic></sub>,<bold>v</bold><sub><italic>t</italic></sub>]<sup><italic>T</italic></sup>, where the components represent the cursor’s position and velocity in the two dimensions. Denoting the target position by <bold>d</bold>*, we form the cost function as
<disp-formula id="pcbi.1004730.e002"><alternatives><graphic id="pcbi.1004730.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:mo>∥</mml:mo> <mml:msub><mml:mi mathvariant="bold">d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:msup><mml:mo>∥</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>v</mml:mi></mml:msub> <mml:mo>∥</mml:mo> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msup><mml:mo>∥</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mo>∥</mml:mo> <mml:msub><mml:mi mathvariant="bold">u</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msup><mml:mo>∥</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where the three terms in the sum enforce positional accuracy, stopping condition, and energetic efficiency, respectively. The stopping condition is included in the cost function since the subject is required to stop at the target for 250ms. Hence a movement that just passes through the target without stopping at the target does not result in a reward. The efficiency cost puts a penalty on large velocity commands. The weights <italic>w</italic><sub><italic>r</italic></sub> and <italic>w</italic><sub><italic>v</italic></sub> can be first empirically approximated such that the OFC model produces trajectories similar to the monkey’s natural trajectories. These weights can be then validated and refined experimentally as shown in the Results section. Given the linear Gaussian state-space model in <xref ref-type="disp-formula" rid="pcbi.1004730.e001">Eq (1)</xref> and the quadratic cost function in <xref ref-type="disp-formula" rid="pcbi.1004730.e002">Eq (2)</xref>, the optimal control solution <bold>u</bold><sub><italic>t</italic></sub> at each time that minimizes the expected cost is given by a linear function of the controller’s (brain’s) estimate of the state at that time [<xref ref-type="bibr" rid="pcbi.1004730.ref047">47</xref>]. This is the standard linear-quadratic-Gaussian (LQG) solution. Given the assumption of noiseless visual feedback, the controller’s (brain’s) estimate of the state at each time is equal to the actual displayed state on the screen, <bold>x</bold><sub><italic>t</italic>|<italic>t</italic></sub>, and hence OFC-PPF solves for the intended control as
<disp-formula id="pcbi.1004730.e003"><alternatives><graphic id="pcbi.1004730.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">u</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <bold>x</bold>* = [<bold>d</bold>*,<bold>0</bold>]<sup><italic>T</italic></sup> is the target state for position and velocity, and <bold>L</bold> is the steady-state solution to the discrete form of the algebraic Riccati equation found recursively and offline [<xref ref-type="bibr" rid="pcbi.1004730.ref047">47</xref>]. This optimal feedback control policy can be interpreted as the subject’s corrective control command in response to the deviation of the visual feedback of the current prosthetic state from the target state.</p>
</sec>
<sec id="sec006">
<title>Point process model of the spikes</title>
<p>Adaptive OFC-PPF uses a point process observation model of the spiking activity in closed loop. To do so, it bins the spikes in small intervals Δ that contain at most one spike (taken to be 5ms here). This generates a discrete time-series of 0’s and 1’s (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1C</xref>). This discrete time-series is modeled as a point process [<xref ref-type="bibr" rid="pcbi.1004730.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref035">35</xref>]. The point process model enables the brain to control the BMI with every binary spike event and at a much faster time-scale compared to the commonly-used closed-loop BMI decoders, e.g., the Wiener filter or the Kalman filter. While it is possible to fit the point process parameters by designing a batch-based technique that runs on the time-scale of minutes (using the generalized-linear models (GLM) maximum likelihood methods), this would result in a slow rate of update for the parameters. Hence we use the point process modeling framework to design an algorithm that adapts the decoder parameters with every binary spike event and at a much faster time-scale compared to batch-based techniques that are often used in BMI decoders. We will demonstrate in the Results section that this spike-event-based adaptation time-scale results in much faster convergence compared to the slower time-scale of existing batch-based methods.</p>
<p>We denote the neural observations of the ensemble of <italic>C</italic> neurons by <bold>N</bold><sub>1</sub>, ⋯ ,<bold>N</bold><sub><italic>t</italic></sub> where <inline-formula id="pcbi.1004730.e004"><alternatives><graphic id="pcbi.1004730.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msub><mml:mi mathvariant="bold">N</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>t</mml:mi> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the binary spike events of the <italic>C</italic> neurons at time <italic>t</italic>. We assume that neurons’ activities are conditionally independent given the intended kinematics. Hence the point process observation model (similar to an inhomogeneous Poisson process) for the ensemble is given by [<xref ref-type="bibr" rid="pcbi.1004730.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1004730.ref035">35</xref>]
<disp-formula id="pcbi.1004730.e005"><alternatives><graphic id="pcbi.1004730.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>N</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi>Δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi>Δ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
Here Δ is the time interval used to bin the spikes, taken to be small enough to contain at most one spike, <inline-formula id="pcbi.1004730.e006"><alternatives><graphic id="pcbi.1004730.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the instantaneous firing rate of neuron <italic>c</italic> at time <italic>t</italic>, and <inline-formula id="pcbi.1004730.e007"><alternatives><graphic id="pcbi.1004730.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the model parameters for neuron <italic>c</italic> that need to be estimated via CLDA (see below). Motivated by cosine tuning models of the motor cortex [<xref ref-type="bibr" rid="pcbi.1004730.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref049">49</xref>], we take <inline-formula id="pcbi.1004730.e008"><alternatives><graphic id="pcbi.1004730.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for each neuron as a log-linear function of velocity in the two dimensions 
<disp-formula id="pcbi.1004730.e009"><alternatives><graphic id="pcbi.1004730.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <inline-formula id="pcbi.1004730.e010"><alternatives><graphic id="pcbi.1004730.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>;</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the parameter in this model. Note that this model can equivalently be written as
<disp-formula id="pcbi.1004730.e011"><alternatives><graphic id="pcbi.1004730.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo></mml:mrow> <mml:msubsup><mml:mi>β</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mo form="prefix">cos</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>p</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>θ</italic><sub><italic>t</italic></sub> is the movement direction at time <italic>t</italic>, <inline-formula id="pcbi.1004730.e012"><alternatives><graphic id="pcbi.1004730.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>p</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the preferred direction and <inline-formula id="pcbi.1004730.e013"><alternatives><graphic id="pcbi.1004730.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the modulation depth.</p>
</sec>
<sec id="sec007">
<title>Spike-event-based adaptation using OFC-PPF</title>
<p>We now combine the OFC and PPF models to develop the adaptive OFC-PPF architecture. The architecture consists of one recursive Bayesian decoder for the kinematics and one decoder for each neuron’s parameters.</p>
<p>To estimate the parameters, we need to accurately infer the intended velocity and solve for values that best describe the observed neural activity in response to this intention under the observation <xref ref-type="disp-formula" rid="pcbi.1004730.e005">model (4)</xref>. Initially, however, the output of the kinematic decoder is not an accurate estimate of the intended velocity because of poor decoder parameter estimates. Hence during the adaptation process and to estimate the parameters, we use the infinite-horizon OFC model of the brain to infer its velocity intention. All this model needs is knowledge of the task goal and of the visual feedback to the subject, which are both independent of the quality of the kinematic decoder. The visual feedback is just the decoded kinematics <bold>x</bold><sub><italic>t</italic>|<italic>t</italic></sub> and the task goal is quantified as in <xref ref-type="disp-formula" rid="pcbi.1004730.e002">Eq (2)</xref>. Hence the intended kinematics at each time, denoted by <inline-formula id="pcbi.1004730.e014"><alternatives><graphic id="pcbi.1004730.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">d</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, are found from Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e003">3</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004730.e001">1</xref>) as
<disp-formula id="pcbi.1004730.e015"><alternatives><graphic id="pcbi.1004730.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:mi mathvariant="bold">L</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:mi mathvariant="bold">L</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
The weights in the cost <xref ref-type="disp-formula" rid="pcbi.1004730.e002">function (2)</xref> can be approximately chosen such that the OFC <xref ref-type="disp-formula" rid="pcbi.1004730.e015">model (7)</xref> reaches the target with a movement duration similar to the monkey’s natural movement duration. We can also experimentally test the choice of the weights in the cost function as discussed in the Results section. We experimentally tested two different types of cost functions with different assumptions about neural mechanisms for control. These findings were used to select the BMI cost function.</p>
<p>Given the inferred velocity intention <xref ref-type="disp-formula" rid="pcbi.1004730.e015">Eq (7)</xref>, we need to fit the parameters of the point process model. One way to fit these would be to use batch-based methods [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>], such as SmoothBatch, to find the parameters of the point process model using GLM maximum-likelihood techniques [<xref ref-type="bibr" rid="pcbi.1004730.ref035">35</xref>]. For example, we can design a SmoothBatch algorithm that finds the maximum-likelihood estimate of the point process parameters in <xref ref-type="disp-formula" rid="pcbi.1004730.e009">Eq (5)</xref> in batches of 90 sec length using GLM methods, and average these batch estimates over time with a half-life of 180 sec [<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>]. However, this approach would only update the decoder parameters and improve the decoder quality on the time-scale of minutes, which is the batch length. To allow the BMI to update the decoder parameters with every spike event, we instead develop an adaptive algorithm by building a recursive Bayesian decoder for the parameters.</p>
<p>A recursive Bayesian decoder consists of a prior model on the unknown states—i.e., the tuning parameters for each neuron here—and an observation model relating the neural activity to these states. The observation model is given by <xref ref-type="disp-formula" rid="pcbi.1004730.e005">Eq (4)</xref>. We construct the prior model for the parameters of each neuron as a random-walk state-space model given by
<disp-formula id="pcbi.1004730.e016"><alternatives><graphic id="pcbi.1004730.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">q</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <bold>q</bold><sub><italic>t</italic></sub> is white Gaussian noise with covariance matrix <bold>Q</bold>. We used the random-walk prior model since it provides us with a dynamic model with minimal assumption and with adequate uncertainty. The only assumption of a random-walk model is continuity in the evolution of parameters. Moreover, the random-walk model incorporates adequate uncertainty (e.g., to account for model mismatch) through its stochastic noise term <bold>q</bold><sub><italic>t</italic></sub>.</p>
<p>The choice of <bold>Q</bold> dictates the learning rate of the adaptive decoder [<xref ref-type="bibr" rid="pcbi.1004730.ref050">50</xref>]. The development of a principled algorithm for selection of the optimal learning rate or <bold>Q</bold> is the topic of our future work [<xref ref-type="bibr" rid="pcbi.1004730.ref050">50</xref>]; this selection can be guided by the approximate lower and upper bounds on parameter values given by neurophysiological and physical constraints, and refined using experimental tuning.</p>
<p>Given the prior and the observation models, we can write the recursions of the point process decoder for the parameters, which consist of a prediction step and an update step [<xref ref-type="bibr" rid="pcbi.1004730.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref039">39</xref>]. Let’s denote the one step prediction mean by <inline-formula id="pcbi.1004730.e017"><alternatives><graphic id="pcbi.1004730.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">N</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the prediction covariance by <inline-formula id="pcbi.1004730.e018"><alternatives><graphic id="pcbi.1004730.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:msub></mml:math></alternatives></inline-formula>, the minimum mean-squared error (MMSE) estimate by <inline-formula id="pcbi.1004730.e019"><alternatives><graphic id="pcbi.1004730.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, and its covariance by <inline-formula id="pcbi.1004730.e020"><alternatives><graphic id="pcbi.1004730.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:msub></mml:math></alternatives></inline-formula>. From <xref ref-type="disp-formula" rid="pcbi.1004730.e016">Eq (8)</xref>, the prediction step of OFC-PPF for the parameters is found as
<disp-formula id="pcbi.1004730.e021"><alternatives><graphic id="pcbi.1004730.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula> <disp-formula id="pcbi.1004730.e022"><alternatives><graphic id="pcbi.1004730.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
Since the observation model is a point process, to find the update step we make a Gaussian approximation to the posterior [<xref ref-type="bibr" rid="pcbi.1004730.ref034">34</xref>]. We have provided the recursions of a general PPF in <xref ref-type="supplementary-material" rid="pcbi.1004730.s002">S2 Text</xref> and shown how the parameter decoder can be obtained from these recursions given the log-linear rate function in <xref ref-type="disp-formula" rid="pcbi.1004730.e009">Eq (5)</xref>. The update step for the instantaneous firing rate function in <xref ref-type="disp-formula" rid="pcbi.1004730.e009">Eq (5)</xref> can be found as
<disp-formula id="pcbi.1004730.e023"><alternatives><graphic id="pcbi.1004730.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:msub></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:msub></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msubsup><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula> <disp-formula id="pcbi.1004730.e024"><alternatives><graphic id="pcbi.1004730.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:msub> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where <inline-formula id="pcbi.1004730.e025"><alternatives><graphic id="pcbi.1004730.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1004730.e009">Eq (5)</xref>), and <inline-formula id="pcbi.1004730.e026"><alternatives><graphic id="pcbi.1004730.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (i.e., the intended velocity) is given as in <xref ref-type="disp-formula" rid="pcbi.1004730.e015">Eq (7)</xref>. Hence adaptive OFC-PPF estimates each neuron’s parameters at each time step using Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e021">9</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1004730.e024">12</xref>).</p>
<p>Intuitively, in the prediction step Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e021">9</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004730.e022">10</xref>) we use the random-walk state model in <xref ref-type="disp-formula" rid="pcbi.1004730.e016">Eq (8)</xref> to move the parameter estimate forward in time. Since the random-walk model enforces continuity, the predicted parameters in <xref ref-type="disp-formula" rid="pcbi.1004730.e021">Eq (9)</xref> are the same as the previous estimated parameters; but the prediction covariance in <xref ref-type="disp-formula" rid="pcbi.1004730.e022">Eq (10)</xref> is larger to account for uncertainty and model-mismatch. In the update step Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e023">11</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004730.e024">12</xref>), the estimate is found by making a correction or update to the prediction. To do so, we compare the actual spike observation at time <italic>t</italic>, <inline-formula id="pcbi.1004730.e027"><alternatives><graphic id="pcbi.1004730.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (whether 1 or 0), with the predicted probability of having a spike at time <italic>t</italic>, <inline-formula id="pcbi.1004730.e028"><alternatives><graphic id="pcbi.1004730.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (predicted because we use the predicted parameter <inline-formula id="pcbi.1004730.e029"><alternatives><graphic id="pcbi.1004730.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> to compute this probability). Note that this predicted probability is also equivalent to the predicted expected number of spikes at time <italic>t</italic>, as we have a Bernoulli random variable per bin. Hence the correction is (1- predicted probability of a spike)—or equivalently (1-predicted expected value of the number of spikes)—if a spike occurs and (0- predicted probability of a spike)—or equivalently (0-predicted expected value of the number of spikes)—if no spike occurs. If a spike occurs and the predicted probability of a spike is high, this correction is small (since our predicted parameter was probably close to the true value) and vice versa. Therefore the estimate is a combination of the prediction and the correction terms (see also <xref ref-type="supplementary-material" rid="pcbi.1004730.s003">S3 Text</xref>).</p>
<p>It is important to note that adaptive OFC-PPF does not perform joint estimation of parameters and kinematics as is done in the simulation studies in [<xref ref-type="bibr" rid="pcbi.1004730.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref051">51</xref>]. Instead, given the poor initial parameter estimates and hence the poor initial kinematic decoder, we rely on the OFC model to provide the intended kinematics to the parameter estimator as in <xref ref-type="disp-formula" rid="pcbi.1004730.e015">Eq (7)</xref>. This ensures that the poor decoded kinematics do not disrupt the adaptation of the parameters. The disruption in parameter convergence can happen as a result of joint estimation even if a goal-directed prior kinematic model is used to guide the decoded kinematics towards the target (for example the OFC goal-directed model in our assisted training paradigm; see below). This is because, unlike our approach, joint estimation requires a prior joint distribution to be placed on the kinematics and parameters. While this prior joint distribution can be pre-selected in a simulation study, it cannot be easily defined in actual BMI experiments as parameters and their uncertainty are initially unknown. But a joint estimator is sensitive to this prior joint distribution and to the relative uncertainty placed on the initial parameters and kinematics. This relative uncertainty is dictated by the relative noise covariances in the prior models of kinematics and parameters in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004730.e016">8</xref>), and by the selected covariances on their initial estimates. For example, if parameters are initially poor but not enough noise is placed on their prior model, the joint estimator will likely not converge as it assumes that the parameters are closer to the true values than they actually are; hence it will make most of the update to the decoded kinematics while assuming the wrong parameters. This worsens the estimate of the kinematic intention, which in turn further disrupts the parameter estimation. In contrast, adaptive OFC-PPF convergence does not depend on the initial kinematic decoder quality; the only way the decoded kinematics enter the adaptation process is by providing the visual feedback term in the OFC model since the monkey indeed observes these decoded kinematics regardless of their quality.</p>
<p>It is also important to note that in our architecture the estimation of each neuron’s parameters is independent of other neurons and only requires the OFC-inferred intention. Hence the parameter decoders for each neuron can run in parallel if need be, making it readily scalable to many channels of recording. Moreover, the state dimension is relatively small (3 in this work) for each parameter decoder and hence the estimation is not computationally demanding. For example, our system could be run in experiments with 20–30 neurons and 5ms bins within MATLAB even using a serial implementation of parameter decoders.</p>
</sec>
<sec id="sec008">
<title>Autonomous and dynamic assisted training using the OFC-PPF paradigm</title>
<p>To enable the BMI to perform general movements (e.g., curved jumps or straight target-directed movements), once decoder parameters converge we use a random-walk prior model (c.f. <xref ref-type="disp-formula" rid="pcbi.1004730.e030">Eq (13)</xref> with <bold>L</bold><sub><italic>a</italic></sub> = 0 and <xref ref-type="disp-formula" rid="pcbi.1004730.e043">Eq (19)</xref>) in the kinematics decoder. This random-walk prior model only enforces two general rules, which apply to many types of movements, without any additional assumptions: 1) velocity evolution in time is correlated, i.e., there is correlation between velocity vectors at two adjacent time points; 2) position is the integral of velocity. Given the poor initial parameter estimates, however, an initial random-walk kinematic decoder often generates trajectories that are far from the intended trajectories. This may result in decoded trajectories that are biased towards a specific region of space, and consequently cause slower convergence in decoder parameters by not allowing the decoder to explore the space. Moreover, this may result in low initial success rates and hence in reduced subject engagement in the task, which can consequently lead to failure in parameter convergence.</p>
<p>Here we develop a new dynamic assisted training technique within the OFC-PPF paradigm that allows the subject to explore the space even with poor initial parameters, and hence results in consistent parameter convergence across sessions. Assisted training has been used in prior studies to help subjects reach targets with a poor decoder (e.g., [<xref ref-type="bibr" rid="pcbi.1004730.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref036">36</xref>]). Current methods either add to the decoded velocity vector an assistive vector that directs straight towards the target, or subtract from the decoded velocity vector a vector perpendicular to the straight line to the target, thus attenuating the deviation. These methods often continuously or manually change the ratio of the assistive vector to the decoded vector in the sum to adjust how much assistance is provided to the subject. These ad-hoc approaches can make convergence trainer-dependent and significantly reduce robustness. Highly variable levels of assistance can also complicate the interpretation of performance during adaptation. It is, therefore, important to develop an assisted training technique that provides a systematic way to change the level of assistance before parameter convergence, and also enables a way to compute a chance level assisted performance, the comparison to which may provide a potential approach to assess user’s engagement during assistance. Moreover, while current methods often set a constant speed for the assistive vector, it is important to provide an approach to adjust the prosthetic speed systematically in a given trial. Finally, it could be beneficial to incorporate more naturalistic modulations of speed compared to current manipulations (such as adding to the decoded vector), which for example do not enforce a stopping condition at the target.</p>
<p>Our new OFC-based assisted training technique automatically and dynamically adjusts the assistance level based on subject’s performance, and can provide a way to calculate a chance level performance during assisted training; this may in turn have the potential to assess subject engagement during assistance. The assist technique automatically iterates between assist and test periods and stops assistance once proficient performance is reached. The OFC-based assisted training also automatically adjusts the speed at each time step based on the current kinematic feedback. It also enforces stopping at the target. Finally, it can be combined with the OFC-PPF spike-event-based adaptation and intention estimation in a modular fashion and does not interfere with the process of adaptation.</p>
<p>The OFC-based assisted training works by incorporating the target information in the kinematics decoder using an optimal feedback-controlled prior kinematics model instead of the random-walk model (<xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>). This results in a target-directed decoder that, in addition to enforcing continuity, reflects the subject’s goal to reach the instructed target in the decoded kinematics [<xref ref-type="bibr" rid="pcbi.1004730.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref039">39</xref>]. Specifically, we build the prior model of our target-directed decoder using Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004730.e003">3</xref>) as
<disp-formula id="pcbi.1004730.e030"><alternatives><graphic id="pcbi.1004730.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:msub><mml:mi mathvariant="bold">L</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:msub><mml:mi mathvariant="bold">L</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">w</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
Note that <bold>L</bold><sub><italic>a</italic></sub> depends on the cost function chosen in <xref ref-type="disp-formula" rid="pcbi.1004730.e002">Eq (2)</xref> for assisted training and need not be equal to <bold>L</bold>, which is used for intention estimation. Indeed, to change the level of assistance dynamically, we systematically change <bold>L</bold><sub><italic>a</italic></sub> depending on the subject’s performance as we describe below. In contrast, <bold>L</bold> for intention estimation remains constant throughout the adaptation process.</p>
<p>Given the prior state-space model in <xref ref-type="disp-formula" rid="pcbi.1004730.e030">Eq (13)</xref> and the observation model in <xref ref-type="disp-formula" rid="pcbi.1004730.e005">Eq (4)</xref>, we can find the recursions of the kinematics decoder similar to what we have derived for a feedback-controlled point process decoder for target-directed movements [<xref ref-type="bibr" rid="pcbi.1004730.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref039">39</xref>]. Let’s denote the one step prediction mean by <bold>x</bold><sub><italic>t</italic>|<italic>t</italic>−1</sub> = <italic>E</italic>(<bold>x</bold><sub><italic>t</italic></sub>|<bold>N</bold><sub>1: <italic>t</italic>−1</sub>), the prediction covariance by <bold>Λ</bold><sub><italic>x</italic><sub><italic>t</italic>|<italic>t</italic>−1</sub></sub>, the MMSE estimate that is displayed to the subject by <bold>x</bold><sub><italic>t</italic>|<italic>t</italic></sub>, and its covariance by <bold>Λ</bold><sub><italic>x</italic><sub><italic>t</italic>|<italic>t</italic></sub></sub>. Using <xref ref-type="disp-formula" rid="pcbi.1004730.e030">Eq (13)</xref>, the prediction step of OFC-PPF for the kinematics is found as
<disp-formula id="pcbi.1004730.e031"><alternatives><graphic id="pcbi.1004730.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:msub><mml:mi mathvariant="bold">L</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:msub><mml:mi mathvariant="bold">L</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula> <disp-formula id="pcbi.1004730.e032"><alternatives><graphic id="pcbi.1004730.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:msub><mml:mi mathvariant="bold">L</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:msub><mml:mi mathvariant="bold">L</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">W</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
The decoder update step for the log-linear rate function in <xref ref-type="disp-formula" rid="pcbi.1004730.e009">Eq (5)</xref> as we have shown in <xref ref-type="supplementary-material" rid="pcbi.1004730.s002">S2 Text</xref> and derived previously [<xref ref-type="bibr" rid="pcbi.1004730.ref026">26</xref>] is given by
<disp-formula id="pcbi.1004730.e033"><alternatives><graphic id="pcbi.1004730.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi mathvariant="bold">Λ</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi mathvariant="bold">Λ</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:msup><mml:msub><mml:mrow/><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi>Δ</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula> <disp-formula id="pcbi.1004730.e034"><alternatives><graphic id="pcbi.1004730.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">Λ</mml:mi> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:munderover> <mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <inline-formula id="pcbi.1004730.e035"><alternatives><graphic id="pcbi.1004730.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn mathvariant="bold">0</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, since the observation model assumes velocity tuning only and no tuning to position (see also [<xref ref-type="bibr" rid="pcbi.1004730.ref034">34</xref>] for a general treatment). Note that, as before, <inline-formula id="pcbi.1004730.e036"><alternatives><graphic id="pcbi.1004730.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are the estimated parameters found in <xref ref-type="disp-formula" rid="pcbi.1004730.e024">Eq (12)</xref>. Hence, during assisted training, adaptive OFC-PPF decodes the kinematics using Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e031">14</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1004730.e034">17</xref>). In this work we use a special case of the above by implementing a velocity PPF; this means that in the update steps in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e033">16</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004730.e034">17</xref>), we only update the velocity and set the position equal to the predicted position in <xref ref-type="disp-formula" rid="pcbi.1004730.e031">Eq (14)</xref>, which is equal to the integral of the decoded velocity (this is in the same spirit as a velocity KF; see the specific choices of <bold>A</bold> and <bold>B</bold> below).</p>
<p>Similar to the parameter recursions in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e021">9</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1004730.e024">12</xref>), these kinematic recursions are obtained from the same general form given in <xref ref-type="supplementary-material" rid="pcbi.1004730.s002">S2 Text</xref>, but this time by taking the parameters as known and decoding the kinematics instead. Since all <italic>C</italic> neurons are informative of the kinematics, the kinematic decoder incorporates all neurons’ spiking activities. For <italic>C</italic> neurons and assuming that their activities are independent conditioned on the kinematic state, the correction term simply becomes the sum of the correction terms for each neuron. In the prediction step, we use the prior model of kinematics in <xref ref-type="disp-formula" rid="pcbi.1004730.e030">Eq (13)</xref> (either assisted or non-assisted) to predict the kinematics at time <italic>t</italic> based on the estimated kinematics at time <italic>t</italic>−1. In the update step, we correct this prediction based on the difference between the spike observations of all neurons <inline-formula id="pcbi.1004730.e037"><alternatives><graphic id="pcbi.1004730.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and their predicted probability of having a spike at time <italic>t</italic>, i.e., <inline-formula id="pcbi.1004730.e038"><alternatives><graphic id="pcbi.1004730.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. This is the predicted probability since the predicted kinematics <bold>v</bold><sub><italic>t</italic>|<italic>t</italic>−1</sub> is used to compute it. Note that here we consider <inline-formula id="pcbi.1004730.e039"><alternatives><graphic id="pcbi.1004730.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> as given and decode the kinematics. The more informative the spiking activity is about the kinematics, i.e., the larger <inline-formula id="pcbi.1004730.e040"><alternatives><graphic id="pcbi.1004730.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is for a neuron, the more weight is placed on the correction term for that neuron. If the spiking activity is not informative at all for a neuron, or <inline-formula id="pcbi.1004730.e041"><alternatives><graphic id="pcbi.1004730.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, then that neuron’s spiking activity will not affect the decoded kinematics (see also <xref ref-type="supplementary-material" rid="pcbi.1004730.s003">S3 Text</xref>).</p>
<p>The assisted training paradigm can dynamically change the level of assistance. To decrease the level of assistance, we change <bold>L</bold><sub><italic>a</italic></sub> by increasing <italic>w</italic><sub><italic>v</italic></sub> and <italic>w</italic><sub><italic>r</italic></sub> in the cost function in <xref ref-type="disp-formula" rid="pcbi.1004730.e002">Eq (2)</xref>. Increasing these weights increases the time it takes for the state-space model in <xref ref-type="disp-formula" rid="pcbi.1004730.e030">Eq (13)</xref> to reach the target. A longer arrival time at the target is equivalent to a lower level of assistance since the subject would need to take the cursor to the target by relying more on its neural activity as opposed to the prior model (c.f., Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e031">14</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004730.e034">17</xref>). Motivated by [<xref ref-type="bibr" rid="pcbi.1004730.ref044">44</xref>], we pick
<disp-formula id="pcbi.1004730.e042"><alternatives><graphic id="pcbi.1004730.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mi>v</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:msup><mml:mi>τ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msub><mml:mi>w</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mi>τ</mml:mi> <mml:mn>4</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where <italic>τ</italic> is a time constant. Hence we change the level of assistance by changing this single parameter <italic>τ</italic>. As <italic>τ</italic> → ∞, <bold>L</bold><sub><italic>a</italic></sub> → <bold>0</bold>, the state-space model in <xref ref-type="disp-formula" rid="pcbi.1004730.e030">Eq (13)</xref> becomes equivalent to a random-walk state-space model, and hence assistance stops.</p>
<p>The dynamic assisted training paradigm proceeds as follows (<xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>). We first decide on a discrete set of assistance levels corresponding to a discrete set of <italic>τ</italic>’s, and on a time period to decode using each level of assisted training. We start the adaptive OFC-PPF from the highest assist level and decrease the assist level one by one while the subject is performing the task and parameters are being updated. After the time period for the lowest assist level ends, we initiate a test period in which the subject controls the BMI with no assistance, i.e., using a random-walk state-space model in <xref ref-type="disp-formula" rid="pcbi.1004730.e030">Eq (13)</xref> corresponding to <italic>τ</italic> → ∞. We evaluate the subject’s performance during this test period. Based on this non-assisted level of performance, the system decides on whether assistance should continue and if so, what level of assistance it should restart at. The process enters a new assist period and repeats until non-assisted performance exceeds a desired threshold. Note that parameter adaptation continues even after assistance stops. Indeed we can set the performance threshold, which is used to decide whether to continue the assistance, below the maximum steady-state performance that happens once parameters fully converge.</p>
<fig id="pcbi.1004730.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004730.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Adaptive OFC-PPF flow-chart.</title>
<p>(A) The architecture proceeds with decoding as follows. The decoder parameters are first initialized as desired. The architecture then starts a period of combined assisted training and spike-event-based closed-loop adaptation. Once non-assisted performance in a test period exceeds a desired threshold, assistance stops and a random-walk PPF (termed here RW-PPF) is used for control. Spike-event-based adaptation continues until performance saturates. At that point, adaptation stops and the random-walk PPF with the converged parameters is used by the subject for volitional control of movements in various tasks. The green parts of the flow-chart show the dynamic assisted training procedure. (B) The architecture during the different stages of adaptation and assisted training.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Chance level performance computation during assisted training</title>
<p>While providing assisted training, it is often difficult to assess whether subjects are engaged in the task. This is because a high level of assist could result in good performance even in the absence of volitional control by the subject. In addition to providing an automatic way to conduct dynamic assisted training, our architecture provides a way to compute the chance level performance during assisted training. The ability to compute this chance level may have the potential to assess subject engagement during assisted training in a principled manner. We calculate the chance level performance at each assistance level by running the adaptive OFC-PPF while the subject’s monitor is off and hence the subject cannot be engaged in the task. In this case, the adaptive OFC-PPF performance is purely due to the assisted state-space model. If a subject’s performance is significantly larger than the corresponding chance level performance during a given assist level, this may indicate that the subject is engaged in the task. This could in turn be useful both for identifying assist levels that enable subject engagement and for post-hoc interpretation of performance during assistance. We have shown the chance level performance with assistance in green in <xref ref-type="fig" rid="pcbi.1004730.g003">Fig 3</xref>. We can see that performance with assistance is above the 99% chance level; consistent with this, the monkey’s performance converges. In this monkey, assisted training always allowed it to converge to a good decoder. We did not observe instances of the monkey giving up with assisted training (in contrast to without assisted training). Had we observed sessions in which the decoder did not converge, it would have been interesting to confirm that the assisted performance would fall below chance level in such sessions. While in principle this computational approach to find the chance level assisted performance may allow us to assess engagement, we need additional experiments with a less motivated animal to fully test the idea. This will be the focus of our future investigations.</p>
</sec>
<sec id="sec010">
<title>State-space model for 2D cursor movements</title>
<p>While the OFC-PPF development above is general to any state-space model, in this work we pick the forward dynamics model in <xref ref-type="disp-formula" rid="pcbi.1004730.e001">Eq (1)</xref> as
<disp-formula id="pcbi.1004730.e043"><alternatives><graphic id="pcbi.1004730.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="bold">A</mml:mi> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>Δ</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>Δ</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mi>a</mml:mi></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula> <disp-formula id="pcbi.1004730.e044"><alternatives><graphic id="pcbi.1004730.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="bold">B</mml:mi> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>Δ</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>Δ</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula> <disp-formula id="pcbi.1004730.e045"><alternatives><graphic id="pcbi.1004730.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="bold">W</mml:mi> <mml:mo>=</mml:mo> <mml:mtext>diag</mml:mtext> <mml:mfenced close="]" open="["><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mi>w</mml:mi></mml:mtd> <mml:mtd><mml:mi>w</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <italic>a</italic> and <italic>w</italic> are fit to the monkey’s own end-point cursor kinematics using maximum-likelihood estimation [<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>]. Moreover, we use a velocity decoder, i.e., we decode the velocity and obtain the position deterministically by integrating the decoded velocity in each dimension using <bold>x</bold><sub><italic>t</italic></sub> = <bold>Ax</bold><sub><italic>t</italic>−1</sub>, i.e., <inline-formula id="pcbi.1004730.e046"><alternatives><graphic id="pcbi.1004730.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004730.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:mtext>horiz</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>horiz</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>horiz</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and similarly for the vertical position.</p>
</sec>
<sec id="sec011">
<title>Adaptive OFC-PPF: A fully modular closed-loop BMI architecture</title>
<p>The complete flow chart for the adaptive OFC-PPF architecture is shown in <xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>. The architecture proceeds with decoding as follows. The decoder parameters are first initialized as desired. The architecture then starts a period of combined assisted training and spike-event-based closed-loop adaptation. Once non-assisted performance exceeds a desired threshold, assistance stops and a random-walk PPF is used for control. Spike-event-based adaptation continues until performance saturates. At that point, adaptation stops and the random-walk PPF with the converged parameters is used.</p>
<p>It is important to note that the adaptive OFC-PPF architecture is fully modular. First, the intention estimation module is fully independent of the rest of the architecture. For example, one can elect to use prior methods of intention estimation [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>] without modifying any other OFC-PPF modules. The assisted training module is also fully separate from the rest of the architecture and its use is optional. In particular, OFC assisted training and intention estimation are separate modules and can use different cost functions and can be used independently. Moreover, the spike-event-based method of adaptation is a module independent of the kinematics decoder and intention estimation. For example, one can use the SmoothBatch method for updating the parameters while keeping the rest of the architecture intact.</p>
</sec>
</sec>
<sec id="sec012">
<title>Experimental Procedures</title>
<sec id="sec013">
<title>Surgery and electrophysiology</title>
<p>A male rhesus macaque (Macaca mulatta) was chronically implanted with arrays of 128 Teflon-coated tungsten microwire electrodes (35 <italic>μm</italic> diameter, 500 <italic>μm</italic> spacing, 8 × 16 configuration; Innovative Neurophysiology, Durham, NC). The arrays targeted the arm and hand areas of the primary motor cortex (M1) and dorsal premotor cortex (PMd) of each hemisphere. Localization of target areas was performed using stereotactic coordinates and implants were typically positioned at a depth of 2.5 <italic>mm</italic>.</p>
<p>Neural activity was recorded using a 128-channel MAP system (Plexon, Inc., Dallas, TX, USA). For real-time BMI control, channel-level activity was used, which was defined by setting thresholds for each channel (5.5 standard deviations from the mean signal amplitude) and using online sorting software to define unit templates that captured all incoming neural activity on the channel. Thresholds were set at the beginning of each session based on 1–2 min of neural activity recorded as the animal sat quietly. After defining channel thresholds, the online sorting client was used to define unit templates. Templates were typically defined that captured all threshold crossings. In the rare event that channel-level activity showed clearly separable units that could not be adequately captured in a single sorting template, the channel was split into two units. The use of templates allowed for real-time rejection of non-neuronal artifacts during BMI sessions. BMI was controlled by 15–20 multi-units on each day. We used 5ms as we found that more than 1 spike rarely occurred within a single 5ms bin (less than 0.6% of the bins).</p>
<p>All procedures were conducted in compliance with the National Institutes of Health Guide for the Care and Use of Laboratory Animals and were approved by the University of California, Berkeley Institutional Animal Care and Use Committee.</p>
</sec>
<sec id="sec014">
<title>Decoder initialization</title>
<p>Decoder parameters were initialized either by fitting them using neural activity recorded as the subject passively viewed a cursor moving through the center-out task during a visual feedback session (referred to as visual feedback seed) [<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>], or they were initialized arbitrarily by randomly permuting the visual feedback seed across neurons.</p>
</sec>
<sec id="sec015">
<title>Behavioral tasks</title>
<p><italic>Center-out task.</italic> The monkey performed a self-paced delayed center-out reaching task under BMI control (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1A and 1B</xref>). During BMI control, its arm was confined within a primate chair. Trials were initiated by moving to the center target. Upon entering the center, one of eight peripheral targets appeared. After a brief hold, a “go” cue (center target changing color) indicated to the subject to initiate a reach to the peripheral target. Successful trials required a movement to and brief hold at the central target to initialize a trial, followed by a movement to and brief hold at the peripheral target, and were rewarded by a liquid reward. Failure to acquire the target within a specified window or to hold the cursor within the target for the duration of the hold period resulted in an error, and the trial was repeated. To meet the hold requirement, the monkey had to maintain the cursor within the target for the full hold period upon entering it; this is stricter than some prior tasks [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>] since the subject had no opportunity to correct for exiting the target before the completion of the hold period. The monkey had to actively return the cursor to the center to initialize new trials after success or failure. Target directions were presented in a blocked pseudo-randomized order. Targets were circular with 1.2 cm radius and were uniformly distributed about a circle of 13 cm diameter. Hold time requirements at the center and at the targets were 250 ms and the subject had 3–10 s to complete the movement from the central to the peripheral target.</p>
<p><italic>Target-jump task.</italic> The monkey also performed a target-jump task that consisted of the normal center-out trials interleaved with jump trials. In one type of target-jump task, a jump trial occurred with a probability of 25% and in it the target changed randomly to one of the other 7 targets 500 ms after the cursor left the center. In the other type of target-jump task, a jump trial occurred with a probability of 17% and could be one of 5 jump types (displayed later in Figures in Results); again the jump occurred 500 ms after the cursor left the center.</p>
<p><italic>Target-to-target task.</italic> The monkey also performed a target-to-target movement task in one session. This task required the monkey to perform a point-to-point movement similar to the center-out task. However, this time, there was no center target and the initial and end target locations could be different from the center-out task (displayed later in Figures in Results).</p>
</sec>
<sec id="sec016">
<title>Behavioral metrics</title>
<p>BMI performance was quantified using both task-level and kinematic metrics. The main task metric used was success rate (number of successful trials completed per minute), which takes into account both speed and accuracy. We also calculated the trial percent correct (percentage of initiated trials resulting in success). Steady-state success rate was calculated over the best ten minutes of a session and steady-state percent correct was calculated over the best 100 trials per session for all decoders to minimize the effect of motivation variation. In addition to steady-state success rate, we also assess decoder adaptation via the success rate evolution over time by calculating it in non-overlapping 2 min windows. Movement kinematics were quantified using movement error and reach time metrics. Movement error for a given trial was defined as the average perpendicular deviation from a straight-line reach between the central and peripheral target. Reach time was calculated as the time from leaving the central target to arriving at the peripheral target. Average reach time and movement error metrics for a session were calculated in the same manner as the percent correct metric.</p>
</sec>
</sec>
</sec>
<sec id="sec017" sec-type="results">
<title>Results</title>
<p>We implemented the adaptive OFC-PPF architecture and dissociated the effect of each of the novel modeling components by performing various closed-loop experiments with a non-human primate. The monkey performed a total of 89 days of experiments with the decoder. <xref ref-type="fig" rid="pcbi.1004730.g003">Fig 3</xref> shows the result of the full process of adaptive OFC-PPF in an example session from initialization, to assisted training and adaptation, and finally to steady-state control (see also <xref ref-type="supplementary-material" rid="pcbi.1004730.s005">S1 Fig</xref> for performance over time after assisted training stops). This figure also shows randomly selected BMI trajectories after adaptation stops and the trained random-walk PPF is used for control by the monkey. In our experiments, we evaluated the adaptive OFC-PPF’s novel CLDA components. In particular, we evaluated the OFC model for intention estimation, the new assisted training algorithm, the spike-event-based method of adaptation, and the extendibility of the architecture to the target-jump and target-to-target tasks.</p>
<fig id="pcbi.1004730.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004730.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Performance over the process of adaptive OFC-PPF.</title>
<p>(A) Success rate as a function of time from the start of the experiment in one session. Success rate is calculated in sliding 2 min windows. The decoder was initialized using a visual feedback seed. Adaptive OFC-PPF was then run as described in the flow-chart in <xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>. The architecture started by providing assisted training and adaptation. After the first assist period, which consisted of 3 discrete assist levels, performance in the test period exceeded the desired threshold of 5 trials/min and hence the architecture stopped the assisted training (vertical dashed black line). We stopped the adaptation at the vertical dashed blue line, after which the trained point process model was used in a random-walk PPF to control the cursor. Green lines show the 99% upper bound on the chance level performance during the assisted training. Assisted performance is above the 99% chance level. The horizontal dashed line shows the mean manual task performance with the arm on that day. (B) Randomly selected center-out trials on this day after adaptation stopped.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.g003" xlink:type="simple"/>
</fig>
<sec id="sec018">
<title>Selecting the OFC Model for Intention Estimation</title>
<p>The OFC intention estimation model that we have proposed here can be adjusted by changing the dynamic state-space model in <xref ref-type="disp-formula" rid="pcbi.1004730.e001">Eq (1)</xref> and the cost function in <xref ref-type="disp-formula" rid="pcbi.1004730.e002">Eq (2)</xref>. For any prosthetic device with a given dynamic state-space model, once the task goal is chosen, OFC can be used for intention estimation. This may thus provide a general method for intention estimation in different BMI setups. Here for 2D cursor movements, we tried two candidate classes of OFC models for intention estimation. First, we tried a naturalistic OFC model (N-OFC) in which <italic>a</italic> in <xref ref-type="disp-formula" rid="pcbi.1004730.e043">Eq (19)</xref> was fit to the monkey’s own naturalistic cursor movement and in which the cost function was defined as in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004730.e002">2</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004730.e042">18</xref>). Second, we tried an OFC model, termed instant-OFC, that assumed the monkey’s control command directly sets the intended velocity, i.e., that <italic>a</italic> = 0 in <xref ref-type="disp-formula" rid="pcbi.1004730.e043">Eq (19)</xref>. Consequently, in the latter model we set <italic>ω</italic><sub><italic>v</italic></sub> = 0 in <xref ref-type="disp-formula" rid="pcbi.1004730.e042">Eq (18)</xref> since in this case <italic>u</italic><sub><italic>t</italic></sub> is equivalent to the intended velocity and hence a non-zero <italic>w</italic><sub><italic>r</italic></sub> is sufficient to both enforce the stopping condition and impose the control cost.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004730.g004">Fig 4A and 4B</xref> show two sample decoded trajectories, the decoded velocities, and the inferred intended velocities by the N-OFC and the instant-OFC models. The N-OFC model’s inferred intended velocity direction and speed depend on the feedback of both the decoded position and the decoded velocities. The assumption in the N-OFC model is that the monkey intends to gradually change the velocity vector towards the target as opposed to immediately. This is enforced by the non-zero <italic>a</italic> that models the correlation between two adjacent velocity vectors in time. In contrast to N-OFC, the instant-OFC model assumes that the intended velocity need not be correlated with the current velocity (<italic>a</italic> = 0). Hence both its intended velocity direction and speed are mainly dependent on the feedback of the decoded position.</p>
<fig id="pcbi.1004730.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004730.g004</object-id>
<label>Fig 4</label>
<caption>
<title>OFC intention estimation results in higher PPF performance.</title>
<p>(A, B) Sample decoded trajectories (black), the decoded velocities (orange), and the inferred intended velocities by the N-OFC model (magenta) and the instant-OFC model (blue) on the <italic>right</italic> and by the existing CursorGoal method of intention estimation (red) [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>] on the <italic>left</italic>. The latter method [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>] obtains the intended velocity by rotating the decoded velocity vectors towards the target while keeping their speed unchanged (the speed is set to zero at the target). Since the instant-OFC model outperformed the N-OFC model, we used the former for intention estimation. (C) Steady-state performance of the PPF decoder trained using the OFC method of intention estimation (blue) vs. the CursorGoal method of intention estimation (red). Bars indicate average values and error bars indicate s.e.m..</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.g004" xlink:type="simple"/>
</fig>
<p>We ran experiments over a total of 18 sessions in which a PPF decoder was trained using either the N-OFC model or the instant-OFC model. We compared the steady-state performance of these two PPF decoders. We found that for 2D cursor movements, using the instant-OFC model compared with the N-OFC model resulted in a PPF decoder that improved success rate by 21% (one-sided <italic>t</italic>-test, <italic>P</italic> &lt; 10<sup>−4</sup>). Movement error and reach times using the instant-OFC model also improved by 6% (one-sided <italic>t</italic>-test, <italic>P</italic> &lt; 0.09) and 15% (one-sided <italic>t</italic>-test, <italic>P</italic> &lt; 10<sup>−3</sup>), respectively (<xref ref-type="supplementary-material" rid="pcbi.1004730.s008">S1 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1004730.s006">S2 Fig</xref>). We also found that the improvement in performance for the instant-OFC model was not due to a simple increase in speed; on average the maximum speed when the decoder was trained with the N-OFC model did not change significantly compared to when it was trained using the instant-OFC model (two-sided <italic>t</italic>-test, <italic>P</italic> = 0.55). This may suggest that the instant-OFC model better captures the user’s control strategy. We thus elected to use the instant-OFC model for intention estimation in this study. Hence OFC-PPF in the remainder of this paper refers to a PPF that was trained with the instant-OFC model.</p>
</sec>
<sec id="sec019">
<title>OFC Intention Estimation Improves the Performance of the PPF Decoder</title>
<p>To examine the effect of using the OFC intention estimation on the steady-state performance of the PPF decoder, we performed experiments that dissociated its effect and compared it to the state-of-the-art method of intention estimation, i.e., CursorGoal [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>]. In particular, in addition to running experiments in which we converged the PPF decoder with the adaptive OFC-PPF, we also ran experiments in which we converged the PPF with exactly the same adaptive approach except for using the CursorGoal method of intention estimation in place of OFC (<xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>). The CursorGoal method infers the intended velocity direction by rotating the decoded velocity vector towards the target, while setting the intended speed equal to the decoded speed before reaching the target and to zero at the target. We call the PPF decoder trained using the CursorGoal method of intention estimation, CursorGoal-PPF. <xref ref-type="fig" rid="pcbi.1004730.g004">Fig 4A and 4B</xref> show the inferred velocity intentions used in the CursorGoal-PPF for two sample decoded trajectories. These inferred velocities are directed straight towards the target; thus the inferred velocity direction in this case depends only on the current position. Moreover, this method does not infer the speed intention and sets it equal to the decoded speed. Hence a major difference between the instant-OFC model we elected to use and the existing CursorGoal method of intention estimation [<xref ref-type="bibr" rid="pcbi.1004730.ref020">20</xref>] is that the former infers the speed intention in contrast to the latter that does not infer the speed intention.</p>
<p>We compared the steady-state performance between 12 days with OFC-PPF and 12 days with CursorGoal-PPF (<xref ref-type="fig" rid="pcbi.1004730.g004">Fig 4C</xref>). We found that using the OFC intention estimation significantly improved the performance of PPF decoder (<xref ref-type="supplementary-material" rid="pcbi.1004730.s008">S1 Table</xref>), increasing success rate by 26% (one-sided <italic>t</italic>-test, <italic>P</italic> &lt; 10<sup>−6</sup>). Also, reach times were 24% shorter with OFC-PPF compared with CursorGoal-PPF (one-sided <italic>t</italic>-test, <italic>P</italic> &lt; 10<sup>−5</sup>), and maximum speeds with OFC-PPF were higher by 6% compared to CursorGoal-PPF (one-sided <italic>t</italic>-test, <italic>P</italic> &lt; 0.002). Finally, movement error and accuracy did not change significantly between the two decoders (two-sided <italic>t</italic>-test, <italic>P</italic> &gt; 0.6). These results indicate that the monkey could control the OFC-PPF significantly faster than CursorGoal-PPF without a cost on movement error or accuracy. In addition to performance improvement, a principal advantage of using an explicit model of the brain for intention estimation is its ability to extend to prosthetics with various dynamics, simply by incorporating their dynamic model in the OFC formulation (see <xref ref-type="sec" rid="sec024">Discussion</xref>).</p>
</sec>
<sec id="sec020">
<title>OFC Assisted Training Results in Consistent Parameter Convergence</title>
<p>We found that assisted training enabled the monkey to achieve proficient control consistently across days. This was in contrast to days in which assisted training was not applied. Initially during the experiments, we adapted the PPF decoder using the method of SmoothBatch and without the assisted training paradigm. We performed 8 days of experiments in which we initialized the decoder using visual feedback seeds. We found that in 3 of these 8 days, the monkey was unable to converge to proficient control and hence discontinued playing the task. In many cases, the cursor initially got stuck at the boundaries or corners of the workspace and hence was not able to explore the space. In contrast, in tens of days that adaptation was performed with assisted training, whether using the method of SmoothBatch or using continuous spike-event-based adaptation, the monkey always achieved proficient control eventually (see below for comparison of the speed of convergence between SmoothBatch and spike-event-based adaptation). These results suggest that assisted training was essential in keeping the subject engaged and in exploring the space so that decoder parameters could converge.</p>
</sec>
<sec id="sec021">
<title>Spike-Event-Based Adaptation Results in Faster and More Consistent Performance Convergence</title>
<p>We investigated whether fast spike-event-based parameter adaptation for the PPF decoder can increase the speed of convergence compared to batch-based methods that update the parameters on the slower time-scale of minutes. To do so, we performed experiments to dissociate the effect of the time-scale of adaptation. In particular, in addition to running experiments in which we trained the PPF using the spike-event-based adaptation method, we also ran experiments in which we trained it with slower adaptation time-scales using the method of SmoothBatch [<xref ref-type="bibr" rid="pcbi.1004730.ref021">21</xref>], while keeping all the other components of the algorithm the same (<xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>). SmoothBatch adapts the parameters smoothly once every 90 sec (see <xref ref-type="sec" rid="sec002">Methods</xref>). We refer to this decoder as SmoothBatch OFC-PPF. We compared the speed of performance convergence using SmoothBatch OFC-PPF and adaptive OFC-PPF by finding the time it took these decoders to reach 90% of the maximum performance. <xref ref-type="fig" rid="pcbi.1004730.g005">Fig 5A</xref> shows the performance convergence using SmoothBatch OFC-PPF and adaptive OFC-PPF in consecutive days in which parameters were initialized to the same values (see also <xref ref-type="supplementary-material" rid="pcbi.1004730.s007">S3A Fig</xref>). Performance converged faster in adaptive OFC-PPF compared to SmoothBatch OFC-PPF in these days. This result held on average across all days as demonstrated in <xref ref-type="fig" rid="pcbi.1004730.g005">Fig 5B and 5C</xref> (see also <xref ref-type="supplementary-material" rid="pcbi.1004730.s009">S2 Table</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004730.s007">S3B and S3C Fig</xref>). Across 12 days of experiments with each decoder, while the eventual steady-state success rate was the same (two-sided <italic>t</italic>-test; <italic>P</italic> = 0.35), adaptive OFC-PPF converged much faster to this steady-state level compared with SmoothBatch OFC-PPF. In particular, across 12 days, success rate in SmoothBatch OFC-PPF converged in 18.7±3.2 min (mean ± s.e.m.). In comparison and across 12 days, success rate in adaptive OFC-PPF converged in 6.5±0.7 min, which was significantly faster than SmoothBatch OFC-PPF (one-sided <italic>t</italic>-test; <italic>P</italic> &lt; 10<sup>−3</sup>). Hence adaptive OFC-PPF resulted both in faster convergence and in more consistent speed of convergence as indicated by the lower s.e.m. across days. Moreover, assisted training in 2 of the 12 days for SmoothBatch OFC-PPF had to reinitiate after the test period and went on to a second assist period (<xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>). In comparison, using adaptive OFC-PPF, assisted training always stopped after the first test period since the performance had already exceeded the threshold success rate of 5 trials/min (<xref ref-type="fig" rid="pcbi.1004730.g005">Fig 5</xref>).</p>
<fig id="pcbi.1004730.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004730.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Spike-event-based adaptation enables faster convergence.</title>
<p>(A) Performance over time for adaptive OFC-PPF (solid) and SmoothBatch OFC-PPF (dashed) run on two sets (red and blue) of two consecutive days that started from the same initial parameters. Vertical lines show the time point where assistance stopped as the subject’s non-assisted success rate in the test period at that point exceeded the desired minimum threshold of 5 trials/min. Success rate is calculated in sliding 2 min windows. (B, C) Average success rate across sessions as a function of time into the adaptive session for SmoothBatch OFC-PPF in (B) and Adaptive OFC-PPF in (C). Blue curves show the mean success rate over 12 days of experiments for each decoder and shading reflects the standard deviation across these days. The red bar shows the time range in which the BMI architecture stopped the assisted training across days. Spike-event-based adaptation resulted in faster convergence and less variability compared with SmoothBatch adaptation that updated the decoder parameters on a slower adaptation time-scale, i.e., once every 90 seconds.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec022">
<title>Adaptive OFC-PPF Results in Proficient BMI Control Even from a Poor Initial Decoder</title>
<p>We also investigated whether adaptive OFC-PPF could converge to a proficient decoder when starting from a poor initial decoder. First, we found that this monkey was not able to control the BMI using a visual feedback seed decoder (i.e., a decoder whose parameters were found from the neural activity collected during a training session in which cursor movements were visually displayed to the monkey). Success rate using a PPF decoder that used the visual feedback parameters was 0 across all days tried (the monkey soon lost motivation using this decoder, which indeed motivated the design of the assisted training paradigm). Hence across tens of days, adaptive OFC-PPF could always result in proficient performance in this monkey in spite of starting from a poor initial decoder (i.e., the visual feedback seed decoder). To further examine the robustness of adaptive OFC-PPF to initialization, we ran 2 days of experiments in which we started the adaptive OFC-PPF once from a visual feedback seed and once from a seed that was obtained by randomly permuting the visual feedback seed across neurons. We found that adaptive OFC-PPF resulted in proficient control starting from the permuted seed. Moreover, success rate, movement error, percent correct, and reach times did not change significantly between the two converged decoders (two-sided <italic>t</italic>-test; <italic>P</italic> &gt; 0.16; <xref ref-type="fig" rid="pcbi.1004730.g006">Fig 6A</xref>). For example, average success rate for the visual feedback and permuted visual feedback seeds were 14.6 ± 1.8 vs. 14.45 ± 2.3 trials/min, respectively.</p>
<fig id="pcbi.1004730.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004730.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Adaptive OFC-PPF is robust to initialization.</title>
<p>(A) Performance over time for adaptive OFC-PPF that was initialized once using a visual feedback seed and once using a permuted visual feedback seed on the same day. Vertical dashed lines show the time point at which the architecture stopped the assisted training. Regardless of the initial seed, performance converges to similar values in these two sessions. Note that initial performance of both visual feedback and permuted visual feedback seeds were poor and hence assistance was used to allow the subject perform the task initially as parameters were adapting. (B–D) Convergence of the point process parameters for an example neuron as a function of time, when starting from the two different seeds. The baseline firing rate is shown in (B) and <italic>α</italic><sup><italic>c</italic></sup> for the velocity components in the two dimensions are shown in (C) and (D) (see <xref ref-type="disp-formula" rid="pcbi.1004730.e009">Eq (5)</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.g006" xlink:type="simple"/>
</fig>
<p>We also examined the convergence of decoder parameters starting from the visual feedback and permuted visual feedback seeds using adaptive OFC-PPF (<xref ref-type="fig" rid="pcbi.1004730.g006">Fig 6B–6D</xref>). On the days in which we started adaptive OFC-PPF once from each of these two seeds, we calculated the difference between the estimated parameters in the two cases as a function of time into the adaptive session. We found that this difference was significantly reduced at the end of the adaptive session compared to the start of this session (paired <italic>t</italic>-test; <italic>P</italic> &lt; 0.05). This suggests that the parameters converged to similar values regardless of the initial seed (<xref ref-type="fig" rid="pcbi.1004730.g006">Fig 6B–6D</xref>). In particular, for the baseline firing rate and <italic>α</italic><sup><italic>c</italic></sup> parameters of each neuron (c.f. <xref ref-type="disp-formula" rid="pcbi.1004730.e009">Eq (5)</xref>), this difference at the start of the session was on average 5.3 and 5.6 times larger than at the end of the session, respectively (see <xref ref-type="supplementary-material" rid="pcbi.1004730.s004">S4 Text</xref> for details of calculation).</p>
</sec>
<sec id="sec023">
<title>Adaptive OFC-PPF Extends to Other Tasks</title>
<p>We also investigated whether adaptive OFC-PPF could extend to tasks beyond the standard center-out target-directed task used for CLDA training. The computational element that allows for this extendability after adaptation is complete is the flexible prior model placed on the kinematics in the PPF (see <xref ref-type="disp-formula" rid="pcbi.1004730.e030">Eq (13)</xref>). After the decoder is trained and assisted training stops (i.e., when <bold>L</bold><sub><italic>a</italic></sub> = 0), we use a random-walk prior model on kinematics that only constrains the kinematics thorough the dynamic matrix <bold>A</bold> in <xref ref-type="disp-formula" rid="pcbi.1004730.e043">Eq (19)</xref>. The <bold>A</bold> matrix just enforces two general rules: 1) velocity evolution in time is correlated, i.e., there is correlation between velocity vectors at two adjacent time points, 2) position is the integral of velocity. These general constraints hold for various types of movement (e.g., straight movements or curved movements). Here we ran closed-loop experiments and showed that the new CLDA technique could enable extension to other tasks.</p>
<p>Using a decoder trained with adaptive OFC-PPF, we had the monkey perform a target-jump task across 7 sessions. In this task, in a random selection of center-out trials, the target jumped to one of the other 7 targets 500ms after the cursor left the center (see <xref ref-type="sec" rid="sec002">Methods</xref>; <xref ref-type="fig" rid="pcbi.1004730.g007">Fig 7A</xref>). The monkey achieved proficient control in the target-jump task (<xref ref-type="fig" rid="pcbi.1004730.g007">Fig 7A</xref>). In particular, while the target-jump trials were harder to perform, monkey’s accuracy (percent correct) on these trials was only slightly lower than the normal center-out trials in the same sessions, i.e., 88% vs. 92% (<xref ref-type="supplementary-material" rid="pcbi.1004730.s010">S3 Table</xref>). The monkey achieved a success rate of 13.9±0.4 trials per minute on the target-jump task across sessions (note that jumps require moving a longer distance compared to center-out trials; for example, on the same days the monkey’s success rate on the center-out task was 15.08±0.3 in comparison).</p>
<fig id="pcbi.1004730.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004730.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Adaptive OFC-PPF extends to tasks beyond those used for CLDA training.</title>
<p>(A) Sample random trajectories in the target-jump task. Gray circle shows the initial target and cyan circle shows the eventual target after the jump occurred. The unfilled circle on the trajectory shows the time at which the jump occurred. The monkey used a random-walk PPF trained on the center-out task to perform this target-jump task. (B) Sample random trajectories in the target-to-target task. Each trial type consisted of a start target and an end target. Instead of going from the center to one of eight peripheral targets in the center-out task, here the monkey had to move the cursor from one target to another target (whose locations could also differ from those in the center-out task).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.g007" xlink:type="simple"/>
</fig>
<p>In addition to the target-jump sessions, the monkey performed a target-to-target movement task in one session. This task required the monkey to perform a point-to-point movement similar to the center-out task (i.e., movement to and brief hold at an initial target, followed by movement to and brief hold at a terminal target). However, this time, there was no center target and the initial and end target locations could be different from the center-out task (<xref ref-type="fig" rid="pcbi.1004730.g007">Fig 7B</xref>). The monkey again achieved proficient control on this task reaching a success rate of 13.2 trials per minute and an accuracy of 90%.</p>
</sec>
</sec>
<sec id="sec024" sec-type="conclusions">
<title>Discussion</title>
<p>Significant progress has been made in BMI development by combining Kalman filters with CLDA techniques. However, current decoders such as Kalman filters may limit the time-scale at which the brain can control the prosthetic and the time-scale at which decoder parameters can be adapted. Time-scales of control and adaptation may significantly affect BMI performance. Hence developing decoders that are not limited to a particular time-scale because of modeling assumptions provides a powerful tool to investigate these effects (<xref ref-type="supplementary-material" rid="pcbi.1004730.s001">S1 Text</xref>). Moreover, while various successful CLDA approaches have been used in different studies, a unified CLDA framework for intention estimation, assisted training, and adaptation is lacking. Here we propose a novel CLDA architecture for training a PPF BMI in closed-loop operation, which consists of two main computational components: 1. A general unified control-theoretic OFC framework for (i) intention estimation and (ii) assisted training, 2. Dynamic spike-event-based adaptation as opposed to batch-based adaptation. This architecture allows an arbitrarily fast time-scale for spike processing in control and adaptation, and incorporates a general unified control-theoretic CLDA framework. We use the architecture to investigate the effects of the time-scale of adaptation and of the OFC framework on closed-loop decoder training. Using closed-loop experiments in a rhesus monkey over 89 days, we dissociated the effect of the novel components of our CLDA framework, i.e., the OFC method of intention estimation, the OFC method of assisted training, and the spike-event-based time-scale of adaptation in training a PPF. In summary, our paradigm produced improvements on two fronts: 1) spike-event-based adaptation and assisted training improved the speed and ease of decoder convergence during training, and 2) OFC intention estimation resulted in higher performance PPF decoders after training was complete. Overall, the BMI architecture—termed adaptive OFC-PPF—enabled robust performance and extended control to various tasks.</p>
<p>The architecture is based on an infinite-horizon optimal feedback-control model of brain behavior in closed-loop BMI control and a point process model of the spiking activity (<xref ref-type="fig" rid="pcbi.1004730.g001">Fig 1</xref>). The OFC model infers the brain’s intention during the process of adaptation. This OFC model is also used to develop a new assisted training technique, which allows for dynamic and automated assisted training. The assisted training technique also enables the calculation of a chance level performance during assisted training; this may provide a potential approach to evaluate subject engagement during assistance by comparing to this chance level. Thus OFC modeling of brain behavior provides a unified framework for intention estimation and assisted training. The point process model allows subjects to control the BMI with every spike event, and enables the BMI to adapt its parameters with every spike event. The architecture is also fully modular (<xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>).</p>
<p>Our closed-loop experiments in a non-human primate dissociated the advantage of each of the architecture modeling components. We first dissociated the effect of the OFC intention estimation by comparing OFC-PPF with CursorGoal-PPF at steady state. We found that using the OFC model for intention estimation results in a PPF with higher steady-state success rate compared with current intention estimation techniques (i.e., CursorGoal; <xref ref-type="fig" rid="pcbi.1004730.g004">Fig 4</xref>); this suggests that the former better estimates the brain’s control strategy. We dissociated the effect of the OFC assisted training by comparing OFC-PPF with assisted training turned off or on. We found that the automated assisted training technique results in consistent performance convergence across days by allowing the decoder to explore the space and by keeping the subject motivated. We dissociated the effect of spike-event-based adaptation by comparing SmoothBatch OFC-PPF with adaptive OFC-PPF during decoder training. We showed that fast spike-event-based adaptation results in faster performance convergence compared with existing batch-based methods, which have a slower adaptation time-scale (<xref ref-type="fig" rid="pcbi.1004730.g005">Fig 5</xref>). We also found that the architecture is robust to initialization of parameters (<xref ref-type="fig" rid="pcbi.1004730.g006">Fig 6</xref>). Finally, we showed that adaptive OFC-PPF results in a decoder that extends to tasks beyond those used for CLDA (<xref ref-type="fig" rid="pcbi.1004730.g003">Fig 3</xref>), in particular a target-jump task and a  target-to-target task (<xref ref-type="fig" rid="pcbi.1004730.g007">Fig 7</xref>).</p>
<p>While we implemented the OFC model for intention estimation in spike-based BMIs and to fit a point process observation model, the OFC intention estimation technique can also be used for other signal modalities or observation models. These include local field potentials or electrocorticography (ECoG) signals, which can be modeled as a Gaussian process. In these cases, the estimated intention would be used to fit a Gaussian model of neural activity in an appropriate decoder such as a Kalman filter. Moreover, the OFC models the brain’s strategy in closed-loop control of a prosthetic. Since the brain is the controller of movement in any BMI setup, the OFC framework could generalize to various BMI setups by simply quantifying the corresponding prosthetic’s dynamics and the task goals within the OFC’s state-space model and cost function, respectively.</p>
<p>The OFC assisted training technique is also not specific to a point process. We can, for example, extend this framework to provide assisted training in a Kalman filter BMI by using the OFC state-space model as the prior kinematic model in the Kalman filter. The dynamic assisted training will otherwise be identical to the one used in combination with a point process observation model here (<xref ref-type="fig" rid="pcbi.1004730.g002">Fig 2</xref>).</p>
<p>In this work we used a 5ms bin-width to generate the 0 and 1 time-series of the spikes. This was because in our case more than 1 spike rarely occured within a single bin. In the PPF decoder we use a discrete-time point process as an approximation to a continuous-time point process. This approximation is reasonable as long as the bins are small enough to contain at most 1 spike [<xref ref-type="bibr" rid="pcbi.1004730.ref035">35</xref>]. If in a scenario units or multiunits are recorded with higher firing rates such that there is a considerable probability of having more than 1 spike per 5ms bin, then smaller bin-widths should be used to get a discrete-time point process, which is a good approximation to the continuous-time point process.</p>
<p>An important observation in the BMI field is that the brain can adapt to control a BMI decoder over time [<xref ref-type="bibr" rid="pcbi.1004730.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref028">28</xref>]. Neural plasticity can result in changes in neural firing properties (e.g., directional tuning) that yield improved BMI performance. Closed-loop decoder adaptation also introduces an additional adaptive element into the BMI, creating a “two-learner system”. Neural and decoder adaptation can interact [<xref ref-type="bibr" rid="pcbi.1004730.ref028">28</xref>], raising the possibility for interference between these two learning elements. Neural plasticity is most robustly observed with slowly-varying or fixed decoders [<xref ref-type="bibr" rid="pcbi.1004730.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004730.ref028">28</xref>]. A potential concern, then, is that the high frequency of adaptation and control in the OFC-PPF could disrupt neural plasticity. More broadly, how decoder control and adaptation time-scales influence neural plasticity is currently unknown. We therefore devised a set of experiments to examine neural learning effects. We ran an additional experiment with this monkey over 14 days with a semi-stationary neural ensemble using the adaptive OFC-PPF. On each day, adaptation was run for 5–15 minutes starting from the previous day’s decoder. The monkey showed gradual performance improvement over these days, with increased success rate and reduced movement error. These results suggest that learning can indeed occur while the monkey controls a PPF adapted with the spike-event-based adaptation paradigm; thus adaptive OFC-PPF can indeed be combined with brain learning to improve neuroprosthetic control. Detailed data related to the learning experiment are presented elsewhere [<xref ref-type="bibr" rid="pcbi.1004730.ref028">28</xref>]. The examination of how the time-scales of neural and decoder adaptation may interfere in other scenarios from a theoretical perspective is important in future studies [<xref ref-type="bibr" rid="pcbi.1004730.ref052">52</xref>].</p>
<p>Another important problem to investigate is the selection of the learning rate in CLDA algorithms. The learning rate is a critical parameter of any adaptive algorithm and is currently selected in an ad-hoc manner and by trial and error in CLDA-based BMIs. The learning rate in adaptive OFC-PPF is dictated by the noise covariance in the state model of the parameter decoder. Developing principled methods for optimal selection of this learning rate will be the topic of our future investigation [<xref ref-type="bibr" rid="pcbi.1004730.ref050">50</xref>].</p>
<p>The point process model allows subjects to control the BMI and receive feedback at a much faster time-scale than a Gaussian model used in Kalman filters. In this work, we focused on developing the novel closed-loop point process BMI training architecture that is fully modular, adaptive and robust, and can extend control to various tasks. While outside the scope of this work, it is important to investigate whether the PPF can be controlled better than the Kalman filter by using the point process neural encoding model and by providing the fast time-scale of control, which in turn increases the rate of control and feedback. For example, it may indeed be that the faster time-scale of control results in more accurate control. Moreover, the spiking activity that any BMI algorithm uses as its input is fundamentally a sequence of spike events, or zeros and ones, which indicate the time-points at which the spikes occur. The larger bins used in prior decoders just preprocess this spiking signal first, and then use the preprocessed signal (e.g., the count of spikes within the bin) to decode movement intention. As the data processing inequality in information theory states [<xref ref-type="bibr" rid="pcbi.1004730.ref053">53</xref>], preprocessing data cannot add information. Hence processing the spikes directly with an optimal filter specifically designed for the zero and one spike events could extract the maximal amount of information from the spikes. This, along with the faster update rates, may result in performance improvements. To examine questions related to performance comparisons, novel experiments are needed to dissociate the effects of control rate, feedback rate, and the mathematical encoding model on BMI control. This will be the subject of our future investigation [<xref ref-type="bibr" rid="pcbi.1004730.ref054">54</xref>]. Finally, in our experiments the smaller time-scale of adaptation resulted in faster convergence to the same steady-state level. However, it would be interesting to examine whether the steady-state performance could also change as a result of the time-scale of decoder adaptation in more complex BMI tasks that rely more on neural adaptation and introduce complex interactions between the decoder and neural adaptation processes.</p>
<p>Here we not only developed the novel adaptive OFC-PPF BMI training architecture, but also dissociated and explored the effect of each of its modeling components. Given the modularity of the architecture and its general control-theoretic CLDA framework, these results guide the incorporation of various proposed modeling components in neuroprosthetic designs. These findings have significant implications towards the development of future clinically-viable neurotechnologies.</p>
</sec>
<sec id="sec025">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004730.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>BMI time scales of decoding and adaptation.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>General recursions for a PPF.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>PPF Processing of noisy spiking activity.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s004" xlink:type="simple">
<label>S4 Text</label>
<caption>
<title>Computing the difference in converged parameters.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s005" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Performance over the process of adaptive OFC PPF after assisted training.</title>
<p>Success rate as a function of time from the start of the session; success rate here is computed and shown only for the portion of the session after assistance stopped. Success rate is calculated in sliding 2 min windows. Figure convention is otherwise the same as in <xref ref-type="fig" rid="pcbi.1004730.g003">Fig 3A</xref>. Note that performance after assisted training ends is above the desired minimum threshold of 5 trials/min.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s006" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Instant-OFC method of intention estimation results in more proficient control.</title>
<p>Steady-state performance of the PPF decoder trained using the instant-OFC method of intention estimation (blue) vs. the CursorGoal method of intention estimation (red) vs. the N-OFC method of intention estimation (magenta). Bars indicate average values and error bars indicate s.e.m..</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s007" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Convergence of performance after assisted training.</title>
<p>Figure convention is the same as in <xref ref-type="fig" rid="pcbi.1004730.g005">Fig 5</xref>. Success rate is calculated in sliding 2 min windows. Time for each session is aligned to the end of assistance in that session. (A) Non-assisted performance over time for adaptive OFC-PPF (solid) and SmoothBatch OFC-PPF (dashed), which were run on two sets (red and blue) of two consecutive days that started from the same initial parameters. Time is aligned to the end of assisted training for each session. (B, C) Non-assisted average success rate across sessions as a function of time after assisted training stops for SmoothBatch OFC-PPF in (B) and Adaptive OFC-PPF in (C). Time is again aligned to the end of assistance. Blue curves show the mean success rate over 12 days of experiments for each decoder.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s008" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Performance improvement using instant OFC method of intention estimation.</title>
<p>Note that a positive improvement in reach time and movement error means a shorter reach time and a smaller movement error.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s009" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>The effect of adaptation time scale on the speed of performance convergence.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004730.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004730.s010" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Percent correct comparison of target-jump vs. center-out trials in the target jump task.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004730.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nicolelis</surname> <given-names>MAL</given-names></name>. <article-title>Actions from thoughts</article-title>. <source>Nature Neuroscience</source>. <year>2001</year> <month>Jan</month>;p. <fpage>403</fpage>–<lpage>407</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>. <article-title>Connecting cortex to machines: recent advances in brain interfaces</article-title>. <source>Nature Neuroscience</source>. <year>2002</year> <month>Nov</month>;p. <fpage>1085</fpage>–<lpage>1088</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn947" xlink:type="simple">10.1038/nn947</ext-link></comment> <object-id pub-id-type="pmid">12403992</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwartz</surname> <given-names>AB</given-names></name>. <article-title>Cortical neural prosthetics</article-title>. <source>Annual Review of Neuroscience</source>.<year>2004</year> <month>Jul</month>;<volume>27</volume>:<fpage>487</fpage>–<lpage>507</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.neuro.27.070203.144233" xlink:type="simple">10.1146/annurev.neuro.27.070203.144233</ext-link></comment> <object-id pub-id-type="pmid">15217341</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carmena</surname> <given-names>JM</given-names></name>. <article-title>Advances in Neuroprosthetic Learning and Control</article-title>. <source>PLoS Biol</source>.<year>2013</year> <day>05</day>;<volume>11</volume>(<issue>5</issue>):<fpage>e1001561</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001561" xlink:type="simple">10.1371/journal.pbio.1001561</ext-link></comment> <object-id pub-id-type="pmid">23700383</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lebedev</surname> <given-names>M</given-names></name>. <article-title>Brain-machine interfaces: an overview</article-title>. <source>Translational Neuroscience</source>. <year>2014</year> <month>Mar</month>;<volume>5</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2478/s13380-014-0212-z" xlink:type="simple">10.2478/s13380-014-0212-z</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Tillery</surname> <given-names>SIH</given-names></name>, <name name-style="western"><surname>Schwartz</surname> <given-names>AB</given-names></name>. <article-title>Direct Cortical Control of 3D Neuroprosthetic Devices</article-title>. <source>Science</source>. <year>2002</year> <month>Jun</month>;<volume>296</volume>:<fpage>1829</fpage>–<lpage>1832</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1070291" xlink:type="simple">10.1126/science.1070291</ext-link></comment> <object-id pub-id-type="pmid">12052948</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Serruya</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Hatsopoulos</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>. <article-title>Instant neural control of a movement signal</article-title>. <source>Nature</source>. <year>2002</year> <month>Mar</month>;<volume>416</volume>:<fpage>141</fpage>–<lpage>142</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/416141a" xlink:type="simple">10.1038/416141a</ext-link></comment> <object-id pub-id-type="pmid">11894084</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carmena</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Lebedev</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Crist</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Santucci</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Dimitrov</surname> <given-names>DF</given-names></name>, <etal>et al</etal>. <article-title>Learning to Control a Brain-Machine Interface for Reaching and Grasping by Primates</article-title>. <source>PLoS Biol</source>. <year>2003</year>;<volume>1</volume>(<issue>2</issue>):<fpage>e42</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0000042" xlink:type="simple">10.1371/journal.pbio.0000042</ext-link></comment> <object-id pub-id-type="pmid">14624244</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Musallam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Corneil</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Greger</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Scherberger</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Andersen</surname> <given-names>RA</given-names></name>. <article-title>Cognitive control signals for neural prosthetics</article-title>. <source>Science</source>. <year>2004</year> <month>Jul</month>;<volume>305</volume>:<fpage>258</fpage>–<lpage>262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1097938" xlink:type="simple">10.1126/science.1097938</ext-link></comment> <object-id pub-id-type="pmid">15247483</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Santhanam</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ryu</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Afshar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shenoy</surname> <given-names>KV</given-names></name>. <article-title>A high-performance brain-computer interface</article-title>. <source>Nature</source>. <year>2006</year> <month>Jul</month>;<volume>442</volume>:<fpage>195</fpage>–<lpage>198</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature04968" xlink:type="simple">10.1038/nature04968</ext-link></comment> <object-id pub-id-type="pmid">16838020</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Velliste</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Perel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Spalding</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Whitford</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Schwartz</surname> <given-names>AB</given-names></name>. <article-title>Cortical control of a prosthetic arm for self-feeding</article-title>. <source>Nature</source>. <year>2008</year> <month>Jun</month>;<volume>453</volume>:<fpage>1098</fpage>–<lpage>1101</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06996" xlink:type="simple">10.1038/nature06996</ext-link></comment> <object-id pub-id-type="pmid">18509337</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Simeral</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Hochberg</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Black</surname> <given-names>MJ</given-names></name>. <article-title>Neural control of computer cursor velocity by decoding motor cortical spiking activity in humans with tetraplegia</article-title>. <source>J Neural Eng</source>. <year>2008</year>;<volume>5</volume>:<fpage>455</fpage>–<lpage>476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1741-2560/5/4/010" xlink:type="simple">10.1088/1741-2560/5/4/010</ext-link></comment> <object-id pub-id-type="pmid">19015583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moritz</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Perlmutter</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Fetz</surname> <given-names>EE</given-names></name>. <article-title>Direct control of paralysed muscles by cortical neurons</article-title>. <source>Nature</source>. <year>2008</year> <month>Dec</month>;<volume>456</volume>:<fpage>639</fpage>–<lpage>643</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07418" xlink:type="simple">10.1038/nature07418</ext-link></comment> <object-id pub-id-type="pmid">18923392</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mulliken</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Musallam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Andersen</surname> <given-names>RA</given-names></name>. <article-title>Decoding Trajectories from Posterior Parietal Cortex Ensembles</article-title>. <source>J Neurosci</source>. <year>2008</year> <month>Nov</month>;<volume>28</volume>(<issue>48</issue>):<fpage>12913</fpage>–<lpage>12926</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1463-08.2008" xlink:type="simple">10.1523/JNEUROSCI.1463-08.2008</ext-link></comment> <object-id pub-id-type="pmid">19036985</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ganguly</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Carmena</surname> <given-names>JM</given-names></name>. <article-title>Emergence of a Stable Cortical Map for Neuroprosthetic Control</article-title>. <source>PLoS Biol</source>. <year>2009</year> <month>Jul</month>;<volume>7</volume>(<issue>7</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1000153" xlink:type="simple">10.1371/journal.pbio.1000153</ext-link></comment> <object-id pub-id-type="pmid">19621062</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suminski</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Tkach</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Fagg</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Hatsopoulos</surname> <given-names>NG</given-names></name>. <article-title>Incorporating Feedback from Multiple Sensory Modalities Enhances Brain-Machine Interface Control</article-title>. <source>J Neurosci</source>. <year>2010</year> <month>Dec</month>;<volume>30</volume>(<issue>50</issue>):<fpage>16777</fpage>–<lpage>16787</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3967-10.2010" xlink:type="simple">10.1523/JNEUROSCI.3967-10.2010</ext-link></comment> <object-id pub-id-type="pmid">21159949</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mahmoudi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sanchez</surname> <given-names>JC</given-names></name>. <article-title>A symbiotic brain-machine interface through value-based decision making</article-title>. <source>PLOS ONE</source>. <year>2011</year> <month>Apr</month>;<volume>6</volume>(<issue>3</issue>):<fpage>e14760</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0014760" xlink:type="simple">10.1371/journal.pone.0014760</ext-link></comment> <object-id pub-id-type="pmid">21423797</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Doherty</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Lebedev</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Ifft</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Zhuang</surname> <given-names>KZ</given-names></name>, <name name-style="western"><surname>Shokur</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bleuler</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Active tactile exploration using a brain-machine-brain interface</article-title>. <source>Nature</source>. <year>2011</year> <month>Nov</month>;<volume>479</volume>:<fpage>228</fpage>–<lpage>231</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10489" xlink:type="simple">10.1038/nature10489</ext-link></comment> <object-id pub-id-type="pmid">21976021</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hochberg</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Bacher</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Jarosiewicz</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Masse</surname> <given-names>NY</given-names></name>, <name name-style="western"><surname>Simeral</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Vogel</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Reach and grasp by people with tetraplegia using a neurally controlled robotic arm</article-title>. <source>Nature</source>. <year>2012</year> <month>May</month>;<volume>485</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11076" xlink:type="simple">10.1038/nature11076</ext-link></comment> <object-id pub-id-type="pmid">22596161</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gilja</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Nuyujukian</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Chestek</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Cunningham</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Fan</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>A High-Performance Neural Prosthesis Enabled by Control Algorithm Design</article-title>. <source>Nat Neurosci</source>. <year>2012</year> <month>Dec</month>;<volume>15</volume>:<fpage>1752</fpage>–<lpage>1757</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3265" xlink:type="simple">10.1038/nn.3265</ext-link></comment> <object-id pub-id-type="pmid">23160043</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Orsborn</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Dangi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moorman</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Carmena</surname> <given-names>JM</given-names></name>. <article-title>Closed-Loop Decoder Adaptation on Intermediate Time-Scales Facilitates Rapid BMI Performance Improvements Independent of Decoder Initialization Conditions</article-title>. <source>IEEE Trans Neural Syst Rehabil Eng</source>. <year>2012</year> <month>Jul</month>;<volume>20</volume>(<issue>4</issue>):<fpage>468</fpage>–<lpage>477</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2012.2185066" xlink:type="simple">10.1109/TNSRE.2012.2185066</ext-link></comment> <object-id pub-id-type="pmid">22772374</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hauschild</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mulliken</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Fineman</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Loeb</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Andersen</surname> <given-names>RA</given-names></name>. <article-title>Cognitive signals for brain-machine interfaces in posterior parietal cortex include continuous 3D trajectory commands</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2012</year>;<volume>109</volume>:<fpage>17075</fpage>–<lpage>17080</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1215092109" xlink:type="simple">10.1073/pnas.1215092109</ext-link></comment> <object-id pub-id-type="pmid">23027946</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Collinger</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Wodlinger</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Downey</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Tyler-Kabara</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Weber</surname> <given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>High-performance neuroprosthetic control by an individual with tetraplegia</article-title>. <source>The Lancet</source>. <year>2013</year> <month>Feb</month>;<volume>381</volume>(<issue>9866</issue>):<fpage>557</fpage>–<lpage>564</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0140-6736(12)61816-9" xlink:type="simple">10.1016/S0140-6736(12)61816-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ethier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Oby</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Bauman</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>LE</given-names></name>. <article-title>Restoration of grasp following paralysis through brain-controlled stimulation of muscles</article-title>. <source>Nature</source>. <year>2012</year> <month>May</month>;<volume>485</volume>:<fpage>368</fpage>–<lpage>371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10987" xlink:type="simple">10.1038/nature10987</ext-link></comment> <object-id pub-id-type="pmid">22522928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Powers</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wornell</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ZM</given-names></name>. <article-title>Neural population partitioning and a concurrent brain-machine interface for sequential motor function</article-title>. <source>Nat Neurosci</source>. <year>2012</year> <month>Dec</month>;<volume>15</volume>(<issue>12</issue>):<fpage>1715</fpage>–<lpage>1722</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3250" xlink:type="simple">10.1038/nn.3250</ext-link></comment> <object-id pub-id-type="pmid">23143511</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ZM</given-names></name>, <name name-style="western"><surname>Wornell</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Powers</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>A Real-Time Brain-Machine Interface Combining Motor Target and Trajectory Intent Using an Optimal Feedback Control Design</article-title>. <source>PLOS ONE</source>. <year>2013</year> <month>Apr</month>;<volume>8</volume>(<issue>4</issue>):<fpage>e59049</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0059049" xlink:type="simple">10.1371/journal.pone.0059049</ext-link></comment> <object-id pub-id-type="pmid">23593130</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ZM</given-names></name>. <article-title>A cortical-spinal prosthesis for targeted limb movement in paralysed primate avatars</article-title>. <source>Nat Commun</source>. <year>2014</year> <month>Feb</month>;<volume>5</volume> (<issue>3237</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms4237" xlink:type="simple">10.1038/ncomms4237</ext-link></comment> <object-id pub-id-type="pmid">24549394</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Orsborn</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Moorman</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Overduin</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Dimitrov</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Carmena</surname> <given-names>JM</given-names></name>. <article-title>Closed-loop decoder adaptation shapes neural plasticity for skillful neuroprosthetic control</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>82</volume>:<fpage>1380</fpage>–<lpage>1392</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2014.04.048" xlink:type="simple">10.1016/j.neuron.2014.04.048</ext-link></comment> <object-id pub-id-type="pmid">24945777</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>Z</given-names></name>. <article-title>Decoding methods for neural prostheses: where have we reached?</article-title> <source>Frontiers in Systems Neuroscience</source>. <year>2014</year>;<volume>8</volume>(<issue>129</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baranauskas</surname> <given-names>G</given-names></name>. <article-title>What limits the performance of current invasive Brain Machine Interfaces?</article-title> <source>Frontiers in Systems Neuroscience</source>. <year>2014</year>;<volume>8</volume>(<issue>68</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnsys.2014.00068" xlink:type="simple">10.3389/fnsys.2014.00068</ext-link></comment> <object-id pub-id-type="pmid">24808833</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dangi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gowda</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moorman</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Orsborn</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>So</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shanechi</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Continuous Closed-Loop Decoder Adaptation with a Recursive Maximum Likelihood Algorithm Allows for Rapid Performance Acquisition in Brain-Machine Interfaces</article-title>. <source>Neural Comput</source>. <year>2014</year> <month>Sep</month>;<volume>26</volume>(<issue>9</issue>):<fpage>1811</fpage>–<lpage>1839</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00632" xlink:type="simple">10.1162/NECO_a_00632</ext-link></comment> <object-id pub-id-type="pmid">24922501</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Lebedev</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Nicolelis</surname> <given-names>MAL</given-names></name>. <article-title>Adaptive decoding for brain-machine interfaces through Bayesian parameter updates</article-title>. <source>Neural Comp</source>. <year>2011</year>;<volume>23</volume>:<fpage>3162</fpage>–<lpage>3204</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00207" xlink:type="simple">10.1162/NECO_a_00207</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Quirk</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>A statistical paradigm for neural spike train decoding applied to position prediction from ensemble firing patterns of rat hippocampal place cells</article-title>. <source>J Neurosci</source>. <year>1998</year> <month>Sep</month>;<volume>18</volume>(<issue>18</issue>):<fpage>7411</fpage>–<lpage>7425</lpage>. <object-id pub-id-type="pmid">9736661</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Barbieri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Solo</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Dynamic analysis of neural encoding by point process adaptive filtering</article-title>. <source>Neural Comput</source>. <year>2004</year>;<volume>16</volume>:<fpage>971</fpage>–<lpage>998</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976604773135069" xlink:type="simple">10.1162/089976604773135069</ext-link></comment> <object-id pub-id-type="pmid">15070506</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title>. <source>J Neurophysiol</source>. <year>2005</year>;<volume>93</volume>:<fpage>1074</fpage>–<lpage>1089</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00697.2004" xlink:type="simple">10.1152/jn.00697.2004</ext-link></comment> <object-id pub-id-type="pmid">15356183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>So</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dangi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Orsborn</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Gastpar</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Carmena</surname> <given-names>JM</given-names></name>. <article-title>Subject-specific modulation of local field potential spectral power during brain-machine interface control in primates</article-title>. <source>J Neural Eng</source>. <year>2014</year> <month>Feb</month>;<volume>11</volume>:<fpage>026002</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1741-2560/11/2/026002" xlink:type="simple">10.1088/1741-2560/11/2/026002</ext-link></comment> <object-id pub-id-type="pmid">24503623</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref037">
<label>37</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Wornell</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ZM</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <chapter-title>A Parallel Point-Process Filter for Estimation of Goal-Directed Movements from Neural Signals</chapter-title>. In: <source>Proc. IEEE conference on acoustics, speech, and signal processing (ICASSP)</source>. <publisher-loc>Dallas, TX</publisher-loc>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ZM</given-names></name>, <name name-style="western"><surname>Wornell</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <chapter-title>A brain-machine interface combining target and trajectory information using optimal feedback control</chapter-title>. In: <source>Computational and Systems Neuroscience (COSYNE) Meeting</source>. <publisher-loc>Salt Lake City, USA</publisher-loc>; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Wornell</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ZM</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Feedback-controlled parallel point process filter for estimation of goal-directed movements from neural signals</article-title>. <source>IEEE Trans Neural Syst Rehabil Eng</source>. <year>2012</year> <month>Oct</month>. <object-id pub-id-type="pmid">23047892</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Todorov</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>. <article-title>Optimal Feedback Control as a Theory of Motor Coordination</article-title>. <source>Nat Neurosci</source>. <year>2002</year> <month>Nov</month>;<volume>5</volume>(<issue>11</issue>):<fpage>1226</fpage>–<lpage>1235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn963" xlink:type="simple">10.1038/nn963</ext-link></comment> <object-id pub-id-type="pmid">12404008</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Todorov</surname> <given-names>E</given-names></name>. <article-title>Optimality principles in sensorimotor control</article-title>. <source>Nat Neurosci</source>. <year>2004</year> <month>Sep</month>;p. <fpage>907</fpage>–<lpage>915</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1309" xlink:type="simple">10.1038/nn1309</ext-link></comment> <object-id pub-id-type="pmid">15332089</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shadmehr</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Krakauer</surname> <given-names>JW</given-names></name>. <article-title>A computational neuroanatomy for motor control</article-title>. <source>Exp Brain Res</source>. <year>2008</year>;p. <fpage>359</fpage>–<lpage>381</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00221-008-1280-5" xlink:type="simple">10.1007/s00221-008-1280-5</ext-link></comment> <object-id pub-id-type="pmid">18251019</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref043">
<label>43</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Golub</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>BM</given-names></name>, <chapter-title>Chase SM</chapter-title>. <chapter-title>Internal Models Engaged by Brain-computer Interface Control</chapter-title>. In: <source>IEEE EMBS</source>. <publisher-loc>San Diego, USA</publisher-loc>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref044">
<label>44</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Huh</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Todorov</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <chapter-title>Infinite Horizon Optimal Control Framework for Goal Directed Movements</chapter-title>. In: <source>Society for Neuroscience (SFN) Meeting</source>. <publisher-loc>San Diego, USA</publisher-loc>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref045">
<label>45</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Huh</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Todorov</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <chapter-title>Infinite horizon optimal control framework for goal directed movements</chapter-title>. In: <source>Proc. Advances in Computational Motor Control</source>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qian</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>ZP</given-names></name>, <name name-style="western"><surname>Mazzoni</surname> <given-names>P</given-names></name>. <article-title>Movement Duration, Fitts’s Law, and an Infinite-Horizon Optimal Feedback Control Model for Biological Motor Systems</article-title>. <source>Neural Comput</source>. <year>2013</year> <month>Mar</month>;<volume>25</volume>(<issue>3</issue>):<fpage>697</fpage>–<lpage>724</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00410" xlink:type="simple">10.1162/NECO_a_00410</ext-link></comment> <object-id pub-id-type="pmid">23272916</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bertsekas</surname> <given-names>D</given-names></name>. <article-title>Dynamic Programming and Optimal Control</article-title>. <source>Athena Scientific</source>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moran</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Schwartz</surname> <given-names>AB</given-names></name>. <article-title>Motor Cortical Representation of Speed and Direction During Reaching</article-title>. <source>J Neurophysiol</source>. <year>1999</year>;<volume>82</volume>:<fpage>2676</fpage>–<lpage>2692</lpage>. <object-id pub-id-type="pmid">10561437</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Georgopoulos</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Kalaska</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Caminiti</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Massey</surname> <given-names>JT</given-names></name>. <article-title>On the relations between the direction of two-dimensional arm movement and cell discharge in primate motor cortex</article-title>. <source>J Neurosci</source>. <year>1982</year> <month>Nov</month>;<volume>2</volume>(<issue>11</issue>):<fpage>1527</fpage>–<lpage>1537</lpage>. <object-id pub-id-type="pmid">7143039</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref050">
<label>50</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hsieh</surname> <given-names>HL</given-names></name>, <name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>. <chapter-title>Optimal calibration of the learning rate in closed-loop adaptive brain-machine interfaces</chapter-title>. In: Proc. <source>IEEE Conference on Engineering in Medicine and Biology Society (EMBC)</source>. <publisher-loc>Milan, Italy</publisher-loc>; <year>2015</year>. p. <fpage>1667</fpage>–<lpage>1670</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kowalski</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Srinivasan</surname> <given-names>L</given-names></name>. <article-title>Dynamic analysis of naive adaptive brain-machine interfaces</article-title>. <source>Neural Comput</source>. <year>2013</year> <month>Sep</month>;<volume>25</volume>(<issue>9</issue>):<fpage>2373</fpage>–<lpage>2420</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00484" xlink:type="simple">10.1162/NECO_a_00484</ext-link></comment> <object-id pub-id-type="pmid">23777523</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Merel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pianto</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Cunningham</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <article-title>Encoder-Decoder Optimization for Brain-Computer Interfaces</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year> <day>06</day>;<volume>11</volume>(<issue>6</issue>):<fpage>e1004288</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004288" xlink:type="simple">10.1371/journal.pcbi.1004288</ext-link></comment> <object-id pub-id-type="pmid">26029919</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004730.ref053">
<label>53</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Cover</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>J</given-names></name>. <source>Elements of Information Theory</source>. <publisher-name>Wiley &amp; Sons Inc</publisher-name>.; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004730.ref054">
<label>54</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Shanechi</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Orsborn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Moorman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Gowda</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Carmena</surname> <given-names>JM</given-names></name>. <chapter-title>High-Performance Brain-Machine Interface Enabled by an Adaptive Optimal Feedback-Controlled Point Process Decoder</chapter-title>. In: <source>Proc. IEEE Conference on Engineering in Medicine and Biology Society (EMBC)</source>. <publisher-loc>Chicago, Il</publisher-loc>; <year>2014</year>. p. <fpage>6493</fpage>–<lpage>6496</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>