<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004970</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01967</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Animal models</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Animals</subject><subj-group><subject>Invertebrates</subject><subj-group><subject>Nematoda</subject><subj-group><subject>Caenorhabditis</subject><subj-group><subject>Caenorhabditis elegans</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Fluorescence imaging</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Human factors engineering</subject><subj-group><subject>Man-computer interface</subject><subj-group><subject>Graphical user interface</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Computer architecture</subject><subj-group><subject>User interfaces</subject><subj-group><subject>Graphical user interface</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Calcium imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Calcium imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Image analysis</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Accurate Automatic Detection of Densely Distributed Cell Nuclei in 3D Space</article-title>
<alt-title alt-title-type="running-head">Accurate Detection of Densely Packed Nuclei in 3D</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5239-2235</contrib-id>
<name name-style="western">
<surname>Toyoshima</surname>
<given-names>Yu</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Tokunaga</surname>
<given-names>Terumasa</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8077-8589</contrib-id>
<name name-style="western">
<surname>Hirose</surname>
<given-names>Osamu</given-names>
</name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kanamori</surname>
<given-names>Manami</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Teramoto</surname>
<given-names>Takayuki</given-names>
</name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Jang</surname>
<given-names>Moon Sun</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kuge</surname>
<given-names>Sayuri</given-names>
</name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ishihara</surname>
<given-names>Takeshi</given-names>
</name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Yoshida</surname>
<given-names>Ryo</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Iino</surname>
<given-names>Yuichi</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biological Sciences, Graduate School of Science, The University of Tokyo, Bunkyo-ku, Tokyo, Japan</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Systems Design and Informatics, Faculty of Computer Science and Systems Engineering, Kyushu Institute of Technology, Iizuka-shi, Fukuoka, Japan</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>The Institute of Statistical Mathematics, Research Organization of Information and Systems, Tachikawa, Tokyo, Japan</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Faculty of Electrical and Computer Engineering, Institute of Science and Engineering, Kanazawa University, Kakuma, Kanazawa, Japan</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Department of Biology, Faculty of Sciences, Kyushu University, Higashi-ku, Fukuoka, Japan</addr-line></aff>
<aff id="aff006"><label>6</label> <addr-line>CREST, Japan Science and Technology Corporation, Bunkyo-ku, Tokyo, Japan</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Packer</surname>
<given-names>Adam</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University College London, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Performed the experiments: MK MSJ TTe YT. Analyzed the data: YT YI TTo OH RY TTe MK MSJ SK TI. Wrote the paper: YT YI. Conceived the project: YT YI. Developed the method of image anlaysis: YT YI. Supported the development: TTo OH RY MK TI. Developed the customized microscope: TTe TI. Designed the experiments: YT YI TTe MK MSJ SK TI.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">iino@bs.s.u-tokyo.ac.jp</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>6</day>
<month>6</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>6</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>6</issue>
<elocation-id>e1004970</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>11</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>3</day>
<month>5</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Toyoshima et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004970"/>
<abstract>
<p>To measure the activity of neurons using whole-brain activity imaging, precise detection of each neuron or its nucleus is required. In the head region of the nematode <italic>C</italic>. <italic>elegans</italic>, the neuronal cell bodies are distributed densely in three-dimensional (3D) space. However, no existing computational methods of image analysis can separate them with sufficient accuracy. Here we propose a highly accurate segmentation method based on the curvatures of the iso-intensity surfaces. To obtain accurate positions of nuclei, we also developed a new procedure for least squares fitting with a Gaussian mixture model. Combining these methods enables accurate detection of densely distributed cell nuclei in a 3D space. The proposed method was implemented as a graphical user interface program that allows visualization and correction of the results of automatic detection. Additionally, the proposed method was applied to time-lapse 3D calcium imaging data, and most of the nuclei in the images were successfully tracked and measured.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>To reach the ultimate goal of neuroscience to understanding how each neuron functions in the brain, whole-brain activity imaging techniques with single-cell resolution have been intensively developed. There are many neurons in the whole-brain images and manual detection of the neurons is very time-consuming. However, the neurons are often packed densely in the 3D space and existing automatic methods fail to correctly split the clumps. In fact, in previous reports of whole-brain activity imaging of <italic>C</italic>. <italic>elegans</italic>, the number of detected neurons were less than expected. Such scarcity may be a cause of measurement errors and misidentification of neuron classes. Here we developed a highly accurate automatic cell detection method for densely-packed cells. The proposed method successfully detected almost all neurons in whole-brain images of the nematode. Our method can be used to track multi-objects and enables automatic measurements of the neuronal activities from whole-brain activity imaging data. We also developed a visualization and correction tool that is helpful for experimenters. Additionally, the proposed method can be a fundamental technique for other applications such as making wiring diagram of neurons or establishing a cell lineage in embryonic development. Thus our framework supports effective and accurate bio-image analyses.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003382</institution-id>
<institution>Core Research for Evolutional Science and Technology, Japan Science and Technology Agency</institution>
</institution-wrap>
</funding-source>
<award-id>“Creation of Fundamental Technologies for Understanding and Control of Biosystem Dynamics”</award-id>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001700</institution-id>
<institution>Ministry of Education, Culture, Sports, Science, and Technology</institution>
</institution-wrap>
</funding-source>
<award-id>20115002</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Iino</surname>
<given-names>Yuichi</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001700</institution-id>
<institution>Ministry of Education, Culture, Sports, Science, and Technology</institution>
</institution-wrap>
</funding-source>
<award-id>25115010</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Iino</surname>
<given-names>Yuichi</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001700</institution-id>
<institution>Ministry of Education, Culture, Sports, Science, and Technology</institution>
</institution-wrap>
</funding-source>
<award-id>221S0003</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Iino</surname>
<given-names>Yuichi</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001700</institution-id>
<institution>Ministry of Education, Culture, Sports, Science, and Technology</institution>
</institution-wrap>
</funding-source>
<award-id>26830006</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5239-2235</contrib-id>
<name name-style="western">
<surname>Toyoshima</surname>
<given-names>Yu</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001700</institution-id>
<institution>Ministry of Education, Culture, Sports, Science, and Technology</institution>
</institution-wrap>
</funding-source>
<award-id>24800014</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5239-2235</contrib-id>
<name name-style="western">
<surname>Toyoshima</surname>
<given-names>Yu</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the CREST program “Creation of Fundamental Technologies for Understanding and Control of Biosystem Dynamics” of the Japan Science and Technology Agency (JST). YI was supported by Grants-in-Aid for Innovative Areas “Systems molecular ethology” (20115002) and “Memory dynamism” (25115010), and "Comprehensive Brain Network" (221S0003). YT was supported by Grants-in-Aid for Young Scientists (B) (26830006) and for Research Activity start-up (24800014) and for Scientific Research on Innovative Areas (16H01418) from the Ministry of Education, Culture, Sports, Science and Technology of Japan. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="20"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data and code are available from the SSBD database (<ext-link ext-link-type="uri" xlink:href="http://ssbd.qbic.riken.jp/set/20160501/" xlink:type="simple">http://ssbd.qbic.riken.jp/set/20160501/</ext-link>) and figshare (<ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.6084/m9.figshare.3184546" xlink:type="simple">https://dx.doi.org/10.6084/m9.figshare.3184546</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The animal brain is the most complex information processing system in living organisms. To elucidate how real nervous systems perform computations is one of the fundamental goals of neuroscience and systems biology. The wiring information for neural circuits and visualization of their activity at cellular resolution are required for achieving this goal. Advances in microscopy techniques in recent years have enabled whole-brain activity imaging of small animals at cellular resolution [<xref ref-type="bibr" rid="pcbi.1004970.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004970.ref004">4</xref>]. The wiring information of all the neurons in the mouse brain can be obtained using recently developed brain-transparentization techniques [<xref ref-type="bibr" rid="pcbi.1004970.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1004970.ref009">9</xref>].</p>
<p>Detection of neurons from microscopy images is necessary for optical measurements of neuronal activity or for obtaining wiring information. Because there are many neurons in the images, methods of automatic neuron detection, rather than manual selection of ROIs (regions of interest), are required and several such methods have been proposed [<xref ref-type="bibr" rid="pcbi.1004970.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref011">11</xref>]. Detection of cells that are distributed in three-dimensional (3D) space is also important in other fields of biology such as embryonic development studies [<xref ref-type="bibr" rid="pcbi.1004970.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1004970.ref017">17</xref>].</p>
<p>In these methods, cell nuclei are often labeled by fluorescent probes and used as a marker of a cell. To identify nuclei in such images, the basic method is blob detection, which for example consists of local peak detection followed by watershed segmentation. If the cells are sparsely distributed, blob detection methods are powerful techniques for nucleus detection. However, if two or more cells are close to each other, the blobs are fused, and some cells will be overlooked. These false negatives may be trivial for the statistics of the cells but may strongly affect individual measurements such as those of neuronal activity. Overlooking some nuclei should be avoided when subsequent analyses assume that all the cells were detected, for example, when making wiring diagram of neurons or establishing a cell lineage in embryonic development. Therefore, correct detection of all nuclei from images without false negatives is a fundamental problem in the field of bio-image informatics.</p>
<p>Although many efforts have been made to develop methods that avoid such false negatives, these methods seem to insufficiently overcome the problem. In the head region of <italic>Caenorhabditis elegans</italic>, for example, the neuronal nuclei are densely packed and existing methods produce many false negatives, as shown below. Actually, in the studies of whole-brain activity imaging of <italic>C</italic>. <italic>elegans</italic> reported so far, the local peak detection method that can overlook many nuclei was employed [<xref ref-type="bibr" rid="pcbi.1004970.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref018">18</xref>], or the nuclei were manually detected [<xref ref-type="bibr" rid="pcbi.1004970.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref020">20</xref>]. Highly accurate automatic nucleus detection methods should be developed in order to improve the efficiency and accuracy of such image analysis.</p>
<p>Here we propose a highly accurate automatic nucleus detection method for densely distributed cell nuclei in 3D space. The proposed method is based on newly developed clump splitting method suitable for 3D images and improves the detection of all nuclei in 3D images of neurons of nematodes. A combination of this approach with a Gaussian mixture fitting algorithm yields highly accurate locations of densely packed nuclei and enables automatic tracking and measuring of these nuclei. The performance of the proposed method is demonstrated by using various images of densely-packed head neurons of nematodes which was obtained by various types of microscopes.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Overlooking of nuclei by blob detection</title>
<p>In this study, we focused on the head neurons of the soil nematode <italic>C</italic>. <italic>elegans</italic>, which constitute the major neuronal ensemble of this animal [<xref ref-type="bibr" rid="pcbi.1004970.ref021">21</xref>]. All the neuronal nuclei in a worm of strain JN2100 were visualized by the red fluorescent protein mCherry. The head region of the worm was imaged by a confocal microscope, and we obtained 3D images of 12 animals (Data 1, <xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1A</xref>). The shape of the nuclei was roughly ellipsoidal (<xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1B</xref>). The fluorescence intensity increased toward the centers of the nuclei (<xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1D</xref>). The typical half-radius of the nuclei was about 1.10 μm (<xref ref-type="supplementary-material" rid="pcbi.1004970.s001">S1 Fig</xref>). The distance to the nearest neighboring nucleus was 4.30 ± 2.13 μm (mean and standard deviation, <xref ref-type="supplementary-material" rid="pcbi.1004970.s001">S1 Fig</xref>), suggesting that the neurons are densely distributed in 3D space. The mean fluorescence intensities differed among neurons by one order of magnitude (<xref ref-type="supplementary-material" rid="pcbi.1004970.s001">S1 Fig</xref>), making it difficult to detect a darker nucleus near a bright nucleus.</p>
<fig id="pcbi.1004970.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004970.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overlooking of nuclei by conventional blob detection.</title>
<p><bold>(A)</bold> Example of 3D image of neuronal nuclei in the head region of a worm (Data 1, see <xref ref-type="sec" rid="sec010">Methods</xref>). Image is displayed as max projection along <italic>x</italic><sub>3</sub> axis. Note that all of the raw images in this paper is displayed in logarithmic scale in order to visualize dark nuclei. <bold>(B)</bold> Enlarged view of green box in (A). A particular slice along the <italic>x</italic><sub>3</sub> axis is displayed. <bold>(C)</bold> Preprocessed image of the image in (B). <bold>(D)</bold> Intensities on the dotted lines in (B) and (C). <bold>(E)</bold> Results of watershed segmentation (step 2 of the proposed method). The region of the brighter nucleus is shown in cyan. <bold>(F)</bold> Results of segmentation by the proposed method (step 3 of the proposed method). The region of the darker nucleus is shown in magenta.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.g001" xlink:type="simple"/>
</fig>
<p>We first applied conventional blob detection techniques to the 3D image (<xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1C–1E</xref>). Salt-and-pepper noise and background intensities were removed from the image. The image was smoothed to avoid over-segmentation (<xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1C and 1D</xref>). Local intensity peaks in the preprocessed image were detected and used as seeds for 3D seeded grayscale watershed segmentation. Each segmented region was regarded as a nucleus (<xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1E</xref>). We found that dark nuclei in high-density regions often escaped detection. If the dark nucleus was adjacent to a bright nucleus, the fluorescence of the bright nucleus overlapped that of the dark one, and the local intensity peak in the dark nucleus was masked (<xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1D</xref>). As a result, the seed for the dark nucleus was lost, and the dark nucleus fused with the bright nucleus (<xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1E</xref>). The rate of false-negative nuclei was 18.9%. In contrast, our proposed method successfully detected and segmented the dark nuclei (<xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1F</xref>).</p>
</sec>
<sec id="sec004">
<title>Using areas of negative curvature of iso-intensity surfaces for clump splitting in 3D images</title>
<p>The shapes of the nuclei are roughly ellipsoidal, and the fluorescence intensity increased toward the centers of the nuclei, suggesting that the intensity of nuclei can be approximated by a mixture of trivariate Gaussian distributions. The intensities <italic>f</italic><sub><italic>k</italic></sub> of the <italic>k</italic>-th Gaussian distribution <italic>g</italic><sub><italic>k</italic></sub> at voxel position <inline-formula id="pcbi.1004970.e001"><alternatives><graphic id="pcbi.1004970.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004970.e001" xlink:type="simple"/>
<mml:math display="inline" id="M1"><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math>
</alternatives></inline-formula> can be written as
<disp-formula id="pcbi.1004970.e002">
<alternatives>
<graphic id="pcbi.1004970.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004970.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mspace width="0.15em"/><mml:mo>|</mml:mo><mml:mspace width="0.15em"/><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mn mathvariant="bold">2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>T</mml:mtext></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>μ</italic><sub><italic>k</italic></sub> and <italic>Σ</italic><sub><italic>k</italic></sub> are the mean vector and covariance matrix of <italic>g</italic><sub><italic>k</italic></sub>, respectively, and <italic>π</italic><sub><italic>k</italic></sub> is an intensity scaling factor. To explain the effect on the curvature, typical bright and dark nuclei were approximated by the Gaussian distribution and are shown in <xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2</xref> as iso-intensity contour lines (<xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2A, 2C and 2E</xref>) and plots of the intensity along the cross section (<xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2B, 2D and 2F</xref>). When a bright nucleus was near a dark nucleus, the peak intensity of the dark nucleus merged with the tail of the fluorescence intensity distribution of the bright nucleus and no longer formed a peak.</p>
<fig id="pcbi.1004970.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004970.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Fluorescence intensity distribution of nuclei approximated by Gaussian distribution.</title>
<p>(<bold>A, B</bold>) Example of fluorescence intensity distribution of a bright nucleus approximated by Gaussian distribution <italic>f</italic><sub>1</sub>. <italic>π</italic><sub>1</sub> = 120, <italic>μ</italic><sub>1</sub> = (−1,0,0), <italic>Σ</italic><sub>1</sub> = (diag(1.10,0.89,1.35))<sup>2</sup>. (<bold>C</bold>, <bold>D</bold>) Example of fluorescence intensity distribution of a dark nucleus approximated by Gaussian distribution <italic>f</italic><sub>2</sub>. <italic>π</italic><sub>2</sub> = 40, <italic>μ</italic><sub>2</sub> = (2,0,0), <italic>Σ</italic><sub>2</sub> = (diag(1.10,0.89,1.35) × 0.9)<sup>2</sup>. (<bold>E</bold>, <bold>F</bold>) Fluorescence intensity distribution when a dark nucleus is near a bright nucleus, approximated by a mixture of distributions <italic>f</italic><sub>1</sub> and <italic>f</italic><sub>2</sub>. Area enclosed by black broken lines in E displays an area of negative curvature. (<bold>A</bold>, <bold>C</bold>, <bold>E</bold>) Iso-intensity contour lines of trivariate Gaussian distribution at <italic>x</italic><sub>3</sub> = 1. (<bold>B</bold>, <bold>D</bold>, <bold>F</bold>) Plot of intensity at (<italic>x</italic><sub>2</sub>,<italic>x</italic><sub>3</sub>) = (0,1). Black crosses indicate peak positions. (<bold>G</bold>) Outline of the fused blob and typical result of 2D clump splitting method. Red points indicate concave points. Red dashed line indicates the border line.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.g002" xlink:type="simple"/>
</fig>
<p>These false negatives can be avoided by using methods for dividing a close pair of objects, or clump splitting. Such methods have been developed for correct detection of objects in two-dimensional (2D) images [<xref ref-type="bibr" rid="pcbi.1004970.ref022">22</xref>–<xref ref-type="bibr" rid="pcbi.1004970.ref026">26</xref>]. These methods focus on the concavity of the outline of a blob. The concavity was calculated based on one of or a combination of various measurements such as angle [<xref ref-type="bibr" rid="pcbi.1004970.ref025">25</xref>], area [<xref ref-type="bibr" rid="pcbi.1004970.ref027">27</xref>], curvature [<xref ref-type="bibr" rid="pcbi.1004970.ref026">26</xref>], and distance measurements [<xref ref-type="bibr" rid="pcbi.1004970.ref024">24</xref>] of the outline. In these methods, after binarization of the image, concavity was obtained for each point on the outline. Then the concave points were determined as the local peaks of the concavity. After determination of concave points, a line connecting a pair of concave points is regarded as the boundary between the objects. When we regard the outermost contour line in <xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2E</xref> as the outline of the fused blob (<xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2G</xref>), the conventional 2D clump splitting method can be easily applied and two concave points are detected from the fused blob (<xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2G</xref>, red circles). The blob was divided into two parts by a border line connecting the two points, and the dark nucleus was detected.</p>
<p>In the ideal case in <xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2E</xref>, we obtained necessary and sufficient number of concave points. In real images, however, we might obtain too many concave points because outlines often contain noise and are not smooth. However, the number of concave points to choose is unknown because it is hard to know how many nuclei are included in a blob in a real image. Further, it is not obvious how to find the correct combinations of concave points to be linked if a blob contains three or more objects. In addition, for 3D images, the concepts of border lines that connect two concave points cannot be naturally expanded to three dimensions, because now we need some extra processes such as connecting groups of concave points in order to form border surfaces. Even if we regard a 3D image as a stack of 2D images, it is hard to split objects fused in the z direction (direction of the stacks) [<xref ref-type="bibr" rid="pcbi.1004970.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref027">27</xref>].</p>
<p>Here we introduce a concept of areas of concavity instead of concave points (i.e. local peak of concavity). Hereafter we use curvature as a measure of concavity and focus on areas of negative curvature for simplicity and clarity, but other measures such as angle, area, and distance from convex hull may be applicable. Furthermore we used the iso-intensity contour lines inside the object in addition to the outline of the object. Near the concave points in <xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2E</xref>, the iso-intensity contour lines have negative curvature; i.e., they curve in the direction of low intensities. Negative curvature may be a landmark of the border line because a single Gaussian distribution has positive curvature everywhere. Actually, the voxels at which an iso-intensity contour line has negative curvature were between two Gaussian distributions (<xref ref-type="fig" rid="pcbi.1004970.g002">Fig 2E</xref>, area between the broken lines). Once these voxels are removed from the blob, detection of two nuclei should be straightforward.</p>
<p>This approach is different from the classic clump splitting methods in two respects; focusing on area rather than local peak of concavity (concave points), and using iso-intensity contour lines in addition to the outline. These differences eliminate the need for determining how many concave points should be chosen and for obtaining correct combinations of the concave points because the area of negative curvature will cover the border lines. Therefore we can use the approach even if a blob contains three or more objects. In addition, this approach is robust to noise because it does not depend on a single contour line. Furthermore, this approach can be expanded to 3D images naturally because the 3D area (i.e. voxels) of negative curvatures will cover the border surfaces of the 3D objects. Iso-intensity contour lines in 2D images are parts of iso-intensity contour surfaces in three dimensions. A point on an iso-intensity surface has two principal curvatures, which can be calculated from the intensities of surrounding voxels (<xref ref-type="supplementary-material" rid="pcbi.1004970.s007">S2 Text</xref>) [<xref ref-type="bibr" rid="pcbi.1004970.ref028">28</xref>]. The smaller of the two principal curvatures is positive at any point in a single Gaussian distribution but is negative around the border of two Gaussian distributions. Therefore, once voxels that have negative curvature are removed from the blob, two or more nuclei should be detected easily in 3D images. Thus our approach solves the above problems of the classic clump splitting methods.</p>
</sec>
<sec id="sec005">
<title>Clump splitting in real 3D images</title>
<p>We applied the above approach to real 3D images (<xref ref-type="fig" rid="pcbi.1004970.g003">Fig 3</xref>). The original images were processed by denoising, background removal, and smoothing to obtain the preprocessed images. The peak detection algorithm could find only a peak from the bright nucleus, and the blob obtained by watershed segmentation contained both nuclei. The principal curvatures of the iso-intensity surface were calculated from the preprocessed image. There were voxels of negative curvature in the area between two nuclei, but the area did not divide the two nuclei completely. The voxels of negative curvature were removed from the blob, and the blob was distance-transformed; these procedures were followed by 3D watershed segmentation. Thus, the two nuclei were separated, and the dark nucleus was successfully detected.</p>
<fig id="pcbi.1004970.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004970.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Illustration of the proposed method.</title>
<p>Results of each process are shown in each row. Columns show images at different <italic>x</italic><sub>3</sub> positions (focal planes).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.g003" xlink:type="simple"/>
</fig>
<p>After voxels of negative curvature were removed from the blobs, the size of blobs obtained by the second watershed segmentation tended to be smaller than real nuclei, and the distances between the blobs tended to be larger. To obtain the precise positions and sizes of the nuclei, least squares fitting with a Gaussian mixture was applied to the entire 3D image using a newly developed method (see <xref ref-type="sec" rid="sec010">Methods</xref>). The number of Gaussian distributions and the initial values of the centers of the distributions were derived from the above results.</p>
<p>Repeated application of watershed segmentation may increase over-segmentation. If the distance between two fitted Gaussian distributions is too small, the two distributions may represent the same nuclei. In this case, one of the two distributions was removed to avoid over-segmentation, and the fitting procedure was repeated with a single Gaussian distribution.</p>
<p>The proposed method detected 194 out of 198 nuclei in the 3D image (<xref ref-type="fig" rid="pcbi.1004970.g004">Fig 4</xref>). Among the four overlooked nuclei, the intensities of two of them were too low to be detected. The other two had moderate intensities but were adjacent to brighter nuclei. In these cases, curvature-based clump splitting successfully split the two nuclei. However, deviations of the brighter nuclei from Gaussian distributions disrupted the fitting of the Gaussian distributions and resulted in misplacement of the Gaussian distributions for the darker nuclei, which were instead fitted to the brighter nuclei. On the other hand, the proposed method returned 11 false positives. Two of them resulted from the misplacement of the Gaussian distribution for the darker nuclei described above. Four of them were not neuronal nuclei but were fluorescence foci intrinsic to the gut. Three of them were the result of over-segmentation of complex-shaped non-neuronal nuclei. One of them was mislocalized fluorescence in the cytosol. The last one was the result of over-segmentation of a large nucleus that was fitted with two Gaussian distributions separated by a distance larger than the cutoff distance.</p>
<fig id="pcbi.1004970.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004970.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Nuclei detected by the proposed method.</title>
<p>True positives, false positives, and false negatives are shown as red, cyan, and yellow ellipses, respectively. Original image is the same as <xref ref-type="fig" rid="pcbi.1004970.g001">Fig 1A</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Comparison with other segmentation methods</title>
<p>We compared the performance of the proposed method with five previously published methods for nucleus segmentation (<xref ref-type="fig" rid="pcbi.1004970.g005">Fig 5</xref> and <xref ref-type="table" rid="pcbi.1004970.t001">Table 1</xref>). Ilastik [<xref ref-type="bibr" rid="pcbi.1004970.ref029">29</xref>] is based on machine learning techniques and uses image features such as Laplacian of Gaussian. FARSight [<xref ref-type="bibr" rid="pcbi.1004970.ref030">30</xref>] is based on graph cut techniques. RPHC [<xref ref-type="bibr" rid="pcbi.1004970.ref001">1</xref>] was designed for multi-object tracking problems such as whole-brain activity imaging of <italic>C</italic>. <italic>elegans</italic> and uses a numerical optimization-based peak detection technique for object detection. 3D watershed plugin in ImageJ [<xref ref-type="bibr" rid="pcbi.1004970.ref031">31</xref>] consists of local peak detection and seeded watershed. This method is almost the same as the conventional blob detection method used in our proposed method. CellSegmentation3D [<xref ref-type="bibr" rid="pcbi.1004970.ref032">32</xref>] uses gradient flow tracking techniques and was developed for clump splitting. This method has been used in the study of automated nucleus detection and annotation in 3D images of adult <italic>C</italic>. <italic>elegans</italic> [<xref ref-type="bibr" rid="pcbi.1004970.ref033">33</xref>]. We applied these six methods to 12 animals in Data 1 (<xref ref-type="fig" rid="pcbi.1004970.g005">Fig 5</xref>) and obtained the performance indices (<xref ref-type="table" rid="pcbi.1004970.t001">Table 1</xref>, see <xref ref-type="sec" rid="sec010">Methods</xref>). The parameters of each method were optimized for the dataset.</p>
<fig id="pcbi.1004970.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004970.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Segmentation results of proposed and previously published methods.</title>
<p>Each row shows the original image or the segmentation result of the indicated method. Left column shows the three dimensional projection of the result. Middle column shows the two-dimensional section of the result. Right column shows the enlarged view of the image in the middle column. Each segmented region is assigned a different color.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.g005" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1004970.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004970.t001</object-id>
<label>Table 1</label> <caption><title>Performance of proposed and the state-of-the-art methods.</title></caption>
<alternatives>
<graphic id="pcbi.1004970.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center">Proposed</th>
<th align="center">Ilastik</th>
<th align="center">FARSight</th>
<th align="center">RPHC</th>
<th align="center">3D watershed</th>
<th align="center">CellSegmentation3D</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">TP</td>
<td align="right">184.92</td>
<td align="right">169.67</td>
<td align="right">155.25</td>
<td align="right">141.67</td>
<td align="right">161.17</td>
<td align="right">152.33</td>
</tr>
<tr>
<td align="left">FP</td>
<td align="right">9.42</td>
<td align="right">5.08</td>
<td align="right">3.92</td>
<td align="right">11.50</td>
<td align="right">22.08</td>
<td align="right">40.33</td>
</tr>
<tr>
<td align="left">FN</td>
<td align="right">6.00</td>
<td align="right">21.25</td>
<td align="right">35.67</td>
<td align="right">49.25</td>
<td align="right">29.75</td>
<td align="right">38.58</td>
</tr>
<tr>
<td align="left">Found</td>
<td align="right">194.33</td>
<td align="right">174.75</td>
<td align="right">159.17</td>
<td align="right">153.17</td>
<td align="right">183.25</td>
<td align="right">192.67</td>
</tr>
<tr>
<td align="left">TP rate</td>
<td align="right">0.9686</td>
<td align="right">0.8885</td>
<td align="right">0.8133</td>
<td align="right">0.7419</td>
<td align="right">0.8440</td>
<td align="right">0.7981</td>
</tr>
<tr>
<td align="left">FP rate</td>
<td align="right">0.0493</td>
<td align="right">0.0265</td>
<td align="right">0.0205</td>
<td align="right">0.0602</td>
<td align="right">0.1158</td>
<td align="right">0.2115</td>
</tr>
<tr>
<td align="left">FN rate</td>
<td align="right">0.0314</td>
<td align="right">0.1115</td>
<td align="right">0.1867</td>
<td align="right">0.2581</td>
<td align="right">0.1560</td>
<td align="right">0.2019</td>
</tr>
<tr>
<td align="left">F-measure</td>
<td align="right">0.9602</td>
<td align="right">0.9277</td>
<td align="right">0.8865</td>
<td align="right">0.8232</td>
<td align="right">0.8615</td>
<td align="right">0.7943</td>
</tr>
<tr>
<td align="left">Accuracy</td>
<td align="right">0.9239</td>
<td align="right">0.8657</td>
<td align="right">0.7969</td>
<td align="right">0.7001</td>
<td align="right">0.7572</td>
<td align="right">0.6597</td>
</tr>
<tr>
<td align="left">Time (sec)</td>
<td align="right">202.60</td>
<td align="right">240.75</td>
<td align="right">14.73</td>
<td align="right">537.41</td>
<td align="right">40.98</td>
<td align="right">352.70</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>The means of 12 animals are shown. TP, FP and FN mean True Positive, False Positive and False Negative, respectively. The mean of the Grand Truth (GT) is 190.92. The details of performance indices are described in Methods section.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>The 3D images in the dataset contains 190.92 nuclei on average, based on manual counting. The proposed method found 96.9% of the nuclei and the false negative rate was 3.1%, whereas the false negative rate of the other methods were 11.2% or more. The false positive rate of the proposed method was 4.9% and that of the other methods ranged from 2.1% to 21.2%. The proposed method shows the best performance with both of the well-established indices, F-measure [<xref ref-type="bibr" rid="pcbi.1004970.ref012">12</xref>] and Accuracy [<xref ref-type="bibr" rid="pcbi.1004970.ref034">34</xref>], because of the very low false negative rate and modest false positive rate.</p>
<p>It should be noted that all of the compared methods overlooked more than 10% of nuclei in our dataset. The reason for this was suggested by the segmentation results, in which almost all of these methods failed to detect the dark nuclei near the bright nuclei and fused them (<xref ref-type="fig" rid="pcbi.1004970.g005">Fig 5</xref>, right column). These results suggest that all the compared methods have difficulty in handling 3D images with either large variance of object intensity or dense packing of objects, or both (<xref ref-type="supplementary-material" rid="pcbi.1004970.s001">S1 Fig</xref>).</p>
<p>These results clearly indicate that our proposed method detects densely distributed cell nuclei in 3D space with highest accuracy. Very low false negative rate is the most significant improvement of the proposed method from the other methods, suggesting that the proposed method will improve efficiency and accuracy of image analysis steps drastically.</p>
</sec>
<sec id="sec007">
<title>GUI for visualization and error correction</title>
<p>Because none of the computational image analysis methods is perfect, experimenters should be able to correct any errors they find. Therefore, a user-friendly graphical user interface (GUI) for visualization and correction of the results is required. We developed a GUI called RoiEdit3D for visualizing the result of the proposed method and correcting it manually (<xref ref-type="supplementary-material" rid="pcbi.1004970.s002">S2 Fig</xref>). Because RoiEdit3D is based on ImageJ/Fiji [<xref ref-type="bibr" rid="pcbi.1004970.ref035">35</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref036">36</xref>] in MATLAB through Miji [<xref ref-type="bibr" rid="pcbi.1004970.ref037">37</xref>], experimenters can use the familiar interface and tools of ImageJ directly. Developers can extend the functionality using a favorite framework chosen from various options such as ImageJ macros, Java, MATLAB scripts, and C++ languages. Interface with downstream analyses should be straightforward because the corrected results are saved in the standard MATLAB data format and can be exported to Microsoft Excel.</p>
<p>Three-dimensional images are shown as trihedral figures using the customized Orthogonal View plugin in ImageJ (<xref ref-type="supplementary-material" rid="pcbi.1004970.s002">S2 Fig</xref>). Fitted Gaussian distributions are shown as ellipsoidal regions of interest (ROIs) in each view. The parameters of the Gaussian distributions are shown in the Customized ROI Manager window in tabular form. The Customized ROI Manager and trihedral figures are linked, and selected ROIs are highlighted in both windows. When the parameters of the distributions or the names of nuclei are changed in the Customized ROI Manager window, the corresponding ROIs in the trihedral figures are updated immediately. Least squares fitting with a Gaussian mixture can be applied after ROIs are manually removed or added.</p>
</sec>
<sec id="sec008">
<title>Application for whole-brain activity imaging</title>
<p>RoiEdit3D can be used for multi-object tracking. The fitted Gaussian mixture at a time point is used as an initial value for the mixture at the next time point, and a fitting procedure is executed (<xref ref-type="fig" rid="pcbi.1004970.g006">Fig 6A</xref>). Additionally, the intensities of nuclei can be obtained as parameters of the fitted Gaussian distributions.</p>
<fig id="pcbi.1004970.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004970.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Methods and results of tracking using RoiEdit3D.</title>
<p><bold>(A)</bold> Schematic illustration of the tracking method. <bold>(B)</bold> Part of the data used for tracking (Data 2). Three-dimensional image of the first time point is shown as the max projected image of the right half of the animal. Neuronal nucleus marker is shown in red, and calcium indicator is shown in light blue. ROI of ASER is shown as a yellow ellipse. Other ROIs appear as blue ellipses. <bold>(C)</bold> Time course of ASER response obtained by the calcium indicator. Gray area indicates the stimulation period.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.g006" xlink:type="simple"/>
</fig>
<p>We tried to track and measure the fluorescence intensity of nuclei in real time-lapse 3D images (Data2). The animal in the image expressed a calcium indicator, so neural activity during stimulation with the sensory stimulus, sodium chloride, could be measured as changes in the fluorescent intensity. The proposed nucleus detection method was applied to the first time point in the image and found 194 nuclei out of 198 nuclei. Seventeen false positives and four false negatives were corrected manually using RoiEdit3D. Then the nuclei in the time-lapse 3D image were tracked by the proposed method. Most of the nuclei were successfully tracked. One or more tracking errors occurred in 27 nuclei during 591 frames, and the success rate was 86.4%, which is comparable to that in the previous work [<xref ref-type="bibr" rid="pcbi.1004970.ref001">1</xref>]. The tracking process takes 19.83 sec per frame (total 3.25 hr).</p>
<p>The ASER gustatory neuron was successfully identified and tracked in the time-lapse 3D image by the proposed method (<xref ref-type="fig" rid="pcbi.1004970.g006">Fig 6B</xref>). The ASER neuron reportedly responds to changes in the sodium chloride concentration [<xref ref-type="bibr" rid="pcbi.1004970.ref038">38</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref039">39</xref>]. We identified a similar response of the ASER neuron using the proposed method (<xref ref-type="fig" rid="pcbi.1004970.g006">Fig 6C</xref>). This result indicates that the proposed method can be used for multi-object tracking and measuring, which is an essential function for whole-brain activity imaging.</p>
<p>Furthermore the proposed method was utilized to measure the fluorescence intensity of nuclei in time-lapse 2D images (Data 3). The proposed nucleus detection method was applied to the image for the first time point (<xref ref-type="supplementary-material" rid="pcbi.1004970.s003">S3 Fig</xref>). Data 3 does not contain images of a highly-localized nuclear marker, and therefore the images of calcium indicator that was weakly localized to the nuclei were used instead. The proposed method found 7 nuclei out of 9 nuclei. Six false positives and two false negatives were corrected manually using RoiEdit3D. Then the nuclei were tracked by the proposed method. All of the nuclei were successfully tracked during 241 time frames. The ASER neuron was successfully identified and tracked in the 2D images. The response of the ASER neuron in the 2D images (<xref ref-type="supplementary-material" rid="pcbi.1004970.s003">S3 Fig</xref>) is similar to that in the 3D images. This result indicates that the proposed method can be used for multi-object tracking and measuring of 2D images as well as 3D images.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>In this article, we proposed a method that accurately detects neuronal nuclei densely distributed in 3D space. Our GUI enables visualization and manual correction of the results of automatic detection of nuclei from 3D images as well as 2D images. Additionally, our GUI successfully tracked and measured multiple objects in time-lapse 2D and 3D images. Thus, the proposed method can be used as a comprehensive tool for analysis of neuronal activity, including whole-brain activity imaging.</p>
<p>Although the microscopy methods for whole-brain activity imaging of <italic>C</italic>. <italic>elegans</italic> have been intensively developed in recent years [<xref ref-type="bibr" rid="pcbi.1004970.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004970.ref020">20</xref>], computational image analysis methods were underdeveloped. In these works, the neuronal nuclei in the whole-brain activity imaging data were detected either manually or automatically by peak detection. Manual detection is most reliable but time- and labor-consuming, whereas the accuracy of the automatic peak detection is relatively low because of overlooking dark nuclei near bright nuclei. Our proposed method will reduce the difficulty and improve the accuracy. Furthermore, the numbers of the neuronal nuclei found or tracked in these four works were less than the real number of neuronal nuclei [<xref ref-type="bibr" rid="pcbi.1004970.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004970.ref021">21</xref>]. The scarcity may be due not only to the experimental limitations such as fluctuation of fluorescent protein expression or low image resolution, but also to the limitations of the image analysis methods that may overlook nuclei. The proposed method can detect almost all the nuclei in our whole-brain activity imaging data (<xref ref-type="fig" rid="pcbi.1004970.g006">Fig 6</xref>), suggesting that the proposed method can avoid errors that may be caused by overlooking nuclei, such as erroneous measurements of neural activities and misidentifications of neuron classes. Thus, our method will be highly useful for the purpose.</p>
<p>Peng and colleagues have intensively developed the computational methods for automatic annotation of cell nuclei in <italic>C</italic>. <italic>elegans</italic> [<xref ref-type="bibr" rid="pcbi.1004970.ref033">33</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref040">40</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref041">41</xref>]. Although their methods successfully annotate cells in many tissue such as body wall muscles and intestine, the methods seem not to be applicable to annotations of head neurons in adult worms, which is highly desired in the field of whole-brain activity imaging [<xref ref-type="bibr" rid="pcbi.1004970.ref020">20</xref>]. They pointed out that the positions of neuronal nuclei in adult worms are highly variable [<xref ref-type="bibr" rid="pcbi.1004970.ref033">33</xref>] and this may be one of the reasons for the difficulty. The accuracy of detection and segmentation of neuronal nuclei may be another reasons because CellSegmentation3D that was incorporated in their latest annotation framework [<xref ref-type="bibr" rid="pcbi.1004970.ref033">33</xref>] shows compromised performance in our dataset (<xref ref-type="table" rid="pcbi.1004970.t001">Table 1</xref>, <xref ref-type="fig" rid="pcbi.1004970.g005">Fig 5</xref>). Our proposed method improves the accuracy of neuronal nucleus detection and will promote developing the automatic annotation methods for the neurons. It is noteworthy that the method of simultaneous detection and annotation of cells [<xref ref-type="bibr" rid="pcbi.1004970.ref041">41</xref>] is unique and useful in the studies of <italic>C</italic>. <italic>elegans</italic>. Because the method assigns the positions of reference to the sample image directly and avoid the detection step, the method find cells without overlooking under some conditions, but would not work correctly under the large variation of the numbers or the relative positions of the nuclei, both of which are observed in our dataset.</p>
<p>The optimal method for accurate detection of nuclei will vary depending on the characteristics of the nuclei. Many conditions such as the visualization method, shape, and distribution of nuclei will affect these characteristics. In our case, the distributions of the fluorescence intensity of nuclei were similar to Gaussian distributions; thus, we developed an optimal method for such cases. Even if an original image does not have these characteristics, some preprocessing steps such as applying a Gaussian smoothing filter may enable application of our method to the image.</p>
<p>Although choosing the optimal method and tuning its parameters might be more work than manual identification, the automatic detection method would improve subjectivity and effectivity. In the field of biology, it is often the case that hundreds or thousands of animals should be analyzed equally well. In such case, manual detection would be time-consuming and the automatic detection method would be required.</p>
<p>For tracking the nuclei in time lapse images, we can apply the detection method to each time frame separately and then link the detected nuclei between frames. In this case, some false negatives and false positives would be separately produced for each frame, and they might disrupt the link step, resulting in increase of tracking errors. On the other hand, in the proposed method, the result of the automatic detection could be corrected manually, resulting in decrease of tracking errors.</p>
<p>The proposed tracking method is a simplistic approach. Combination with existing excellent tracking methods will likely improve tracking performance of the proposed method. Cell division and cell death did not occur in our data, but they are fundamental problems in the analysis of embryonic development. It may be important to improve our method if it is to be applied to these problems so that the method handles such phenomena appropriately.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec011">
<title>Strains and cultures</title>
<p><italic>C</italic>. <italic>elegans</italic> strains JN2100 and JN2101 were used in this study. Animals were raised on nematode growth medium at 20°C. <italic>E</italic>. <italic>coli</italic> strain OP50 was used as a food source.</p>
<sec id="sec012">
<title>JN2100</title>
<p>The genotype of the strain JN2100 is <italic>Is[H20p</italic>::<italic>NLS4</italic>::<italic>mCherry]</italic>. In this strain, the nuclei of all neurons are marked by the red fluorescent protein mCherry [<xref ref-type="bibr" rid="pcbi.1004970.ref042">42</xref>]. The <italic>H20</italic> promoter (<italic>H20p</italic>) is a 2479 bp DNA fragment derived from an upstream region of the <italic>rimb-1</italic> gene of <italic>C</italic>. <italic>elegans</italic> and drives gene expression in a pan-neuronal manner. mCherry was fused with four tandem repeats of nuclear localization signal (NLS) peptides and localized to the nuclei. The strain was generated by injection of an expression vector containing <italic>H20p</italic>::<italic>NLS4</italic>::<italic>mCherry</italic> to the Bristol N2 strain (wild type), integration of the transgene into the genome by UV irradiation, and outcrossing with N2 three times.</p>
</sec>
<sec id="sec013">
<title>JN2101</title>
<p>The genotype of the strain JN2101 is <italic>Is[H20p</italic>::<italic>NLS4</italic>::<italic>mCherry]; Ex [tax-4p</italic>::<italic>nls-YC2</italic>.<italic>60</italic>, <italic>lin-44p</italic>::<italic>GFP]</italic>. In this strain, a genetically encoded calcium indicator (GECI) is expressed in some sensory neurons and reports the activity of these neurons. The <italic>tax-4</italic> promoter (<italic>tax-4p</italic>) is a 3132 bp DNA fragment derived from the upstream region of the <italic>tax-4</italic> gene of <italic>C</italic>. <italic>elegans</italic> and drives gene expression in a subset of sensory neurons including the ASER gustatory neuron [<xref ref-type="bibr" rid="pcbi.1004970.ref043">43</xref>]. <italic>Yellow-Cameleon 2</italic>.<italic>60</italic> (<italic>YC2</italic>.<italic>60</italic>) is a type of GECI and reports the Ca<sup>2+</sup> concentration, which changes with neuronal activity, as the ratio of the fluorescence intensity of yellow fluorescent protein (YFP) to that of cyan fluorescent protein (CFP) [<xref ref-type="bibr" rid="pcbi.1004970.ref044">44</xref>]. YC2.60 was fused with an NLS peptide and localized mainly to the nuclei. The strain was generated by injection of an expression vector containing <italic>tax-4p</italic>::<italic>nls-YC2</italic>.<italic>60</italic> with a transformation marker (<italic>lin-44p</italic>::<italic>GFP</italic>, expressed in tail hypodermis cells) to JN2100.</p>
</sec>
</sec>
<sec id="sec014">
<title>Datasets</title>
<p>We used three datasets in this study. Data1 and 2 contain ~200 neuronal nuclei, and Data3 contains 9 nuclei. The positions of the centers of the nuclei were manually corrected by experimental specialists using the proposed GUI.</p>
<sec id="sec015">
<title>Data 1</title>
<p>A set of static 3D single-channel images of strain JN2100 was used to test the nucleus detection performance of the proposed method. Day 1 adult animals were mounted on a 2% agar pad and paralyzed by sodium azide. The fluorescence of mCherry was observed using laser scanning confocal microscopy (Leica SP5 with 63× water immersion lens and 2× zoom). The sizes of the images along the <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> axes were 512 and 256 voxels, respectively, and the size along the <italic>x</italic><sub>3</sub> axis varied from 142 to 175 voxels depending on the diameter of the animal. The sizes of a voxel along the <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, and <italic>x</italic><sub>3</sub> axes were 0.240, 0.240, and 0.252 μm, respectively.</p>
</sec>
<sec id="sec016">
<title>Data 2</title>
<p>A time series of 3D multichannel images of strain JN2101 was used to test the tracking performance of the proposed method. A day 1 adult animal was introduced and held in a microfluidic device called olfactory chip [<xref ref-type="bibr" rid="pcbi.1004970.ref045">45</xref>]. The animal and its head neurons moved to some extent in the device because the animal was not paralyzed. The animal was stimulated from 50 to 100 s after initiation of each experiment with a down-step concentration of sodium chloride [<xref ref-type="bibr" rid="pcbi.1004970.ref039">39</xref>], and the fluorescence in the CFP, YFP, and mCherry channels was observed simultaneously using customized spinning disk confocal microscopy. The sizes of the image along the <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, and <italic>x</italic><sub>3</sub> axes were 512, 256, and 20 voxels, respectively. The sizes of a voxel along the <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, and <italic>x</italic><sub>3</sub> axes were 0.33, 0.33, and 1.40 μm, respectively. The volumetric frame rate was 4.75 per second (95 planar frame rate), and 591 3D frames were recorded (about 124 s).</p>
</sec>
<sec id="sec017">
<title>Data 3</title>
<p>A time series of 2D multichannel images of strain JN2101 was used to test the detection and the tracking performance of the proposed method for 2D time lapse images. The experimental conditions for sample preparation and stimulation are same as Data 2 except stimulation period (51 to 151 frames after initiation of the experiment). The fluorescence in the CFP and YFP channels was observed simultaneously using DMI6000B inverted microscope with HCX PL APO 63x (NA 1.40) objective lens (Leica), a dual-view FRET imaging system DV2 (Photometrics) and an ImageEM EM-CCD camera (Hamamatsu Photonics) [<xref ref-type="bibr" rid="pcbi.1004970.ref046">46</xref>]. The sizes of the image along the <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> axes were 512 and 256, respectively. The sizes of a voxel along the <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> axes were 0.254 and 0.254 μm, respectively. The frame rate was 1.83 per second, and 241 2D frames were recorded (about 131 s).</p>
</sec>
</sec>
<sec id="sec018">
<title>Outline of the proposed method</title>
<p>The blobs of the nuclei were detected by the conventional method (Steps 1 &amp; 2). Under-segmented blobs were detected and split in Step 3. The precise positions and sizes of the nuclei were obtained in Step 4. The names and parameter values of the filters used in the proposed method are shown in <xref ref-type="supplementary-material" rid="pcbi.1004970.s005">S1 Table</xref>.</p>
<sec id="sec019">
<title>Step 1: Preprocessing</title>
<p>Parallel displacement along the <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> axes between images with different <italic>x</italic><sub>3</sub> or time axes was corrected on the basis of cross-correlation using the dftregistration function [<xref ref-type="bibr" rid="pcbi.1004970.ref047">47</xref>] implemented in MATLAB. If the data contained multiple channels or multiple time points, the images in one channel or one time point were extracted for nucleus detection. Next, the images were processed by a denoising filter (“Median 3D…” for Data 1), background subtraction (“Subtract Background…” for Data 1), and Gaussian blurring (“Gaussian Blur 3D…” for Data 1) using appropriate methods implemented in Fiji.</p>
</sec>
<sec id="sec020">
<title>Step 2: Segmentation</title>
<p>Obvious background voxels in the images were removed by thresholding using an appropriate method implemented in Fiji. Local intensity peaks of the 3D image were detected using the 3D maximum filter implemented in MATLAB. If there were two or more peaks within the radius of the 3D maximum filter, only the brightest one was regarded as a local peak, and the others were discarded. The local peaks were used as seeds for 3D seeded grayscale watershed segmentation implemented as “Marker-controlled Watershed” in the MorphoLibJ plugin in Fiji. Too-small objects were regarded as background noise and removed. Background voxels in each segmented subimage were removed by thresholding [<xref ref-type="bibr" rid="pcbi.1004970.ref048">48</xref>] implemented in MATLAB.</p>
</sec>
<sec id="sec021">
<title>Step 3: Clump splitting based on negative curvature</title>
<p>The curvature of the iso-intensity surface was calculated at each voxel (<xref ref-type="supplementary-material" rid="pcbi.1004970.s007">S2 Text</xref>) [<xref ref-type="bibr" rid="pcbi.1004970.ref028">28</xref>]. A segmented subimage was marked as under-segmented if the number of voxels having negative curvature in the subimage exceeded a threshold. If the voxels of negative curvature were not connected to the border of the subimage, they were regarded as noise and not counted. Voxels of negative curvature near the border of the subimage were regarded as part of a correct segmentation and not counted. If the subimages were marked as under-segmented, the voxels of negative curvature were removed, and the subimage was distance-transformed and segmented by the 3D seeded watershed algorithm.</p>
</sec>
<sec id="sec022">
<title>Step 4: Least squares fitting with a Gaussian mixture</title>
<p>The positions, shapes, and intensities of detected nuclei were obtained by fitting with a Gaussian mixture. The least squares fitting procedure is described in detail in <xref ref-type="supplementary-material" rid="pcbi.1004970.s001">S1 Text</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004970.s004">S4 Fig</xref>. The number of Gaussian distributions and the initial values of the centers of the distributions were derived from the results of clump splitting (previous step). The initial values of the covariance matrices of the distributions were fixed at a predefined default value. If the distance between the centers of two distributions was too small after fitting, either of the two distributions was removed, and the fitting procedure was repeated. After convergence, the scaling factors of the Gaussian distributions were estimated in other channels to obtain the intensities of the nuclei in these channels.</p>
<p>If the data contained multiple time points, the fitting procedure enabled tracking of the nuclei. The Gaussian mixture at the current time point was used as an initial value for the Gaussian mixture at the next time point, and the fitting procedure was executed without changing the eigenvalues of the covariance matrices (i.e., the size of the nuclei) [<xref ref-type="bibr" rid="pcbi.1004970.ref049">49</xref>]. This step was repeated for all the time points.</p>
<p>The proposed method was implemented as C, Java, and Matlab, then integrated as Matlab codes. In this study, the proposed method was tested on a desktop PC (3.2GHz 6-core Intel Core i7-3930K with 16GB memory, Windows 7 64bit). In order to confirm the portability of our method to Linux and cluster environment, the proposed method was tested on Shirokane3 supercomputing system (Human Genome Center, the University of Tokyo).</p>
</sec>
</sec>
<sec id="sec023">
<title>Performance comparison</title>
<p>The performance of proposed method for cell detection was compared with five state-of-the-art methods: Ilastik, FARSight, RPHC, 3D watershed plugin in ImageJ, and CellSegmentation3D. Ilastik is machine learning-based method and required a training data that was created manually. The parameters of RPHC was the same as the literature [<xref ref-type="bibr" rid="pcbi.1004970.ref001">1</xref>]. The parameters of the other methods were optimized based on F-measure and accuracy. The parallel displacements of the raw 3D images of 12 animals in Data 1 was corrected, and the methods were applied to the images. Because FARSight crashed during processing, its command line version (segment_nuclei.exe) was used [<xref ref-type="bibr" rid="pcbi.1004970.ref050">50</xref>]. The input images for FARSight and CellSegmentation3D were converted to 8-bit images because they could not operate with 32-bit grayscale images. For CellSegmentation3D, because it could not operate with our whole 3D image, the input images were divided and processed separately. The comparison was performed and the processing time was measured on the same PC as that used for the proposed method. All the methods other than CellSegmentation3D might be able to utilize multi-threading.</p>
<p>The centroids of the segmented regions obtained by each program were used as the representative points of the objects. For the proposed method, the means of the fitted Gaussian distributions (<italic>μ</italic><sub><italic>k</italic></sub>) were used as the representative points. The Euclid distances of the representative points and manually pointed Ground Truth were obtained. If a representative point was nearest-neighbor of a point of Ground Truth and vice versa, the object was regarded as a True Positive. If only the former condition was met, the Ground Truth was regarded as a False Negative. If only the latter condition was met, the object was regarded as a False Positive.</p>
<p>We obtained the indices of the performance [<xref ref-type="bibr" rid="pcbi.1004970.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref034">34</xref>,<xref ref-type="bibr" rid="pcbi.1004970.ref050">50</xref>] as follows:
<disp-formula id="pcbi.1004970.e003">
<alternatives>
<graphic id="pcbi.1004970.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004970.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004970.e004">
<alternatives>
<graphic id="pcbi.1004970.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004970.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mi>F</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004970.e005">
<alternatives>
<graphic id="pcbi.1004970.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004970.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mi>F</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004970.e006">
<alternatives>
<graphic id="pcbi.1004970.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004970.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mi>F</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004970.e007">
<alternatives>
<graphic id="pcbi.1004970.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004970.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mi>A</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
where
<disp-formula id="pcbi.1004970.e008">
<alternatives>
<graphic id="pcbi.1004970.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004970.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
GT, TP, FP and FN mean Ground Truth, True Positive, False Positive and False Negative, respectively.</p>
</sec>
</sec>
<sec id="sec024">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004970.s001" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Shape and spatial distribution of nuclei obtained by the proposed method.</title>
<p>(<bold>A–C</bold>) Radius of the nuclei in Data 1. The half-radii of fitted ellipsoids are obtained as the square roots of the eigenvalues of the covariance matrices of the fitted Gaussian distributions. (<bold>D</bold>) Shape of the nuclei measured as a ratio of maximum and minimum lengths of axes of the ellipsoids. (<bold>E</bold>) Distances to nearest neighbors of nuclei obtained as minimum distance between centers of the fitted Gaussian distributions. (<bold>F</bold>) Fluorescence intensities of nuclei obtained as the scaling parameters <italic>π</italic><sub><italic>k</italic></sub> of the fitted Gaussian distributions.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004970.s002" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Screenshot of RoiEdit3D.</title>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004970.s003" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>A tracking result for 2-dimensional time series images.</title>
<p><bold>(A)</bold> The image at the first time point of Data 3 (2-dimsnional time series images) is shown. For presentation, only the CFP channel of the calcium indicator Yellow Cameleon is shown in light blue. ROI of ASER is shown as a yellow ellipse. Other ROIs appear as blue ellipses. <bold>(B)</bold> Time course of ASER response obtained by the calcium indicator. Gray area indicates the stimulation period.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004970.s004" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Verification of proposed alternate optimization procedure.</title>
<p>Time courses indicate the progress of the optimization procedures for the 3D images of 12 animals in Data 1. Table shows fitness scores of procedures for each animal and the number of trials having scores within 110% of the best score.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004970.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.s005" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Names and parameter values of filters used in the proposed method.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004970.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.s006" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Procedure for least squares fitting with a Gaussian mixture.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004970.s007" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004970.s007" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Procedure for calculation of principal curvatures of iso-intensity surfaces.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>A part of the computing resources was provided by the Shirokane3 supercomputing system of the Human Genome Center (the University of Tokyo). We thank Y. Satoh and other members of our laboratories for helpful discussions and technical assistance with the experiments.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004970.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tokunaga</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hirose</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Kawaguchi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Toyoshima</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Teramoto</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ikebata</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Automated detection and tracking of many cells by using 4D live-cell imaging data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>i43</fpage>–<lpage>i51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu271" xlink:type="simple">10.1093/bioinformatics/btu271</ext-link></comment> <object-id pub-id-type="pmid">24932004</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ahrens</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Orger</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Robson</surname> <given-names>DN</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>PJ</given-names></name>. <article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>: <fpage>413</fpage>–<lpage>420</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2434" xlink:type="simple">10.1038/nmeth.2434</ext-link></comment> <object-id pub-id-type="pmid">23524393</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prevedel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yoon</surname> <given-names>Y-G</given-names></name>, <name name-style="western"><surname>Hoffmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pak</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wetzstein</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kato</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Simultaneous whole-animal 3D imaging of neuronal activity using light-field microscopy</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>: <fpage>727</fpage>–<lpage>730</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2964" xlink:type="simple">10.1038/nmeth.2964</ext-link></comment> <object-id pub-id-type="pmid">24836920</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lemon</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>Pulver</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Höckendorf</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>McDole</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Branson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Freeman</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Whole-central nervous system functional imaging in larval Drosophila</article-title>. <source>Nat Commun</source>. <year>2015</year>;<volume>6</volume>: <fpage>7924</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms8924" xlink:type="simple">10.1038/ncomms8924</ext-link></comment> <object-id pub-id-type="pmid">26263051</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tainaka</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kubota</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Suyama</surname> <given-names>TQ</given-names></name>, <name name-style="western"><surname>Susaki</surname> <given-names>E a</given-names></name>, <name name-style="western"><surname>Perrin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ukai-Tadenuma</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Whole-body imaging with single-cell resolution by tissue decolorization</article-title>. <source>Cell</source>. Elsevier Inc.; <year>2014</year>;<volume>159</volume>: <fpage>911</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.10.034" xlink:type="simple">10.1016/j.cell.2014.10.034</ext-link></comment> <object-id pub-id-type="pmid">25417165</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Susaki</surname> <given-names>E a.</given-names></name>, <name name-style="western"><surname>Tainaka</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Perrin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kishino</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Tawara</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>TM</given-names></name>, <etal>et al</etal>. <article-title>Whole-brain imaging with single-cell resolution using chemical cocktails and computational analysis</article-title>. <source>Cell</source>. Elsevier; <year>2014</year>;<volume>157</volume>: <fpage>726</fpage>–<lpage>739</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.03.042" xlink:type="simple">10.1016/j.cell.2014.03.042</ext-link></comment> <object-id pub-id-type="pmid">24746791</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hama</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kurokawa</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kawano</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ando</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shimogori</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Noda</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Scale: a chemical approach for fluorescence imaging and reconstruction of transparent mouse brain [Internet]</article-title>. <source>Nature Neuroscience</source>. Nature Publishing Group; <year>2011</year>. pp. <fpage>1481</fpage>–<lpage>1488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2928" xlink:type="simple">10.1038/nn.2928</ext-link></comment> <object-id pub-id-type="pmid">21878933</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ke</surname> <given-names>M-T</given-names></name>, <name name-style="western"><surname>Fujimoto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Imai</surname> <given-names>T</given-names></name>. <article-title>SeeDB: a simple and morphology-preserving optical clearing agent for neuronal circuit reconstruction</article-title>. <source>Nat Neurosci</source>. Nature Publishing Group; <year>2013</year>;<volume>16</volume>: <fpage>1154</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3447" xlink:type="simple">10.1038/nn.3447</ext-link></comment> <object-id pub-id-type="pmid">23792946</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chung</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wallace</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>S-Y</given-names></name>, <name name-style="western"><surname>Kalyanasundaram</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Andalman</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>TJ</given-names></name>, <etal>et al</etal>. <article-title>Structural and molecular interrogation of intact biological systems</article-title>. <source>Nature</source>. Nature Publishing Group; <year>2013</year>;<volume>497</volume>: <fpage>332</fpage>–<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12107" xlink:type="simple">10.1038/nature12107</ext-link></comment> <object-id pub-id-type="pmid">23575631</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oberlaender</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dercksen</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Egger</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gensel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hege</surname> <given-names>HC</given-names></name>. <article-title>Automated three-dimensional detection and counting of neuron somata</article-title>. <source>J Neurosci Methods</source>. <year>2009</year>;<volume>180</volume>: <fpage>147</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2009.03.008" xlink:type="simple">10.1016/j.jneumeth.2009.03.008</ext-link></comment> <object-id pub-id-type="pmid">19427542</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Latorre</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Alonso-Nanclares</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Muelas</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Peña</surname> <given-names>J-M</given-names></name>, <name name-style="western"><surname>Defelipe</surname> <given-names>J</given-names></name>. <article-title>3D segmentations of neuronal nuclei from confocal microscope image stacks</article-title>. <source>Front Neuroanat</source>. <year>2013</year>;<volume>7</volume>: <fpage>49</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnana.2013.00049" xlink:type="simple">10.3389/fnana.2013.00049</ext-link></comment> <object-id pub-id-type="pmid">24409123</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bashar</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Yamagata</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kobayashi</surname> <given-names>TJ</given-names></name>. <article-title>Improved and robust detection of cell nuclei from four dimensional fluorescence images</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>: <fpage>e101891</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0101891" xlink:type="simple">10.1371/journal.pone.0101891</ext-link></comment> <object-id pub-id-type="pmid">25020042</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bashar</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Komatsu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Fujimori</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kobayashi</surname> <given-names>TJ</given-names></name>. <article-title>Automatic extraction of nuclei centroids of mouse embryonic cells from fluorescence microscopy images</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>: <fpage>e35550</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0035550" xlink:type="simple">10.1371/journal.pone.0035550</ext-link></comment> <object-id pub-id-type="pmid">22590505</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Azuma</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Onami</surname> <given-names>S</given-names></name>. <article-title>Evaluation of the effectiveness of simple nuclei-segmentation methods on Caenorhabditis elegans embryogenesis images</article-title>. <source>BMC Bioinformatics</source>. BMC Bioinformatics; <year>2013</year>;<volume>14</volume>: <fpage>295</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-14-295" xlink:type="simple">10.1186/1471-2105-14-295</ext-link></comment> <object-id pub-id-type="pmid">24090283</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Boyle</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ooi</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Sandel</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Waterston</surname> <given-names>RH</given-names></name>. <article-title>Automated cell lineage tracing in Caenorhabditis elegans</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2006</year>;<volume>103</volume>: <fpage>2707</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0511111103" xlink:type="simple">10.1073/pnas.0511111103</ext-link></comment> <object-id pub-id-type="pmid">16477039</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meijering</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dzyubachyk</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Smal</surname> <given-names>I</given-names></name>. <article-title>Methods for cell and particle tracking</article-title>. <source>Methods Enzymol</source>. <year>2012</year>;<volume>504</volume>: <fpage>183</fpage>–<lpage>200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/B978-0-12-391857-4.00009-4" xlink:type="simple">10.1016/B978-0-12-391857-4.00009-4</ext-link></comment> <object-id pub-id-type="pmid">22264535</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stegmaier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Amat</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lemon</surname> <given-names>WC</given-names></name>, <name name-style="western"><surname>Teodoro</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mikut</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>PJ</given-names></name>, <etal>et al</etal>. <article-title>Real-Time Three-Dimensional Cell Segmentation in Large-Scale Microscopy Data of Developing Technology Real-Time Three-Dimensional Cell Segmentation in Large-Scale Microscopy Data of Developing Embryos</article-title>. <source>Dev Cell</source>. Elsevier Inc.; <year>2016</year>;<volume>36</volume>: <fpage>225</fpage>–<lpage>240</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.devcel.2015.12.028" xlink:type="simple">10.1016/j.devcel.2015.12.028</ext-link></comment> <object-id pub-id-type="pmid">26812020</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kato</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kaplan</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Schrödel</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Skora</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lindsay</surname> <given-names>TH</given-names></name>, <name name-style="western"><surname>Yemini</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Global Brain Dynamics Embed the Motor Command Sequence of Caenorhabditis elegans</article-title>. <source>Cell</source>. <year>2015</year>;<volume>163</volume>: <fpage>656</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2015.09.034" xlink:type="simple">10.1016/j.cell.2015.09.034</ext-link></comment> <object-id pub-id-type="pmid">26478179</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schrödel</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Prevedel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Aumayr</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Zimmer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vaziri</surname> <given-names>A</given-names></name>. <article-title>Brain-wide 3D imaging of neuronal activity in Caenorhabditis elegans with sculpted light</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>: <fpage>1013</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2637" xlink:type="simple">10.1038/nmeth.2637</ext-link></comment> <object-id pub-id-type="pmid">24013820</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nguyen</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Shipley</surname> <given-names>FB</given-names></name>, <name name-style="western"><surname>Linder</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Plummer</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Setru</surname> <given-names>SU</given-names></name>, <etal>et al</etal>. <article-title>Whole-brain calcium imaging with cellular resolution in freely behaving Caenorhabditis elegans</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2016</year>;<volume>113</volume>: <fpage>E1074</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1507110112" xlink:type="simple">10.1073/pnas.1507110112</ext-link></comment> <object-id pub-id-type="pmid">26712014</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Southgate</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name>. <article-title>The Structure of the Nervous System of the Nematode Caenorhabditis elegans [Internet]</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>1986</year>. pp. <fpage>1</fpage>–<lpage>340</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.1986.0056" xlink:type="simple">10.1098/rstb.1986.0056</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ong</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Jayasooriah</surname></name>, <name name-style="western"><surname>Yeow</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Sinniah</surname> <given-names>R</given-names></name>. <article-title>Decomposition of digital clumps into convex parts by contour tracing and labelling</article-title>. <source>Pattern Recognit Lett</source>. <year>1992</year>;<volume>13</volume>: <fpage>789</fpage>–<lpage>795</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0167-8655(92)90129-N" xlink:type="simple">10.1016/0167-8655(92)90129-N</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Ong</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jayasooriah</surname></name>, <name name-style="western"><surname>Sinniah</surname> <given-names>R</given-names></name>. <article-title>Clump splitting through concavity analysis</article-title>. <source>Pattern Recognit Lett</source>. <year>1994</year>;<volume>15</volume>: <fpage>1013</fpage>–<lpage>1018</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0167-8655(94)90033-7" xlink:type="simple">10.1016/0167-8655(94)90033-7</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>LaTorre</surname> <given-names>A.</given-names></name>, <name name-style="western"><surname>Alonso-Nanclares</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Muelas</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Peña</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>DeFelipe</surname> <given-names>J</given-names></name>. <article-title>Segmentation of neuronal nuclei based on clump splitting and a two-step binarization of images</article-title>. <source>Expert Syst Appl</source>. Elsevier Ltd; <year>2013</year>;<volume>40</volume>: <fpage>6521</fpage>–<lpage>6530</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.eswa.2013.06.010" xlink:type="simple">10.1016/j.eswa.2013.06.010</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bai</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>F</given-names></name>. <article-title>Splitting touching cells based on concave points and ellipse fitting</article-title>. <source>Pattern Recognit</source>. Elsevier; <year>2009</year>;<volume>42</volume>: <fpage>2434</fpage>–<lpage>2446</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.patcog.2009.04.003" xlink:type="simple">10.1016/j.patcog.2009.04.003</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref026"><label>26</label><mixed-citation publication-type="other" xlink:type="simple">Zhang C, Sun C, Su R, Pham TD. Segmentation of clustered nuclei based on curvature weighting. Proceedings of the 27th Conference on Image and Vision Computing New Zealand—IVCNZ ‘12. New York, New York, USA: ACM Press; 2012. p. 49. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/2425836.2425848" xlink:type="simple">10.1145/2425836.2425848</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Indhumathi</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>YY</given-names></name>, <name name-style="western"><surname>Guan</surname> <given-names>YQ</given-names></name>, <name name-style="western"><surname>Opas</surname> <given-names>M</given-names></name>. <article-title>An automatic segmentation algorithm for 3D cell cluster splitting using volumetric confocal images</article-title>. <source>J Microsc</source>. <year>2011</year>;<volume>243</volume>: <fpage>60</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1365-2818.2010.03482.x" xlink:type="simple">10.1111/j.1365-2818.2010.03482.x</ext-link></comment> <object-id pub-id-type="pmid">21288236</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thirion</surname> <given-names>J-P</given-names></name>, <name name-style="western"><surname>Gourdon</surname> <given-names>A</given-names></name>. <article-title>Computing the Differential Characteristics of Isointensity Surfaces</article-title>. <source>Comput Vis Image Underst</source>. <year>1995</year>;<volume>61</volume>: <fpage>190</fpage>–<lpage>202</lpage>.<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/cviu.1995.1015" xlink:type="simple">10.1006/cviu.1995.1015</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref029"><label>29</label><mixed-citation publication-type="other" xlink:type="simple">Sommer C, Straehle C, Kothe U, Hamprecht F a. Ilastik: Interactive learning and segmentation toolkit. 2011 IEEE International Symposium on Biomedical Imaging: From Nano to Macro. IEEE; 2011. pp. 230–233.<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/ISBI.2011.5872394" xlink:type="simple">10.1109/ISBI.2011.5872394</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Al-Kofahi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lassoued</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Roysam</surname> <given-names>B</given-names></name>. <article-title>Improved automatic detection and segmentation of cell nuclei in histopathology images</article-title>. <source>IEEE Trans Biomed Eng</source>. <year>2010</year>;<volume>57</volume>: <fpage>841</fpage>–<lpage>852</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TBME.2009.2035102" xlink:type="simple">10.1109/TBME.2009.2035102</ext-link></comment> <object-id pub-id-type="pmid">19884070</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ollion</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cochennec</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Loll</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Escudé</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Boudier</surname> <given-names>T</given-names></name>. <article-title>TANGO: A generic tool for high-throughput 3D image analysis for studying nuclear organization</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>: <fpage>1840</fpage>–<lpage>1841</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt276" xlink:type="simple">10.1093/bioinformatics/btt276</ext-link></comment> <object-id pub-id-type="pmid">23681123</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tarokh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nie</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Mara</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>3D cell nuclei segmentation based on gradient flow tracking</article-title>. <source>BMC Cell Biol</source>. <year>2007</year>;<volume>8</volume>: <fpage>40</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2121-8-40" xlink:type="simple">10.1186/1471-2121-8-40</ext-link></comment> <object-id pub-id-type="pmid">17784958</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aerni</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Do</surname> <given-names>CB</given-names></name>, <name name-style="western"><surname>Gross</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>SD</given-names></name>, <etal>et al</etal>. <article-title>Automated cellular annotation for high-resolution images of adult Caenorhabditis elegans</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>: <fpage>i18</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt223" xlink:type="simple">10.1093/bioinformatics/btt223</ext-link></comment> <object-id pub-id-type="pmid">23812982</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Song</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>M</given-names></name>. <article-title>Region-based progressive localization of cell nuclei in microscopic images with data adaptive modeling</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>: <fpage>173</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-14-173" xlink:type="simple">10.1186/1471-2105-14-173</ext-link></comment> <object-id pub-id-type="pmid">23725412</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneider</surname> <given-names>C a</given-names></name>, <name name-style="western"><surname>Rasband</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Eliceiri</surname> <given-names>KW</given-names></name>. <article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>. <source>Nature Methods</source>. Nature Publishing Group; <year>2012</year>. pp. <fpage>671</fpage>–<lpage>675</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2089" xlink:type="simple">10.1038/nmeth.2089</ext-link></comment> <object-id pub-id-type="pmid">22930834</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schindelin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Arganda-Carreras</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Frise</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kaynig</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Longair</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pietzsch</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Fiji: an open-source platform for biological-image analysis</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>: <fpage>676</fpage>–<lpage>682</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2019" xlink:type="simple">10.1038/nmeth.2019</ext-link></comment> <object-id pub-id-type="pmid">22743772</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sage</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Prodanov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tinevez</surname> <given-names>J-Y</given-names></name>, <name name-style="western"><surname>Schindelin</surname> <given-names>J</given-names></name>. <article-title>MIJ: Making Interoperablility between ImageJ and Matlab Possible</article-title>. <source>ImageJ User Dev Conf Poster</source>. <year>2012</year>; <volume>4</volume>. Available: <ext-link ext-link-type="uri" xlink:href="http://bigwww.epfl.ch/sage/soft/mij/Poster-MIJ-Daniel-Sage.pdf" xlink:type="simple">http://bigwww.epfl.ch/sage/soft/mij/Poster-MIJ-Daniel-Sage.pdf</ext-link></mixed-citation></ref>
<ref id="pcbi.1004970.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suzuki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Faumont</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ezcurra</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lockery</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name>. <article-title>Functional asymmetry in Caenorhabditis elegans taste neurons and its computational role in chemotaxis</article-title>. <source>Nature</source>. <year>2008</year>;<volume>454</volume>: <fpage>114</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06927" xlink:type="simple">10.1038/nature06927</ext-link></comment> <object-id pub-id-type="pmid">18596810</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kunitomo</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sato</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Iwata</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Satoh</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ohno</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Yamada</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Concentration memory-dependent synaptic plasticity of a taste circuit regulates salt concentration chemotaxis in Caenorhabditis elegans</article-title>. <source>Nat Commun</source>. Nature Publishing Group; <year>2013</year>;<volume>4</volume>: <fpage>2210</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms3210" xlink:type="simple">10.1038/ncomms3210</ext-link></comment> <object-id pub-id-type="pmid">23887678</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Long</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>E</given-names></name>. <article-title>A 3D digital atlas of C. elegans and its application to single-cell analyses</article-title>. <source>Nat Methods</source>. Nature Publishing Group; <year>2009</year>;<volume>6</volume>: <fpage>667</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1366" xlink:type="simple">10.1038/nmeth.1366</ext-link></comment> <object-id pub-id-type="pmid">19684595</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Long</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>H</given-names></name>. <article-title>Simultaneous recognition and segmentation of cells: application in C.elegans</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>: <fpage>2895</fpage>–<lpage>902</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr480" xlink:type="simple">10.1093/bioinformatics/btr480</ext-link></comment> <object-id pub-id-type="pmid">21849395</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shaner</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Campbell</surname> <given-names>RE</given-names></name>, <article-title>Steinbach P a, Giepmans BNG, Palmer AE, Tsien RY. Improved monomeric red, orange and yellow fluorescent proteins derived from Discosoma sp. red fluorescent protein</article-title>. <source>Nat Biotechnol</source>. <year>2004</year>;<volume>22</volume>: <fpage>1567</fpage>–<lpage>1572</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt1037" xlink:type="simple">10.1038/nbt1037</ext-link></comment> <object-id pub-id-type="pmid">15558047</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Komatsu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Mori</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Rhee</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Akaike</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ohshima</surname> <given-names>Y</given-names></name>. <article-title>Mutations in a cyclic nucleotide-gated channel lead to abnormal thermosensation and chemosensation in C. elegans</article-title>. <source>Neuron</source>. <year>1996</year>;<volume>17</volume>: <fpage>707</fpage>–<lpage>18</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/8893027" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/8893027</ext-link> <object-id pub-id-type="pmid">8893027</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nagai</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yamada</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tominaga</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ichikawa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Miyawaki</surname> <given-names>A</given-names></name>. <article-title>Expanded dynamic range of fluorescent indicators for Ca(2+) by circularly permuted yellow fluorescent proteins</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2004</year>;<volume>101</volume>: <fpage>10554</fpage>–<lpage>10559</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0400417101" xlink:type="simple">10.1073/pnas.0400417101</ext-link></comment> <object-id pub-id-type="pmid">15247428</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chronis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zimmer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bargmann</surname> <given-names>CI</given-names></name>. <article-title>Microfluidics for in vivo imaging of neuronal and behavioral activity in Caenorhabditis elegans</article-title>. <source>Nat Methods</source>. <year>2007</year>;<volume>4</volume>: <fpage>727</fpage>–<lpage>731</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth1075" xlink:type="simple">10.1038/nmeth1075</ext-link></comment> <object-id pub-id-type="pmid">17704783</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tomida</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Oda</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Takekawa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Iino</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Saito</surname> <given-names>H</given-names></name>. <article-title>The Temporal Pattern of Stimulation Determines the Extent and Duration of MAPK Activation in a Caenorhabditis elegans Sensory Neuron</article-title>. <source>Sci Signal</source>. <year>2012</year>;<volume>5</volume>: <fpage>ra76</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/scisignal.2002983" xlink:type="simple">10.1126/scisignal.2002983</ext-link></comment> <object-id pub-id-type="pmid">23074267</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guizar-Sicairos</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Thurman</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Fienup</surname> <given-names>JR</given-names></name>. <article-title>Efficient subpixel image registration algorithms</article-title>. <source>Opt Lett</source>. <year>2008</year>;<volume>33</volume>: <fpage>156</fpage>–<lpage>158</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1364/OL.33.000156" xlink:type="simple">10.1364/OL.33.000156</ext-link></comment> <object-id pub-id-type="pmid">18197224</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otsu</surname> <given-names>N</given-names></name>. <article-title>A Threshold Selection Method from Gray-Level Histograms</article-title>. <source>IEEE Trans Syst Man Cybern</source>. <year>1979</year>;<volume>9</volume>: <fpage>62</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TSMC.1979.4310076" xlink:type="simple">10.1109/TSMC.1979.4310076</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004970.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fukunaga</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kubota</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Oda</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Iwasaki</surname> <given-names>W</given-names></name>. <article-title>GroupTracker: Video tracking system for multiple animals under severe occlusion</article-title>. <source>Comput Biol Chem</source>. Elsevier Ltd; <year>2015</year>;<volume>57</volume>: <fpage>39</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.compbiolchem.2015.02.006" xlink:type="simple">10.1016/j.compbiolchem.2015.02.006</ext-link></comment> <object-id pub-id-type="pmid">25736254</object-id></mixed-citation></ref>
<ref id="pcbi.1004970.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mathew</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Schmitz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Muñoz-Descalzo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ansari</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Pampaloni</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Stelzer</surname> <given-names>EHK</given-names></name>, <etal>et al</etal>. <article-title>Robust and automated three-dimensional segmentation of densely packed cell nuclei in different biological specimens with Lines-of-Sight decomposition</article-title>. <source>BMC Bioinformatics</source>. BMC Bioinformatics; <year>2015</year>;<volume>16</volume>: <fpage>187</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12859-015-0617-x" xlink:type="simple">10.1186/s12859-015-0617-x</ext-link></comment> <object-id pub-id-type="pmid">26049713</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>