<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01190</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005038</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein domains</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Parasitology</subject><subj-group><subject>Parasite groups</subject><subj-group><subject>Apicomplexa</subject><subj-group><subject>Plasmodium</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Genomic databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genomic databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Molecular evolution</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Improvement in Protein Domain Identification Is Reached by Breaking Consensus, with the Agreement of Many Profiles and Domain Co-occurrence</article-title>
<alt-title alt-title-type="running-head">Domain Annotation by Multiple Profiles and Co-occurrence</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Bernardes</surname> <given-names>Juliana</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zaverucha</surname> <given-names>Gerson</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Vaquero</surname> <given-names>Catherine</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Carbone</surname> <given-names>Alessandra</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Sorbonne Universités, UPMC Univ-Paris 6, CNRS, UMR 7238, Laboratoire de Biologie Computationnelle et Quantitative, Paris, France</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>COPPE, Programa de Engenharia de Sistemas e Computação, Universidade Federal do Rio de Janeiro, Rio de Janeiro, Brazil</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Sorbonne Universités, UPMC Univ-Paris 6, INSERM U1135, CNRS ERL 8255, Centre d’Immunologie et des Maladies Infectieuses (CIMI-Paris), Paris, France</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Institut Universitaire de France, Paris, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Levitt</surname> <given-names>Michael</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Stanford University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: AC JB. Performed the experiments: JB. Analyzed the data: JB AC CV. Contributed reagents/materials/analysis tools: JB AC GZ. Wrote the paper: AC JB.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">juliana.silva_bernardes@upmc.fr</email> (JB); <email xlink:type="simple">alessandra.carbone@lip6.fr</email> (AC)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>29</day>
<month>7</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>7</issue>
<elocation-id>e1005038</elocation-id>
<history>
<date date-type="received">
<day>17</day>
<month>7</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>28</day>
<month>6</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Bernardes et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005038"/>
<abstract>
<p>Traditional protein annotation methods describe known domains with probabilistic models representing consensus among homologous domain sequences. However, when relevant signals become too weak to be identified by a global consensus, attempts for annotation fail. Here we address the fundamental question of domain identification for highly divergent proteins. By using high performance computing, we demonstrate that the limits of state-of-the-art annotation methods can be bypassed. We design a new strategy based on the observation that many structural and functional protein constraints are not globally conserved through all species but might be locally conserved in separate clades. We propose a novel exploitation of the large amount of data available: 1. for each known protein domain, several probabilistic <italic>clade-centered models</italic> are constructed from a large and differentiated panel of homologous sequences, 2. a decision-making protocol combines outcomes obtained from multiple models, 3. a multi-criteria optimization algorithm finds the most likely protein architecture. The method is evaluated for domain and architecture prediction over several datasets and statistical testing hypotheses. Its performance is compared against HMMScan and HHblits, two widely used search methods based on sequence-profile and profile-profile comparison. Due to their closeness to actual protein sequences, clade-centered models are shown to be more specific and functionally predictive than the broadly used consensus models. Based on them, we improved annotation of <italic>Plasmodium falciparum</italic> protein sequences on a scale not previously possible. We successfully predict at least one domain for 72% of <italic>P. falciparum</italic> proteins against 63% achieved previously, corresponding to 30% of improvement over the total number of Pfam domain predictions on the whole genome. The method is applicable to any genome and opens new avenues to tackle evolutionary questions such as the reconstruction of ancient domain duplications, the reconstruction of the history of protein architectures, and the estimation of protein domain age. Website and software: <ext-link ext-link-type="uri" xlink:href="http://www.lcqb.upmc.fr/CLADE" xlink:type="simple">http://www.lcqb.upmc.fr/CLADE</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Current sequence databases contain hundreds of billions of nucleotides coding for genes and a classification of these sequences is a primary problem in genomics. A reasonable way to organize these sequences is through their predicted domains, but the identification of domains in very divergent sequences, spanning the entire phylogenetic tree of species, is a difficult problem. By generating multiple probabilistic models for a domain, describing the spread of evolutionary patterns in different phylogenetic clades, we can effectively explore domains that are likely to be coded in gene sequences. Through a machine learning approach and optimization techniques, coding for expected evolutionary constraints, we filter the many possibilities of domain identification found for a gene and propose the most likely domain architecture associated to it. The application of this novel approach to the full genome of <italic>Plasmodium falciparum</italic>, to a dataset of sequences from three SCOP datasets highlights the interest of exploring multiple pathways of domain evolution in the aim of extracting biological information from genomic sequences. Our new computational approach was developed with the hope of providing a novel tier of accurate and precise tools that complement existing tools such as HMMer, HHblits and PSI-BLAST, by exploring in a novel way the large amount of sequence data available. The existence of powerful databases for sequences, domains and architectures help make this hope a reality.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004795</institution-id>
<institution>Institut Universitaire de France</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Carbone</surname> <given-names>Alessandra</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>CALSIMLAB</institution>
</funding-source>
<award-id>ANR-11-LABX-0037-0 (ANR-11-IDEX-0004-02)</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Carbone</surname> <given-names>Alessandra</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Grid’5000 - https://www.grid5000.fr</institution>
</funding-source>
</award-group>
<award-group id="award004">
<funding-source>
<institution>Equip@Meso</institution>
</funding-source>
<award-id>ANR-10-EQPX-29-01</award-id>
</award-group>
<funding-statement>This work undertaken (partially) in the framework of CALSIMLAB is supported by the public grant ANR-11-LABX-0037-0 from the “Investissements d’Avenir” program (ANR-11-IDEX-0004-02). Experiments were carried out using Grid’5000 (<ext-link ext-link-type="uri" xlink:href="https://www.grid5000.fr" xlink:type="simple">https://www.grid5000.fr</ext-link>) and the UPMC MESU machine financed by the project Equip@Meso (ANR-10-EQPX-29-01) of the “Investissements d’Avenir” program. Funds from the Institut Universitaire de France. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="2"/>
<page-count count="39"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data are available at the address: <ext-link ext-link-type="uri" xlink:href="http://www.lcqb.upmc.fr/CLADE" xlink:type="simple">http://www.lcqb.upmc.fr/CLADE</ext-link> and in the Supplementary Material submitted with the article.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The evolutionary history of eukaryotic proteins involves rapid sequence divergence, addition and deletion of protein domains, fusion and fission of genes. This implies that protein repertoires of distantly related species differ greatly (new architectures, that is combinations of domains, are many), while domain repertoires do not (new domains are few) [<xref ref-type="bibr" rid="pcbi.1005038.ref001">1</xref>]. To account for the great diversity of domain contexts in eukaryotes, an effort was made to categorize coding regions into protein domains and domain families. An important contribution issued by this effort is the Pfam database [<xref ref-type="bibr" rid="pcbi.1005038.ref002">2</xref>], a large collection of protein families, each represented by multiple sequence alignments (MSAs) and hidden Markov models (HMMs). Pfam also provides protein domain architectures and higher-level groupings of related domains (clans). It highlighted that different architectures give rise to the diversity of proteins found in nature, and that identifying domains of a protein can provide insights into its function. Hence, the complexity of protein annotation can be simplified by focusing on domains, even though the problem of unraveling domain organization (domain architecture) still remains.</p>
<p>Proteins sharing more than 30% of sequence identity have a high probability also to share the same fold [<xref ref-type="bibr" rid="pcbi.1005038.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref004">4</xref>]. Thus, since fold and function of a protein have generally an intimate relationship [<xref ref-type="bibr" rid="pcbi.1005038.ref005">5</xref>], strong sequence similarity is exploited by conventional alignment methods to reconstruct families of functionally related proteins and to accomplish genome annotations. Unfortunately, the complete sequencing of several organisms differing in physiology, habitat and genetics, as <italic>Plasmodium falciparum</italic>, brought to light the weakness of homology-based approaches to annotation [<xref ref-type="bibr" rid="pcbi.1005038.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref008">8</xref>]. This limitation is challenged even more by the large prokaryotic and eukaryotic metagenomic samples generated today.</p>
<p>Radically new homology-based annotation approaches combine information from physico-chemical properties of sequences and conserved amino acid positions in MSAs, together with sophisticated inference methods to extract a general profile (typically a profile HMM, in short pHMMs [<xref ref-type="bibr" rid="pcbi.1005038.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref010">10</xref>]) of a protein domain family and use it as a signature for homology detection [<xref ref-type="bibr" rid="pcbi.1005038.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref017">17</xref>]. This profile represents a consensus of signals characterizing a given domain in a multitude of different species. We shall speak of <italic>sequence consensus model</italic>, in short SCM. Conversely, other approaches [<xref ref-type="bibr" rid="pcbi.1005038.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref020">20</xref>] associate to each protein domain family several different profiles, built from a sample of diversified homologous sequences. The resulting set of profiles, for all protein domain families, is approximately six or seven times larger than the number of domain families, depending on the method. For instance, SUPERFAMILY [<xref ref-type="bibr" rid="pcbi.1005038.ref018">18</xref>] constructs 15 438 models for 1 962 SCOP superfamilies [<xref ref-type="bibr" rid="pcbi.1005038.ref021">21</xref>], and Gene3D [<xref ref-type="bibr" rid="pcbi.1005038.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref022">22</xref>] constructs 16 933 models for 2 738 domain families. Such sets of domain families are rather small compared to the number of distinct Pfam domains (14 831 for Pfam version 27) and one would like to generate and handle multiple models representing all Pfam domains. The co-occurrence of domains within a protein was also shown to be very powerful to accurately identify domains in divergent protein sequences [<xref ref-type="bibr" rid="pcbi.1005038.ref023">23</xref>] and especially for the <italic>P. falciparum</italic> genome [<xref ref-type="bibr" rid="pcbi.1005038.ref024">24</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref027">27</xref>]. Nevertheless, the 37% of <italic>P. falciparum</italic> proteins still completely lack domain annotation and one of the main reasons is that relevant signals in sequences might become too weak to be identified by consensus if sequence divergence is too important or if the pool of sequences is biased (too small or overrepresented by certain clades). Another reason is that proteins without predicted domains might belong to novel families completely missing in Pfam and other databases.</p>
<p>Based on the observation that structural and functional constraints might not be globally conserved through all species, we propose a novel pipeline, called CLADE (CLoser sequences for Annotations Directed by Evolution), that identifies domains in proteins by using all known Pfam domains and the large quantity of available genomic data spanning through a large panel of species. The idea is to “decompose” the signal of consensus shared by homologous sequences, collected at the scale of the entire phylogenetic tree, into several consensus signals coming from homologous sequences collected at the scale of species within clades (we shall speak of <italic>clade-centered models</italic>, in short CCM), and possibly of species that are phylogenetically distant from the genome considered. To do this, we construct several profiles for each Pfam domain, starting from a large and differentiated panel of homologous sequences in a protein domain family, and we use CCMs and SCMs to search for homologous sequences in the genome to annotate. The outcomes of these models are processed and transformed into features used to train a meta-classifier, that is a Support Vector Machine (SVM) [<xref ref-type="bibr" rid="pcbi.1005038.ref028">28</xref>], that assigns a confidence score to each domain prediction. Based on this score (defined later) and on other properties, such as domain co-occurrence, CLADE finds the most probable architecture for each protein sequence by using DAMA [<xref ref-type="bibr" rid="pcbi.1005038.ref027">27</xref>], a tool that finds best domain architectures based on multi-objective optimization criteria.</p>
<p>By using high performance computing (HPC), CLADE demonstrates that the limits in annotation reached by current methods can be bypassed. In fact, HPC makes it possible to construct and explore a large number of profiles (a few millions) and to search, within them, for the appropriate evolutionary patterns that match the protein sequences to annotate. The idea to explore a large space of profiles and to combine the information coming from them for the prediction of domains within proteins has never been developed before and turned out to be a winning strategy that opens up new hopes and directions for the development of accurate annotation systems. In CLADE, each domain is represented by about three hundred and fifty profiles, a number that is hundreds times larger than what has been previously proposed [<xref ref-type="bibr" rid="pcbi.1005038.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref020">20</xref>]. In total, about 2.5 million profiles are used to annotate a genome. The information issued by these models is merged and CLADE finds agreement among models, takes into consideration their phylogenetic origin, and combines potential annotations in an accurate reconstruction of domain architectures. Both the profile-based search and the analysis of the resulting annotations require HCP. By using grid computing, we could annotate proteins lying in the twilight zone [<xref ref-type="bibr" rid="pcbi.1005038.ref029">29</xref>] of the <italic>P. falciparum</italic> genome, remarkably rich in A and T, and advance on the fundamental question of how to identify domains for proteins that are highly diverged. The <italic>P. falciparum</italic> protein annotation represents a very difficult case study. More than 44% of open reading frames in this genome remains without any putative annotation [<xref ref-type="bibr" rid="pcbi.1005038.ref030">30</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref032">32</xref>] in PlasmoDB v11.1 that reports 2 464 proteins with unknown or hypothetical function over 5 542 genes. Our methodology shows a striking improvement over current annotation approaches. No specific property of the <italic>P. falciparum</italic> genome, besides its localization within the Alveolata clade, is used and the method can be applied to any other genome.</p>
<p>We show that because of their closeness to actual protein sequences, CCMs are more specific and more functionally predictive than the broader Pfam family models, based on consensus. The accurate domain annotation reached with CCMs has important implications also for protein evolution studies. In fact, we show that CCMs provide novel information that can be exploited to explore the landscape of protein domain evolution. We shall argue that CCMs can help to trace ancient domain duplications, to reconstruct the history of protein architectures, and to better estimate protein domain age.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>Our main claim is that protein domains are subject to heterogeneous evolutionary signals, possibly due to multiple evolutionary pressures of structural and functional origins. To demonstrate that this observation greatly helps to improve annotation, we first present how CLADE exploits the large quantity of available genomic information to provide protein sequence annotation. Then, we validate CLADE approach on several datasets of sequences by demonstrating that “multi-source” domain modeling is more appropriate than “mono-source” domain modeling for capturing remote homology. We compare CLADE to widely used domain prediction tools based on the mono-source approach. Finally, we report the improved annotation realized by CLADE of all <italic>P. falciparum</italic> proteins, known to be difficult to annotate.</p>
<sec id="sec003">
<title>The CLADE approach</title>
<p>To predict domains in protein sequences, CLADE pipeline is organized in three main steps (<xref ref-type="fig" rid="pcbi.1005038.g001">Fig 1</xref>). The input is a set of protein sequences coming from the same genome or from different ones. In the latter case, each sequence is accompanied by its NCBI taxon code.</p>
<fig id="pcbi.1005038.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schema representing the three main steps of CLADE method.</title>
<p>The 1st step (<bold>top</bold>) concerns the construction of domain profiles from the Pfam database. A specific set of species can be furnished to CLADE (optional) to guide the selection of homologous sequences (and species) for the construction of clade-centered models (CCM), otherwise set to be a random selection. The output is a library of probabilistic models: for each Pfam domain, it contains a SCM, provided by Pfam, and a large number of CCMs, associated to the FULL set of Pfam sequences for the domain. All probabilistic models are used to identify potential domains occurring in query sequences. The schema illustrates the model construction for domain <italic>D</italic><sup>1</sup>; it is applied to all Pfam domains. The 2nd step (<bold>middle</bold>) matches all models generated in step 1 against query sequences belonging to a given genome or to a set of sequences given as input, and identifies a set of potential domains occurring in the sequences. Then, it filters potential domains by using support vector machines. For each domain, it constructs a SVM that combines multiple features extracted from the SCM and CCM models associated to the domain. The schema illustrates domain identification for a given query sequence; it is applied to all input sequences. The 3rd step (<bold>bottom</bold>) takes the position of potential domains in a query sequence (from step 2) and runs DAMA, a tool designed to predict domain architectures from known ones.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.g001" xlink:type="simple"/>
</fig>
<sec id="sec004">
<title>CLADE’s first step: Construction of protein profiles to identify potential domains</title>
<p>In this step, CLADE uses information coming from the Pfam v27 database (Pfam<sub>27</sub>) and constructs probabilistic models by automatically sampling reference sequences through a large panel of species representing the whole tree of eukaryotic, archaeal, bacterial, viral worlds, and from metagenomes. If a user wants to use a preferred set of species, CLADE accepts the specified set, representing phylogenetic variability in the tree of life, as optional input.</p>
<p>For each Pfam domain, CLADE identifies a set of homologous sequences within those in the Pfam<sub>27</sub> FULL set based on their taxonomic origin. It selects species that are uniformly spread either in the phylogenetic tree of life or within the specific set of species specified by the user (see <xref ref-type="supplementary-material" rid="pcbi.1005038.s001">S1 Table</xref> for the set of NCBI clades considered). The selection guarantees that species belong to different phylogenetic clades and that the phylogenetic tree is well represented (see section “Clade-centered models” in <xref ref-type="sec" rid="sec018">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005038.s006">S1 Fig</xref>). From each identified sequence, CLADE constructs a probabilistic profile (<xref ref-type="fig" rid="pcbi.1005038.g001">Fig 1</xref>, top left): it constructed 2 404 066 profiles based on the species distribution reported in <xref ref-type="fig" rid="pcbi.1005038.g002">Fig 2</xref>. For this, two computational approaches that underlie different evolutionary assumptions have been used. The first captures the consensus of homologous sequences. The idea behind this model is that homologous proteins should share common physico-chemical and structural features that could be described by a sequence profile based on the entire set of homologs [<xref ref-type="bibr" rid="pcbi.1005038.ref009">9</xref>]. For this reason, we call this model <italic>sequence consensus model</italic> (SCM). 14 831 SCMs (one for each Pfam domain) were directly downloaded from Pfam<sub>27</sub>. These SCMs are profile Hidden Markov Models and they have been constructed from the Pfam<sub>27</sub> SEED set associated to the domain, representative of a large span of species. These models are exploited by other annotation systems, such as HMMScan [<xref ref-type="bibr" rid="pcbi.1005038.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref033">33</xref>]. The second computational approach is based on a new class of models, called <italic>clade-centered models</italic> (CCMs), and generated 2 389 235 CCMs. This was done by taking a few hundred homologous sequences for each Pfam domain as reference sequences, and by constructing a few hundred profiles for each domain. These models span regions of protein sequence space that are not well represented in the SEED sequences from which the original Pfam SCM is constructed. CCMs might highlight motifs, structural characteristics or physico-chemical properties that are shared by a specific reference sequence and by a pool of sequences that are similar to it. Hence, if the original set of reference sequences for a domain is made of divergent homologs, CCMs are expected to describe properties that could be missed by the SCM representing global consensus. The idea behind the use of CCMs is that protein evolution pathways are bound to be few due to the numerous structural and functional constraints that a protein undergoes. This means that the evolutionary constraints that drive a protein evolution in a specific species and the corresponding (conserved, structural, physico-chemical) signals identifiable in a sequence, might be more easily detectable by looking closely at the evolutionary solutions found by some other species. We hypothesize that some species share their evolutionary solutions with the species to annotate, even if they are phylogenetically distant from it. The construction of CCMs constitutes a basic difference between CLADE approach and existing methods: CLADE uses SCMs like other methods and goes beyond them by exploiting extra information present in our databases. Namely, it constructs CCMs describing the multiple, possibly divergent, evolutionary solutions that are present in nature and uses CCMs to annotate.</p>
<fig id="pcbi.1005038.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Distribution of species used for the generation of CCMs of Pfam<sub>27</sub> domains.</title>
<p><bold>A.</bold> Distribution of species illustrating the spread of the organisms chosen to construct models in CLADE. Species are organized in Bacteria, Archaea, Viruses, several eukaryotic clades and environmental sequences (“Metagenomes”). For each species, at least one domain sequence has been used to construct some CCMs. “Metagenomes” are bacterial and eukaryotic sequences. <bold>B.</bold> Zoom over eukaryotic clades and environmental sequences appearing in A. Eukaryotic sequences are divided in 17 clades. The most represented clades are Metazoa, Fungi, Viridiplantae, Alveolata, Stramenopiles, Amoebozoa and Euglenozoa. All other clades are zoomed in <bold>C</bold>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>CLADE’s second step: Multiple criteria support predictions</title>
<p>CLADE exploits all models produced in its first step to predict domains in the set of protein sequences to be annotated (<xref ref-type="fig" rid="pcbi.1005038.g001">Fig 1</xref>, middle; see section “Combining Model Predictions” in <xref ref-type="sec" rid="sec018">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005038.s007">S2 Fig</xref>). It uses PSI-BLAST and HMMer (and their respective models) to screen each query sequence and identify potential domains. CLADE uses a combination of criteria, ultimately converted into a score provided by a Support Vector Machine (SVM), to specifically deal with false positives and eliminate them. This issue is fundamental in domain prediction. The SVM discriminates potential domains by evaluating which prediction is more probable among those displaying: a small E-value, a sufficiently long domain hit, the phylogenetic proximity between the taxon of the sequence to be annotated and the reference species generating the CCMs leading to annotation, and a large agreement among models leading to the prediction. Scores issued by the SVM filter boost weak domain predictions that positively satisfy several of the conditions, and penalise high confidence domains when the combination of conditions do not support the prediction. This step of merging together the results produced by different profiles for the same protein sequence, distinguishes CLADE from other multiple-profile-based approaches [<xref ref-type="bibr" rid="pcbi.1005038.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref020">20</xref>] (see section “Analysis of a benchmark dataset from SCOP” in Results for a comparison to the strategy previously developed by SUPERFAMILY).</p>
</sec>
<sec id="sec006">
<title>CLADE’s third step: Protein architectures filter predictions</title>
<p>Domain co-occurrence is expected to enhance the level of confidence in a prediction [<xref ref-type="bibr" rid="pcbi.1005038.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref035">35</xref>]. This is because: 1. the majority of proteins are multi-domain, and 2. we observe fewer domain combinations than statistically expected [<xref ref-type="bibr" rid="pcbi.1005038.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref037">37</xref>]. Intuitively, co-occurrence suggests functional cooperation, that is, two or more domains can interact to determine the protein function [<xref ref-type="bibr" rid="pcbi.1005038.ref038">38</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref040">40</xref>]. Once domains are selected, CLADE calls DAMA, a tool that considers domain co-occurrence and domain overlapping, and that combines several domains into most probable architectures (<xref ref-type="fig" rid="pcbi.1005038.g001">Fig 1</xref>, bottom).</p>
</sec>
</sec>
<sec id="sec007">
<title>Multi-source versus mono-source approach to annotation</title>
<p>To demonstrate that “multi-source” domain modeling is more appropriate than “mono-source” domain modeling for capturing remote homology, we consider several datasets: 1. three datasets of single-domain sequences constructed from the SCOP database [<xref ref-type="bibr" rid="pcbi.1005038.ref021">21</xref>] as gold standard, 2. four datasets of randomly generated single-domain sequences satisfying different statistical hypotheses, 3. two datasets of randomly generated multi-domain sequences satisfying different statistical hypotheses. We evaluate the improvement in using an annotation that exploits multi-source domain modeling by comparing the performance of CLADE, that favors the multi-source strategy, to the performance of HMMScan and HHblits, that favor the mono-source one. We recall that HMMScan and HHblits are widely used search methods based on sequence-profile and profile-profile comparison, respectively. We estimate the false discovery rate (FDR) for the three methods. Also, with the SCOP datasets, we show that agreement among models is an important feature present in CLADE, and missing in existing multi-source domain approaches, like SUPERFAMILY. Note that CLADE skips its third step (DAMA) on datasets 1 and 2 because they comprise single-domain sequences.</p>
<sec id="sec008">
<title>Analysis of a benchmark dataset from SCOP</title>
<p>We considered three datasets of sequences coming from the database SCOP: ASTRAL95, ASTRAL30 and ASTRAL10. They are constructed from domain families sharing the same structure and they contain sequences with at most 95%, 30%, 10% of sequence identity (see section “Databases” in <xref ref-type="sec" rid="sec018">Methods</xref>). On these reference datasets, we tested mono-source and multi-source annotation strategies with HMMScan and HHblits supporting the mono-source strategy, and with CLADE, CLADE<sub><italic>BEv</italic></sub>, CLADE_HHblits and CLADE<sub><italic>BEv</italic></sub>HHblits supporting the multi-source strategy. CLADE_HHblits and CLADE<sub><italic>BEv</italic></sub>HHblits use the CLADE approach, but replace PSI-BLAST models and sequence-profile search with HHblits models and profile-profile search. They allow us to verify whether a profile-profile approach combined with multiple models improves CLADE performance. The test considers, one at the time, ASTRAL domain families and uses a leave-one-out cross validation strategy to verify how many times models constructed on all-but-one sequences help to correctly annotate left out sequences. For all tools, results are reported in <xref ref-type="table" rid="pcbi.1005038.t001">Table 1</xref>; it is important to stress that the test is very stringent because it is realized at the SCOP family level. (For the details on the implementation of the test, see section “Experiment on SCOP datasets” in <xref ref-type="sec" rid="sec018">Methods</xref>.)</p>
<table-wrap id="pcbi.1005038.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.t001</object-id>
<label>Table 1</label>
<caption>
<title>Performance of CLADE, CLADE<sub>BEv</sub>, HMMScan and HHblits on a SCOP dataset of sequences.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005038.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="center"><bold>ASTRAL10</bold></td>
<td align="center"/>
<td align="center"><bold>Mono-source</bold></td>
<td align="center" colspan="2"><bold>Multi-source</bold></td>
</tr>
<tr>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>HMMScan</bold></td>
<td align="center"><bold>CLADE</bold></td>
<td align="center"><bold>CLADE</bold><sub><bold><italic>BEv</italic></bold></sub></td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>TP</bold></td>
<td align="center">24</td>
<td align="center">217</td>
<td align="center">165</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FP</bold></td>
<td align="center">10</td>
<td align="center">89</td>
<td align="center">141</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FN</bold></td>
<td align="center">272</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>F-measure</bold></td>
<td align="center">0.15</td>
<td align="center">0.83</td>
<td align="center">0.70</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>PPV</bold></td>
<td align="center">0.71</td>
<td align="center">0.71</td>
<td align="center">0.54</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>Sen</bold></td>
<td align="center">0.08</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>HHblits</bold></td>
<td align="center"><bold>CLADE_HHblits</bold></td>
<td align="center"><bold>CLADE</bold><sub><bold><italic>BEv</italic></bold></sub>HHblits</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>TP</bold></td>
<td align="center">29</td>
<td align="center">300</td>
<td align="center">289</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FP</bold></td>
<td align="center">144</td>
<td align="center">5</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FN</bold></td>
<td align="center">133</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>F-measure</bold></td>
<td align="center">0.17</td>
<td align="center">0.99</td>
<td align="center">0.97</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>PPV</bold></td>
<td align="center">0.17</td>
<td align="center">0.98</td>
<td align="center">0.95</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>Sen</bold></td>
<td align="center">0.18</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center"><bold>ASTRAL30</bold></td>
<td align="center"/>
<td align="center"><bold>Mono-source</bold></td>
<td align="center" colspan="2"><bold>Multi-source</bold></td>
</tr>
<tr>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>HMMScan</bold></td>
<td align="center"><bold>CLADE</bold></td>
<td align="center"><bold>CLADE</bold><sub><bold><italic>BEv</italic></bold></sub></td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>TP</bold></td>
<td align="center">430</td>
<td align="center">994</td>
<td align="center">741</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FP</bold></td>
<td align="center">127</td>
<td align="center">229</td>
<td align="center">471</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FN</bold></td>
<td align="center">694</td>
<td align="center">28</td>
<td align="center">39</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>F-measure</bold></td>
<td align="center">0.51</td>
<td align="center">0.89</td>
<td align="center">0.74</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>PPV</bold></td>
<td align="center">0.77</td>
<td align="center">0.81</td>
<td align="center">0.61</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>Sen</bold></td>
<td align="center">0.38</td>
<td align="center">0.97</td>
<td align="center">0.95</td>
</tr>
<tr>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>HHblits</bold></td>
<td align="center"><bold>CLADE_HHblits</bold></td>
<td align="center"><bold>CLADE</bold><sub><bold><italic>BEv</italic></bold></sub>HHblits</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>TP</bold></td>
<td align="center">476</td>
<td align="center">1241</td>
<td align="center">1150</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FP</bold></td>
<td align="center">502</td>
<td align="center">7</td>
<td align="center">97</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FN</bold></td>
<td align="center">318</td>
<td align="center">3</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>F-measure</bold></td>
<td align="center">0.54</td>
<td align="center">1</td>
<td align="center">0.96</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>PPV</bold></td>
<td align="center">0.49</td>
<td align="center">0.99</td>
<td align="center">0.92</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>Sen</bold></td>
<td align="center">0.6</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center"><bold>ASTRAL95</bold></td>
<td align="center"/>
<td align="center"><bold>Mono-source</bold></td>
<td align="center" colspan="2"><bold>Multi-source</bold></td>
</tr>
<tr>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>HMMScan</bold></td>
<td align="center"><bold>CLADE</bold></td>
<td align="center"><bold>CLADE</bold><sub><bold><italic>BEv</italic></bold></sub></td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>TP</bold></td>
<td align="center">7000</td>
<td align="center">8512</td>
<td align="center">7772</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FP</bold></td>
<td align="center">710</td>
<td align="center">117</td>
<td align="center">857</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FN</bold></td>
<td align="center">923</td>
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>F-measure</bold></td>
<td align="center">0.9</td>
<td align="center">0.99</td>
<td align="center">0.95</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>PPV</bold></td>
<td align="center">0.91</td>
<td align="center">0.99</td>
<td align="center">0.90</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>Sen</bold></td>
<td align="center">0.88</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>HHblits</bold></td>
<td align="center"><bold>CLADE_HHblits</bold></td>
<td align="center"><bold>CLADE</bold><sub><bold><italic>BEv</italic></bold></sub>HHblits</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>TP</bold></td>
<td align="center">3934</td>
<td align="center">8537</td>
<td align="center">7947</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FP</bold></td>
<td align="center">1679</td>
<td align="center">96</td>
<td align="center">686</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>FN</bold></td>
<td align="center">3020</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>F-measure</bold></td>
<td align="center">0.63</td>
<td align="center">0.99</td>
<td align="center">0.96</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>PPV</bold></td>
<td align="center">0.7</td>
<td align="center">0.99</td>
<td align="center">0.92</td>
</tr>
<tr>
<td align="center"/>
<td align="left"><bold>Sen</bold></td>
<td align="center">0.57</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>SCOP datasets ASTRAL95, ASTRAL30, ASTRAL10 contain sequences with at most 95%, 30%, 10% of sequence identity.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>CLADE multi-source strategy clearly outperforms the mono-source strategy as illustrated by HMMScan and HHblits results. Note that HHblits badly handles false positives compared to HMMScan that uses a special filter for this (see section “Tools run for comparison” in <xref ref-type="sec" rid="sec018">Methods</xref>) and this appears clearly in the performance reported in <xref ref-type="table" rid="pcbi.1005038.t001">Table 1</xref>. On the other hand, CLADE_HHblits records a clear improvement over CLADE reaching a nearly optimal performance. This highlights that the multi-source strategy successfully complements the power of HHblits. It should be noticed though, that the profile-profile search becomes extremely costly in time when expanded to a scale of hundred thousands models and thousands (or even millions, for metagenomics) of sequences to be annotated. The conversion of each query sequence into a profile, before performing profile-profile comparison, and the identification of domain specific cut-offs for all domains are highly time consuming and an approach based on a sequence-profile comparison remains more computationally reasonable.</p>
<p>This test allows us also to compare CLADE with SUPERFAMILY [<xref ref-type="bibr" rid="pcbi.1005038.ref018">18</xref>], a probabilistic profiles library representing all structural domains present in the SCOP database [<xref ref-type="bibr" rid="pcbi.1005038.ref041">41</xref>]. Note that CLADE has been constructed in the same spirit as SUPERFAMILY: both systems generate multiple models for a given domain, but they select among the predictions of these models with a different computational approach. SUPERFAMILY selects domains by looking at their best E-value, while CLADE exploits best E-values and also agreement among different models (second step) and domain co-existence (third step). Note that CLADE<sub><italic>BEv</italic></sub> selects among different predictions of the models by using best E-values, as SUPERFAMILY does, and that domain co-existence is not tested by CLADE<sub><italic>BEv</italic></sub> on the SCOP sequences, since the testing datasets contain just one domain. While CLADE and CLADE<sub><italic>BEv</italic></sub> behave the same on ASTRAL95 (<italic>F</italic>-<italic>measure</italic> = <italic>PPV</italic> = <italic>Sen</italic> = 1, <italic>PPV</italic> = 1 for both), on more distant sequences, their performance diverges. On ASTRAL10, we observe an increasing difference for CLADE and CLADE<sub><italic>BEv</italic></sub> in <italic>F</italic>-<italic>measure</italic> (0.83 and 0.7, respectively) and in <italic>PPV</italic> (0.71 and 0.54, respectively) at <italic>Sen</italic> = 1 (<xref ref-type="table" rid="pcbi.1005038.t001">Table 1</xref>). This shows that, by combining results obtained by different models through SVMs, CLADE can highly improve its performance on domain detection.</p>
<p>To conclude, this analysis highlights that criteria other than sequence similarity play a key role in an accurate identification of protein domains. The criteria describing agreement among models and domain co-existence do not simply allow for new predictions but they provide detailed scores justifying the confidence in a prediction. They can be fruitfully used by the biologist to annotate sequences.</p>
</sec>
<sec id="sec009">
<title>Analysis of datasets of randomly generated sequences</title>
<p>We performed several statistical tests to show that CLADE predicted domains are likely true positives. For this, we estimated False Discovery Rate (FDR) expressing how many times a tool, namely CLADE, HMMScan and HHblits, recognizes a known domain in a reshuffled sequence. We considered the problem of annotating sequences containing a single domain. We used four different random generations of amino-acids sequences and constructed two H0 and two H1 hypotheses. Based on the sets of sequences generated by these statistical hypotheses, we evaluated CLADE, HMMScan and HHblits. The evaluation of HHblits is included whenever the multi-source strategy is directly compared with the mono-source strategy.</p>
<p>As a first H0 hypothesis, we considered the set of 14 831 Pfam<sub>27</sub> domain families, extracted a reference sequence from the Pfam<sub>27</sub> SEED set of each domain family and generated, for each reference sequence, a random sequence by reshuffling the amino-acids (that is 1-mers) in the original one. The resulting sequence has the same length as the original one and the same amino-acids content. These random sequences were then annotated with CLADE and HMMScan and the FDR was computed for both tools. A second H0 hypothesis test was realized by considering a set of sequences representing each Pfam domain as above, and by reshuffling quadruplets of consecutive amino-acids, that is 4-mers. Again, the random sequences were annotated by CLADE and HMMScan, and the associated FDR was computed.</p>
<p>This test allows us to estimate how selective CLADE features are compared to the acceptance thresholds proposed by HMMScan in the identification of domains within sequences expected to contain a single domain, i.e. where co-occurrence cannot be exploited. Since CLADE uses several layers for filtering out domain predictions, its strategy is to accept more domains at the beginning and filter them based on criteria that are not used by HMMScan. But how much more does CLADE accept? The FDR computed for the two H0 hypotheses describes how permissive CLADE is at the beginning of the process, before applying DAMA, compared to HMMScan.</p>
<p>The two experiments were run 20 times each and 296 620 (14 831 × 20) random sequences were produced for each experiment. For each random sequence, we checked whether CLADE and HMMScan would predict a domain, and if so, whether the predicted domain was the domain originating the sequence or a different (new) one. For 1-mers, CLADE obtained a FDR of 6.98<italic>e</italic>-03 and HMMScan of 2<italic>e</italic>-04 on new domain predictions. For 4-mers, CLADE obtained a FDR of 7.6<italic>e</italic>-03 and HMMScan of 2<italic>e</italic>-04. See also <xref ref-type="supplementary-material" rid="pcbi.1005038.s002">S2 Table</xref>.</p>
<p>To show that “multi-source” domain modeling is more appropriate than “mono-source” domain modeling for capturing remote homology, we constructed two H1 hypotheses, one closer to the mono-source view, shared by the different approaches found in the literature and based on consensus sequences, and a second one closer to the multi-source view, supported by CLADE.</p>
<p>The first H1 hypothesis that we explored promotes the mono-source view and it is expected to be favorably biased towards HMMScan predictions. We considered the set of 14 831 Pfam<sub>27</sub> domain families and their associated SCMs, provided by Pfam<sub>27</sub>. Then, we generated 14 831 random sequences, each of them associated to a different probabilistic model, with HMMemit [<xref ref-type="bibr" rid="pcbi.1005038.ref033">33</xref>] (default parameters), a tool that generates artificial sequences from a probabilistic model. The generated sequences are consistent with a sequence family consensus and they are useful to test domain annotation. Next, we run HMMScan and CLADE for annotating domains in these sequences. HHblits is run by constructing profiles for each query sequence with <monospace>hhblits</monospace> over HHdb, the HHblits database, and by using HHsearch for a profile-profile comparison. Since the sequences come from specific domain families, we checked whether CLADE, HMMScan and HHblits could predict the right domain family for each sequence. This experiment was repeated 20 times and we evaluated sensitivity, PPV and F-score on the 296 620 generated sequences, or their associated profile. The plots describing CLADE, HMMScan and HHblits sensitivity at different PPV values, and the number of domains predicted by the three tools at different F-scores, are illustrated in <xref ref-type="fig" rid="pcbi.1005038.g003">Fig 3A</xref> (top and bottom). We note that for all tools, at different sensitivity values, PPV is at least 0.98. For F-scores smaller than 0.8, the number of predicted domains corresponds essentially to all domains in the set; for high F-scores, that is if both the sensitivity and the PPV are large, then the number of predicted domains remains high (about a half of all domains) for all tools. Three more curves are added to the plots: by considering Pfam<sub>27</sub> clans, that is related Pfam entries that are grouped together, we observe that CLADE, HMMScan and HHblits perform comparably well and that CLADE and HHblits profit of the notion of a clan better than HMMScan. The curves plotting PPV versus sensitivity almost coincide for the three tools and they are very close when the number of domains versus F-scores are considered. This means that, when clans are not considered, CLADE predicts domains that are nevertheless very close to the original one. The performance for all systems is very good, and the plots clearly point out that all tools can easily detect domains in generated sequences when the sequence generator injects sufficiently precise information about the domain, consistently with the sequence family consensus. (Compare to the experiments based on the H0 hypotheses.) The slight advantage recorded for HMMScan is expected, since, as argued above, this H1 hypothesis is in favor of HMMScan relying on the mono-source view.</p>
<fig id="pcbi.1005038.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Mono-source versus multi-source hypothesis tested on randomly generated sequences.</title>
<p>Comparison between CLADE, HMMScan and HHblits performance on the two H1 hypotheses. <bold>A.</bold> The mono-source hypothesis, constructed in favor of HMMScan predictions, is evaluated with a precision-recall plot (top; Sensitivity versus PPV) and by counting how many domains are discovered by the tools at a given F-score (bottom). CLADE curves are constructed by considering all domains (green) or all domains sharing the same Pfam clans (pink). The same for HMMScan (red for all domains and blue for clans) and for HHblits (orange for all domains and grey for clans) curves. <bold>B.</bold> The multi-source hypothesis, constructed in favor of CLADE predictions, is evaluated by two plots, described as in <bold>A</bold>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.g003" xlink:type="simple"/>
</fig>
<p>The second H1 hypothesis that we explored promotes the multi-source view and it is expected to be favorably biased towards CLADE predictions. For this, we considered the set of <italic>P. falciparum</italic> sequences where CLADE predicted some domain while HMMScan predicted none, and, out of it, we extracted the full set of domain sequences occurring in these <italic>P. falciparum</italic> sequences. Note that a <italic>P. falciparum</italic> sequence might contain several predicted domains, and that each of these domain sequences have been considered. We obtained a total of 571 domain sequences. For each <italic>P. falciparum</italic> domain sequence, we looked into the CCMs that CLADE used for predicting it and selected at most four CCMs showing an E-value &lt; 1<italic>e</italic>-30, if any. Given a CCM, we considered the sequence originally used to construct it and produced a pHMM with jackHMMer [<xref ref-type="bibr" rid="pcbi.1005038.ref033">33</xref>]. This means that we have at most 4 CCMs models associated to each one of the 571 domain sequences. For each sequence, we picked one of their associated CCMs with a uniform probability and generated a sequence from it with HMMemit. The generation of sequences was performed 20 times. For each resulting sequence, we constructed a profile to evaluate HHblits. We annotated these 11 420 generated sequences or profiles with CLADE, HMMScan and HHblits, and evaluated the three tools with sensibility, PPV and F-score as before.</p>
<p>In the two plots of <xref ref-type="fig" rid="pcbi.1005038.g003">Fig 3B</xref> (top and bottom), we observe that CLADE performs better than HMMScan and HHblits. This remains true when a more permissive evaluation is realized at the clan level rather than the usual family level. For all methods, the clan evaluation shows that many false predictions are domains that belong to the same clan of the true domain. We also observe that HHblits outperformed HMMScan, the use of profile-profile searching being more efficient [<xref ref-type="bibr" rid="pcbi.1005038.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref042">42</xref>]. This highlights the interest of using multiple models in domain identification. Nevertheless, we observe that HMMScan performance is very good, considering that it did not find the domain on the original <italic>P. falciparum</italic> sequence. In this respect, it should be noticed that:</p>
<list list-type="order">
<list-item>
<p>here the task is somewhat easier, since HMMScan is asked to annotate a domain sequence and not a larger <italic>P. falciparum</italic> sequence where the position of the domain has to be identified.</p>
</list-item>
<list-item>
<p>we constructed CCMs starting from specific sequences from which CLADE annotated the corresponding <italic>P. falciparum</italic> domain. They are possibly heterogeneous and they are supposed to guide HMMScan domain recognition, since we know from CLADE analysis that their reference sequence can help annotation. Yet, the lower HMMScan performance demonstrates that the combination of several CCMs (multiple-source modeling) is important for annotation. HMMScan does not use the idea of agreement between heterogeneous models while CLADE does.</p>
</list-item>
</list>
<p>In conclusion, CLADE, HMMScan and HHblits predict more easily domains in the first H1 dataset than in the second one (see plots on the bottom of <xref ref-type="fig" rid="pcbi.1005038.g003">Fig 3A and 3B</xref>, where the <italic>y</italic>-axes have not the same scale). By comparing the plots on the top of <xref ref-type="fig" rid="pcbi.1005038.g003">Fig 3A and 3B</xref>, we note that CLADE performs similarly to HMMScan and HHblits on the first dataset, while on the second one, constructed from a list of hard examples of remote homology, the difference among the three systems is much more important. The heterogeneity of the domain models appears crucial for obtaining an improved performance (considering clans or not) and a successful remote homology detection. Clearly, HHblits profile-profile comparison improves the mono-source strategy performance of HMMScan, but it remains poor when compared to CLADE multi-source strategy.</p>
</sec>
<sec id="sec010">
<title>CLADE FDR computed on multi-domain sequences</title>
<p>We estimated CLADE FDR on the prediction of multi-domain proteins. To do so, we consider a FDR strategy that is based on the first H0 hypothesis introduced above, generating random sequences that preserve the same amino-acids composition of the original sequences. Here, we generated random sequences starting from the 5 542 <italic>P. falciparum</italic> sequences. For each of these sequences, we concatenated the real sequence to its random reshuffling (<xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4A</xref>). Then, to annotate the domains and evaluate the performance of the systems with an estimation of their FDR, we run CLADE and HMMScan on this dataset of sequences and HHblits on the associated profiles. Several situations may arise, as illustrated in <xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4B</xref>: 1. the original sequence is annotated as before, and no annotation is found in the reshuffled one; 2. the reshuffled sequence as well as the original sequence are both annotated with the original domain annotation; 3. the original domain annotation is found in the original sequence and a different annotation is found in the reshuffled one; 4. both subsequences are newly annotated. With respect to these four scenarios, we counted as false positives all outcomes of kind 2, 3 and 4. That is, we just check whether the random sequence can be annotated at all.</p>
<fig id="pcbi.1005038.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.g004</object-id>
<label>Fig 4</label>
<caption>
<title>CLADE predicts more domains over a range of FDRs.</title>
<p><bold>A.</bold> Illustration of the FDR estimation procedure. For each original protein sequence, we make predictions on it and on twenty shuffled sequences concatenated to the original sequence, to allow “real” domains (Y, S) to boost false predictions on the shuffled sequence (domains V, Z, X) when using domain co-occurrence. The estimated FDR is the ratio of false predictions per protein to the total number of predictions per protein. Notice that domain co-occurrence might imply the original protein sequence to be re-annotated (see domain V in the bottom sequence of the drawing). <bold>B.</bold> Illustration of the four types of annotation that can be induced by the concatenation with a shuffled sequence discussed in the text. <bold>C.</bold> The y-axis is the number of predicted domains per protein (“signal”), while the x-axis is the FDR (“noise”), so better performing methods have higher curves (more signal for a given noise threshold). CLADE (red) outperforms HMMScan (black), HHblits (green) and DAMA (pink) on the two datasets, 1-mer (top) and 4-mer (bottom), obtained by randomly reshuffling <italic>P. falciparum</italic> sequences (see text). CLADE has been tested under several restrictions and the resulting FDR curves have been added to the plot: CLADE<sub><italic>ALV</italic></sub> (grey), CLADE<sub><italic>BEv</italic></sub> (blue) and CLADE<sub><italic>BEv</italic></sub>-no-cut-off (orange). The inset plot zooms the curves on small FDR values (&lt; 0.001).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.g004" xlink:type="simple"/>
</fig>
<p>We repeated the construction 20 times and considered as FDR, the average FDR of the 20 experiments. We also checked the second H0 hypothesis introduced above, based on the reshuffling of 4-mers, following the same procedure as for 1-mers. The idea behind this model is that 4-mers within a protein sequence might be more likely to occur than others, since protein sequences might contain repetitive patterns.</p>
<p>A comparison among the tools is reported in <xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4C</xref> (top) (see section “FDR curves” in <xref ref-type="sec" rid="sec018">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005038.s008">S3 Fig</xref>), where CLADE is shown to predict a much higher number of domains than HMMScan and HHblits for any fixed noise threshold (that is, the same FDR) for both the 1-mer and the 4-mer reshuffling. HMMScan and CLADE predict a comparable small number of domains in the reshuffled parts, while CLADE predicts more domains than HMMScan on the real parts. In contrast, HHblits performance is highly influenced by two main factors. First, the construction of a profile for the shuffled part of the query sequence introduces extra noise in the evaluation of HHblits, contrary to HMMScan and CLADE that directly work on sequences. This factor seems to particularly affect HHblits in 4-mers, sequences that are harder to analyze than 1-mers. Second, the lack of domain specific cut-off acceptance for HHblits, contrary to HMMScan and CLADE that filter out a large number of false positives due to suitable domain specific cut-offs. Note that such cut-offs are crucial for CLADE. In fact, when we test CLADE<sub><italic>BEv</italic></sub>-no-cut-off, that is the version of CLADE that does not include the SVM filter, that does not use domain specific cut-offs and that considers a score system based on best E-values only, the behavior of the system is essentially identical to the one of HHblits on 1-mer as illustrated in <xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4</xref>. Compare it with the curve associated to CLADE<sub><italic>BEv</italic></sub> also. (See curves on the 4-mer plot as well.)</p>
<p>In conclusion, we started from random sequences, relatively far from real protein sequences, and showed that CLADE has a significantly different behavior from HMMScan and HHblits on these datasets. Notice that the two H0 hypotheses would ask for the three tools to minimize the number of predictions in random sequences. Even if HMMScan and CLADE detect some domain, their performances remain very good as shown by the plots. HHblits’ lack of filtering for false positives explains its poorer performance. It is interesting to notice that DAMA [<xref ref-type="bibr" rid="pcbi.1005038.ref027">27</xref>], the tool used in CLADE 3rd step for reconstructing the best architecture from domain hits, performs better than HMMScan based on E-value, when it is evaluated on hits obtained with SCMs, as reported in <xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4C</xref>. The CLADE curve evaluates how much the usage of CCMs improves annotation compared to the usage of SCMs only. Note that DAMA is today the state-of-the-art method compared to tools handling domain co-occurrence such as MDA [<xref ref-type="bibr" rid="pcbi.1005038.ref023">23</xref>], CODD [<xref ref-type="bibr" rid="pcbi.1005038.ref024">24</xref>] and dPUC [<xref ref-type="bibr" rid="pcbi.1005038.ref026">26</xref>]. The curves demonstrate that, by combining DAMA with clade-centered models, domain annotation highly improves.</p>
<p>Note that <xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4C</xref> reports the behavior of CLADE when the model library is restricted to CCMs from the Alveolata clade only (CLADE<sub><italic>ALV</italic></sub>). One observes that at the same FDR value, the number of predictions is much lower for CLADE<sub><italic>ALV</italic></sub> than for CLADE.</p>
</sec>
</sec>
<sec id="sec011">
<title>Analysis of the dataset of all <italic>P. falciparum</italic> proteins</title>
<p>Upheld by CLADE performance on the SCOP benchmark datasets and the FDR tests, we checked whether CLADE could significantly contribute to the identification of domains within the full set of <italic>P. falciparum</italic> proteins. A large number (2464) of <italic>P. falciparum</italic> proteins has no identified domain in PlasmoDB and it remains with no domain identification (2068) even after the analysis of existing <italic>in silico</italic> predictive methods [<xref ref-type="bibr" rid="pcbi.1005038.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref026">26</xref>]. We performed a large scale domain prediction and compared CLADE results against annotations obtained with HMMScan.</p>
<p>All evaluations reported below were realized with the same CLADE parameters (with an E-value cut-off at 1<italic>e</italic>-3 and by adopting a specific SVM probability cut-off for each domain). See section “CLADE pipeline, parameter settings and tools used in CLADE” in <xref ref-type="sec" rid="sec018">Methods</xref>.</p>
<sec id="sec012">
<title>Domain annotation of all <italic>P. falciparum</italic> proteins</title>
<p>Over the 5 542 proteins of PlasmoDB, HMMScan identifies 6 037 domains but leaves 2 068 proteins with no identified putative domains. CLADE drastically reduced this number to 1 544, providing 25% improvement and a global annotation of 7 841 domains (at E-values ≤ 1<italic>e</italic>-3; see <xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5A</xref> and <xref ref-type="table" rid="pcbi.1005038.t002">Table 2</xref>, top). These values describe the impact of CLADE on the full set of proteins. CLADE analysis on multi-domain proteins is even more impressive as reported in <xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5A</xref>, where the importance of CCMs is highlighted. In many domain predictions, CLADE exploits CCMs in an exclusive manner: about 87% of CLADE domain predictions obtained with E-value ≤ 1<italic>e</italic>-60 are contributed by CCMs, and a total of 5 630 domains are identified by CCMs against 2211 identified by SCMs at E-value ≤ 1<italic>e</italic>-3 (<xref ref-type="table" rid="pcbi.1005038.t002">Table 2</xref>, top). Also, more than a half of the domains predicted by CLADE are co-occurring domains and this is true for all predictions, independently on the E-values (<xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5A</xref>). CLADE agrees on 98% of HMMScan predictions. Notice that HMMScan annotation is based on SCMs, and that if we consider CLADE SCMs predictions only, the number of CLADE predicted domains is smaller than that of HMMScan (2211 against 6037 domains). This is because CLADE predictions based on SCMs are often also obtained by CCMs with a better E-value and counted as CCM model predictions. The number of domains identified by SCMs and CCMs at a given threshold, is reported in <xref ref-type="table" rid="pcbi.1005038.t002">Table 2</xref> (top).</p>
<fig id="pcbi.1005038.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Domain predictions for <italic>P. falciparum</italic> proteins.</title>
<p><bold>A.</bold> Cumulative plot of domain predictions, for all <italic>P. falciparum</italic> proteins in PlasmoDB. All domains identified with an E-value ≤ <italic>E</italic> are counted, where <italic>E</italic> indexes the bins. The height of a bin corresponds to the total number of predictions. Predicted domains are classified in two groups, depending on whether they have been predicted with (white and light grey) or without (dark grey and black) domain co-occurrence, and two subgroups, depending on whether they have been identified through SCMs (white and black; Cooc-SCM and <inline-formula id="pcbi.1005038.e001"><alternatives><graphic id="pcbi.1005038.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mover><mml:mtext>SCM</mml:mtext> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) or by means of CCMs (light and dark grey; Cooc-CCM and <inline-formula id="pcbi.1005038.e002"><alternatives><graphic id="pcbi.1005038.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover><mml:mtext>CCM</mml:mtext> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>). Note that <inline-formula id="pcbi.1005038.e003"><alternatives><graphic id="pcbi.1005038.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mtext>Cooc-CCM</mml:mtext> <mml:mo>∪</mml:mo> <mml:mover><mml:mtext>CCM</mml:mtext> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> equals the set of domains detected by CCMs, and that <inline-formula id="pcbi.1005038.e004"><alternatives><graphic id="pcbi.1005038.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mtext>Cooc-SCM</mml:mtext> <mml:mo>∪</mml:mo> <mml:mover><mml:mtext>SCM</mml:mtext> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> is the set of domains detected by SCMs. <bold>B.</bold> Cumulative plot of domain predictions for proteins with “unknown function” in PlasmoDB. Here, we consider that a domain has “unknown function” if it is annotated in PlasmoDB with one of the following labels: unknown function, product unspecified, hypothetical protein, pseudogene and conserved <italic>P. falciparum</italic> protein family. Bins are as in <bold>A</bold>. <bold>C.</bold> Distribution of species generating all CCMs used to annotate the <italic>P. falciparum</italic> genome. The inset plot is a zoom of the last seven clades; arrows help to identify names of clades. (Also, see <xref ref-type="supplementary-material" rid="pcbi.1005038.s009">S4 Fig</xref> for the distribution of species generating CCMs used to detect new domains.)</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.g005" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1005038.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.t002</object-id>
<label>Table 2</label>
<caption>
<title>Analysis of domains identified by CLADE but not by PlasmoDB.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005038.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center" colspan="2">CLADE</th>
<th align="center" colspan="2">SCM<xref ref-type="table-fn" rid="t002fn005"><sup>d</sup></xref></th>
<th align="center" colspan="2">CCM<xref ref-type="table-fn" rid="t002fn006"><sup>e</sup></xref></th>
</tr>
<tr>
<th align="center">E-value</th>
<th align="center">Cooc<xref ref-type="table-fn" rid="t002fn007"><sup>f</sup></xref></th>
<th align="center">Total<xref ref-type="table-fn" rid="t002fn008"><sup>g</sup></xref></th>
<th align="center">Cooc</th>
<th align="center">Total</th>
<th align="center">Cooc</th>
<th align="center">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" colspan="7"><bold>All domains identified by CLADE</bold></td>
</tr>
<tr>
<td align="center">1e-60</td>
<td align="center">843</td>
<td align="center">1698</td>
<td align="center">44</td>
<td align="center">206</td>
<td align="center">799/461</td>
<td align="center">1492/801</td>
</tr>
<tr>
<td align="center">1e-30</td>
<td align="center">1858</td>
<td align="center">3392</td>
<td align="center">228</td>
<td align="center">558</td>
<td align="center">1630/1043</td>
<td align="center">2834/1728</td>
</tr>
<tr>
<td align="center">1e-15</td>
<td align="center">3050</td>
<td align="center">5329</td>
<td align="center">527</td>
<td align="center">1095</td>
<td align="center">2523/1614</td>
<td align="center">4234/2683</td>
</tr>
<tr>
<td align="center">1e-5</td>
<td align="center">4483</td>
<td align="center">7172</td>
<td align="center">1156</td>
<td align="center">1823</td>
<td align="center">3327/2230</td>
<td align="center">5349/3555</td>
</tr>
<tr>
<td align="center">1e-3</td>
<td align="center">5167</td>
<td align="center">7841</td>
<td align="center">1544</td>
<td align="center">2211</td>
<td align="center">3623/2475</td>
<td align="center">5630/3801</td>
</tr>
<tr>
<td align="center" colspan="7"><bold>Domains occurring on proteins predicted for the first time</bold><xref ref-type="table-fn" rid="t002fn002"><sup>a</sup></xref></td>
</tr>
<tr>
<td align="center">1e-60</td>
<td align="center">7</td>
<td align="center">23</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">7/4</td>
<td align="center">23/18</td>
</tr>
<tr>
<td align="center">1e-30</td>
<td align="center">32</td>
<td align="center">115</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">32/24</td>
<td align="center">115/97</td>
</tr>
<tr>
<td align="center">1e-15</td>
<td align="center">127</td>
<td align="center">393</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">125/110</td>
<td align="center">391/361</td>
</tr>
<tr>
<td align="center">1e-5</td>
<td align="center">340</td>
<td align="center">789</td>
<td align="center">32</td>
<td align="center">35</td>
<td align="center">308/262</td>
<td align="center">754/690</td>
</tr>
<tr>
<td align="center">1e-3</td>
<td align="center">467</td>
<td align="center">916</td>
<td align="center">57</td>
<td align="center">60</td>
<td align="center">410/346</td>
<td align="center">856/774</td>
</tr>
<tr>
<td align="center" colspan="7"><bold>Domains enriching known protein architectures</bold><xref ref-type="table-fn" rid="t002fn003"><sup>b</sup></xref></td>
</tr>
<tr>
<td align="center">1e-60</td>
<td align="center">41</td>
<td align="center">49</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">41/37</td>
<td align="center">49/43</td>
</tr>
<tr>
<td align="center">1e-30</td>
<td align="center">131</td>
<td align="center">147</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">130/114</td>
<td align="center">146/128</td>
</tr>
<tr>
<td align="center">1e-15</td>
<td align="center">347</td>
<td align="center">428</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">345/294</td>
<td align="center">426/373</td>
</tr>
<tr>
<td align="center">1e-5</td>
<td align="center">803</td>
<td align="center">950</td>
<td align="center">114</td>
<td align="center">114</td>
<td align="center">689/510</td>
<td align="center">836/651</td>
</tr>
<tr>
<td align="center">1e-3</td>
<td align="center">1052</td>
<td align="center">1200</td>
<td align="center">206</td>
<td align="center">206</td>
<td align="center">846/638</td>
<td align="center">994/780</td>
</tr>
<tr>
<td align="center" colspan="7"><bold>Brand-new domains in</bold> <italic><bold>P. falciparum</bold></italic> <bold>annotation</bold><xref ref-type="table-fn" rid="t002fn004"><sup>c</sup></xref></td>
</tr>
<tr>
<td align="center">1e-60</td>
<td align="center">9</td>
<td align="center">18</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">8/8</td>
<td align="center">17/16</td>
</tr>
<tr>
<td align="center">1e-30</td>
<td align="center">51</td>
<td align="center">103</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">50/44</td>
<td align="center">102/91</td>
</tr>
<tr>
<td align="center">1e-15</td>
<td align="center">190</td>
<td align="center">402</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">189/169</td>
<td align="center">401/373</td>
</tr>
<tr>
<td align="center">1e-5</td>
<td align="center">448</td>
<td align="center">816</td>
<td align="center">40</td>
<td align="center">40</td>
<td align="center">408/353</td>
<td align="center">776/712</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">603</td>
<td align="center">971</td>
<td align="center">79</td>
<td align="center">79</td>
<td align="center">524/458</td>
<td align="center">892/817</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>For increasing values <italic>E</italic>, the number of domains is cumulative, all domains identified with an E-value ≤ <italic>E</italic> are counted.</p>
</fn>
<fn id="t002fn002">
<p><sup>a</sup>Number of CLADE predictions occurring on proteins with no domain annotation in PlasmoDB.</p>
</fn>
<fn id="t002fn003">
<p><sup>b</sup>Number of new domains annotated by CLADE that enrich already known protein architectures.</p>
</fn>
<fn id="t002fn004">
<p><sup>c</sup>Number of new domains annotated by CLADE that occur in no <italic>P. falciparum</italic> protein, according to PlasmoDB.</p>
</fn>
<fn id="t002fn005">
<p><sup>d</sup>CLADE new predictions obtained with sequence consensus models (SCMs). These domains are not identified by HMMScan with GA cut-off.</p>
</fn>
<fn id="t002fn006">
<p><sup>e</sup>Predictions obtained with clade-centered models (CCMs). Two values <italic>n</italic>/<italic>m</italic> are reported, <italic>n</italic> is the difference between the total number of CLADE predictions (third column) and the number of those predictions that are based on SCM (fifth column), and <italic>m</italic> is the number of predictions that are obtained exclusively by CCMs (within the E-value range).</p>
</fn>
<fn id="t002fn007">
<p><sup>f</sup>Number of CLADE predictions that are supported by domain co-occurrence.</p>
</fn>
<fn id="t002fn008">
<p><sup>g</sup>Total number of CLADE predictions including those that are not supported by domain co-occurrence.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>Two overlapping hits in PlasmoDB and CLADE “agree” if they are associated to the same clan (possibly, the same domain). Vice versa, two overlapping hits “disagree” if they are associated to different clans (<xref ref-type="fig" rid="pcbi.1005038.g006">Fig 6A</xref>). We identify as “new”, those domains predicted by CLADE that do not overlap PlasmoDB hits (<xref ref-type="fig" rid="pcbi.1005038.g006">Fig 6B</xref>) or that disagree with some PlasmoDB annotation (<xref ref-type="fig" rid="pcbi.1005038.g006">Fig 6A</xref>). Also, we say that a CLADE hit is “brand-new” if the domain does not occur in any <italic>P. falciparum</italic> protein architecture in PlasmoDB. Based on these notions we observe that among the 2116 new domains identified by CLADE, 916 concern <italic>P. falciparum</italic> proteins that have never been predicted before (for an E-value ≤ 1<italic>e</italic>-3; <xref ref-type="table" rid="pcbi.1005038.t002">Table 2</xref>) and 1200 are additional domains enriching already identified protein architectures (<xref ref-type="table" rid="pcbi.1005038.t002">Table 2</xref>, middle). As expected, no contribution coming from SCMs seems to help, for both classes of predictions, most of the predictions being based on CCMs. 971 domains are identified as brand-new. Note that brand-new domains might enrich already known architectures or might occur in proteins with no annotation in PlasmoDB. CLADE predicts their co-occurrence with already annotated domains for 603 of them (<xref ref-type="table" rid="pcbi.1005038.t002">Table 2</xref>, bottom).</p>
<fig id="pcbi.1005038.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Schema of CLADE annotations versus PlasmoDB annotations.</title>
<p><bold>A.</bold> Examples of new domains in CLADE that overlap either non annotated regions (blue) or PlasmoDB hits associated to different clans (green and yellow). Red hits agree because they are associated to the same domain and (dark and light) violet hits agree because their associated domains are in the same clan. <bold>B.</bold> Example of a new domain in a sequence that is not annotated in PlasmoDB. <bold>C.</bold> Example of an enriched PlasmoDB architecture. It is constituted by CLADE domains that either agree with PlasmoDB domains (light and dark grey) or are new (blue and orange). Note that CLADE hits agreeing with PlasmoDB annotation might correspond to different regions in the sequence (see length of CLADE and HMMScan hits in dark and light grey).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.g006" xlink:type="simple"/>
</fig>
<p>Among the 2116 CLADE new domains (<xref ref-type="fig" rid="pcbi.1005038.g006">Fig 6A and 6B</xref>), there are 824 of them that belong to proteins with unknown function in PlasmoDB, and among the 1200 domains enriching known architectures (<xref ref-type="fig" rid="pcbi.1005038.g006">Fig 6A and 6C</xref>), we count 207 such domains (<xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5B</xref>). In general, when considering predictions for proteins with unknown function in PlasmoDB, the majority of these predictions are realized without using domain co-occurrence and they greatly depend on the availability of CCMs (<xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5B</xref>).</p>
<p>An example of <italic>P. falciparum</italic> protein annotation realized with CLADE is illustrated in <xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7</xref>. The sequence was annotated by Pfam<sub>27</sub> with a few known domains. Besides confirming Pfam<sub>27</sub> annotation, CLADE identifies new hits by co-occurrence of similar domains in other species (<xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7A</xref>). The co-existence of Kelch motifs, TIG and filamin domains in a <italic>Chlamydomonas reinhardtii</italic> architecture and of DUF947 in a <italic>Aureococcus anophagefferens</italic> architecture with Dynein domain allowed for a more precise annotation than the one proposed by Pfam<sub>27</sub> (<xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7B</xref>).</p>
<fig id="pcbi.1005038.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.g007</object-id>
<label>Fig 7</label>
<caption>
<title>CLADE annotation supported by domain co-occurrence. Analysis of <italic>P. falciparum</italic> protein PF3D7_1122900 (PF11_0240).</title>
<p>The protein is 5 251aa long. The list of domains (in various colors and) annotated by various methods is reported on the bottom. <bold>A.</bold> Comparison of the architectures found by CLADE<sub>27</sub> (that is CLADE based on Pfam<sub>27</sub> domains) and Pfam<sub>27</sub>. Six CLADE<sub>27</sub> domains, absent in Pfam<sub>27</sub>, are highlighted by a black dot. <bold>B.</bold> Two Pfam<sub>27</sub> architectures showing domain co-occurrence supporting CLADE<sub>27</sub> annotation. <bold>C.</bold> Comparison of the architectures found by CLADE<sub>24</sub> (that is CLADE based on Pfam<sub>24</sub> domains), CODD [<xref ref-type="bibr" rid="pcbi.1005038.ref024">24</xref>], dPUC [<xref ref-type="bibr" rid="pcbi.1005038.ref026">26</xref>] and Pfam<sub>24</sub>. Notice that the MORN_2 domain has been predicted by CODD but that it is supported by an extremely high E-value (= 7.5) and no co-occurrence. All other domains have been detected by CLADE<sub>24</sub> as well. Eleven CLADE<sub>24</sub> domains, absent in Pfam<sub>24</sub>, are highlighted by a black dot. Some of these domains have been identified by CODD and dPUC also. <bold>D.</bold> Two Pfam<sub>24</sub> architectures showing co-occurrence and supporting CLADE<sub>24</sub> annotation. Compare with the <italic>Chlamydomonas reinhardtii</italic> annotation provided by Pfam<sub>27</sub> in <bold>B</bold>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.g007" xlink:type="simple"/>
</fig>
<p>This example bears witness to the coherence of CLADE predictions. In fact, it highlights that several domains identified by CLADE annotation based on Pfam<sub>24</sub> and missed by Pfam<sub>24</sub> annotation are confirmed by Pfam<sub>27</sub> annotation. Namely, two of the four Kelch motif occurrences (orange domains in <xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7C</xref>) and all three ATPases occurrences (grey domains in <xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7C</xref>) identified by CLADE<sub>24</sub> are confirmed by Pfam<sub>27</sub> (olive green domains and violet, grey, dark violet domains in <xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7A</xref>, respectively). Yet, a number of domains like DHC_N2 (Dynein), TIG and filamin, highlighted already by CLADE with CCMs generated in Pfam<sub>24</sub>, are still to be identified in Pfam<sub>27</sub> annotation (<xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7C</xref>). In this respect, notice that the <italic>Chlamydomonas reinhardtii</italic> architecture supported by Pfam<sub>27</sub> has been highly enriched compared to the older version in Pfam<sub>24</sub> (see <xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7D</xref>). This demonstrates that domains co-existence is a very powerful tool of annotation analysis.</p>
</sec>
<sec id="sec013">
<title>The multi-source strategy enriches CLADE architectures in <italic>P. falciparum</italic> sequences</title>
<p>To illustrate the power of the multi-source strategy, we discuss a concrete example of domain annotation for the two <italic>P. falciparum</italic> sequences PF3D7_0502000 (PFE0100w) and PF3D7_1219100 (PFL0930w), where a clathrin domain is found in the two sequences (see pink domains with a black boundary in <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8A and 8B</xref>) by two distinguished CCMs presenting rather different physico-chemical conservation profiles (<xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8C</xref>, middle and bottom for domains in PFL0930w and PFE0100w, respectively). The SCM associated to the Clathrin domain by Pfam<sub>27</sub> does not identify the domain in PFE0100w while it identifies it in PFL0930w with E-value 1.9<italic>e</italic>-28.</p>
<fig id="pcbi.1005038.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005038.g008</object-id>
<label>Fig 8</label>
<caption>
<title>A concrete example illustrating the role of the multi-source strategy in CLADE.</title>
<p>Analysis of the clathrin domain identification (Pfam domain PF00637) in two <italic>P. falciparum</italic> proteins PF3D7_0502000 (PFE0100w) and PF3D7_1219100 (PFL0930w). Their occurrence is highlighted with a black contour in <bold>A</bold> and <bold>B</bold>. These protein sequences are 1 272aa and 1 997aa in length, respectively. <bold>A.</bold> Annotation of PFE0100w. Pfam<sub>27</sub> prediction: only one domain is identified. CLADE prediction: three domains are identified, two of which are new. <bold>B.</bold> Annotation of PFL0930w. Three domains are identified, a clathrin propel, a clathrin H-link and seven copies of the clathrin domain. Pfam<sub>27</sub>: the selected clathrin domain (with a black contour) is identified with E-value 1.9<italic>e</italic>-28. CLADE: the selected clathrin domain (with a black contour) is identified with a CCM based on <italic>Eurytemora affinis</italic> with E-value 2<italic>e</italic>-40. <bold>C.</bold> Physico-chemical conservation analyses of the SCM (top) for the clathrin domain identified in PFE0100w, and of the two CCMs generated by <italic>Harpegnathos saltator</italic> (middle) and by <italic>Eurytemora affinis</italic> (bottom) for the clathrin domain identified in PFE0100w and in PFL0930w, respectively. Each display shows the physico-chemical property that is most represented at a given position of the multiple sequence alignment generating the profile. Colored bars describe physico-chemical classes; the color scale is given at the bottom. The height of each colored bar corresponds to the frequency of the most represented (conserved) amino acid property. Values vary from 0 to 100: for instance, a blue bar that goes up to 100 indicates that the 100% of the amino acids occurring at this position are hydrophobic. The <italic>P. falciparum</italic> sequence PFE0100w is reported for the top and middle displays together with the physico-chemical positional matching, indicated by a *, between the corresponding residue in the <italic>P. falciparum</italic> sequence and the alignment position, if any. The display on the bottom is matched to the PFL0930w sequence. Amino acids are classified as suggested in [<xref ref-type="bibr" rid="pcbi.1005038.ref043">43</xref>] according to biochemical similarities: hydrophobic (VILMFWA), negatively charged (DE), positively charged (KR), aromatic (YH), polar (NSTQ), and C, G, P considered as special. <bold>D.</bold> The species that contributed to CLADE identification of the clathrin domain in <italic>P. falciparum</italic> sequence PFE0100w are organized into a schematic phylogenetic tree (drawing inspired by Figure 1 in [<xref ref-type="bibr" rid="pcbi.1005038.ref044">44</xref>]). For each clade, the total number of species involved in CCM construction is indicated at the “root” of the associated tree. Species are marked by a colored dot indicating the E-value range obtained by matching the corresponding CCM to the PFE0100w sequence. The color scale follows E-value ranges. <bold>E.</bold> Four amino-acid profiles of the clathrin domain, two provided by CCMs generated by Metazoan species (<italic>Harpegnathos saltator</italic> and <italic>Eurytemora affinis</italic>) and two by Amoebozoan species (<italic>Dictyostelium discoideum</italic> and <italic>Entamoeba histolytica</italic>), are mapped against the two <italic>P. falciparum</italic> sequences PFE0100w (left) and PFL0930w (right). (Note that PFE0100w and PFL0930w sequences are also reported in <bold>C</bold>.) E-values for the mappings of CCMs against the two <italic>P. falciparum</italic> sequences are reported on the profile heading (in parenthesis). Profiles in the Alveolata box (bottom) are constructed by running PSI-BLAST on the two identified <italic>Plasmodium</italic> domain sequences; they show high similarity with the profiles coming from Metazoan and Amoebozoan species.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.g008" xlink:type="simple"/>
</fig>
<p>We observe a low level of conservation in the physico-chemical profile of the Pfam<sub>27</sub> SCM (<xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8C</xref>, top) compared to the high level of conservation recorded for the two CCMs used to annotate the two sequences (<xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8C</xref>, middle and bottom): when aligned with the clathrin hit in the respective <italic>P. falciparum</italic> sequences, one observes that the number of positions preserving the physico-chemical properties in <italic>P. falciparum</italic> is much higher for the CCMs than for the SCM (see the higher number of starred positions below each one of the three profiles).</p>
<p>Besides the CCM used to best annotate the PFE0100w sequence, all other CLADE CCMs for the clathrin domain were considered against the PFE0100w sequence but they scored lower than the CCM generated by <italic>Harpegnathos saltator</italic>. The distribution of their E-value scores across the phylogenetic tree is illustrated in <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8D</xref>. We notice that the best hits were obtained with CCMs generated by Metazoan or Fungi species, and that for all models generated by Alveolata species, scores were quite low, suggesting that annotation based on Alveolata species could be hard to identify. A similar pattern can be displayed for PFL0930w.</p>
<p>Several CCMs display a physico-chemical conservation profile that is closer to PFE0100w than to PFL0930w. See <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8E</xref>. For both sequences, we find CCMs with close profiles in the three Metazoa, Amaebozoa and Alveolata clades.</p>
</sec>
<sec id="sec014">
<title>Species helping domain identification</title>
<p>To understand how the large space of available sequences is exploited by CLADE to attaint <italic>P. falciparum</italic> predictions, we performed two distinguished <italic>a posteriori</italic> analyses of the set of species generating the CCMs that helped CLADE predictions (<xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5C</xref>).</p>
<p>First, we observed that the 54% of the contribution is provided by homologs belonging to the Alveolata clade and that the 46% of homologs belongs to other clades and, among them, Metazoa, Fungi, Viridiplantae appear to be the most represented Eukaryotic clades. A non negligible contribution is also recorded from Viruses, Bacteria and Archaea homologs. (Compare Bacteria with Viridiplantae in the inset of <xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5C</xref>.) This finding agrees with the intuition that best sequence similarity most likely appears within the Alveolata clade, but it also highlights that half of the times this is not the case, and especially for the predictions whose E-value is not very high (notice the E-value distribution in <xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5C</xref>). When we consider new domains only, the contribution from Alveolata species decreases (32.21%) in favour of all other species (67.79%; <xref ref-type="supplementary-material" rid="pcbi.1005038.s009">S4 Fig</xref>). Over 2 116 new predictions, 291 come from CCMs generated from viral, bacterial and archaeal species.</p>
<p>In this respect, the analysis reported in <xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4C</xref> quantifies the improvement obtained by adding to the Pfam set of models, those CCMs generated by sequences belonging to arbitrary species (red curve in <xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4C</xref>) compared to the Alveolata models only (grey curve <xref ref-type="fig" rid="pcbi.1005038.g004">Fig 4C</xref>), making the 3% of all CLADE models (see <xref ref-type="fig" rid="pcbi.1005038.g002">Fig 2</xref>). It confirms the interest in an expanded model construction.</p>
<p>Second, we checked whether pairs of domains occurring in the same <italic>P. falciparum</italic> protein were identified based on CCMs associated to species belonging to the same clade or not (<xref ref-type="supplementary-material" rid="pcbi.1005038.s003">S3 Table</xref>). Over the 1 688 <italic>P. falciparum</italic> proteins with at least two domains identified by CLADE (where the confidence on these predictions is strongly supported by domain co-occurrence), we found that 900 multi-domain proteins contain domains that are detected by CCMs coming from different clades. In particular, if we look at predictions with respect to a fixed E-value, we find that among the 60 multi-domain proteins containing at least a domain predicted at E-value ≤ 1<italic>e</italic>-60, 28 present a domain identification that is based on different clades. Similarly, among the 627 multi-domain proteins whose domains are identified with 1<italic>e</italic>-15 &lt; E-value ≤ 1<italic>e</italic>-5, 376 are identified with different clades, that is almost half of the proteins containing at least two domains are identified with the help of several clades. This is in agreement with the hypothesis that a protein evolutionary process is random, and hence, clade independent. A concrete example is illustrated in <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8</xref>, where CLADE identifies three domains with CCMs generated by sequences from Metazoa (<italic>Harpegnathos saltator</italic> for the clathrin domain), Trichomonadida (<italic>Trichomonas vaginalis</italic> for zf-C3HC4) and Alveolata species (another <italic>P. falciparum</italic> protein for VPS11_C). Two of the species defining CCMs predicted with best E-values are sparse in the tree and far from the Alveolata clade, explaining the difficulty of annotating this protein with SCMs. These three domains have been found to co-occur in 34 different species including <italic>Homo sapiens</italic> and <italic>Anopheles gambiae</italic> (details are available in Pfam website).</p>
</sec>
<sec id="sec015">
<title>Physico-chemical conservation for predictions based on CCMs</title>
<p>CCMs used in domain prediction provide a physico-chemical profile of the protein that is typically more conserved than the one obtained by the associated SCM (observe the number of starred positions along the <italic>P. falciparum</italic> sequence in <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8C</xref>).</p>
<p>The amino acid groups analysis of the two <italic>P. falciparum</italic> sequences, PFE0100w and PFL0930w, shows very high positional conservation obtained with the CCMs of <italic>Harpegnathos saltator</italic> (E-value 4<italic>e</italic>-30) and <italic>Eurytemora affinis</italic> (E-value 2<italic>e</italic>-40). Compare with the conservation profile of the SCM on the PFE0100w sequence (E-value &gt; 1, top).</p>
<p>This property augments our confidence in the method. In particular, notice that physico-chemical profiles help to detail the differences between CCMs. In fact, different matches of different CCMs for the same domain might highlight different evolutionary signatures of the domain. In <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8E</xref>, for instance, the physico-chemical profiles of different models for the clathrin domain indicate two classes of models, one matching the PFE0100w domain and the other matching the PFL0930w domain (see left and right profiles in <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8E</xref>).</p>
</sec>
<sec id="sec016">
<title>CLADE versus HHblits on <italic>P. falciparum</italic> genome</title>
<p>We compared the domain annotation obtained with HHblits and CLADE. For this, we considered increasing HHblits FDR thresholds (from 0.1% up to 10%) and fixed CLADE FDR at 0.1%. Looking at predictions upon which CLADE and HHblits agree (overlapping hits that are annotated by the two systems with the same domain or by domains belonging to the same clan; see <xref ref-type="supplementary-material" rid="pcbi.1005038.s005">S5 Table</xref>), we observe that:</p>
<list list-type="order">
<list-item>
<p>the proportion of HHblits domain hits in agreement with CLADE is much larger for stringent FDR thresholds (note the almost complete overlapping at FDR 0.1% reported in <xref ref-type="supplementary-material" rid="pcbi.1005038.s005">S5 Table</xref>) and gets smaller, by reaching a converging bound, for high FDR values.</p>
</list-item>
<list-item>
<p>CLADE can detect with higher confidence (due to smaller E-values and co-occurrence), domains that are detected by HHblits at much higher FDR, and therefore much lower confidence. For instance, of the 916 CLADE domains occurring on proteins annotated for the first time, 477 of them are detected by HHblits at FDR 10%.</p>
</list-item>
<list-item>
<p>CLADE predicts in newly annotated architectures more than 400 domains that are missed by HHblits at FDR 10%. Of those, 230 are supported by co-occurrence and have E-value varying from 6<italic>e</italic>-88 to 1<italic>e</italic>-3. The fact that they are supported by known co-occurrent domain contexts brings confidence in their prediction.</p>
</list-item>
<list-item>
<p>for high FDRs, HHblits is prone to obtain a large number of false positives. In fact, note that at FDR 10%, only 772 domains over a total of 3 260 HHblits predictions on proteins annotated for the first time, are supported by domain co-occurrence. This holds true for both the enrichment of known protein structures and the predictions of brand-new domains. In contrast, notice that at a FDR of 0.1%, many HHblits predictions are supported by co-occurrence.</p>
</list-item>
</list>
</sec>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>When sequences in a protein domain family are too divergent, signals of homology are easier to trace with CCMs rather than with models based on the consensus of homologous sequences spanning the entire phylogenetic tree (reminiscent ideas were presented in [<xref ref-type="bibr" rid="pcbi.1005038.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1005038.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref045">45</xref>]). CLADE shows that, by combining in a unique tool CCMs and consensus models, the predictive power can be highly reinforced.</p>
<p>In CLADE, CCMs have been constructed for domains in the Pfam database. In this respect, it is worth to highlight that CCMs are basically different from: 1. Pfam models characterizing Pfam clans [<xref ref-type="bibr" rid="pcbi.1005038.ref046">46</xref>] whose purpose is to group different families together, possibly new protein families that appear to have arisen from a single evolutionary origin; 2. Pfam models characterizing Pfam domain families (called SCMs in CLADE). Compared to both Pfam family models, CCMs are much closer to actual protein sequences, therefore more specific and more functionally predictive. In fact, one can think of CCMs as forming a new layer of models situated at the very bottom of the Pfam hierarchy and associated to FULL sequences within Pfam domain families. The example reported in <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8C and 8E</xref> illustrates how CCMs are closer to sequences than Pfam family models.</p>
<p>Standard approaches, like Pfam, are limited to consensus within seeds only, and CCMs showed to model evolutionary information differently. Below, we propose several ways to revisit basic evolutionary questions based on CCMs.</p>
<p><bold>CCMs can be used to analyze ancient duplications.</bold> Modern sequences evolved in the context of full genome and local duplications. The fate of the duplicated domains could be different for several reasons. The most important one is domain organization within architectures, where the accomplishment of different cooperative functional purposes might induce duplicated domains to reach possibly very divergent sequence profiles. CCM can help to model these parallel profiles (created by domain divergence) better than a consensus approach. The example on clathrin domains illustrated in <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8</xref> highlights the parallel co-existence in the Metazoa and Amoebozoa clades of CCMs characterized by two distinguished profiles, suggesting that an ancient duplication took place before the Metazoa-Amoebozoa phylogenetic divergence and gave origin to the two kinds of domains observed today in the two clades. The existence of two distinguished copies (fitting the two profiles) of the clathrin domain in the <italic>P. falciparum</italic> genome, reveals that this duplication is even older and places it before the Metazoa-Amoebozoa-Alveolata divergence. CCMs can be used for large scale explorations of parallel profiles evolution.</p>
<p><bold>Multiple CCMs can be used to analyse domain evolution.</bold> Whether the actual number of evolutionary pathways for a domain family is relatively small or not remains an open question. The large number of CCMs associated to a domain <italic>D</italic> characterizes the evolutionary landscape of <italic>D</italic>, and highlights the viability of different evolutionary processes. The mathematical description of the models, as probabilistic profiles, can be used to explicitly address quantitative questions on the landscape variability. For instance, a measure of how different CCMs are, one from the other, can be developed and used to bring an estimation on the number of distinct evolutionary pathways associated to a domain. Do different domains have a sensibly different number of evolutionary pathways associated to them? Does the distribution of distances between probabilistic profiles of a given domain have a small/large variance? Can we suggest a graph-like relational structure among CCMs and exploit the structure of the graph to infer functional consequences? These questions do not have an answer today but they seem fundamental to the understanding of the evolutionary landscapes we observe.</p>
<p><bold>CCMs and their impact on functional annotation.</bold> The interest of an accurate genomic mapping of protein domains and protein architectures is multiple. It directly implies the possibility to develop: 1. a more precise functional analysis of domains and architectures within genomes; 2. a comparative analysis of domains and architectures between species within clades. Based on it, pangenomic differences of phylogenetically close microbial species (strains or genomes) can be defined at the domain level, and species variability carefully assessed. By using domains as the building blocks of proteins functional activity, we can assert that the presence of the same domains within different architectures in different species/strains might guarantee a similar functional activity for the organism. In this sense, a relaxed notion of pangenomic variability can be defined, closer in spirit to the functional activity of the species. Similar observations apply to microbial communities, where domains, more than proteins, appear to be useful building blocks for functional annotation; 3. a comparative analysis of domains and architectures between species across distant clades. This could help to improve estimating the age of domains and architectures [<xref ref-type="bibr" rid="pcbi.1005038.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref048">48</xref>]; 4. an accurate identification of gene homology between pairs of genomes. This will directly benefit synteny blocks reconstruction and chromosomal rearrangement analyses; 5. an improved tracing of gene acquisition for bacterial species, where lateral gene transfer is much present. This will imply a more precise reconstruction of reticulate evolution.</p>
<p><bold>CCMs and domain architectures identification.</bold> The way protein architectures form is an important factor to understand protein evolution. A quantification of the elementary events affecting protein architectures, such as domain(s) insertion/deletion, duplication and exchange, was done [<xref ref-type="bibr" rid="pcbi.1005038.ref049">49</xref>] but, yet, little is known about the relationships between these elementary events [<xref ref-type="bibr" rid="pcbi.1005038.ref050">50</xref>] and the molecular mechanisms they originate from. Finer domain mapping (obtained with more precise annotation tools as CLADE) on all proteins of completely sequenced genomes will contribute precise information on the evolution of protein architectures. This means, for instance, a more precise estimation of the rate of insertion, deletion, duplication and exchange of domains within proteins in a given species. In general, it would be interesting: 1. to establish whether the process of generation of an architecture follows constraints or not, 2. to pinpoint such constraints, if they exist, and 3. to verify whether they are species specific or not. This information turns out to be useful in the context of phylogenetic profiles prediction [<xref ref-type="bibr" rid="pcbi.1005038.ref051">51</xref>].</p>
<p><bold>The role of the Alveolata and other clades in <italic>P. falciparum</italic> domain annotation.</bold> An <italic>a posteriori</italic> analysis of our predictions highlights that: 1. species in the Alveolata clade are preferably chosen for domain identification (54%), 2. a significant number of identifications (46%) are suggested by species that lie outside the Alveolata clade (that is, far from <italic>P. falciparum</italic>) and yet providing acceptable E-values for predicted domains (<xref ref-type="fig" rid="pcbi.1005038.g005">Fig 5C</xref>). The first point confirms the strength and importance of considering phylogenetic signals in annotation, and the second point highlights the limitations of the idea of phylogenetic proximity.</p>
<p>Besides the observation that many <italic>P. falciparum</italic> sequences are more easily identifiable by CCMs generated by phylogenetically distant species rather than CCMs coming from Alveolata species, other observations strongly reinforce the interest in looking at different clades while identifying domains: 1. multi-domain proteins identified with CCMs originated in different clades, suggest processes of domain evolution that are independent within each protein (see the three domains identified with models constructed from Alveolata, Amaebozoa and Cryptophyta sequences in <xref ref-type="fig" rid="pcbi.1005038.g008">Fig 8</xref>); 2. new domain families are periodically added to databases like Pfam and annotation becomes gradually more precise as a function of this addition (see the impact of the Pfam<sub>27</sub> enrichment on the <italic>Chlamydomonas reinhardtii</italic> protein architecture compared to Pfam<sub>24</sub> in <xref ref-type="fig" rid="pcbi.1005038.g007">Fig 7A and 7C</xref>); 3. CCMs coming from bacterial and archaeal species should allow to check for ancient lateral gene transfer.</p>
<p><bold>On CLADE methodological improvements.</bold> On the methodological side, the use of agreement among models (handled by SVMs) and of co-occurrence (handled by DAMA) in CLADE improves predictions up to 19.6% on the <italic>P. falciparum</italic> sequences (<xref ref-type="supplementary-material" rid="pcbi.1005038.s004">S4 Table</xref>), over a score system based on best E-values (CLADE<sub><italic>BEv</italic></sub>) and this highlights that criteria other than sequence similarity, play a key role in the identification of protein domains. The usage of multiple criteria to reach agreement among models, allows for new predictions and plays an important role in the evaluation of the confidence in a prediction, with improved scores that can help the biologist to annotate sequences.</p>
<p>Several ways could be envisaged to improve further our methodological approach.</p>
<list list-type="order">
<list-item>
<p>The sequence search tool PSI-BLAST [<xref ref-type="bibr" rid="pcbi.1005038.ref052">52</xref>] could be replaced by the profile-profile comparison tool HHblits [<xref ref-type="bibr" rid="pcbi.1005038.ref017">17</xref>], and both CCMs and consensus models could be constructed by HHblits. For large applications, the construction of profiles for the query sequences and the identification of domain specific cut-offs for all domains become too costly, and one could transform HHblits models in HMMs to avoid profile-profile comparison.</p>
</list-item>
<list-item>
<p>The number of meta-features in the meta-classifier used to combine model predictions could be increased. For instance, one could encode motif information known for specific domains. The SVM could be improved, by making the choice of a given kernel to be domain specific. More radically, the choice of designing CLADE based on SVM could be revisited. Other decision strategies could be employed instead, like multi-response linear regression [<xref ref-type="bibr" rid="pcbi.1005038.ref053">53</xref>] for instance.</p>
</list-item>
<list-item>
<p>Domain co-occurrence re-ranks low confidence domains as relevant when they appear with co-occurring domains. The power of this criterion has been already observed in [<xref ref-type="bibr" rid="pcbi.1005038.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref055">55</xref>]. Other multi-objective optimization functions could be added in DAMA to screen the domain list and exploited in CLADE, as discussed in [<xref ref-type="bibr" rid="pcbi.1005038.ref027">27</xref>].</p>
</list-item>
<list-item>
<p>CLADE selects a reference set of domain sequences exploiting the large span of organisms in the phylogenetic tree of life. This choice ignores how protein evolution is full of gene duplications, horizontal gene transfer, domain shuffling and so on. It is reasonable to think that building gene trees and couple them with CLADE would help to better span the sequence diversity right at the beginning of the models construction. Future development of CLADE could explicitly consider orthology/paralogy/xenology to better build CCMs.</p>
</list-item>
<list-item>
<p>The pool of approximately 350 CCMs associated to each domain could be extended to provide an enriched annotation. Several databases, such as SCOP, CATH, Gene3D, propose domains that are not shared with Pfam. From these domains new models can be constructed and added to the CLADE model library. This perspective demands the development of criteria to avoid redundancy in the model library and to ensure a reasonable computational time.</p>
</list-item>
</list>
<p>These methodological improvements are general, independent from specific genome characteristics, and guarantee the strategy to be applied to any genome. They will likely be able to address at least a part of the 28% of <italic>P. falciparum</italic> proteins that are still missing a domain identification and the protein architectures that should be enriched with new domains (among the 2394 single domain proteins, 1214 of them contain a domain that covers less than the half of the protein length, and for these proteins we expect multiple domains to lie together). Some unannotated proteins in <italic>P. falciparum</italic> likely contain completely novel domains, which are evolutionarily unrelated to domains present in the existing domain family databases. If that is so, CLADE would not find them, at least not until existing databases grow enough to cover more of that domain space.</p>
<p><bold>CCMs and computational power.</bold> By using HPC, CLADE demonstrates to push the limits in annotation reached by current methods. The first step of CLADE, generating CCMs, is the highly expensive one. It is performed once for all genomes to be annotated. All CCMs used to realize <italic>P. falciparum</italic> annotation have been constructed in 3.7 months of computer time by using 250 CPUs (and they are made publicly available). The two subsequent steps (2 and 3), dedicated to genome annotation, are relatively fast. For example, CLADE steps 2 and 3 ran in about 1 hr on 100 CPUs for the entire <italic>P. falciparum</italic> genome. CLADE domain library is expected to be regularly updated on new domains appearing in databases. This means that only CCMs for new domains need to be constructed and added to the existing library. This step can be realized independently from steps 2 and 3. In years to come, the expected improvements in HPC and in CLADE implementation (with a thoughtful selection of domain models) will render CLADE more computationally accessible.</p>
</sec>
<sec id="sec018" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec019">
<title>Databases</title>
<p>Our method extends Pfam, an important collection of protein domains, that has been widely used for annotating proteins with unknown function. We use Pfam v27 (Pfam<sub>27</sub>, downloaded from <ext-link ext-link-type="uri" xlink:href="http://pfam.sanger.ac.uk" xlink:type="simple">http://pfam.sanger.ac.uk</ext-link>), containing 14 831 protein domains. In order to assess the performance of our method, we apply it to the set of all <italic>P. falciparum</italic> proteins. For this, we use PlasmoDB (<ext-link ext-link-type="uri" xlink:href="http://PlasmoDB.org" xlink:type="simple">http://PlasmoDB.org</ext-link>), that is the official repository of the <italic>P. falciparum</italic> proteins used as a reference database by malaria researchers. PlasmoDB v11.1 contains 5 542 proteins.</p>
<p>We used the UniProtKB database [<xref ref-type="bibr" rid="pcbi.1005038.ref056">56</xref>]: 1. to extract NCBI taxonomy for sequences and the list of known domain architectures. 2. to recover the Pfam domain organization of all proteins in UniProt 15.6 (Swiss-Prot 57.6 and SP-TrEMBL 40.6); we downloaded the dataset <ext-link ext-link-type="uri" xlink:href="ftp://ftp.ebi.ac.uk/pub/databases/Pfam/releases/Pfam27.0/swisspfam.gz" xlink:type="simple">ftp://ftp.ebi.ac.uk/pub/databases/Pfam/releases/Pfam27.0/swisspfam.gz</ext-link> and used it to analyze co-occurrence in CLADE annotations. (In our tables and figures, “Cooc”, abbreviating “predictions supported by domain co-occurrence”, and “Cooc-CCM”, abbreviating “predictions identified by a CCM and supported by domain co-occurrence”, count architectures whose domain pairs belong to already known architectures.)</p>
<p>A reference list of clades has been extracted from NCBI (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/taxonomy" xlink:type="simple">http://www.ncbi.nlm.nih.gov/taxonomy</ext-link>) and used for selecting a representative set of sequences in the construction of CCMs. Clades have been specified for Bacteria, Archaea, Viruses and Eukaryotes in <xref ref-type="supplementary-material" rid="pcbi.1005038.s001">S1 Table</xref>.</p>
<p>We used the SCOP v1.75 [<xref ref-type="bibr" rid="pcbi.1005038.ref041">41</xref>] database to compare CLADE, based on the multi-source strategy, with the mono-source strategy of HMMScan [<xref ref-type="bibr" rid="pcbi.1005038.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref033">33</xref>] and HHblits [<xref ref-type="bibr" rid="pcbi.1005038.ref017">17</xref>]. Also, the SCOP datasets allowed us to compare CLADE with the computational strategy employed in SUPERFAMILY, a system that builds multiple hidden Markov models, for each protein superfamily, to realize sequence search. The SUPERFAMILY sequence search method is built on 1 962 superfamilies (from classes a to g), while CLADE relies on Pfam<sub>27</sub> containing 14 831 protein domains. To realize the comparative analyses, we considered SCOP domains whose associated sequences are coming from at least 10 species, and constructed a three testing sets from the ASTRAL95 dataset, containing 255 domain families and 8 633 sequences with at most 95% sequence identity, from ASTRAL30, made of 66 domain families and 1 251 sequences with at most 30% sequence identity, and from ASTRAL10 made of 18 domain families and 306 sequences with at most 10% sequence identity. ASTRAL95, ASTRAL30 and ASTRAL10 are subsets of SCOP [<xref ref-type="bibr" rid="pcbi.1005038.ref021">21</xref>] and can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://scop.berkeley.edu/astral/subsets/ver=1.75" xlink:type="simple">http://scop.berkeley.edu/astral/subsets/ver=1.75</ext-link>.</p>
<p>Tests with HHblits required the use of HHdb, a database built from the UniProt and NCBI NR databases, and provided in the HH-suite package [<xref ref-type="bibr" rid="pcbi.1005038.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref042">42</xref>].</p>
</sec>
<sec id="sec020">
<title>Tools run for comparison</title>
<p>HMMScan was run with default parameters and curated inclusion thresholds. The option <monospace>–cut_ga</monospace>, for model-specific thresholding (using profile’s GA gathering cutoffs to set all thresholding), was used. HMMScan is included in the HMMer 3.0 package [<xref ref-type="bibr" rid="pcbi.1005038.ref033">33</xref>] downloadable at <ext-link ext-link-type="uri" xlink:href="http://hmmer.janelia.org/software" xlink:type="simple">http://hmmer.janelia.org/software</ext-link>.</p>
<p>HHblits was run with default parameters. It is part of the HH-suite package—version 2.0.15 [<xref ref-type="bibr" rid="pcbi.1005038.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref042">42</xref>] downloadable at <ext-link ext-link-type="uri" xlink:href="https://github.com/soedinglab/hh-suite" xlink:type="simple">https://github.com/soedinglab/hh-suite</ext-link>.</p>
</sec>
<sec id="sec021">
<title>Detailed description of the CLADE pipeline</title>
<p>First, we detail how Pfam methodology works and how we modify it by including additional models, called <italic>clade-centered models</italic> (CCM). Then, we describe how to combine those models to produce reliable predictions. In the final step, we apply DAMA, an algorithm especially designed to take into account domain co-occurrence, to find the most likely domain architecture.</p>
<sec id="sec022">
<title>Pfam methodology</title>
<p>Let <italic>D</italic><sup><italic>i</italic></sup> be an arbitrary protein domain in the Pfam database. In Pfam, <italic>D</italic><sup><italic>i</italic></sup> is associated to two sets of sequences, SEED and FULL. SEED is a set of protein sequences, called seed sequences for the domain <italic>D</italic><sup><italic>i</italic></sup>, that share evolutionary and structural properties. It is defined by Pfam curators and results in a high-quality set of sequences. Pfam aligns seed sequences to build a profile hidden Markov model, SCM<sup><italic>i</italic></sup>, that represents the consensus of the seed alignment, that is the common features of the seed sequences. SCM<sup><italic>i</italic></sup> is used by Pfam to scan databases of proteins with unknown function by localizing regions in sequences that are similar to the domain <italic>D</italic><sup><italic>i</italic></sup>. Pfam predictions are those domain hits that HMMScan identifies with the <monospace>–cut_ga</monospace> option. In contrast, FULL is a automatically generated set. To construct it, Pfam uses SCM<sup><italic>i</italic></sup> to search in UniProtKB [<xref ref-type="bibr" rid="pcbi.1005038.ref056">56</xref>] for all significant hits from HMMScan (using the <monospace>–cut_ga</monospace> option). Most FULL sequences are never evaluated by experts, and some of them are probably false positives from HMMScan (sharing neither evolution nor structure). FULL contains SEED. In what follows, FULL is denoted <inline-formula id="pcbi.1005038.e005"><alternatives><graphic id="pcbi.1005038.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mn>1</mml:mn> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and SEED is denoted <inline-formula id="pcbi.1005038.e006"><alternatives><graphic id="pcbi.1005038.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>m</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>*</mml:mo></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Each sequence in FULL, and therefore in SEED, is associated to a protein in the UniProtKB database and provides a NCBI taxonomy for it.</p>
<p>A simplified Pfam flowchart, showing the library of SCMs generated by HMMer, one for each domain <italic>D</italic><sup><italic>i</italic></sup>, is illustrated in <xref ref-type="supplementary-material" rid="pcbi.1005038.s006">S1 Fig</xref> (solid lines).</p>
</sec>
<sec id="sec023">
<title>Clade-centered models</title>
<p>SCM<sup><italic>i</italic></sup> is a probabilistic model explaining how sequences in the SEED dataset <italic>S</italic><sup><italic>i</italic></sup>* of Pfam<sub>27</sub>, associated to the domain <italic>D</italic><sup><italic>i</italic></sup>, have evolved. By contrast, we shall build a number of new models by exploiting information coming from (possibly different) evolutionary paths associated to specific species. They are called <inline-formula id="pcbi.1005038.e007"><alternatives><graphic id="pcbi.1005038.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mtext>CCM</mml:mtext><mml:msubsup><mml:mrow/><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, where CCM stands for <italic>clade-centered model</italic>, <italic>i</italic> indexes the domain <italic>D</italic><sup><italic>i</italic></sup>, and <italic>j</italic> is an index running over the different models. To construct them, we take at most 350 sequences belonging to different species by choosing them from the FULL dataset <italic>S</italic><sup><italic>i</italic></sup> in Pfam<sub>27</sub>. The algorithm extracts a comparable number of sequences, whenever possible, from each clade. This automatic selection guarantees that the distribution of species is as uniform as possible across the panel of phylogenetic clades. (See list of clades leading the selection in <xref ref-type="supplementary-material" rid="pcbi.1005038.s001">S1 Table</xref>.) This set of selected sequences is referred to as <inline-formula id="pcbi.1005038.e008"><alternatives><graphic id="pcbi.1005038.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover><mml:msup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Each sequence in <inline-formula id="pcbi.1005038.e009"><alternatives><graphic id="pcbi.1005038.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover><mml:msup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> will be used as a query to search for similar sequences, with PSI-BLAST [<xref ref-type="bibr" rid="pcbi.1005038.ref052">52</xref>], within the non-redundant protein database (NR). From the resulting set of similar sequences, a probabilistic model <inline-formula id="pcbi.1005038.e010"><alternatives><graphic id="pcbi.1005038.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mtext>CCM</mml:mtext><mml:msubsup><mml:mrow/><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is constructed. As a result, we produce models <inline-formula id="pcbi.1005038.e011"><alternatives><graphic id="pcbi.1005038.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mtext>CCM</mml:mtext><mml:msubsup><mml:mrow/><mml:mn>1</mml:mn> <mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext>CCM</mml:mtext><mml:msubsup><mml:mrow/><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, with <inline-formula id="pcbi.1005038.e012"><alternatives><graphic id="pcbi.1005038.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mover><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mn>350</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. See <xref ref-type="supplementary-material" rid="pcbi.1005038.s006">S1 Fig</xref> (dotted lines).</p>
</sec>
<sec id="sec024">
<title>Combining Model Predictions</title>
<p>Reliable predictions are obtained by combining domain hits from different models. We follow three main steps:</p>
<p><italic>1. The building phase of the ensemble of clade-centered models.</italic> We modify Pfam original library, in such a way that, a single domain <italic>D</italic><sup><italic>i</italic></sup> is now represented by an <italic>ensemble of models</italic> <inline-formula id="pcbi.1005038.e013"><alternatives><graphic id="pcbi.1005038.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>=</mml:mo></mml:mrow> <mml:mo>{</mml:mo><mml:mtext>CCM</mml:mtext><mml:msubsup><mml:mrow/><mml:mn>1</mml:mn> <mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext>CCM</mml:mtext><mml:msubsup><mml:mrow/><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>i</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mtext>SCM</mml:mtext> <mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:math></alternatives></inline-formula>. We have used PSI-BLAST [<xref ref-type="bibr" rid="pcbi.1005038.ref052">52</xref>] and HMMer [<xref ref-type="bibr" rid="pcbi.1005038.ref033">33</xref>] for providing models in <inline-formula id="pcbi.1005038.e014"><alternatives><graphic id="pcbi.1005038.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mi>i</mml:mi></mml:msup></mml:math></alternatives></inline-formula>. The two tools exploit different data: individual sequences in the FULL dataset of Pfam<sub>27</sub> were used as queries to build <inline-formula id="pcbi.1005038.e015"><alternatives><graphic id="pcbi.1005038.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mtext>CCM</mml:mtext><mml:msubsup><mml:mrow/><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> with PSI-BLAST, and sequences in the SEED dataset were used by HMMer in Pfam<sub>27</sub> to build SCM<sup><italic>i</italic></sup>. SCM<sup><italic>i</italic></sup> models were downloaded directly from the Pfam website. A flowchart describing this pipeline is illustrated in <xref ref-type="supplementary-material" rid="pcbi.1005038.s006">S1 Fig</xref> (dotted and solid lines).</p>
<p><italic>2. The meta-classifier training phase.</italic> After the building phase of CCMs and SCMs, the models are run to search for potential domains and model outputs are combined to produce a final decision. For this latter step, one can employ plurality voting or meta-learning techniques [<xref ref-type="bibr" rid="pcbi.1005038.ref057">57</xref>]. We implemented a meta-learning decision strategy that used a meta-classifier (Support Vector Machine—SVM) trained from features that were obtained by pre-processing outputs of CCMs and SCMs. Model outputs (frequently corresponding to confidence scores) have been used directly in the SVM training [<xref ref-type="bibr" rid="pcbi.1005038.ref058">58</xref>]. After trying this algorithmic approach, we realized that we did not achieve good performance possibly for two reasons. First, the high divergence of the sequences in a protein dataset (for instance, the <italic>P. falciparum</italic> protein dataset) can imply that the distribution of confidence scores in the training set is different from the distribution in the testing data. Second, our models are very heterogeneous, since they were trained from different data sources, thus, it is not expected that there is necessarily an agreement among their predictions. Because of these two observations, any decision strategy that tries to find a perfect agreement of model answers is expected to fail. To avoid this, we designed meta-features which aim: (i) to highlight individual model results, when agreement among CCMs and SCMs models is not observed, and (ii) to provide an indication of the performance of all models. See schema in <xref ref-type="supplementary-material" rid="pcbi.1005038.s007">S2 Fig</xref>. We defined five meta-features as follows.</p>
<p>Let <italic>s</italic> be a query sequence that we wish to score against all models in <inline-formula id="pcbi.1005038.e016"><alternatives><graphic id="pcbi.1005038.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mi>i</mml:mi></mml:msup></mml:math></alternatives></inline-formula>. Since the domain <italic>D</italic><sup><italic>i</italic></sup> can be found in multiple copies within <italic>s</italic> by different models <inline-formula id="pcbi.1005038.e017"><alternatives><graphic id="pcbi.1005038.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>C</italic><sub><italic>j</italic></sub> is one of the CCMs or SCM<sup><italic>i</italic></sup> in <inline-formula id="pcbi.1005038.e018"><alternatives><graphic id="pcbi.1005038.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mi>i</mml:mi></mml:msup></mml:math></alternatives></inline-formula>, we want to identify all best matches in <italic>s</italic> that do not pairwise overlap. For each one of these best matches we create a distinguished hit, described by the location on the sequence and by 5 features of the associated model <italic>C</italic><sub><italic>j</italic></sub>. To achieve goal (i), we extract three features from the <italic>C</italic><sub><italic>j</italic></sub> output: the E-value (provided either by HMMer for SCMs, or by PSI-BLAST for CCMs), the hit length (that is, the length of the domain found in <italic>s</italic> by the model <italic>C</italic><sub><italic>j</italic></sub>), and a binary feature that indicates if the E-value of <italic>C</italic><sub><italic>j</italic></sub> is smaller than a threshold <italic>T</italic>′. For goal (ii), we define two features concerning the percentage of models in <inline-formula id="pcbi.1005038.e019"><alternatives><graphic id="pcbi.1005038.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mi>i</mml:mi></mml:msup></mml:math></alternatives></inline-formula> that <italic>support</italic> the prediction of <italic>C</italic><sub><italic>j</italic></sub>. For this, we say that a model <italic>C</italic><sub><italic>l</italic></sub> supports the prediction of a model <italic>C</italic><sub><italic>j</italic></sub> if their matches on <italic>s</italic> overlap each other and the overlapping size is greater than 50% of the <italic>C</italic><sub><italic>j</italic></sub> match size. Thus, the fourth meta-feature is defined as the percentage of models that support <italic>C</italic><sub><italic>j</italic></sub> having E-values smaller than a threshold <italic>T</italic>′′. The fifth feature represents the percentage of models <italic>C</italic><sub><italic>l</italic></sub> that support <italic>C</italic><sub><italic>j</italic></sub> and that are built from species that belong to the clade of <italic>s</italic>. Our motivation is based on the assumption that species of the same clade tend to share more domains than species of different clades. Note that, we do not penalize predictions that are obtained from models built from species of distant clades, but we just wish to use this evolutionary information to reinforce the presence of a domain when it is observed in species close to <italic>s</italic>. We discuss <italic>T</italic>′ and <italic>T</italic>′′ thresholds in section “CLADE pipeline, parameter settings and tools used in CLADE” (<xref ref-type="sec" rid="sec018">Methods</xref>).</p>
<p>For each domain <italic>D</italic><sup><italic>i</italic></sup>, we trained a meta-classifier (SVM) from the five meta-features described above, to distinguish between real domain occurrences and false predictions. More precisely, we built a one-vs-rest SVM<sup><italic>i</italic></sup> [<xref ref-type="bibr" rid="pcbi.1005038.ref059">59</xref>], that is a binary classifier that discriminates two classes by finding a large-margin separation among them, as illustrated in <xref ref-type="supplementary-material" rid="pcbi.1005038.s007">S2 Fig</xref>. For this, we used all sequences in the set <inline-formula id="pcbi.1005038.e020"><alternatives><graphic id="pcbi.1005038.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>∖</mml:mo> <mml:mover><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> as a positive training set, that is all sequences in <italic>S</italic><sup><italic>i</italic></sup> with the exception of those used to build CCMs. If <inline-formula id="pcbi.1005038.e021"><alternatives><graphic id="pcbi.1005038.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>∖</mml:mo> <mml:mover><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mn>50</mml:mn></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> sequences, then we consider the entire set <italic>S</italic><sup><italic>i</italic></sup>. Moreover, to augment the number of sequences in the positive training set, we apply a rate of mutation of 20% on the initial set of sequences <inline-formula id="pcbi.1005038.e022"><alternatives><graphic id="pcbi.1005038.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>∖</mml:mo> <mml:mover><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> (<italic>S</italic><sup><italic>i</italic></sup> when <inline-formula id="pcbi.1005038.e023"><alternatives><graphic id="pcbi.1005038.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>∖</mml:mo> <mml:mover><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mn>50</mml:mn></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) to arrive to a total of 1 000 sequences per domain. This was done with The Sequence Manipulation Suite software [<xref ref-type="bibr" rid="pcbi.1005038.ref060">60</xref>]. To construct the negative training set, we randomly choose 20 sequences in each set <italic>S</italic><sup><italic>k</italic></sup>, where <italic>k</italic> = 1…14 831 (the number of Pfam domains), and shuffle their 2-mers. We obtain about 300 000 sequences. Notice that when we compare models of <italic>D</italic><sup><italic>i</italic></sup> against these 300 000 sequences, only a few of them give an E-value smaller than 1 (chosen as threshold) and this ensures these sequences to be negative for <italic>D</italic><sup><italic>i</italic></sup>. We repeat the construction 10 times and randomly choose, among all generated sequences, 1 000 sequences that will form the negative set. Positive and negative datasets have the same size, in order to avoid unbalanced sets. (For certain protein families this is obtained by using the supersampling SVM option.)</p>
<p><italic>3. The prediction phase.</italic> Each protein sequence in the set to be annotated is used as a query <italic>s</italic> to be scored against all models in the ensemble <inline-formula id="pcbi.1005038.e024"><alternatives><graphic id="pcbi.1005038.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005038.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msup><mml:mi mathvariant="script">C</mml:mi> <mml:mi>i</mml:mi></mml:msup></mml:math></alternatives></inline-formula>. The hits produced by the models (corresponding to predictions of domain <italic>D</italic><sup><italic>i</italic></sup> in the sequence <italic>s</italic>) are then processed and the five features described above are extracted for each occurrence of domain <italic>D</italic><sup><italic>i</italic></sup> in <italic>s</italic>, as indicated in <xref ref-type="supplementary-material" rid="pcbi.1005038.s007">S2 Fig</xref>. Then, the SVM<sup><italic>i</italic></sup> (trained to recognize the domain <italic>D</italic><sup><italic>i</italic></sup>, as described above) is asked to determine if the domain <italic>D</italic><sup><italic>i</italic></sup> is found in the protein sequence <italic>s</italic>, and to provide a confidence score. However, from a biologist’s perspective, it is more valuable to identify the most likely domains that occur in <italic>s</italic> and that are not overlapping. This is known as a multi-class classification problem. To enable a set of one-vs-rest SVMs (one for each domain) to work with this problem, it is essential to calibrate the output of each classifier into a confidence measure, like the posterior probability. Since standard SVMs do not provide such probabilities, we employed Platt’s method [<xref ref-type="bibr" rid="pcbi.1005038.ref061">61</xref>] to map SVM outputs into posterior probabilities. As a result, SVM’s probabilities are comparable to each other, and we can assign to <italic>s</italic> the domain that achieves the highest predictive value, as done in [<xref ref-type="bibr" rid="pcbi.1005038.ref062">62</xref>]. Strictly speaking, as noticed above, if several non-overlapping matching of the same domain <italic>D</italic><sup><italic>i</italic></sup> are found in <italic>s</italic>, then for each non-overlapping match, we assign to <italic>s</italic> the domain that achieves the highest predictive value.</p>
<p>At the end of this step, several overlapping hits associated to different potential domains are identified for <italic>s</italic>. Based on this set of potential domain hits, we determine the most likely domain architecture for <italic>s</italic>. For this, we first observe that the tendency of a domain to occur preferentially with a small set of other domains in a protein sequence can favor lower confidence domains compared to higher confidence domains, once we want to insert them in a domain architecture. Hence, we applied DAMA, an algorithm that has been designed to determine the most probable domain architecture for <italic>s</italic> by taking into account domain combinations. Its performance has been evaluated in [<xref ref-type="bibr" rid="pcbi.1005038.ref027">27</xref>].</p>
</sec>
<sec id="sec025">
<title>E-values estimation in CLADE</title>
<p>CLADE works with two kinds of probabilistic models, generated by PSI-BLAST and by HMMer. Because of their format we cannot put them together in a single library and handle them in the same manner. A possibility would be to convert PSI-BLAST to HMMer format or vice-versa. However, the transformation could decrease the performance of the models. Then, we score the models individually, that is, each model is used to scan the entire set of query sequences given in input to CLADE and the E-values corresponding to the matches are estimated by the respective tools (PSI-BLAST and HMMer). This strategy assumes models to be independent. It should be noticed that this independence assumption is frequently adopted by machine learning methods and it has been shown to work well in most cases [<xref ref-type="bibr" rid="pcbi.1005038.ref063">63</xref>]. By adopting this strategy we assure CLADE E-values not be over-estimated.</p>
</sec>
<sec id="sec026">
<title>CLADE pipeline, parameter settings and tools used in CLADE</title>
<p>The three steps constituting CLADE are implemented with a number of parameters and implementation choices:</p>
<list list-type="order">
<list-item>
<p>For each Pfam domain, an ensemble model, containing several CCMs and a SCM, is constructed and used for domain identification; an E-value is provided for each identified domain.</p>
</list-item>
<list-item>
<p>Identified domains are filtered, based on several criteria; SVM probabilities are computed for each domain.</p>
</list-item>
<list-item>
<p>Best architectures are selected using DAMA, and domains appearing in an architecture are identified by an E-value and a SVM probability.</p>
</list-item>
</list>
<p>SCMs were downloaded directly from the Pfam web site, while CCMs were built with PSI-BLAST (v.2.2.28 for 5 iterations and E-value cut-off 1<italic>e</italic>-03) on the NR database (download in March 2014). PSI-BLAST was applied to sequences coming from species that were representatives of the whole tree of life. In its second step, CLADE searches for domains occurrences in the query sequences, based on CCMs and SCMs. In order to detect a large number of potential Pfam domains, we set a permissive search E-value (= 1) in PSI-BLAST and HMMer search, using default values for the remaining parameters. We combined the predictions obtained by all profiles by training a SVM from features coming from profile outputs. For SVM, we used the LIBSVM tool [<xref ref-type="bibr" rid="pcbi.1005038.ref064">64</xref>] (v.3.0) with default parameters, and we turned on the option “-b” to provide probability estimates. The software is available at <ext-link ext-link-type="uri" xlink:href="http://www.csie.ntu.edu.tw/~cjlin/libsvm" xlink:type="simple">http://www.csie.ntu.edu.tw/~cjlin/libsvm</ext-link>.</p>
<p>Five features were designed to highlight the best prediction and to provide a measure of the performance of all profiles (see section “Combining Model Predictions” in <xref ref-type="sec" rid="sec018">Methods</xref>). The definition of two of these features depends on the thresholds <italic>T</italic>′ and <italic>T</italic>′′. Namely, the restrictive E-value threshold <italic>T</italic>′ = <italic>min</italic>(1<italic>e</italic> − 30, <italic>Ev</italic><sub><italic>D</italic><sup><italic>i</italic></sup></sub>), where <italic>Ev</italic><sub><italic>D</italic><sup><italic>i</italic></sup></sub> is the greatest E-value observed among proteins containing the domain <italic>D</italic><sup><italic>i</italic></sup> in Pfam sequences, is set to compute the third feature. The fourth feature equals the number of hits (profile outputs) with E-value smaller than <italic>T</italic>′′ = 1. This is a permissive threshold used to count the agreement with best predictions.</p>
<p>For each domain <italic>D</italic><sub><italic>i</italic></sub>, a specific SVM probability cut-off <italic>T</italic><sub><italic>D</italic><sub><italic>i</italic></sub></sub> was defined, as done in Pfam [<xref ref-type="bibr" rid="pcbi.1005038.ref002">2</xref>]. Namely, we considered all sequences in the positive training set for the domain <italic>D</italic><sub><italic>i</italic></sub> defined at the end of subsection “The meta-classifier training phase” (see section “Combining Model Predictions” in <xref ref-type="sec" rid="sec018">Methods</xref>) and computed SVM probabilities for each sequence in both the positive training set and the negative training set. If the intervals of the positive and the negative distributions do not overlap, then we set <italic>T</italic><sub><italic>D</italic><sub><italic>i</italic></sub></sub> to be the maximum value of the negative distribution. If these intervals overlap, then we let <italic>μ</italic> and <italic>σ</italic> be the mean and the standard deviation of the positive distribution of SVM probabilities for <italic>D</italic><sub><italic>i</italic></sub>, and we set <italic>T</italic><sub><italic>D</italic><sub><italic>i</italic></sub></sub> = <italic>μ</italic> − 2<italic>σ</italic>.</p>
<p>This set of parameters is used by default in all analysis realized with CLADE. Note that also CLADE<sub><italic>BEv</italic></sub>, the version of CLADE that does not include the SVM filter and that considers a score system based on best E-values only, employs domain specific cut-offs. These cut-offs are not the same cut-offs used in CLADE, but they are computed based on E-values of positive and negative training sets. CLADE<sub><italic>BEv</italic></sub>-no-cut-off is CLADE<sub><italic>BEv</italic></sub> but uses a unique cut-off of 1<italic>e</italic>-3 for all domains.</p>
<p>Finally, the DAMA software [<xref ref-type="bibr" rid="pcbi.1005038.ref027">27</xref>] uses the pre-computed list of domain pairs presenting strong co-occurrence in known domain architectures and the list of domain architectures extracted from UniProtKB. DAMA has been run with default parameters. Notice that domains participating in architectures identified by DAMA have E-values &lt; 1<italic>e</italic> − 3 and their length covers at least 40% of the original domain length. Hence, CLADE and CLADE<sub><italic>BEv</italic></sub> architectures contain domains with these features. We stress that DAMA favors the identification of architectures that are made of co-occurring domains, but enriches them with new domains having an E-value &lt; 1<italic>e</italic>-10. These new domains added to an architecture do not co-occur with the existing ones. Hence, CLADE and CLADE<sub><italic>BEv</italic></sub> architectures are made of domains that might co-occur but not necessarily.</p>
</sec>
</sec>
<sec id="sec027">
<title>Experiment on SCOP datasets</title>
<p>To realize the comparison experiment on the three SCOP datasets, we used a leave-one-out strategy as follows. Given a domain family <italic>F</italic><sub><italic>D</italic></sub> in one of the ASTRAL datasets, we considered the set of <italic>n</italic> sequences, coming from different species and associated to <italic>F</italic><sub><italic>D</italic></sub> in ASTRAL, to create <italic>n</italic> test-sets for <italic>F</italic><sub><italic>D</italic></sub>. Each test-set takes <italic>n</italic> − 1 sequences for training and leaves one sequence out for the test. Then, we tested whether the sequence that was left out could be annotated by a model (or models) constructed without using it, and counted the correct identification of the domain as a true positive (TP), the identification of an erroneous domain as a false positive (FP) and the identification of no domain as a false negative (FN). Note that a domain is “correctly” identified when it belongs to the domain family <italic>F</italic><sub><italic>D</italic></sub>.</p>
<p>This same procedure, was implemented for all systems we wanted to compare: HMMScan, HHblits, CLADE, CLADE<sub><italic>BEv</italic></sub>, CLADE_HHblits, CLADE<sub><italic>BEv</italic></sub>HHblits.</p>
<p>For HMMScan (run with default parameters), each test-set of <italic>n</italic> − 1 training sequences was first aligned with <monospace>Clustal W</monospace> (version 2.1) [<xref ref-type="bibr" rid="pcbi.1005038.ref065">65</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref066">66</xref>]. Then we used <monospace>hmmbuild</monospace> to construct a probabilistic model (a profile) from the alignment. To compare profiles and test sequences we used <monospace>hmmsearch</monospace> that employs a composition bias filter by default for eliminating false positives. All tools can be found in the HMMer package—version 3.</p>
<p>For HHblits (run with default parameters), we also constructed a profile from each test-set of <italic>n</italic> − 1 aligned sequences (it is the same alignment as for the HMMScan experiment) but using <monospace>hhmake</monospace>. In HHblits experiment, test sequences must be represented by profiles and we used <monospace>hhblits</monospace> on HHdb (the HHblits database) to construct them. Profiles were compared with <monospace>hhsearch</monospace> [<xref ref-type="bibr" rid="pcbi.1005038.ref042">42</xref>]. All tools can be found in the HH-suite package—version 2.0.15.</p>
<p>For CLADE, we considered the profile constructed from the test-set of <italic>n</italic> − 1 aligned sequences in the HMMScan experiment, and we constructed additional profiles, one for each sequence in the <italic>n</italic> − 1 set. This was done by using PSI-BLAST and the NR database (see details in <xref ref-type="sec" rid="sec018">Methods</xref>). To combine the outputs of the <italic>n</italic> profiles, we trained a SVM by using as positive set the same <italic>n</italic> − 1 sequences and as negative set other sequences never used in training nor test. The negative sequences were chosen randomly into the same SCOP dataset of the positive ones, and by avoiding sequences sharing the same SCOP fold. The SVM was trained with an equal number of positive and negative sequences. The third step of CLADE, handling architectures with DAMA, was not used.</p>
<p>For CLADE<sub><italic>BEv</italic></sub>, the version of CLADE that does not include the SVM filter and that considers a score system based on best E-values only, the procedure is the same as for CLADE. The domain-specific cut-offs were learned based on E-values of positive and negative training sets.</p>
<p>For CLADE_HHblits, we carried out the same profile construction as for CLADE, but we replaced PSI-BLAST and HMMScan profiles by HHblits models. Like before, we trained a SVM for combining profile outputs. The only difference is that we used profile-profile comparison to generate the meta-features for training the SVM instead of using sequence-profile comparison like in CLADE. The domain specific cut-offs used in CLADE were computed for the HHblits models using the same learning procedure as that employed for CLADE.</p>
<p>For CLADE<sub><italic>BEv</italic></sub>HHblits, the procedure is the same as for CLADE_HHblits, with cut-offs computed for HHblits models that are domain specific but based on E-values (as done for CLADE<sub><italic>BEv</italic></sub>).</p>
</sec>
<sec id="sec028">
<title>Estimated False Discovery Rate for domains identified in protein sequences</title>
<p>Estimating the number of false predictions is an essential step for evaluating the performance of domain identification methods. The basic principle is to estimate the probability that a potential domain has been randomly predicted. We computed the False Discovery Rate (FDR) in two different ways, based on different random models of sequence generation. The key idea is that domain predictions on random sequences arise by chance alone, that predictions on real sequences give us the total number of predictions (true or false), and that their ratio approximate the false discovery rate. For evaluating CLADE (but also HMMScan and DAMA), we run it on real sequences concatenated to its reshuffled ones. The first random model takes a protein and generates 20 different reshuffling of the protein sequence producing new sequences that have the same residue content of the original one and the same length. We call this model “1-mer”. The second random model takes a protein and generates 20 different reshuffling of <italic>k</italic>-mers in the original sequence, for <italic>k</italic> = 4. We call this model “4-mer”. The idea behind this last model is that small <italic>k</italic>-mers within a protein sequence might be more likely to occur than random <italic>k</italic>-mers, since protein sequences might contain repetitive patterns (for instance, blocks of hydrophobic amino-acids or other compositional biases). Given the original set of protein sequences <italic>P</italic> and its associated shuffled sequences <italic>S</italic>, let <italic>P</italic> + <italic>S</italic> be the set of concatenated sequences. Note that the set <italic>P</italic> + <italic>S</italic> is a set containing 20 times more sequences than <italic>P</italic> because from each sequence in <italic>P</italic>, we generated 20 sequences. Then, we computed the number of CLADE domain predictions within the <italic>P</italic>-portion (saying <italic>R</italic>) and the number of predictions within the <italic>S</italic>-portion (saying <italic>A</italic>) of the <italic>P</italic> + <italic>S</italic> sequences, and set the FDR = <italic>A</italic>/<italic>R</italic> for the dataset. This calculation is repeated 20 times, with respect to 20 different reshuffling and the FDR for the 1-mer experiment is considered to be the average of the FDRs of the 20 datasets. The same for the 4-mer experiment. The same strategy was used in [<xref ref-type="bibr" rid="pcbi.1005038.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref027">27</xref>] (see section “FDR curves” in <xref ref-type="sec" rid="sec018">Methods</xref>).</p>
<p>The random reshuffling was realized with the perl function <monospace>List::Util::shuffle()</monospace>.</p>
<sec id="sec029">
<title>FDR curves</title>
<p>The FDR can be controlled by modulating the E-value threshold used to filter potential domains [<xref ref-type="bibr" rid="pcbi.1005038.ref026">26</xref>] and this possibility is used here to compare CLADE, DAMA, HMMScan and HHblits performance. To construct the FDR curves, we followed two strategies. The first strategy [<xref ref-type="bibr" rid="pcbi.1005038.ref027">27</xref>] generates all domain hits of E-value &lt; 1<italic>e</italic>-3 with HMMER 3.0 and uses them as input for HMMScan and DAMA. For HHblits, it generates domain hits with HHsearch (by matching models, constructed with <monospace>hhmake</monospace> from Pfam seed alignments, to profiles of query sequences, constructed with <monospace>hhblits</monospace> on HHdb) and considers only those with E-value &lt; 1<italic>e</italic>-3. For CLADE, it generates domain hits with CCMs and SCMs, and, again, considers only those with E-value &lt; 1<italic>e</italic>-3. Each tool reconstructs all architectures at once from the set of their corresponding domain hits. For HHMScan and HHblits, architectures are constructed with Pfam strategy for which, in case of overlapping hits, the hit with better score is chosen. For each tool, points in the corresponding FDR curve are obtained by varying the E-value threshold <italic>M</italic> and filtering out from the architectures all domain hits with E-values &gt; <italic>M</italic>. We varied E-values from 1<italic>e</italic>-60 to 1<italic>e</italic>-3 by small steps. From the resulting set of architectures (made of domain hits of E-value &lt; <italic>M</italic> only), we compute the FDR and the number of domains per protein, and repeat the procedure until the whole curve is drawn.</p>
<p>The interest of this first strategy to generate FDR curves is twofold. When predictions of protein domain architectures are realized over large sets of proteins, we might be interested to have only one run that accepts domains with a high E-value and then decide how to select architectures out of this run, depending on the characteristics of the output we find. Also, we might be interested to explore the landscape of architecture predictions before deciding what E-values to use as a threshold. In doing this, one would like to know whether the tool remains robust while competing with a larger number of domain hits/false positives. This strategy evaluates this aspect of the tools performance.</p>
<p>The second strategy has been presented in [<xref ref-type="bibr" rid="pcbi.1005038.ref026">26</xref>]. Namely, for each tool, we consider several input sets of domain hits with a E-value threshold &lt; <italic>M</italic>, for different thresholds <italic>M</italic>. They are produced by HMMER 3.0 for HMMScan and DAMA, by HHsearch (as explained for the first FDR strategy) for HHblits, and by HMMER and PSI-BLAST for CLADE. Then, we run each tool on each corresponding set and compute FDR and number of domains per protein for the resulting sets of architectures. This calculation allows constructing curves where the number of domains per proteins is a function of the FDR values. Best performing methods present higher curves. The FDR curves of all methods were computed by using the same set of shuffled sequences. Note that HMMScan and HHblits architectures are obtained by resolving overlaps with a preference for hits of lowest E-value. The curves obtained with this strategy are reported in <xref ref-type="supplementary-material" rid="pcbi.1005038.s008">S3 Fig</xref>.</p>
</sec>
</sec>
<sec id="sec030">
<title>Evaluation of CLADE, CLADE<sub>BEv</sub>, HMMScan and HHblits performance</title>
<p>The performances of CLADE, CLADE<sub><bold>BEv</bold></sub> (a version without the SVM filter, introduced in the second step of CLADE, and considering a score system based on best E-values only), HMMScan [<xref ref-type="bibr" rid="pcbi.1005038.ref033">33</xref>] and HHblits [<xref ref-type="bibr" rid="pcbi.1005038.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005038.ref042">42</xref>] have been evaluated by using two standard measures: positive predictive value <italic>PPV</italic> = <italic>TP</italic>/(<italic>TP</italic> + <italic>FP</italic>) (also called precision) and sensitivity <italic>Sen</italic> = <italic>TP</italic>/(<italic>TP</italic> + <italic>FN</italic>) (also known as recall), where <italic>TP</italic>, <italic>FP</italic> and <italic>FN</italic> are true positives, false positives and false negatives, respectively. To give the overall performance for each method, we computed the <italic>F</italic>-score (also called <italic>F</italic>-measure) combining <italic>PPV</italic> and <italic>Sen</italic>, and defined as <italic>F</italic>-score = 2 * <italic>PPV</italic> * <italic>Sen</italic>/(<italic>PPV</italic> + <italic>Sen</italic>). The <italic>F</italic>-score can be interpreted as the harmonic mean of <italic>PPV</italic> and <italic>Sen</italic>, reaching its best value at 1 and worst score at 0. <italic>TP</italic>, <italic>FP</italic> and <italic>FN</italic> are defined as follows: let <italic>s</italic> be a protein sequence, <italic>A</italic> be its domain architecture and <italic>T</italic> be the evaluated method; a true positive is a domain in <italic>A</italic> that is correctly predicted by <italic>T</italic>, a false positive is a domain detected by <italic>T</italic> that overlaps a different domain in <italic>A</italic>, and a false negative is a domain in <italic>A</italic> that is not detected by <italic>T</italic>. The method <italic>T</italic> can detect other domains along <italic>s</italic> that do not overlap domains in <italic>A</italic>, and we shall refer to them as “additional” domains.</p>
</sec>
<sec id="sec031">
<title>Time complexity of the system and construction of the CLADE models library</title>
<p>CLADE is a pipeline that involves several different tools, and its formal time complexity is hard to establish. The model construction step takes relatively long time due to the time of generation of more than 2 millions (2 389 235) models defining the CLADE library. Namely, each domain construction takes about 30 minutes, and the overall model construction step can be realised in about 3, 7 months on 250 CPUs. Once the models are constructed, domain identification is fast (that is, less than an hour on 100 CPUs for about 5000 proteins).</p>
</sec>
<sec id="sec032">
<title>Data and software availability</title>
<p>CLADE software and the entire library of CCMs used for the applications presented in this article are available at the address: <ext-link ext-link-type="uri" xlink:href="http://www.lcqb.upmc.fr/CLADE" xlink:type="simple">http://www.lcqb.upmc.fr/CLADE</ext-link>. The CCMs that we generated can be used for annotating any genome and they avoid running the first step of CLADE again. For <italic>P. falciparum</italic>, CLADE website provides access to a downloadable xls file containing the full list of annotations for the 5542 <italic>P. falciparum</italic> proteins (AllDomains.xls). The file also contains the annotations obtained with HHblits and HMMScan, and for each hit, it reports its position, the PlasmoDb accession number, the Pfam domain name, the Pfam clan (if any), and the E-value. The list of disagreeing hits between CLADE and HHblits/HMMScan is also given. A HHblits/HMMScan hit disagrees with CLADE for two reasons: 1. either the hit does not overlap CLADE hits, 2. or the hit overlaps (with an overlapping of any size) a CLADE hit of a different domain and a different clan.</p>
</sec>
</sec>
<sec id="sec033">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005038.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Reference clades used for building CCMs in CLADE.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005038.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>FDR for domain predictions: Comparison between CLADE and HMMScan tested on the two H0 hypotheses.</title>
<p>FDR computed for randomly generated domains under two H0 hypothesis tests (see the dataset description in section “Estimated False Discovery Rate for domains identified in protein sequences” in <xref ref-type="sec" rid="sec018">Methods</xref>). Mean and variance over 20 randomly generated sets of amino-acids sequences of false domain predictions realized by CLADE and HMMScan. FDR values have been computed by considering that either a domain (All) or the original domain (Original), or a new domain (New) identified on these randomly generated sequences is a false positive. Each set of random sequences is constructed from the 14 831 Pfam<sub>27</sub> domain families by reshuffling either amino-acids (1-mers) or quadruplets of amino-acids (4-mers).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005038.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s003" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Multi-domain proteins on <italic>P. falciparum</italic> sequences.</title>
<p>For different E-value ranges we report the number of proteins predicted by CLADE as having at least two domains (MDP), possibly two occurrences of the same domain. Also, we report the number of multi-domain proteins that were predicted through local models coming from different clades (MDP DC). Notice that for these proteins, at least one prediction was obtained with a clade different of Alveolata. Multi-domain proteins are counted according to the E-value of their higher confidence domain.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005038.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s004" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Improvements and agreement of CLADE over HMMScan domain predictions on <italic>P. falciparum</italic> sequences.</title>
<p>Based on the lists of domain predictions provided by CLADE (based on SVM) and CLADE<sub><bold>BEv</bold></sub>(based on best E-value), we report the percentage improvement, agreement on domain predictions and agreement on domain architectures of these systems over HMMscan on the full set of <italic>P. falciparum</italic> protein sequences. The improvement has been computed as <italic>X</italic> − <italic>Y</italic>/<italic>Y</italic>, where <italic>X</italic> is the total number of domains predicted by CLADE or CLADE<sub><bold>BEv</bold></sub> and <italic>Y</italic> is the total number of domains predicted by HMMscan with a GA cut-off. Percentage of agreement on domain predictions is the proportion of HMMscan domain predictions shared with CLADE/CLADE<sub><bold>BEv</bold></sub>. Percentage of agreement on domain architectures is the proportion of HMMscan domain architectures shared with CLADE/CLADE<sub><bold>BEv</bold></sub>. When CLADE and HMMScan annotate a sequence with two domains belonging to the same Pfam clan, we say that the two systems agree.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005038.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s005" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>CLADE and HHblits predictions on <italic>P. falciparum</italic> sequences at various FDRs.</title>
<p>CLADE is run with an optimal FDR threshold set at 0.1% (top). The values reported on the two CLADE columns (top), correspond to the values in <xref ref-type="table" rid="pcbi.1005038.t002">Table 2</xref> for an E-value equal to 1<italic>e</italic>-3. HHblits has been evaluated at different FDR thresholds (middle) and its predictions are compared to CLADE predictions (bottom). In the bottom table we report the total number (Total) of HHblits predictions at FDR 0.1%, 1%, 5%, 10% and how many predictions have been found by HHblits that were obtained by CLADE with an FDR of 0.1% (Shared). Note that, a domain is “shared” by CLADE and HHblits if the two associated domain hits overlap and they belong to the same clan. No condition on the size of the overlapping region is imposed.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005038.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s006" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Pfam and CLADE flowchart for domain identification.</title>
<p>Pfam methodology is showed in solid lines, while modifications proposed by CLADE are shown in dotted lines. For clarity, we duplicated the dataset of Pfam domains to highlight the different use, for model constructions, of the two Pfam sets of sequences SEED (left) and FULL (right). In fact, given a domain <italic>D</italic><sup><italic>i</italic></sup>, the two methodologies make a different use of domain sequences. Based on the SEED set of sequences <italic>S</italic><sup><italic>i</italic>*</sup> of <italic>D</italic><sup><italic>i</italic></sup>, Pfam produces a multiple sequence alignment, MSA<sup><italic>i</italic>*</sup>, and builds a profile hidden Markov model, SCM<sup><italic>i</italic>*</sup>. Based on this model, Pfam searches for new homologous sequences and constructs a set of new representative members of <italic>D</italic><sup><italic>i</italic></sup>, called FULL. FULL contains SEED. On the other hand, CLADE builds models selecting sequences in the FULL set <italic>S</italic><sup><italic>i</italic></sup> according to a reference set of species. These selected sequences are used as queries for building local models (CCM<sup><italic>i</italic></sup>) by using PSI-BLAST and the nr database. As a result, CLADE produces a large model library containing both SCMs and CCMs, and uses it to scan genomes to be annotated, like the <italic>P. falciparum</italic> genome (PlasmoDB).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005038.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s007" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>A meta-classifier to combine model predictions.</title>
<p>Flow-chart describing the final decision making process on the outputs produced by the models of a domain <italic>D</italic><sup><italic>i</italic></sup>. A meta-classifier (SVM) is trained with five meta-features that are obtained by pre-processing the outputs of the probabilistic models (SCMs and CCMs).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005038.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s008" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>CLADE predicts more domains over a range of FDRs.</title>
<p>The y-axis is the number of predicted domains per protein (“signal”), while the x-axis is the FDR (“noise”), so better performing methods have higher curves (more signal for a given noise threshold). CLADE (red) outperforms HMMScan (black), HHblits (green) and DAMA (pink) on the two datasets, 1-mer (top) and 4-mer (bottom), obtained by randomly reshuffling <italic>P. falciparum</italic> sequences (see text). CLADE has been tested under several restrictions and the resulting FDR curves have been added to the plot: CLADE<sub><italic>ALV</italic></sub> (grey), CLADE<sub><italic>BEv</italic></sub> (blue) and CLADE<sub><italic>BEv</italic></sub>-no-cut-off (orange). The inset plot zooms the curves on small FDR values (&lt; 0.001). Compare with the plots in <xref ref-type="fig" rid="pcbi.1005038.g006">Fig 6C</xref>: here, the same data are plot with the strategy introduced in [<xref ref-type="bibr" rid="pcbi.1005038.ref026">26</xref>] and described in Methods.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005038.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005038.s009" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>CLADE on Pfam<sub>27</sub>: Distribution of new domains detected by CLADE.</title>
<p>On Pfam<sub>27</sub>, CLADE identifies 2116 new predictions compared to HMMscan. These are domains that either do not overlap with HMMScan hits or they overlap with some hit that is neither the same domain nor the same clan. CLADE predicts 32.21% of the new domains by using CCMs defined from Alveolata species, and 67.79% by using CCMs defined from other clades. Notice that 291 predictions come from CCMs defined from Viruses, Bacteria and Archaea species.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Omar Harb for his continuous assistance and skilled PlasmoDB support (CV), Gregory Nuel for his suggestions on statistical testing, and Elodie Laine for reading the manuscript and suggesting improvements.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005038.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ponting</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dickens</surname> <given-names>N</given-names></name>. <article-title>Genome cartography through domain annotation</article-title>. <source>Genome Biology</source>. <year>2001</year>;<volume>2</volume>:<fpage>comment2006</fpage>–<lpage>comment2006.6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2001-2-7-comment2006" xlink:type="simple">10.1186/gb-2001-2-7-comment2006</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Finn</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mistry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Coggill</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Heger</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pollington</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Research</source>. <year>2010</year>;<volume>38</volume>:<fpage>D211</fpage>–<lpage>D222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkp985" xlink:type="simple">10.1093/nar/gkp985</ext-link></comment> <object-id pub-id-type="pmid">19920124</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Darnell</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Doolittle</surname> <given-names>W</given-names></name>. <article-title>Speculations on the early course of evolution</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1986</year>;<volume>83</volume>:<fpage>1271</fpage>–<lpage>1275</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.83.5.1271" xlink:type="simple">10.1073/pnas.83.5.1271</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>R</given-names></name>. <article-title>Database of homology-derived protein structures and the structural meaning of sequence alignment</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>1991</year>;<volume>9</volume>:<fpage>56</fpage>–<lpage>68</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.340090107" xlink:type="simple">10.1002/prot.340090107</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bashford</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Chothia</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lesk</surname> <given-names>A</given-names></name>. <article-title>Determinants of a protein fold: unique features of the globin amino acid sequences</article-title>. <source>Journal of Molecular Biology</source>. <year>1987</year>;<volume>196</volume>:<fpage>199</fpage>–<lpage>216</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0022-2836(87)90521-3" xlink:type="simple">10.1016/0022-2836(87)90521-3</ext-link></comment> <object-id pub-id-type="pmid">3656444</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lesk</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Levitt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chothia</surname> <given-names>C</given-names></name>. <article-title>Alignment of the amino acid sequences of distantly related proteins using variable gap penalties</article-title>. <source>Protein Engineering</source>. <year>1986</year>;<volume>1</volume>:<fpage>77</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/protein/1.1.77" xlink:type="simple">10.1093/protein/1.1.77</ext-link></comment> <object-id pub-id-type="pmid">3507691</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Callebaut</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Prat</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Meurice</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mornon</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tomavo</surname> <given-names>S</given-names></name>. <article-title>Prediction of the general transcription factors associated with RNA polymerase II in Plasmodium falciparum: conserved features and differences relative to other eukaryotes</article-title>. <source>BMC Genomics</source>. <year>2005</year>;<volume>6</volume>:<fpage>100</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-6-100" xlink:type="simple">10.1186/1471-2164-6-100</ext-link></comment> <object-id pub-id-type="pmid">16042788</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baussand</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Deremble</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Carbone</surname> <given-names>A</given-names></name>. <article-title>Periodic distributions of hydrophobic amino acids allows the definition of fundamental building blocks to align distantly related proteins</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2007</year>;<volume>67</volume>:<fpage>695</fpage>–<lpage>708</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.21319" xlink:type="simple">10.1002/prot.21319</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>. <article-title>Hidden markov models for sequence analysis: extension and analysis of the basic method</article-title>. <source>CABIOS</source>. <year>1996</year>;<volume>12</volume>:<fpage>95</fpage>–<lpage>107</lpage>. <object-id pub-id-type="pmid">8744772</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Loewenstein</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Raimondo</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Redfern</surname> <given-names>OC</given-names></name>, <name name-style="western"><surname>Watson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Frishman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Linial</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Protein function annotation by homology-based inference</article-title>. <source>Genome Biology</source>. <year>2009</year>;<volume>10</volume>:<fpage>207</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2009-10-2-207" xlink:type="simple">10.1186/gb-2009-10-2-207</ext-link></comment> <object-id pub-id-type="pmid">19226439</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gough</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karplus</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chothia</surname> <given-names>C</given-names></name>. <article-title>Assignment of homology to genome sequences using a library of hidden Markov models that represent all proteins of known structure</article-title>. <source>Journal of Molecular Biology</source>. <year>2001</year>;<volume>313</volume>:<fpage>903</fpage>–<lpage>919</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2001.5080" xlink:type="simple">10.1006/jmbi.2001.5080</ext-link></comment> <object-id pub-id-type="pmid">11697912</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yona</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Levitt</surname> <given-names>M</given-names></name>. <article-title>Within the twilight zone: a sensitive profile-profile comparison tool based on information theory</article-title>. <source>Journal of Molecular Biology</source>. <year>2002</year>;<volume>315</volume>:<fpage>1257</fpage>–<lpage>1275</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2001.5293" xlink:type="simple">10.1006/jmbi.2001.5293</ext-link></comment> <object-id pub-id-type="pmid">11827492</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brandt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Heringa</surname> <given-names>J</given-names></name>. <article-title>webPRC: the Profile Comparer for alignment-based searching of public domain databases</article-title>. <source>Nucleic Acids Research</source>. <year>2009</year>;<volume>37</volume>(<issue>2</issue>):<fpage>W48</fpage>–<lpage>W52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkp279" xlink:type="simple">10.1093/nar/gkp279</ext-link></comment> <object-id pub-id-type="pmid">19420063</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sadreyev</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Grishin</surname> <given-names>N</given-names></name>. <article-title>Profile-profile comparisons by COMPASS predict intricate homologies between protein families</article-title>. <source>Protein Science</source>. <year>2003</year>;<volume>12</volume>:<fpage>2262</fpage>–<lpage>2272</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1110/ps.03197403" xlink:type="simple">10.1110/ps.03197403</ext-link></comment> <object-id pub-id-type="pmid">14500884</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wistrand</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sonnhammer</surname> <given-names>E</given-names></name>. <article-title>Improving Profile HMM Discrimination by Adapting Transition Probabilities</article-title>. <source>Journal of Molecular Biology</source>. <year>2004</year>;<volume>338</volume>(<issue>4</issue>):<fpage>847</fpage>–<lpage>854</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2004.03.023" xlink:type="simple">10.1016/j.jmb.2004.03.023</ext-link></comment> <object-id pub-id-type="pmid">15099750</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bernardes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Carbone</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zaverucha</surname> <given-names>G</given-names></name>. <article-title>A discriminative method for family-based protein remote homology detection that combines inductive logic programming and propositional models</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>83</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-83" xlink:type="simple">10.1186/1471-2105-12-83</ext-link></comment> <object-id pub-id-type="pmid">21429187</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Remmert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Biegert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hauser</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Soding</surname> <given-names>J</given-names></name>. <article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nature Methods</source>. <year>2011</year>;<volume>9</volume>:<fpage>173</fpage>–<lpage>175</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1818" xlink:type="simple">10.1038/nmeth.1818</ext-link></comment> <object-id pub-id-type="pmid">22198341</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gough</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karplus</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chothia</surname> <given-names>C</given-names></name>. <article-title>Assignment of homology to genome sequences using a library of hidden Markov models that represent all proteins of known structure</article-title>. <source>Journal of Molecular Biology</source>. <year>2001</year>;<volume>313</volume>(<issue>4</issue>):<fpage>903</fpage>–<lpage>919</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2001.5080" xlink:type="simple">10.1006/jmbi.2001.5080</ext-link></comment> <object-id pub-id-type="pmid">11697912</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Muruganujan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>P</given-names></name>. <article-title>PANTHER in 2013: modeling the evolution of gene function, and other gene attributes, in the context of phylogenetic trees</article-title>. <source>Nucleic Acids Research</source>. <year>2013</year>;<volume>41</volume>(<issue>D1</issue>):<fpage>D377</fpage>–<lpage>D386</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks1118" xlink:type="simple">10.1093/nar/gks1118</ext-link></comment> <object-id pub-id-type="pmid">23193289</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lees</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yeats</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Perkins</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sillitoe</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Rentzsch</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dessailly</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Gene3D: a domain-based resource for comparative genomics, functional annotation and protein network analysis</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D465</fpage>–<lpage>D471</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1181" xlink:type="simple">10.1093/nar/gkr1181</ext-link></comment> <object-id pub-id-type="pmid">22139938</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fox NK CJ Brenner</surname> <given-names>SE</given-names></name>. <article-title>SCOPe: Structural Classification of Proteins-extended, integrating SCOP and ASTRAL data and classification of new structures</article-title>. <source>Nucleic Acids Research</source>. <year>2014</year>;<volume>42</volume>:<fpage>D304</fpage>–<lpage>309</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt1240" xlink:type="simple">10.1093/nar/gkt1240</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lees</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Studer</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Dawson</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Sillitoe</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Gene3D: multi-domain annotations for protein sequence and comparative genome analysis</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>:<fpage>D240</fpage>–<lpage>D245</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt1205" xlink:type="simple">10.1093/nar/gkt1205</ext-link></comment> <object-id pub-id-type="pmid">24270792</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yeats</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Redfern</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Orengo</surname> <given-names>C</given-names></name>. <article-title>A fast and automated solution for accurately resolving protein domain architectures</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>:<fpage>745</fpage>–<lpage>751</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq034" xlink:type="simple">10.1093/bioinformatics/btq034</ext-link></comment> <object-id pub-id-type="pmid">20118117</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Terrapon</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gascuel</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Marechal</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bréhélin</surname> <given-names>L</given-names></name>. <article-title>Detection of new protein domains using co-occurrence: application to Plasmodium falciparum</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>3077</fpage>–<lpage>3083</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp560" xlink:type="simple">10.1093/bioinformatics/btp560</ext-link></comment> <object-id pub-id-type="pmid">19786484</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bischoff</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Vaquero</surname> <given-names>C</given-names></name>. <article-title>In silico and biological survey of transcription-associated proteins implicated in the transcriptional machinery during the erythrocytic development of Plasmodium falciparum</article-title>. <source>BMC Genomics</source>. <year>2010</year>;<volume>11</volume>:<fpage>34</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-11-34" xlink:type="simple">10.1186/1471-2164-11-34</ext-link></comment> <object-id pub-id-type="pmid">20078850</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ochoa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Llinás</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>M</given-names></name>. <article-title>Using context to improve protein domain identification</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>:<fpage>90</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-90" xlink:type="simple">10.1186/1471-2105-12-90</ext-link></comment> <object-id pub-id-type="pmid">21453511</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bernardes</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Vieira</surname> <given-names>FRJ</given-names></name>, <name name-style="western"><surname>Zaverucha</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Carbone</surname> <given-names>A</given-names></name>. <article-title>A multi-objective optimisation approach accurately resolves protein domain architectures</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>3</issue>):<fpage>345</fpage>–<lpage>353</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv582" xlink:type="simple">10.1093/bioinformatics/btv582</ext-link></comment> <object-id pub-id-type="pmid">26458889</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Boser</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Guyon</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Vapnik</surname> <given-names>V</given-names></name>. <chapter-title>A training algorithm for optimal margin classifiers</chapter-title>. In: <source>Proceedings of the fifth annual ACM workshop on Computational learning theory</source>. <publisher-name>ACM Press</publisher-name>; <year>1992</year>. p. <fpage>144</fpage>–<lpage>152</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005038.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rost</surname> <given-names>B</given-names></name>. <article-title>Twilight zone of protein sequence alignments</article-title>. <source>Protein Eng</source>. <year>1999</year>;<volume>2</volume>:<fpage>85</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/protein/12.2.85" xlink:type="simple">10.1093/protein/12.2.85</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aurrecoechea</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Brestelli</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Brunk</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dommer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fischer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gajria</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>PlasmoDB: a functional genomic database for malaria parasites</article-title>. <source>Nucleic Acids Research</source>. <year>2009</year>;<volume>37</volume>:<fpage>D539</fpage>–<lpage>D543</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn814" xlink:type="simple">10.1093/nar/gkn814</ext-link></comment> <object-id pub-id-type="pmid">18957442</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Date</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stoeckert</surname> <given-names>C</given-names></name>. <article-title>Computational modeling of the Plasmodium falciparum interactome reveals protein function on a genome-wide scale</article-title>. <source>Genome Research</source>. <year>2006</year>;<volume>16</volume>:<fpage>542</fpage>–<lpage>549</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.4573206" xlink:type="simple">10.1101/gr.4573206</ext-link></comment> <object-id pub-id-type="pmid">16520460</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lu</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ding</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Valenzuela</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ribeiro</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>cDNA sequences reveal considerable gene prediction inaccuracy in the Plasmodium falciparum genome</article-title>. <source>BMC Genomics</source>. <year>2007</year>;<volume>8</volume>:<fpage>255</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-8-255" xlink:type="simple">10.1186/1471-2164-8-255</ext-link></comment> <object-id pub-id-type="pmid">17662120</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>. <article-title>Accelerated profile HMM searches</article-title>. <source>PLoS Comp Biol</source>. <year>2011</year>;<volume>7</volume>:<fpage>e1002195</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002195" xlink:type="simple">10.1371/journal.pcbi.1002195</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vogel</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Berzuini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bashton</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gough</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Teichmann</surname> <given-names>S</given-names></name>. <article-title>Supra-domains: evolutionary units larger than single protein domains</article-title>. <source>Journal of Molecular Biology</source>. <year>2004</year>;<volume>336</volume>:<fpage>809</fpage>–<lpage>823</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2003.12.026" xlink:type="simple">10.1016/j.jmb.2003.12.026</ext-link></comment> <object-id pub-id-type="pmid">15095989</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Domrachev</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lipman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bryant</surname> <given-names>S</given-names></name>. <article-title>CDART: Protein Homology by Domain Architecture</article-title>. <source>Genome Research</source>. <year>2002</year>;<volume>12</volume>:<fpage>1619</fpage>–<lpage>1623</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.278202" xlink:type="simple">10.1101/gr.278202</ext-link></comment> <object-id pub-id-type="pmid">12368255</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Coin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bateman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Enhanced protein domain discovery by using language modeling techniques from speech recognition</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2003</year>;<volume>100</volume>:<fpage>4516</fpage>–<lpage>4520</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0737502100" xlink:type="simple">10.1073/pnas.0737502100</ext-link></comment> <object-id pub-id-type="pmid">12668763</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moore</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Björklund</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Ekman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bornberg-Bauer</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Elofsson</surname> <given-names>A</given-names></name>. <article-title>Arrangements in the modular evolution of proteins</article-title>. <source>Trends Biochem Sci</source>. <year>2008</year>;<volume>33</volume>:<fpage>444</fpage>–<lpage>451</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tibs.2008.05.008" xlink:type="simple">10.1016/j.tibs.2008.05.008</ext-link></comment> <object-id pub-id-type="pmid">18656364</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marcotte</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Pellegrini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ng</surname> <given-names>HL</given-names></name>, <name name-style="western"><surname>Rice</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yeates</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Eisenberg</surname> <given-names>D</given-names></name>. <article-title>Detecting Protein Function and Protein-Protein Interactions from Genome Sequences</article-title>. <source>Science</source>. <year>1999</year>;<volume>285</volume>:<fpage>751</fpage>–<lpage>753</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.285.5428.751" xlink:type="simple">10.1126/science.285.5428.751</ext-link></comment> <object-id pub-id-type="pmid">10427000</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Apic</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gough</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Teichmann</surname> <given-names>S</given-names></name>. <article-title>Domain Combinations in Archaeal, Eubacterial and Eukaryotic Proteomes</article-title>. <source>J Mol Biol</source>. <year>2001</year>;<volume>310</volume>:<fpage>311</fpage>–<lpage>325</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2001.4776" xlink:type="simple">10.1006/jmbi.2001.4776</ext-link></comment> <object-id pub-id-type="pmid">11428892</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wuchty</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Almaas</surname> <given-names>E</given-names></name>. <article-title>Evolutionary cores of domain co-occurrence networks</article-title>. <source>BMC Evol Biol</source>. <year>2005</year>;<volume>5</volume>:<fpage>24</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2148-5-24" xlink:type="simple">10.1186/1471-2148-5-24</ext-link></comment> <object-id pub-id-type="pmid">15788102</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Murzin</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Hubbard</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Chothia</surname> <given-names>C</given-names></name>. <article-title>SCOP: A structural classification of proteins database for the investigation of sequences and structures</article-title>. <source>Journal of Molecular Biology</source>. <year>1995</year>;<volume>247</volume>(<issue>4</issue>):<fpage>536</fpage>–<lpage>540</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0022-2836(05)80134-2" xlink:type="simple">10.1016/S0022-2836(05)80134-2</ext-link></comment> <object-id pub-id-type="pmid">7723011</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Soeding</surname> <given-names>J</given-names></name>. <article-title>Protein homology detection by HMM-HMM comparison</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>:<fpage>951</fpage>–<lpage>960</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti125" xlink:type="simple">10.1093/bioinformatics/bti125</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gouy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Guindon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gascuel</surname> <given-names>O</given-names></name>. <article-title>SeaView Version 4: A Multiplatform Graphical User Interface for Sequence Alignment and Phylogenetic Tree Building</article-title>. <source>Molecular Biology and Evolution</source>. <year>2010</year>;<volume>27</volume>:<fpage>221</fpage>–<lpage>224</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msp259" xlink:type="simple">10.1093/molbev/msp259</ext-link></comment> <object-id pub-id-type="pmid">19854763</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keeling</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Burger</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Durnford</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pearlman</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>The tree of eukaryotes</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2005</year>;<volume>20</volume>:<fpage>670</fpage>–<lpage>676</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tree.2005.09.005" xlink:type="simple">10.1016/j.tree.2005.09.005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rehmsmeier</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vingron</surname> <given-names>M</given-names></name>. <article-title>Phylogenetic information improves homology detection</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2001</year>;<volume>45</volume>:<fpage>360</fpage>–<lpage>371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.1156" xlink:type="simple">10.1002/prot.1156</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Finn</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Mistry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schuster-Bockler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Griffiths-Jones</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hollich</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Lassmann</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Pfam: clans, web tools and services</article-title>. <source>Nucleic Acids Research</source>. <year>2005</year>;<volume>34</volume>:<fpage>D247</fpage>–<lpage>D251</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkj149" xlink:type="simple">10.1093/nar/gkj149</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mirkin</surname> <given-names>BG</given-names></name>, <name name-style="western"><surname>Fenner</surname> <given-names>TI</given-names></name>, <name name-style="western"><surname>Galperin</surname> <given-names>MY</given-names></name>, <name name-style="western"><surname>Koonin</surname> <given-names>EV</given-names></name>. <article-title>Algorithms for computing parsimonious evolutionary scenarios for genome evolution, the last universal common ancestor and dominance of horizontal gene transfer in the evolution of prokaryotes</article-title>. <source>BMC evolutionary biology</source>. <year>2003</year>;<volume>3</volume>:<fpage>2</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2148-3-2" xlink:type="simple">10.1186/1471-2148-3-2</ext-link></comment> <object-id pub-id-type="pmid">12515582</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bourne</surname> <given-names>PE</given-names></name>. <article-title>The evolutionary history of protein domains viewed by species phylogeny</article-title>. <source>PloS one</source>. <year>2009</year>;<volume>4</volume>:<fpage>e8378</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0008378" xlink:type="simple">10.1371/journal.pone.0008378</ext-link></comment> <object-id pub-id-type="pmid">20041107</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bjorklund</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ekman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Light</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Frey-Skott</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Elofsson</surname> <given-names>A</given-names></name>. <article-title>Domain rearrangements in protein evolution</article-title>. <source>J Mol Biol</source>. <year>2005</year>;<volume>353</volume>:<fpage>911</fpage>–<lpage>923</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2005.08.067" xlink:type="simple">10.1016/j.jmb.2005.08.067</ext-link></comment> <object-id pub-id-type="pmid">16198373</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pasek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Risler</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Brezellec</surname> <given-names>P</given-names></name>. <article-title>Gene fusion/fission is a major contributor to evolution of multi-domain bacterial proteins</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>:<fpage>1418</fpage>–<lpage>1423</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl135" xlink:type="simple">10.1093/bioinformatics/btl135</ext-link></comment> <object-id pub-id-type="pmid">16601004</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pellegrini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Marcotte</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Eisenberg</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yeates</surname> <given-names>TO</given-names></name>. <article-title>Assigning protein functions by comparative genome analysis: protein phylogenetic profiles</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>1999</year>;<volume>96</volume>(<issue>8</issue>):<fpage>4285</fpage>–<lpage>4288</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.96.8.4285" xlink:type="simple">10.1073/pnas.96.8.4285</ext-link></comment> <object-id pub-id-type="pmid">10200254</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Altschul</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Madden</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Schaffer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Gapped Blast and Psi-Blast: A New Generation of Protein Database Search Programs</article-title>. <source>Nucleic Acids Research</source>. <year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>3402</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/25.17.3389" xlink:type="simple">10.1093/nar/25.17.3389</ext-link></comment> <object-id pub-id-type="pmid">9254694</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frank</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Inglis</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Witten</surname> <given-names>I</given-names></name>. <article-title>Using Model Trees for Classification</article-title>. <source>Machine Learning</source>. <year>1998</year>;<volume>32</volume>:<fpage>63</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1007421302149" xlink:type="simple">10.1023/A:1007421302149</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McLaughlin</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hou</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>W</given-names></name>. <article-title>On the detection of functionally coherent groups of protein domains with an extension to protein annotation</article-title>. <source>BMC Bioinformatics</source>. <year>2007</year>;<volume>8</volume>:<fpage>390</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-8-390" xlink:type="simple">10.1186/1471-2105-8-390</ext-link></comment> <object-id pub-id-type="pmid">17937820</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scott</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hallett</surname> <given-names>M</given-names></name>. <article-title>Predicting subcellular localization via protein motif co-occurrence</article-title>. <source>Genome Research</source>. <year>2004</year>;<volume>14</volume>:<fpage>1957</fpage>–<lpage>1966</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.2650004" xlink:type="simple">10.1101/gr.2650004</ext-link></comment> <object-id pub-id-type="pmid">15466294</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rolf</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bairoch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Barker</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Boeckmann</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ferro</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>UniProt: the Universal Protein knowledgebase</article-title>. <source>Nucleic Acids Research</source>. <year>2004</year>;<volume>32</volume>:<fpage>D115</fpage>–<lpage>D119</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkh131" xlink:type="simple">10.1093/nar/gkh131</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref057">
<label>57</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Brazdil</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Giraud-Carrier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Soares</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vilalta</surname> <given-names>R</given-names></name>. <chapter-title>Metalearning: Applications to Data Mining</chapter-title>. <source>Cognitive technologies</source>. <publisher-name>Springer</publisher-name>; <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005038.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wolpert</surname> <given-names>D</given-names></name>. <article-title>Stacked generalization</article-title>. <source>Neural Networks</source>. <year>1992</year>;<volume>5</volume>:<fpage>241</fpage>–<lpage>259</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0893-6080(05)80023-1" xlink:type="simple">10.1016/S0893-6080(05)80023-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Platt</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cristianini</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Shawe-Taylor</surname> <given-names>J</given-names></name>. <article-title>Large margin dags for multiclass classification</article-title>. In: <source>Advances in Neural Information Processing Systems</source> <volume>12</volume>; <year>2000</year>. p. <fpage>547</fpage>–<lpage>553</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005038.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stothard</surname> <given-names>P</given-names></name>. <article-title>The Sequence Manipulation Suite: JavaScript programs for analyzing and formatting protein and DNA sequences</article-title>. <source>Biotechniques</source>. <year>2000</year>;<volume>28</volume>:<fpage>1102</fpage>–<lpage>1104</lpage>. <object-id pub-id-type="pmid">10868275</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref061">
<label>61</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Platt</surname> <given-names>J</given-names></name>. <chapter-title>Probabilistic Outputs for Support Vector Machines and Comparisons to Regularized Likelihood Methods</chapter-title>. In: <source>Advances in Large Margin Classifiers</source>. <publisher-name>MIT Press</publisher-name>; <year>1999</year>. p. <fpage>61</fpage>–<lpage>74</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005038.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Anand</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pugalenthi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Suganthan</surname> <given-names>P</given-names></name>. <article-title>Predicting protein structural class by SVM with class-wise optimized features and decision probabilities</article-title>. <source>Journal of Theoretical Biology</source>. <year>2008</year>;<volume>253</volume>:<fpage>375</fpage>–<lpage>380</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2008.02.031" xlink:type="simple">10.1016/j.jtbi.2008.02.031</ext-link></comment> <object-id pub-id-type="pmid">18423492</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Domingos</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pazzani</surname> <given-names>M</given-names></name>. <article-title>On the optimality of the simple Bayesian classifier under zero-one loss</article-title>. <source>Machine learning</source>. <year>1997</year>;<volume>29</volume>(<issue>2–3</issue>):<fpage>103</fpage>–<lpage>130</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1007413511361" xlink:type="simple">10.1023/A:1007413511361</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>C</given-names></name>. <article-title>LIBSVM: A library for support vector machines</article-title>. <source>ACM Trans Intell Syst Technol</source>. <year>2011</year> <month>May</month>;<volume>2</volume>:<fpage>1</fpage>–<lpage>27</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/1961189.1961199" xlink:type="simple">10.1145/1961189.1961199</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thompson</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Higgins</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>TJ</given-names></name>. <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>. <source>Nucleic Acids Res</source>. <year>1994</year>;<volume>22</volume>:<fpage>4673</fpage>–<lpage>4680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/22.22.4673" xlink:type="simple">10.1093/nar/22.22.4673</ext-link></comment> <object-id pub-id-type="pmid">7984417</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005038.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Larkin</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Blackshields</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>NP</given-names></name>, <name name-style="western"><surname>Chenna</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>McGettigan</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>McWilliam</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Clustal W and Clustal X version 2.0</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>:<fpage>2947</fpage>–<lpage>2948</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm404" xlink:type="simple">10.1093/bioinformatics/btm404</ext-link></comment> <object-id pub-id-type="pmid">17846036</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>