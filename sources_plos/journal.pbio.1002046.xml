<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosbiol</journal-id>
<journal-title-group>
<journal-title>PLOS Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1544-9173</issn>
<issn pub-type="epub">1545-7885</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PBIOLOGY-D-14-02182</article-id>
<article-id pub-id-type="doi">10.1371/journal.pbio.1002046</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A Sensory-Motor Control Model of Animal Flight Explains Why Bats Fly Differently in Light Versus Dark</article-title>
<alt-title alt-title-type="running-head">Bat Flight in Dark and Light Conditions</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Bar</surname>
<given-names>Nadav S.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Skogestad</surname>
<given-names>Sigurd</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Marçal</surname>
<given-names>Jose M.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ulanovsky</surname>
<given-names>Nachum</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Yovel</surname>
<given-names>Yossi</given-names>
</name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Chemical Engineering, Norwegian University of Science and Technology (NTNU), Trondheim, Norway</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Institute for Telecommunications, University of Lisbon, Lisbon, Portugal</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Neurobiology, Weizmann Institute of Science, Rehovot, Israel</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Zoology, Faculty of Life Sciences, and Sagol School of Neuroscience, Tel Aviv University, Tel Aviv, Israel</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Hedenström</surname>
<given-names>Anders</given-names>
</name>
<role>Academic Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Lund University, SWEDEN</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con" id="contrib001"><p>Conceived and designed the experiments: NU YY. Performed the experiments: NU YY. Analyzed the data: NSB SS NU YY JMM. Contributed reagents/materials/analysis tools: NSB. Wrote the paper: NSB YY NU. Mathematical model developed: NSB. Design and programming of simulator: NSB. Mathematical analysis: NSB.</p></fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">nadi.bar@ntnu.no</email> (NSB); <email xlink:type="simple">yossiyovel@hotmail.com</email> (YY)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>1</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>28</day>
<month>1</month>
<year>2015</year>
</pub-date>
<volume>13</volume>
<issue>1</issue>
<elocation-id>e1002046</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>6</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>12</month>
<year>2014</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Bar et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pbio.1002046" xlink:type="simple"/>
<abstract>
<p>Animal flight requires fine motor control. However, it is unknown how flying animals rapidly transform noisy sensory information into adequate motor commands. Here we developed a sensorimotor control model that explains vertebrate flight guidance with high fidelity. This simple model accurately reconstructed complex trajectories of bats flying in the dark. The model implies that in order to apply appropriate motor commands, bats have to estimate not only the angle-to-target, as was previously assumed, but also the angular velocity (“proportional-derivative” controller). Next, we conducted experiments in which bats flew in light conditions. When using vision, bats altered their movements, reducing the flight curvature. This change was explained by the model via reduction in sensory noise under vision versus pure echolocation. These results imply a surprising link between sensory noise and movement dynamics. We propose that this sensory-motor link is fundamental to motion control in rapidly moving animals under different sensory conditions, on land, sea, or air.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Bats are extremely skillful aviators: they are able to capture prey and land on targets under challenging flight conditions, as well as maneuver accurately using either echolocation or vision. It remains a mystery, however, how bats—or other flying animals—rapidly translate the noisy incoming sensory information into correct motor commands in order to converge onto a target. To address this question, we developed a sensorimotor control model that explains animal flight guidance and tested it in bats with experiments conducted under dark and light conditions. The model reproduced the bats’ flight trajectory with very high accuracy, suggesting that bats have to estimate not only the angle to target but also changes in the angle over time (angular velocity). Additionally, we demonstrate that the bat must suppress its sensory noise by integrating sensory information over several sonar pulses in order to successfully guide its flight. Comparisons of flight trajectories in light and dark suggest that the surprisingly curved flights exhibited by bats in the dark are due to sensory noise, not motor limitations. We hypothesize that rapidly moving animals must adaptively change their motor control strategy to optimally match the sensory conditions.</p>
</abstract>
<abstract abstract-type="toc">
<p>A model of animal flight guidance suggests that bats use estimates of angular velocity and time-integrated sensory information to find their targets, and explains why bats fly straighter in the light than in the dark.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the Human Frontier Science Program (HFSP grant no. RGP0040/2013 to YY and HFSP grant no. RGP0062/2009 to NU). Norwegian University of Science and Technology (NTNU) funded the development of the model to NSB. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="0"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. The code for the dynamic model is available to download from Nadav S. Bar’s laboratory at <ext-link ext-link-type="uri" xlink:href="http://www.nt.ntnu.no/users/barc/" xlink:type="simple">http://www.nt.ntnu.no/users/barc/</ext-link> and requires Matlab. The raw data for all the experiments in light conditions are available to download from Yossi Yovel’s laboratory at <ext-link ext-link-type="uri" xlink:href="http://www.yossiyovel.com/" xlink:type="simple">http://www.yossiyovel.com/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec sec-type="intro" id="sec001">
<title>Introduction</title>
<p>An important open question in neuroscience is how animals transform incoming sensory information into motor commands to control movement [<xref ref-type="bibr" rid="pbio.1002046.ref001">1</xref>–<xref ref-type="bibr" rid="pbio.1002046.ref006">6</xref>]. This problem is particularly difficult in flying animals, in which sensory input is rapid and motor control must be accurate. Bats are the only mammals capable of true flight [<xref ref-type="bibr" rid="pbio.1002046.ref007">7</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref008">8</xref>]. Many tasks performed by bats require fine maneuvering toward targets (e.g., catching mobile prey or landing on small stationary objects). To converge to its target, the bat must reduce to zero the azimuth-to-target angle, <italic>θ</italic> (<xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1A</xref>). Reducing <italic>θ</italic> requires careful, well-coordinated control of the forces the bat applies to maneuver. Thus, a major challenge the bat faces is to translate the noisy estimates of <italic>θ</italic> into motor commands.</p>
<p>A few previous studies tested how bats control their approach [<xref ref-type="bibr" rid="pbio.1002046.ref009">9</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref010">10</xref>]. These studies focused either on the flight pattern [<xref ref-type="bibr" rid="pbio.1002046.ref010">10</xref>–<xref ref-type="bibr" rid="pbio.1002046.ref013">13</xref>] or on the echolocation dynamics [<xref ref-type="bibr" rid="pbio.1002046.ref009">9</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref010">10</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref014">14</xref>], but they did not examine the sensorimotor loop [<xref ref-type="bibr" rid="pbio.1002046.ref015">15</xref>]—that is, how bats rely on sensory input to control flight motor commands. Here, we aimed to examine: (1) If it is enough for the bat to measure the azimuth-to-target (<italic>θ</italic>), or does it need additional information in order to apply the correct motor commands to converge onto the target? Specifically, it is well known from control theory that noisy measurements can pose a great challenge in fine guidance tasks, necessitating additional measurements, such as derivatives of <italic>θ</italic>. (2) Does the bat change its control strategy under different sensory conditions which differ in their noise level, such as in dark versus light, and moreover, do environments with reduced sensory noise affect the motor commands and accordingly the flight? To answer these questions, we developed a control-theory based sensorimotor model that receives noisy sensory input and computes the needed forces based on basic physical principles. This model allowed us to test different control strategies to evaluate the bat’s sensorimotor strategy and to examine its control strategy under different sensory conditions (light versus dark). To test our model, we used behavioral data from Egyptian fruit bats (Rousettus aegyptiacus)—flying mammals that possess an advanced biosonar (echolocation) system [<xref ref-type="bibr" rid="pbio.1002046.ref016">16</xref>–<xref ref-type="bibr" rid="pbio.1002046.ref021">21</xref>], as well as an excellent visual system [<xref ref-type="bibr" rid="pbio.1002046.ref022">22</xref>].</p>
<fig id="pbio.1002046.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.1002046.g001</object-id>
<label>Figure 1</label>
<caption>
<title>Control theory sensorimotor models for bat flight behavior.</title>
<p>(a) Schematic top-view depiction of a bat trajectory (black dashed line), together with the line of sight (LOS) to the target, the velocity <italic>ν</italic>(<italic>t</italic>), and the angle <italic>θ</italic>(<italic>t</italic>) between <italic>ν</italic>(<italic>t</italic>) and the LOS. (b–d) 2-D projections of actual bat flight trajectories (black dashed curves) together with the simulated trajectories from the proportional controller (red) and the proportional-derivative (PD) controller (blue). Examples b–d are ordered according to the curvature of the trajectory. For small initial angles <italic>θ</italic><sub>0</sub> (illustrated by example b, <italic>θ</italic><sub>0</sub> = 18°), convergence is achieved by both controllers, but is more accurate with the PD controller (blue). Higher initial angles (c, <italic>θ</italic><sub>0</sub> = 77°) require a controller that considers the angular velocity in addition to the angle <italic>θ</italic>, and such PD controllers achieved very good performance (blue curves in example c). Example d shows a trial with a small initial angle (<italic>θ</italic><sub>0</sub> = 9°) that did not converge, probably because the target was too close and the bat did not manage to slow down on time. Dots (blue or red) represent sensory acquisition time samples (10 Hz echolocation, i.e., a dot every 100 ms). Gray sphere depicts the 10-cm diameter landing target, drawn to scale. (e) Histogram of the initial angle <italic>θ</italic><sub>0</sub> of the converging (open bars) and diverging trials (full bars), based on a proportional controller. The proportional controller was able to achieve convergence mostly for small angles (below 45°—vertical black dashed line). (f) Histogram of the error ratio (error in proportional controller / error in PD controller). Grey bar, number of simulations that completely diverged when using the Proportional controller. Blue or red bars, number of trials in which the PD controller was more accurate than the proportional controller (ratio &gt;1, blue), or vice versa (ratio &lt;1, red). PD control is clearly superior to proportional control. (g) 2-D histograms of the parameter space (<italic>k<sub>d</sub></italic> and <italic>k<sub>p</sub></italic> ) that best fit the real trajectories, plotted individually for each of the 6 bats; based on all the 222 trials in the dark condition. Colors represent the number of trials for which a certain <italic>k<sub>p</sub>, k<sub>d</sub></italic>, combination was found to best reconstruct the real trajectory (see <xref ref-type="sec" rid="sec004">Materials and Methods</xref>). Color scale, from zero (blue) to maximum count (red). Red represents the following values in bats #1–6, respectively: 13, 19, 10, 12, 14, 7. A clear optimum is visible for each bat. Circles represent the optimum values (see <xref ref-type="sec" rid="sec004">Materials and Methods</xref>), which are fixed for the simulations of each bat. All the data is available in the <xref ref-type="supplementary-material" rid="pbio.1002046.s001">S1 Data</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.g001"/>
</fig>
<p>We found that a simple model, which considers only the angle-to-target and its derivative (a “proportional-derivative controller”), was able to reconstruct complex, several-meter-long flight trajectories very accurately—with an average error of only 14.6 cm. We show that, to successfully land in the dark, the bat has to integrate (to average) sensory data from its biosonar system over several hundred milliseconds, in order to overcome sensory noise. We also demonstrate that when flying in light and using vision, bats reduced their flight curvature. This change in movement pattern was fully explained by the model as resulting from the reduced sensory noise when using vision. Taken together, these results imply an important link between sensory noise and movement dynamics in a rapidly moving mammal.</p>
</sec>
<sec sec-type="results" id="sec002">
<title>Results</title>
<p>Bats were trained to land on a 10 cm diameter sphere placed at a random position in a 6 × 7 m large room. We started off with experiments in complete darkness, in which the bats had to rely exclusively on biosonar to estimate the angle-to-target <italic>θ</italic> using acoustic cues extracted from the reflected echoes [<xref ref-type="bibr" rid="pbio.1002046.ref014">14</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref017">17</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref022">22</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref023">23</xref>]. In complete darkness, Egyptian fruit bats emit biosonar pulse-pairs at a rate of 7–10 Hz [<xref ref-type="bibr" rid="pbio.1002046.ref017">17</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref020">20</xref>], and hence in the model we assumed a 10 Hz sensory acquisition rate. Interestingly, bats often did not fly to the target in a direct line, but rather exhibited a curved trajectory, sometimes even circling around the target (<xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1B-D</xref>, black dashed curves; a total of 222 trials were analyzed). We aimed to elucidate this behavior. Our model received as input only the initial conditions of the real bat: initial flight angle <italic>θ</italic><sub>0</sub>, initial velocity <italic>ν</italic><sub>0</sub>, the initial position of the bat and the target, as well as a fixed controller parameter determined from a training set that contained 80% of all the trials for each bat (see details in the text below and in the Materials and Methods). The model then simulated the full flight trajectory according to a sensorimotor control model and Newton’s laws of motion, until landing on the target (or missing it). The simulated bat began its flight at the real bat’s origin and with the same direction and speed as the real bat. From this instant onwards, at every sensory update (see below) the simulated bat re-estimated the direction and distance of the target (relative to the bat’s new position) and updated its next motor commands accordingly. In our model, the distance to the target was only used to slow down the bat as it approached landing and not to guide it. We assumed that distance is estimated via bio-sonar. The main objective of the sensorimotor control model was to translate the sensory azimuth measurements (direction to target) into motor commands. We tested several paradigms to perform this translation, comparing them to the bats’ behavior (see below).</p>
<sec id="sec002a">
<title>A Proportional Controller Fails to Explain Bat Flight Behavior</title>
<p>We simulated several control strategies with increasing complexity; in all models, turning forces <italic>F</italic><sub>⊥</sub> were applied perpendicularly to the movement trajectory in order to turn (maneuver) the bat based on the sensory input.</p>
<p>We first tested the simplest possible control strategy, the so-called “proportional control” [<xref ref-type="bibr" rid="pbio.1002046.ref024">24</xref>–<xref ref-type="bibr" rid="pbio.1002046.ref026">26</xref>], in which the turning forces <italic>F</italic><sub>⊥</sub> at every moment are proportional to the measured angle <italic>θ</italic>:
<disp-formula id="pbio.1002046.e001">
<alternatives>
<graphic id="pbio.1002046.e001g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e001"/>
<mml:math display="block" id="M01" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mo>⊥</mml:mo>
</mml:msub>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mo>⋅</mml:mo>
<mml:mi>θ</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>k<sub>p</sub></italic> is a constant, referred to as the “proportional gain” (Materials and Methods). Such a simple proportional controller performed poorly: First, it converged onto the target in only 61% of the complete-darkness trials (136/222). Second, it converged successfully only in trials with “easy” initial conditions, i.e., small initial angle <italic>θ</italic><sub>0</sub>; 88% of the successful trials (120/136) had <italic>θ</italic><sub>0</sub> &lt; 45° (see, for example, red curve in <xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1B</xref>). The convergence in these trials is not surprising because the bat started flying already heading towards the target, and thus small corrections were sufficient to reach the target. Third, in the difficult cases with <italic>θ</italic><sub>0</sub> &gt; 45°, the model failed in 73% of the trials (<italic>θ</italic><sub>0</sub> &gt; 45° occurred in 59/222 trials, and in 43/59 or 73% of these difficult trials, the model failed to converge; <xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1E</xref>, compare empty versus full bars to the right of the dashed line [<italic>θ</italic><sub>0</sub> &gt; 45°]; c.f. <xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1C</xref>). Failures to converge occurred mostly because the forces applied during flight were too large, leading to large angular velocity and oscillations of <italic>θ</italic> that did not converge to zero (see <xref ref-type="supplementary-material" rid="pbio.1002046.s004">S1 Fig.</xref>, middle row). Thus, a simple proportional controller is not adequate to explain bat guidance of flight.</p>
</sec>
<sec id="sec002b">
<title>A Proportional-Derivative Controller Accurately Reconstructs Bat Flight Trajectories</title>
<p>The failure of the proportional controller implies a need for a stabilizing effect, to counteract these strong forces. A simple stabilizer commonly used in control theory is to add a derivative term, which dampens the overshooting effect of the proportional controller; such a control strategy is called a “proportional-derivative (PD) controller” [<xref ref-type="bibr" rid="pbio.1002046.ref024">24</xref>–<xref ref-type="bibr" rid="pbio.1002046.ref027">27</xref>]:
<disp-formula id="pbio.1002046.e002">
<alternatives>
<graphic id="pbio.1002046.e002g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e002"/>
<mml:math display="block" id="M02" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>F</mml:mi>
<mml:mo>⊥</mml:mo>
</mml:msub>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mo>⋅</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>d</mml:mi>
</mml:msub>
<mml:mo>⋅</mml:mo><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
The PD controller proved to be dramatically superior as compared to the simpler proportional controller: the PD controller led to convergence in 100% of the trials (222/222, see examples in <xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1B-D</xref>, blue lines); it converged successfully even in those trials in which the bat maneuvered strongly (<xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1C,D</xref>: compare the red lines [proportional controller] that diverged versus the blue lines [PD controller] that converged accurately; see more examples in <xref ref-type="supplementary-material" rid="pbio.1002046.s005">S2</xref>–<xref ref-type="supplementary-material" rid="pbio.1002046.s010">S7</xref> Figs.). Notably, the PD controller was able to explain even extreme-maneuvering trials in which the bat exhibited a full 360° rotation (<xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1D</xref>). For each trial we found the model parameters (<italic>k<sub>p</sub></italic> and <italic>k<sub>d</sub></italic> ) that minimized the error between the simulated trajectory and real bat trajectory (see <xref ref-type="sec" rid="sec004">Materials and Methods</xref> for error-index definition). We computed the error index for the proportional controller and for the PD controller, for those 136 trials in which the proportional controller converged. The analysis revealed that in 92% of the cases (125/136), the PD controller led to trajectories with a smaller error (<xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1F</xref>, blue bars). The average reconstruction error of the PD controller over the testing data was extremely small—only 14.6 ± 1.1 cm (mean ± S.E.M.; see <xref ref-type="sec" rid="sec004">Materials and Methods</xref> for details on the training and testing procedure; see also <xref ref-type="supplementary-material" rid="pbio.1002046.s016">S1 Table</xref> for data on each individual bat). In contrast, the proportional controller did not converge at all in 39% of the trials (86/222; <xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1F</xref>, gray bar), and in those trials where it did converge, its trajectory error was, on average, 3.6 times worse than in the PD controller. In some cases (12.5%, 17/136), the PD controller outperformed the proportional controller by more than 10-fold.</p>
<p>Importantly, when we plotted the distribution of the parameters (<italic>k<sub>p</sub></italic>, <italic>k<sub>d</sub></italic>) that best fitted each experiment, we found that bats used one consistent control strategy (<xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1G</xref>, note the uni-modal distribution of best parameters for each individual bat, peaking at around <italic>k<sub>d</sub></italic> ≈ 2–6 and <italic>k<sub>p</sub></italic> ≈ 1–5). When examining different individual bats, each bat had slightly different optimal parameters (<xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1G</xref> and <xref ref-type="supplementary-material" rid="pbio.1002046.s017">S2 Table</xref>), but they were all centered within the same limited range in the parameter space. This consistency between and within bats, all of which exhibit high (non-zero) values of optimal <italic>k<sub>d</sub></italic>, argues against the proportional model—and emphasizes the need for differentiating the angle, as implemented in the PD model.</p>
<p>Finally, we tested two alternative two-parameter models, the proportional-integrative (PI) model and the derivative-integrative (DI) model. Both of these models performed worse than the PD model, and one of them performed worse than the Proportional model as well (<xref ref-type="supplementary-material" rid="pbio.1002046.s011">S8 Fig</xref>). We therefore conclude that the superior performance of the PD controller was specifically due to the combination of the proportional and derivative terms (P+D). This combination is particularly effective during rapid maneuvering because the proportional term corrects the error and the derivative term stabilizes the controller.</p>
</sec>
<sec id="sec002c">
<title>Integrating Sensory Information Over Time Stabilizes Motor Performance</title>
<p>All the models we discussed so far were deterministic and assumed that the bat can perfectly measure the angle-to-target. In reality, however, all organisms have sensory errors. To assess the effect of this sensory noise, we tested two models of angle-dependent additive Gaussian noise, which mimic the sensory errors found in the auditory system of several vertebrates (<xref ref-type="supplementary-material" rid="pbio.1002046.s012">S9 Fig.</xref> and Materials and Methods) [<xref ref-type="bibr" rid="pbio.1002046.ref028">28</xref>–<xref ref-type="bibr" rid="pbio.1002046.ref030">30</xref>]. As expected, sensory noise had strong implications for the convergence of the model: in many trials, adding the noise resulted in increased maneuvering errors (<xref ref-type="fig" rid="pbio.1002046.g002">Fig. 2A</xref>, top, red dashed curves), and oftentimes led to complete failure to converge (<xref ref-type="fig" rid="pbio.1002046.g002">Fig. 2B-C</xref>, top). The noise impaired convergence in 85% of the 222 trials (189/222). The percent of diverging simulations increased in trials with highly curved turns, as expressed by their small straightness index and large maximal angle <italic>θ</italic><sub>max</sub> (<xref ref-type="fig" rid="pbio.1002046.g002">Fig. 2D</xref>, see <xref ref-type="sec" rid="sec004">Materials and Methods</xref> for definitions of these indices). Even in the trials that did converge despite the noise, the error index increased substantially, on average by more than 2-fold.</p>
<fig id="pbio.1002046.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.1002046.g002</object-id>
<label>Figure 2</label>
<caption>
<title>The effect of noise on sensorimotor control.</title>
<p>(a–c) The same three example flight trajectories (trials) as in <xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1B–D</xref>. For each trial we performed 150 noise simulations (30 shown: red dashed lines), with additive Gaussian noise. Top row, without noise filtering; Bottom row, with an exponentially decaying weighted noise-suppression strategy. Black dashed curve, original trajectory; blue curve, PD simulated trajectory with no noise (deterministic); red curves, 30 simulated trajectories with noise (terminated after 7 s of simulated flight because bats never flew more than 5 s). (d) Percentage of diverged flights (cases with noise in which the simulated bat failed to converge to the target), plotted as a function of the straightness index (left) and the maximal angle <italic>θ</italic><sub>max</sub> (right). Error bars, mean ± S.E.M., computed over trials. Note that the percentage of diverged flights (failures) increase for more curved flights. (e) An integration (averaging) window of length 3–4 yielded simulations that reconstructed most accurately the real flight trajectories in the dark (arrow). The data is available in the <xref ref-type="supplementary-material" rid="pbio.1002046.s002">S2 Data</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.g002"/>
</fig>
<p>The model failed to converge in the presence of noise because the derivative term of the PD controller differentiates noisy measurements, which further amplifies the noise (see <xref ref-type="sec" rid="sec004">Materials and Methods</xref>). We therefore hypothesized that the bat must use a noise-suppression strategy and integrate (average) over several sensory measurements to overcome the noise. To elucidate the number of measurements of <italic>θ</italic> that should be averaged before executing the motor commands, we tested several different integration functions and evaluated their effect on the percent of successful convergences and on the error index. An exponentially decaying integrator (Materials and Methods), which only takes into account the three to four most recent measurements, was found to outperform uniform and linearly decaying integrators (<xref ref-type="supplementary-material" rid="pbio.1002046.s013">S10 Fig.</xref>). This simple exponential integrator exhibited successful noise suppression and reproduced the bat’s flight trajectories with high fidelity (<xref ref-type="fig" rid="pbio.1002046.g002">Fig. 2E</xref>, arrow; see also <xref ref-type="fig" rid="pbio.1002046.g002">Fig. 2A-C</xref>, bottom—compare to the failed convergences in the top panels when not using noise suppression). Interestingly, there is a biologically-plausible update algorithm to implement such an exponential integrator, by only requiring the bat to remember the last <italic>average</italic> <italic>θ</italic> (see <xref ref-type="sec" rid="sec004">Materials and Methods</xref>). Previous work has shown that in stationary micro-bats (<italic>Eptesicus fuscus</italic>) that perform a detection task, integrating information over five to ten sonar calls substantially improves performance [<xref ref-type="bibr" rid="pbio.1002046.ref031">31</xref>]. Our current findings strengthen the need for integration. The shorter integration window that we found in flying bats (three to four sonar pulses; note the optimum in <xref ref-type="fig" rid="pbio.1002046.g002">Fig. 2E</xref>: arrow) versus stationary bats (five to ten calls [<xref ref-type="bibr" rid="pbio.1002046.ref031">31</xref>]) might reflect the need for faster decision-making during flight maneuvers. It might also result from the difference between the bat species used in the two studies, which rely on echolocation to a different extent (<italic>Rousettus</italic> less than <italic>Eptesicus</italic>).</p>
</sec>
<sec id="sec002d">
<title>Experiments in Light Versus Dark Reveal That Sensory Noise Affects the Motor Strategy</title>
<p>An important prediction of our model is that sensory noise determines motor performance. In particular, the model predicts that using an alternative sensory system with less noise would allow the bat to apply stronger turning forces. In the highly visual Egyptian fruit bat [<xref ref-type="bibr" rid="pbio.1002046.ref022">22</xref>], visual estimation of <italic>θ</italic> is less noisy than echolocation-based estimates. This is due to two factors: First, visual angular acuity in these bats is 0.3° [<xref ref-type="bibr" rid="pbio.1002046.ref022">22</xref>], 10-fold better than their echolocation-based acuity of 2°–3° [<xref ref-type="bibr" rid="pbio.1002046.ref017">17</xref>]; and second, vision has a much higher effective update rate (at least 25 Hz flicker-fusion limit in mammalian vision [<xref ref-type="bibr" rid="pbio.1002046.ref032">32</xref>] versus 7–10 Hz echolocation rate). We therefore hypothesized that, because the effective sensory noise is substantially reduced under vision, bats performing a visually guided flight will be able to use stronger maneuvering forces <italic>F</italic><sub>⊥</sub>, which will be expressed by higher gain parameters (<italic>k<sub>p</sub></italic>, <italic>k<sub>d</sub></italic> ) in our model.</p>
<p>To test this hypothesis, we conducted new experiments in which the same individual bats (five of the six bats) flew under a light level that is considered optimal for bat vision (1 lux) [<xref ref-type="bibr" rid="pbio.1002046.ref033">33</xref>], while performing the same landing task. We examined here all of these 43 light-based trials, and found that the PD controller used for modeling the dark conditions (Figs. <xref ref-type="fig" rid="pbio.1002046.g001">1</xref> and <xref ref-type="fig" rid="pbio.1002046.g002">2</xref>) was inadequate in explaining the light trials (the mean error was 2-fold higher, see <xref ref-type="sec" rid="sec004">Materials and Methods</xref>). Therefore, we implemented a new version of the PD controller, where we increased the sensory update-rate from 10 Hz (sonar) to 25 Hz (vision [<xref ref-type="bibr" rid="pbio.1002046.ref032">32</xref>]) and also decreased the noise level [<xref ref-type="bibr" rid="pbio.1002046.ref022">22</xref>] (see <xref ref-type="sec" rid="sec004">Materials and Methods</xref>). This PD model was able to reproduce the trajectories flown in the light with a high fidelity (<xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3A</xref>, top row, green curves). We found that, as we hypothesized, the simulated bat exhibited significantly larger gain parameters (<italic>k<sub>p</sub></italic>, <italic>k<sub>d</sub></italic> ) in light versus dark (<xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3B</xref>; 8/10 parameters increased in the five bats; Wilcoxon signed rank test, <italic>p</italic> &lt; 0.01). Further, the simulated bat exerted significantly stronger forces when flying in the light (<xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3C</xref>; <italic>t</italic>-test, comparing flights with <italic>θ</italic><sub>0</sub> &gt; 45°: <italic>p</italic> &lt; 10<sup>−11</sup> see also <xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3D</xref>). Moreover, flight trajectories in light conditions were more direct than in darkness, as quantified by their higher straightness index (<xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3E</xref>, <italic>t</italic>-test: <italic>p</italic> &lt; 0.03). Additionally, we found that using an appropriate integration window is even more crucial in light than in dark (the optimum is more pronounced, see <xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3F</xref>, arrow).</p>
<fig id="pbio.1002046.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pbio.1002046.g003</object-id>
<label>Figure 3</label>
<caption>
<title>Effects of different sensory inputs (vision versus echolocation) on flight control.</title>
<p>(a–c) Six example flights: three recorded in the light (top) and three in the dark (bottom, same examples as in Figs. <xref ref-type="fig" rid="pbio.1002046.g001">1</xref>–<xref ref-type="fig" rid="pbio.1002046.g002">2</xref>). Dashed black curves, real trajectories. Blue curves, trajectory of PD controller using <italic>k<sub>d</sub></italic>, <italic>k<sub>p</sub></italic> gains optimized for dark conditions. Green curves, trajectory using <italic>k<sub>d</sub></italic>, <italic>k<sub>p</sub></italic> gains optimized for light conditions. Dots represent sensory acquisition time samples (Blue: 10 Hz, echolocation; Green: 25 Hz, vision). The errors between the real and simulated trajectories (indicated inside the figures) show that high gains are preferable in light conditions. (b) Gain parameters of the PD controller in light and dark for each bat (for the five bats that participated in both dark and light experiments). Note that eight of the ten parameters were above the diagonal—indicating larger gain parameters in light versus dark. (c) The forces exerted by the simulated bat (<italic>F</italic><sub>⊥</sub>) were much stronger in the light than in the dark (see main text). (d) The mean force exerted by the simulated bats increased with the maximum angle <italic>θ</italic><sub>max</sub> in both light and dark, but was always stronger for light (green) than for dark conditions (blue). (e) The straightness index of the real bat trajectories (see <xref ref-type="sec" rid="sec004">Materials and Methods</xref>) was significantly lower in dark than in light, for initial angles &gt; 45° (<italic>p</italic> &lt; 0.03); this indicates that the bat flies straighter in light conditions. (f) An integration window of length 3 yielded simulations that reconstructed most accurately the real flight trajectories in the light (arrow). All the data is available in the <xref ref-type="supplementary-material" rid="pbio.1002046.s003">S3 Data</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.g003"/>
</fig>
<p>We next tested if the light-based gain parameters could explain trajectories flown in the dark, and vice versa. When we applied on flights performed in light the <italic>k<sub>p</sub></italic>, <italic>k<sub>d</sub></italic> parameters derived from dark trials, the simulations produced trajectories that converged onto the target, but were much less direct (<xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3A</xref>, top row, blue curves). Conversely, when we applied on dark trials the <italic>k<sub>p</sub></italic>, <italic>k<sub>d</sub></italic> parameters from the light condition, the simulations produced straighter trajectories (<xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3A</xref>, bottom row, green curves; and Materials and Methods), consistent with the stronger forces applied by the bats in the light. Interestingly, this implies that, in terms of its motor abilities, the bat could have easily flown more directly to the target in the dark—but instead, it flew in a curved manner because of sensory limitations (namely, the higher sensory noise and lower sensory update-rate in the dark).</p>
</sec>
</sec>
<sec sec-type="conclusions" id="sec003">
<title>Discussion</title>
<p>Taken together, our results demonstrate a simple, biologically-plausible, sensorimotor model that explains flight guidance in bats—that is, how they maneuver towards a desired target in the presence of sensory noise. In our model we concentrate on translating noisy sensory input into motor commands. We ignore noise in the motor and proprioception systems [<xref ref-type="bibr" rid="pbio.1002046.ref034">34</xref>], both of which affect the bat’s flight performance in reality. Such noise should be similar in light and in dark and thus will not affect any of our results (aside from making the flight trajectories less smooth).</p>
<p>Our model relies on two key components. The first is (i) integrating (averaging) sensory information over time, in order to acquire a better (less noisy) estimation of the angle-to-target (<italic>θ</italic>). Importantly, we have found that the bat could apply a very simple biologically-plausible implementation of such an estimator (or integrator), which uses minimal memory and only requires memorizing one previous sensory estimation of <italic>θ</italic> (see <xref ref-type="sec" rid="sec004">Materials and Methods</xref>). And the model relies on (ii) the derivative of <italic>θ</italic> in addition to <italic>θ</italic> itself, in order to stabilize the controller. These two components suggest strong limitations on the processing that must be implemented in the bat’s brain, or in the brain of other rapidly moving animals.</p>
<p>We found that two main factors explain why bats fly in curved trajectories towards the target: (i) The initial angle <italic>θ</italic><sub>0</sub>: when the bat starts flying at a non-zero initial angle <italic>θ</italic><sub>0</sub> (e.g., <xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1C</xref>), it flies in a curved manner, while if the bat takes off from the wall with a near-zero <italic>θ</italic><sub>0</sub>, it flies rather straight to the target (<xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1B</xref>). This is especially true in the dark (when sensory noise is higher) and the bat does not apply strong forces to decrease its angle-to-target. (ii) The gain parameters <italic>k<sub>p</sub></italic>, <italic>k<sub>d</sub></italic> of the PD controller: low gain parameters are used when the sensory noise is higher (e.g., in the dark), leading to curved flights; while high gain parameters lead to straighter flights.</p>
<p>Finally, the experiments in the light suggest that, when using vision, bats can exert stronger motor command (stronger forces) and thus fly to the target more directly than when using biosonar. In contrast, in the dark, when there is higher sensory noise and lower sensory update-rate, the bats exert weaker forces—and therefore the angle-to-target converges more slowly. Taken together, these results imply the surprising conclusion that the highly curved flight trajectories often exhibited by bats in the dark are due to sensory limitations—not motor limitations.</p>
</sec>
<sec sec-type="materials|methods" id="sec004">
<title>Materials and Methods</title>
<sec sec-type="materials|methods" id="sec004a">
<title>Experimental Procedures</title>
<p>All experimental procedures were approved by the Institutional Animal Care and Use Committees of the Weizmann Institute of Science and the University of Maryland, where these experiments were performed.</p>
<p>The full behavioral methods for the dark experiments were described elsewhere [<xref ref-type="bibr" rid="pbio.1002046.ref017">17</xref>]. In brief: Six adult Egyptian fruit bats (<italic>Rousettus aegyptiacus</italic>) were trained to detect, localize and approach a polystyrene sphere (10 cm diameter) that was mounted on a vertical pole positioned inside a large anechoic flight-room (6.4 × 6.4 × 2.7 m). The target’s size resembles the size of some fruits that are commonly eaten by these bats in nature, such as mango. To exclude the possibility of using vision, the target was painted black and the room was in complete darkness (illuminance &lt; 10<sup>−4</sup> lux). To prevent use of olfaction, the bats were food-rewarded (with a piece of fruit) only after landing on the target. After every trial, the target was randomly repositioned inside the room, both in the horizontal and in the vertical planes. A total of 253 trials were collected with at least 30 trials per bat. Because our model only addresses azimuth measurements, <italic>θ</italic>, we excluded all flights in which there was a change of more than 15% in the bat’s elevation (height) over the entire flight. This resulted in 222 trials of darkness flights, at least 20 trials per bat, which were analyzed here. To test the effect of a sensory system with lower noise (vision), additional 43 new trials were conducted in light conditions, using 5 of the 6 individual bats that were tested in the dark. We used a relatively dim light (illuminance = 1 lux), which is considered ideal for bat vision [<xref ref-type="bibr" rid="pbio.1002046.ref033">33</xref>], and which is equivalent to light levels under bright full moonlight.</p>
<sec id="sec004aa">
<title>Video recordings</title>
<p>Two synchronized, high-speed, digital video cameras (Photron, set with a frame rate of 125 frames per second), were used to record the flight of the bats. The direct-linear-transform algorithm was used to measure the three-dimensional location of the bat and other objects (e.g., the target) in the room, using the two camera views, as done previously [<xref ref-type="bibr" rid="pbio.1002046.ref017">17</xref>].</p>
</sec>
</sec>
<sec id="sec004b">
<title>The Model</title>
<p>The model consists of two controllers (one angular controller for turning the bat and one thrust controller for forward movement), and a set of differential equations describing the bat’s motion. We used a fixed sensory update rate of 10Hz for echolocation (i.e., 100 ms steps) or 25Hz for vision (i.e. 40 ms steps). At each sensory update step, the model uses the angle-to-target <italic>θ</italic>, either deterministically or with additive noise (see main text). The noise was added to the value of <italic>θ</italic>, which was based on a single estimation or on an average of several estimations depending on the exact model (main text). The model then uses this <italic>θ</italic> as input for the first controller—the angular controller, which calculates the turning force according to one of the control methods described in the main text and below (proportional controller or proportional-derivative [PD] controller). This turning force is then used by the second controller which calculates the forward thrust. The two forces (turning and thrust) are then integrated in the motion equations to calculate the angle-to-target, <italic>θ</italic>, at the next time step. In between two updates, the simulated bat continues to move with the same forces as used in the most recent calculation.</p>
<p>We calculate the line-of-sight (LOS) distance to target <italic>r</italic>, the velocity vector <italic>ν</italic>, the angle <italic>θ</italic> between <italic>w</italic> and the LOS, and the angular velocity <italic>ω</italic> (see <xref ref-type="supplementary-material" rid="pbio.1002046.s014">S11 Fig.</xref>), by solving the following set of differential equations (the motion equations)
<disp-formula id="pbio.1002046.e003">
<alternatives>
<graphic id="pbio.1002046.e003g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e003"/>
<mml:math display="block" id="M03" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>r</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
<mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal">cos</mml:mi><mml:mi>θ</mml:mi>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<disp-formula id="pbio.1002046.e004">
<alternatives>
<graphic id="pbio.1002046.e004g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e004"/>
<mml:math display="block" id="M04" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo>
<mml:mi mathvariant="normal">drag</mml:mi><mml:mo>−</mml:mo>
<mml:mtext>angular damping force</mml:mtext><mml:mo>+</mml:mo>
<mml:mi mathvariant="normal">thrust</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<disp-formula id="pbio.1002046.e005">
<alternatives>
<graphic id="pbio.1002046.e005g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e005"/>
<mml:math display="block" id="M05" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:mi>ω</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
<disp-formula id="pbio.1002046.e006">
<alternatives>
<graphic id="pbio.1002046.e006g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e006"/>
<mml:math display="block" id="M06" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>ω</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>U</mml:mi>
<mml:mi>θ</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where the operator <italic>Ẋ</italic> represents the derivative with respect to time, <italic>d</italic>(<italic>X</italic>)/<italic>dt</italic>. The forces drag, angular damping, thrust, and the turning force <italic>U<sub>θ</sub></italic>, which is calculated by the angular controller, are explained below. Additionally, we defined <italic>θ<sub>max</sub></italic> as the maximum angle <italic>θ</italic> along the flight <italic>t</italic> &gt; 0.</p>
<p>The acceleration <italic>ν̇</italic>(<italic>t</italic>) can be described by the following ordinary differential equation (ODE):
<disp-formula id="pbio.1002046.e007">
<alternatives>
<graphic id="pbio.1002046.e007g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e007"/>
<mml:math display="block" id="M07" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>v</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:mo>−</mml:mo><mml:mi mathvariant="normal">drag</mml:mi><mml:mo>−</mml:mo>
<mml:mtext>angular damping force</mml:mtext><mml:mo>+</mml:mo><mml:mi mathvariant="normal">thrust</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pbio.1002046.e008">
<alternatives>
<graphic id="pbio.1002046.e008g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e008"/>
<mml:math display="block" id="M08" overflow="scroll">
<mml:mrow>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mi>f</mml:mi>
</mml:msub>
<mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>D</mml:mi>
<mml:mi>t</mml:mi>
</mml:msub>
<mml:mo>∥</mml:mo><mml:msub>
<mml:mi>U</mml:mi>
<mml:mi>θ</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>∥</mml:mo><mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>U</mml:mi>
<mml:mi>v</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where drag is proportional to the velocity <italic>ν</italic>(<italic>t</italic>), and <italic>D<sub>f</sub></italic> is the drag coefficient [<xref ref-type="bibr" rid="pbio.1002046.ref011">11</xref>]; and the angular damping force is proportional to the turning force <italic>U<sub>θ</sub></italic>(<italic>t</italic>) (i.e., when the bat turns, it slows down), with a coefficient <italic>D<sub>t</sub></italic>.</p>
<p>The forward thrust of the bat <italic>U<sub>ν</sub></italic>(<italic>t</italic>) is proportional to the wing beat and is described by
<disp-formula id="pbio.1002046.e009">
<alternatives>
<graphic id="pbio.1002046.e009g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e009"/>
<mml:math display="block" id="M09" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>U</mml:mi>
<mml:mi>v</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:mi>F</mml:mi><mml:mi mathvariant="normal">sin</mml:mi><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>β</mml:mi><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where <italic>β</italic> is the flapping frequency of the wings, which we set to 10 Hz according to the behavior of the real bats [<xref ref-type="bibr" rid="pbio.1002046.ref011">11</xref>], and <italic>F</italic> is the forward thrust of each wing flap, according to the data from [<xref ref-type="bibr" rid="pbio.1002046.ref011">11</xref>]. In addition to the azimuth <italic>θ</italic>(<italic>t</italic>), we assume that the bat estimates the distance to the target (for instance, by using bio-sonar). The distance in our model is only used to slow down the approaching velocity when the bat reaches a critical minimum distance to the target. We estimated from our observations this distance to be approximately 0.5 m. Slowing down is modelled by replacing <xref ref-type="disp-formula" rid="pbio.1002046.e009">Equation 6</xref> with the damping term <italic>U<sub>ν</sub></italic>(<italic>t</italic>) = −1.1<italic>ν</italic>(<italic>t</italic>).</p>
<p>In order to compare the simulated bat’s motion to our experimental results, we transformed the bat’s egocentric polar coordinates (<italic>r,θ</italic>) into the Earth Cartesian coordinates <italic>x,y</italic> using the linear transformation <italic>θ<sub>x</sub> = θ + α</italic>, where <italic>θ<sub>x</sub></italic> is the angle between the vector of flight and the <italic>x</italic>-axis (see <xref ref-type="supplementary-material" rid="pbio.1002046.s014">S11 Fig.</xref>).</p>
<p>This allows computing the velocity components along <italic>x</italic> and <italic>y</italic> through the following equations:
<disp-formula id="pbio.1002046.e010">
<alternatives>
<graphic id="pbio.1002046.e010g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e010"/>
<mml:math display="block" id="M10" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>v</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
<mml:mi mathvariant="normal">cos</mml:mi><mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>θ</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
<mml:mspace width="1em"/>
<mml:msub>
<mml:mi>v</mml:mi>
<mml:mi>y</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
<mml:mi mathvariant="normal">sin</mml:mi><mml:mo>(</mml:mo><mml:msub>
<mml:mi>θ</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
<disp-formula id="pbio.1002046.e011">
<alternatives>
<graphic id="pbio.1002046.e011g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e011"/>
<mml:math display="block" id="M11" overflow="scroll">
<mml:mrow>
<mml:mi>α</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
<mml:mo>=</mml:mo><mml:mi mathvariant="normal">atan2</mml:mi><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo>
<mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo>
<mml:mo>,</mml:mo>
<mml:mspace width="1em"/>
<mml:mo>−</mml:mo>
<mml:mi>π</mml:mi><mml:mo>≤</mml:mo><mml:mi>α</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mi>π</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
where the coordinates <italic>x</italic>(<italic>t</italic>) and <italic>x</italic>(<italic>t</italic>) are calculated by integration of <italic>ν<sub>x</sub></italic> and <italic>ν<sub>y</sub></italic> at every instance (every 1 ms), given the initial conditions <italic>x</italic>(0), <italic>y</italic>(0), <italic>ν</italic>(0) and <italic>θ</italic>(0), and the function atan2 (<italic>y,x</italic>) is the Matlab (Mathworks) function for arctan(<italic>y/x</italic> ), defined in [<italic>−π,π</italic>]. In the main text we denoted <italic>θ</italic>(0) by the shortened notation <italic>θ</italic><sub>0</sub>.</p>
<p>Using the linear transformation above, we can then calculate the angular velocity and the angular acceleration as
<disp-formula id="pbio.1002046.e012">
<alternatives>
<graphic id="pbio.1002046.e012g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e012"/>
<mml:math display="block" id="M12" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo>
<mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
<disp-formula id="pbio.1002046.e013">
<alternatives>
<graphic id="pbio.1002046.e013g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e013"/>
<mml:math display="block" id="M13" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>ω</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:msub>
<mml:mover accent="true">
<mml:mi>ω</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo>
<mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
where <italic>α̇</italic>(<italic>t</italic>) and <inline-formula id="pbio.1002046.e014">
<alternatives>
<graphic id="pbio.1002046.e014g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e014" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M14" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</inline-formula> are the first and second time derivatives of <italic>α</italic>(<italic>t</italic>) (<italic>dα</italic>(<italic>t</italic>)/<italic>dt</italic>) and <italic>d</italic><sup>2</sup><italic>α</italic>(<italic>t</italic>)/<italic>dt</italic><sup>2</sup>, respectively). Combining Eq. <xref ref-type="disp-formula" rid="pbio.1002046.e005">3</xref> and <xref ref-type="disp-formula" rid="pbio.1002046.e012">9</xref> leads to the set of differential equations
<disp-formula id="pbio.1002046.e015">
<alternatives>
<graphic id="pbio.1002046.e015g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e015"/>
<mml:math display="block" id="M15" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>ω</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
<disp-formula id="pbio.1002046.e016">
<alternatives>
<graphic id="pbio.1002046.e016g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e016"/>
<mml:math display="block" id="M16" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>ω</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>U</mml:mi>
<mml:mi>θ</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo>
<mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
In order to compute <italic>α̇</italic>(<italic>t</italic>) and <inline-formula id="pbio.1002046.e017">
<alternatives>
<graphic id="pbio.1002046.e017g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e017" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M17" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</inline-formula>, we first define the relative velocity components in Earth coordinates to be
<disp-formula id="pbio.1002046.e018">
<alternatives>
<graphic id="pbio.1002046.e018g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e018"/>
<mml:math display="block" id="M18" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:mi>T</mml:mi><mml:mi>B</mml:mi><mml:mi>x</mml:mi></mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:mi>T</mml:mi><mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:mi>B</mml:mi><mml:mi>x</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pbio.1002046.e019">
<alternatives>
<graphic id="pbio.1002046.e019g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e019"/>
<mml:math display="block" id="M19" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:mi>T</mml:mi><mml:mi>B</mml:mi><mml:mi>y</mml:mi></mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:mi>T</mml:mi><mml:mi>y</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:mi>B</mml:mi><mml:mi>y</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>V<sub>T</sub></italic> is the velocity of the target; in our case <italic>V<sub>T</sub></italic> = 0, since we tested only stationary target. <italic>V<sub>B</sub></italic> = <italic>ν</italic>(<italic>t</italic>) is the velocity of the bat, and <italic>V<sub>TB</sub></italic> is the relative velocity (target-bat). The components of the velocity vectors can be calculated using <italic>V<sub>B<sub>x</sub></sub></italic> = <italic>ν<sub>x</sub></italic>(<italic>t</italic>) and <italic>V<sub>B<sub>y</sub></sub></italic> = <italic>ν<sub>y</sub></italic>(<italic>t</italic>) found in <xref ref-type="disp-formula" rid="pbio.1002046.e010">Eq. 7</xref>. Then the expression for change in the line of sight, <italic>α̇</italic>(<italic>t</italic>), is obtained by [<xref ref-type="bibr" rid="pbio.1002046.ref027">27</xref>]:
<disp-formula id="pbio.1002046.e020">
<alternatives>
<graphic id="pbio.1002046.e020g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e020"/>
<mml:math display="block" id="M20" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>B</mml:mi>
<mml:mi>y</mml:mi>
</mml:msub>
</mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:msub>
<mml:mi>B</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
and <inline-formula id="pbio.1002046.e021">
<alternatives>
<graphic id="pbio.1002046.e021g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e021" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M21" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</inline-formula> is obtained by differentiation of <xref ref-type="disp-formula" rid="pbio.1002046.e020">Eq. 13</xref> using the chain rule.</p>
</sec>
<sec id="sec004c">
<title>The Angular Controller</title>
<p>Control theory offers many solutions for how to calculate the amount of forces needed in order to achieve a desired response with respect to performance and stability. In the case of the bat, the objective is to reduce the angle <italic>θ</italic> between the line of flight and the LOS, by applying turning forces <italic>U<sub>θ</sub></italic>(<italic>t</italic>) (in the main text denoted <italic>F</italic><sub>⊥</sub>), thus controlling the angular acceleration of <italic>θ</italic>. In our case of a stationary target, the control objective is to reduce <italic>θ</italic> to zero. The simplest control strategy that can achieve this is the so-called proportional control, applying forces that are proportional to the error <italic>e</italic>(<italic>t</italic>); in our case of reducing <italic>θ</italic>(<italic>t</italic>) to zero, the error <italic>e</italic>(<italic>t</italic>) is <italic>θ</italic> itself. The forces are computed by
<disp-formula id="pbio.1002046.e022">
<alternatives>
<graphic id="pbio.1002046.e022g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e022"/>
<mml:math display="block" id="M22" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>U</mml:mi>
<mml:mrow>
<mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mi>θ</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
where <italic>p</italic> denotes the proportional controller, and <italic>k<sub>p</sub></italic> is the proportional factor (gain). This angular force <italic>U<sub>θ,p</sub></italic>(<italic>t</italic>) is then used in <xref ref-type="disp-formula" rid="pbio.1002046.e006">Eq. 4</xref> to calculate <inline-formula id="pbio.1002046.e023">
<alternatives>
<graphic id="pbio.1002046.e023g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e023" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M23" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>ω</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</inline-formula>—the change in angular velocity. A typical problem of this proportional controller is that it does not consider the rate of convergence, and therefore tends to overshoot and often oscillates around the desired angle. In certain cases, the proportional controller may even lead to divergence away from the target (instability). To compensate for this and to stabilize the system, it is common to introduce a derivative element, which takes into account the rate in which the angle <italic>θ</italic> changes. In the proportional-derivative (PD) controller, the forces are computed as:
<disp-formula id="pbio.1002046.e024">
<alternatives>
<graphic id="pbio.1002046.e024g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e024"/>
<mml:math display="block" id="M24" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>U</mml:mi>
<mml:mrow>
<mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>d</mml:mi></mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>d</mml:mi>
</mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula>
where <italic>d</italic> denotes the derivative term, <italic>k<sub>d</sub></italic> is the derivative gain, and <italic>k<sub>p</sub></italic> is the proportional gain as before. We assume that the bat estimates the angular velocity, for instance by using a simple first order numerical differentiation, such as first order Euler [<xref ref-type="bibr" rid="pbio.1002046.ref026">26</xref>], obtaining
<disp-formula id="pbio.1002046.e025">
<alternatives>
<graphic id="pbio.1002046.e025g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e025"/>
<mml:math display="block" id="M25" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>θ</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo>
<mml:mn>1</mml:mn><mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi><mml:mi>t</mml:mi>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
where <italic>θ</italic>(<italic>t</italic> – 1) is the previous measurement of <italic>θ</italic>.</p>
<p>Other simple, well-known, two-gain control strategies that we tested were the proportional-integrative (PI) and the derivative-integrative (DI). The PI controller can be written as
<disp-formula id="pbio.1002046.e026">
<alternatives>
<graphic id="pbio.1002046.e026g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e026"/>
<mml:math display="block" id="M26" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>U</mml:mi>
<mml:mrow>
<mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mi>I</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mi>θ</mml:mi><mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:msubsup>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mrow>
<mml:mi>t</mml:mi>
</mml:msubsup>
</mml:mrow>
<mml:mi>θ</mml:mi><mml:mi>d</mml:mi><mml:mi>τ</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
where the <italic>k<sub>i</sub></italic> is the integral gain. The less commonly used, two-gain parameter DI controller can be written as</p>
<disp-formula id="pbio.1002046.e027">
<alternatives>
<graphic id="pbio.1002046.e027g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e027"/>
<mml:math display="block" id="M27" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>U</mml:mi>
<mml:mrow>
<mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mi>I</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>d</mml:mi>
</mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>−</mml:mo><mml:msub>
<mml:mi>k</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mrow>
<mml:msubsup>
<mml:mo>∫</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mrow>
<mml:mi>t</mml:mi>
</mml:msubsup>
</mml:mrow>
<mml:mi>θ</mml:mi><mml:mi>d</mml:mi><mml:mi>τ</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula>
</sec>
<sec id="sec004d">
<title>Model Training and Testing</title>
<p>To estimate the proportional and derivative gains of the controller (<italic>k<sub>p</sub></italic> and <italic>k<sub>d</sub></italic>, respectively) that best fit the bats’ behavior in the dark, we first simulated 31 values in the parameter space of each gain, ranging from 0 to 16. We validated the model by randomly dividing the dark trials of each bat into 80% training trials and 20% testing trials (80% of the 222 trials were randomly selected with equal probability). We first computed the best mean gain parameters for each bat in the dark using the training set and then tested these parameters on trials from the test set (the remaining 20%). This procedure was repeated 100 times. The average error for the training set was 4.6 cm, while for the test set it was 14.6 cm, suggesting that our model could indeed predict accurately the bats’ behavior. All the errors reported in this article are errors on the testing set. The test values for each bat are provided in <xref ref-type="supplementary-material" rid="pbio.1002046.s016">S1 Table</xref>.</p>
<p>To test whether our model, developed for dark conditions, is accurate for light conditions as well, we simulated the trials conducted in light for each bat using the same model, i.e., 10 Hz update rate of echolocation and the same gain parameters that were used in the dark; we then compared the error index. Few of the trials diverged, and of the trials that did converge, the mean error was 2-folds larger than the error we obtained for the dark trials, especially for large angles (maximum error over 60 cm). We therefore went on to test a different model for the light with a higher update rate (25 Hz) and a different noise model with less noise (see below).</p>
<p>Interestingly, when we used the training procedure in order to optimize the control parameters in the light trials (see the <italic>k<sub>p</sub></italic> and <italic>k<sub>d</sub></italic> values in <xref ref-type="supplementary-material" rid="pbio.1002046.s017">S2 Table</xref>), and then tested these on the dark trials, most of the simulations diverged. Of those simulations that did converge, the error increased from 2.6 cm in the light to 21.50 ±0.6 cm in the dark, supporting our hypothesis that the bat uses a different control model in the light than in dark conditions.</p>
</sec>
<sec id="sec004e">
<title>Control Parameter Space</title>
<p>We tested the parameter space <italic>k<sub>d</sub></italic> and <italic>k<sub>p</sub></italic> by simulating the 222 dark trials and 43 light trials, all without noise, over a grid of combinations of <italic>k<sub>d</sub></italic> and <italic>k<sub>p</sub></italic> from 0 to 16. We measured the error index between each simulation and its corresponding real trajectory (see below). The parameter values that minimized the error index are provided in <xref ref-type="supplementary-material" rid="pbio.1002046.s017">S2 Table</xref>.</p>
</sec>
<sec id="sec004f">
<title>Convergence Criteria</title>
<p>A trial simulation was stopped when one of the following convergence criteria was satisfied: (1) When the simulated bat hit the target (i.e., reached a 5 cm distance from the center of the 10 cm diameter target). (2) When the simulation lasted more than 7 s. This criterion was set because the average time-to-landing in the real experiments was 1.5 s, and the longest flight duration observed in the 222 trials was less than 4 s.</p>
</sec>
<sec id="sec004g">
<title>The Error Index</title>
<p>In order to compare the trajectories of the simulated and the real bat, we first created a joint closed shape that is defined by the two curves (i.e., as illustrated in <xref ref-type="supplementary-material" rid="pbio.1002046.s015">S12 Fig.</xref>, the curves that surround the areas <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, and <italic>A</italic><sub>3</sub>). The area inside the closed continuous curve can be calculated by</p>
<disp-formula id="pbio.1002046.e028">
<alternatives>
<graphic id="pbio.1002046.e028g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e028"/>
<mml:math display="block" id="M28" overflow="scroll">
<mml:mrow>
<mml:mo>∥</mml:mo><mml:mi>A</mml:mi><mml:mo>∥</mml:mo><mml:mo>=</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mo>∬</mml:mo>
<mml:mi>D</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mi>d</mml:mi><mml:mi>A</mml:mi><mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mn>2</mml:mn>
</mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mo>∮</mml:mo>
<mml:mi>C</mml:mi>
</mml:msub>
</mml:mrow>
<mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(19)</label>
</disp-formula>
<p>Since our vectors are in discrete form, the above continuous equation can be approximated to discrete-time form by the following
<disp-formula id="pbio.1002046.e029">
<alternatives>
<graphic id="pbio.1002046.e029g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e029"/>
<mml:math display="block" id="M29" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mn>1</mml:mn>
<mml:mn>2</mml:mn>
</mml:mfrac>
<mml:mo>[</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow>
<mml:mrow>
<mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:munderover>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>+</mml:mo><mml:msub>
<mml:mi>x</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub>
<mml:mi>y</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo><mml:msub>
<mml:mi>y</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>)</mml:mo><mml:mo>−</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow>
<mml:mrow>
<mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:munderover>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>y</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>+</mml:mo><mml:msub>
<mml:mi>y</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub>
<mml:mi>x</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>−</mml:mo><mml:msub>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>)</mml:mo><mml:mo>]</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(20)</label>
</disp-formula>
where <italic>m</italic> is the number of discrete points in each curve. If the curves intersect, the intersection points are found using linear interpolation between each of the elements composing the curves (<xref ref-type="supplementary-material" rid="pbio.1002046.s015">S12 Fig.</xref>). In those cases, we sum all the closed areas using
<disp-formula id="pbio.1002046.e030">
<alternatives>
<graphic id="pbio.1002046.e030g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e030"/>
<mml:math display="block" id="M30" overflow="scroll">
<mml:mrow>
<mml:mo>∥</mml:mo><mml:mi>A</mml:mi><mml:mo>∥</mml:mo><mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:munderover>
<mml:msub>
<mml:mi>A</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
<label>(21)</label>
</disp-formula>
where <italic>k</italic> is the number of intersection points (e.g. in <xref ref-type="supplementary-material" rid="pbio.1002046.s015">S12 Fig.</xref>, <italic>k</italic> = 4). The error index is defined by normalizing the total area ∥ <italic>A</italic> ∥ by the length of the experimental trajectory of the corresponding trial. Simulations in which the bat circled the target prior to landing (see convergence criterion above) were penalized by multiplying the error by a factor of 10, since such a behavior was never observed in the real experiments.</p>
</sec>
<sec id="sec004h">
<title>The Noise Model</title>
<p>In the dark, we assumed that the bat measures the angle, based on echolocation with a frequency of 10 Hz, i.e., every 0.1 s. We assumed that the noise is <italic>θ</italic>-dependent [<xref ref-type="bibr" rid="pbio.1002046.ref020">20</xref>–<xref ref-type="bibr" rid="pbio.1002046.ref022">22</xref>], and we tested two different models. The first noise model has no bias (the measured <italic>θ</italic> linearly depends on the real <italic>θ</italic>), and it has a nonlinear noise term that is low at small angles and increases above <italic>π</italic> / 2 (<xref ref-type="supplementary-material" rid="pbio.1002046.s012">S9 Fig.</xref>—left):
<disp-formula id="pbio.1002046.e031">
<alternatives>
<graphic id="pbio.1002046.e031g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e031"/>
<mml:math display="block" id="M31" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub>
<mml:mi>κ</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="normal">sin</mml:mi></mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub>
<mml:mi>κ</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
<label>(22)</label>
</disp-formula>
where <inline-formula id="pbio.1002046.e032">
<alternatives>
<graphic id="pbio.1002046.e032g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e032" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M32" overflow="scroll">
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
</mml:math>
</alternatives>
</inline-formula>
 is the noisy estimation of <italic>θ</italic>, <italic>κ</italic><sub>1</sub> = 0.65, <italic>κ</italic><sub>2</sub> = 0.15 and <italic>n</italic> is Gaussian noise (<inline-formula id="pbio.1002046.e033">
<alternatives>
<graphic id="pbio.1002046.e033g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e033" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M33" overflow="scroll">
<mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</inline-formula>).</p>
<p>The second noise model (<xref ref-type="supplementary-material" rid="pbio.1002046.s012">S9 Fig.</xref> - right) has both a bias in the estimation of <italic>θ</italic>(<italic>t</italic>) and additive Gaussian noise that is <italic>θ</italic>-dependent [<xref ref-type="bibr" rid="pbio.1002046.ref020">20</xref>–<xref ref-type="bibr" rid="pbio.1002046.ref022">22</xref>]:
<disp-formula id="pbio.1002046.e034">
<alternatives>
<graphic id="pbio.1002046.e034g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e034"/>
<mml:math display="block" id="M34" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal">sin</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>0.4</mml:mn><mml:mi>n</mml:mi><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mn>0.15</mml:mn><mml:mi>n</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
<label>(23)</label>
</disp-formula>
with the parameters <italic>a</italic> = 2.22 and <italic>b</italic> = 0.458, and <italic>n</italic> is the Gaussian noise. In the light conditions, the simulated bat estimated the angle-to-target <italic>θ</italic> by using both vision and echolocation (the real bats did not completely stop echolocating at this light level). We assumed that the additional independent visual measurements were acquired at a rate of 25 Hz (see more details in the main text). Additionally, the noise model assumed a measurement of <italic>θ</italic>, which is approximately 7-fold more accurate at each time step, following previous behavioral and anatomical studies (see main text):
<disp-formula id="pbio.1002046.e035">
<alternatives>
<graphic id="pbio.1002046.e035g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e035"/>
<mml:math display="block" id="M35" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal">sin</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>0.07</mml:mn><mml:mi>n</mml:mi><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mn>0.02</mml:mn><mml:mi>n</mml:mi>
</mml:mrow>
</mml:math>
</alternatives>
<label>(24)</label>
</disp-formula></p>
</sec>
<sec id="sec004i">
<title>Sensory Integration</title>
<p>We implemented the exponentially decaying integration function as follows:
<disp-formula id="pbio.1002046.e036">
<alternatives>
<graphic id="pbio.1002046.e036g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e036"/>
<mml:math display="block" id="M36" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo>=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msubsup>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:msubsup>
<mml:mrow>
<mml:msub>
<mml:mi>W</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
<mml:mo>⋅</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:msubsup>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>N</mml:mi>
</mml:msubsup>
<mml:msub>
<mml:mi>W</mml:mi>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:math>
</alternatives>
<label>(25)</label>
</disp-formula>
where <inline-formula id="pbio.1002046.e037">
<alternatives>
<graphic id="pbio.1002046.e037g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e037" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M37" overflow="scroll">
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</inline-formula>
 is the estimated angle <italic>θ</italic> at the current time
 after integration (averaging) over several sensory measurements, and <inline-formula id="pbio.1002046.e038">
<alternatives>
<graphic id="pbio.1002046.e038g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e038" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M38" overflow="scroll">
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mi>i</mml:mi>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
 is the measured angle <italic>θ</italic> at sample time <italic>i</italic>, with noise and without integration. Each of the previous N sensory inputs was integrated with a weight <italic>W<sub>i</sub></italic> calculated according to <italic>W<sub>i</sub> = w</italic><sup><italic>i</italic>–1</sup> / <italic>V</italic> and <italic>V</italic> = (1–<italic>w<sup>N</sup></italic>)/(1–<italic>w</italic>), and <italic>w</italic> is the decay parameter, which was estimated in our case to be <italic>w</italic> = 0.5. The window that was found to best explain the behavior was N = 3–4 (<xref ref-type="fig" rid="pbio.1002046.g002">Fig. 2E</xref>). We also tested a linearly decaying averaging model, and a uniform averaging model, and found the exponentially decaying average to be superior in terms of successful convergence and accuracy (error index); this testing was done by comparing between the experiments trajectories and 120 simulated trajectories with noisy measurements for each trial (<xref ref-type="supplementary-material" rid="pbio.1002046.s013">S10 Fig.</xref>).</p>
<p>The above integration function requires the memory of at least three past measurements, and to perform a relatively complicated mathematical expression at each time step. A much more practical and biologically plausible method to implement the above integration function is to use the discrete form of a low pass filter [<xref ref-type="bibr" rid="pbio.1002046.ref026">26</xref>], which updates the current angle estimation using the previous one according to the weight constant <italic>γ</italic>
<disp-formula id="pbio.1002046.e039">
<alternatives>
<graphic id="pbio.1002046.e039g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e039"/>
<mml:math display="block" id="M39" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow>
<mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>⋅</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
<label>(26)</label>
</disp-formula>
where <italic>k</italic> is the time step and <inline-formula id="pbio.1002046.e040">
<alternatives>
<graphic id="pbio.1002046.e040g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e040" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M40" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mi>k</mml:mi>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula>
 is the current noisy measurement of the angle (Eq. <xref ref-type="disp-formula" rid="pbio.1002046.e031">22</xref>–<xref ref-type="disp-formula" rid="pbio.1002046.e035">24</xref>). Using the above equation, the organism needs only to remember the most recent measurement and the value <inline-formula id="pbio.1002046.e041">
<alternatives>
<graphic id="pbio.1002046.e041g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e041" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M41" overflow="scroll">
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:msub>
</mml:math>
</alternatives>
</inline-formula>
 estimated at the previous measurement. The above practical implementation is another presentation of <xref ref-type="disp-formula" rid="pbio.1002046.e036">Eq. 25</xref>. To see that, we apply <xref ref-type="disp-formula" rid="pbio.1002046.e039">Eq. 26</xref> recursively:
<disp-formula id="pbio.1002046.e042">
<alternatives>
<graphic id="pbio.1002046.e042g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e042"/>
<mml:math display="block" id="M42" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo><mml:mi>γ</mml:mi>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi>
<mml:mo>)</mml:mo></mml:mrow>
<mml:mi>γ</mml:mi>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow>
<mml:mn>2</mml:mn>
</mml:msup>
<mml:mi>γ</mml:mi><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mo>⋯</mml:mo>
<mml:mo>+</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>−</mml:mo>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mi>k</mml:mi>
</mml:msup>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pbio.1002046.e043">
<alternatives>
<graphic id="pbio.1002046.e043g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e043"/>
<mml:math display="block" id="M43" overflow="scroll">
<mml:mrow>
<mml:mo>=</mml:mo>
<mml:munderover>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:munderover>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow>
<mml:mi>i</mml:mi>
</mml:msup>
<mml:mi>γ</mml:mi><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo><mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow>
<mml:mi>k</mml:mi>
</mml:msup>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>0</mml:mn>
</mml:msub>
</mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
and for the choice of <italic>γ</italic> = 0.5 and assuming
that the first estimation <inline-formula id="pbio.1002046.e044">
<alternatives>
<graphic id="pbio.1002046.e044g" mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.1002046.e044" position="anchor" xlink:type="simple"/>
<mml:math display="inline" id="M44" overflow="scroll">
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>=</mml:mo><mml:mn>0</mml:mn>
</mml:math>
</alternatives>
</inline-formula>, we have
<disp-formula id="pbio.1002046.e045">
<alternatives>
<graphic id="pbio.1002046.e045g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e045"/>
<mml:math display="block" id="M45" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¯</mml:mo>
</mml:mover>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mi>k</mml:mi>
</mml:msub>
<mml:mo>+</mml:mo><mml:mn>0.25</mml:mn><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo><mml:mn>0.125</mml:mn><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo><mml:mn>0.0625</mml:mn><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˜</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo><mml:mo>⋯</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(27)</label>
</disp-formula>
which is corresponding to <xref ref-type="disp-formula" rid="pbio.1002046.e036">Eq. 25</xref> with a decay parameter <italic>w</italic> = 0.5. Indeed, the simulation results of the above equation and an exponentially weighted function (<xref ref-type="disp-formula" rid="pbio.1002046.e036">Eq. 25</xref>) with three past measurements are very similar.</p>
</sec>
<sec id="sec004j">
<title>Proof of Convergence</title>
<p>We have shown (<xref ref-type="supplementary-material" rid="pbio.1002046.s011">S8 Fig.</xref>) that the PD controller was superior in performance to the other two-parameter controllers, i.e. the DI and the PI. It was also superior to the single parameter P controller. We will prove here that the derivative term is essential for stabilization of the guidance controller.</p>
<p>Applying the proportional controller (<xref ref-type="disp-formula" rid="pbio.1002046.e022">Eq. 14</xref>) to the model dynamics (<xref ref-type="disp-formula" rid="pbio.1002046.e016">Eq. 12</xref>), we get
<disp-formula id="pbio.1002046.e046">
<alternatives>
<graphic id="pbio.1002046.e046g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e046"/>
<mml:math display="block" id="M46" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>ω</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:msub>
<mml:mi>θ</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:msub>
<mml:mi>θ</mml:mi>
<mml:mi>d</mml:mi>
</mml:msub>
<mml:mo>)</mml:mo><mml:mo>+</mml:mo>
<mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(28)</label>
</disp-formula>
<disp-formula id="pbio.1002046.e047">
<alternatives>
<graphic id="pbio.1002046.e047g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e047"/>
<mml:math display="block" id="M47" overflow="scroll">
<mml:mrow>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo>
<mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:msub>
<mml:mi>θ</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(29)</label>
</disp-formula>
since <italic>θ<sub>d</sub></italic> = 0. Rearranging the above equation, we get
<disp-formula id="pbio.1002046.e048">
<alternatives>
<graphic id="pbio.1002046.e048g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e048"/>
<mml:math display="block" id="M48" overflow="scroll">
<mml:mrow>
<mml:mo>(</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:msub>
<mml:mi>θ</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
</alternatives>
<label>(30)</label>
</disp-formula>
The solution for this differential equation is marginally stable [<xref ref-type="bibr" rid="pbio.1002046.ref024">24</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref025">25</xref>] and the solution oscillates; i.e., it never converges to an isolated steady state, except when the true solution is a straight line (initial angle to target is identically zero). Applying a proportional-derivative controller, (<xref ref-type="disp-formula" rid="pbio.1002046.e024">Eq. 15</xref>) we get
<disp-formula id="pbio.1002046.e049">
<alternatives>
<graphic id="pbio.1002046.e049g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e049"/>
<mml:math display="block" id="M49" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mover accent="true">
<mml:mi>ω</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:msub>
<mml:mi>θ</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>d</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</alternatives>
<label>(31)</label>
</disp-formula>
and then we get the second order differential equation
<disp-formula id="pbio.1002046.e050">
<alternatives>
<graphic id="pbio.1002046.e050g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e050"/>
<mml:math display="block" id="M50" overflow="scroll">
<mml:mrow>
<mml:mo>(</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>d</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:msub>
<mml:mover accent="true">
<mml:mi>θ</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:mover accent="true">
<mml:mi>α</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mo>(</mml:mo><mml:msub>
<mml:mi>θ</mml:mi>
<mml:mi>x</mml:mi>
</mml:msub>
<mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo>
</mml:mrow>
</mml:math>
</alternatives>
<label>(32)</label>
</disp-formula>
<disp-formula id="pbio.1002046.e051">
<alternatives>
<graphic id="pbio.1002046.e051g" mimetype="image" position="anchor" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.e051"/>
<mml:math display="block" id="M51" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mi>e</mml:mi>
<mml:mo>¨</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>d</mml:mi>
</mml:msub>
<mml:mover accent="true">
<mml:mi>e</mml:mi>
<mml:mo>˙</mml:mo>
</mml:mover>
<mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub>
<mml:mi>K</mml:mi>
<mml:mi>p</mml:mi>
</mml:msub>
<mml:mi>e</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn>
</mml:mrow>
</mml:math>
</alternatives>
<label>(33)</label>
</disp-formula>
which is an exponentially stable system for any positive parameters <italic>K<sub>p</sub></italic> ≥ 0 and <italic>K<sub>d</sub></italic> &gt; 0 [<xref ref-type="bibr" rid="pbio.1002046.ref024">24</xref>,<xref ref-type="bibr" rid="pbio.1002046.ref025">25</xref>], and thus the error <italic>e</italic>(<italic>t</italic>) = <italic>θ<sub>x</sub> – α = θ</italic> is reduced to zero exponentially with time. This proves that the derivative term is essential for ensuring convergence of the controller—that is, the PD controller is the simplest stable controller for guidance purposes.</p>
</sec>
</sec>
<sec id="sec005">
<title>Supporting Information</title>
<supplementary-material id="pbio.1002046.s001" mimetype="application/vnd.ms-excel" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s001">
<label>S1 Data</label>
<caption>
<title>Individual data points underlying the analyses displayed in <xref ref-type="fig" rid="pbio.1002046.g001">Fig. 1</xref>.</title>
<p>(XLS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s002" mimetype="application/vnd.ms-excel" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s002">
<label>S2 Data</label>
<caption>
<title>Individual data points underlying the analyses displayed in <xref ref-type="fig" rid="pbio.1002046.g002">Fig. 2</xref>.</title>
<p>(XLS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s003" mimetype="application/vnd.ms-excel" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s003">
<label>S3 Data</label>
<caption>
<title>Individual data points underlying the analyses displayed in <xref ref-type="fig" rid="pbio.1002046.g003">Fig. 3</xref>.</title>
<p>(XLS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s004" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s004">
<label>S1 Fig</label>
<caption>
<title>Simulations of three trials.</title>
<p>Top: Trajectories of the real bats (dashed black), simulated bats with proportional controller (red) and with PD controller (blue curves). Middle panels (red)—depicts proportional controller, the simulated angle <italic>θ</italic> (solid), the real angle <italic>θ</italic> (black dashed-dotted) and the simulated angular velocity <italic>dθ/dt</italic> (dashed). Bottom panels (blue)—the same as in the middle but for the PD controller.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s005" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s005">
<label>S2 Fig</label>
<caption>
<title>Additional simulation of trials, bat 1.</title>
<p>Flight trajectories of the real bat number 1 (black dashed), simulations with optimal dark <italic>k<sub>d</sub></italic> and <italic>k<sub>p</sub></italic> (blue), simulations with the same initial conditions but with optimal light gains <italic>k<sub>d</sub></italic>, <italic>k<sub>p</sub></italic>, and a pure proportional controller, <italic>k<sub>d</sub></italic> = 0 (red). The angle <italic>θ</italic>(<italic>t</italic>) (solid), and angular velocity (dashed) are given below the x—y planes, together with the measured <italic>θ</italic>(<italic>t</italic>) (dotted) and the errors between the trajectories for each gain set. The time point of the end of the experiment is marked with grey circle.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s006" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s006">
<label>S3 Fig</label>
<caption>
<title>Additional simulation of trials, bat 2.</title>
<p>Flight trajectories of the real bat number 2; see details in <xref ref-type="supplementary-material" rid="pbio.1002046.s005">S2 Fig.</xref></p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s007" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s007">
<label>S4 Fig</label>
<caption>
<title>Additional simulation of trials, bat 3.</title>
<p>Flight trajectories of the real bat number 3; see details in <xref ref-type="supplementary-material" rid="pbio.1002046.s005">S2 Fig.</xref></p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s008" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s008">
<label>S5 Fig</label>
<caption>
<title>Additional simulation of trials, bat 4.</title>
<p>Flight trajectories of the real bat number 4; see details in <xref ref-type="supplementary-material" rid="pbio.1002046.s005">S2 Fig.</xref></p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s009" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s009">
<label>S6 Fig</label>
<caption>
<title>Additional simulation of trials, bat 5.</title>
<p>Flight trajectories of the real bat number 5; see details in <xref ref-type="supplementary-material" rid="pbio.1002046.s005">S2 Fig.</xref></p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s010" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s010">
<label>S7 Fig</label>
<caption>
<title>Additional simulation of trials, bat 6.</title>
<p>Flight trajectories of the real bat number 6; see details in <xref ref-type="supplementary-material" rid="pbio.1002046.s005">S2 Fig.</xref></p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s011" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s011">
<label>S8 Fig</label>
<caption>
<title>Different control strategies.</title>
<p>Comparison of the single-parameter Proportional (P) controller (red) to the two-parameters Proportional-Derivative (PD), Derivative-Integrative (DI), and Proportional-Integrative (PI) controllers. Increasing the number of control parameters from one (P controller) to two (PD, DI, PI) does not necessarily decrease the rate of divergence (right) or the error (left) of the trials that did converge. This indicate that the improvement of the PD over the P controller is not due to the number of parameters. Numbers above bars indicate number of diverged trials.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s012" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s012">
<label>S9 Fig</label>
<caption>
<title>The noise model.</title>
<p>Noise envelope in <italic>θ</italic> of the first noise model (<xref ref-type="disp-formula" rid="pbio.1002046.e031">Eq. 22</xref>, left) and the second model (<xref ref-type="disp-formula" rid="pbio.1002046.e034">Eq. 23</xref>, right).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s013" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s013">
<label>S10 Fig</label>
<caption>
<title>Comparison of the three filter types tested.</title>
<p>Exponential decaying, linearly decaying and uniform average window, all with window length N = 5; each experiment was compared to 120 simulations with noisy measurements and noise suppression.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s014" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s014">
<label>S11 Fig</label>
<caption>
<title>Schematic drawing.</title>
<p>The bat, the target, and the angle <italic>θ</italic> to the line-of-sight (LOS).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s015" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s015">
<label>S12 Fig</label>
<caption>
<title>The two trajectories (simulated and real) intersect at four points (marked as +), creating three non-intersecting areas, A1 to A3, that can be calculated using <xref ref-type="disp-formula" rid="pbio.1002046.e029">Eq. 20</xref>.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s016" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s016">
<label>S1 Table</label>
<caption>
<title>The mean error index (cm) of the six bats, with the S.E.M, for training (a random set of 80% of the dark trials) and testing (the remaining 20% of the dark trials).</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pbio.1002046.s017" mimetype="image/tiff" position="float" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pbio.1002046.s017">
<label>S2 Table</label>
<caption>
<title>The parameters <italic>k<sub>d</sub></italic> and <italic>k<sub>p</sub></italic> that minimize the error index between the simulated trajectories and the real trajectory for each trial in both dark and light conditions.</title>
<p>Values are average of <italic>n</italic> trials of each bat, with their respective S.E.M values.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank D. Derdikman, J. Wright, and M. Geva-Sagiv for comments on the manuscript; H. Preisig for discussions; and C. Moss and B. Falk for data collection.</p>
</ack>
<glossary>
<title>Abbreviations</title> 
<def-list>
<def-item>
<term>θ</term>
<def>
<p>azimuth-to-target angle</p>
</def>
</def-item>
<def-item>
<term>DI</term>
<def>
<p>derivative-integrative</p>
</def>
</def-item>
<def-item>
<term>LOS</term>
<def>
<p>line of sight</p>
</def>
</def-item>
<def-item>
<term>PD</term>
<def>
<p>proportional-derivative</p>
</def>
</def-item>
<def-item>
<term>PI</term>
<def>
<p>proportional-integrative</p>
</def>
</def-item>
</def-list>
</glossary>
<ref-list>
<title>References</title>
<ref id="pbio.1002046.ref001">
<label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">William B, Dickson DS (2006) An integrative model of insect flight control. In: Proc. AIAA Aerosp. Sci. Meet. Exhib. Reno, NV.</mixed-citation>
</ref>
<ref id="pbio.1002046.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Taylor</surname> <given-names>GK</given-names></name> (<year>2001</year>) <article-title>Mechanics and aerodynamics of insect flight control</article-title>. <source>Biol Rev Camb Philos Soc</source> <volume>76</volume>: <fpage>449</fpage>–<lpage>71</lpage>. <object-id pub-id-type="pmid">11762490</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maimon</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Straw</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name> (<year>2010</year>) <article-title>Active flight increases the gain of visual motion processing in drosophila</article-title>. <source>Nat Neurosci</source> <volume>13</volume>: <fpage>393</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2492" xlink:type="simple">10.1038/nn.2492</ext-link></comment> <object-id pub-id-type="pmid">20154683</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gallup</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Hale</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Sumpter</surname> <given-names>DJT</given-names></name>, <name name-style="western"><surname>Garnier</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kacelnik</surname> <given-names>A</given-names></name>, <etal>et al.</etal> (<year>2012</year>) <article-title>Visual attention and the acquisition of information in human crowds</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>109</volume>: <fpage>7245</fpage>–<lpage>50</lpage>. <object-id pub-id-type="pmid">22529369</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bhagavatula</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Claudianos</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ibbotson</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Srinivasan</surname> <given-names>MV</given-names></name> (<year>2011</year>) <article-title>Optic flow cues guide flight in birds</article-title>. <source>Curr Biol</source> <volume>21</volume>: <fpage>1794</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2011.09.009" xlink:type="simple">10.1016/j.cub.2011.09.009</ext-link></comment> <object-id pub-id-type="pmid">22036184</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hedrick</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>X</given-names></name> (<year>2009</year>) <article-title>Wingbeat time and the scaling of passive rotational damping in flapping flight</article-title>. <source>Science</source> <volume>324</volume>: <fpage>252</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1168431" xlink:type="simple">10.1126/science.1168431</ext-link></comment> <object-id pub-id-type="pmid">19359586</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arita</surname> <given-names>HT</given-names></name>, <name name-style="western"><surname>Fenton</surname> <given-names>MB</given-names></name> (<year>1997</year>) <article-title>Flight and echlocation in the ecology and evolution of bats</article-title>. <source>Trends Ecol Evol</source> <volume>12</volume>: <fpage>53</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">21237972</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Norberg</surname> <given-names>UM</given-names></name>, <name name-style="western"><surname>Rayner</surname> <given-names>JMV</given-names></name> (<year>1987</year>) <article-title>Ecological morphology and flight in bats (mammalia; chiroptera): Wing adaptations, flight performance, foraging strategy and echolocation</article-title>. <source>Philos Trans R Soc B Biol Sci</source> <volume>316</volume>: <fpage>335</fpage>–<lpage>427</lpage>.</mixed-citation>
</ref>
<ref id="pbio.1002046.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ghose</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Horiuchi</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Krishnaprasad</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Moss</surname> <given-names>CF</given-names></name> (<year>2006</year>) <article-title>Echolocating bats use a nearly time-optimal strategy to intercept prey</article-title>. <source>PLoS Biol</source> <volume>4</volume>: <fpage>e108</fpage>. <object-id pub-id-type="pmid">16605303</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuc</surname> <given-names>R</given-names></name> (<year>1994</year>) <article-title>Sensorimotor model of bat echolocation and prey capture</article-title>. <source>J Acoust Soc Am</source> <volume>96</volume>: <fpage>1965</fpage>. <object-id pub-id-type="pmid">7963018</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Watts</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mitchell</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Swartz</surname> <given-names>SM</given-names></name> (<year>2001</year>) <article-title>A computational model for estimating the mechanics of horizontal flapping flight in bats: model description and validation</article-title>. <source>J Exp Biol</source> <volume>204</volume>: <fpage>2873</fpage>–<lpage>2898</lpage>. <object-id pub-id-type="pmid">11683442</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Iriarte-Diaz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Riskin</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Breuer</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Swartz</surname> <given-names>SM</given-names></name> (<year>2012</year>) <article-title>Kinematic plasticity during flight in fruit bats: individual variability in response to loading</article-title>. <source>PLoS ONE</source> <volume>7</volume>: <fpage>e36665</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0036665" xlink:type="simple">10.1371/journal.pone.0036665</ext-link></comment> <object-id pub-id-type="pmid">22615790</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hubel</surname> <given-names>TY</given-names></name>, <name name-style="western"><surname>Hristov</surname> <given-names>NI</given-names></name>, <name name-style="western"><surname>Swartz</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Breuer</surname> <given-names>KS</given-names></name> (<year>2009</year>) <article-title>Time-resolved wake structure and kinematics of bat flight</article-title>. <source>Exp Fluids</source> <volume>46</volume>: <fpage>933</fpage>–<lpage>43</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1242/jeb.043257" xlink:type="simple">10.1242/jeb.043257</ext-link></comment> <object-id pub-id-type="pmid">20889823</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ghose</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Moss</surname> <given-names>CF</given-names></name> (<year>2006</year>) <article-title>Steering by hearing: a bat’s acoustic gaze is linked to its flight motor output by a delayed, adaptive linear law</article-title>. <source>J Neurosci</source> <volume>26</volume>: <fpage>1704</fpage>–<lpage>10</lpage>. <object-id pub-id-type="pmid">16467518</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kleinfeld</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ahissar</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Diamond</surname> <given-names>ME</given-names></name> (<year>2006</year>) <article-title>Active sensation: insights from the rodent vibrissa sensorimotor system</article-title>. <source>Curr Opin Neurobiol</source> <volume>16</volume>: <fpage>435</fpage>–<lpage>44</lpage>. <object-id pub-id-type="pmid">16837190</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Holderied</surname> <given-names>MW</given-names></name> (<year>2007</year>) <article-title>Bat echolocation calls: adaptation and convergent evolution</article-title>. <source>Proc Biol Sci</source> <volume>274</volume>: <fpage>905</fpage>–<lpage>12</lpage>. <object-id pub-id-type="pmid">17251105</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yovel</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Falk</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Moss</surname> <given-names>CF</given-names></name>, <name name-style="western"><surname>Ulanovsky</surname> <given-names>N</given-names></name> (<year>2010</year>) <article-title>Optimal localization by pointing off axis</article-title>. <source>Science</source> <volume>327</volume>: <fpage>701</fpage>–<lpage>704</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1183310" xlink:type="simple">10.1126/science.1183310</ext-link></comment> <object-id pub-id-type="pmid">20133574</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yovel</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Geva-Sagiv</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ulanovsky</surname> <given-names>N</given-names></name> (<year>2011</year>) <article-title>Click-based echolocation in bats: not so primitive after all</article-title>. <source>J Comp Physiol A Neuroethol Sens Neural Behav Physiol</source> <volume>197</volume>: <fpage>515</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00359-011-0639-4" xlink:type="simple">10.1007/s00359-011-0639-4</ext-link></comment> <object-id pub-id-type="pmid">21465138</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yovel</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Falk</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Moss</surname> <given-names>CF</given-names></name>, <name name-style="western"><surname>Ulanovsky</surname> <given-names>N</given-names></name> (<year>2011</year>) <article-title>Active control of acoustic field-of-view in a biosonar system</article-title>. <source>PLoS Biol</source> <volume>9</volume>: <fpage>e1001150</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001150" xlink:type="simple">10.1371/journal.pbio.1001150</ext-link></comment> <object-id pub-id-type="pmid">21931535</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holland</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Waters</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Rayner</surname> <given-names>JMV</given-names></name> (<year>2004</year>) <article-title>Echolocation signal structure in the megachiropteran bat rousettus aegyptiacus geoffroy 1810</article-title>. <source>J Exp Biol</source> <volume>207</volume>: <fpage>4361</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">15557022</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holland</surname> <given-names>RA</given-names></name>,<name name-style="western"><surname>Waters</surname> <given-names>DA</given-names></name> (<year>2005</year>) <article-title>Echolocation signals and pinnae movement in the fruitbat rousettus aegyptiacus</article-title>. <source>Acta Chiropterologica</source> <volume>7</volume>: <fpage>83</fpage>–<lpage>90</lpage>.</mixed-citation>
</ref>
<ref id="pbio.1002046.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heffner</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Koay</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Heffner</surname> <given-names>HE</given-names></name> (<year>1999</year>) <article-title>Sound localization in an old-world fruit bat (rousettus aegyptiacus): acuity, use of binaural cues, and relationship to vision</article-title>. <source>J Comp Psychol</source> <volume>113</volume>: <fpage>297</fpage>–<lpage>306</lpage>. <object-id pub-id-type="pmid">10497795</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Masters</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Moffat</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Simmons</surname> <given-names>JA</given-names></name> (<year>1985</year>) <article-title>Sonar tracking of horizontally moving targets by the big brown bat eptesicus fuscus</article-title>. <source>Science</source> <volume>228</volume>: <fpage>1331</fpage>–<lpage>3</lpage>. <object-id pub-id-type="pmid">4001947</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref024">
<label>24</label>
<mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Dorf</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Bishop</surname> <given-names>RH</given-names></name> (<year>2010</year>) <source>Modern Control Systems</source>. <edition>12 edition</edition>. <publisher-loc>Upper Saddle River, NJ, USA</publisher-loc>: <publisher-name>Prentice Hall, Inc</publisher-name>.</mixed-citation>
</ref>
<ref id="pbio.1002046.ref025">
<label>25</label>
<mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>CT</given-names></name> (<year>2012</year>) <source>Linear System Theory and Design</source>. <edition>3 edition</edition>. <publisher-loc>NY, USA</publisher-loc>: <publisher-name>Oxford University Press Inc</publisher-name>.</mixed-citation>
</ref>
<ref id="pbio.1002046.ref026">
<label>26</label>
<mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ogata</surname> <given-names>K</given-names></name> (<year>1995</year>) <source>Discrete-Time Control Systems</source>. <publisher-loc>Upper Saddle River, NJ, USA</publisher-loc>: <publisher-name>Prentice Hall, Inc</publisher-name>.</mixed-citation>
</ref>
<ref id="pbio.1002046.ref027">
<label>27</label>
<mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Zarchan</surname> <given-names>P</given-names></name> (<year>2007</year>) <source>Tactical and Strategic Missile Guidance</source>, volume <volume>889</volume>. <edition>fifth edition</edition>. <publisher-name>AIAA</publisher-name></mixed-citation>
</ref>
<ref id="pbio.1002046.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nodal</surname> <given-names>FR</given-names></name>, <name name-style="western"><surname>Bajo</surname> <given-names>VM</given-names></name>, <name name-style="western"><surname>Parsons</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Schnupp</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>AJ</given-names></name> (<year>2008</year>) <article-title>Sound localization behavior in ferrets: comparison of acoustic orientation and approach-to-target responses</article-title>. <source>Neuroscience</source> <volume>154</volume>: <fpage>397</fpage>–<lpage>408</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroscience.2007.12.022" xlink:type="simple">10.1016/j.neuroscience.2007.12.022</ext-link></comment> <object-id pub-id-type="pmid">18281159</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Populin</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Yin</surname> <given-names>TCT</given-names></name> (<year>1998</year>) <article-title>Behavioral studies of sound localization in the cat</article-title>. <source>J Neurosci</source> <volume>18</volume>: <fpage>2147</fpage>–<lpage>2160</lpage>. <object-id pub-id-type="pmid">9482800</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fischer</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Pena</surname> <given-names>JL</given-names></name> (<year>2011</year>) <article-title>Owl’s behavior and neural representation predicted by bayesian inference</article-title>. <source>Nat Neurosci</source> <volume>14</volume>: <fpage>1061</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2872" xlink:type="simple">10.1038/nn.2872</ext-link></comment> <object-id pub-id-type="pmid">21725311</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref031">
<label>31</label>
<mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Surlykke</surname> <given-names>A</given-names></name> (<year>2004</year>) <source>Echolocation in Bats and Dolphins</source>. <publisher-loc>Chicago</publisher-loc>: <publisher-name>The University of Chicago Press</publisher-name>. p. <fpage>268</fpage>.</mixed-citation>
</ref>
<ref id="pbio.1002046.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Healy</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>McNally</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ruxton</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Cooper</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>AL</given-names></name> (<year>2013</year>) <article-title>Metabolic rate and body size are linked with perception of temporal information</article-title>. <source>Anim Behav</source> <volume>86</volume>: <fpage>685</fpage>–<lpage>696</lpage>. <object-id pub-id-type="pmid">24109147</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bradbury</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Nottebohm</surname> <given-names>F</given-names></name> (<year>1969</year>) <article-title>The use of vision by the little brown bat, myotis lucifugus, under controlled conditions</article-title>. <source>Anim Behav</source> <volume>17</volume>: <fpage>480</fpage>–<lpage>5</lpage>. <object-id pub-id-type="pmid">5370961</object-id></mixed-citation>
</ref>
<ref id="pbio.1002046.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harris</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Wolpert</surname> <given-names>DM</given-names></name> (<year>1998</year>) <article-title>Signal-dependent noise determines motor planning</article-title>. <source>Nature</source> <volume>394</volume>: <fpage>780</fpage>–<lpage>4</lpage>. <object-id pub-id-type="pmid">9723616</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>